<!doctype html>
<html lang="br" data-theme="garden">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="data:">
  <title>htmx</title>
  <link rel="stylesheet" href="index.css">
  <script src="htmx.min.js"></script>
  <meta name="htmx-config" content='{"selfRequestsOnly":false}'>
</head>
<body>
  <div
    id="formulario"
    hx-get="https://kktwevkrtvwhmcapjscx.supabase.co/functions/v1/htmx/api/formulario"
    hx-trigger="load"
  >
  </div>

  <div
    id="lista-funcionarios"
    hx-get="https://kktwevkrtvwhmcapjscx.supabase.co/functions/v1/htmx/api/funcionarios"
    hx-trigger="load"
  >
  </div>

  <script>
    const fetchFuncionarios = async () => {
      await htmx.ajax("GET", "/api/funcionarios", "#lista-funcionarios");
    };

    document.addEventListener("htmx:configRequest", (event) => {
      if (event.detail.path === "/api/funcionario" && event.detail.verb !== "GET") {
        setTimeout(() => {
          document.getElementById("toast").innerHTML = "";
        }, 3 * 1000)
      }
    });

    document.addEventListener("htmx:afterRequest", async (event) => {
      if (event.target.id === "formulario") {
        await fetchFuncionarios();
      }
    });
</script>
</body>
</html>
