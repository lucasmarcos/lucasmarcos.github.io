/*
 Bundled license information:

cytoscape/dist/cytoscape.cjs.js:
  (*!
  Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
  Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
  Licensed under The MIT License (http://opensource.org/licenses/MIT)
)
  (*!
  Event object based on jQuery events, MIT license

  https://jquery.org/license/
  https://tldrlegal.com/license/mit-license
  https://github.com/jquery/jquery/blob/master/src/event.js
)
  (*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License *)
  (*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License *)
*/
(()=>{function Sl(n,p,q,u){switch(n){case -2:return q<p;case -1:return u>=p&&q<p;case 0:return q<p&&u>p;case 1:return q<=p&&u>p;case 2:return u>p;case 4:return!0}}function Mh(n,p,q,u){for(var w;n.from==n.to||(1>q?n.from>=p:n.from>p)||(-1<q?n.to<=p:n.to<p);){var y=!u&&n instanceof pf&&0>n.index?null:n.parent;if(!y)return n;n=y}y=u?0:fe.IgnoreOverlays;if(u)for(let B=n,z=B.parent;z;B=z,z=B.parent)B instanceof pf&&0>B.index&&(null===(w=z.enter(p,q,y))||void 0===w?void 0:w.from)!=B.from&&(n=z);for(;;){u=
n.enter(p,q,y);if(!u)return n;n=u}}function Tl(n,p,q,u){n=n.cursor();let w=[];if(!n.firstChild())return w;if(null!=q)for(let y=!1;!y;)if(y=n.type.is(q),!n.nextSibling())return w;for(;;){if(null!=u&&n.type.is(u))return w;if(n.type.is(p)&&w.push(n.node),!n.nextSibling())return null==u?w:[]}}function Fj(n,p,q=p.length-1){for(;0<=q;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(p[q]&&p[q]!=n.name)return!1;q--}}return!0}function Ul(n){if(!n.length)return null;let p=0,q=n[0];for(var u=1;u<n.length;u++){let w=
n[u];(w.from>q.from||w.to<q.to)&&(q=w,p=u)}u=q instanceof pf&&0>q.index?null:q.parent;n=n.slice();return u?n[p]=u:n.splice(p,1),new Vl(n,q)}function Gj(n){return n.children.some(p=>p instanceof gg||!p.type.isAnonymous||Gj(p))}function Gp(n){function p(Na,Qa,kb,pb,ib,zb){let {id:gb,start:qb,end:Lb,size:Xb}=ha,$b=ua,pc=Fa;for(;0>Xb;){if(ha.next(),-1==Xb){kb.push(T[gb]);pb.push(qb-Na);return}if(-3==Xb){Fa=gb;return}if(-4==Xb){ua=gb;return}throw new RangeError(`Unrecognized record size: ${Xb}`);}var yb=
Da[gb],Bb=qb-Na,Db;if(Db=Lb-qb<=H){var Cb=ha.pos-Qa;Qa=ha.fork();var sb=Db=0,Sb=0,lc=Qa.end-H,qc={size:0,start:0,skip:0};a:for(var oc=Qa.pos-Cb;Qa.pos>oc;){var bb=Qa.size;if(Qa.id==ib&&0<=bb){qc.size=Db;qc.start=sb;qc.skip=Sb;Sb+=4;Db+=4;Qa.next();continue}var db=Qa.pos-bb;if(0>bb||db<oc||Qa.start<lc)break;var oa=Qa.id>=ca?4:0;let ya=Qa.start;for(Qa.next();Qa.pos>db;){if(0>Qa.size)if(-3==Qa.size)oa+=4;else break a;else Qa.id>=ca&&(oa+=4);Qa.next()}sb=ya;Db+=bb;Sb+=oa}Db=Cb=((0>ib||Db==Cb)&&(qc.size=
Db,qc.start=sb,qc.skip=Sb),4<qc.size?qc:void 0)}if(Db){Bb=new Uint16Array(Cb.size-Cb.skip);yb=ha.pos-Cb.size;for(zb=Bb.length;ha.pos>yb;)zb=y(Cb.start,Bb,zb);yb=new gg(Bb,Lb-Cb.start,E);Bb=Cb.start-Na}else{sb=ha.pos-Xb;ha.next();Na=[];ib=[];Sb=gb>=ca?gb:-1;lc=0;for(qc=Lb;ha.pos>sb;)if(0<=Sb&&ha.id==Sb&&0<=ha.size)ha.end<=qc-H&&(u(Na,ib,qb,lc,ha.end,qc,Sb,$b,pc),lc=Na.length,qc=ha.end),ha.next();else if(2500<zb){Cb=qb;bb=sb;Qa=Na;Db=ib;oc=[];db=0;for(oa=-1;ha.pos>bb;){let {id:ya,start:N,end:M,size:Z}=
ha;if(!(4<Z)){if(-1<oa&&N<oa)break;0>oa&&(oa=M-H);oc.push(ya,N,M);db++}ha.next()}if(db){bb=new Uint16Array(4*db);db=oc[oc.length-2];for(let ya=oc.length-3,N=0;0<=ya;ya-=3)bb[N++]=oc[ya],bb[N++]=oc[ya+1]-db,bb[N++]=oc[ya+2]-db,bb[N++]=N;Qa.push(new gg(bb,oc[2]-db,E));Db.push(db-Cb)}}else p(qb,sb,Na,ib,Sb,zb+1);(0<=Sb&&0<lc&&lc<Na.length&&u(Na,ib,qb,lc,qb,qc,Sb,$b,pc),Na.reverse(),ib.reverse(),-1<Sb&&0<lc)?(zb=q(yb,pc),yb=Hj(yb,Na,ib,0,Na.length,0,Lb-qb,zb,zb)):yb=w(yb,Na,ib,Lb-qb,$b-Lb,pc)}kb.push(yb);
pb.push(Bb)}function q(Na,Qa){return(kb,pb,ib)=>{let zb=0,gb=kb.length-1,qb,Lb;if(0<=gb&&(qb=kb[gb])instanceof Ee){if(!gb&&qb.type==Na&&qb.length==ib)return qb;(Lb=qb.prop(Cd.lookAhead))&&(zb=pb[gb]+qb.length+Lb)}return w(Na,kb,pb,ib,zb,Qa)}}function u(Na,Qa,kb,pb,ib,zb,gb,qb,Lb){let Xb=[],$b=[];for(;Na.length>pb;)Xb.push(Na.pop()),$b.push(Qa.pop()+kb-ib);Na.push(w(E.types[gb],Xb,$b,zb-ib,qb-zb,Lb));Qa.push(ib-kb)}function w(Na,Qa,kb,pb,ib,zb,gb){zb&&(zb=[Cd.contextHash,zb],gb=gb?[zb].concat(gb):
[zb]);25<ib&&(ib=[Cd.lookAhead,ib],gb=gb?[ib].concat(gb):[ib]);return new Ee(Na,Qa,kb,pb,gb)}function y(Na,Qa,kb){let {id:pb,start:ib,end:zb,size:gb}=ha;if(ha.next(),0<=gb&&pb<ca){let qb=kb;if(4<gb){let Lb=ha.pos-(gb-4);for(;ha.pos>Lb;)kb=y(Na,Qa,kb)}Qa[--kb]=qb;Qa[--kb]=zb-Na;Qa[--kb]=ib-Na;Qa[--kb]=pb}else-3==gb?Fa=pb:-4==gb&&(ua=pb);return kb}var B;let {buffer:z,nodeSet:E,maxBufferLength:H=1024,reused:T=[],minRepeatType:ca=E.types.length}=n,ha=Array.isArray(z)?new Wl(z,z.length):z,Da=E.types,Fa=
0,ua=0,Va=[],Ha=[];for(;0<ha.pos;)p(n.start||0,n.bufferStart||0,Va,Ha,-1,0);let sa=null!==(B=n.length)&&void 0!==B?B:Va.length?Ha[0]+Va[0].length:0;return new Ee(Da[n.topID],Va.reverse(),Ha.reverse(),sa)}function vi(n,p){if(!n.isAnonymous||p instanceof gg||p.type!=n)return 1;let q=Ij.get(p);if(null==q){q=1;for(let u of p.children){if(u.type!=n||!(u instanceof Ee)){q=1;break}q+=vi(n,u)}Ij.set(p,q)}return q}function Hj(n,p,q,u,w,y,B,z,E){function H(Fa,ua,Va,Ha,sa){for(;Va<Ha;){let Qa=Va;var Na=ua[Va];
let kb=vi(n,Fa[Va]);for(Va++;Va<Ha;Va++){let pb=vi(n,Fa[Va]);if(kb+pb>=ca)break;kb+=pb}if(Va==Qa+1){if(kb>ca){Na=Fa[Qa];H(Na.children,Na.positions,0,Na.children.length,ua[Qa]+sa);continue}ha.push(Fa[Qa])}else ha.push(Hj(n,Fa,ua,Qa,Va,Na,ua[Va-1]+Fa[Va-1].length-Na,null,E));Da.push(Na+sa-y)}}let T=0;for(let Fa=u;Fa<w;Fa++)T+=vi(n,p[Fa]);let ca=Math.ceil(1.5*T/8),ha=[],Da=[];return H(p,q,u,w,0),(z||E)(ha,Da,B)}function wi(n,p=Uint16Array){if("string"!=typeof n)return n;let q=null;for(let w=0,y=0;w<
n.length;){let B=0;for(;;){var u=n.charCodeAt(w++);let z=!1;if(126==u){B=65535;break}92<=u&&u--;34<=u&&u--;u-=32;if(46<=u&&(u-=46,z=!0),B+=u,z)break;B*=46}q?q[y++]=B:q=new p(B)}return q}function Xl(n,p,q){for(let u=p,w;65535!=(w=n[u]);u++)if(w==q)return u-p;return-1}function Yl(n,p,q){let u=n.cursor(fe.IncludeAnonymous);for(u.moveTo(p);;)if(0>q?!u.childBefore(p):!u.childAfter(p))for(;;){if((0>q?u.to<p:u.from>p)&&!u.type.isError)return 0>q?Math.max(0,Math.min(u.to-1,p-25)):Math.min(n.length,Math.max(u.from+
1,p+25));if(0>q?u.prevSibling():u.nextSibling())break;if(!u.parent())return 0>q?0:n.length}}function Zl(n,p){for(let q=0;q<p.length;q++){let u=p[q];if(u.pos==n.pos&&u.sameState(n)){p[q].score<n.score&&(p[q]=n);return}}p.push(n)}function qf(n,p){return n[p]|n[p+1]<<16}function Hp(n){let p=null;for(let q of n)n=q.p.stoppedAt,(q.pos==q.p.stream.end||null!=n&&q.pos>n)&&q.p.parser.stateFlag(q.state,2)&&(!p||p.score<q.score)&&(p=q);return p}function $l(n){if(n.external){let p=n.extend?1:0;return(q,u)=>
n.external(q,u)<<1|p}return n.get}var Jj=Object.defineProperty,Ip=Object.getOwnPropertyDescriptor,Jp=Object.getOwnPropertyNames,Kp=Object.prototype.hasOwnProperty,Kj=(n=>"u">typeof require?require:"u">typeof Proxy?new Proxy(n,{get:(p,q)=>("u">typeof require?require:p)[q]}):n)(function(n){if("u">typeof require)return require.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported');}),Lj=(n,p)=>()=>(n&&(p=n(n=0)),p),va=(n,p)=>()=>(p||n((p={exports:{}}).exports,p),p.exports),
Lp=(n,p,q,u)=>{if(p&&"object"==typeof p||"function"==typeof p)for(let w of Jp(p))!Kp.call(n,w)&&w!==q&&Jj(n,w,{get:()=>p[w],enumerable:!(u=Ip(p,w))||u.enumerable});return n},Mp=n=>Lp(Jj({},"__esModule",{value:!0}),n),Np=va(n=>{function p(E){if(768>E)return!1;for(let H=0,T=B.length;;){let ca=H+T>>1;if(E<B[ca])T=ca;else if(E>=z[ca])H=ca+1;else return!0;if(H==T)return!1}}function q(E){return 127462<=E&&127487>=E}function u(E,H,T){if(H==E.length)return H;var ca;if(ca=H)ca=E.charCodeAt(H),ca=56320<=ca&&
57344>ca;ca&&(ca=E.charCodeAt(H-1),ca=55296<=ca&&56320>ca);ca&&H--;ca=y(E,H);for(H+=65536>ca?1:2;H<E.length;){var ha=y(E,H);if(8205==ca||8205==ha||T&&p(ha))H+=65536>ha?1:2,ca=ha;else if(q(ha)){ha=0;let Da=H-2;for(;0<=Da&&q(y(E,Da));)ha++,Da-=2;if(0==ha%2)break;H+=2}else break}return H}function w(E,H,T){for(;0<H;){let ca=u(E,H-2,T);if(ca<H)return ca;H--}return 0}function y(E,H){let T=E.charCodeAt(H);if(!(55296<=T&&56320>T)||H+1==E.length)return T;E=E.charCodeAt(H+1);return 56320<=E&&57344>E?(T-55296<<
10)+(E-56320)+65536:T}var B=[],z=[];(()=>{let E="lc 34 7n 7 7b 19    2  2   20 b 1c l g  2t 7 2 6 2 2  4 z  u r 2j b 1m 9 9  o 4  9  3  5 17 3 3b f  w 1j    4 8 4  3 7 a 2 t  1m    2 4 8  9  a 2 q  2 2 1l  4 2 4 2 2 3 3  u 2 3  b 2 1l  4 5  2 4  k 2 m 6   1m   2  4 8  7 3 a 2 u  1n    c  9  14  3  1l 3 5 3  4 7 2 b 2 t  1m  2  2  3  5 2 7 2 b 2 s 2 1l 2   2 4 8  9  a 2 t  20  4  2 3   8  29  2 7 c 8 2q  2 9 b 6 22 2 r      1j e  5  2 5 b  10 9  2u 4  6  2 2 2 p 2 4 3 g 4 d  2 2 6  f  jj 3 qa 3 t 3 t 2 u 2 1s 2  7 8  2 b 9  19 3 3b 2 y  3a 3 4 2 9  6 3 63 2 2  1m   7     2 8 6 a 2  1c h 1r 4 1c 7   5  14 9 c 2 w 4 2 2  3 1k   2 3   3 1m 8 2 2 48 3  d  7 4  6  3 2 5i 1m  5 ek  5f x 2da 3 3x  2o w fe 6 2x 2 n9w 4  a w 2 28 2 7k  3  4  p 2 5  47 2 q i d  12 8 p b 1a 3 1c  2 4 2 2 13  1v 6 2 2 2 2 c  8  1b  1f   3 2 2 5 2   16 2 8  6m  2  4  fn4  kh g g g a6 2 gt  6a  45 5 1ae 3  2 5 4 14 3 4  4l 2 fx 4 ar 2 49 b 4w  1i f 1k 3 1d 4 2 2 1x 3 10 5  8 1q  c 2 1g 9 a 4 2  2n 3 2   2 6  4g  3 8 l 2 1l 2     m  e 7 3 5 5f 8 2 3   n  29  2 6   2   2  2 6j  2 4 6 2  2 r 2 2d 8 2   2 2y    2 6   2t 3 2 4  5 77 9  2 6t  a 2   4  40 4 2 2 4  w a 14 6 2 4 8  9 6 2 3 1a d  2 ba 7  6   2a m 2 7  2  2 3e 6 3   2  7   20 2 3    9n 2 f0b 5 1n 7 t4  1r 4 29  f5k 2 43q   3 4 5 8 8 2 7 u 4 44 3 1iz 1j 4 1e 8  e  m 5  f 11s 7  h 2 7  2  5 79 7 c5 4 15s 7 31 7 240 5 gx7k 2o 3k 6o".split(" ").map(H=>
H?parseInt(H,36):1);for(let H=0,T=0;H<E.length;H++)(H%2?z:B).push(T+=E[H])})();n.findClusterBreak=function(E,H,T=!0,ca=!0){return(T?u:w)(E,H,ca)};n.isExtendingChar=p}),hg=va(n=>{function p(V){let A=-1;for(let J of V)A+=J.length+1;return A}function q(V,A,J=0,W=1E9){for(let ea=0,qa=0,za=!0;qa<V.length&&ea<=W;qa++){let Wa=V[qa],fb=ea+Wa.length;fb>=J&&(fb>W&&(Wa=Wa.slice(0,W-ea)),ea<J&&(Wa=Wa.slice(J-ea)),za?(A[A.length-1]+=Wa,za=!1):A.push(Wa));ea=fb+1}return A}function u(V,A,J){return A=Math.max(0,
Math.min(V.length,A)),[A,Math.max(A,Math.min(V.length,J))]}function w(V,A,J=!0,W=!0){return Db.findClusterBreak(V,A,J,W)}function y(V,A,J,W=!1){if(!(0==A&&0>=J)){var ea=V.length-2;0<=ea&&0>=J&&J==V[ea+1]?V[ea]+=A:0<=ea&&0==A&&0==V[ea]?V[ea+1]+=J:W?(V[ea]+=A,V[ea+1]+=J):V.push(A,J)}}function B(V,A,J){if(0!=J.length)if(A=A.length-2>>1,A<V.length)V[V.length-1]=V[V.length-1].append(J);else{for(;V.length<A;)V.push(Cb.empty);V.push(J)}}function z(V,A,J){let W=V.inserted;for(let ea=0,qa=0,za=0;za<V.sections.length;){let Wa=
V.sections[za++],fb=V.sections[za++];if(0>fb)ea+=Wa,qa+=Wa;else{let Ab=ea,Ib=qa,uc=Cb.empty;for(;Ab+=Wa,Ib+=fb,fb&&W&&(uc=uc.append(W[za-2>>1])),!(J||za==V.sections.length||0>V.sections[za+1]);)Wa=V.sections[za++],fb=V.sections[za++];A(ea,Ab,qa,Ib,uc);ea=Ab;qa=Ib}}}function E(V,A,J,W=!1){let ea=[];W=W?[]:null;V=new N(V);A=new N(A);for(let Wa=-1;;){if(V.done&&A.len||A.done&&V.len)throw Error("Mismatched change set lengths");if(-1==V.ins&&-1==A.ins){var qa=Math.min(V.len,A.len);y(ea,qa,-1);V.forward(qa);
A.forward(qa)}else if(0<=A.ins&&(0>V.ins||Wa==V.i||0==V.off&&(A.len<V.len||A.len==V.len&&!J))){qa=A.len;for(y(ea,A.ins,-1);qa;){var za=Math.min(V.len,qa);0<=V.ins&&Wa<V.i&&V.len<=za&&(y(ea,0,V.ins),W&&B(W,ea,V.text),Wa=V.i);V.forward(za);qa-=za}A.next()}else if(0<=V.ins){qa=0;for(za=V.len;za;)if(-1==A.ins){let fb=Math.min(za,A.len);qa+=fb;za-=fb;A.forward(fb)}else if(0==A.ins&&A.len<za)za-=A.len,A.next();else break;y(ea,qa,Wa<V.i?V.ins:0);W&&Wa<V.i&&B(W,ea,V.text);Wa=V.i;V.forward(V.len-za)}else{if(V.done&&
A.done)return W?ya.createSet(ea,W):oa.create(ea);throw Error("Mismatched change set lengths");}}}function H(V,A,J=!1){let W=[];J=J?[]:null;V=new N(V);A=new N(A);for(let ea=!1;;){if(V.done&&A.done)return J?ya.createSet(W,J):oa.create(W);if(0==V.ins)y(W,V.len,0,ea),V.next();else if(0!=A.len||A.done){if(V.done||A.done)throw Error("Mismatched change set lengths");let qa=Math.min(V.len2,A.len),za=W.length;if(-1==V.ins){let Wa=-1==A.ins?-1:A.off?0:A.ins;y(W,qa,Wa,ea);J&&Wa&&B(J,W,A.text)}else-1==A.ins?
(y(W,V.off?0:V.len,qa,ea),J&&B(J,W,V.textBit(qa))):(y(W,V.off?0:V.len,A.off?0:A.ins,ea),J&&!A.off&&B(J,W,A.text));ea=(V.ins>qa||0<=A.ins&&A.len>qa)&&(ea||W.length>za);V.forward2(qa);A.forward(qa)}else y(W,0,A.ins,ea),J&&B(J,W,A.text),A.next()}}function T(V,A){for(let J of V.ranges)if(J.to>A)throw new RangeError("Selection points outside of document");}function ca(V,A){return V==A||V.length==A.length&&V.every((J,W)=>J===A[W])}function ha(V,A,J){if(V.length!=A.length)return!1;for(let W=0;W<V.length;W++)if(!J(V[W],
A[W]))return!1;return!0}function Da(V,A){let J=!1;for(let W of A)Ha(V,W)&1&&(J=!0);return J}function Fa(V,A,J){function W(fb){let Ab=[];for(let Ib=0;Ib<ea.length;Ib++){let uc=sa(fb,ea[Ib]);if(2==qa[Ib])for(let xc of uc)Ab.push(xc);else Ab.push(uc)}return A.combine(Ab)}let ea=J.map(fb=>V[fb.id]),qa=J.map(fb=>fb.type),za=ea.filter(fb=>!(fb&1)),Wa=V[A.id]>>1;return{create(fb){for(let Ab of ea)Ha(fb,Ab);return fb.values[Wa]=W(fb),1},update(fb,Ab){if(!Da(fb,za))return 0;Ab=W(fb);return A.compare(Ab,fb.values[Wa])?
0:(fb.values[Wa]=Ab,1)},reconfigure(fb,Ab){var Ib=Da(fb,ea);let uc=Ab.config.facets[A.id];Ab=Ab.facet(A);if(uc&&!Ib&&ca(J,uc))return fb.values[Wa]=Ab,0;Ib=W(fb);return A.compare(Ib,Ab)?(fb.values[Wa]=Ab,0):(fb.values[Wa]=Ib,1)}}}function ua(V){return A=>new ec(A,V)}function Va(V,A,J){function W(za,Wa){var fb=qa.get(za);if(null!=fb){if(fb<=Wa)return;let Ab=ea[fb].indexOf(za);-1<Ab&&ea[fb].splice(Ab,1);za instanceof hc&&J.delete(za.compartment)}if(qa.set(za,Wa),Array.isArray(za))for(let Ab of za)W(Ab,
Wa);else if(za instanceof hc){if(J.has(za.compartment))throw new RangeError("Duplicate use of compartment in extensions");fb=A.get(za.compartment)||za.inner;J.set(za.compartment,fb);W(fb,Wa)}else if(za instanceof ec)W(za.inner,za.prec);else if(za instanceof tb)ea[Wa].push(za),za.provides&&W(za.provides,Wa);else if(za instanceof Sa)ea[Wa].push(za),za.facet.extensions&&W(za.facet.extensions,Pb.default);else{fb=za.extension;if(!fb)throw Error(`Unrecognized extension value in extension set (${za}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);
W(fb,Wa)}}let ea=[[],[],[],[],[]],qa=new Map;return W(V,Pb.default),ea.reduce((za,Wa)=>za.concat(Wa))}function Ha(V,A){if(A&1)return 2;A>>=1;var J=V.status[A];if(4==J)throw Error("Cyclic dependency between fields and/or facets");if(J&2)return J;V.status[A]=4;J=V.computeSlot(V,V.config.dynamicSlots[A]);return V.status[A]=2|J}function sa(V,A){return A&1?V.config.staticValues[A>>1]:V.values[A>>1]}function Na(V,A,J){var W;let ea,qa,za;return J?(ea=A.changes,qa=ya.empty(A.changes.length),za=V.changes.compose(A.changes)):
(ea=A.changes.map(V.changes),qa=V.changes.mapDesc(A.changes,!0),za=V.changes.compose(ea)),{changes:za,selection:A.selection?A.selection.map(qa):null===(W=V.selection)||void 0===W?void 0:W.map(ea),effects:Ta.mapEffects(V.effects,ea).concat(Ta.mapEffects(A.effects,qa)),annotations:V.annotations.length?V.annotations.concat(A.annotations):A.annotations,scrollIntoView:V.scrollIntoView||A.scrollIntoView}}function Qa(V,A,J){let W=A.selection,ea=pb(A.annotations);return A.userEvent&&(ea=ea.concat(mb.userEvent.of(A.userEvent))),
{changes:A.changes instanceof ya?A.changes:ya.of(A.changes||[],J,V.facet(Dc)),selection:W&&(W instanceof Z?W:Z.single(W.anchor,W.head)),effects:pb(A.effects),annotations:ea,scrollIntoView:!!A.scrollIntoView}}function kb(V,A,J){var W=Qa(V,A.length?A[0]:{},V.doc.length);A.length&&!1===A[0].filter&&(J=!1);for(var ea=1;ea<A.length;ea++){!1===A[ea].filter&&(J=!1);var qa=!!A[ea].sequential;W=Na(W,Qa(V,A[ea],qa?W.changes.newLength:V.doc.length),qa)}V=mb.create(V,W.changes,W.selection,W.effects,W.annotations,
W.scrollIntoView);if(J){J=V;V=J.startState;A=!0;for(za of V.facet(cd)){W=za(J);if(!1===W){A=!1;break}if(Array.isArray(W))if(!0===A)A=W;else a:{ea=[];for(let Wa=0,fb=0;;){let Ab;if(Wa<A.length&&(fb==W.length||W[fb]>=A[Wa]))qa=A[Wa++],Ab=A[Wa++];else if(fb<W.length)qa=W[fb++],Ab=W[fb++];else{A=ea;break a}!ea.length||ea[ea.length-1]<qa?ea.push(qa,Ab):ea[ea.length-1]<Ab&&(ea[ea.length-1]=Ab)}}}if(!0!==A){if(!1===A){A=J.changes.invertedDesc;var za=ya.empty(V.doc.length)}else A=J.changes.filter(A),za=A.changes,
A=A.filtered.mapDesc(A.changes).invertedDesc;J=mb.create(V,za,J.selection&&J.selection.map(A),Ta.mapEffects(J.effects,A),J.annotations,J.scrollIntoView)}za=V.facet(jd);for(A=za.length-1;0<=A;A--)W=za[A](J),W instanceof mb?J=W:Array.isArray(W)&&1==W.length&&W[0]instanceof mb?J=W[0]:J=kb(V,pb(W),!1);za=J}else za=V;J=za.startState;V=J.facet(wc);A=za;for(W=V.length-1;0<=W;W--)(ea=V[W](za))&&Object.keys(ea).length&&(A=Na(A,Qa(J,ea,za.changes.newLength),!0));return A==za?za:mb.create(J,za.changes,za.selection,
A.effects,A.annotations,A.scrollIntoView)}function pb(V){return null==V?Fb:Array.isArray(V)?V:[V]}function ib(V){return A=>{if(!/\S/.test(A))return n.CharCategory.Space;a:if(ic)var J=ic.test(A);else{for(J=0;J<A.length;J++){let W=A[J];if(/\w/.test(W)||"\u0080"<W&&(W.toUpperCase()!=W.toLowerCase()||Hb.test(W))){J=!0;break a}}J=!1}if(J)return n.CharCategory.Word;for(J=0;J<V.length;J++)if(-1<A.indexOf(V[J]))return n.CharCategory.Word;return n.CharCategory.Other}}function zb(V,A){return V.from-A.from||
V.value.startSide-A.value.startSide}function gb(V){if(1<V.length)for(let A=V[0],J=1;J<V.length;J++){let W=V[J];if(0<zb(A,W))return V.slice().sort(zb);A=W}return V}function qb(V,A,J){let W=new Map;for(var ea of V)for(V=0;V<ea.chunk.length;V++)0>=ea.chunk[V].maxPoint&&W.set(ea.chunk[V],ea.chunkPos[V]);ea=new Set;for(let qa of A)for(A=0;A<qa.chunk.length;A++)V=W.get(qa.chunk[A]),null!=V&&(J?J.mapPos(V):V)==qa.chunkPos[A]&&!J?.touchesRange(V,V+qa.chunk[A].length)&&ea.add(qa.chunk[A]);return ea}function Lb(V,
A){for(let J=V[A];;){let W=(A<<1)+1;if(W>=V.length)break;let ea=V[W];if(W+1<V.length&&0<=ea.compare(V[W+1])&&(ea=V[W+1],W++),0>J.compare(ea))break;V[W]=J;V[A]=ea;A=W}}function Xb(V,A,J,W,ea,qa){V.goto(A);J.goto(W);ea=W+ea;let za=W;for(A=W-A;;){let Wa=(W=V.to+A-J.to)||V.endSide-J.endSide,fb=0>Wa?V.to+A:J.to,Ab=Math.min(fb,ea);if(V.point||J.point?V.point&&J.point&&(V.point==J.point||V.point.eq(J.point))&&$b(V.activeForPoint(V.to),J.activeForPoint(J.to))||qa.comparePoint(za,Ab,V.point,J.point):Ab>za&&
!$b(V.active,J.active)&&qa.compareRange(za,Ab,V.active,J.active),fb>ea)break;(W||V.openEnd!=J.openEnd)&&qa.boundChange&&qa.boundChange(fb);za=fb;0>=Wa&&V.next();0<=Wa&&J.next()}}function $b(V,A){if(V.length!=A.length)return!1;for(let J=0;J<V.length;J++)if(V[J]!=A[J]&&!V[J].eq(A[J]))return!1;return!0}function pc(V,A){for(let J=A,W=V.length-1;J<W;J++)V[J]=V[J+1];V.pop()}function yb(V,A,J){for(let W=V.length-1;W>=A;W--)V[W+1]=V[W];V[A]=J}function Bb(V,A){let J=-1,W=1E9;for(let ea=0;ea<A.length;ea++)0>
(A[ea]-W||V[ea].endSide-V[J].endSide)&&(J=ea,W=A[ea]);return J}var Db=Np(),Cb=class V{lineAt(A){if(0>A||A>this.length)throw new RangeError(`Invalid position ${A} in document of length ${this.length}`);return this.lineInner(A,!1,1,0)}line(A){if(1>A||A>this.lines)throw new RangeError(`Invalid line number ${A} in ${this.lines}-line document`);return this.lineInner(A,!0,1,0)}replace(A,J,W){[A,J]=u(this,A,J);let ea=[];return this.decompose(0,A,ea,2),W.length&&W.decompose(0,W.length,ea,3),this.decompose(J,
this.length,ea,1),Sb.from(ea,this.length-(J-A)+W.length)}append(A){return this.replace(this.length,this.length,A)}slice(A,J=this.length){[A,J]=u(this,A,J);let W=[];return this.decompose(A,J,W,0),Sb.from(W,J-A)}eq(A){if(A==this)return!0;if(A.length!=this.length||A.lines!=this.lines)return!1;let J=this.scanIdentical(A,1),W=this.length-this.scanIdentical(A,-1),ea=new lc(this);A=new lc(A);for(let qa=J,za=J;;){if(ea.next(qa),A.next(qa),qa=0,ea.lineBreak!=A.lineBreak||ea.done!=A.done||ea.value!=A.value)return!1;
if(za+=ea.value.length,ea.done||za>=W)return!0}}iter(A=1){return new lc(this,A)}iterRange(A,J=this.length){return new qc(this,A,J)}iterLines(A,J){null==A?J=this.iter():(null==J&&(J=this.lines+1),A=this.line(A).from,J=this.iterRange(A,Math.max(A,J==this.lines+1?this.length:1>=J?0:this.line(J-1).to)));return new oc(J)}toString(){return this.sliceString(0)}toJSON(){let A=[];return this.flatten(A),A}constructor(){}static of(A){if(0==A.length)throw new RangeError("A document must have at least one line");
return 1!=A.length||A[0]?32>=A.length?new sb(A):Sb.from(sb.split(A,[])):V.empty}},sb=class V extends Cb{constructor(A,J=p(A)){super();this.text=A;this.length=J}get lines(){return this.text.length}get children(){return null}lineInner(A,J,W,ea){for(let qa=0;;qa++){let za=this.text[qa],Wa=ea+za.length;if((J?W:Wa)>=A)return new bb(ea,Wa,W,za);ea=Wa+1;W++}}decompose(A,J,W,ea){A=0>=A&&J>=this.length?this:new V(q(this.text,[""],A,J),Math.min(J,this.length)-Math.max(0,A));ea&1?(J=W.pop(),ea=q(A.text,J.text.slice(),
0,A.length),32>=ea.length?W.push(new V(ea,J.length+A.length)):(A=ea.length>>1,W.push(new V(ea.slice(0,A)),new V(ea.slice(A))))):W.push(A)}replace(A,J,W){if(!(W instanceof V))return super.replace(A,J,W);[A,J]=u(this,A,J);let ea=q(this.text,q(W.text,q(this.text,[""],0,A)),J);A=this.length+W.length-(J-A);return 32>=ea.length?new V(ea,A):Sb.from(V.split(ea,[]),A)}sliceString(A,J=this.length,W="\n"){[A,J]=u(this,A,J);let ea="";for(let qa=0,za=0;qa<=J&&za<this.text.length;za++){let Wa=this.text[za],fb=
qa+Wa.length;qa>A&&za&&(ea+=W);A<fb&&J>qa&&(ea+=Wa.slice(Math.max(0,A-qa),J-qa));qa=fb+1}return ea}flatten(A){for(let J of this.text)A.push(J)}scanIdentical(){return 0}static split(A,J){let W=[],ea=-1;for(let qa of A)W.push(qa),ea+=qa.length+1,32==W.length&&(J.push(new V(W,ea)),W=[],ea=-1);return-1<ea&&J.push(new V(W,ea)),J}},Sb=class V extends Cb{constructor(A,J){super();this.children=A;this.length=J;this.lines=0;for(let W of A)this.lines+=W.lines}lineInner(A,J,W,ea){for(let qa=0;;qa++){let za=this.children[qa],
Wa=ea+za.length,fb=W+za.lines-1;if((J?fb:Wa)>=A)return za.lineInner(A,J,W,ea);ea=Wa+1;W=fb+1}}decompose(A,J,W,ea){for(let qa=0,za=0;za<=J&&qa<this.children.length;qa++){let Wa=this.children[qa],fb=za+Wa.length;if(A<=fb&&J>=za){let Ab=ea&((za<=A?1:0)|(fb>=J?2:0));za>=A&&fb<=J&&!Ab?W.push(Wa):Wa.decompose(A-za,J-za,W,Ab)}za=fb+1}}replace(A,J,W){if([A,J]=u(this,A,J),W.lines<this.lines)for(let za=0,Wa=0;za<this.children.length;za++){var ea=this.children[za],qa=Wa+ea.length;if(A>=Wa&&J<=qa){let fb=ea.replace(A-
Wa,J-Wa,W);ea=this.lines-ea.lines+fb.lines;return fb.lines<ea>>4&&fb.lines>ea>>6?(qa=this.children.slice(),qa[za]=fb,new V(qa,this.length-(J-A)+W.length)):super.replace(Wa,qa,fb)}Wa=qa+1}return super.replace(A,J,W)}sliceString(A,J=this.length,W="\n"){[A,J]=u(this,A,J);let ea="";for(let qa=0,za=0;qa<this.children.length&&za<=J;qa++){let Wa=this.children[qa],fb=za+Wa.length;za>A&&qa&&(ea+=W);A<fb&&J>za&&(ea+=Wa.sliceString(A-za,J-za,W));za=fb+1}return ea}flatten(A){for(let J of this.children)J.flatten(A)}scanIdentical(A,
J){if(!(A instanceof V))return 0;let W=0,[ea,qa,za,Wa]=0<J?[0,0,this.children.length,A.children.length]:[this.children.length-1,A.children.length-1,-1,-1];for(;;ea+=J,qa+=J){if(ea==za||qa==Wa)return W;let fb=this.children[ea],Ab=A.children[qa];if(fb!=Ab)return W+fb.scanIdentical(Ab,J);W+=fb.length+1}}static from(A,J=A.reduce((W,ea)=>W+ea.length+1,-1)){function W(R){let U;if(R.lines>Wa&&R instanceof V)for(let na of R.children)W(na);else R.lines>fb&&(Ib>fb||!Ib)?(ea(),Ab.push(R)):R instanceof sb&&Ib&&
(U=xc[xc.length-1])instanceof sb&&32>=R.lines+U.lines?(Ib+=R.lines,uc+=R.length+1,xc[xc.length-1]=new sb(U.text.concat(R.text),U.length+1+R.length)):(Ib+R.lines>za&&ea(),Ib+=R.lines,uc+=R.length+1,xc.push(R))}function ea(){0!=Ib&&(Ab.push(1==xc.length?xc[0]:V.from(xc,uc)),uc=-1,Ib=xc.length=0)}var qa=0;for(let R of A)qa+=R.lines;if(32>qa){qa=[];for(let R of A)R.flatten(qa);return new sb(qa,J)}let za=Math.max(32,qa>>5),Wa=za<<1,fb=za>>1,Ab=[],Ib=0,uc=-1,xc=[];for(let R of A)W(R);return ea(),1==Ab.length?
Ab[0]:new V(Ab,J)}};Cb.empty=new sb([""],0);var lc=class{constructor(V,A=1){this.dir=A;this.lineBreak=this.done=!1;this.value="";this.nodes=[V];this.offsets=[0<A?1:(V instanceof sb?V.text.length:V.children.length)<<1]}nextInner(V,A){for(this.done=this.lineBreak=!1;;){let W=this.nodes.length-1;var J=this.nodes[W];let ea=this.offsets[W],qa=ea>>1,za=J instanceof sb?J.text.length:J.children.length;if(qa==(0<A?za:0)){if(0==W)return this.done=!0,this.value="",this;0<A&&this.offsets[W-1]++;this.nodes.pop();
this.offsets.pop()}else if((ea&1)==(0<A?0:1)){if(this.offsets[W]+=A,0==V)return this.lineBreak=!0,this.value="\n",this;V--}else if(J instanceof sb){J=J.text[qa+(0>A?-1:0)];if(this.offsets[W]+=A,J.length>Math.max(0,V))return this.value=0==V?J:0<A?J.slice(V):J.slice(0,J.length-V),this;V-=J.length}else J=J.children[qa+(0>A?-1:0)],V>J.length?(V-=J.length,this.offsets[W]+=A):(0>A&&this.offsets[W]--,this.nodes.push(J),this.offsets.push(0<A?1:(J instanceof sb?J.text.length:J.children.length)<<1))}}next(V=
0){return 0>V&&(this.nextInner(-V,-this.dir),V=this.value.length),this.nextInner(V,this.dir)}},qc=class{constructor(V,A,J){this.value="";this.done=!1;this.cursor=new lc(V,A>J?-1:1);this.pos=A>J?V.length:0;this.from=Math.min(A,J);this.to=Math.max(A,J)}nextInner(V,A){if(0>A?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;V+=Math.max(0,0>A?this.pos-this.to:this.from-this.pos);let J=0>A?this.pos-this.from:this.to-this.pos;V>J&&(V=J);J-=V;let {value:W}=this.cursor.next(V);
return this.pos+=(W.length+V)*A,this.value=W.length<=J?W:0>A?W.slice(W.length-J):W.slice(0,J),this.done=!this.value,this}next(V=0){return 0>V?V=Math.max(V,this.from-this.pos):0<V&&(V=Math.min(V,this.to-this.pos)),this.nextInner(V,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}},oc=class{constructor(V){this.inner=V;this.afterBreak=!0;this.value="";this.done=!1}next(V=0){let {done:A,lineBreak:J,value:W}=this.inner.next(V);return A&&this.afterBreak?(this.value="",this.afterBreak=
!1):A?(this.done=!0,this.value=""):J?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=W,this.afterBreak=!1),this}get lineBreak(){return!1}};"u">typeof Symbol&&(Cb.prototype[Symbol.iterator]=function(){return this.iter()},lc.prototype[Symbol.iterator]=qc.prototype[Symbol.iterator]=oc.prototype[Symbol.iterator]=function(){return this});var bb=class{constructor(V,A,J,W){this.from=V;this.to=A;this.number=J;this.text=W}get length(){return this.to-this.from}},db=/\r\n?|\n/;n.MapMode=
void 0;(function(V){V[V.Simple=0]="Simple";V[V.TrackDel=1]="TrackDel";V[V.TrackBefore=2]="TrackBefore";V[V.TrackAfter=3]="TrackAfter"})(n.MapMode||(n.MapMode={}));var oa=class V{constructor(A){this.sections=A}get length(){let A=0;for(let J=0;J<this.sections.length;J+=2)A+=this.sections[J];return A}get newLength(){let A=0;for(let J=0;J<this.sections.length;J+=2){let W=this.sections[J+1];A+=0>W?this.sections[J]:W}return A}get empty(){return 0==this.sections.length||2==this.sections.length&&0>this.sections[1]}iterGaps(A){for(let J=
0,W=0,ea=0;J<this.sections.length;){let qa=this.sections[J++],za=this.sections[J++];0>za?(A(W,ea,qa),ea+=qa):ea+=za;W+=qa}}iterChangedRanges(A,J=!1){z(this,A,J)}get invertedDesc(){let A=[];for(let J=0;J<this.sections.length;){let W=this.sections[J++],ea=this.sections[J++];0>ea?A.push(W,ea):A.push(ea,W)}return new V(A)}composeDesc(A){return this.empty?A:A.empty?this:H(this,A)}mapDesc(A,J=!1){return A.empty?this:E(this,A,J)}mapPos(A,J=-1,W=n.MapMode.Simple){let ea=0,qa=0;for(let za=0;za<this.sections.length;){let Wa=
this.sections[za++],fb=this.sections[za++],Ab=ea+Wa;if(0>fb){if(Ab>A)return qa+(A-ea);qa+=Wa}else{if(W!=n.MapMode.Simple&&Ab>=A&&(W==n.MapMode.TrackDel&&ea<A&&Ab>A||W==n.MapMode.TrackBefore&&ea<A||W==n.MapMode.TrackAfter&&Ab>A))return null;if(Ab>A||Ab==A&&0>J&&!Wa)return A==ea||0>J?qa:qa+fb;qa+=fb}ea=Ab}if(A>ea)throw new RangeError(`Position ${A} is out of range for changeset of length ${ea}`);return qa}touchesRange(A,J=A){for(let ea=0,qa=0;ea<this.sections.length&&qa<=J;){var W=this.sections[ea++];
let za=this.sections[ea++];W=qa+W;if(0<=za&&qa<=J&&W>=A)return qa<A&&W>J?"cover":!0;qa=W}return!1}toString(){let A="";for(let J=0;J<this.sections.length;){let W=this.sections[J++],ea=this.sections[J++];A+=(A?" ":"")+W+(0<=ea?":"+ea:"")}return A}toJSON(){return this.sections}static fromJSON(A){if(!Array.isArray(A)||A.length%2||A.some(J=>"number"!=typeof J))throw new RangeError("Invalid JSON representation of ChangeDesc");return new V(A)}static create(A){return new V(A)}},ya=class V extends oa{constructor(A,
J){super(A);this.inserted=J}apply(A){if(this.length!=A.length)throw new RangeError("Applying change set to a document with the wrong length");return z(this,(J,W,ea,qa,za)=>A=A.replace(ea,ea+(W-J),za),!1),A}mapDesc(A,J=!1){return E(this,A,J,!0)}invert(A){let J=this.sections.slice(),W=[];for(let qa=0,za=0;qa<J.length;qa+=2){let Wa=J[qa];var ea=J[qa+1];if(0<=ea){J[qa]=ea;J[qa+1]=Wa;for(ea=qa>>1;W.length<ea;)W.push(Cb.empty);W.push(Wa?A.slice(za,za+Wa):Cb.empty)}za+=Wa}return new V(J,W)}compose(A){return this.empty?
A:A.empty?this:H(this,A,!0)}map(A,J=!1){return A.empty?this:E(this,A,J,!0)}iterChanges(A,J=!1){z(this,A,J)}get desc(){return oa.create(this.sections)}filter(A){let J=[],W=[],ea=[],qa=new N(this);a:for(let fb=0,Ab=0;;){for(var za=fb==A.length?1E9:A[fb++];Ab<za||Ab==za&&0==qa.len;){if(qa.done)break a;var Wa=Math.min(qa.len,za-Ab);y(ea,Wa,-1);let Ib=-1==qa.ins?-1:0==qa.off?qa.ins:0;y(J,Wa,Ib);0<Ib&&B(W,J,qa.text);qa.forward(Wa);Ab+=Wa}for(za=A[fb++];Ab<za;){if(qa.done)break a;Wa=Math.min(qa.len,za-Ab);
y(J,Wa,-1);y(ea,Wa,-1==qa.ins?-1:0==qa.off?qa.ins:0);qa.forward(Wa);Ab+=Wa}}return{changes:new V(J,W),filtered:oa.create(ea)}}toJSON(){let A=[];for(let J=0;J<this.sections.length;J+=2){let W=this.sections[J],ea=this.sections[J+1];0>ea?A.push(W):0==ea?A.push([W]):A.push([W].concat(this.inserted[J>>1].toJSON()))}return A}static of(A,J,W){function ea(Ib=!1){if(Ib||za.length)fb<J&&y(za,J-fb,-1),Ib=new V(za,Wa),Ab=Ab?Ab.compose(Ib.map(Ab)):Ib,za=[],Wa=[],fb=0}function qa(Ib){if(Array.isArray(Ib))for(var uc of Ib)qa(uc);
else if(Ib instanceof V){if(Ib.length!=J)throw new RangeError(`Mismatched change set length (got ${Ib.length}, expected ${J})`);ea();Ab=Ab?Ab.compose(Ib.map(Ab)):Ib}else{let {from:xc,to:R=xc,insert:U}=Ib;if(xc>R||0>xc||R>J)throw new RangeError(`Invalid change range ${xc} to ${R} (in doc of length ${J})`);Ib=U?"string"==typeof U?Cb.of(U.split(W||db)):U:Cb.empty;uc=Ib.length;if(xc!=R||0!=uc)xc<fb&&ea(),xc>fb&&y(za,xc-fb,-1),y(za,R-xc,uc),B(Wa,za,Ib),fb=R}}let za=[],Wa=[],fb=0,Ab=null;return qa(A),ea(!Ab),
Ab}static empty(A){return new V(A?[A,-1]:[],[])}static fromJSON(A){if(!Array.isArray(A))throw new RangeError("Invalid JSON representation of ChangeSet");let J=[],W=[];for(let ea=0;ea<A.length;ea++){let qa=A[ea];if("number"==typeof qa)J.push(qa,-1);else{if(!Array.isArray(qa)||"number"!=typeof qa[0]||qa.some((za,Wa)=>Wa&&"string"!=typeof za))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==qa.length)J.push(qa[0],0);else{for(;W.length<ea;)W.push(Cb.empty);W[ea]=Cb.of(qa.slice(1));
J.push(qa[0],W[ea].length)}}}return new V(J,W)}static createSet(A,J){return new V(A,J)}},N=class{constructor(V){this.set=V;this.i=0;this.next()}next(){let {sections:V}=this.set;this.i<V.length?(this.len=V[this.i++],this.ins=V[this.i++]):(this.len=0,this.ins=-2);this.off=0}get done(){return-2==this.ins}get len2(){return 0>this.ins?this.len:this.ins}get text(){let {inserted:V}=this.set,A=this.i-2>>1;return A>=V.length?Cb.empty:V[A]}textBit(V){let {inserted:A}=this.set,J=this.i-2>>1;return J>=A.length&&
!V?Cb.empty:A[J].slice(this.off,null==V?void 0:this.off+V)}forward(V){V==this.len?this.next():(this.len-=V,this.off+=V)}forward2(V){-1==this.ins?this.forward(V):V==this.ins?this.next():(this.ins-=V,this.off+=V)}},M=class V{constructor(A,J,W){this.from=A;this.to=J;this.flags=W}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let A=this.flags&
7;return 7==A?null:A}get goalColumn(){let A=this.flags>>6;return 16777215==A?void 0:A}map(A,J=-1){let W,ea;return this.empty?W=ea=A.mapPos(this.from,J):(W=A.mapPos(this.from,1),ea=A.mapPos(this.to,-1)),W==this.from&&ea==this.to?this:new V(W,ea,this.flags)}extend(A,J=A){return A<=this.anchor&&J>=this.anchor?Z.range(A,J):Z.range(this.anchor,Math.abs(A-this.anchor)>Math.abs(J-this.anchor)?A:J)}eq(A,J=!1){return this.anchor==A.anchor&&this.head==A.head&&(!J||!this.empty||this.assoc==A.assoc)}toJSON(){return{anchor:this.anchor,
head:this.head}}static fromJSON(A){if(!A||"number"!=typeof A.anchor||"number"!=typeof A.head)throw new RangeError("Invalid JSON representation for SelectionRange");return Z.range(A.anchor,A.head)}static create(A,J,W){return new V(A,J,W)}},Z=class V{constructor(A,J){this.ranges=A;this.mainIndex=J}map(A,J=-1){return A.empty?this:V.create(this.ranges.map(W=>W.map(A,J)),this.mainIndex)}eq(A,J=!1){if(this.ranges.length!=A.ranges.length||this.mainIndex!=A.mainIndex)return!1;for(let W=0;W<this.ranges.length;W++)if(!this.ranges[W].eq(A.ranges[W],
J))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new V([this.main],0)}addRange(A,J=!0){return V.create([A].concat(this.ranges),J?0:this.mainIndex+1)}replaceRange(A,J=this.mainIndex){let W=this.ranges.slice();return W[J]=A,V.create(W,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(A=>A.toJSON()),main:this.mainIndex}}static fromJSON(A){if(!A||!Array.isArray(A.ranges)||"number"!=typeof A.main||A.main>=A.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");
return new V(A.ranges.map(J=>M.fromJSON(J)),A.main)}static single(A,J=A){return new V([V.range(A,J)],0)}static create(A,J=0){if(0==A.length)throw new RangeError("A selection needs at least one range");for(let W=0,ea=0;ea<A.length;ea++){let qa=A[ea];if(qa.empty?qa.from<=W:qa.from<W)return V.normalized(A.slice(),J);W=qa.to}return new V(A,J)}static cursor(A,J=0,W,ea){return M.create(A,A,(0==J?0:0>J?8:16)|(null==W?7:Math.min(6,W))|(ea??16777215)<<6)}static range(A,J,W,ea){W=(W??16777215)<<6|(null==ea?
7:Math.min(6,ea));return J<A?M.create(J,A,48|W):M.create(A,J,(J>A?8:0)|W)}static normalized(A,J=0){J=A[J];A.sort((ea,qa)=>ea.from-qa.from);J=A.indexOf(J);for(let ea=1;ea<A.length;ea++){let qa=A[ea];var W=A[ea-1];if(qa.empty?qa.from<=W.to:qa.from<W.to){let za=W.from;W=Math.max(qa.to,W.to);ea<=J&&J--;A.splice(--ea,2,qa.anchor>qa.head?V.range(W,za):V.range(za,W))}}return new V(A,J)}},pa=0,Ja=class V{constructor(A,J,W,ea,qa){this.combine=A;this.compareInput=J;this.compare=W;this.isStatic=ea;this.id=pa++;
this.default=A([]);this.extensions="function"==typeof qa?qa(this):qa}get reader(){return this}static define(A={}){return new V(A.combine||(J=>J),A.compareInput||((J,W)=>J===W),A.compare||(A.combine?(J,W)=>J===W:ca),!!A.static,A.enables)}of(A){return new Sa([],this,0,A)}compute(A,J){if(this.isStatic)throw Error("Can't compute a static facet");return new Sa(A,this,1,J)}computeN(A,J){if(this.isStatic)throw Error("Can't compute a static facet");return new Sa(A,this,2,J)}from(A,J){return J||=W=>W,this.compute([A],
W=>J(W.field(A)))}},Sa=class{constructor(V,A,J,W){this.dependencies=V;this.facet=A;this.type=J;this.value=W;this.id=pa++}dynamicSlot(V){var A;let J=this.value,W=this.facet.compareInput,ea=this.id,qa=V[ea]>>1,za=2==this.type,Wa=!1,fb=!1,Ab=[];for(let Ib of this.dependencies)"doc"==Ib?Wa=!0:"selection"==Ib?fb=!0:0==((null!==(A=V[Ib.id])&&void 0!==A?A:1)&1)&&Ab.push(V[Ib.id]);return{create(Ib){return Ib.values[qa]=J(Ib),1},update(Ib,uc){if(Wa&&uc.docChanged||fb&&(uc.docChanged||uc.selection)||Da(Ib,
Ab))if(uc=J(Ib),za?!ha(uc,Ib.values[qa],W):!W(uc,Ib.values[qa]))return Ib.values[qa]=uc,1;return 0},reconfigure:(Ib,uc)=>{let xc;var R=uc.config.address[ea];if(null!=R){if(R=sa(uc,R),this.dependencies.every(U=>U instanceof Ja?uc.facet(U)===Ib.facet(U):U instanceof tb?uc.field(U,!1)==Ib.field(U,!1):!0)||(za?ha(xc=J(Ib),R,W):W(xc=J(Ib),R)))return Ib.values[qa]=R,0}else xc=J(Ib);return Ib.values[qa]=xc,1}}}},Za=Ja.define({static:!0}),tb=class V{constructor(A,J,W,ea,qa){this.id=A;this.createF=J;this.updateF=
W;this.compareF=ea;this.spec=qa;this.provides=void 0}static define(A){let J=new V(pa++,A.create,A.update,A.compare||((W,ea)=>W===ea),A);return A.provide&&(J.provides=A.provide(J)),J}create(A){return(A.facet(Za).find(J=>J.field==this)?.create||this.createF)(A)}slot(A){let J=A[this.id]>>1;return{create:W=>(W.values[J]=this.create(W),1),update:(W,ea)=>{let qa=W.values[J];ea=this.updateF(qa,ea);return this.compareF(qa,ea)?0:(W.values[J]=ea,1)},reconfigure:(W,ea)=>{let qa=W.facet(Za),za=ea.facet(Za),Wa;
return(Wa=qa.find(fb=>fb.field==this))&&Wa!=za.find(fb=>fb.field==this)?(W.values[J]=Wa.create(W),1):null!=ea.config.address[this.id]?(W.values[J]=ea.field(this),0):(W.values[J]=this.create(W),1)}}}init(A){return[this,Za.of({field:this,create:A})]}get extension(){return this}},Pb={lowest:4,low:3,default:2,high:1,highest:0},Jb={highest:ua(Pb.highest),high:ua(Pb.high),default:ua(Pb.default),low:ua(Pb.low),lowest:ua(Pb.lowest)},ec=class{constructor(V,A){this.inner=V;this.prec=A}},yc=class V{of(A){return new hc(this,
A)}reconfigure(A){return V.reconfigure.of({compartment:this,extension:A})}get(A){return A.config.compartments.get(this)}},hc=class{constructor(V,A){this.compartment=V;this.inner=A}},Fc=class V{constructor(A,J,W,ea,qa,za){this.base=A;this.compartments=J;this.dynamicSlots=W;this.address=ea;this.staticValues=qa;this.facets=za;for(this.statusTemplate=[];this.statusTemplate.length<W.length;)this.statusTemplate.push(0)}staticFacet(A){let J=this.address[A.id];return null==J?A.default:this.staticValues[J>>
1]}static resolve(A,J,W){var ea=[];let qa=Object.create(null),za=new Map;for(var Wa of Va(A,J,za))Wa instanceof tb?ea.push(Wa):(qa[Wa.facet.id]||(qa[Wa.facet.id]=[])).push(Wa);let fb=Object.create(null);J=[];Wa=[];for(let Ib of ea)fb[Ib.id]=Wa.length<<1,Wa.push(uc=>Ib.slot(uc));ea=W?.config.facets;for(let Ib in qa){let uc=qa[Ib],xc=uc[0].facet;var Ab=ea&&ea[Ib]||[];if(uc.every(R=>0==R.type))(fb[xc.id]=J.length<<1|1,ca(Ab,uc))?J.push(W.facet(xc)):(Ab=xc.combine(uc.map(R=>R.value)),J.push(W&&xc.compare(Ab,
W.facet(xc))?W.facet(xc):Ab));else{for(let R of uc)0==R.type?(fb[R.id]=J.length<<1|1,J.push(R.value)):(fb[R.id]=Wa.length<<1,Wa.push(U=>R.dynamicSlot(U)));fb[xc.id]=Wa.length<<1;Wa.push(R=>Fa(R,xc,uc))}}W=Wa.map(Ib=>Ib(fb));return new V(A,za,W,fb,J,qa)}},Ic=Ja.define(),Nc=Ja.define({combine:V=>V.some(A=>A),static:!0}),Dc=Ja.define({combine:V=>V.length?V[0]:void 0,static:!0}),cd=Ja.define(),jd=Ja.define(),wc=Ja.define(),zc=Ja.define({combine:V=>V.length?V[0]:!1}),da=class{constructor(V,A){this.type=
V;this.value=A}static define(){return new Ca}},Ca=class{of(V){return new da(this,V)}},Ea=class{constructor(V){this.map=V}of(V){return new Ta(this,V)}},Ta=class V{constructor(A,J){this.type=A;this.value=J}map(A){A=this.type.map(this.value,A);return void 0===A?void 0:A==this.value?this:new V(this.type,A)}is(A){return this.type==A}static define(A={}){return new Ea(A.map||(J=>J))}static mapEffects(A,J){if(!A.length)return A;let W=[];for(let ea of A)(A=ea.map(J))&&W.push(A);return W}};Ta.reconfigure=Ta.define();
Ta.appendConfig=Ta.define();var mb=class V{constructor(A,J,W,ea,qa,za){this.startState=A;this.changes=J;this.selection=W;this.effects=ea;this.annotations=qa;this.scrollIntoView=za;this._state=this._doc=null;W&&T(W,J.newLength);qa.some(Wa=>Wa.type==V.time)||(this.annotations=qa.concat(V.time.of(Date.now())))}static create(A,J,W,ea,qa,za){return new V(A,J,W,ea,qa,za)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||
this.startState.applyTransaction(this),this._state}annotation(A){for(let J of this.annotations)if(J.type==A)return J.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(A){let J=this.annotation(V.userEvent);return!(!J||!(J==A||J.length>A.length&&J.slice(0,A.length)==A&&"."==J[A.length]))}};mb.time=da.define();mb.userEvent=da.define();mb.addToHistory=da.define();mb.remote=da.define();var Fb=[];n.CharCategory=void 0;(function(V){V[V.Word=
0]="Word";V[V.Space=1]="Space";V[V.Other=2]="Other"})(n.CharCategory||(n.CharCategory={}));var Hb=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;try{var ic=RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}var Jc=class V{constructor(A,J,W,ea,qa,za){this.config=A;this.doc=J;this.selection=W;this.values=ea;this.status=A.statusTemplate.slice();this.computeSlot=qa;za&&(za._state=this);for(A=0;A<this.config.dynamicSlots.length;A++)Ha(this,A<<
1);this.computeSlot=null}field(A,J=!0){A=this.config.address[A.id];if(null==A){if(J)throw new RangeError("Field is not present in this state");}else return Ha(this,A),sa(this,A)}update(...A){return kb(this,A,!0)}applyTransaction(A){let J=this.config,{base:W,compartments:ea}=J;for(var qa of A.effects)qa.is(yc.reconfigure)?(J&&(ea=new Map,J.compartments.forEach((Wa,fb)=>ea.set(fb,Wa)),J=null),ea.set(qa.value.compartment,qa.value.extension)):qa.is(Ta.reconfigure)?(J=null,W=qa.value):qa.is(Ta.appendConfig)&&
(J=null,W=pb(W).concat(qa.value));let za;J?za=A.startState.values.slice():(J=Fc.resolve(W,ea,this),za=(new V(J,this.doc,this.selection,J.dynamicSlots.map(()=>null),(Wa,fb)=>fb.reconfigure(Wa,this),null)).values);qa=A.startState.facet(Nc)?A.newSelection:A.newSelection.asSingle();new V(J,A.newDoc,qa,za,(Wa,fb)=>fb.update(Wa,A),A)}replaceSelection(A){return"string"==typeof A&&(A=this.toText(A)),this.changeByRange(J=>({changes:{from:J.from,to:J.to,insert:A},range:Z.cursor(J.from+A.length)}))}changeByRange(A){let J=
this.selection;var W=A(J.ranges[0]);let ea=this.changes(W.changes),qa=[W.range];W=pb(W.effects);for(let Wa=1;Wa<J.ranges.length;Wa++){let fb=A(J.ranges[Wa]);var za=this.changes(fb.changes);let Ab=za.map(ea);for(let Ib=0;Ib<Wa;Ib++)qa[Ib]=qa[Ib].map(Ab);za=ea.mapDesc(za,!0);qa.push(fb.range.map(za));ea=ea.compose(Ab);W=Ta.mapEffects(W,Ab).concat(Ta.mapEffects(pb(fb.effects),za))}return{changes:ea,selection:Z.create(qa,J.mainIndex),effects:W}}changes(A=[]){return A instanceof ya?A:ya.of(A,this.doc.length,
this.facet(V.lineSeparator))}toText(A){return Cb.of(A.split(this.facet(V.lineSeparator)||db))}sliceDoc(A=0,J=this.doc.length){return this.doc.sliceString(A,J,this.lineBreak)}facet(A){let J=this.config.address[A.id];return null==J?A.default:(Ha(this,J),sa(this,J))}toJSON(A){let J={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(A)for(let W in A){let ea=A[W];ea instanceof tb&&null!=this.config.address[ea.id]&&(J[W]=ea.spec.toJSON(this.field(A[W]),this))}return J}static fromJSON(A,J={},W){if(!A||
"string"!=typeof A.doc)throw new RangeError("Invalid JSON representation for EditorState");let ea=[];if(W)for(let qa in W)if(Object.prototype.hasOwnProperty.call(A,qa)){let za=W[qa],Wa=A[qa];ea.push(za.init(fb=>za.spec.fromJSON(Wa,fb)))}return V.create({doc:A.doc,selection:Z.fromJSON(A.selection),extensions:J.extensions?ea.concat([J.extensions]):ea})}static create(A={}){let J=Fc.resolve(A.extensions||[],new Map),W=A.doc instanceof Cb?A.doc:Cb.of((A.doc||"").split(J.staticFacet(V.lineSeparator)||db));
A=A.selection?A.selection instanceof Z?A.selection:Z.single(A.selection.anchor,A.selection.head):Z.single(0);return T(A,W.length),J.staticFacet(Nc)||(A=A.asSingle()),new V(J,W,A,J.dynamicSlots.map(()=>null),(ea,qa)=>qa.create(ea),null)}get tabSize(){return this.facet(V.tabSize)}get lineBreak(){return this.facet(V.lineSeparator)||"\n"}get readOnly(){return this.facet(zc)}phrase(A,...J){for(let W of this.facet(V.phrases))if(Object.prototype.hasOwnProperty.call(W,A)){A=W[A];break}return J.length&&(A=
A.replace(/\$(\$|\d*)/g,(W,ea)=>{if("$"==ea)return"$";ea=+(ea||1);return!ea||ea>J.length?W:J[ea-1]})),A}languageDataAt(A,J,W=-1){let ea=[];for(let qa of this.facet(Ic))for(let za of qa(this,J,W))Object.prototype.hasOwnProperty.call(za,A)&&ea.push(za[A]);return ea}charCategorizer(A){return ib(this.languageDataAt("wordChars",A).join(""))}wordAt(A){let {text:J,from:W,length:ea}=this.doc.lineAt(A),qa=this.charCategorizer(A),za=A-W;for(A-=W;0<za;){var Wa=w(J,za,!1);if(qa(J.slice(Wa,za))!=n.CharCategory.Word)break;
za=Wa}for(;A<ea;){Wa=w(J,A);if(qa(J.slice(A,Wa))!=n.CharCategory.Word)break;A=Wa}return za==A?null:Z.range(za+W,A+W)}};Jc.allowMultipleSelections=Nc;Jc.tabSize=Ja.define({combine:V=>V.length?V[0]:4});Jc.lineSeparator=Dc;Jc.readOnly=zc;Jc.phrases=Ja.define({compare(V,A){let J=Object.keys(V),W=Object.keys(A);return J.length==W.length&&J.every(ea=>V[ea]==A[ea])}});Jc.languageData=Ic;Jc.changeFilter=cd;Jc.transactionFilter=jd;Jc.transactionExtender=wc;yc.reconfigure=Ta.define();var $c=class{eq(V){return this==
V}range(V,A=V){return Cc.create(V,A,this)}};$c.prototype.startSide=$c.prototype.endSide=0;$c.prototype.point=!1;$c.prototype.mapMode=n.MapMode.TrackDel;var Cc=class V{constructor(A,J,W){this.from=A;this.to=J;this.value=W}static create(A,J,W){return new V(A,J,W)}},Tc=class V{constructor(A,J,W,ea){this.from=A;this.to=J;this.value=W;this.maxPoint=ea}get length(){return this.to[this.to.length-1]}findIndex(A,J,W,ea=0){let qa=W?this.to:this.from;for(let za=ea,Wa=qa.length;;){if(za==Wa)return za;ea=za+Wa>>
1;let fb=qa[ea]-A||(W?this.value[ea].endSide:this.value[ea].startSide)-J;if(ea==za)return 0<=fb?za:Wa;0<=fb?Wa=ea:za=ea+1}}between(A,J,W,ea){for(let qa=this.findIndex(J,-1E9,!0),za=this.findIndex(W,1E9,!1,qa);qa<za;qa++)if(!1===ea(this.from[qa]+A,this.to[qa]+A,this.value[qa]))return!1}map(A,J){let W=[],ea=[],qa=[],za=-1,Wa=-1;for(let Ab=0;Ab<this.value.length;Ab++){let Ib=this.value[Ab],uc=this.from[Ab]+A;var fb=this.to[Ab]+A;let xc,R;if(uc==fb){if(fb=J.mapPos(uc,Ib.startSide,Ib.mapMode),null==fb||
(xc=R=fb,Ib.startSide!=Ib.endSide&&(R=J.mapPos(uc,Ib.endSide),R<xc)))continue}else if(xc=J.mapPos(uc,Ib.startSide),R=J.mapPos(fb,Ib.endSide),xc>R||xc==R&&0<Ib.startSide&&0>=Ib.endSide)continue;0>(R-xc||Ib.endSide-Ib.startSide)||(0>za&&(za=xc),Ib.point&&(Wa=Math.max(Wa,R-xc)),W.push(Ib),ea.push(xc-za),qa.push(R-za))}return{mapped:W.length?new V(ea,qa,W,Wa):null,pos:za}}},Vc=class V{constructor(A,J,W,ea){this.chunkPos=A;this.chunk=J;this.nextLayer=W;this.maxPoint=ea}static create(A,J,W,ea){return new V(A,
J,W,ea)}get length(){let A=this.chunk.length-1;return 0>A?0:Math.max(this.chunkEnd(A),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let A=this.nextLayer.size;for(let J of this.chunk)A+=J.value.length;return A}chunkEnd(A){return this.chunkPos[A]+this.chunk[A].length}update(A){let {add:J=[],sort:W=!1,filterFrom:ea=0,filterTo:qa=this.length}=A;A=A.filter;if(0==J.length&&!A)return this;if(W&&(J=J.slice().sort(zb)),this.isEmpty)return J.length?V.of(J):this;let za=(new wd(this,null,-1)).goto(0),
Wa=0,fb=[],Ab=new qd;for(;za.value||Wa<J.length;)if(Wa<J.length&&0<=(za.from-J[Wa].from||za.startSide-J[Wa].value.startSide)){let Ib=J[Wa++];Ab.addInner(Ib.from,Ib.to,Ib.value)||fb.push(Ib)}else 1==za.rangeIndex&&za.chunkIndex<this.chunk.length&&(Wa==J.length||this.chunkEnd(za.chunkIndex)<J[Wa].from)&&(!A||ea>this.chunkEnd(za.chunkIndex)||qa<this.chunkPos[za.chunkIndex])&&Ab.addChunk(this.chunkPos[za.chunkIndex],this.chunk[za.chunkIndex])?za.nextChunk():((!A||ea>za.to||qa<za.from||A(za.from,za.to,
za.value))&&(Ab.addInner(za.from,za.to,za.value)||fb.push(Cc.create(za.from,za.to,za.value))),za.next());return Ab.finishInner(this.nextLayer.isEmpty&&!fb.length?V.empty:this.nextLayer.update({add:fb,filter:A,filterFrom:ea,filterTo:qa}))}map(A){if(A.empty||this.isEmpty)return this;let J=[],W=[],ea=-1;for(let qa=0;qa<this.chunk.length;qa++){let za=this.chunkPos[qa],Wa=this.chunk[qa],fb=A.touchesRange(za,za+Wa.length);if(!1===fb)ea=Math.max(ea,Wa.maxPoint),J.push(Wa),W.push(A.mapPos(za));else if(!0===
fb){let {mapped:Ab,pos:Ib}=Wa.map(za,A);Ab&&(ea=Math.max(ea,Ab.maxPoint),J.push(Ab),W.push(Ib))}}A=this.nextLayer.map(A);return 0==J.length?A:new V(W,J,A||V.empty,ea)}between(A,J,W){if(!this.isEmpty){for(let ea=0;ea<this.chunk.length;ea++){let qa=this.chunkPos[ea],za=this.chunk[ea];if(J>=qa&&A<=qa+za.length&&!1===za.between(qa,A-qa,J-qa,W))return}this.nextLayer.between(A,J,W)}}iter(A=0){return Yc.from([this]).goto(A)}get isEmpty(){return this.nextLayer==this}static iter(A,J=0){return Yc.from(A).goto(J)}static compare(A,
J,W,ea,qa=-1){A=A.filter(Ab=>0<Ab.maxPoint||!Ab.isEmpty&&Ab.maxPoint>=qa);J=J.filter(Ab=>0<Ab.maxPoint||!Ab.isEmpty&&Ab.maxPoint>=qa);let za=qb(A,J,W),Wa=new nd(A,za,qa),fb=new nd(J,za,qa);W.iterGaps((Ab,Ib,uc)=>Xb(Wa,Ab,fb,Ib,uc,ea));W.empty&&0==W.length&&Xb(Wa,0,fb,0,0,ea)}static eq(A,J,W=0,ea){null==ea&&(ea=999999999);var qa=A.filter(fb=>!fb.isEmpty&&0>J.indexOf(fb));let za=J.filter(fb=>!fb.isEmpty&&0>A.indexOf(fb));if(qa.length!=za.length)return!1;if(!qa.length)return!0;let Wa=qb(qa,za);qa=(new nd(qa,
Wa,0)).goto(W);for(W=(new nd(za,Wa,0)).goto(W);;){if(qa.to!=W.to||!$b(qa.active,W.active)||qa.point&&(!W.point||!qa.point.eq(W.point)))return!1;if(qa.to>ea)return!0;qa.next();W.next()}}static spans(A,J,W,ea,qa=-1){A=(new nd(A,null,qa)).goto(J);qa=J;let za=A.openStart;for(;;){let Wa=Math.min(A.to,W);if(A.point){let fb=A.activeForPoint(A.to);ea.point(qa,Wa,A.point,fb,A.pointFrom<J?fb.length+1:0>A.point.startSide?fb.length:Math.min(fb.length,za),A.pointRank);za=Math.min(A.openEnd(Wa),fb.length)}else Wa>
qa&&(ea.span(qa,Wa,A.active,za),za=A.openEnd(Wa));if(A.to>W)return za+(A.point&&A.to>W?1:0);qa=A.to;A.next()}}static of(A,J=!1){let W=new qd;for(let ea of A instanceof Cc?[A]:J?gb(A):A)W.add(ea.from,ea.to,ea.value);return W.finish()}static join(A){if(!A.length)return V.empty;let J=A[A.length-1];for(let W=A.length-2;0<=W;W--)for(let ea=A[W];ea!=V.empty;ea=ea.nextLayer)J=new V(ea.chunkPos,ea.chunk,J,Math.max(ea.maxPoint,J.maxPoint));return J}};Vc.empty=new Vc([],[],null,-1);Vc.empty.nextLayer=Vc.empty;
var qd=class V{finishChunk(A){this.chunks.push(new Tc(this.from,this.to,this.value,this.maxPoint));this.chunkPos.push(this.chunkStart);this.chunkStart=-1;this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint);this.maxPoint=-1;A&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[];this.chunkPos=[];this.chunkStart=-1;this.last=null;this.lastTo=this.lastFrom=-1E9;this.from=[];this.to=[];this.value=[];this.setMaxPoint=this.maxPoint=-1;this.nextLayer=null}add(A,J,W){this.addInner(A,
J,W)||(this.nextLayer||(this.nextLayer=new V)).add(A,J,W)}addInner(A,J,W){let ea=A-this.lastTo||W.startSide-this.last.endSide;if(0>=ea&&0>(A-this.lastFrom||W.startSide-this.last.startSide))throw Error("Ranges must be added sorted by `from` position and `startSide`");return 0>ea?!1:(250==this.from.length&&this.finishChunk(!0),0>this.chunkStart&&(this.chunkStart=A),this.from.push(A-this.chunkStart),this.to.push(J-this.chunkStart),this.last=W,this.lastFrom=A,this.lastTo=J,this.value.push(W),W.point&&
(this.maxPoint=Math.max(this.maxPoint,J-A)),!0)}addChunk(A,J){if(0>(A-this.lastTo||J.value[0].startSide-this.last.endSide))return!1;this.from.length&&this.finishChunk(!0);this.setMaxPoint=Math.max(this.setMaxPoint,J.maxPoint);this.chunks.push(J);this.chunkPos.push(A);let W=J.value.length-1;return this.last=J.value[W],this.lastFrom=J.from[W]+A,this.lastTo=J.to[W]+A,!0}finish(){return this.finishInner(Vc.empty)}finishInner(A){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return A;
A=Vc.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(A):A,this.setMaxPoint);return this.from=null,A}},wd=class{constructor(V,A,J,W=0){this.layer=V;this.skip=A;this.minPoint=J;this.rank=W}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(V,A=-1E9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(V,A,!1),this}gotoInner(V,A,J){for(;this.chunkIndex<this.layer.chunk.length;){let W=this.layer.chunk[this.chunkIndex];
if(!(this.skip&&this.skip.has(W)||this.layer.chunkEnd(this.chunkIndex)<V||W.maxPoint<this.minPoint))break;this.chunkIndex++;J=!1}this.chunkIndex<this.layer.chunk.length&&(V=this.layer.chunk[this.chunkIndex].findIndex(V-this.layer.chunkPos[this.chunkIndex],A,!0),(!J||this.rangeIndex<V)&&this.setRangeIndex(V));this.next()}forward(V,A){0>(this.to-V||this.endSide-A)&&this.gotoInner(V,A,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1E9;this.value=null;break}else{let V=
this.layer.chunkPos[this.chunkIndex],A=this.layer.chunk[this.chunkIndex];if(this.from=V+A.from[this.rangeIndex],this.to=V+A.to[this.rangeIndex],this.value=A.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),0>this.minPoint||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(V){if(V==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;
this.rangeIndex=0}else this.rangeIndex=V}nextChunk(){this.chunkIndex++;this.rangeIndex=0;this.next()}compare(V){return this.from-V.from||this.startSide-V.startSide||this.rank-V.rank||this.to-V.to||this.endSide-V.endSide}},Yc=class V{constructor(A){this.heap=A}static from(A,J=null,W=-1){let ea=[];for(let qa=0;qa<A.length;qa++)for(let za=A[qa];!za.isEmpty;za=za.nextLayer)za.maxPoint>=W&&ea.push(new wd(za,J,W,qa));return 1==ea.length?ea[0]:new V(ea)}get startSide(){return this.value?this.value.startSide:
0}goto(A,J=-1E9){for(let W of this.heap)W.goto(A,J);for(A=this.heap.length>>1;0<=A;A--)Lb(this.heap,A);return this.next(),this}forward(A,J){for(var W of this.heap)W.forward(A,J);for(W=this.heap.length>>1;0<=W;W--)Lb(this.heap,W);0>(this.to-A||this.value.endSide-J)&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1E9,this.value=null,this.rank=-1;else{let A=this.heap[0];this.from=A.from;this.to=A.to;this.value=A.value;this.rank=A.rank;A.value&&A.next();Lb(this.heap,0)}}},nd=class{constructor(V,
A,J){this.minPoint=J;this.active=[];this.activeTo=[];this.activeRank=[];this.minActive=-1;this.point=null;this.pointRank=this.pointFrom=0;this.to=-1E9;this.endSide=0;this.openStart=-1;this.cursor=Yc.from(V,A,J)}goto(V,A=-1E9){return this.cursor.goto(V,A),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=V,this.endSide=A,this.openStart=-1,this.next(),this}forward(V,A){for(;-1<this.minActive&&0>(this.activeTo[this.minActive]-V||this.active[this.minActive].endSide-
A);)this.removeActive(this.minActive);this.cursor.forward(V,A)}removeActive(V){pc(this.active,V);pc(this.activeTo,V);pc(this.activeRank,V);this.minActive=Bb(this.active,this.activeTo)}addActive(V){let A=0,{value:J,to:W,rank:ea}=this.cursor;for(;A<this.activeRank.length&&0<(ea-this.activeRank[A]||W-this.activeTo[A]);)A++;yb(this.active,A,J);yb(this.activeTo,A,W);yb(this.activeRank,A,ea);V&&yb(V,A,this.cursor.from);this.minActive=Bb(this.active,this.activeTo)}next(){let V=this.to;var A=this.point;this.point=
null;let J=0>this.openStart?[]:null;for(;;){var W=this.minActive;if(-1<W&&0>(this.activeTo[W]-this.cursor.from||this.active[W].endSide-this.cursor.startSide)){if(this.activeTo[W]>V){this.to=this.activeTo[W];this.endSide=this.active[W].endSide;break}this.removeActive(W);J&&pc(J,W)}else if(this.cursor.value)if(this.cursor.from>V){this.to=this.cursor.from;this.endSide=this.cursor.startSide;break}else if(W=this.cursor.value,W.point)if(A&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();
else{this.point=W;this.pointFrom=this.cursor.from;this.pointRank=this.cursor.rank;this.to=this.cursor.to;this.endSide=W.endSide;this.cursor.next();this.forward(this.to,this.endSide);break}else this.addActive(J),this.cursor.next();else{this.to=this.endSide=1E9;break}}if(J)for(this.openStart=0,A=J.length-1;0<=A&&J[A]<V;A--)this.openStart++}activeForPoint(V){if(!this.active.length)return this.active;let A=[];for(let J=this.active.length-1;0<=J&&!(this.activeRank[J]<this.pointRank);J--)(this.activeTo[J]>
V||this.activeTo[J]==V&&this.active[J].endSide>=this.point.endSide)&&A.push(this.active[J]);return A.reverse()}openEnd(V){let A=0;for(let J=this.activeTo.length-1;0<=J&&this.activeTo[J]>V;J--)A++;return A}};n.Annotation=da;n.AnnotationType=Ca;n.ChangeDesc=oa;n.ChangeSet=ya;n.Compartment=yc;n.EditorSelection=Z;n.EditorState=Jc;n.Facet=Ja;n.Line=bb;n.Prec=Jb;n.Range=Cc;n.RangeSet=Vc;n.RangeSetBuilder=qd;n.RangeValue=$c;n.SelectionRange=M;n.StateEffect=Ta;n.StateEffectType=Ea;n.StateField=tb;n.Text=
Cb;n.Transaction=mb;n.codePointAt=function(V,A){let J=V.charCodeAt(A);if(!(55296<=J&&56320>J)||A+1==V.length)return J;V=V.charCodeAt(A+1);return 56320<=V&&57344>V?(J-55296<<10)+(V-56320)+65536:J};n.codePointSize=function(V){return 65536>V?1:2};n.combineConfig=function(V,A,J={}){let W={};for(let ea of V)for(let qa of Object.keys(ea)){V=ea[qa];let za=W[qa];if(void 0===za)W[qa]=V;else if(za!==V&&void 0!==V)if(Object.hasOwnProperty.call(J,qa))W[qa]=J[qa](za,V);else throw Error("Config merge conflict for field "+
qa);}for(let ea in A)void 0===W[ea]&&(W[ea]=A[ea]);return W};n.countColumn=function(V,A,J=V.length){let W=0;for(let ea=0;ea<J&&ea<V.length;)9==V.charCodeAt(ea)?(W+=A-W%A,ea++):(W++,ea=w(V,ea));return W};n.findClusterBreak=w;n.findColumn=function(V,A,J,W){for(let ea=0,qa=0;;){if(qa>=A)return ea;if(ea==V.length)break;qa+=9==V.charCodeAt(ea)?J-qa%J:1;ea=w(V,ea)}return!0===W?-1:V.length};n.fromCodePoint=function(V){return 65535>=V?String.fromCharCode(V):(V-=65536,String.fromCharCode((V>>10)+55296,(V&
1023)+56320))}}),am=va(n=>{var p="u"<typeof Symbol?"__\u037c":Symbol.for("\u037c"),q="u"<typeof Symbol?"__styleSet"+Math.floor(1E8*Math.random()):Symbol("styleSet"),u="u">typeof globalThis?globalThis:"u">typeof window?window:{};n=n.StyleModule=function(B,z){function E(ha){return/^@/.test(ha)?[ha]:ha.split(/,\s*/)}function H(ha,Da,Fa,ua){var Va=[],Ha=/^@(\w+)\b/.exec(ha[0]),sa=Ha&&"keyframes"==Ha[1];if(Ha&&null==Da)return Fa.push(ha[0]+";");for(var Na in Da){var Qa=Da[Na];if(/&/.test(Na))H(Na.split(/,\s*/).map(function(kb){return ha.map(function(pb){return kb.replace(/&/,
pb)})}).reduce(function(kb,pb){return kb.concat(pb)}),Qa,Fa);else if(Qa&&"object"==typeof Qa){if(!Ha)throw new RangeError("The value of a property ("+Na+") should be a primitive value.");H(E(Na),Qa,Va,sa)}else null!=Qa&&Va.push(Na.replace(/_.*/,"").replace(/[A-Z]/g,function(kb){return"-"+kb.toLowerCase()})+": "+Qa+";")}(Va.length||sa)&&Fa.push((!T||Ha||ua?ha:ha.map(T)).join(", ")+" {"+Va.join(" ")+"}")}this.rules=[];var T=(z||{}).finish,ca;for(ca in B)H(E(ca),B[ca],this.rules)};n.prototype.getRules=
function(){return this.rules.join("\n")};n.newName=function(){var B=u[p]||1;return u[p]=B+1,"\u037c"+B.toString(36)};n.mount=function(B,z,E){var H=B[q];E=E&&E.nonce;H?E&&H.setNonce(E):H=new y(B,E);H.mount(Array.isArray(z)?z:[z],B)};var w=new Map,y=function(B,z){var E=B.ownerDocument||B,H=E.defaultView;if(!B.head&&B.adoptedStyleSheets&&H.CSSStyleSheet){if(z=w.get(E))return B[q]=z;this.sheet=new H.CSSStyleSheet;w.set(E,this)}else this.styleTag=E.createElement("style"),z&&this.styleTag.setAttribute("nonce",
z);this.modules=[];B[q]=this};y.prototype.mount=function(B,z){for(var E=this.sheet,H=0,T=0,ca=0;ca<B.length;ca++){var ha=B[ca],Da=this.modules.indexOf(ha);if(Da<T&&-1<Da&&(this.modules.splice(Da,1),T--,Da=-1),-1==Da){if(this.modules.splice(T++,0,ha),E)for(Da=0;Da<ha.rules.length;Da++)E.insertRule(ha.rules[Da],H++)}else{for(;T<Da;)H+=this.modules[T++].rules.length;H+=ha.rules.length;T++}}if(E)0>z.adoptedStyleSheets.indexOf(this.sheet)&&(z.adoptedStyleSheets=[this.sheet].concat(z.adoptedStyleSheets));
else{B="";for(E=0;E<this.modules.length;E++)B+=this.modules[E].getRules()+"\n";this.styleTag.textContent=B;z=z.head||z;this.styleTag.parentNode!=z&&z.insertBefore(this.styleTag,z.firstChild)}};y.prototype.setNonce=function(B){this.styleTag&&this.styleTag.getAttribute("nonce")!=B&&this.styleTag.setAttribute("nonce",B)}}),Op=va(n=>{Object.defineProperty(n,"__esModule",{value:!0});var p={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",
32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},q={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",
57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},u="u">typeof navigator&&/Mac/.test(navigator.platform),w="u">typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(y=0;10>y;y++)p[48+y]=p[96+y]=String(y);var y;for(y=1;24>=y;y++)p[y+111]="F"+y;for(y=65;90>=y;y++)p[y]=String.fromCharCode(y+32),q[y]=String.fromCharCode(y);for(B in p)q.hasOwnProperty(B)||(q[B]=p[B]);var B;n.base=p;n.keyName=function(z){z=
!(u&&z.metaKey&&z.shiftKey&&!z.ctrlKey&&!z.altKey||w&&z.shiftKey&&z.key&&1==z.key.length||"Unidentified"==z.key)&&z.key||(z.shiftKey?q:p)[z.keyCode]||z.key||"Unidentified";return"Esc"==z&&(z="Escape"),"Del"==z&&(z="Delete"),"Left"==z&&(z="ArrowLeft"),"Up"==z&&(z="ArrowUp"),"Right"==z&&(z="ArrowRight"),"Down"==z&&(z="ArrowDown"),z};n.shift=q}),Gg=va(n=>{function p(g){let e;return 11==g.nodeType?e=g.getSelection?g:g.ownerDocument:e=g,e.getSelection()}function q(g,e){return e?g==e||g.contains(1!=e.nodeType?
e.parentNode:e):!1}function u(g,e){if(!e.anchorNode)return!1;try{return q(g,e.anchorNode)}catch{return!1}}function w(g){return 3==g.nodeType?Fa(g,0,g.nodeValue.length).getClientRects():1==g.nodeType?g.getClientRects():[]}function y(g,e,k,r){return k?E(g,e,k,r,-1)||E(g,e,k,r,1):!1}function B(g){for(var e=0;;e++)if(g=g.previousSibling,!g)return e}function z(g){return 1==g.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(g.nodeName)}function E(g,e,k,r,x){for(;;){if(g==k&&e==r)return!0;
if(e==(0>x?0:H(g))){if("DIV"==g.nodeName)return!1;let G=g.parentNode;if(!G||1!=G.nodeType)return!1;e=B(g)+(0>x?0:1);g=G}else if(1==g.nodeType){if(g=g.childNodes[e+(0>x?-1:0)],1==g.nodeType&&"false"==g.contentEditable)return!1;e=0>x?H(g):0}else return!1}}function H(g){return 3==g.nodeType?g.nodeValue.length:g.childNodes.length}function T(g,e){e=e?g.left:g.right;return{left:e,right:e,top:g.top,bottom:g.bottom}}function ca(g,e){let k=e.width/g.offsetWidth,r=e.height/g.offsetHeight;return(.995<k&&1.005>
k||!isFinite(k)||1>Math.abs(e.width-g.offsetWidth))&&(k=1),(.995<r&&1.005>r||!isFinite(r)||1>Math.abs(e.height-g.offsetHeight))&&(r=1),{scaleX:k,scaleY:r}}function ha(g){let e=g.ownerDocument,k,r;for(g=g.parentNode;g&&!(g==e.body||k&&r);)if(1==g.nodeType)!r&&g.scrollHeight>g.clientHeight&&(r=g),!k&&g.scrollWidth>g.clientWidth&&(k=g),g=g.assignedSlot||g.parentNode;else if(11==g.nodeType)g=g.host;else break;return{x:k,y:r}}function Da(g){if(g.setActive)return g.setActive();if(Ud)return g.focus(Ud);
let e=[];for(var k=g;k&&(e.push(k,k.scrollTop,k.scrollLeft),k!=k.ownerDocument);k=k.parentNode);if(g.focus(null==Ud?{get preventScroll(){return Ud={preventScroll:!0},!0}}:void 0),!Ud)for(Ud=!1,g=0;g<e.length;){k=e[g++];let r=e[g++],x=e[g++];k.scrollTop!=r&&(k.scrollTop=r);k.scrollLeft!=x&&(k.scrollLeft=x)}}function Fa(g,e,k=e){let r=Hf||=document.createRange();return r.setEnd(g,k),r.setStart(g,e),r}function ua(g,e,k,r){e={key:e,code:e,keyCode:k,which:k,cancelable:!0};r&&({altKey:e.altKey,ctrlKey:e.ctrlKey,
shiftKey:e.shiftKey,metaKey:e.metaKey}=r);r=new KeyboardEvent("keydown",e);r.synthetic=!0;g.dispatchEvent(r);e=new KeyboardEvent("keyup",e);return e.synthetic=!0,g.dispatchEvent(e),r.defaultPrevented||e.defaultPrevented}function Va(g){for(;g;){if(g&&(9==g.nodeType||11==g.nodeType&&g.host))return g;g=g.assignedSlot||g.parentNode}return null}function Ha(g){for(;g.attributes.length;)g.removeAttributeNode(g.attributes[0])}function sa(g){return g.scrollTop>Math.max(1,g.scrollHeight-g.clientHeight-4)}function Na(g,
e){for(let k=g,r=e;;){if(3==k.nodeType&&0<r)return{node:k,offset:r};if(1==k.nodeType&&0<r){if("false"==k.contentEditable)return null;k=k.childNodes[r-1];r=H(k)}else if(k.parentNode&&!z(k))r=B(k),k=k.parentNode;else return null}}function Qa(g,e){for(let k=g,r=e;;){if(3==k.nodeType&&r<k.nodeValue.length)return{node:k,offset:r};if(1==k.nodeType&&r<k.childNodes.length){if("false"==k.contentEditable)return null;k=k.childNodes[r];r=0}else if(k.parentNode&&!z(k))r=B(k)+1,k=k.parentNode;else return null}}
function kb(g){let e=g.nextSibling;return g.parentNode.removeChild(g),e}function pb(g,e,k,r,x,G,Q,aa,fa){let {children:ra}=g,Aa=ra.length?ra[e]:null,Oa=G.length?G[G.length-1]:null,Ka=Oa?Oa.breakAfter:Q;if(!(e==r&&Aa&&!Q&&!Ka&&2>G.length&&Aa.merge(k,x,G.length?Oa:null,0==k,aa,fa))){if(r<ra.length){let Ra=ra[r];Ra&&(x<Ra.length||Ra.breakAfter&&Oa?.breakAfter)?(e==r&&(Ra=Ra.split(x),x=0),!Ka&&Oa&&Ra.merge(0,x,Oa,!0,0,fa)?G[G.length-1]=Ra:((x||Ra.children.length&&!Ra.children[0].length)&&Ra.merge(0,x,
null,!1,0,fa),G.push(Ra))):Ra?.breakAfter&&(Oa?Oa.breakAfter=1:Q=1);r++}for(Aa&&(Aa.breakAfter=Q,0<k&&(!Q&&G.length&&Aa.merge(k,Aa.length,G[0],!1,aa,0)?Aa.breakAfter=G.shift().breakAfter:(k<Aa.length||Aa.children.length&&0==Aa.children[Aa.children.length-1].length)&&Aa.merge(k,Aa.length,null,!1,aa,0),e++));e<r&&G.length;)if(ra[r-1].become(G[G.length-1]))r--,G.pop(),fa=G.length?0:aa;else if(ra[e].become(G[0]))e++,G.shift(),aa=G.length?0:fa;else break;!G.length&&e&&r<ra.length&&!ra[e-1].breakAfter&&
ra[r].merge(0,0,ra[e-1],!1,aa,fa)&&e--;(e<r||G.length)&&g.replaceChildren(e,r,G)}}function ib(g,e,k,r,x,G){let Q=g.childCursor(),{i:aa,off:fa}=Q.findPos(k,1),{i:ra,off:Aa}=Q.findPos(e,-1);e-=k;for(let Oa of r)e+=Oa.length;g.length+=e;pb(g,ra,Aa,aa,fa,r,0,x,G)}function zb(g,e,k){let r=g.nodeValue.length;e>r&&(e=r);let x=e,G=e,Q=0;0==e&&0>k||e==r&&0<=k?mc.chrome||mc.gecko||(e?(x--,Q=1):G<r&&(G++,Q=-1)):0>k?x--:G<r&&G++;g=Fa(g,x,G).getClientRects();if(!g.length)return null;k=g[(Q?0>Q:0<=k)?0:g.length-
1];return mc.safari&&!Q&&0==k.width&&(k=Array.prototype.find.call(g,aa=>aa.width)||k),Q?T(k,0>Q):k||null}function gb(g,e){let k=g.dom;({children:g}=g);var r=0;for(var x=0;r<g.length;r++){let G=g[r],Q=x+G.length;if(!(Q==x&&0>=G.getSide())){if(e>x&&e<Q&&G.dom.parentNode==k)return G.domAtPos(e-x);if(e<=x)break;x=Q}}for(e=r;0<e;e--)if(x=g[e-1],x.dom.parentNode==k)return x.domAtPos(x.length);for(;r<g.length;r++)if(e=g[r],e.dom.parentNode==k)return e.domAtPos(0);return new rd(k,0)}function qb(g,e,k){let r,
{children:x}=g;0<k&&e instanceof Ze&&x.length&&(r=x[x.length-1])instanceof Ze&&r.mark.eq(e.mark)?qb(r,e.children[0],k-1):(x.push(e),e.setParent(g));g.length+=e.length}function Lb(g,e,k){function r(fa,ra){for(let Ka=0,Ra=0;Ka<fa.children.length&&Ra<=ra;Ka++){let nb=fa.children[Ka],xb=Ra+nb.length;if(xb>=ra)if(nb.children.length)r(nb,ra-Ra);else{var Aa;if(!(Aa=!Q)&&(Aa=Q.isHidden)&&!(Aa=0<k)){var Oa=nb;Aa=Q.coordsAt(0,1);Oa=Oa.coordsAt(0,1);Aa=Aa&&Oa&&Oa.top<Aa.bottom}Aa&&(xb>ra||Ra==xb&&0<nb.getSide())?
(Q=nb,aa=ra-Ra):(Ra<ra||Ra==xb&&0>nb.getSide()&&!nb.isHidden)&&(x=nb,G=ra-Ra)}Ra=xb}}let x=null,G=-1,Q=null,aa=-1;r(g,e);return(e=(0>k?x:Q)||x||Q)?e.coordsAt(Math.max(0,e==x?G:aa),k):Xb(g)}function Xb(g){let e=g.dom.lastChild;if(!e)return g.dom.getBoundingClientRect();g=w(e);return g[g.length-1]||null}function $b(g,e){for(let k in g)"class"==k&&e.class?e.class+=" "+g.class:"style"==k&&e.style?e.style+=";"+g.style:e[k]=g[k];return e}function pc(g,e,k){if(g==e)return!0;g||=ka;e||=ka;let r=Object.keys(g),
x=Object.keys(e);if(r.length-(k&&-1<r.indexOf(k)?1:0)!=x.length-(k&&-1<x.indexOf(k)?1:0))return!1;for(let G of r)if(G!=k&&(-1==x.indexOf(G)||g[G]!==e[G]))return!1;return!0}function yb(g,e,k){let r=!1;if(e)for(let x in e)k&&x in k||(r=!0,"style"==x?g.style.cssText="":g.removeAttribute(x));if(k)for(let x in k)e&&e[x]==k[x]||(r=!0,"style"==x?g.style.cssText=k[x]:g.setAttribute(x,k[x]));return r}function Bb(g,e=!1){let {inclusiveStart:k,inclusiveEnd:r}=g;return null==k&&(k=g.inclusive),null==r&&(r=g.inclusive),
{start:k??e,end:r??e}}function Db(g,e,k,r=0){let x=k.length-1;0<=x&&k[x]+r>=g?k[x]=Math.max(k[x],e):k.push(g,e)}function Cb(g,e){for(let k of e)g=new Ze(k,[g],g.length);return g}function sb(g){let e=[];for(let k=0;k<g.length;k++)e.push(1<<+g[k]);return e}function Sb(g){return 247>=g?If[g]:1424<=g&&1524>=g?2:1536<=g&&1785>=g?Jf[g-1536]:1774<=g&&2220>=g?4:8192<=g&&8204>=g?256:64336<=g&&65023>=g?4:1}function lc(g,e){if(g.length!=e.length)return!1;for(let k=0;k<g.length;k++){let r=g[k],x=e[k];if(r.from!=
x.from||r.to!=x.to||r.direction!=x.direction||!lc(r.inner,x.inner))return!1}return!0}function qc(g,e,k,r,x,G,Q){let aa=r%2?2:1;if(r%2==x%2)for(let Ra=e,nb=0;Ra<k;){e=!0;var fa=!1;if(nb==G.length||Ra<G[nb].from){var ra=Gc[Ra];ra!=aa&&(e=!1,fa=16==ra)}ra=e||1!=aa?null:[];var Aa=e?r:r+1,Oa=Ra;a:for(;;)if(nb<G.length&&Oa==G[nb].from){if(fa)break a;var Ka=G[nb];if(!e)for(let xb=Ka.to,Rb=nb+1;;){if(xb==k)break a;if(Rb<G.length&&G[Rb].from==xb)xb=G[Rb++].to;else{if(Gc[xb]==aa)break a;break}}(nb++,ra)?ra.push(Ka):
(Ka.from>Ra&&Q.push(new rc(Ra,Ka.from,Aa)),oc(g,Ka.direction==Uc!=!(Aa%2)?r+1:r,x,Ka.inner,Ka.from,Ka.to,Q),Ra=Ka.to);Oa=Ka.to}else{if(Oa==k||(e?Gc[Oa]!=aa:Gc[Oa]==aa))break;Oa++}ra?qc(g,Ra,Oa,r+1,x,ra,Q):Ra<Oa&&Q.push(new rc(Ra,Oa,Aa));Ra=Oa}else for(let Ra=k,nb=G.length;Ra>e;){k=!0;fa=!1;if(!nb||Ra>G[nb-1].to)ra=Gc[Ra-1],ra!=aa&&(k=!1,fa=16==ra);ra=k||1!=aa?null:[];Aa=k?r:r+1;Oa=Ra;a:for(;;)if(nb&&Oa==G[nb-1].to){if(fa)break a;Ka=G[--nb];if(!k)for(let xb=Ka.from,Rb=nb;;){if(xb==e)break a;if(Rb&&
G[Rb-1].to==xb)xb=G[--Rb].from;else{if(Gc[xb-1]==aa)break a;break}}ra?ra.push(Ka):(Ka.to<Ra&&Q.push(new rc(Ka.to,Ra,Aa)),oc(g,Ka.direction==Uc!=!(Aa%2)?r+1:r,x,Ka.inner,Ka.from,Ka.to,Q),Ra=Ka.from);Oa=Ka.from}else{if(Oa==e||(k?Gc[Oa-1]!=aa:Gc[Oa-1]==aa))break;Oa--}ra?qc(g,Oa,Ra,r+1,x,ra,Q):Oa<Ra&&Q.push(new rc(Oa,Ra,Aa));Ra=Oa}}function oc(g,e,k,r,x,G,Q){let aa=e%2?2:1;for(var fa=0;fa<=r.length;fa++){var ra=fa?r[fa-1].to:x,Aa=fa<r.length?r[fa].from:G,Oa=fa?256:aa;for(let Ra=ra,nb=Oa,xb=Oa;Ra<Aa;Ra++){var Ka=
Sb(g.charCodeAt(Ra));512==Ka?Ka=nb:8==Ka&&4==xb&&(Ka=16);Gc[Ra]=4==Ka?2:Ka;Ka&7&&(xb=Ka);nb=Ka}for(let Ra=ra,nb=Oa,xb=Oa;Ra<Aa;Ra++){ra=Gc[Ra];if(128==ra)Ra<Aa-1&&nb==Gc[Ra+1]&&nb&24?ra=Gc[Ra]=nb:Gc[Ra]=256;else if(64==ra){for(Oa=Ra+1;Oa<Aa&&64==Gc[Oa];)Oa++;Ka=Ra&&8==nb||Oa<G&&8==Gc[Oa]?1==xb?1:8:256;for(let Rb=Ra;Rb<Oa;Rb++)Gc[Rb]=Ka;Ra=Oa-1}else 8==ra&&1==xb&&(Gc[Ra]=1);nb=ra;ra&7&&(xb=ra)}}fa=1==aa?2:1;for(let Ra=0,nb=0,xb=0;Ra<=r.length;Ra++){ra=Ra?r[Ra-1].to:x;Aa=Ra<r.length?r[Ra].from:G;for(let Rb=
ra,fc,dd,bd;Rb<Aa;Rb++)if(dd=Nh[fc=g.charCodeAt(Rb)])if(0>dd)for(ra=nb-3;0<=ra;ra-=3){if(se[ra+1]==-dd){Oa=se[ra+2];(Oa=Oa&2?aa:Oa&4?Oa&1?fa:aa:0)&&(Gc[Rb]=Gc[se[ra]]=Oa);nb=ra;break}}else{if(189==se.length)break;se[nb++]=Rb;se[nb++]=fc;se[nb++]=xb}else if(2==(bd=Gc[Rb])||1==bd)for(xb=(ra=bd==aa)?0:1,Oa=nb-3;0<=Oa;Oa-=3){Ka=se[Oa+2];if(Ka&2)break;if(ra)se[Oa+2]|=2;else{if(Ka&4)break;se[Oa+2]|=4}}}for(let Ra=0,nb=aa;Ra<=r.length;Ra++)for(Aa=Ra?r[Ra-1].to:x,fa=Ra<r.length?r[Ra].from:G;Aa<fa;)if(ra=
Gc[Aa],256==ra){for(ra=Aa+1;;)if(ra==fa){if(Ra==r.length)break;ra=r[Ra++].to;fa=Ra<r.length?r[Ra].from:G}else if(256==Gc[ra])ra++;else break;Oa=1==nb;Oa=Oa==(1==(ra<G?Gc[ra]:aa))?Oa?1:2:aa;for(let xb=ra,Rb=Ra,fc=Rb?r[Rb-1].to:x;xb>Aa;)xb==fc&&(xb=r[--Rb].from,fc=Rb?r[Rb-1].to:x),Gc[--xb]=Oa;Aa=ra}else nb=ra,Aa++;qc(g,x,G,e,k,r,Q)}function bb(g,e,k){if(!g)return[new rc(0,0,e==ge?1:0)];if(e==Uc&&!k.length&&!$e.test(g))return[new rc(0,g.length,0)];if(k.length)for(;g.length>Gc.length;)Gc[Gc.length]=256;
let r=[];e=e==Uc?0:1;return oc(g,e,e,k,0,g.length,r),r}function db(g,e,k,r,x){var G,Q=r.head-g.from;let aa=rc.find(e,Q,null!==(G=r.bidiLevel)&&void 0!==G?G:-1,r.assoc);r=e[aa];G=r.side(x,k);if(Q==G){Q=aa+(x?1:-1);if(0>Q||Q>=e.length)return null;r=e[aa=Q];Q=r.side(!x,k);G=r.side(x,k)}let fa=$a.findClusterBreak(g.text,Q,r.forward(x,k));(fa<r.from||fa>r.to)&&(fa=G);kd=g.text.slice(Math.min(Q,fa),Math.max(Q,fa));return(e=aa==(x?e.length-1:0)?null:e[aa+(x?1:-1)])&&fa==G&&e.level+(x?0:1)<r.level?$a.EditorSelection.cursor(e.side(!x,
k)+g.from,e.forward(x,k)?1:-1,e.level):$a.EditorSelection.cursor(fa+g.from,r.forward(x,k)?-1:1,r.level)}function oa(g,e,k){g=g.facet(ig);g.length?g[0](e):window.onerror?window.onerror(String(e),k,void 0,void 0,e):k?console.error(k+":",e):console.error(e)}function ya(g,e){var k=g.state.facet(Oh);if(!k.length)return k;k=k.map(x=>x instanceof Function?x(g):x);let r=[];return $a.RangeSet.spans(k,e.from,e.to,{point(){},span(x,G,Q,aa){x-=e.from;G-=e.from;let fa=r;for(let Ka=Q.length-1;0<=Ka;Ka--,aa--){var ra=
Q[Ka].spec.bidiIsolate;let Ra;if(null==ra)a:{ra=e.text;for(var Aa=x,Oa=G;Aa<Oa;Aa++){let nb=Sb(ra.charCodeAt(Aa));if(1==nb){ra=Uc;break a}if(2==nb||4==nb){ra=ge;break a}}ra=Uc}0<aa&&fa.length&&(Ra=fa[fa.length-1]).to==x&&Ra.direction==ra?(Ra.to=G,fa=Ra.inner):(ra={from:x,to:G,direction:ra,inner:[]},fa.push(ra),fa=ra.inner)}}}),r}function N(g){let e=0,k=0,r=0,x=0;for(let G of g.state.facet(Xg)){let Q=G(g);Q&&(null!=Q.left&&(e=Math.max(e,Q.left)),null!=Q.right&&(k=Math.max(k,Q.right)),null!=Q.top&&
(r=Math.max(r,Q.top)),null!=Q.bottom&&(x=Math.max(x,Q.bottom)))}return{left:e,right:k,top:r,bottom:x}}function M(g,e){var k=g.observer.selectionRange;if(!k.focusNode)return null;let r=Na(k.focusNode,k.focusOffset),x=Qa(k.focusNode,k.focusOffset);k=r||x;if(x&&r&&x.node!=r.node){var G=od.get(x.node);!G||G instanceof xe&&G.text!=x.node.nodeValue?k=x:g.docView.lastCompositionAfterCursor&&(G=od.get(r.node),!G||G instanceof xe&&G.text!=r.node.nodeValue||(k=x))}if(g.docView.lastCompositionAfterCursor=k!=
r,!k)return null;g=e-k.offset;return{from:g,to:g+k.node.nodeValue.length,node:k.node}}function Z(g,e,k){k=M(g,k);if(!k)return null;let {node:r,from:x,to:G}=k;var Q=r.nodeValue;if(/[\n\r]/.test(Q)||g.state.doc.sliceString(k.from,k.to)!=Q)return null;e=e.invertedDesc;e=new ye(e.mapPos(x),e.mapPos(G),x,G);k=[];for(Q=r.parentNode;;Q=Q.parentNode){var aa=od.get(Q);if(aa instanceof Ze)k.push({node:Q,deco:aa.mark});else{if(aa instanceof Gb||"DIV"==Q.nodeName&&Q.parentNode==g.contentDOM)return{range:e,text:r,
marks:k,line:Q};if(Q!=g.contentDOM){aa=k;var fa=aa.push,ra=Q,Aa=Pa,Oa=Q;let Ka=Object.create(null);for(let Ra=0;Ra<Oa.attributes.length;Ra++){let nb=Oa.attributes[Ra];Ka[nb.name]=nb.value}fa.call(aa,{node:ra,deco:new Aa({inclusive:!0,attributes:Ka,tagName:Q.tagName.toLowerCase()})})}else return null}}}function pa(g,e,k){let r=new xi;return $a.RangeSet.compare(g,e,k,r),r.changes}function Ja(g,e){let k=!1;return e&&g.iterChangedRanges((r,x)=>{r<e.to&&x>e.from&&(k=!0)}),k}function Sa(g,e,k=1){let r=
g.charCategorizer(e);g=g.doc.lineAt(e);var x=e-g.from;if(0==g.length)return $a.EditorSelection.cursor(e);0==x?k=1:x==g.length&&(k=-1);let G=e=x;0>k?e=$a.findClusterBreak(g.text,x,!1):G=$a.findClusterBreak(g.text,x);for(k=r(g.text.slice(e,G));0<e;){x=$a.findClusterBreak(g.text,e,!1);if(r(g.text.slice(x,e))!=k)break;e=x}for(;G<g.length;){x=$a.findClusterBreak(g.text,G);if(r(g.text.slice(G,x))!=k)break;G=x}return $a.EditorSelection.range(e+g.from,G+g.from)}function Za(g,e){return g.top<e.bottom-1&&g.bottom>
e.top+1}function tb(g,e){return e<g.top?{top:e,left:g.left,right:g.right,bottom:g.bottom}:g}function Pb(g,e){return e>g.bottom?{top:g.top,left:g.left,right:g.right,bottom:e}:g}function Jb(g,e,k){let r,x;let G;var Q=!1;let aa,fa,ra,Aa;for(let Ka=g.firstChild;Ka;Ka=Ka.nextSibling){let Ra=w(Ka);for(let nb=0;nb<Ra.length;nb++){let xb=Ra[nb];x&&Za(x,xb)&&(xb=tb(Pb(xb,x.bottom),x.top));let Rb=xb.left>e?xb.left-e:Math.max(0,e-xb.right),fc=xb.top>k?xb.top-k:Math.max(0,k-xb.bottom);if(0==Rb&&0==fc)return 3==
Ka.nodeType?ec(Ka,e,k):Jb(Ka,e,k);if(!r||G>fc||G==fc&&Oa>Rb){r=Ka;x=xb;var Oa=Rb;Q=(G=fc)?k<xb.top?-1:1:Rb?e<xb.left?-1:1:0;Q=!Q||(0<Q?nb<Ra.length-1:0<nb)}0==Rb?k>xb.bottom&&(!ra||ra.bottom<xb.bottom)?(aa=Ka,ra=xb):k<xb.top&&(!Aa||Aa.top>xb.top)&&(fa=Ka,Aa=xb):ra&&Za(ra,xb)?ra=Pb(ra,xb.bottom):Aa&&Za(Aa,xb)&&(Aa=tb(Aa,xb.top))}}if(ra&&ra.bottom>=k?(r=aa,x=ra):Aa&&Aa.top<=k&&(r=fa,x=Aa),!r)return{node:g,offset:0};Oa=Math.max(x.left,Math.min(x.right,e));if(3==r.nodeType)return ec(r,Oa,k);if(Q&&"false"!=
r.contentEditable)return Jb(r,Oa,k);e=Array.prototype.indexOf.call(g.childNodes,r)+(e>=(x.left+x.right)/2?1:0);return{node:g,offset:e}}function ec(g,e,k){let r=g.nodeValue.length;var x=-1,G=1E9;let Q=0;for(let aa=0;aa<r;aa++){let fa=Fa(g,aa,aa+1).getClientRects();for(let ra=0;ra<fa.length;ra++){let Aa=fa[ra];if(Aa.top==Aa.bottom)continue;Q||=e-Aa.left;let Oa=(Aa.top>k?Aa.top-k:k-Aa.bottom)-1;if(Aa.left-1<=e&&Aa.right+1>=e&&Oa<G){G=x=e>=(Aa.left+Aa.right)/2;if((mc.chrome||mc.gecko)&&Fa(g,aa).getBoundingClientRect().left==
Aa.right&&(G=!x),0>=Oa)return{node:g,offset:aa+(G?1:0)};x=aa+(G?1:0);G=Oa}}}return{node:g,offset:-1<x?x:0<Q?g.nodeValue.length:0}}function yc(g,e,k,r=-1){var x,G,Q=g.contentDOM.getBoundingClientRect(),aa=Q.top+g.viewState.paddingTop;let fa;var {docHeight:ra}=g.viewState;let {x:Aa,y:Oa}=e,Ka=Oa-aa;if(0>Ka)return 0;if(Ka>ra)return g.state.doc.length;for(let xb=g.viewState.heightOracle.textHeight/2,Rb=!1;fa=g.elementAtHeight(Ka),fa.type!=n.BlockType.Text;)for(;Ka=0<r?fa.bottom+xb:fa.top-xb,!(0<=Ka&&
Ka<=ra);){if(Rb)return k?null:0;Rb=!0;r=-r}Oa=aa+Ka;r=fa.from;if(r<g.viewport.from)return 0==g.viewport.from?0:k?null:hc(g,Q,fa,Aa,Oa);if(r>g.viewport.to)return g.viewport.to==g.state.doc.length?g.state.doc.length:k?null:hc(g,Q,fa,Aa,Oa);k=g.dom.ownerDocument;ra=g.root.elementFromPoint?g.root:k;(aa=ra.elementFromPoint(Aa,Oa))&&!g.contentDOM.contains(aa)&&(aa=null);aa||(Aa=Math.max(Q.left+1,Math.min(Q.right-1,Aa)),aa=ra.elementFromPoint(Aa,Oa),aa&&!g.contentDOM.contains(aa)&&(aa=null));var Ra;Q=-1;
if(aa&&0!=(null===(x=g.docView.nearest(aa))||void 0===x?void 0:x.isEditable)){if(k.caretPositionFromPoint){var nb=k.caretPositionFromPoint(Aa,Oa);nb&&({offsetNode:Ra,offset:Q}=nb)}else if(k.caretRangeFromPoint&&(x=k.caretRangeFromPoint(Aa,Oa))){({startContainer:Ra,startOffset:Q}=x);if(!(x=!g.contentDOM.contains(Ra))&&(x=mc.safari))a:if(x=Ra,k=Aa,3!=x.nodeType||Q!=(nb=x.nodeValue.length))x=!1;else{for(aa=x.nextSibling;aa;aa=aa.nextSibling)if(1!=aa.nodeType||"BR"!=aa.nodeName){x=!1;break a}x=Fa(x,nb-
1,nb).getBoundingClientRect().left>k}if(!(nb=x)&&(nb=mc.chrome))a:if(x=Ra,nb=Aa,0!=Q)nb=!1;else{for(k=x;;){aa=k.parentNode;if(!aa||1!=aa.nodeType||aa.firstChild!=k){nb=!1;break a}if(aa.classList.contains("cm-line"))break;k=aa}x=1==x.nodeType?x.getBoundingClientRect():Fa(x,0,Math.max(x.nodeValue.length,1)).getBoundingClientRect();nb=5<nb-x.left}nb&&(Ra=void 0)}Ra&&(Q=Math.min(H(Ra),Q))}if(!Ra||!g.docView.dom.contains(Ra)){Ra=Gb.find(g.docView,r);if(!Ra)return Ka>fa.top+fa.height/2?fa.to:fa.from;({node:Ra,
offset:Q}=Jb(Ra.dom,Aa,Oa))}g=g.docView.nearest(Ra);return g?g.isWidget&&1==(null===(G=g.dom)||void 0===G?void 0:G.nodeType)?(G=g.dom.getBoundingClientRect(),e.y<G.top||e.y<=G.bottom&&e.x<=(G.left+G.right)/2?g.posAtStart:g.posAtEnd):g.localPosFromDOM(Ra,Q)+g.posAtStart:null}function hc(g,e,k,r,x){e=Math.round((r-e.left)*g.defaultCharacterWidth);g.lineWrapping&&k.height>1.5*g.defaultLineHeight&&(r=g.viewState.heightOracle.textHeight,e+=Math.floor((x-k.top-.5*(g.defaultLineHeight-r))/r)*g.viewState.heightOracle.lineLength);
x=g.state.sliceDoc(k.from,k.to);return k.from+$a.findColumn(x,e,g.state.tabSize)}function Fc(g,e,k){g=g.lineBlockAt(e);if(Array.isArray(g.type)){let r;for(let x of g.type){if(x.from>e)break;if(!(x.to<e)){if(x.from<e&&x.to>e)return x;(!r||x.type==n.BlockType.Text&&(r.type!=x.type||(0>k?x.from<e:x.to>e)))&&(r=x)}}return r||g}return g}function Ic(g,e,k,r){let x=g.state.doc.lineAt(e.head),G=g.bidiSpans(x),Q=g.textDirectionAt(x.from);for(let aa=e,fa=null;;){e=db(x,G,Q,aa,k);let ra=kd;if(!e){if(x.number==
(k?g.state.doc.lines:1))return aa;ra="\n";x=g.state.doc.line(x.number+(k?1:-1));G=g.bidiSpans(x);e=g.visualLineSide(x,!k)}if(fa){if(!fa(ra))return aa}else{if(!r)return e;fa=r(ra)}aa=e}}function Nc(g,e,k){let r=g.state.charCategorizer(e),x=r(k);return G=>{G=r(G);return x==$a.CharCategory.Space&&(x=G),x==G}}function Dc(g,e,k){for(;;){let r=0;for(let x of g)x.between(e-1,e+1,(G,Q,aa)=>{e>G&&e<Q&&(aa=r||k||(e-G<Q-e?-1:1),e=0>aa?G:Q,r=aa)});if(!r)return e}}function cd(g,e,k){e=Dc(g.state.facet(jg).map(r=>
r(g)),k.from,e.head>k.from?-1:1);return e==k.from?k:$a.EditorSelection.cursor(e,e<k.from?1:-1)}function jd(g,e){var k;let {newSel:r}=e,x=g.state.selection.main,G=g.inputState.lastKeyTime>Date.now()-100?g.inputState.lastKeyCode:-1;if(e.bounds){let {from:Ka,to:Ra}=e.bounds;var Q=x.from,aa=null;(8===G||mc.android&&e.text.length<Ra-Ka)&&(Q=x.to,aa="end");{var fa=g.state.doc.sliceString(Ka,Ra,"\uffff");var ra=e.text;Q-=Ka;var Aa=Math.min(fa.length,ra.length);let nb=0;for(;nb<Aa&&fa.charCodeAt(nb)==ra.charCodeAt(nb);)nb++;
if(nb==Aa&&fa.length==ra.length)fa=null;else{Aa=fa.length;for(var Oa=ra.length;0<Aa&&0<Oa&&fa.charCodeAt(Aa-1)==ra.charCodeAt(Oa-1);)Aa--,Oa--;"end"==aa&&(Q-=Aa+Math.max(0,nb-Math.min(Aa,Oa))-nb);Aa<nb&&fa.length<ra.length?(nb-=Q<=nb&&Q>=Aa?nb-Q:0,Oa=nb+(Oa-Aa),Aa=nb):Oa<nb&&(nb-=Q<=nb&&Q>=Oa?nb-Q:0,Aa=nb+(Aa-Oa),Oa=nb);fa={from:nb,toA:Aa,toB:Oa}}}fa&&(mc.chrome&&13==G&&fa.toB==fa.from+2&&"\uffff\uffff"==e.text.slice(fa.from,fa.toB)&&fa.toB--,k={from:Ka+fa.from,to:Ka+fa.toA,insert:$a.Text.of(e.text.slice(fa.from,
fa.toB).split("\uffff"))})}else r&&(!g.hasFocus&&g.state.facet(Ne)||r.main.eq(x))&&(r=null);return k||r?(!k&&e.typeOver&&!x.empty&&r&&r.main.empty?k={from:x.from,to:x.to,insert:g.state.doc.slice(x.from,x.to)}:(mc.mac||mc.android)&&k&&k.from==k.to&&k.from==x.head-1&&/^\. ?$/.test(k.insert.toString())&&"off"==g.contentDOM.getAttribute("autocorrect")?(r&&2==k.insert.length&&(r=$a.EditorSelection.single(r.main.anchor-1,r.main.head-1)),k={from:k.from,to:k.to,insert:$a.Text.of([k.insert.toString().replace(".",
" ")])}):k&&k.from>=x.from&&k.to<=x.to&&(k.from!=x.from||k.to!=x.to)&&4>=x.to-x.from-(k.to-k.from)?k={from:x.from,to:x.to,insert:g.state.doc.slice(x.from,k.from).append(k.insert).append(g.state.doc.slice(k.to,x.to))}:mc.chrome&&k&&k.from==k.to&&k.from==x.head&&"\n "==k.insert.toString()&&g.lineWrapping&&(r&&=$a.EditorSelection.single(r.main.anchor-1,r.main.head-1),k={from:x.from,to:x.to,insert:$a.Text.of([" "])}),k)?wc(g,k,r,G):r&&!r.main.eq(x)?(e=!1,k="select",g.inputState.lastSelectionTime>Date.now()-
50&&("select"==g.inputState.lastSelectionOrigin&&(e=!0),k=g.inputState.lastSelectionOrigin),g.dispatch({selection:r,scrollIntoView:e,userEvent:k}),!0):!1:!1}function wc(g,e,k,r=-1){if(mc.ios&&g.inputState.flushIOSKey(e))return!0;let x=g.state.selection.main;if(mc.android&&(e.to==x.to&&(e.from==x.from||e.from==x.from-1&&" "==g.state.sliceDoc(e.from,x.from))&&1==e.insert.length&&2==e.insert.lines&&ua(g.contentDOM,"Enter",13)||(e.from==x.from-1&&e.to==x.to&&0==e.insert.length||8==r&&e.insert.length<
e.to-e.from&&e.to>x.head)&&ua(g.contentDOM,"Backspace",8)||e.from==x.from&&e.to==x.to+1&&0==e.insert.length&&ua(g.contentDOM,"Delete",46)))return!0;let G=e.insert.toString();0<=g.inputState.composing&&g.inputState.composing++;let Q,aa=()=>Q||=zc(g,e,k);return g.state.facet(Kf).some(fa=>fa(g,e.from,e.to,G,aa))||g.dispatch(aa()),!0}function zc(g,e,k){let r=g.state,x=r.selection.main;if(e.from>=x.from&&e.to<=x.to&&e.to-e.from>=(x.to-x.from)/3&&(!k||k.main.empty&&k.main.from==e.from+e.insert.length)&&
0>g.inputState.composing){k=x.from<e.from?r.sliceDoc(x.from,e.from):"";var G=x.to>e.to?r.sliceDoc(e.to,x.to):"";k=r.replaceSelection(g.state.toText(k+e.insert.sliceString(0,void 0,g.state.lineBreak)+G))}else{let Q=r.changes(e),aa=k&&k.main.to<=Q.newLength?k.main:void 0;if(1<r.selection.ranges.length&&0<=g.inputState.composing&&e.to<=x.to&&e.to>=x.to-10){let fa=g.state.sliceDoc(e.from,e.to),ra;ra=(k=k&&M(g,k.main.head))?{from:k.from,to:k.to-(e.insert.length-(e.to-e.from))}:g.state.doc.lineAt(x.head);
let Aa=x.to-e.to,Oa=x.to-x.from;k=r.changeByRange(Ka=>{if(Ka.from==x.from&&Ka.to==x.to)return{changes:Q,range:aa||Ka.map(Q)};var Ra=Ka.to-Aa,nb=Ra-fa.length;if(Ka.to-Ka.from!=Oa||g.state.sliceDoc(nb,Ra)!=fa||Ka.to>=ra.from&&Ka.from<=ra.to)return{range:Ka};Ra=r.changes({from:nb,to:Ra,insert:e.insert});nb=Ka.to-x.to;return{changes:Ra,range:aa?$a.EditorSelection.range(Math.max(0,aa.anchor+nb),Math.max(0,aa.head+nb)):Ka.map(Ra)}})}else k={changes:Q,selection:aa&&r.selection.replaceRange(aa)}}G="input.type";
return(g.composing||g.inputState.compositionPendingChange&&g.inputState.compositionEndedAt>Date.now()-50)&&(g.inputState.compositionPendingChange=!1,G+=".compose",g.inputState.compositionFirstChange&&(G+=".start",g.inputState.compositionFirstChange=!1)),r.update(k,{userEvent:G,scrollIntoView:!0})}function da(g,e){return(k,r)=>{try{return e.call(g,r,k)}catch(x){oa(k.state,x)}}}function Ca(g){function e(x){return k[x]||(k[x]={observers:[],handlers:[]})}let k=Object.create(null);for(let x of g){if((g=
x.spec)&&g.domEventHandlers)for(let G in g.domEventHandlers){var r=g.domEventHandlers[G];r&&e(G).handlers.push(da(x.value,r))}if(g&&g.domEventObservers)for(let G in g.domEventObservers)(r=g.domEventObservers[G])&&e(G).observers.push(da(x.value,r))}for(let x in le)e(x).handlers.push(le[x]);for(let x in me)e(x).observers.push(me[x]);return k}function Ea(g,e){g=g.state.facet(Zc);return g.length?g[0](e):mc.mac?e.metaKey:e.ctrlKey}function Ta(g,e){var {main:k}=g.state.selection;if(k.empty)return!1;g=p(g.root);
if(!g||0==g.rangeCount)return!0;g=g.getRangeAt(0).getClientRects();for(k=0;k<g.length;k++){let r=g[k];if(r.left<=e.clientX&&r.right>=e.clientX&&r.top<=e.clientY&&r.bottom>=e.clientY)return!0}return!1}function mb(g,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let k=e.target,r;k!=g.contentDOM;k=k.parentNode)if(!k||11==k.nodeType||(r=od.get(k))&&r.ignoreEvent(e))return!1;return!0}function Fb(g){let e=g.dom.parentNode;if(e){var k=e.appendChild(document.createElement("textarea"));k.style.cssText=
"position: fixed; left: -10000px; top: 10px";k.focus();setTimeout(()=>{g.focus();k.remove();ic(g,k.value)},50)}}function Hb(g,e,k){for(let r of g.facet(e))k=r(k,g);return k}function ic(g,e){e=Hb(g.state,Fe,e);let {state:k}=g,r,x=1,G=k.toText(e),Q=G.lines==k.selection.ranges.length;if(null!=Yg&&k.selection.ranges.every(aa=>aa.empty)&&Yg==G.toString()){let aa=-1;r=k.changeByRange(fa=>{let ra=k.doc.lineAt(fa.from);if(ra.from==aa)return{range:fa};aa=ra.from;let Aa=k.toText((Q?G.line(x++).text:e)+k.lineBreak);
return{changes:{from:ra.from,insert:Aa},range:$a.EditorSelection.cursor(fa.from+Aa.length)}})}else Q?r=k.changeByRange(aa=>{let fa=G.line(x++);return{changes:{from:aa.from,to:aa.to,insert:fa.text},range:$a.EditorSelection.cursor(aa.from+fa.length)}}):r=k.replaceSelection(G);g.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}function Jc(g,e,k,r){if(1==r)return $a.EditorSelection.cursor(e,k);if(2==r)return Sa(g.state,e,k);k=Gb.find(g.docView,e);e=g.state.doc.lineAt(k?k.posAtEnd:e);r=k?k.posAtStart:
e.from;k=k?k.posAtEnd:e.to;return k<g.state.doc.length&&k==e.to&&k++,$a.EditorSelection.range(r,k)}function $c(g,e){let k=g.posAtCoords({x:e.clientX,y:e.clientY},!1);{var r=e.clientX;e=e.clientY;let G=Gb.find(g.docView,k);if(G){var x=k-G.posAtStart;r=0==x?1:x==G.length?-1:(g=G.coordsAt(x,-1))&&e>=g.top&&e<=g.bottom&&r>=g.left&&r<=g.right?-1:(x=G.coordsAt(x,1))&&e>=x.top&&e<=x.bottom&&r>=x.left&&r<=x.right?1:g&&g.bottom>=e?-1:1}else r=1}return{pos:k,bias:r}}function Cc(g){if(!yi)return g.detail;let e=
Zg,k=$g;return Zg=g,$g=Date.now(),Ph=!e||k>Date.now()-400&&2>Math.abs(e.clientX-g.clientX)&&2>Math.abs(e.clientY-g.clientY)?(Ph+1)%3:1}function Tc(g,e){let k=$c(g,e),r=Cc(e),x=g.state.selection;return{update(G){G.docChanged&&(k.pos=G.changes.mapPos(k.pos),x=x.map(G.changes))},get(G,Q,aa){var fa=$c(g,G);G=Jc(g,fa.pos,fa.bias,r);if(k.pos!=fa.pos&&!Q){var ra=Jc(g,k.pos,k.bias,r);let Oa=Math.min(ra.from,G.from);ra=Math.max(ra.to,G.to);G=Oa<G.from?$a.EditorSelection.range(Oa,ra):$a.EditorSelection.range(ra,
Oa)}if(Q)aa=x.replaceRange(x.main.extend(G.from,G.to));else{if(Q=aa&&1==r&&1<x.ranges.length){a:{var Aa=x;fa=fa.pos;for(Q=0;Q<Aa.ranges.length;Q++){let {from:Oa,to:Ka}=Aa.ranges[Q];if(Oa<=fa&&Ka>=fa){fa=$a.EditorSelection.create(Aa.ranges.slice(0,Q).concat(Aa.ranges.slice(Q+1)),Aa.mainIndex==Q?0:Aa.mainIndex-(Aa.mainIndex>Q?1:0));break a}}fa=null}Q=Aa=fa}aa=Q?Aa:aa?x.addRange(G):$a.EditorSelection.create([G])}return aa}}}function Vc(g,e,k,r){if(k=Hb(g.state,Fe,k),k){var x=g.posAtCoords({x:e.clientX,
y:e.clientY},!1),{draggedContent:G}=g.inputState;if(r=r&&G)r=g.state.facet(cc),r=r.length?r[0](e):mc.mac?!e.altKey:!e.ctrlKey;e=r?{from:G.from,to:G.to}:null;k={from:x,insert:k};k=g.state.changes(e?[e,k]:k);g.focus();g.dispatch({changes:k,selection:{anchor:k.mapPos(x,-1),head:k.mapPos(x,1)},userEvent:e?"move.drop":"input.drop"});g.inputState.draggedContent=null}}function qd(g,e){let k=g.dom.parentNode;if(k){var r=k.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px";
r.value=e;r.focus();r.selectionEnd=e.length;r.selectionStart=0;setTimeout(()=>{r.remove();g.focus()},50)}}function wd(g,e){let k=[];for(let r of g.facet(Qh)){let x=r(g,e);x&&k.push(x)}return k.length?g.update({effects:k,annotations:ah.of(!0)}):null}function Yc(g){setTimeout(()=>{var e=g.hasFocus;e!=g.inputState.notifiedFocused&&((e=wd(g.state,e))?g.dispatch(e):g.update([]))},10)}function nd(g){Rh.has(g)||(Rh.add(g),g.addEventListener("copy",()=>{}),g.addEventListener("cut",()=>{}))}function V(g,e){return g==
e?g:(g.constructor!=e.constructor&&(ne=!0),e)}function A(g,e){let k,r;null==g[e]&&(k=g[e-1])instanceof Oe&&(r=g[e+1])instanceof Oe&&g.splice(e-1,3,new Oe(k.length+1+r.length))}function J(g,e,k){let r=new zi;return $a.RangeSet.compare(g,e,k,r,0),r.changes}function W(g,e){let k=g.getBoundingClientRect(),r=g.ownerDocument,x=r.defaultView||window,G=Math.max(0,k.left),Q=Math.min(x.innerWidth,k.right),aa=Math.max(0,k.top),fa=Math.min(x.innerHeight,k.bottom);for(let ra=g.parentNode;ra&&ra!=r.body;)if(1==
ra.nodeType){let Aa=ra,Oa=window.getComputedStyle(Aa);if((Aa.scrollHeight>Aa.clientHeight||Aa.scrollWidth>Aa.clientWidth)&&"visible"!=Oa.overflow){let Ka=Aa.getBoundingClientRect();G=Math.max(G,Ka.left);Q=Math.min(Q,Ka.right);aa=Math.max(aa,Ka.top);fa=Math.min(ra==g.parentNode?x.innerHeight:fa,Ka.bottom)}ra="absolute"==Oa.position||"fixed"==Oa.position?Aa.offsetParent:Aa.parentNode}else if(11==ra.nodeType)ra=ra.host;else break;return{left:G-k.left,right:Math.max(G,Q)-k.left,top:aa-(k.top+e),bottom:Math.max(aa,
fa)-(k.top+e)}}function ea(g,e){g=g.getBoundingClientRect();return{left:0,right:g.right-g.left,top:e,bottom:g.bottom-(g.top+e)}}function qa(g,e,k){let r=[],x=g,G=0;return $a.RangeSet.spans(k,g,e,{span(){},point(Q,aa){Q>x&&(r.push({from:x,to:Q}),G+=Q-x);x=aa}},20),x<e&&(r.push({from:x,to:e}),G+=e-x),{total:G,ranges:r}}function za({total:g,ranges:e},k){if(0>=k)return e[0].from;if(1<=k)return e[e.length-1].to;g=Math.floor(g*k);for(k=0;;k++){let {from:r,to:x}=e[k],G=x-r;if(g<=G)return r+g;g-=G}}function Wa(g,
e){let k=0;for(let {from:r,to:x}of g.ranges){if(e<=x){k+=e-r;break}k+=x-r}return k/g.total}function fb(g,e){for(let k of g)if(e(k))return k}function Ab(g,e){if(1==e.scale)return g;let k=e.toDOM(g.top),r=e.toDOM(g.bottom);return new te(g.from,g.length,k,r-k,Array.isArray(g._content)?g._content.map(x=>Ab(x,e)):g._content)}function Ib(g,e,k){return new xd.StyleModule(e,{finish(r){return/&/.test(r)?r.replace(/&\w*/,x=>{if("&"==x)return g;if(!k||!k[x])throw new RangeError(`Unsupported selector: ${x}`);
return k[x]}):g+" "+r}})}function uc(g,e,k){for(;e;){var r=od.get(e);if(r&&r.parent==g)return r;r=e.parentNode;e=r!=g.dom?r:0<k?e.nextSibling:e.previousSibling}return null}function xc(g,e){let k=e.startContainer,r=e.startOffset,x=e.endContainer;e=e.endOffset;g=g.docView.domAtPos(g.state.selection.main.anchor);return y(g.node,g.offset,x,e)&&([k,r,x,e]=[x,e,k,r]),{anchorNode:k,anchorOffset:r,focusNode:x,focusOffset:e}}function R(g,e){function k(x){x.preventDefault();x.stopImmediatePropagation();r=x.getTargetRanges()[0]}
if(e.getComposedRanges&&(e=e.getComposedRanges(g.root)[0]))return xc(g,e);let r=null;return g.contentDOM.addEventListener("beforeinput",k,!0),g.dom.ownerDocument.execCommand("indent"),g.contentDOM.removeEventListener("beforeinput",k,!0),r?xc(g,r):null}function U(g,e,k){for(let r=g.state.facet(e),x=r.length-1;0<=x;x--)e=r[x],(e="function"==typeof e?e(g):e)&&$b(e,k);return k}function na(g,e,k){return e.altKey&&(g="Alt-"+g),e.ctrlKey&&(g="Ctrl-"+g),e.metaKey&&(g="Meta-"+g),!1!==k&&e.shiftKey&&(g="Shift-"+
g),g}function wa(g){g=g.facet(rf);let e=kg.get(g);return e||kg.set(g,e=La(g.reduce((k,r)=>k.concat(r),[]))),e}function La(g,e=Pe){let k=Object.create(null),r=Object.create(null),x=(aa,fa)=>{let ra=r[aa];if(null==ra)r[aa]=fa;else if(ra!=fa)throw Error("Key binding "+aa+" is used both as a regular binding and as a multi-stroke prefix");},G=(aa,fa,ra,Aa,Oa)=>{var Ka,Ra,nb=k[aa]||(k[aa]=Object.create(null));fa=fa.split(/ (?!$)/).map(xb=>{xb=xb.split(/-(?!$)/);let Rb=xb[xb.length-1];"Space"==Rb&&(Rb=" ");
let fc,dd,bd,Wc;for(let Vd=0;Vd<xb.length-1;++Vd){let Od=xb[Vd];if(/^(cmd|meta|m)$/i.test(Od))Wc=!0;else if(/^a(lt)?$/i.test(Od))fc=!0;else if(/^(c|ctrl|control)$/i.test(Od))dd=!0;else if(/^s(hift)?$/i.test(Od))bd=!0;else if(/^mod$/i.test(Od))"mac"==e?Wc=!0:dd=!0;else throw Error("Unrecognized modifier name: "+Od);}return fc&&(Rb="Alt-"+Rb),dd&&(Rb="Ctrl-"+Rb),Wc&&(Rb="Meta-"+Rb),bd&&(Rb="Shift-"+Rb),Rb});for(let xb=1;xb<fa.length;xb++){let Rb=fa.slice(0,xb).join(" ");x(Rb,!0);nb[Rb]||(nb[Rb]={preventDefault:!0,
stopPropagation:!1,run:[fc=>{let dd=Qe={view:fc,prefix:Rb,scope:aa};return setTimeout(()=>{Qe==dd&&(Qe=null)},lg),!0}]})}fa=fa.join(" ");x(fa,!1);nb=nb[fa]||(nb[fa]={preventDefault:!1,stopPropagation:!1,run:(null===(Ra=null===(Ka=nb._any)||void 0===Ka?void 0:Ka.run)||void 0===Ra?void 0:Ra.slice())||[]});ra&&nb.run.push(ra);Aa&&(nb.preventDefault=!0);Oa&&(nb.stopPropagation=!0)};for(let aa of g){g=aa.scope?aa.scope.split(" "):["editor"];if(aa.any)for(let fa of g){var Q=k[fa]||(k[fa]=Object.create(null));
Q._any||(Q._any={preventDefault:!1,stopPropagation:!1,run:[]});let {any:ra}=aa;for(let Aa in Q)Q[Aa].run.push(Oa=>ra(Oa,mg))}if(Q=aa[e]||aa.key)for(let fa of g)G(fa,Q,aa.run,aa.preventDefault,aa.stopPropagation),aa.shift&&G(fa,"Shift-"+Q,aa.shift,aa.preventDefault,aa.stopPropagation)}return k}function eb(g,e,k,r){mg=e;let x=Pd.keyName(e);var G=$a.codePointAt(x,0);G=$a.codePointSize(G)==x.length&&" "!=x;let Q="",aa=!1,fa=!1,ra=!1;Qe&&Qe.view==k&&Qe.scope==r&&(Q=Qe.prefix+" ",0>bh.indexOf(e.keyCode)&&
(fa=!0,Qe=null));let Aa=new Set,Oa=nb=>{if(nb){for(let xb of nb.run)if(!Aa.has(xb)&&(Aa.add(xb),xb(k)))return nb.stopPropagation&&(ra=!0),!0;nb.preventDefault&&(nb.stopPropagation&&(ra=!0),fa=!0)}return!1};g=g[r];let Ka,Ra;return g&&(Oa(g[Q+na(x,e,!G)])?aa=!0:G&&(e.altKey||e.metaKey||e.ctrlKey)&&!(mc.windows&&e.ctrlKey&&e.altKey)&&(Ka=Pd.base[e.keyCode])&&Ka!=x?(Oa(g[Q+na(Ka,e,!0)])||e.shiftKey&&(Ra=Pd.shift[e.keyCode])!=x&&Ra!=Ka&&Oa(g[Q+na(Ra,e,!1)]))&&(aa=!0):G&&e.shiftKey&&Oa(g[Q+na(x,e,!0)])&&
(aa=!0),!aa&&Oa(g._any)&&(aa=!0)),fa&&(aa=!0),aa&&ra&&e.stopPropagation(),mg=null,aa}function Ya(g){let e=g.scrollDOM.getBoundingClientRect();return{left:(g.textDirection==n.Direction.LTR?e.left:e.right-g.scrollDOM.clientWidth*g.scaleX)-g.scrollDOM.scrollLeft*g.scaleX,top:e.top-g.scrollDOM.scrollTop*g.scaleY}}function hb(g,e,k,r){k=g.coordsAtPos(e,2*k);if(!k)return r;e=g.dom.getBoundingClientRect();let x=(k.top+k.bottom)/2;k=g.posAtCoords({x:e.left+1,y:x});g=g.posAtCoords({x:e.right-1,y:x});return null==
k||null==g?r:{from:Math.max(r.from,Math.min(k,g)),to:Math.min(r.to,Math.max(k,g))}}function Nb(g,e,k){function r(dd,bd,Wc,Vd){return new ch(e,dd-Ka.left,bd-Ka.top,Wc-dd,Vd-bd)}function x({top:dd,bottom:bd,horizontal:Wc}){let Vd=[];for(let Od=0;Od<Wc.length;Od+=2)Vd.push(r(Wc[Od],dd,Wc[Od+1],bd));return Vd}function G(dd,bd,Wc){function Vd(oe,af,pe,bf,ng){oe=g.coordsAtPos(oe,oe==Wc.to?-2:2);pe=g.coordsAtPos(pe,pe==Wc.from?2:-2);!oe||!pe||(Od=Math.min(oe.top,pe.top,Od),og=Math.max(oe.bottom,pe.bottom,
og),ng==n.Direction.LTR?pg.push(ra&&af?Ra:oe.left,ra&&bf?nb:pe.right):pg.push(!ra&&bf?Ra:pe.left,!ra&&af?nb:oe.right))}let Od=1E9,og=-1E9,pg=[],dh=dd??Wc.from,eh=bd??Wc.to;for(let oe of g.visibleRanges)if(oe.to>dh&&oe.from<eh)for(let af=Math.max(oe.from,dh),pe=Math.min(oe.to,eh);;){let bf=g.state.doc.lineAt(af);for(let ng of g.bidiSpans(bf)){let Sh=ng.from+bf.from,Lf=ng.to+bf.from;if(Sh>=pe)break;Lf>af&&Vd(Math.max(Sh,af),null==dd&&Sh<=dh,Math.min(Lf,pe),null==bd&&Lf>=eh,ng.dir)}if(af=bf.to+1,af>=
pe)break}return 0==pg.length&&Vd(dh,null==dd,eh,null==bd,g.textDirection),{top:Od,bottom:og,horizontal:pg}}function Q(dd,bd){dd=Oa.top+(bd?dd.top:dd.bottom);return{top:dd,bottom:dd,horizontal:[]}}if(k.to<=g.viewport.from||k.from>=g.viewport.to)return[];var aa=Math.max(k.from,g.viewport.from),fa=Math.min(k.to,g.viewport.to);let ra=g.textDirection==n.Direction.LTR;var Aa=g.contentDOM;let Oa=Aa.getBoundingClientRect(),Ka=Ya(g);Aa=(Aa=Aa.querySelector(".cm-line"))&&window.getComputedStyle(Aa);let Ra=
Oa.left+(Aa?parseInt(Aa.paddingLeft)+Math.min(0,parseInt(Aa.textIndent)):0),nb=Oa.right-(Aa?parseInt(Aa.paddingRight):0);Aa=Fc(g,aa,1);let xb=Fc(g,fa,-1),Rb=Aa.type==n.BlockType.Text?Aa:null,fc=xb.type==n.BlockType.Text?xb:null;if(Rb&&(g.lineWrapping||Aa.widgetLineBreaks)&&(Rb=hb(g,aa,1,Rb)),fc&&(g.lineWrapping||xb.widgetLineBreaks)&&(fc=hb(g,fa,-1,fc)),Rb&&fc&&Rb.from==fc.from&&Rb.to==fc.to)return x(G(k.from,k.to,Rb));aa=Rb?G(k.from,null,Rb):Q(Aa,!1);k=fc?G(null,k.to,fc):Q(xb,!0);fa=[];return(Rb||
Aa).to<(fc||xb).from-(Rb&&fc?1:0)||1<Aa.widgetLineBreaks&&aa.bottom+g.defaultLineHeight/2<k.top?fa.push(r(Ra,aa.bottom,nb,k.top)):aa.bottom<k.top&&g.elementAtHeight((aa.bottom+k.top)/2).type==n.BlockType.Text&&(aa.bottom=k.top=(aa.bottom+k.top)/2),x(aa).concat(fa).concat(x(k))}function sc(g){return[Xd.define(e=>new Ai(e,g)),qg.of(g)]}function Ec(g){return g.startState.facet(cf)!=g.state.facet(cf)}function Kc(g,e,k,r,x){e.lastIndex=0;for(let G=g.iterRange(k,r),Q=k,aa;!G.next().done;Q+=G.value.length)if(!G.lineBreak)for(;aa=
e.exec(G.value);)x(Q+aa.index,aa)}function ed(g,e){let k=g.visibleRanges;if(1==k.length&&k[0].from==g.viewport.from&&k[0].to==g.viewport.to)return k;let r=[];for(let {from:x,to:G}of k)x=Math.max(g.state.doc.lineAt(x).from,x-e),G=Math.min(g.state.doc.lineAt(G).to,G+e),r.length&&r[r.length-1].to>=x?r[r.length-1].to=G:r.push({from:x,to:G});return r}function ud(){return Mj||=Xd.fromClass(class{constructor(g){this.view=g;this.decorations=xa.none;this.decorationCache=Object.create(null);this.decorator=
this.makeDecorator(g.state.facet(fh));this.decorations=this.decorator.createDeco(g)}makeDecorator(g){return new gh({regexp:g.specialChars,decoration:(e,k,r)=>{var {doc:x}=k.state;e=$a.codePointAt(e[0],0);return 9==e?(x=x.lineAt(r),k=k.state.tabSize,r=$a.countColumn(x.text,k,r-x.from),xa.replace({widget:new Th((k-r%k)*this.view.defaultCharacterWidth/this.view.scaleX)})):this.decorationCache[e]||(this.decorationCache[e]=xa.replace({widget:new Nj(g,e)}))},boundary:g.replaceTabs?void 0:/[^]/})}update(g){let e=
g.state.facet(fh);g.startState.facet(fh)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(g.view)):this.decorations=this.decorator.updateDeco(g,this.decorations)}},{decorations:g=>g.decorations})}function he(g,e){var k=g.posAtCoords({x:e.clientX,y:e.clientY},!1);let r=g.state.doc.lineAt(k),x=k-r.from;2E3<x?g=-1:x==r.length?(e=e.clientX,g=(k=g.coordsAtPos(g.viewport.from))?Math.round(Math.abs((k.left-e)/g.defaultCharacterWidth)):-1):g=$a.countColumn(r.text,g.state.tabSize,
k-r.from);return{line:r.number,col:g,off:x}}function ze(g,e){let k=he(g,e),r=g.state.selection;return k?{update(x){if(x.docChanged){var G=x.changes.mapPos(x.startState.doc.line(k.line).from);G=x.state.doc.lineAt(G);k={line:G.number,col:k.col,off:Math.min(k.off,G.length)};r=r.map(x.changes)}},get(x,G,Q){var aa=he(g,x);if(!aa)return r;x=g.state;var fa=k,ra=Math.min(fa.line,aa.line);G=Math.max(fa.line,aa.line);let Aa=[];if(2E3<fa.off||2E3<aa.off||0>fa.col||0>aa.col){var Oa=Math.min(fa.off,aa.off);for(aa=
Math.max(fa.off,aa.off);ra<=G;ra++)fa=x.doc.line(ra),fa.length<=aa&&Aa.push($a.EditorSelection.range(fa.from+Oa,fa.to+aa))}else for(Oa=Math.min(fa.col,aa.col),aa=Math.max(fa.col,aa.col);ra<=G;ra++){fa=x.doc.line(ra);let Ka=$a.findColumn(fa.text,Oa,x.tabSize,!0);if(0>Ka)Aa.push($a.EditorSelection.cursor(fa.to));else{let Ra=$a.findColumn(fa.text,aa,x.tabSize);Aa.push($a.EditorSelection.range(fa.from+Ka,fa.from+Ra))}}return Aa.length?Q?$a.EditorSelection.create(Aa.concat(r.ranges)):$a.EditorSelection.create(Aa):
r}}:null}function L(g){g=g.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:g.clientHeight,right:g.clientWidth}}function O(g,e){let k=parseInt(g.style.left,10);(isNaN(k)||1<Math.abs(e-k))&&(g.style.left=e+"px")}function ia(g){let e=g.nextSibling;return g.remove(),e}function ma(g){let e=[Yd];return g&&!1===g.fixed&&e.push(Mf.of(!0)),e}function Ia(g){return Array.isArray(g)?g:[g]}function cb(g,e,k){for(;g.value&&g.from<=k;)g.from==k&&e.push(g.value),g.next()}function jb(g,e){return g.state.facet(sf).formatNumber(e,
g.state)}function Eb(g){let e=9;for(;e<g;)e=10*e+9;return e}function vc(g){return Xd.define(e=>({decorations:g.createDeco(e),update(k){this.decorations=g.updateDeco(k,this.decorations)}}),{decorations:e=>e.decorations})}var $a=hg(),xd=am(),Pd=Op(),qe=class{constructor(){this.anchorNode=null;this.anchorOffset=0;this.focusNode=null;this.focusOffset=0}eq(g){return this.anchorNode==g.anchorNode&&this.anchorOffset==g.anchorOffset&&this.focusNode==g.focusNode&&this.focusOffset==g.focusOffset}setRange(g){let {anchorNode:e,
focusNode:k}=g;this.set(e,Math.min(g.anchorOffset,e?H(e):0),k,Math.min(g.focusOffset,k?H(k):0))}set(g,e,k,r){this.anchorNode=g;this.anchorOffset=e;this.focusNode=k;this.focusOffset=r}},Ud=null,Hf,rd=class g{constructor(e,k,r=!0){this.node=e;this.offset=k;this.precise=r}static before(e,k){return new g(e.parentNode,B(e),k)}static after(e,k){return new g(e.parentNode,B(e)+1,k)}},Ae=[],od=class g{constructor(){this.dom=this.parent=null;this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?
this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let k=this.posAtStart;for(let r of this.children){if(r==e)return k;k+=r.length+r.breakAfter}throw new RangeError("Invalid child in posBefore");}posAfter(e){return this.posBefore(e)+e.length}sync(e,k){if(this.flags&2){var r=this.dom;let x=null,G;for(let Q of this.children){if(Q.flags&7){if(!Q.dom&&(G=x?x.nextSibling:r.firstChild)){let aa=g.get(G);(!aa||!aa.parent&&aa.canReuseDOM(Q))&&Q.reuseDOM(G)}Q.sync(e,
k);Q.flags&=-8}if(G=x?x.nextSibling:r.firstChild,k&&!k.written&&k.node==r&&G!=Q.dom&&(k.written=!0),Q.dom.parentNode==r)for(;G&&G!=Q.dom;)G=kb(G);else r.insertBefore(Q.dom,G);x=Q.dom}for((G=x?x.nextSibling:r.firstChild)&&k&&k.node==r&&(k.written=!0);G;)G=kb(G)}else if(this.flags&1)for(r of this.children)r.flags&7&&(r.sync(e,k),r.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,k){let r;if(e==this.dom)r=this.dom.childNodes[k];else{for(k=0==H(e)?0:0==k?-1:1;;){let x=e.parentNode;if(x==this.dom)break;0==k&&
x.firstChild!=x.lastChild&&(e==x.firstChild?k=-1:k=1);e=x}0>k?r=e:r=e.nextSibling}if(r==this.dom.firstChild)return 0;for(;r&&!g.get(r);)r=r.nextSibling;if(!r)return this.length;for(let x=0,G=0;;x++){e=this.children[x];if(e.dom==r)return G;G+=e.length+e.breakAfter}}domBoundsAround(e,k,r=0){let x=-1,G=-1,Q=-1,aa=-1;for(let fa=0,ra=r,Aa=r;fa<this.children.length;fa++){let Oa=this.children[fa],Ka=ra+Oa.length;if(ra<e&&Ka>k)return Oa.domBoundsAround(e,k,ra);if(Ka>=e&&-1==x&&(x=fa,G=ra),ra>k&&Oa.dom.parentNode==
this.dom){Q=fa;aa=Aa;break}Aa=Ka;ra=Ka+Oa.breakAfter}return{from:G,to:0>aa?r+this.length:aa,startDOM:(x?this.children[x-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:Q<this.children.length&&0<=Q?this.children[Q].dom:null}}markDirty(e=!1){this.flags|=2;this.markParentsDirty(e)}markParentsDirty(e){for(let k=this.parent;k&&!(e&&(k.flags|=2),k.flags&1);k=k.parent)k.flags|=1,e=!1}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&
(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let k=e.parent;if(!k)return e;e=k}}replaceChildren(e,k,r=Ae){this.markDirty();for(let x=e;x<k;x++){let G=this.children[x];G.parent==this&&0>r.indexOf(G)&&G.destroy()}250>r.length?this.children.splice(e,k-e,...r):this.children=[].concat(this.children.slice(0,e),r,this.children.slice(k));for(e=0;e<r.length;e++)r[e].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new Nf(this.children,
e,this.children.length)}childPos(e,k=1){return this.childCursor().findPos(e,k)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==e?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,k,r,x,G,Q){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&
8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}};od.prototype.breakAfter=0;var Nf=class{constructor(g,e,k){this.children=g;this.pos=e;this.i=k;this.off=0}findPos(g,e=1){for(;;){if(g>this.pos||g==this.pos&&(0<e||0==this.i||this.children[this.i-1].breakAfter))return this.off=g-this.pos,this;let k=this.children[--this.i];this.pos-=k.length+k.breakAfter}}},Ld="u">typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},Of="u">typeof document?
document:{documentElement:{style:{}}},Zd=/Edge\/(\d+)/.exec(Ld.userAgent),rg=/MSIE \d/.test(Ld.userAgent),Pf=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ld.userAgent),Ge=!!(rg||Pf||Zd),Qf=!Ge&&/gecko\/(\d+)/i.test(Ld.userAgent),Re=!Ge&&/Chrome\/(\d+)/.exec(Ld.userAgent),df="webkitFontSmoothing"in Of.documentElement.style,ef=!Ge&&/Apple Computer/.test(Ld.vendor),sg=ef&&(/Mobile\/\w+/.test(Ld.userAgent)||2<Ld.maxTouchPoints),mc={mac:sg||/Mac/.test(Ld.platform),windows:/Win/.test(Ld.platform),linux:/Linux|X11/.test(Ld.platform),
ie:Ge,ie_version:rg?Of.documentMode||6:Pf?+Pf[1]:Zd?+Zd[1]:0,gecko:Qf,gecko_version:Qf?+(/Firefox\/(\d+)/.exec(Ld.userAgent)||[0,0])[1]:0,chrome:!!Re,chrome_version:Re?+Re[1]:0,ios:sg,android:/Android\b/.test(Ld.userAgent),webkit:df,safari:ef,webkit_version:df?+(/\bAppleWebKit\/(\d+)/.exec(Ld.userAgent)||[0,0])[1]:0,tabSize:null!=Of.documentElement.style.tabSize?"tab-size":"-moz-tab-size"},xe=class g extends od{constructor(e){super();this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||
document.createTextNode(this.text))}sync(e,k){this.dom||this.createDOM();this.dom.nodeValue!=this.text&&(k&&k.node==this.dom&&(k.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){3==e.nodeType&&this.createDOM(e)}merge(e,k,r){return this.flags&8||r&&(!(r instanceof g)||256<this.length-(k-e)+r.length||r.flags&8)?!1:(this.text=this.text.slice(0,e)+(r?r.text:"")+this.text.slice(k),this.markDirty(),!0)}split(e){let k=new g(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),
k.flags|=this.flags&8,k}localPosFromDOM(e,k){return e==this.dom?k:k?this.text.length:0}domAtPos(e){return new rd(this.dom,e)}domBoundsAround(e,k,r){return{from:r,to:r+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,k){return zb(this.dom,e,k)}},Ze=class g extends od{constructor(e,k=[],r=0){super();this.mark=e;this.children=k;this.length=r;for(let x of k)x.setParent(this)}setAttrs(e){if(Ha(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let k in this.mark.attrs)e.setAttribute(k,
this.mark.attrs[k]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,k){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName)));super.sync(e,k)}merge(e,k,r,x,G,Q){return r&&(!(r instanceof g&&r.mark.eq(this.mark))||e&&0>=G||k<this.length&&0>=Q)?!1:(ib(this,e,k,r?r.children.slice():[],G-1,Q-1),this.markDirty(),!0)}split(e){let k=
[];var r=0;let x=-1,G=0;for(let Q of this.children){let aa=r+Q.length;aa>e&&k.push(r<e?Q.split(e-r):Q);0>x&&r>=e&&(x=G);r=aa;G++}r=this.length-e;return this.length=e,-1<x&&(this.children.length=x,this.markDirty()),new g(this.mark,k,r)}domAtPos(e){return gb(this,e)}coordsAt(e,k){return Lb(this,e,k)}},Rf=class g extends od{static create(e,k,r){return new g(e,k,r)}constructor(e,k,r){super();this.widget=e;this.length=k;this.side=r;this.prevWidget=null}split(e){let k=g.create(this.widget,this.length-e,
this.side);return this.length-=e,k}sync(e){this.dom&&this.widget.updateDOM(this.dom,e)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),!this.widget.editable&&(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,k,r,x,G,Q){return r&&(!(r instanceof g&&this.widget.compare(r.widget))||0<e&&0>=G||k<this.length&&0>=Q)?!1:(this.length=e+(r?r.length:0)+(this.length-k),!0)}become(e){return e instanceof g&&e.side==this.side&&
this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(0==this.length)return $a.Text.empty;for(var e=this;e.parent;)e=e.parent;({view:e}=e);e=e&&e.state.doc;let k=this.posAtStart;return e?e.slice(k,k+this.length):$a.Text.empty}domAtPos(e){return(this.length?
0==e:0<this.side)?rd.before(this.dom):rd.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,k){if(k=this.widget.coordsAt(this.dom,e,k))return k;k=this.dom.getClientRects();let r=null;if(!k.length)return null;let x=this.side?0>this.side:0<e;for(let G=x?k.length-1:0;r=k[G],!(0<e?0==G:G==k.length-1||r.top<r.bottom);G+=x?-1:1);return T(r,!x)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy();this.dom&&this.widget.destroy(this.dom)}},
S=class g extends od{constructor(e){super();this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof g&&e.side==this.side}split(){return new g(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer";e.setAttribute("aria-hidden","true");this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return 0<this.side?rd.before(this.dom):rd.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return $a.Text.empty}get isHidden(){return!0}};
xe.prototype.children=Rf.prototype.children=S.prototype.children=Ae;var ka=Object.create(null),Ga=class{eq(g){return!1}updateDOM(g,e){return!1}compare(g){return this==g||this.constructor==g.constructor&&this.eq(g)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(g){return!0}coordsAt(g,e,k){return null}get isHidden(){return!1}get editable(){return!1}destroy(g){}};n.BlockType=void 0;(function(g){g[g.Text=0]="Text";g[g.WidgetBefore=1]="WidgetBefore";g[g.WidgetAfter=2]="WidgetAfter";
g[g.WidgetRange=3]="WidgetRange"})(n.BlockType||(n.BlockType={}));var xa=class extends $a.RangeValue{constructor(g,e,k,r){super();this.startSide=g;this.endSide=e;this.widget=k;this.spec=r}get heightRelevant(){return!1}static mark(g){return new Pa(g)}static widget(g){let e=Math.max(-1E4,Math.min(1E4,g.side||0)),k=!!g.block;return e+=k&&!g.inlineOrder?0<e?3E8:-4E8:0<e?1E8:-1E8,new rb(g,e,e,k,g.widget||null,!1)}static replace(g){let e=!!g.block,k,r;if(g.isBlockGap)k=-5E8,r=4E8;else{let {start:x,end:G}=
Bb(g,e);k=(x?e?-3E8:-1:5E8)-1;r=(G?e?2E8:1:-6E8)+1}return new rb(g,k,r,e,g.widget||null,!0)}static line(g){return new Ma(g)}static set(g,e=!1){return $a.RangeSet.of(g,e)}hasHeight(){return this.widget?-1<this.widget.estimatedHeight:!1}};xa.none=$a.RangeSet.empty;var Pa=class g extends xa{constructor(e){let {start:k,end:r}=Bb(e);super(k?-1:5E8,r?1:-6E8,null,e);this.tagName=e.tagName||"span";this.class=e.class||"";this.attrs=e.attributes||null}eq(e){var k,r;return this==e||e instanceof g&&this.tagName==
e.tagName&&(this.class||(null===(k=this.attrs)||void 0===k?void 0:k.class))==(e.class||(null===(r=e.attrs)||void 0===r?void 0:r.class))&&pc(this.attrs,e.attrs,"class")}range(e,k=e){if(e>=k)throw new RangeError("Mark decorations may not be empty");return super.range(e,k)}};Pa.prototype.point=!1;var Ma=class g extends xa{constructor(e){super(-2E8,-2E8,null,e)}eq(e){return e instanceof g&&this.spec.class==e.spec.class&&pc(this.spec.attributes,e.spec.attributes)}range(e,k=e){if(k!=e)throw new RangeError("Line decoration ranges must be zero-length");
return super.range(e,k)}};Ma.prototype.mapMode=$a.MapMode.TrackBefore;Ma.prototype.point=!0;var rb=class g extends xa{constructor(e,k,r,x,G,Q){super(k,r,G,e);this.block=x;this.isReplace=Q;this.mapMode=x?0>=k?$a.MapMode.TrackBefore:$a.MapMode.TrackAfter:$a.MapMode.TrackDel}get type(){return this.startSide!=this.endSide?n.BlockType.WidgetRange:0>=this.startSide?n.BlockType.WidgetBefore:n.BlockType.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(5<=this.widget.estimatedHeight||0<
this.widget.lineBreaks)}eq(e){var k;if(k=e instanceof g){k=this.widget;var r=e.widget;k=k==r||!!(k&&r&&k.compare(r))}return k&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,k=e){if(this.isReplace&&(e>k||e==k&&0<this.startSide&&0>=this.endSide))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&k!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,k)}};rb.prototype.point=!0;var Gb=
class g extends od{constructor(){super(...arguments);this.children=[];this.length=0;this.prevAttrs=void 0;this.attrs=null;this.breakAfter=0}merge(e,k,r,x,G,Q){if(r){if(!(r instanceof g))return!1;this.dom||r.transferDOM(this)}return x&&this.setDeco(r?r.attrs:null),ib(this,e,k,r?r.children.slice():[],G,Q),!0}split(e){let k=new g;if(k.breakAfter=this.breakAfter,0==this.length)return k;let {i:r,off:x}=this.childPos(e);x&&(k.append(this.children[r].split(x),0),this.children[r].merge(x,this.children[r].length,
null,!1,0,0),r++);for(let G=r;G<this.children.length;G++)k.append(this.children[G],0);for(;0<r&&0==this.children[r-1].length;)this.children[--r].destroy();return this.children.length=r,this.markDirty(),this.length=e,k}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){pc(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,k){qb(this,e,k)}addLineDeco(e){let k=
e.spec.attributes;e=e.spec.class;k&&(this.attrs=$b(k,this.attrs||{}));e&&(this.attrs=$b({class:e},this.attrs||{}))}domAtPos(e){return gb(this,e)}reuseDOM(e){"DIV"==e.nodeName&&(this.setDOM(e),this.flags|=6)}sync(e,k){var r;this.dom?this.flags&4&&(Ha(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0);void 0!==this.prevAttrs&&(yb(this.dom,this.prevAttrs,this.attrs),
this.dom.classList.add("cm-line"),this.prevAttrs=void 0);super.sync(e,k);for(e=this.dom.lastChild;e&&od.get(e)instanceof Ze;)e=e.lastChild;e&&this.length&&("BR"==e.nodeName||0!=(null===(r=od.get(e))||void 0===r?void 0:r.isEditable)||mc.ios&&this.children.some(x=>x instanceof xe))||(r=document.createElement("BR"),r.cmIgnore=!0,this.dom.appendChild(r))}measureTextSize(){if(0==this.children.length||20<this.length)return null;let e=0;for(let r of this.children){if(!(r instanceof xe)||/[^ -~]/.test(r.text))return null;
var k=w(r.dom);if(1!=k.length)return null;e+=k[0].width;k=k[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:k}:null}coordsAt(e,k){e=Lb(this,e,k);if(!this.children.length&&e&&this.parent){({heightOracle:k}=this.parent.view.viewState);let r=e.bottom-e.top;if(2>Math.abs(r-k.lineHeight)&&k.textHeight<r)return k=(r-k.textHeight)/2,{top:e.top+k,bottom:e.bottom-k,left:e.left,right:e.left}}return e}become(e){return e instanceof g&&0==this.children.length&&
0==e.children.length&&pc(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,k){for(let r=0,x=0;r<e.children.length;r++){let G=e.children[r],Q=x+G.length;if(Q>=k){if(G instanceof g)return G;if(Q>k)break}x=Q+G.breakAfter}return null}},gc=class g extends od{constructor(e,k,r){super();this.widget=e;this.length=k;this.deco=r;this.breakAfter=0;this.prevWidget=null}merge(e,k,r,x,G,Q){return r&&(!(r instanceof g&&this.widget.compare(r.widget))||0<e&&0>=G||k<this.length&&0>=
Q)?!1:(this.length=e+(r?r.length:0)+(this.length-k),!0)}domAtPos(e){return 0==e?rd.before(this.dom):rd.after(this.dom,e==this.length)}split(e){let k=this.length-e;this.length=e;e=new g(this.widget,k,this.deco);return e.breakAfter=this.breakAfter,e}get children(){return Ae}sync(e){this.dom&&this.widget.updateDOM(this.dom,e)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),!this.widget.editable&&(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?
this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):$a.Text.empty}domBoundsAround(){return null}become(e){return e instanceof g&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,
k){return this.widget.coordsAt(this.dom,e,k)||(this.widget instanceof Lc?null:T(this.dom.getBoundingClientRect(),this.length?0==e:0>=k))}destroy(){super.destroy();this.dom&&this.widget.destroy(this.dom)}covers(e){let {startSide:k,endSide:r}=this.deco;return k==r?!1:0>e?0>k:0<r}},Lc=class extends Ga{constructor(g){super();this.height=g}toDOM(){let g=document.createElement("div");return g.className="cm-gap",this.updateDOM(g),g}eq(g){return g.height==this.height}updateDOM(g){return g.style.height=this.height+
"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}},Oc=class g{constructor(e,k,r,x){this.doc=e;this.pos=k;this.end=r;this.disallowBlockEffectsFor=x;this.content=[];this.curLine=null;this.pendingBuffer=this.breakAtStart=0;this.bufferMarks=[];this.atCursorPos=!0;this.openEnd=this.openStart=-1;this.text="";this.textOff=0;this.cursor=e.iter();this.skip=k}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;
let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof gc&&0>e.deco.endSide)}getLine(){return this.curLine||(this.content.push(this.curLine=new Gb),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Cb(new S(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer();this.curLine=null;this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0;this.posCovered()||
e&&this.content.length&&this.content[this.content.length-1]instanceof gc||this.getLine()}buildText(e,k,r){for(;0<e;){if(this.textOff==this.text.length){let {value:G,lineBreak:Q,done:aa}=this.cursor.next(this.skip);if(this.skip=0,aa)throw Error("Ran out of text content when drawing inline views");if(Q){this.posCovered()||this.getLine();this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1;this.flushBuffer();this.curLine=null;this.atCursorPos=!0;e--;continue}else this.text=
G,this.textOff=0}let x=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(k.slice(k.length-r));this.getLine().append(Cb(new xe(this.text.slice(this.textOff,this.textOff+x)),k),r);this.atCursorPos=!0;this.textOff+=x;e-=x;r=0}}span(e,k,r,x){this.buildText(k-e,r,x);this.pos=k;0>this.openStart&&(this.openStart=x)}point(e,k,r,x,G,Q){if(this.disallowBlockEffectsFor[Q]&&r instanceof rb){if(r.block)throw new RangeError("Block decorations may not be specified via plugins");if(k>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins");
}Q=k-e;if(r instanceof rb)if(r.block)0<r.startSide&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new gc(r.widget||Dd.block,Q,r));else{let aa=Rf.create(r.widget||Dd.inline,Q,Q?0:r.startSide),fa=this.atCursorPos&&!aa.isEditable&&G<=x.length&&(e<k||0<r.startSide);r=!aa.isEditable&&(e<k||G>x.length||0>=r.startSide);let ra=this.getLine();2!=this.pendingBuffer||fa||aa.isEditable||(this.pendingBuffer=0);this.flushBuffer(x);fa&&(ra.append(Cb(new S(1),x),G),G=x.length+Math.max(0,G-x.length));ra.append(Cb(aa,
x),G);(this.pendingBuffer=(this.atCursorPos=r)?e<k||G>x.length?1:2:0)&&(this.bufferMarks=x.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(r);Q&&(this.textOff+Q<=this.text.length?this.textOff+=Q:(this.skip+=Q-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=k);0>this.openStart&&(this.openStart=G)}static build(e,k,r,x,G){e=new g(e,k,r,G);return e.openEnd=$a.RangeSet.spans(x,k,r,e),0>e.openStart&&(e.openStart=e.openEnd),e.finish(e.openEnd),e}},
Dd=class extends Ga{constructor(g){super();this.tag=g}eq(g){return g.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(g){return g.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}};Dd.inline=new Dd("span");Dd.block=new Dd("div");n.Direction=void 0;(function(g){g[g.LTR=0]="LTR";g[g.RTL=1]="RTL"})(n.Direction||(n.Direction={}));var Uc=n.Direction.LTR,ge=n.Direction.RTL,If=sb("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),
Jf=sb("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Nh=Object.create(null),se=[];for(let g of["()","[]","{}"]){let e=g.charCodeAt(0),k=g.charCodeAt(1);Nh[e]=k;Nh[k]=-e}var $e=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/,rc=class{get dir(){return this.level%2?ge:Uc}constructor(g,e,
k){this.from=g;this.to=e;this.level=k}side(g,e){return this.dir==e==g?this.to:this.from}forward(g,e){return g==(this.dir==e)}static find(g,e,k,r){let x=-1;for(let G=0;G<g.length;G++){let Q=g[G];if(Q.from<=e&&Q.to>=e){if(Q.level==k)return G;(0>x||(0!=r?0>r?Q.from<e:Q.to>e:g[x].level>Q.level))&&(x=G)}}if(0>x)throw new RangeError("Index out of range");return x}},Gc=[],kd="",Zc=$a.Facet.define(),cc=$a.Facet.define(),Bi=$a.Facet.define(),ig=$a.Facet.define(),$d=$a.Facet.define(),Kf=$a.Facet.define(),Qh=
$a.Facet.define(),Fe=$a.Facet.define(),Uh=$a.Facet.define(),tf=$a.Facet.define({combine:g=>g.some(e=>e)}),hh=$a.Facet.define({combine:g=>g.some(e=>e)}),tg=$a.Facet.define(),ih=class g{constructor(e,k="nearest",r="nearest",x=5,G=5,Q=!1){this.range=e;this.y=k;this.x=r;this.yMargin=x;this.xMargin=G;this.isSnapshot=Q}map(e){return e.empty?this:new g(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new g($a.EditorSelection.cursor(e.doc.length),
this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}},ug=$a.StateEffect.define({map:(g,e)=>g.map(e)}),Bc=$a.StateEffect.define(),Ne=$a.Facet.define({combine:g=>g.length?g[0]:!0}),Oj=0,Sf=$a.Facet.define(),Xd=class g{constructor(e,k,r,x,G){this.id=e;this.create=k;this.domEventHandlers=r;this.domEventObservers=x;this.extension=G(this)}static define(e,k){let {eventHandlers:r,eventObservers:x,provide:G,decorations:Q}=k||{};return new g(Oj++,e,r,x,aa=>{let fa=[Sf.of(aa)];return Q&&fa.push(uf.of(ra=>
(ra=ra.plugin(aa))?Q(ra):xa.none)),G&&fa.push(G(aa)),fa})}static fromClass(e,k){return g.define(r=>new e(r),k)}},jh=class{constructor(g){this.spec=g;this.value=this.mustUpdate=null}update(g){if(this.value){if(this.mustUpdate&&(g=this.mustUpdate,this.mustUpdate=null,this.value.update))try{this.value.update(g)}catch(e){if(oa(g.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}else if(this.spec)try{this.value=this.spec.create(g)}catch(e){oa(g.state,
e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(g){var e;if(null!==(e=this.value)&&void 0!==e&&e.destroy)try{this.value.destroy()}catch(k){oa(g.state,k,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}},Vh=$a.Facet.define(),vf=$a.Facet.define(),uf=$a.Facet.define(),Wh=$a.Facet.define(),jg=$a.Facet.define(),Oh=$a.Facet.define(),Xg=$a.Facet.define(),Tf=$a.Facet.define(),ye=class g{constructor(e,k,r,x){this.fromA=e;this.toA=k;this.fromB=r;this.toB=x}join(e){return new g(Math.min(this.fromA,
e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let k=e.length,r=this;for(;0<k;k--){let x=e[k-1];if(!(x.fromA>r.toA)){if(x.toA<r.fromA)break;r=r.join(x);e.splice(k-1,1)}}return e.splice(k,0,r),e}static extendWithRanges(e,k){if(0==k.length)return e;let r=[];for(let x=0,G=0,Q=0,aa=0;;x++){let fa=x==e.length?null:e[x],ra=Q-aa,Aa=fa?fa.fromB:1E9;for(;G<k.length&&k[G]<Aa;){let Oa=k[G+1],Ka=Math.max(aa,k[G]),Ra=Math.min(Aa,Oa);if(Ka<=Ra&&(new g(Ka+ra,
Ra+ra,Ka,Ra)).addToSet(r),Oa>Aa)break;G+=2}if(!fa)return r;(new g(fa.fromA,fa.toA,fa.fromB,fa.toB)).addToSet(r);Q=fa.toA;aa=fa.toB}}},kh=class g{constructor(e,k,r){this.view=e;this.state=k;this.transactions=r;this.flags=0;this.startState=e.state;this.changes=$a.ChangeSet.empty(this.startState.doc.length);for(let G of r)this.changes=this.changes.compose(G.changes);let x=[];this.changes.iterChangedRanges((G,Q,aa,fa)=>x.push(new ye(G,Q,aa,fa)));this.changedRanges=x}static create(e,k,r){return new g(e,
k,r)}get viewportChanged(){return 0<(this.flags&4)}get viewportMoved(){return 0<(this.flags&8)}get heightChanged(){return 0<(this.flags&2)}get geometryChanged(){return this.docChanged||0<(this.flags&18)}get focusChanged(){return 0<(this.flags&1)}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return 0==this.flags&&0==this.transactions.length}},lh=class extends od{get length(){return this.view.state.doc.length}constructor(g){super();
this.view=g;this.decorations=[];this.dynamicDecorationMap=[!1];this.hasComposition=this.domChanged=null;this.markedForComposition=new Set;this.editContextFormatting=xa.none;this.lastCompositionAfterCursor=!1;this.minWidthTo=this.minWidthFrom=this.minWidth=0;this.impreciseHead=this.impreciseAnchor=null;this.forceSelection=!1;this.lastUpdate=Date.now();this.setDOM(g.contentDOM);this.children=[new Gb];this.children[0].setParent(this);this.updateDeco();this.updateInner([new ye(0,0,0,g.state.doc.length)],
0,null)}update(g){var e;let k=g.changedRanges;0<this.minWidth&&k.length&&(k.every(({fromA:G,toA:Q})=>Q<this.minWidthFrom||G>this.minWidthTo)?(this.minWidthFrom=g.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=g.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);this.updateEditContextFormatting(g);var r=-1;0<=this.view.inputState.composing&&!this.view.observer.editContext&&(null!==(e=this.domChanged)&&void 0!==e&&e.newSel?r=this.domChanged.newSel.head:!Ja(g.changes,
this.hasComposition)&&!g.selectionSet&&(r=g.state.selection.main.head));e=-1<r?Z(this.view,g.changes,r):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let {from:G,to:Q}=this.hasComposition;k=(new ye(G,Q,g.changes.mapPos(G,-1),g.changes.mapPos(Q,1))).addToSet(k.slice())}this.hasComposition=e?{from:e.range.fromB,to:e.range.toB}:null;(mc.ie||mc.chrome)&&!e&&g&&g.state.doc.lines!=g.startState.doc.lines&&(this.forceSelection=!0);r=this.decorations;let x=this.updateDeco();
r=pa(r,x,g.changes);return k=ye.extendWithRanges(k,r),this.flags&7||0!=k.length?(this.updateInner(k,g.startState.doc.length,e),g.transactions.length&&(this.lastUpdate=Date.now()),!0):!1}updateInner(g,e,k){this.view.viewState.mustMeasureContent=!0;this.updateChildren(g,e,k);let {observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px";this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let x=mc.chrome||mc.ios?{node:r.selectionRange.focusNode,
written:!1}:void 0;this.sync(this.view,x);this.flags&=-8;x&&(x.written||r.selectionRange.focusNode!=x.node)&&(this.forceSelection=!0);this.dom.style.height=""});this.markedForComposition.forEach(x=>x.flags&=-9);g=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let x of this.children)x instanceof gc&&x.widget instanceof Lc&&g.push(x.dom);r.updateGaps(g)}updateChildren(g,e,k){g=k?k.range.addToSet(g.slice()):g;e=this.childCursor(e);for(let G=g.length-1;;G--){var r=
0<=G?g[G]:null;if(!r)break;let {fromA:Q,toA:aa,fromB:fa,toB:ra}=r;var x=void 0;let Aa,Oa;if(k&&k.range.fromB<ra&&k.range.toB>fa){x=Oc.build(this.view.state.doc,fa,k.range.fromB,this.decorations,this.dynamicDecorationMap);let Rb=Oc.build(this.view.state.doc,k.range.toB,ra,this.decorations,this.dynamicDecorationMap);r=x.breakAtStart;Aa=x.openStart;Oa=Rb.openEnd;let fc=this.compositionView(k);Rb.breakAtStart?fc.breakAfter=1:Rb.content.length&&fc.merge(fc.length,fc.length,Rb.content[0],!1,Rb.openStart,
0)&&(fc.breakAfter=Rb.content[0].breakAfter,Rb.content.shift());x.content.length&&fc.merge(0,0,x.content[x.content.length-1],!0,0,x.openEnd)&&x.content.pop();x=x.content.concat(fc).concat(Rb.content)}else({content:x,breakAtStart:r,openStart:Aa,openEnd:Oa}=Oc.build(this.view.state.doc,fa,ra,this.decorations,this.dynamicDecorationMap));let {i:Ka,off:Ra}=e.findPos(aa,1),{i:nb,off:xb}=e.findPos(Q,-1);pb(this,nb,xb,Ka,Ra,x,r,Aa,Oa)}k&&this.fixCompositionDOM(k)}updateEditContextFormatting(g){this.editContextFormatting=
this.editContextFormatting.map(g.changes);for(let e of g.transactions)for(let k of e.effects)k.is(Bc)&&(this.editContextFormatting=k.value)}compositionView(g){let e=new xe(g.text.nodeValue);e.flags|=8;for(let {deco:k}of g.marks)e=new Ze(k,[e],e.length);g=new Gb;return g.append(e,0),g}fixCompositionDOM(g){let e=(x,G)=>{G.flags=G.flags|8|(G.children.some(aa=>aa.flags&7)?1:0);this.markedForComposition.add(G);let Q=od.get(x);Q&&Q!=G&&(Q.dom=null);G.setDOM(x)},k=this.childPos(g.range.fromB,1),r=this.children[k.i];
e(g.line,r);for(let x=g.marks.length-1;-1<=x;x--)k=r.childPos(k.off,1),r=r.children[k.i],e(0<=x?g.marks[x].node:g.text,r)}updateSelection(g=!1,e=!1){!g&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let k=this.view.root.activeElement;g=k==this.dom;let r=!g&&!(this.view.state.facet(Ne)||-1<this.dom.tabIndex)&&u(this.dom,this.view.observer.selectionRange)&&!(k&&this.dom.contains(k));if(g||e||r){e=this.forceSelection;this.forceSelection=!1;var x=this.view.state.selection.main,
G=this.moveToLine(this.domAtPos(x.anchor)),Q=x.empty?G:this.moveToLine(this.domAtPos(x.head));if(mc.gecko&&x.empty&&!this.hasComposition&&1==G.node.nodeType&&G.node.firstChild&&(0==G.offset||"false"==G.node.childNodes[G.offset-1].contentEditable)&&(G.offset==G.node.childNodes.length||"false"==G.node.childNodes[G.offset].contentEditable)){let fa=document.createTextNode("");this.view.observer.ignore(()=>G.node.insertBefore(fa,G.node.childNodes[G.offset]||null));G=Q=new rd(fa,0);e=!0}var aa=this.view.observer.selectionRange;
!e&&aa.focusNode&&(y(G.node,G.offset,aa.anchorNode,aa.anchorOffset)&&y(Q.node,Q.offset,aa.focusNode,aa.focusOffset)||this.suppressWidgetCursorChange(aa,x))||(this.view.observer.ignore(()=>{var fa;if(fa=mc.android&&mc.chrome&&this.dom.contains(aa.focusNode))a:{for(fa=aa.focusNode;fa&&fa!=this.dom;fa=fa.assignedSlot||fa.parentNode)if(1==fa.nodeType&&"false"==fa.contentEditable){fa=!0;break a}fa=!1}fa&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));if(fa=p(this.view.root))if(x.empty){if(mc.gecko){var ra=
G.node;var Aa=G.offset;(ra=1!=ra.nodeType?0:(Aa&&"false"==ra.childNodes[Aa-1].contentEditable?1:0)|(Aa<ra.childNodes.length&&"false"==ra.childNodes[Aa].contentEditable?2:0))&&3!=ra&&(ra=(1==ra?Na:Qa)(G.node,G.offset))&&(G=new rd(ra.node,ra.offset))}fa.collapse(G.node,G.offset);null!=x.bidiLevel&&void 0!==fa.caretBidiLevel&&(fa.caretBidiLevel=x.bidiLevel)}else if(fa.extend){fa.collapse(G.node,G.offset);try{fa.extend(Q.node,Q.offset)}catch{}}else ra=document.createRange(),x.anchor>x.head&&([G,Q]=[Q,
G]),ra.setEnd(Q.node,Q.offset),ra.setStart(G.node,G.offset),fa.removeAllRanges(),fa.addRange(ra);r&&this.view.root.activeElement==this.dom&&(this.dom.blur(),k&&k.focus())}),this.view.observer.setSelectionRange(G,Q));this.impreciseAnchor=G.precise?null:new rd(aa.anchorNode,aa.anchorOffset);this.impreciseHead=Q.precise?null:new rd(aa.focusNode,aa.focusOffset)}}suppressWidgetCursorChange(g,e){return this.hasComposition&&e.empty&&y(g.focusNode,g.focusOffset,g.anchorNode,g.anchorOffset)&&this.posFromDOM(g.focusNode,
g.focusOffset)==e.head}enforceCursorAssoc(){if(!this.hasComposition){var {view:g}=this,e=g.state.selection.main,k=p(g.root),{anchorNode:r,anchorOffset:x}=g.observer.selectionRange;if(k&&e.empty&&e.assoc&&k.modify){var G=Gb.find(this,e.head);if(G){var Q=G.posAtStart;e.head!=Q&&e.head!=Q+G.length&&(G=this.coordsAt(e.head,-1),Q=this.coordsAt(e.head,1),!G||!Q||G.bottom>Q.top||(G=this.domAtPos(e.head+e.assoc),k.collapse(G.node,G.offset),k.modify("move",0>e.assoc?"forward":"backward","lineboundary"),g.observer.readSelectionRange(),
G=g.observer.selectionRange,g.docView.posFromDOM(G.anchorNode,G.anchorOffset)!=e.from&&k.collapse(r,x)))}}}}moveToLine(g){let e=this.dom,k;if(g.node!=e)return g;for(var r=g.offset;!k&&r<e.childNodes.length;r++){var x=od.get(e.childNodes[r]);x instanceof Gb&&(k=x.domAtPos(0))}for(r=g.offset-1;!k&&0<=r;r--)x=od.get(e.childNodes[r]),x instanceof Gb&&(k=x.domAtPos(x.length));return k?new rd(k.node,k.offset,!0):g}nearest(g){for(;g;){let e=od.get(g);if(e&&e.rootView==this)return e;g=g.parentNode}return null}posFromDOM(g,
e){let k=this.nearest(g);if(!k)throw new RangeError("Trying to find position for a DOM position outside of the document");return k.localPosFromDOM(g,e)+k.posAtStart}domAtPos(g){let {i:e,off:k}=this.childCursor().findPos(g,-1);for(;e<this.children.length-1;){g=this.children[e];if(k<g.length||g instanceof Gb)break;e++;k=0}return this.children[e].domAtPos(k)}coordsAt(g,e){let k=null,r=0;for(let x=this.length,G=this.children.length-1;0<=G;G--){let Q=this.children[G],aa=x-Q.breakAfter,fa=aa-Q.length;if(aa<
g)break;if(fa<=g&&(fa<g||Q.covers(-1))&&(aa>g||Q.covers(1))&&(!k||Q instanceof Gb&&!(k instanceof Gb&&0<=e)))k=Q,r=fa;else if(k&&fa==g&&aa==g&&Q instanceof gc&&2>Math.abs(e)){if(0>Q.deco.startSide)break;G&&(k=null)}x=fa}return k?k.coordsAt(g-r,e):null}coordsForChar(g){let {i:e,off:k}=this.childPos(g,1);g=this.children[e];if(!(g instanceof Gb))return null;for(;g.children.length;){let {i:x,off:G}=g.childPos(k,1);for(;;x++){if(x==g.children.length)return null;if((g=g.children[x]).length)break}k=G}if(!(g instanceof
xe))return null;var r=$a.findClusterBreak(g.text,k);if(r==k)return null;g=Fa(g.dom,k,r).getClientRects();for(r=0;r<g.length;r++){let x=g[r];if(r==g.length-1||x.top<x.bottom&&x.left<x.right)return x}return null}measureVisibleLineHeights(g){let e=[],{from:k,to:r}=g;g=this.view.contentDOM.clientWidth;let x=g>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,G=-1,Q=this.view.textDirection==n.Direction.LTR;for(let ra=0,Aa=0;Aa<this.children.length;Aa++){let Oa=this.children[Aa],Ka=ra+Oa.length;
if(Ka>r)break;if(ra>=k){var aa=Oa.dom.getBoundingClientRect();if(e.push(aa.height),x){var fa=Oa.dom.lastChild;fa=fa?w(fa):[];fa.length&&(fa=fa[fa.length-1],aa=Q?fa.right-aa.left:aa.right-fa.left,aa>G&&(G=aa,this.minWidth=g,this.minWidthFrom=ra,this.minWidthTo=Ka))}}ra=Ka+Oa.breakAfter}return e}textDirectionAt(g){({i:g}=this.childPos(g,1));return"rtl"==getComputedStyle(this.children[g].dom).direction?n.Direction.RTL:n.Direction.LTR}measureTextSize(){for(let x of this.children)if(x instanceof Gb){let G=
x.measureTextSize();if(G)return G}let g=document.createElement("div"),e,k,r;return g.className="cm-line",g.style.width="99999px",g.style.position="absolute",g.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(g);let x=w(g.firstChild)[0];e=g.getBoundingClientRect().height;k=x?x.width/27:7;r=x?x.height:e;g.remove()}),{lineHeight:e,charWidth:k,textHeight:r}}childCursor(g=this.length){let e=this.children.length;return e&&(g-=this.children[--e].length),new Nf(this.children,
g,e)}computeBlockGapDeco(){let g=[],e=this.view.viewState;for(let k=0,r=0;;r++){let x=r==e.viewports.length?null:e.viewports[r],G=x?x.from-1:this.length;if(G>k){let Q=(e.lineBlockAt(G).bottom-e.lineBlockAt(k).top)/this.view.scaleY;g.push(xa.replace({widget:new Lc(Q),block:!0,inclusive:!0,isBlockGap:!0}).range(k,G))}if(!x)break;k=x.to+1}return xa.set(g)}updateDeco(){let g=1,e=this.view.state.facet(uf).map(x=>(this.dynamicDecorationMap[g++]="function"==typeof x)?x(this.view):x),k=!1,r=this.view.state.facet(Wh).map((x,
G)=>{G="function"==typeof x;return G&&(k=!0),G?x(this.view):x});r.length&&(this.dynamicDecorationMap[g++]=k,e.push($a.RangeSet.join(r)));for(this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];g<this.decorations.length;)this.dynamicDecorationMap[g++]=!1;return this.decorations}scrollIntoView(g){if(g.isSnapshot){var e=this.view.viewState.lineBlockAt(g.range.head);this.view.scrollDOM.scrollTop=e.top-g.yMargin;this.view.scrollDOM.scrollLeft=g.xMargin}else{for(e of this.view.state.facet(tg))try{if(e(this.view,
g.range,g))return!0}catch(fc){oa(this.view.state,fc,"scroll handler")}var {range:k}=g;e=this.coordsAt(k.head,k.empty?k.assoc:k.head>k.anchor?-1:1);var r;if(e){!k.empty&&(r=this.coordsAt(k.anchor,k.anchor>k.head?-1:1))&&(e={left:Math.min(e.left,r.left),top:Math.min(e.top,r.top),right:Math.max(e.right,r.right),bottom:Math.max(e.bottom,r.bottom)});r=N(this.view);e={left:e.left-r.left,top:e.top-r.top,right:e.right+r.right,bottom:e.bottom+r.bottom};var {offsetWidth:x,offsetHeight:G}=this.view.scrollDOM,
Q=this.view.scrollDOM;k=k.head<k.anchor?-1:1;r=g.x;var aa=g.y,fa=Math.max(Math.min(g.xMargin,x),-x);g=Math.max(Math.min(g.yMargin,G),-G);var ra=this.view.textDirection==n.Direction.LTR,Aa=Q.ownerDocument,Oa=Aa.defaultView||window;for(let fc=Q,dd=!1;fc&&!dd;)if(1==fc.nodeType){var Ka=void 0;Q=fc==Aa.body;let bd=1;var Ra=1;if(Q)Ka=(Ka=Oa.visualViewport)?{left:0,right:Ka.width,top:0,bottom:Ka.height}:{left:0,right:Oa.innerWidth,top:0,bottom:Oa.innerHeight};else{if(/^(fixed|sticky)$/.test(getComputedStyle(fc).position)&&
(dd=!0),fc.scrollHeight<=fc.clientHeight&&fc.scrollWidth<=fc.clientWidth){fc=fc.assignedSlot||fc.parentNode;continue}Ka=fc.getBoundingClientRect();({scaleX:bd,scaleY:Ra}=ca(fc,Ka));Ka={left:Ka.left,right:Ka.left+fc.clientWidth*bd,top:Ka.top,bottom:Ka.top+fc.clientHeight*Ra}}let Wc=0;var nb=0;if("nearest"==aa)e.top<Ka.top?(nb=e.top-(Ka.top+g),0<k&&e.bottom>Ka.bottom+nb&&(nb=e.bottom-Ka.bottom+g)):e.bottom>Ka.bottom&&(nb=e.bottom-Ka.bottom+g,0>k&&e.top-nb<Ka.top&&(nb=e.top-(Ka.top+g)));else{nb=e.bottom-
e.top;var xb=Ka.bottom-Ka.top;nb=("center"==aa&&nb<=xb?e.top+nb/2-xb/2:"start"==aa||"center"==aa&&0>k?e.top-g:e.bottom-xb+g)-Ka.top}if("nearest"==r?e.left<Ka.left?(Wc=e.left-(Ka.left+fa),0<k&&e.right>Ka.right+Wc&&(Wc=e.right-Ka.right+fa)):e.right>Ka.right&&(Wc=e.right-Ka.right+fa,0>k&&e.left<Ka.left+Wc&&(Wc=e.left-(Ka.left+fa))):Wc=("center"==r?e.left+(e.right-e.left)/2-(Ka.right-Ka.left)/2:"start"==r==ra?e.left-fa:e.right-(Ka.right-Ka.left)+fa)-Ka.left,Wc||nb)if(Q)Oa.scrollBy(Wc,nb);else{var Rb=
xb=0;nb&&(Rb=fc.scrollTop,fc.scrollTop+=nb/Ra,Rb=(fc.scrollTop-Rb)*Ra);Wc&&(Ra=fc.scrollLeft,fc.scrollLeft+=Wc/bd,xb=(fc.scrollLeft-Ra)*bd);e={left:e.left-xb,top:e.top-Rb,right:e.right-xb,bottom:e.bottom-Rb};xb&&1>Math.abs(xb-Wc)&&(r="nearest");Rb&&1>Math.abs(Rb-nb)&&(aa="nearest")}if(Q)break;(e.top<Ka.top||e.bottom>Ka.bottom||e.left<Ka.left||e.right>Ka.right)&&(e={left:Math.max(e.left,Ka.left),right:Math.min(e.right,Ka.right),top:Math.max(e.top,Ka.top),bottom:Math.min(e.bottom,Ka.bottom)});fc=fc.assignedSlot||
fc.parentNode}else if(11==fc.nodeType)fc=fc.host;else break}}}},xi=class{constructor(){this.changes=[]}compareRange(g,e){Db(g,e,this.changes)}comparePoint(g,e){Db(g,e,this.changes)}boundChange(g){Db(g,g,this.changes)}},Xh=class{constructor(g,e){this.points=g;this.text="";this.lineSeparator=e.facet($a.EditorState.lineSeparator)}append(g){this.text+=g}lineBreak(){this.text+="\uffff"}readRange(g,e){if(!g)return this;let k=g.parentNode;for(;;){this.findPointBefore(k,g);let r=this.text.length;this.readNode(g);
let x=g.nextSibling;if(x==e)break;let G=od.get(g),Q=od.get(x);(G&&Q?G.breakAfter:(G?G.breakAfter:z(g))||z(x)&&("BR"!=g.nodeName||g.cmIgnore)&&this.text.length>r)&&this.lineBreak();g=x}return this.findPointBefore(k,e),this}readTextNode(g){let e=g.nodeValue;for(var k of this.points)k.node==g&&(k.pos=this.text.length+Math.min(k.offset,e.length));for(let r=0,x=this.lineSeparator?null:/\r\n?|\n/g;;){k=-1;let G=1,Q;if(this.lineSeparator?(k=e.indexOf(this.lineSeparator,r),G=this.lineSeparator.length):(Q=
x.exec(e))&&(k=Q.index,G=Q[0].length),this.append(e.slice(r,0>k?e.length:k)),0>k)break;if(this.lineBreak(),1<G)for(let aa of this.points)aa.node==g&&aa.pos>this.text.length&&(aa.pos-=G-1);r=k+G}}readNode(g){if(!g.cmIgnore){var e=od.get(g);e=e&&e.overrideDOMText;if(null!=e)for(this.findPointInside(g,e.length),g=e.iter();!g.next().done;)g.lineBreak?this.lineBreak():this.append(g.value);else 3==g.nodeType?this.readTextNode(g):"BR"==g.nodeName?g.nextSibling&&this.lineBreak():1==g.nodeType&&this.readRange(g.firstChild,
null)}}findPointBefore(g,e){for(let k of this.points)k.node==g&&g.childNodes[k.offset]==e&&(k.pos=this.text.length)}findPointInside(g,e){for(let aa of this.points)if(3==g.nodeType?aa.node==g:g.contains(aa.node)){var k=aa,r=this.text.length;a:{var x=g;for(var G=aa.node,Q=aa.offset;;){if(!G||Q<H(G)){x=!1;break a}if(G==x){x=!0;break a}Q=B(G)+1;G=G.parentNode}}k.pos=r+(x?e:0)}}},Yh=class{constructor(g,e){this.node=g;this.offset=e;this.pos=-1}},Zh=class{constructor(g,e,k,r){this.typeOver=r;this.bounds=
null;this.text="";this.domChanged=-1<e;let {impreciseHead:x,impreciseAnchor:G}=g.docView;if(g.state.readOnly&&-1<e)this.newSel=null;else if(-1<e&&(this.bounds=g.docView.domBoundsAround(e,k,0))){if(x||G)e=[];else if(e=[],g.root.activeElement==g.contentDOM){var {anchorNode:Q,anchorOffset:aa,focusNode:fa,focusOffset:ra}=g.observer.selectionRange;e=(Q&&(e.push(new Yh(Q,aa)),(fa!=Q||ra!=aa)&&e.push(new Yh(fa,ra))),e)}g=new Xh(e,g.state);g.readRange(this.bounds.startDOM,this.bounds.endDOM);this.text=g.text;
k=e;g=this.bounds.from;0==k.length?g=null:(e=k[0].pos,k=2==k.length?k[1].pos:e,g=-1<e&&-1<k?$a.EditorSelection.single(e+g,k+g):null);this.newSel=g}else{k=g.observer.selectionRange;e=x&&x.node==k.focusNode&&x.offset==k.focusOffset||!q(g.contentDOM,k.focusNode)?g.state.selection.main.head:g.docView.posFromDOM(k.focusNode,k.focusOffset);k=G&&G.node==k.anchorNode&&G.offset==k.anchorOffset||!q(g.contentDOM,k.anchorNode)?g.state.selection.main.anchor:g.docView.posFromDOM(k.anchorNode,k.anchorOffset);var Aa=
g.viewport;if((mc.ios||mc.chrome)&&g.state.selection.main.empty&&e!=k&&(0<Aa.from||Aa.to<g.state.doc.length)){r=Math.min(e,k);let Oa=Math.max(e,k),Ka=Aa.from-r;Aa=Aa.to-Oa;!(0!=Ka&&1!=Ka&&0!=r||0!=Aa&&-1!=Aa&&Oa!=g.state.doc.length)&&(e=0,k=g.state.doc.length)}this.newSel=$a.EditorSelection.single(k,e)}}},Di=class{setSelectionOrigin(g){this.lastSelectionOrigin=g;this.lastSelectionTime=Date.now()}constructor(g){this.view=g;this.lastScrollLeft=this.lastScrollTop=this.lastFocusTime=this.lastTouchTime=
this.lastKeyTime=this.lastKeyCode=0;this.pendingIOSKey=void 0;this.tabFocusMode=-1;this.lastSelectionOrigin=null;this.lastContextMenu=this.lastSelectionTime=0;this.scrollHandlers=[];this.handlers=Object.create(null);this.composing=-1;this.compositionFirstChange=null;this.compositionEndedAt=0;this.compositionPendingChange=this.compositionPendingKey=!1;this.draggedContent=this.mouseSelection=null;this.handleEvent=this.handleEvent.bind(this);this.notifiedFocused=g.hasFocus;mc.safari&&g.contentDOM.addEventListener("input",
()=>null);mc.gecko&&nd(g.contentDOM.ownerDocument)}handleEvent(g){!mb(this.view,g)||this.ignoreDuringComposition(g)||"keydown"==g.type&&this.keydown(g)||(0!=this.view.updateState?Promise.resolve().then(()=>this.runHandlers(g.type,g)):this.runHandlers(g.type,g))}runHandlers(g,e){if(g=this.handlers[g]){for(let k of g.observers)k(this.view,e);for(let k of g.handlers){if(e.defaultPrevented)break;if(k(this.view,e)){e.preventDefault();break}}}}ensureHandlers(g){g=Ca(g);let e=this.handlers,k=this.view.contentDOM;
for(let r in g)if("scroll"!=r){let x=!g[r].handlers.length,G=e[r];G&&x!=!G.handlers.length&&(k.removeEventListener(r,this.handleEvent),G=null);G||k.addEventListener(r,this.handleEvent,{passive:x})}for(let r in e)"scroll"!=r&&!g[r]&&k.removeEventListener(r,this.handleEvent);this.handlers=g}keydown(g){if(this.lastKeyCode=g.keyCode,this.lastKeyTime=Date.now(),9==g.keyCode&&-1<this.tabFocusMode&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(0<this.tabFocusMode&&27!=g.keyCode&&0>bh.indexOf(g.keyCode)&&
(this.tabFocusMode=-1),mc.android&&mc.chrome&&!g.synthetic&&(13==g.keyCode||8==g.keyCode))return this.view.observer.delayAndroidKey(g.key,g.keyCode),!0;let e;return!mc.ios||g.synthetic||g.altKey||g.metaKey||!((e=mh.find(k=>k.keyCode==g.keyCode))&&!g.ctrlKey||-1<Ci.indexOf(g.key)&&g.ctrlKey&&!g.shiftKey)?(229!=g.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=e||g,setTimeout(()=>this.flushIOSKey(),250),!0)}flushIOSKey(g){let e=this.pendingIOSKey;return!e||"Enter"==e.key&&g&&g.from<
g.to&&/^\S+$/.test(g.insert.toString())?!1:(this.pendingIOSKey=void 0,ua(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(g){return/^key/.test(g.type)?0<this.composing?!0:mc.safari&&!mc.ios&&this.compositionPendingKey&&100>Date.now()-this.compositionEndedAt?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(g){this.mouseSelection&&this.mouseSelection.destroy();this.mouseSelection=g}update(g){this.view.observer.update(g);this.mouseSelection&&
this.mouseSelection.update(g);this.draggedContent&&g.docChanged&&(this.draggedContent=this.draggedContent.map(g.changes));g.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}},mh=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Ci="dthko",bh=[16,
17,18,20,91,92,224,225],Ei=class{constructor(g,e,k,r){this.view=g;this.startEvent=e;this.style=k;this.mustSelect=r;this.scrollSpeed={x:0,y:0};this.scrolling=-1;this.lastEvent=e;this.scrollParents=ha(g.contentDOM);this.atoms=g.state.facet(jg).map(x=>x(g));k=g.contentDOM.ownerDocument;k.addEventListener("mousemove",this.move=this.move.bind(this));k.addEventListener("mouseup",this.up=this.up.bind(this));this.extend=e.shiftKey;this.multiple=g.state.facet($a.EditorState.allowMultipleSelections)&&Ea(g,
e);this.dragging=Ta(g,e)&&1==Cc(e)?null:!1}start(g){!1===this.dragging&&this.select(g)}move(g){if(0==g.buttons)return this.destroy();var e;!(e=this.dragging)&&(e=null==this.dragging)&&(e=this.startEvent,e=10>Math.max(Math.abs(e.clientX-g.clientX),Math.abs(e.clientY-g.clientY)));if(!e){this.select(this.lastEvent=g);var k=e=0,r=0,x=0,G=this.view.win.innerWidth,Q=this.view.win.innerHeight;this.scrollParents.x&&({left:r,right:G}=this.scrollParents.x.getBoundingClientRect());this.scrollParents.y&&({top:x,
bottom:Q}=this.scrollParents.y.getBoundingClientRect());var aa=N(this.view);g.clientX-aa.left<=r+6?e=-(.7*Math.max(0,r-g.clientX)+8):g.clientX+aa.right>=G-6&&(e=.7*Math.max(0,g.clientX-G)+8);g.clientY-aa.top<=x+6?k=-(.7*Math.max(0,x-g.clientY)+8):g.clientY+aa.bottom>=Q-6&&(k=.7*Math.max(0,g.clientY-Q)+8);this.setScrollSpeed(e,k)}}up(g){null==this.dragging&&this.select(this.lastEvent);this.dragging||g.preventDefault();this.destroy()}destroy(){this.setScrollSpeed(0,0);let g=this.view.contentDOM.ownerDocument;
g.removeEventListener("mousemove",this.move);g.removeEventListener("mouseup",this.up);this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(g,e){this.scrollSpeed={x:g,y:e};g||e?0>this.scrolling&&(this.scrolling=setInterval(()=>this.scroll(),50)):-1<this.scrolling&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let {x:g,y:e}=this.scrollSpeed;g&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=g,g=0);e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=
e,e=0);(g||e)&&this.view.win.scrollBy(g,e);!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(g){let e=null;for(let r=0;r<g.ranges.length;r++){let x=g.ranges[r],G=null;if(x.empty){var k=Dc(this.atoms,x.from,0);k!=x.from&&(G=$a.EditorSelection.cursor(k,-1))}else{k=Dc(this.atoms,x.from,-1);let Q=Dc(this.atoms,x.to,1);k==x.from&&Q==x.to||(G=$a.EditorSelection.range(x.from==x.anchor?k:Q,x.from==x.head?k:Q))}G&&(e||=g.ranges.slice(),e[r]=G)}return e?$a.EditorSelection.create(e,g.mainIndex):g}select(g){let {view:e}=
this;g=this.skipAtoms(this.style.get(g,this.extend,this.multiple));!this.mustSelect&&g.eq(e.state.selection,!1===this.dragging)||this.view.dispatch({selection:g,userEvent:"select.pointer"});this.mustSelect=!1}update(g){g.transactions.some(e=>e.isUserEvent("input.type"))?this.destroy():this.style.update(g)&&setTimeout(()=>this.select(this.lastEvent),20)}},le=Object.create(null),me=Object.create(null),nh=mc.ie&&15>mc.ie_version||mc.ios&&604>mc.webkit_version;me.scroll=g=>{g.inputState.lastScrollTop=
g.scrollDOM.scrollTop;g.inputState.lastScrollLeft=g.scrollDOM.scrollLeft};le.keydown=(g,e)=>(g.inputState.setSelectionOrigin("select"),27==e.keyCode&&0!=g.inputState.tabFocusMode&&(g.inputState.tabFocusMode=Date.now()+2E3),!1);me.touchstart=(g,e)=>{g.inputState.lastTouchTime=Date.now();g.inputState.setSelectionOrigin("select.pointer")};me.touchmove=g=>{g.inputState.setSelectionOrigin("select.pointer")};le.mousedown=(g,e)=>{if(g.observer.flush(),g.inputState.lastTouchTime>Date.now()-2E3)return!1;var k=
null;for(var r of g.state.facet(Bi))if(k=r(g,e),k)break;if(!k&&0==e.button&&(k=Tc(g,e)),k)if(r=!g.hasFocus,g.inputState.startMouseSelection(new Ei(g,e,k,r)),r&&g.observer.ignore(()=>{Da(g.contentDOM);let x=g.root.activeElement;x&&!x.contains(g.contentDOM)&&x.blur()}),k=g.inputState.mouseSelection)return k.start(e),!1===k.dragging;return!1};var yi=mc.ie&&11>=mc.ie_version,Zg=null,Ph=0,$g=0;le.dragstart=(g,e)=>{let {selection:{main:k}}=g.state;if(e.target.draggable){var r=g.docView.nearest(e.target);
if(r&&r.isWidget){var x=r.posAtStart;r=x+r.length;(x>=k.to||r<=k.from)&&(k=$a.EditorSelection.range(x,r))}}({inputState:x}=g);return x.mouseSelection&&(x.mouseSelection.dragging=!0),x.draggedContent=k,e.dataTransfer&&(e.dataTransfer.setData("Text",Hb(g.state,Uh,g.state.sliceDoc(k.from,k.to))),e.dataTransfer.effectAllowed="copyMove"),!1};le.dragend=g=>(g.inputState.draggedContent=null,!1);le.drop=(g,e)=>{if(!e.dataTransfer)return!1;if(g.state.readOnly)return!0;let k=e.dataTransfer.files;if(k&&k.length){let x=
Array(k.length),G=0,Q=()=>{++G==k.length&&Vc(g,e,x.filter(aa=>null!=aa).join(g.state.lineBreak),!1)};for(let aa=0;aa<k.length;aa++){let fa=new FileReader;fa.onerror=Q;fa.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(fa.result)||(x[aa]=fa.result);Q()};fa.readAsText(k[aa])}return!0}let r=e.dataTransfer.getData("Text");return r?(Vc(g,e,r,!0),!0):!1};le.paste=(g,e)=>{if(g.state.readOnly)return!0;g.observer.flush();return(e=nh?null:e.clipboardData)?(ic(g,e.getData("text/plain")||e.getData("text/uri-list")),
!0):(Fb(g),!1)};var Yg=null;le.copy=le.cut=(g,e)=>{var k=g.state;let r=[],x=[];var G=!1;for(var Q of k.selection.ranges)Q.empty||(r.push(k.sliceDoc(Q.from,Q.to)),x.push(Q));if(!r.length){G=-1;for(let {from:Aa}of k.selection.ranges)Q=k.doc.lineAt(Aa),Q.number>G&&(r.push(Q.text),x.push({from:Q.from,to:Math.min(k.doc.length,Q.to+1)})),G=Q.number;G=!0}k={text:Hb(k,Uh,r.join(k.lineBreak)),ranges:x,linewise:G};let {text:aa,ranges:fa,linewise:ra}=k;if(!aa&&!ra)return!1;Yg=ra?aa:null;"cut"==e.type&&!g.state.readOnly&&
g.dispatch({changes:fa,scrollIntoView:!0,userEvent:"delete.cut"});return(e=nh?null:e.clipboardData)?(e.clearData(),e.setData("text/plain",aa),!0):(qd(g,aa),!1)};var ah=$a.Annotation.define();me.focus=g=>{g.inputState.lastFocusTime=Date.now();!g.scrollDOM.scrollTop&&(g.inputState.lastScrollTop||g.inputState.lastScrollLeft)&&(g.scrollDOM.scrollTop=g.inputState.lastScrollTop,g.scrollDOM.scrollLeft=g.inputState.lastScrollLeft);Yc(g)};me.blur=g=>{g.observer.clearSelectionRange();Yc(g)};me.compositionstart=
me.compositionupdate=g=>{g.observer.editContext||(null==g.inputState.compositionFirstChange&&(g.inputState.compositionFirstChange=!0),0>g.inputState.composing&&(g.inputState.composing=0))};me.compositionend=g=>{g.observer.editContext||(g.inputState.composing=-1,g.inputState.compositionEndedAt=Date.now(),g.inputState.compositionPendingKey=!0,g.inputState.compositionPendingChange=0<g.observer.pendingRecords().length,g.inputState.compositionFirstChange=null,mc.chrome&&mc.android?g.observer.flushSoon():
g.inputState.compositionPendingChange?Promise.resolve().then(()=>g.observer.flush()):setTimeout(()=>{0>g.inputState.composing&&g.docView.hasComposition&&g.update([])},50))};me.contextmenu=g=>{g.inputState.lastContextMenu=Date.now()};le.beforeinput=(g,e)=>{var k;if("insertReplacementText"==e.inputType&&g.observer.editContext){let G=null===(k=e.dataTransfer)||void 0===k?void 0:k.getData("text/plain");k=e.getTargetRanges();if(G&&k.length){var r=k[0];var x=g.posAtDOM(r.startContainer,r.startOffset);r=
g.posAtDOM(r.endContainer,r.endOffset);return wc(g,{from:x,to:r,insert:g.state.toText(G)},null),!0}}if(mc.chrome&&mc.android&&(r=mh.find(G=>G.inputType==e.inputType))&&(g.observer.delayAndroidKey(r.key,r.keyCode),"Backspace"==r.key||"Delete"==r.key)){let G=(null===(x=window.visualViewport)||void 0===x?void 0:x.height)||0;setTimeout(()=>{var Q;((null===(Q=window.visualViewport)||void 0===Q?void 0:Q.height)||0)>G+10&&g.hasFocus&&(g.contentDOM.blur(),g.focus())},100)}return mc.ios&&"deleteContentForward"==
e.inputType&&g.observer.flushSoon(),mc.safari&&"insertText"==e.inputType&&0<=g.inputState.composing&&setTimeout(()=>me.compositionend(g,e),20),!1};var Rh=new Set,Fi=["pre-wrap","normal","pre-line","break-spaces"],ne=!1,oh=class{constructor(g){this.lineWrapping=g;this.doc=$a.Text.empty;this.heightSamples={};this.lineHeight=14;this.charWidth=7;this.textHeight=14;this.lineLength=30}heightForGap(g,e){let k=this.doc.lineAt(e).number-this.doc.lineAt(g).number+1;return this.lineWrapping&&(k+=Math.max(0,
Math.ceil((e-g-k*this.lineLength*.5)/this.lineLength))),this.lineHeight*k}heightForLine(g){return this.lineWrapping?(1+Math.max(0,Math.ceil((g-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(g){return this.doc=g,this}mustRefreshForWrapping(g){return-1<Fi.indexOf(g)!=this.lineWrapping}mustRefreshForHeights(g){let e=!1;for(let k=0;k<g.length;k++){let r=g[k];0>r?k++:this.heightSamples[Math.floor(10*r)]||(e=!0,this.heightSamples[Math.floor(10*r)]=!0)}return e}refresh(g,
e,k,r,x,G){let Q=-1<Fi.indexOf(g);g=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=Q;if(this.lineWrapping=Q,this.lineHeight=e,this.charWidth=k,this.textHeight=r,this.lineLength=x,g)for(this.heightSamples={},e=0;e<G.length;e++)k=G[e],0>k?e++:this.heightSamples[Math.floor(10*k)]=!0;return g}},Be=class{constructor(g,e){this.from=g;this.heights=e;this.index=0}get more(){return this.index<this.heights.length}},te=class g{constructor(e,k,r,x,G){this.from=e;this.length=k;this.top=r;this.height=
x;this._content=G}get type(){return"number"==typeof this._content?n.BlockType.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof rb?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(e){let k=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new g(this.from,
this.length+e.length,this.top,this.height+e.height,k)}},sd;(function(g){g[g.ByPos=0]="ByPos";g[g.ByHeight=1]="ByHeight";g[g.ByPosNoHeight=2]="ByPosNoHeight"})(sd||={});var Rd=class g{constructor(e,k,r=2){this.length=e;this.height=k;this.flags=r}get outdated(){return 0<(this.flags&2)}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(.001<Math.abs(this.height-e)&&(ne=!0),this.height=e)}replace(e,k,r){return g.of(r)}decomposeLeft(e,k){k.push(this)}decomposeRight(e,k){k.push(this)}applyChanges(e,
k,r,x){let G=this,Q=r.doc;for(let fa=x.length-1;0<=fa;fa--){let {fromA:ra,toA:Aa,fromB:Oa,toB:Ka}=x[fa];var aa=G.lineAt(ra,sd.ByPosNoHeight,r.setDoc(k),0,0);let Ra=aa.to>=Aa?aa:G.lineAt(Aa,sd.ByPosNoHeight,r,0,0);Ka+=Ra.to-Aa;for(Aa=Ra.to;0<fa&&aa.from<=x[fa-1].toA;)ra=x[fa-1].fromA,Oa=x[fa-1].fromB,fa--,ra<aa.from&&(aa=G.lineAt(ra,sd.ByPosNoHeight,r,0,0));Oa+=aa.from-ra;ra=aa.from;aa=wf.build(r.setDoc(Q),e,Oa,Ka);G=V(G,G.replace(ra,Aa,aa))}return G.updateHeight(r,0)}static empty(){return new Qd(0,
0)}static of(e){if(1==e.length)return e[0];let k=0,r=e.length;var x=0;let G=0;for(;;)if(k==r)if(x>2*G){var Q=e[k-1];Q.break?e.splice(--k,1,Q.left,null,Q.right):e.splice(--k,1,Q.left,Q.right);r+=1+Q.break;x-=Q.size}else if(G>2*x)Q=e[r],Q.break?e.splice(r,1,Q.left,null,Q.right):e.splice(r,1,Q.left,Q.right),r+=2+Q.break,G-=Q.size;else break;else x<G?(Q=e[k++])&&(x+=Q.size):(Q=e[--r])&&(G+=Q.size);x=0;return null==e[k-1]?(x=1,k--):null==e[k]&&(x=1,r++),new Gi(g.of(e.slice(0,k)),x,g.of(e.slice(r)))}};
Rd.prototype.size=1;var xf=class extends Rd{constructor(g,e,k){super(g,e);this.deco=k}blockAt(g,e,k,r){return new te(r,this.length,k,this.height,this.deco||0)}lineAt(g,e,k,r,x){return this.blockAt(0,k,r,x)}forEachLine(g,e,k,r,x,G){g<=x+this.length&&e>=x&&G(this.blockAt(0,k,r,x))}updateHeight(g,e=0,k,r){return r&&r.from<=e&&r.more&&this.setHeight(r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}},Qd=class g extends xf{constructor(e,k){super(e,k,null);this.breaks=
this.widgetHeight=this.collapsed=0}blockAt(e,k,r,x){return new te(x,this.length,r,this.height,this.breaks)}replace(e,k,r){e=r[0];return 1==r.length&&(e instanceof g||e instanceof Oe&&e.flags&4)&&10>Math.abs(this.length-e.length)?(e instanceof Oe?e=new g(e.length,this.height):e.height=this.height,this.outdated||(e.outdated=!1),e):Rd.of(r)}updateHeight(e,k=0,r=!1,x){return x&&x.from<=k&&x.more?this.setHeight(x.heights[x.index++]):(r||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-
this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}},Oe=class g extends Rd{constructor(e){super(e,0)}heightMetrics(e,k){let r=e.doc.lineAt(k).number;k=e.doc.lineAt(k+this.length).number;let x=k-r+1,G=0;if(e.lineWrapping){let Q=Math.min(this.height,e.lineHeight*x);e=Q/x;this.length>x+1&&(G=(this.height-Q)/(this.length-x-1))}else e=this.height/x;return{firstLine:r,lastLine:k,
perLine:e,perChar:G}}blockAt(e,k,r,x){let {firstLine:G,lastLine:Q,perLine:aa,perChar:fa}=this.heightMetrics(k,x);if(k.lineWrapping)return k=k.doc.lineAt(x+(e<k.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-r)/this.height))*this.length))),x=aa+k.length*fa,new te(k.from,k.length,Math.max(r,e-x/2),x,0);e=Math.max(0,Math.min(Q-G,Math.floor((e-r)/aa)));let {from:ra,length:Aa}=k.doc.line(G+e);return new te(ra,Aa,r+aa*e,aa,0)}lineAt(e,k,r,x,G){if(k==sd.ByHeight)return this.blockAt(e,r,x,G);if(k==sd.ByPosNoHeight){let {from:ra,
to:Aa}=r.doc.lineAt(e);return new te(ra,Aa-ra,0,0,0)}let {firstLine:Q,perLine:aa,perChar:fa}=this.heightMetrics(r,G);e=r.doc.lineAt(e);k=aa+e.length*fa;r=e.number-Q;return new te(e.from,e.length,Math.max(x,Math.min(x+aa*r+fa*(e.from-G-r),x+this.height-k)),k,0)}forEachLine(e,k,r,x,G,Q){e=Math.max(e,G);k=Math.min(k,G+this.length);let {firstLine:aa,perLine:fa,perChar:ra}=this.heightMetrics(r,G);for(let Oa=e,Ka=x;Oa<=k;){x=r.doc.lineAt(Oa);if(Oa==e){var Aa=x.number-aa;Ka+=fa*Aa+ra*(e-G-Aa)}Aa=fa+ra*x.length;
Q(new te(x.from,x.length,Ka,Aa,0));Ka+=Aa;Oa=x.to+1}}replace(e,k,r){k=this.length-k;if(0<k){let x=r[r.length-1];x instanceof g?r[r.length-1]=new g(x.length+k):r.push(null,new g(k-1))}0<e&&(k=r[0],k instanceof g?r[0]=new g(e+k.length):r.unshift(new g(e-1),null));return Rd.of(r)}decomposeLeft(e,k){k.push(new g(e-1),null)}decomposeRight(e,k){k.push(null,new g(this.length-e-1))}updateHeight(e,k=0,r=!1,x){let G=k+this.length;if(x&&x.from<=k+this.length&&x.more){let aa=[],fa=Math.max(k,x.from);r=-1;for(x.from>
k&&aa.push((new g(x.from-k-1)).updateHeight(e,k));fa<=G&&x.more;){let ra=e.doc.lineAt(fa).length;aa.length&&aa.push(null);var Q=x.heights[x.index++];-1==r?r=Q:.001<=Math.abs(Q-r)&&(r=-2);Q=new Qd(ra,Q);Q.outdated=!1;aa.push(Q);fa+=ra+1}fa<=G&&aa.push(null,(new g(G-fa)).updateHeight(e,fa));x=Rd.of(aa);return(0>r||.001<=Math.abs(x.height-this.height)||.001<=Math.abs(r-this.heightMetrics(e,k).perLine))&&(ne=!0),V(this,x)}(r||this.outdated)&&(this.setHeight(e.heightForGap(k,k+this.length)),this.outdated=
!1);return this}toString(){return`gap(${this.length})`}},Gi=class extends Rd{constructor(g,e,k){super(g.length+e+k.length,g.height+k.height,e|(g.outdated||k.outdated?2:0));this.left=g;this.right=k;this.size=g.size+k.size}get break(){return this.flags&1}blockAt(g,e,k,r){let x=k+this.left.height;return g<x?this.left.blockAt(g,e,k,r):this.right.blockAt(g,e,x,r+this.left.length+this.break)}lineAt(g,e,k,r,x){let G=r+this.left.height,Q=x+this.left.length+this.break,aa=e==sd.ByHeight?g<G:g<Q;g=aa?this.left.lineAt(g,
e,k,r,x):this.right.lineAt(g,e,k,G,Q);if(this.break||(aa?g.to<Q:g.from>Q))return g;e=e==sd.ByPosNoHeight?sd.ByPosNoHeight:sd.ByPos;return aa?g.join(this.right.lineAt(Q,e,k,G,Q)):this.left.lineAt(Q,e,k,r,x).join(g)}forEachLine(g,e,k,r,x,G){let Q=r+this.left.height,aa=x+this.left.length+this.break;if(this.break)g<aa&&this.left.forEachLine(g,e,k,r,x,G),e>=aa&&this.right.forEachLine(g,e,k,Q,aa,G);else{let fa=this.lineAt(aa,sd.ByPos,k,r,x);g<fa.from&&this.left.forEachLine(g,fa.from-1,k,r,x,G);fa.to>=g&&
fa.from<=e&&G(fa);e>fa.to&&this.right.forEachLine(fa.to+1,e,k,Q,aa,G)}}replace(g,e,k){var r=this.left.length+this.break;if(e<r)return this.balanced(this.left.replace(g,e,k),this.right);if(g>this.left.length)return this.balanced(this.left,this.right.replace(g-r,e-r,k));r=[];0<g&&this.decomposeLeft(g,r);let x=r.length;for(let G of k)r.push(G);if(0<g&&A(r,x-1),e<this.length)g=r.length,this.decomposeRight(e,r),A(r,g);return Rd.of(r)}decomposeLeft(g,e){let k=this.left.length;if(g<=k)return this.left.decomposeLeft(g,
e);e.push(this.left);this.break&&(k++,g>=k&&e.push(null));g>k&&this.right.decomposeLeft(g-k,e)}decomposeRight(g,e){let k=this.left.length,r=k+this.break;if(g>=r)return this.right.decomposeRight(g-r,e);g<k&&this.left.decomposeRight(g,e);this.break&&g<r&&e.push(null);e.push(this.right)}balanced(g,e){return g.size>2*e.size||e.size>2*g.size?Rd.of(this.break?[g,null,e]:[g,e]):(this.left=V(this.left,g),this.right=V(this.right,e),this.setHeight(g.height+e.height),this.outdated=g.outdated||e.outdated,this.size=
g.size+e.size,this.length=g.length+this.break+e.length,this)}updateHeight(g,e=0,k=!1,r){let {left:x,right:G}=this,Q=e+x.length+this.break,aa=null;return r&&r.from<=e+x.length&&r.more?aa=x=x.updateHeight(g,e,k,r):x.updateHeight(g,e,k),r&&r.from<=Q+G.length&&r.more?aa=G=G.updateHeight(g,Q,k,r):G.updateHeight(g,Q,k),aa?this.balanced(x,G):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}},wf=class g{constructor(e,k){this.pos=
e;this.oracle=k;this.nodes=[];this.lineEnd=this.lineStart=-1;this.covering=null;this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,k){if(-1<this.lineStart){e=Math.min(k,this.lineEnd);let r=this.nodes[this.nodes.length-1];r instanceof Qd?r.length+=e-this.pos:(e>this.pos||!this.isCovered)&&this.nodes.push(new Qd(e-this.pos,-1));this.writtenTo=e;k>e&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=k}point(e,k,r){if(e<k||r.heightRelevant){let x=
r.widget?r.widget.estimatedHeight:0,G=r.widget?r.widget.lineBreaks:0;0>x&&(x=this.oracle.lineHeight);e=k-e;r.block?this.addBlock(new xf(e,x,r)):(e||G||5<=x)&&this.addLineDeco(x,G,e)}else k>e&&this.span(e,k);-1<this.lineEnd&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(!(-1<this.lineStart)){var {from:e,to:k}=this.oracle.doc.lineAt(this.pos);this.lineStart=e;this.lineEnd=k;this.writtenTo<e&&((this.writtenTo<e-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,
e-1)),this.nodes.push(null));this.pos>e&&this.nodes.push(new Qd(this.pos-e,-1));this.writtenTo=this.pos}}blankContent(e,k){let r=new Oe(k-e);return this.oracle.doc.lineAt(e).to==k&&(r.flags|=4),r}ensureLine(){this.enterLine();var e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Qd)return e;e=new Qd(0,-1);return this.nodes.push(e),e}addBlock(e){this.enterLine();let k=e.deco;k&&0<k.startSide&&!this.isCovered&&this.ensureLine();this.nodes.push(e);this.writtenTo=this.pos+=e.length;
k&&0<k.endSide&&(this.covering=e)}addLineDeco(e,k,r){let x=this.ensureLine();x.length+=r;x.collapsed+=r;x.widgetHeight=Math.max(x.widgetHeight,e);x.breaks+=k;this.writtenTo=this.pos+=r}finish(e){let k=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(-1<this.lineStart)||k instanceof Qd||this.isCovered?(this.writtenTo<this.pos||null==k)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new Qd(0,-1));for(let r of this.nodes)r instanceof Qd&&r.updateHeight(this.oracle,
e),e+=r?r.length:1;return this.nodes}static build(e,k,r,x){e=new g(r,e);return $a.RangeSet.spans(k,r,x,e,0),e.finish(r)}},zi=class{constructor(){this.changes=[]}compareRange(){}comparePoint(g,e,k,r){(g<e||k&&k.heightRelevant||r&&r.heightRelevant)&&Db(g,e,this.changes,5)}},ph=class{constructor(g,e,k,r){this.from=g;this.to=e;this.size=k;this.displaySize=r}static same(g,e){if(g.length!=e.length)return!1;for(let k=0;k<g.length;k++){let r=g[k],x=e[k];if(r.from!=x.from||r.to!=x.to||r.size!=x.size)return!1}return!0}draw(g,
e){return xa.replace({widget:new Pj(this.displaySize*(e?g.scaleY:g.scaleX),e)}).range(this.from,this.to)}},Pj=class extends Ga{constructor(g,e){super();this.size=g;this.vertical=e}eq(g){return g.size==this.size&&g.vertical==this.vertical}toDOM(){let g=document.createElement("div");return this.vertical?g.style.height=this.size+"px":(g.style.width=this.size+"px",g.style.height="2px",g.style.display="inline-block"),g}get estimatedHeight(){return this.vertical?this.size:-1}},Hi=class{constructor(g){this.state=
g;this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0};this.inView=!0;this.scrollTop=this.editorWidth=this.editorHeight=this.contentDOMHeight=this.contentDOMWidth=this.paddingBottom=this.paddingTop=0;this.scrolledToBottom=!1;this.scaleY=this.scaleX=1;this.scrollAnchorPos=0;this.scrollAnchorHeight=-1;this.scaler=$h;this.scrollTarget=null;this.printing=!1;this.mustMeasureContent=!0;this.defaultTextDirection=n.Direction.LTR;this.visibleRanges=[];this.mustEnforceCursorAssoc=!1;let e=g.facet(vf).some(k=>
"function"!=typeof k&&"cm-lineWrapping"==k.class);this.heightOracle=new oh(e);this.stateDeco=g.facet(uf).filter(k=>"function"!=typeof k);this.heightMap=Rd.empty().applyChanges(this.stateDeco,$a.Text.empty,this.heightOracle.setDoc(g.doc),[new ye(0,0,0,g.doc.length)]);for(g=0;2>g&&(this.viewport=this.getViewport(0,null),this.updateForViewport());g++);this.updateViewportLines();this.lineGaps=this.ensureLineGaps([]);this.lineGapDeco=xa.set(this.lineGaps.map(k=>k.draw(this,!1)));this.computeVisibleRanges()}updateForViewport(){let g=
[this.viewport],{main:e}=this.state.selection;for(let k=0;1>=k;k++){let r=k?e.head:e.anchor;if(!g.some(({from:x,to:G})=>r>=x&&r<=G)){let {from:x,to:G}=this.lineBlockAt(r);g.push(new Uf(x,G))}}return this.viewports=g.sort((k,r)=>k.from-r.from),this.updateScaler()}updateScaler(){let g=this.scaler;return this.scaler=7E6>=this.heightMap.height?$h:new qh(this.heightOracle,this.heightMap,this.viewports),g.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[];this.heightMap.forEachLine(this.viewport.from,
this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,g=>{this.viewportLines.push(Ab(g,this.scaler))})}update(g,e=null){this.state=g.state;var k=this.stateDeco;this.stateDeco=this.state.facet(uf).filter(G=>"function"!=typeof G);k=ye.extendWithRanges(g.changedRanges,J(k,this.stateDeco,g?g.changes:$a.ChangeSet.empty(this.state.doc.length)));var r=this.heightMap.height;let x=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);ne=!1;this.heightMap=this.heightMap.applyChanges(this.stateDeco,
g.startState.doc,this.heightOracle.setDoc(this.state.doc),k);(this.heightMap.height!=r||ne)&&(g.flags|=2);x?(this.scrollAnchorPos=g.changes.mapPos(x.from,-1),this.scrollAnchorHeight=x.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=r);k=k.length?this.mapViewport(this.viewport,g.changes):this.viewport;(e&&(e.range.head<k.from||e.range.head>k.to)||!this.viewportIsAppropriate(k))&&(k=this.getViewport(0,e));r=k.from!=this.viewport.from||k.to!=this.viewport.to;this.viewport=k;g.flags|=this.updateForViewport();
(r||!g.changes.empty||g.flags&2)&&this.updateViewportLines();(this.lineGaps.length||4E3<this.viewport.to-this.viewport.from)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,g.changes)));g.flags|=this.computeVisibleRanges(g.changes);e&&(this.scrollTarget=e);!this.mustEnforceCursorAssoc&&g.selectionSet&&g.view.lineWrapping&&g.state.selection.main.empty&&g.state.selection.main.assoc&&!g.state.facet(hh)&&(this.mustEnforceCursorAssoc=!0)}measure(g){var e=g.contentDOM,k=window.getComputedStyle(e),
r=this.heightOracle,x=k.whiteSpace;this.defaultTextDirection="rtl"==k.direction?n.Direction.RTL:n.Direction.LTR;let G=this.heightOracle.mustRefreshForWrapping(x);var Q=e.getBoundingClientRect();let aa=G||this.mustMeasureContent||this.contentDOMHeight!=Q.height;this.contentDOMHeight=Q.height;this.mustMeasureContent=!1;let fa=0,ra=0;if(Q.width&&Q.height){let {scaleX:Ka,scaleY:Ra}=ca(e,Q);(.005<Ka&&.005<Math.abs(this.scaleX-Ka)||.005<Ra&&.005<Math.abs(this.scaleY-Ra))&&(this.scaleX=Ka,this.scaleY=Ra,
fa|=16,G=aa=!0)}var Aa=(parseInt(k.paddingTop)||0)*this.scaleY;k=(parseInt(k.paddingBottom)||0)*this.scaleY;(this.paddingTop!=Aa||this.paddingBottom!=k)&&(this.paddingTop=Aa,this.paddingBottom=k,fa|=18);this.editorWidth!=g.scrollDOM.clientWidth&&(r.lineWrapping&&(aa=!0),this.editorWidth=g.scrollDOM.clientWidth,fa|=16);Aa=g.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=Aa&&(this.scrollAnchorHeight=-1,this.scrollTop=Aa);this.scrolledToBottom=sa(g.scrollDOM);k=(this.printing?ea:W)(e,this.paddingTop);
e=k.top-this.pixelViewport.top;Aa=k.bottom-this.pixelViewport.bottom;this.pixelViewport=k;k=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;k!=this.inView&&(this.inView=k,k&&(aa=!0));if(k=!this.inView&&!this.scrollTarget){var Oa=g.dom;k=Oa.getBoundingClientRect();Oa=Oa.ownerDocument.defaultView||window;k=!(k.left<Oa.innerWidth&&0<k.right&&k.top<Oa.innerHeight&&0<k.bottom)}if(k)return 0;k=Q.width;if((this.contentDOMWidth!=k||this.editorHeight!=g.scrollDOM.clientHeight)&&
(this.contentDOMWidth=Q.width,this.editorHeight=g.scrollDOM.clientHeight,fa|=16),aa){Q=g.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(Q)&&(G=!0),G||r.lineWrapping&&Math.abs(k-this.contentDOMWidth)>r.charWidth){let {lineHeight:Ka,charWidth:Ra,textHeight:nb}=g.docView.measureTextSize();(G=0<Ka&&r.refresh(x,Ka,Ra,nb,k/Ra,Q))&&(g.docView.minWidth=0,fa|=16)}0<e&&0<Aa?ra=Math.max(e,Aa):0>e&&0>Aa&&(ra=Math.min(e,Aa));ne=!1;for(let Ka of this.viewports)x=Ka.from==this.viewport.from?
Q:g.docView.measureVisibleLineHeights(Ka),this.heightMap=(G?Rd.empty().applyChanges(this.stateDeco,$a.Text.empty,this.heightOracle,[new ye(0,0,0,g.state.doc.length)]):this.heightMap).updateHeight(r,0,G,new Be(Ka.from,x));ne&&(fa|=2)}r=!this.viewportIsAppropriate(this.viewport,ra)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return r&&(fa&2&&(fa|=this.updateScaler()),this.viewport=this.getViewport(ra,this.scrollTarget),fa|=this.updateForViewport()),
(fa&2||r)&&this.updateViewportLines(),(this.lineGaps.length||4E3<this.viewport.to-this.viewport.from)&&this.updateLineGaps(this.ensureLineGaps(G?[]:this.lineGaps,g)),fa|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,g.docView.enforceCursorAssoc()),fa}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(g,e){var k=.5-Math.max(-.5,Math.min(.5,g/1E3/2));g=this.heightMap;
let r=this.heightOracle,{visibleTop:x,visibleBottom:G}=this;k=new Uf(g.lineAt(x-1E3*k,sd.ByHeight,r,0,0).from,g.lineAt(G+1E3*(1-k),sd.ByHeight,r,0,0).to);if(e){let {head:Q}=e.range;if(Q<k.from||Q>k.to){let aa=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),fa=g.lineAt(Q,sd.ByPos,r,0,0),ra;"center"==e.y?ra=(fa.top+fa.bottom)/2-aa/2:"start"==e.y||"nearest"==e.y&&Q<k.from?ra=fa.top:ra=fa.bottom-aa;k=new Uf(g.lineAt(ra-500,sd.ByHeight,r,0,0).from,g.lineAt(ra+aa+500,sd.ByHeight,
r,0,0).to)}}return k}mapViewport(g,e){let k=e.mapPos(g.from,-1);g=e.mapPos(g.to,1);return new Uf(this.heightMap.lineAt(k,sd.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(g,sd.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:g,to:e},k=0){if(!this.inView)return!0;let {top:r}=this.heightMap.lineAt(g,sd.ByPos,this.heightOracle,0,0),{bottom:x}=this.heightMap.lineAt(e,sd.ByPos,this.heightOracle,0,0),{visibleTop:G,visibleBottom:Q}=this;return(0==g||r<=G-Math.max(10,Math.min(-k,250)))&&
(e==this.state.doc.length||x>=Q+Math.max(10,Math.min(k,250)))&&r>G-2E3&&x<Q+2E3}mapLineGaps(g,e){if(!g.length||e.empty)return g;let k=[];for(let r of g)e.touchesRange(r.from,r.to)||k.push(new ph(e.mapPos(r.from),e.mapPos(r.to),r.size,r.displaySize));return k}ensureLineGaps(g,e){let k=this.heightOracle.lineWrapping,r=k?1E4:2E3,x=r>>1,G=r<<1;if(this.defaultTextDirection!=n.Direction.LTR&&!k)return[];let Q=[],aa=(ra,Aa,Oa,Ka)=>{if(!(Aa-ra<x)){var Ra=this.state.selection.main,nb=[Ra.from];Ra.empty||nb.push(Ra.to);
for(let xb of nb)if(xb>ra&&xb<Aa){aa(ra,xb-10,Oa,Ka);aa(xb+10,Aa,Oa,Ka);return}Ra=fb(g,xb=>xb.from>=Oa.from&&xb.to<=Oa.to&&Math.abs(xb.from-ra)<x&&Math.abs(xb.to-Aa)<x&&!nb.some(Rb=>xb.from<Rb&&xb.to>Rb));Ra||(Aa<Oa.to&&e&&k&&e.visibleRanges.some(xb=>xb.from<=Aa&&xb.to>=Aa)&&(Ra=e.moveToLineBoundary($a.EditorSelection.cursor(Aa),!1,!0).head,Ra>ra&&(Aa=Ra)),Ka=this.gapSize(Oa,ra,Aa,Ka),Ra=new ph(ra,Aa,Ka,k||2E6>Ka?Ka:2E6));Q.push(Ra)}},fa=ra=>{if(!(ra.length<G||ra.type!=n.BlockType.Text)){var Aa=qa(ra.from,
ra.to,this.stateDeco);if(!(Aa.total<G)){var Oa=this.scrollTarget?this.scrollTarget.range.head:null;if(k){var Ka=r/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=Oa){Oa=Wa(Aa,Oa);Ka=((this.visibleBottom-this.visibleTop)/2+Ka)/ra.height;var Ra=Oa-Ka;Ka=Oa+Ka}else Ra=(this.visibleTop-ra.top-Ka)/ra.height,Ka=(this.visibleBottom-ra.top+Ka)/ra.height;Ra=za(Aa,Ra);Ka=za(Aa,Ka)}else{Ra=Aa.total*this.heightOracle.charWidth;Ka=r*this.heightOracle.charWidth;var nb=0;if(2E6<Ra)for(var xb of g)xb.from>=
ra.from&&xb.from<ra.to&&xb.size!=xb.displaySize&&xb.from*this.heightOracle.charWidth+nb<this.pixelViewport.left&&(nb=xb.size-xb.displaySize);xb=this.pixelViewport.left+nb;nb=this.pixelViewport.right+nb;if(null!=Oa){let Rb=Wa(Aa,Oa);Ra=((nb-xb)/2+Ka)/Ra;Oa=Rb-Ra;Ka=Rb+Ra}else Oa=(xb-Ka)/Ra,Ka=(nb+Ka)/Ra;Ra=za(Aa,Oa);Ka=za(Aa,Ka)}Ra>ra.from&&aa(ra.from,Ra,ra,Aa);Ka<ra.to&&aa(Ka,ra.to,ra,Aa)}}};for(let ra of this.viewportLines)Array.isArray(ra.type)?ra.type.forEach(fa):fa(ra);return Q}gapSize(g,e,k,
r){e=Wa(r,k)-Wa(r,e);return this.heightOracle.lineWrapping?g.height*e:r.total*this.heightOracle.charWidth*e}updateLineGaps(g){ph.same(g,this.lineGaps)||(this.lineGaps=g,this.lineGapDeco=xa.set(g.map(e=>e.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(g){var e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let k=[];$a.RangeSet.spans(e,this.viewport.from,this.viewport.to,{span(r,x){k.push({from:r,to:x})},point(){}},20);e=0;if(k.length!=this.visibleRanges.length)e=
12;else for(let r=0;r<k.length&&!(e&8);r++){let x=this.visibleRanges[r],G=k[r];(x.from!=G.from||x.to!=G.to)&&(e|=4,g&&g.mapPos(x.from,-1)==G.from&&g.mapPos(x.to,1)==G.to||(e|=8))}return this.visibleRanges=k,e}lineBlockAt(g){return g>=this.viewport.from&&g<=this.viewport.to&&this.viewportLines.find(e=>e.from<=g&&e.to>=g)||Ab(this.heightMap.lineAt(g,sd.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(g){return g>=this.viewportLines[0].top&&g<=this.viewportLines[this.viewportLines.length-
1].bottom&&this.viewportLines.find(e=>e.top<=g&&e.bottom>=g)||Ab(this.heightMap.lineAt(this.scaler.fromDOM(g),sd.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(g){let e=this.lineBlockAtHeight(g+8);return e.from>=this.viewport.from||200<this.viewportLines[0].top-g?e:this.viewportLines[0]}elementAtHeight(g){return Ab(this.heightMap.blockAt(this.scaler.fromDOM(g),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+
this.paddingTop+this.paddingBottom}},Uf=class{constructor(g,e){this.from=g;this.to=e}},$h={toDOM(g){return g},fromDOM(g){return g},scale:1,eq(g){return g==this}},qh=class g{constructor(e,k,r){let x=0,G=0,Q=0;this.viewports=r.map(({from:aa,to:fa})=>{let ra=k.lineAt(aa,sd.ByPos,e,0,0).top,Aa=k.lineAt(fa,sd.ByPos,e,0,0).bottom;return x+=Aa-ra,{from:aa,to:fa,top:ra,bottom:Aa,domTop:0,domBottom:0}});this.scale=(7E6-x)/(k.height-x);for(let aa of this.viewports)aa.domTop=Q+(aa.top-G)*this.scale,Q=aa.domBottom=
aa.domTop+(aa.bottom-aa.top),G=aa.bottom}toDOM(e){for(let k=0,r=0,x=0;;k++){let G=k<this.viewports.length?this.viewports[k]:null;if(!G||e<G.top)return x+(e-r)*this.scale;if(e<=G.bottom)return G.domTop+(e-G.top);r=G.bottom;x=G.domBottom}}fromDOM(e){for(let k=0,r=0,x=0;;k++){let G=k<this.viewports.length?this.viewports[k]:null;if(!G||e<G.domTop)return r+(e-x)/this.scale;if(e<=G.domBottom)return G.top+(e-G.domTop);r=G.bottom;x=G.domBottom}}eq(e){return e instanceof g?this.scale==e.scale&&this.viewports.length==
e.viewports.length&&this.viewports.every((k,r)=>k.from==e.viewports[r].from&&k.to==e.viewports[r].to):!1}},vg=$a.Facet.define({combine:g=>g.join(" ")}),wg=$a.Facet.define({combine:g=>-1<g.indexOf(!0)}),vd=xd.StyleModule.newName(),ai=xd.StyleModule.newName(),fd=xd.StyleModule.newName(),Ce={"&light":"."+ai,"&dark":"."+fd},Ii=Ib("."+vd,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",
alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",
flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},
".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},
".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},
"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",
position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",
userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},
".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",
padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Ce),Ji={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Id=mc.ie&&11>=mc.ie_version,ff=class{constructor(g){this.view=g;this.active=!1;this.editContext=null;this.selectionRange=new qe;this.selectionChanged=!1;this.resizeTimeout=this.delayedFlush=-1;this.queue=[];this.delayedAndroidKey=null;this.flushingAndroidKey=-1;this.lastChange=
0;this.scrollTargets=[];this.resizeScroll=this.intersection=null;this.intersecting=!1;this.gapIntersection=null;this.gaps=[];this.printQuery=null;this.parentCheck=-1;this.dom=g.contentDOM;this.observer=new MutationObserver(e=>{for(let k of e)this.queue.push(k);(mc.ie&&11>=mc.ie_version||mc.ios&&g.composing)&&e.some(k=>"childList"==k.type&&k.removedNodes.length||"characterData"==k.type&&k.oldValue.length>k.target.nodeValue.length)?this.flushSoon():this.flush()});window.EditContext&&!1!==g.constructor.EDIT_CONTEXT&&
!(mc.chrome&&126>mc.chrome_version)&&(this.editContext=new bi(g),g.state.facet(Ne)&&(g.contentDOM.editContext=this.editContext.editContext));Id&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue});this.flushSoon()});this.onSelectionChange=this.onSelectionChange.bind(this);this.onResize=this.onResize.bind(this);this.onPrint=this.onPrint.bind(this);this.onScroll=this.onScroll.bind(this);window.matchMedia&&(this.printQuery=window.matchMedia("print"));"function"==
typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver(()=>{var e;(null===(e=this.view.docView)||void 0===e?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(g.scrollDOM));this.addWindowListeners(this.win=g.win);this.start();"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver(e=>{0>this.parentCheck&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1E3));0<e.length&&0<e[e.length-1].intersectionRatio!=this.intersecting&&
(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{0<e.length&&0<e[e.length-1].intersectionRatio&&this.onScrollChanged(document.createEvent("Event"))},{}));this.listenForScroll();this.readSelectionRange()}onScrollChanged(g){this.view.inputState.runHandlers("scroll",g);this.intersecting&&this.view.measure()}onScroll(g){this.intersecting&&
this.flush(!1);this.editContext&&this.view.requestMeasure(this.editContext.measureReq);this.onScrollChanged(g)}onResize(){0>this.resizeTimeout&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1;this.view.requestMeasure()},50))}onPrint(g){!("change"!=g.type&&g.type||g.matches)||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1;this.view.requestMeasure()},500))}updateGaps(g){if(this.gapIntersection&&(g.length!=this.gaps.length||this.gaps.some((e,
k)=>e!=g[k]))){this.gapIntersection.disconnect();for(let e of g)this.gapIntersection.observe(e);this.gaps=g}}onSelectionChange(g){let e=this.selectionChanged;if(this.readSelectionRange()&&!this.delayedAndroidKey){var {view:k}=this,r=this.selectionRange;if(k.state.facet(Ne)?k.root.activeElement==this.dom:u(this.dom,r)){var x=r.anchorNode&&k.docView.nearest(r.anchorNode);x&&x.ignoreEvent(g)?e||(this.selectionChanged=!1):(mc.ie&&11>=mc.ie_version||mc.android&&mc.chrome)&&!k.state.selection.main.empty&&
r.focusNode&&y(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}}}readSelectionRange(){let {view:g}=this;var e=p(g.root);if(!e)return!1;e=mc.safari&&11==g.root.nodeType&&g.root.activeElement==this.dom&&R(this.view,e)||e;if(!e||this.selectionRange.eq(e))return!1;let k=u(this.dom,e);var r;if(r=k&&!this.selectionChanged&&g.inputState.lastFocusTime>Date.now()-200&&g.inputState.lastTouchTime<Date.now()-300)a:{r=this.dom;let x=e.focusNode,G=e.focusOffset;if(x&&e.anchorNode==
x&&e.anchorOffset==G)for(G=Math.min(G,H(x));;)if(G){if(1!=x.nodeType){r=!1;break a}let Q=x.childNodes[G-1];"false"==Q.contentEditable?G--:(x=Q,G=H(x))}else{if(x==r){r=!0;break a}G=B(x);x=x.parentNode}else r=!1}return r?(this.view.inputState.lastFocusTime=0,g.docView.updateSelection(),!1):(this.selectionRange.setRange(e),k&&(this.selectionChanged=!0),!0)}setSelectionRange(g,e){this.selectionRange.set(g.node,g.offset,e.node,e.offset);this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,
0,null,0)}listenForScroll(){this.parentCheck=-1;let g=0,e=null;for(let k=this.dom;k;)if(1==k.nodeType)!e&&g<this.scrollTargets.length&&this.scrollTargets[g]==k?g++:e||=this.scrollTargets.slice(0,g),e&&e.push(k),k=k.assignedSlot||k.parentNode;else if(11==k.nodeType)k=k.host;else break;if(g<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,g)),e){for(let k of this.scrollTargets)k.removeEventListener("scroll",this.onScroll);for(let k of this.scrollTargets=e)k.addEventListener("scroll",this.onScroll)}}ignore(g){if(!this.active)return g();
try{return this.stop(),g()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Ji),Id&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Id&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords();this.queue.length=0;this.selectionChanged=!1}delayAndroidKey(g,e){var k;this.delayedAndroidKey||(this.flushingAndroidKey=
this.view.win.requestAnimationFrame(()=>{let r=this.delayedAndroidKey;r&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=r.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&r.force&&ua(this.dom,r.key,r.keyCode))}));this.delayedAndroidKey&&"Enter"!=g||(this.delayedAndroidKey={key:g,keyCode:e,force:this.lastChange<Date.now()-50||!(null===(k=this.delayedAndroidKey)||void 0===k||!k.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey);
this.delayedAndroidKey=null;this.flushingAndroidKey=-1}flushSoon(){0>this.delayedFlush&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1;this.flush()}))}forceFlush(){0<=this.delayedFlush&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1);this.flush()}pendingRecords(){for(let g of this.observer.takeRecords())this.queue.push(g);return this.queue}processRecords(){var g=this.pendingRecords();g.length&&(this.queue=[]);let e=-1,k=-1,r=!1;for(let x of g)(g=
this.readMutation(x))&&(g.typeOver&&(r=!0),-1==e?{from:e,to:k}=g:(e=Math.min(g.from,e),k=Math.max(g.to,k)));return{from:e,to:k,typeOver:r}}readChange(){let {from:g,to:e,typeOver:k}=this.processRecords();var r=this.selectionChanged&&u(this.dom,this.selectionRange);if(0>g&&!r)return null;-1<g&&(this.lastChange=Date.now());this.view.inputState.lastFocusTime=0;this.selectionChanged=!1;r=new Zh(this.view,g,e,k);return this.view.docView.domChanged={newSel:r.newSel?r.newSel.main:null},r}flush(g=!0){if(0<=
this.delayedFlush||this.delayedAndroidKey)return!1;g&&this.readSelectionRange();g=this.readChange();if(!g)return this.view.requestMeasure(),!1;let e=this.view.state,k=jd(this.view,g);return this.view.state==e&&(g.domChanged||g.newSel&&!g.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),k}readMutation(g){let e=this.view.docView.nearest(g.target);if(!e||e.ignoreMutation(g))return null;if(e.markDirty("attributes"==g.type),"attributes"==g.type&&(e.flags|=4),"childList"==g.type){let k=
uc(e,g.previousSibling||g.target.previousSibling,-1);g=uc(e,g.nextSibling||g.target.nextSibling,1);return{from:k?e.posAfter(k):e.posAtStart,to:g?e.posBefore(g):e.posAtEnd,typeOver:!1}}return"characterData"==g.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:g.target.nodeValue==g.oldValue}:null}setWindow(g){g!=this.win&&(this.removeWindowListeners(this.win),this.win=g,this.addWindowListeners(this.win))}addWindowListeners(g){g.addEventListener("resize",this.onResize);this.printQuery?this.printQuery.addEventListener?
this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):g.addEventListener("beforeprint",this.onPrint);g.addEventListener("scroll",this.onScroll);g.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(g){g.removeEventListener("scroll",this.onScroll);g.removeEventListener("resize",this.onResize);this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):
g.removeEventListener("beforeprint",this.onPrint);g.document.removeEventListener("selectionchange",this.onSelectionChange)}update(g){this.editContext&&(this.editContext.update(g),g.startState.facet(Ne)!=g.state.facet(Ne)&&(g.view.contentDOM.editContext=g.state.facet(Ne)?this.editContext.editContext:null))}destroy(){var g,e,k;this.stop();null===(g=this.intersection)||void 0===g||g.disconnect();null===(e=this.gapIntersection)||void 0===e||e.disconnect();null===(k=this.resizeScroll)||void 0===k||k.disconnect();
for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win);clearTimeout(this.parentCheck);clearTimeout(this.resizeTimeout);this.win.cancelAnimationFrame(this.delayedFlush);this.win.cancelAnimationFrame(this.flushingAndroidKey);this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}},bi=class{constructor(g){this.to=this.from=0;this.pendingContextChange=null;this.handlers=Object.create(null);this.composing=null;this.resetRange(g.state);
let e=this.editContext=new window.EditContext({text:g.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,g.state.selection.main.anchor))),selectionEnd:this.toContextPos(g.state.selection.main.head)});this.handlers.textupdate=k=>{var r=g.state.selection.main;let {anchor:x,head:G}=r,Q=this.toEditorPos(k.updateRangeStart),aa=this.toEditorPos(k.updateRangeEnd);0<=g.inputState.composing&&!this.composing&&(this.composing={contextBase:k.updateRangeStart,
editorBase:Q,drifted:!1});let fa={from:Q,to:aa,insert:$a.Text.of(k.text.split("\n"))};(fa.from==this.from&&x<this.from?fa.from=x:fa.to==this.to&&x>this.to&&(fa.to=x),fa.from!=fa.to||fa.insert.length)?(((mc.mac||mc.android)&&fa.from==G-1&&/^\. ?$/.test(k.text)&&"off"==g.contentDOM.getAttribute("autocorrect")&&(fa={from:Q,to:aa,insert:$a.Text.of([k.text.replace("."," ")])}),this.pendingContextChange=fa,g.state.readOnly)||(r=this.to-this.from+(fa.to-fa.from+fa.insert.length),wc(g,fa,$a.EditorSelection.single(this.toEditorPos(k.selectionStart,
r),this.toEditorPos(k.selectionEnd,r)))),this.pendingContextChange&&(this.revertPending(g.state),this.setSelection(g.state))):(k=$a.EditorSelection.single(this.toEditorPos(k.selectionStart),this.toEditorPos(k.selectionEnd)),k.main.eq(r)||g.dispatch({selection:k,userEvent:"select"}))};this.handlers.characterboundsupdate=k=>{let r=[],x=null;for(let G=this.toEditorPos(k.rangeStart),Q=this.toEditorPos(k.rangeEnd);G<Q;G++){let aa=g.coordsForChar(G);x=aa&&new DOMRect(aa.left,aa.top,aa.right-aa.left,aa.bottom-
aa.top)||x||new DOMRect;r.push(x)}e.updateCharacterBounds(k.rangeStart,r)};this.handlers.textformatupdate=k=>{let r=[];for(let x of k.getTextFormats()){k=x.underlineStyle;let G=x.underlineThickness;if("None"!=k&&"None"!=G){let Q=this.toEditorPos(x.rangeStart),aa=this.toEditorPos(x.rangeEnd);Q<aa&&r.push(xa.mark({attributes:{style:`text-decoration: underline ${"Dashed"==k?"dashed ":"Squiggle"==k?"wavy ":""}${"Thin"==G?1:2}px`}}).range(Q,aa))}}g.dispatch({effects:Bc.of(xa.set(r))})};this.handlers.compositionstart=
()=>{0>g.inputState.composing&&(g.inputState.composing=0,g.inputState.compositionFirstChange=!0)};this.handlers.compositionend=()=>{if(g.inputState.composing=-1,g.inputState.compositionFirstChange=null,this.composing){let {drifted:k}=this.composing;this.composing=null;k&&this.reset(g.state)}};for(let k in this.handlers)e.addEventListener(k,this.handlers[k]);this.measureReq={read:k=>{this.editContext.updateControlBounds(k.contentDOM.getBoundingClientRect());(k=p(k.root))&&k.rangeCount&&this.editContext.updateSelectionBounds(k.getRangeAt(0).getBoundingClientRect())}}}applyEdits(g){let e=
0,k=!1,r=this.pendingContextChange;return g.changes.iterChanges((x,G,Q,aa,fa)=>{if(!k){Q=fa.length-(G-x);if(r&&G>=r.to){if(r.from==x&&r.to==G&&r.insert.eq(fa)){r=this.pendingContextChange=null;e+=Q;this.to+=Q;return}r=null;this.revertPending(g.state)}if(x+=e,G+=e,G<=this.from)this.from+=Q,this.to+=Q;else if(x<this.to){if(x<this.from||G>this.to||3E4<this.to-this.from+fa.length){k=!0;return}this.editContext.updateText(this.toContextPos(x),this.toContextPos(G),fa.toString());this.to+=Q}e+=Q}}),r&&!k&&
this.revertPending(g.state),!k}update(g){let e=this.pendingContextChange,k=g.startState.selection.main;this.composing&&(this.composing.drifted||!g.changes.touchesRange(k.from,k.to)&&g.transactions.some(r=>!r.isUserEvent("input.type")&&r.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=g.changes.mapPos(this.composing.editorBase)):this.applyEdits(g)&&this.rangeIsValid(g.state)?(g.docChanged||g.selectionSet||e)&&this.setSelection(g.state):(this.pendingContextChange=
null,this.reset(g.state));(g.geometryChanged||g.docChanged||g.selectionSet)&&g.view.requestMeasure(this.measureReq)}resetRange(g){let {head:e}=g.selection.main;this.from=Math.max(0,e-1E4);this.to=Math.min(g.doc.length,e+1E4)}reset(g){this.resetRange(g);this.editContext.updateText(0,this.editContext.text.length,g.doc.sliceString(this.from,this.to));this.setSelection(g)}revertPending(g){let e=this.pendingContextChange;this.pendingContextChange=null;this.editContext.updateText(this.toContextPos(e.from),
this.toContextPos(e.from+e.insert.length),g.doc.sliceString(e.from,e.to))}setSelection(g){var {main:e}=g.selection;g=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor)));e=this.toContextPos(e.head);this.editContext.selectionStart==g&&this.editContext.selectionEnd==e||this.editContext.updateSelection(g,e)}rangeIsValid(g){let {head:e}=g.selection.main;return!(0<this.from&&500>e-this.from||this.to<g.doc.length&&500>this.to-e||3E4<this.to-this.from)}toEditorPos(g,e=this.to-this.from){g=Math.min(g,
e);return(e=this.composing)&&e.drifted?e.editorBase+(g-e.contextBase):g+this.from}toContextPos(g){let e=this.composing;return e&&e.drifted?e.contextBase+(g-e.editorBase):g-this.from}destroy(){for(let g in this.handlers)this.editContext.removeEventListener(g,this.handlers[g])}},ad=class g{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return 0<this.inputState.composing}get compositionStarted(){return 0<=
this.inputState.composing}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var k;this.plugins=[];this.pluginMap=new Map;this.editorAttrs={};this.contentAttrs={};this.bidiCache=[];this.destroyed=!1;this.updateState=2;this.measureScheduled=-1;this.measureRequests=[];this.contentDOM=document.createElement("div");this.scrollDOM=document.createElement("div");this.scrollDOM.tabIndex=-1;this.scrollDOM.className="cm-scroller";this.scrollDOM.appendChild(this.contentDOM);
this.announceDOM=document.createElement("div");this.announceDOM.className="cm-announced";this.announceDOM.setAttribute("aria-live","polite");this.dom=document.createElement("div");this.dom.appendChild(this.announceDOM);this.dom.appendChild(this.scrollDOM);e.parent&&e.parent.appendChild(this.dom);let {dispatch:r}=e;this.dispatchTransactions=e.dispatchTransactions||r&&(x=>x.forEach(G=>r(G,this)))||(x=>this.update(x));this.dispatch=this.dispatch.bind(this);this._root=e.root||Va(e.parent)||document;this.viewState=
new Hi(e.state||$a.EditorState.create(e));e.scrollTo&&e.scrollTo.is(ug)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state));this.plugins=this.state.facet(Sf).map(x=>new jh(x));for(let x of this.plugins)x.update(this);this.observer=new ff(this);this.inputState=new Di(this);this.inputState.ensureHandlers(this.plugins);this.docView=new lh(this);this.mountStyles();this.updateAttrs();this.updateState=0;this.requestMeasure();null!==(k=document.fonts)&&void 0!==k&&k.ready&&document.fonts.ready.then(()=>
this.requestMeasure())}dispatch(...e){e=1==e.length&&e[0]instanceof $a.Transaction?e:1==e.length&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(e,this)}update(e){if(0!=this.updateState)throw Error("Calls to EditorView.update are not allowed while an update is in progress");let k=!1,r=!1;var x=this.state;for(var G of e){if(G.startState!=x)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");x=G.state}if(this.destroyed)this.viewState.state=
x;else{var Q=this.hasFocus;G=0;var aa=null;e.some(Aa=>Aa.annotation(ah))?(this.inputState.notifiedFocused=Q,G=1):Q!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=Q,aa=wd(x,Q),aa||(G=1));var fa=this.observer.delayedAndroidKey,ra=null;if(fa?(this.observer.clearDelayedAndroidKey(),ra=this.observer.readChange(),(ra&&!this.state.doc.eq(x.doc)||!this.state.selection.eq(x.selection))&&(ra=null)):this.observer.clear(),x.facet($a.EditorState.phrases)!=this.state.facet($a.EditorState.phrases))return this.setState(x);
x=kh.create(this,x,e);x.flags|=G;G=this.viewState.scrollTarget;try{this.updateState=2;for(let Aa of e){if(G&&=G.map(Aa.changes),Aa.scrollIntoView){let {main:Oa}=Aa.state.selection;G=new ih(Oa.empty?Oa:$a.EditorSelection.cursor(Oa.head,Oa.head>Oa.anchor?-1:1))}for(let Oa of Aa.effects)Oa.is(ug)&&(G=Oa.value.clip(this.state))}this.viewState.update(x,G);this.bidiCache=Ki.update(this.bidiCache,x.changes);x.empty||(this.updatePlugins(x),this.inputState.update(x));k=this.docView.update(x);this.state.facet(Tf)!=
this.styleModules&&this.mountStyles();r=this.updateAttrs();this.showAnnouncements(e);this.docView.updateSelection(k,e.some(Aa=>Aa.isUserEvent("select.pointer")))}finally{this.updateState=0}if(x.startState.facet(vg)!=x.state.facet(vg)&&(this.viewState.mustMeasureContent=!0),(k||r||G||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),k&&this.docViewUpdate(),!x.empty)for(let Aa of this.state.facet($d))try{Aa(x)}catch(Oa){oa(this.state,Oa,"update listener")}(aa||
ra)&&Promise.resolve().then(()=>{aa&&this.state==aa.startState&&this.dispatch(aa);ra&&!jd(this,ra)&&fa.force&&ua(this.contentDOM,fa.key,fa.keyCode)})}}setState(e){if(0!=this.updateState)throw Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)this.viewState.state=e;else{this.updateState=2;var k=this.hasFocus;try{for(let r of this.plugins)r.destroy(this);this.viewState=new Hi(e);this.plugins=e.facet(Sf).map(r=>new jh(r));this.pluginMap.clear();for(let r of this.plugins)r.update(this);
this.docView.destroy();this.docView=new lh(this);this.inputState.ensureHandlers(this.plugins);this.mountStyles();this.updateAttrs();this.bidiCache=[]}finally{this.updateState=0}k&&this.focus();this.requestMeasure()}}updatePlugins(e){let k=e.startState.facet(Sf),r=e.state.facet(Sf);if(k!=r){var x=[];for(let Q of r){var G=k.indexOf(Q);0>G?x.push(new jh(Q)):(G=this.plugins[G],G.mustUpdate=e,x.push(G))}for(let Q of this.plugins)Q.mustUpdate!=e&&Q.destroy(this);this.plugins=x;this.pluginMap.clear()}else for(x of this.plugins)x.mustUpdate=
e;for(e=0;e<this.plugins.length;e++)this.plugins[e].update(this);k!=r&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let k=e.value;if(k&&k.docViewUpdate)try{k.docViewUpdate(this)}catch(r){oa(this.state,r,"doc view update listener")}}}measure(e=!0){if(!this.destroyed)if(-1<this.measureScheduled&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)this.measureScheduled=-1,this.requestMeasure();else{this.measureScheduled=0;e&&
this.observer.forceFlush();e=null;var k=this.scrollDOM,r=k.scrollTop*this.scaleY,{scrollAnchorPos:x,scrollAnchorHeight:G}=this.viewState;1<Math.abs(r-this.viewState.scrollTop)&&(G=-1);this.viewState.scrollAnchorHeight=-1;try{for(let Q=0;;Q++){if(0>G)if(sa(k))x=-1,G=this.viewState.heightMap.height;else{let Ka=this.viewState.scrollAnchorAt(r);x=Ka.from;G=Ka.top}this.updateState=1;let aa=this.viewState.measure(this);if(!aa&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(5<Q){console.warn(this.measureRequests.length?
"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let fa=[];aa&4||([this.measureRequests,fa]=[fa,this.measureRequests]);let ra=fa.map(Ka=>{try{return Ka.read(this)}catch(Ra){return oa(this.state,Ra),He}}),Aa=kh.create(this,this.state,[]),Oa=!1;Aa.flags|=aa;e?e.flags|=aa:e=Aa;this.updateState=2;Aa.empty||(this.updatePlugins(Aa),this.inputState.update(Aa),this.updateAttrs(),Oa=this.docView.update(Aa),Oa&&this.docViewUpdate());for(let Ka=0;Ka<fa.length;Ka++)if(ra[Ka]!=
He)try{let Ra=fa[Ka];Ra.write&&Ra.write(ra[Ka],this)}catch(Ra){oa(this.state,Ra)}if(Oa&&this.docView.updateSelection(!0),!Aa.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget);this.viewState.scrollTarget=null;G=-1;continue}else{let Ka=(0>x?this.viewState.heightMap.height:this.viewState.lineBlockAt(x).top)-G;if(1<Ka||-1>Ka){r+=Ka;k.scrollTop=r/this.scaleY;G=-1;continue}}break}}}finally{this.updateState=
0,this.measureScheduled=-1}if(e&&!e.empty)for(let Q of this.state.facet($d))Q(e)}}get themeClasses(){return vd+" "+(this.state.facet(wg)?fd:ai)+" "+this.state.facet(vg)}updateAttrs(){let e=U(this,Vh,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),k={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Ne)?"true":"false",class:"cm-content",style:`${mc.tabSize}: ${this.state.tabSize}`,role:"textbox",
"aria-multiline":"true"};this.state.readOnly&&(k["aria-readonly"]="true");U(this,vf,k);let r=this.observer.ignore(()=>{let x=yb(this.contentDOM,this.contentAttrs,k),G=yb(this.dom,this.editorAttrs,e);return x||G});return this.editorAttrs=e,this.contentAttrs=k,r}showAnnouncements(e){let k=!0;for(let r of e)for(let x of r.effects)x.is(g.announce)&&(k&&(this.announceDOM.textContent=""),k=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=x.value)}mountStyles(){this.styleModules=
this.state.facet(Tf);let e=this.state.facet(g.cspNonce);xd.StyleModule.mount(this.root,this.styleModules.concat(Ii).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(2==this.updateState)throw Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&-1<this.measureScheduled&&this.measure(!1)}requestMeasure(e){if((0>this.measureScheduled&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e)&&!(-1<this.measureRequests.indexOf(e))){if(null!=e.key)for(let k=
0;k<this.measureRequests.length;k++)if(this.measureRequests[k].key===e.key){this.measureRequests[k]=e;return}this.measureRequests.push(e)}}plugin(e){let k=this.pluginMap.get(e);return(void 0===k||k&&k.spec!=e)&&this.pluginMap.set(e,k=this.plugins.find(r=>r.spec==e)||null),k&&k.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),
this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,k,r){return cd(this,e,Ic(this,e,k,r))}moveByGroup(e,k){return cd(this,e,Ic(this,e,k,r=>Nc(this,e.head,r)))}visualLineSide(e,k){var r=this.bidiSpans(e);let x=this.textDirectionAt(e.from);r=r[k?r.length-
1:0];return $a.EditorSelection.cursor(r.side(k,x)+e.from,r.forward(!k,x)?1:-1)}moveToLineBoundary(e,k,r=!0){a:{let x=Fc(this,e.head,e.assoc||-1);if(e=r&&x.type==n.BlockType.Text&&(this.lineWrapping||x.widgetLineBreaks)?this.coordsAtPos(0>e.assoc&&e.head>x.from?e.head-1:e.head):null){r=this.dom.getBoundingClientRect();let G=this.textDirectionAt(x.from);e=this.posAtCoords({x:k==(G==n.Direction.LTR)?r.right-1:r.left+1,y:(e.top+e.bottom)/2});if(null!=e){k=$a.EditorSelection.cursor(e,k?-1:1);break a}}k=
$a.EditorSelection.cursor(k?x.to:x.from,k?-1:1)}return k}moveVertically(e,k,r){a:{var x=e.head;let ra=k?1:-1;if(x==(k?this.state.doc.length:0))k=$a.EditorSelection.cursor(x,e.assoc);else{k=e.goalColumn;var G=this.contentDOM.getBoundingClientRect(),Q=this.coordsAtPos(x,e.assoc||-1);var aa=this.documentTop;Q?(null==k&&(k=Q.left-G.left),aa=0>ra?Q.top:Q.bottom):(Q=this.viewState.lineBlockAt(x),null==k&&(k=Math.min(G.right-G.left,this.defaultCharacterWidth*(x-Q.from))),aa=(0>ra?Q.top:Q.bottom)+aa);Q=G.left+
k;var fa=r??this.viewState.heightOracle.textHeight>>1;for(let Aa=0;;Aa+=10){r=aa+(fa+Aa)*ra;let Oa=yc(this,{x:Q,y:r},!1,ra);if(r<G.top||r>G.bottom||(0>ra?Oa<x:Oa>x)){x=this.docView.coordsForChar(Oa);k=$a.EditorSelection.cursor(Oa,!x||r<x.top?-1:1,void 0,k);break a}}}}return cd(this,e,k)}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,k=0){return this.docView.posFromDOM(e,k)}posAtCoords(e,k=!0){return this.readMeasured(),yc(this,e,k)}coordsAtPos(e,k=1){this.readMeasured();let r=this.docView.coordsAt(e,
k);if(!r||r.left==r.right)return r;let x=this.state.doc.lineAt(e),G=this.bidiSpans(x);e=G[rc.find(G,e-x.from,-1,k)];return T(r,e.dir==n.Direction.LTR==0<k)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(tf)||e<this.viewport.from||
e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Ed)return[new rc(0,e.length,0)];let k=this.textDirectionAt(e.from),r;for(var x of this.bidiCache)if(x.from==e.from&&x.dir==k&&(x.fresh||lc(x.isolates,r=ya(this,e))))return x.order;r||=ya(this,e);x=bb(e.text,k,r);return this.bidiCache.push(new Ki(e.from,e.to,k,r,!0,x)),x}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||
mc.safari&&(null===(e=this.inputState)||void 0===e?void 0:e.lastContextMenu)>Date.now()-3E4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Da(this.contentDOM);this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((9==e.nodeType?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[];this.inputState.destroy();
this.docView.destroy();this.dom.remove();this.observer.destroy();-1<this.measureScheduled&&this.win.cancelAnimationFrame(this.measureScheduled);this.destroyed=!0}static scrollIntoView(e,k={}){return ug.of(new ih("number"==typeof e?$a.EditorSelection.cursor(e):e,k.y,k.x,k.yMargin,k.xMargin))}scrollSnapshot(){let {scrollTop:e,scrollLeft:k}=this.scrollDOM,r=this.viewState.scrollAnchorAt(e);return ug.of(new ih($a.EditorSelection.cursor(r.from),"start","start",r.top-e,k,!0))}setTabFocusMode(e){null==e?
this.inputState.tabFocusMode=0>this.inputState.tabFocusMode?0:-1:"boolean"==typeof e?this.inputState.tabFocusMode=e?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Xd.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Xd.define(()=>({}),{eventObservers:e})}static theme(e,k){let r=xd.StyleModule.newName();e=[vg.of(r),Tf.of(Ib(`.${r}`,e))];return k&&k.dark&&e.push(wg.of(!0)),e}static baseTheme(e){return $a.Prec.lowest(Tf.of(Ib("."+
vd,e,Ce)))}static findFromDOM(e){var k;let r=e.querySelector(".cm-content");return(null===(k=(r&&od.get(r)||od.get(e))?.rootView)||void 0===k?void 0:k.view)||null}};ad.styleModule=Tf;ad.inputHandler=Kf;ad.clipboardInputFilter=Fe;ad.clipboardOutputFilter=Uh;ad.scrollHandler=tg;ad.focusChangeEffect=Qh;ad.perLineTextDirection=tf;ad.exceptionSink=ig;ad.updateListener=$d;ad.editable=Ne;ad.mouseSelectionStyle=Bi;ad.dragMovesSelection=cc;ad.clickAddsSelectionRange=Zc;ad.decorations=uf;ad.outerDecorations=
Wh;ad.atomicRanges=jg;ad.bidiIsolatedRanges=Oh;ad.scrollMargins=Xg;ad.darkTheme=wg;ad.cspNonce=$a.Facet.define({combine:g=>g.length?g[0]:""});ad.contentAttributes=vf;ad.editorAttributes=Vh;ad.lineWrapping=ad.contentAttributes.of({class:"cm-lineWrapping"});ad.announce=$a.StateEffect.define();var Ed=4096,He={},Ki=class g{constructor(e,k,r,x,G,Q){this.from=e;this.to=k;this.dir=r;this.isolates=x;this.fresh=G;this.order=Q}static update(e,k){if(k.empty&&!e.some(G=>G.fresh))return e;let r=[],x=e.length?
e[e.length-1].dir:n.Direction.LTR;for(let G=Math.max(0,e.length-10);G<e.length;G++){let Q=e[G];Q.dir==x&&!k.touchesRange(Q.from,Q.to)&&r.push(new g(k.mapPos(Q.from,1),k.mapPos(Q.to,-1),Q.dir,Q.isolates,!1,Q.order))}return r}},Pe=mc.mac?"mac":mc.windows?"win":mc.linux?"linux":"key",Qj=$a.Prec.default(ad.domEventHandlers({keydown(g,e){return eb(wa(e.state),g,e,"editor")}})),rf=$a.Facet.define({enables:Qj}),kg=new WeakMap,Qe=null,lg=4E3,mg=null,ch=class g{constructor(e,k,r,x,G){this.className=e;this.left=
k;this.top=r;this.width=x;this.height=G}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,k){return k.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px";e.style.top=this.top+"px";null!=this.width&&(e.style.width=this.width+"px");e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,k,r){if(r.empty){r=
e.coordsAtPos(r.head,r.assoc||1);if(!r)return[];e=Ya(e);return[new g(k,r.left-e.left,r.top-e.top,null,r.bottom-r.top)]}return Nb(e,k,r)}},Ai=class{constructor(g,e){this.view=g;this.layer=e;this.drawn=[];this.scaleY=this.scaleX=1;this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)};this.dom=g.scrollDOM.appendChild(document.createElement("div"));this.dom.classList.add("cm-layer");e.above&&this.dom.classList.add("cm-layer-above");e.class&&this.dom.classList.add(e.class);this.scale();
this.dom.setAttribute("aria-hidden","true");this.setOrder(g.state);g.requestMeasure(this.measureReq);e.mount&&e.mount(this.dom,g)}update(g){g.startState.facet(qg)!=g.state.facet(qg)&&this.setOrder(g.state);(this.layer.update(g,this.dom)||g.geometryChanged)&&(this.scale(),g.view.requestMeasure(this.measureReq))}docViewUpdate(g){!1!==this.layer.updateOnDocViewUpdate&&g.requestMeasure(this.measureReq)}setOrder(g){let e=0;for(g=g.facet(qg);e<g.length&&g[e]!=this.layer;)e++;this.dom.style.zIndex=String((this.layer.above?
150:-1)-e)}measure(){return this.layer.markers(this.view)}scale(){let {scaleX:g,scaleY:e}=this.view;(g!=this.scaleX||e!=this.scaleY)&&(this.scaleX=g,this.scaleY=e,this.dom.style.transform=`scale(${1/g}, ${1/e})`)}draw(g){if(g.length!=this.drawn.length||g.some((k,r)=>{r=this.drawn[r];return!(k.constructor==r.constructor&&k.eq(r))})){let k=this.dom.firstChild;var e=0;for(let r of g)r.update&&k&&r.constructor&&this.drawn[e].constructor&&r.update(k,this.drawn[e])?(k=k.nextSibling,e++):this.dom.insertBefore(r.draw(),
k);for(;k;)e=k.nextSibling,k.remove(),k=e;this.drawn=g}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view);this.dom.remove()}},qg=$a.Facet.define(),cf=$a.Facet.define({combine(g){return $a.combineConfig(g,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,k)=>Math.min(e,k),drawRangeCursor:(e,k)=>e||k})}}),Rj=sc({above:!0,markers(g){let {state:e}=g,k=e.facet(cf),r=[];for(let G of e.selection.ranges){var x=G==e.selection.main;if(G.empty||k.drawRangeCursor){x=x?"cm-cursor cm-cursor-primary":
"cm-cursor cm-cursor-secondary";let Q=G.empty?G:$a.EditorSelection.cursor(G.head,G.head>G.anchor?-1:1);for(let aa of ch.forRange(g,x,Q))r.push(aa)}}return r},update(g,e){g.transactions.some(r=>r.selection)&&(e.style.animationName="cm-blink"==e.style.animationName?"cm-blink2":"cm-blink");let k=Ec(g);k&&(e.style.animationDuration=g.state.facet(cf).cursorBlinkRate+"ms");return g.docChanged||g.selectionSet||k},mount(g,e){g.style.animationDuration=e.state.facet(cf).cursorBlinkRate+"ms"},class:"cm-cursorLayer"}),
xg=sc({above:!1,markers(g){return g.state.selection.ranges.map(e=>e.empty?[]:ch.forRange(g,"cm-selectionBackground",e)).reduce((e,k)=>e.concat(k))},update(g,e){return g.docChanged||g.selectionSet||g.viewportChanged||Ec(g)},class:"cm-selectionLayer"}),Sj=$a.Prec.highest(ad.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),
Li=$a.StateEffect.define({map(g,e){return null==g?null:e.mapPos(g)}}),yg=$a.StateField.define({create(){return null},update(g,e){return null!=g&&(g=e.changes.mapPos(g)),e.effects.reduce((k,r)=>r.is(Li)?r.value:k,g)}}),Tj=Xd.fromClass(class{constructor(g){this.view=g;this.cursor=null;this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(g){var e;let k=g.state.field(yg);null==k?null!=this.cursor&&(null===(e=this.cursor)||void 0===e||e.remove(),this.cursor=null):(this.cursor||
(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(g.startState.field(yg)!=k||g.docChanged||g.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let {view:g}=this;var e=g.state.field(yg);e=null!=e&&g.coordsAtPos(e);if(!e)return null;let k=g.scrollDOM.getBoundingClientRect();return{left:e.left-k.left+g.scrollDOM.scrollLeft*g.scaleX,top:e.top-k.top+g.scrollDOM.scrollTop*g.scaleY,height:e.bottom-e.top}}drawCursor(g){if(this.cursor){let {scaleX:e,
scaleY:k}=this.view;g?(this.cursor.style.left=g.left/e+"px",this.cursor.style.top=g.top/k+"px",this.cursor.style.height=g.height/k+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(g){this.view.state.field(yg)!=g&&this.view.dispatch({effects:Li.of(g)})}},{eventObservers:{dragover(g){this.setDropPos(this.view.posAtCoords({x:g.clientX,y:g.clientY}))},dragleave(g){g.target!=this.view.contentDOM&&this.view.contentDOM.contains(g.relatedTarget)||this.setDropPos(null)},
dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}}),gh=class{constructor(g){let {regexp:e,decoration:k,decorate:r,boundary:x,maxLength:G=1E3}=g;if(!e.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=e,r)this.addMatch=(Q,aa,fa,ra)=>r(ra,fa,fa+Q[0].length,Q,aa);else if("function"==typeof k)this.addMatch=(Q,aa,fa,ra)=>{(aa=k(Q,aa,fa))&&ra(fa,fa+Q[0].length,aa)};else if(k)this.addMatch=(Q,aa,fa,ra)=>ra(fa,fa+Q[0].length,
k);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=x;this.maxLength=G}createDeco(g){let e=new $a.RangeSetBuilder,k=e.add.bind(e);for(let {from:r,to:x}of ed(g,this.maxLength))Kc(g.state.doc,this.regexp,r,x,(G,Q)=>this.addMatch(Q,g,G,k));return e.finish()}updateDeco(g,e){let k=1E9,r=-1;return g.docChanged&&g.changes.iterChanges((x,G,Q,aa)=>{aa>=g.view.viewport.from&&Q<=g.view.viewport.to&&(k=Math.min(Q,k),r=Math.max(aa,r))}),g.viewportMoved||
1E3<r-k?this.createDeco(g.view):-1<r?this.updateRange(g.view,e.map(g.changes),k,r):e}updateRange(g,e,k,r){for(let x of g.visibleRanges){let G=Math.max(x.from,k),Q=Math.min(x.to,r);if(Q>G){let aa=g.state.doc.lineAt(G),fa=aa.to<Q?g.state.doc.lineAt(Q):aa,ra=Math.max(x.from,aa.from),Aa=Math.min(x.to,fa.to);if(this.boundary){for(;G>aa.from;G--)if(this.boundary.test(aa.text[G-1-aa.from])){ra=G;break}for(;Q<fa.to;Q++)if(this.boundary.test(fa.text[Q-fa.from])){Aa=Q;break}}let Oa=[],Ka,Ra=(nb,xb,Rb)=>Oa.push(Rb.range(nb,
xb));if(aa==fa)for(this.regexp.lastIndex=ra-aa.from;(Ka=this.regexp.exec(aa.text))&&Ka.index<Aa-aa.from;)this.addMatch(Ka,g,Ka.index+aa.from,Ra);else Kc(g.state.doc,this.regexp,ra,Aa,(nb,xb)=>this.addMatch(xb,g,nb,Ra));e=e.update({filterFrom:ra,filterTo:Aa,filter:(nb,xb)=>nb<ra||xb>Aa,add:Oa})}}return e}},zg=null!=/x/.unicode?"gu":"g",rh=RegExp("[\x00-\b\n-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]",zg),Vf={0:"null",7:"bell",8:"backspace",
10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},ci=null,fh=$a.Facet.define({combine(g){g=$a.combineConfig(g,
{render:null,specialChars:rh,addSpecialChars:null});var e;if(null==ci&&"u">typeof document&&document.body){let k=document.body.style;ci=null!=(null!==(e=k.tabSize)&&void 0!==e?e:k.MozTabSize)}return(g.replaceTabs=!ci)&&(g.specialChars=new RegExp("\t|"+g.specialChars.source,zg)),g.addSpecialChars&&(g.specialChars=new RegExp(g.specialChars.source+"|"+g.addSpecialChars.source,zg)),g}}),Mj=null,Nj=class extends Ga{constructor(g,e){super();this.options=g;this.code=e}eq(g){return g.code==this.code}toDOM(g){var e=
this.code;e=32<=e?"\u2022":10==e?"\u2424":String.fromCharCode(9216+e);g=g.state.phrase("Control character")+" "+(Vf[this.code]||"0x"+this.code.toString(16));var k=this.options.render&&this.options.render(this.code,g,e);if(k)return k;k=document.createElement("span");return k.textContent=e,k.title=g,k.setAttribute("aria-label",g),k.className="cm-specialChar",k}ignoreEvent(){return!1}},Th=class extends Ga{constructor(g){super();this.width=g}eq(g){return g.width==this.width}toDOM(){let g=document.createElement("span");
return g.textContent="\t",g.className="cm-tab",g.style.width=this.width+"px",g}ignoreEvent(){return!1}},gf=Xd.fromClass(class{constructor(){this.height=1E3;this.attrs={style:"padding-bottom: 1000px"}}update(g){({view:g}=g);g=g.viewState.editorHeight-g.defaultLineHeight-g.documentPadding.top-.5;0<=g&&g!=this.height&&(this.height=g,this.attrs={style:`padding-bottom: ${g}px`})}}),yf=xa.line({class:"cm-activeLine"}),Uj=Xd.fromClass(class{constructor(g){this.decorations=this.getDeco(g)}update(g){(g.docChanged||
g.selectionSet)&&(this.decorations=this.getDeco(g.view))}getDeco(g){let e=-1,k=[];for(let r of g.state.selection.ranges){let x=g.lineBlockAt(r.head);x.from>e&&(k.push(yf.range(x.from)),e=x.from)}return xa.set(k)}},{decorations:g=>g.decorations}),Jd=class extends Ga{constructor(g){super();this.content=g}toDOM(g){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild("string"==typeof this.content?document.createTextNode(this.content):"function"==
typeof this.content?this.content(g):this.content.cloneNode(!0)),"string"==typeof this.content?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(g){var e=g.firstChild?w(g.firstChild):[];if(!e.length)return null;g=window.getComputedStyle(g.parentNode);e=T(e[0],"rtl"!=g.direction);g=parseInt(g.lineHeight);return e.bottom-e.top>1.5*g?{left:e.left,right:e.right,top:e.top,bottom:e.top+g}:e}ignoreEvent(){return!1}},Wf={Alt:[18,g=>!!g.altKey],Control:[17,
g=>!!g.ctrlKey],Shift:[16,g=>!!g.shiftKey],Meta:[91,g=>!!g.metaKey]},Ag={style:"cursor: crosshair"},ae=class{constructor(g,e,k,r){this.facet=e;this.createTooltipView=k;this.removeTooltipView=r;this.input=g.state.facet(e);this.tooltips=this.input.filter(G=>G);let x=null;this.tooltipViews=this.tooltips.map(G=>x=k(G,x))}update(g,e){var k;let r=g.state.facet(this.facet),x=r.filter(fa=>fa);if(r===this.input){for(var G of this.tooltipViews)G.update&&G.update(g);return!1}G=[];let Q=e?[]:null;for(let fa=
0;fa<x.length;fa++){var aa=x[fa];let ra=-1;if(aa){for(let Aa=0;Aa<this.tooltips.length;Aa++){let Oa=this.tooltips[Aa];Oa&&Oa.create==aa.create&&(ra=Aa)}0>ra?(G[fa]=this.createTooltipView(aa,fa?G[fa-1]:null),Q&&(Q[fa]=!!aa.above)):(aa=G[fa]=this.tooltipViews[ra],Q&&(Q[fa]=e[ra]),aa.update&&aa.update(g))}}for(let fa of this.tooltipViews)0>G.indexOf(fa)&&(this.removeTooltipView(fa),null===(k=fa.destroy)||void 0===k||k.call(fa));return e&&(Q.forEach((fa,ra)=>e[ra]=fa),e.length=Q.length),this.input=r,
this.tooltips=x,this.tooltipViews=G,!0}},sh=$a.Facet.define({combine:g=>{var e,k,r;return{position:mc.ios?"absolute":(null===(e=g.find(x=>x.position))||void 0===e?void 0:e.position)||"fixed",parent:(null===(k=g.find(x=>x.parent))||void 0===k?void 0:k.parent)||null,tooltipSpace:(null===(r=g.find(x=>x.tooltipSpace))||void 0===r?void 0:r.tooltipSpace)||L}}}),Mi=new WeakMap,Bg=Xd.fromClass(class{constructor(g){this.view=g;this.above=[];this.inView=!0;this.madeAbsolute=!1;this.lastTransaction=0;this.measureTimeout=
-1;let e=g.state.facet(sh);this.position=e.position;this.parent=e.parent;this.classes=g.themeClasses;this.createContainer();this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this};this.resizeObserver="function"==typeof ResizeObserver?new ResizeObserver(()=>this.measureSoon()):null;this.manager=new ae(g,th,(k,r)=>this.createTooltip(k,r),k=>{this.resizeObserver&&this.resizeObserver.unobserve(k.dom);k.dom.remove()});this.above=this.manager.tooltips.map(k=>!!k.above);
this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver(k=>{Date.now()>this.lastTransaction-50&&0<k.length&&1>k[k.length-1].intersectionRatio&&this.measureSoon()},{threshold:[1]}):null;this.observeIntersection();g.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this));this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,
this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let g of this.manager.tooltipViews)this.intersectionObserver.observe(g.dom)}}measureSoon(){0>this.measureTimeout&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1;this.maybeMeasure()},50))}update(g){g.transactions.length&&(this.lastTransaction=Date.now());var e=this.manager.update(g,this.above);e&&this.observeIntersection();
e=e||g.geometryChanged;g=g.state.facet(sh);if(g.position!=this.position&&!this.madeAbsolute){this.position=g.position;for(let k of this.manager.tooltipViews)k.dom.style.position=this.position;e=!0}if(g.parent!=this.parent){this.parent&&this.container.remove();this.parent=g.parent;this.createContainer();for(let k of this.manager.tooltipViews)this.container.appendChild(k.dom);e=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);
e&&this.maybeMeasure()}createTooltip(g,e){let k=g.create(this.view);e=e?e.dom:null;if(k.dom.classList.add("cm-tooltip"),g.arrow&&!k.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow"))g=document.createElement("div"),g.className="cm-tooltip-arrow",k.dom.appendChild(g);return k.dom.style.position=this.position,k.dom.style.top="-10000px",k.dom.style.left="0px",this.container.insertBefore(k.dom,e),k.mount&&k.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(k.dom),k}destroy(){var g,e,
k;this.view.win.removeEventListener("resize",this.measureSoon);for(let r of this.manager.tooltipViews)r.dom.remove(),null===(g=r.destroy)||void 0===g||g.call(r);this.parent&&this.container.remove();null===(e=this.resizeObserver)||void 0===e||e.disconnect();null===(k=this.intersectionObserver)||void 0===k||k.disconnect();clearTimeout(this.measureTimeout)}readMeasure(){let g=1,e=1;var k=!1;if("fixed"==this.position&&this.manager.tooltipViews.length){var {dom:r}=this.manager.tooltipViews[0];mc.gecko?
k=r.offsetParent!=this.container.ownerDocument.body:"-10000px"==r.style.top&&"0px"==r.style.left&&(k=r.getBoundingClientRect(),k=1<Math.abs(k.top+1E4)||1<Math.abs(k.left))}if(k||"absolute"==this.position)this.parent?(r=this.parent.getBoundingClientRect(),r.width&&r.height&&(g=r.width/this.parent.offsetWidth,e=r.height/this.parent.offsetHeight)):{scaleX:g,scaleY:e}=this.view.viewState;r=this.view.scrollDOM.getBoundingClientRect();let x=N(this.view);return{visible:{left:r.left+x.left,top:r.top+x.top,
right:r.right-x.right,bottom:r.bottom-x.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((G,Q)=>{Q=this.manager.tooltipViews[Q];return Q.getCoords?Q.getCoords(G.pos):this.view.coordsAtPos(G.pos)}),size:this.manager.tooltipViews.map(({dom:G})=>G.getBoundingClientRect()),space:this.view.state.facet(sh).tooltipSpace(this.view),scaleX:g,scaleY:e,makeAbsolute:k}}writeMeasure(g){var e;if(g.makeAbsolute){this.madeAbsolute=
!0;this.position="absolute";for(var k of this.manager.tooltipViews)k.dom.style.position="absolute"}let {visible:r,space:x,scaleX:G,scaleY:Q}=g;k=[];for(let Aa=0;Aa<this.manager.tooltips.length;Aa++){var aa=this.manager.tooltips[Aa];let Oa=this.manager.tooltipViews[Aa],{dom:Ka}=Oa,Ra=g.pos[Aa];var fa=g.size[Aa];if(!Ra||!1!==aa.clip&&(Ra.bottom<=Math.max(r.top,x.top)||Ra.top>=Math.min(r.bottom,x.bottom)||Ra.right<Math.max(r.left,x.left)-.1||Ra.left>Math.min(r.right,x.right)+.1)){Ka.style.top="-10000px";
continue}let nb=aa.arrow?Oa.dom.querySelector(".cm-tooltip-arrow"):null,xb=nb?7:0;var ra=fa.right-fa.left;let Rb=null!==(e=Mi.get(Oa))&&void 0!==e?e:fa.bottom-fa.top,fc=Oa.offset||uh,dd=this.view.textDirection==n.Direction.LTR;fa=fa.width>x.right-x.left?dd?x.left:x.right-fa.width:dd?Math.max(x.left,Math.min(Ra.left-(nb?14:0)+fc.x,x.right-ra)):Math.min(Math.max(x.left,Ra.left-ra+(nb?14:0)-fc.x),x.right-ra);let bd=this.above[Aa];!aa.strictSide&&(bd?Ra.top-Rb-xb-fc.y<x.top:Ra.bottom+Rb+xb+fc.y>x.bottom)&&
bd==x.bottom-Ra.bottom>Ra.top-x.top&&(bd=this.above[Aa]=!bd);aa=(bd?Ra.top-x.top:x.bottom-Ra.bottom)-xb;if(aa<Rb&&!1!==Oa.resize){if(aa<this.view.defaultLineHeight){Ka.style.top="-10000px";continue}Mi.set(Oa,Rb);Ka.style.height=(Rb=aa)/Q+"px"}else Ka.style.height&&(Ka.style.height="");aa=bd?Ra.top-Rb-xb-fc.y:Ra.bottom+xb+fc.y;ra=fa+ra;if(!0!==Oa.overlap)for(let Wc of k)Wc.left<ra&&Wc.right>fa&&Wc.top<aa+Rb&&Wc.bottom>aa&&(aa=bd?Wc.top-Rb-2-xb:Wc.bottom+xb+2);if("absolute"==this.position?(Ka.style.top=
(aa-g.parent.top)/Q+"px",O(Ka,(fa-g.parent.left)/G)):(Ka.style.top=aa/Q+"px",O(Ka,fa/G)),nb)nb.style.left=(Ra.left+(dd?fc.x:-fc.x)-(fa+14-7))/G+"px";!0!==Oa.overlap&&k.push({left:fa,top:aa,right:ra,bottom:aa+Rb});Ka.classList.toggle("cm-tooltip-above",bd);Ka.classList.toggle("cm-tooltip-below",!bd);Oa.positioned&&Oa.positioned(g.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,
!this.inView)))for(let g of this.manager.tooltipViews)g.dom.style.top="-10000px"}},{eventObservers:{scroll(){this.maybeMeasure()}}}),vh=ad.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden",
"&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},
"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),uh={x:0,y:0},th=$a.Facet.define({enables:[Bg,vh]}),zf=$a.Facet.define({combine:g=>g.reduce((e,k)=>e.concat(k),[])}),Af=class g{static create(e){return new g(e)}constructor(e){this.view=e;this.mounted=!1;this.dom=document.createElement("div");this.dom.classList.add("cm-tooltip-hover");this.manager=new ae(e,zf,(k,r)=>this.createHostedView(k,r),k=>k.dom.remove())}createHostedView(e,k){e=e.create(this.view);return e.dom.classList.add("cm-tooltip-section"),
this.dom.insertBefore(e.dom,k?k.dom.nextSibling:this.dom.firstChild),this.mounted&&e.mount&&e.mount(this.view),e}mount(e){for(let k of this.manager.tooltipViews)k.mount&&k.mount(e);this.mounted=!0}positioned(e){for(let k of this.manager.tooltipViews)k.positioned&&k.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let k of this.manager.tooltipViews)null===(e=k.destroy)||void 0===e||e.call(k)}passProp(e){let k;for(let r of this.manager.tooltipViews){let x=r[e];if(void 0!==x)if(void 0===
k)k=x;else if(k!==x)return}return k}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}},Vj=th.compute([zf],g=>{g=g.facet(zf);return 0===g.length?null:{pos:Math.min(...g.map(e=>e.pos)),end:Math.max(...g.map(e=>{var k;return null!==(k=e.end)&&void 0!==k?k:e.pos})),create:Af.create,above:g[0].above,arrow:g.some(e=>e.arrow)}}),Wj=class{constructor(g,e,k,r,x){this.view=
g;this.source=e;this.field=k;this.setHover=r;this.hoverTime=x;this.restartTimeout=this.hoverTimeout=-1;this.pending=null;this.lastMove={x:0,y:0,target:g.dom,time:0};this.checkHover=this.checkHover.bind(this);g.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this));g.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=
-1,!this.active.length){var g=Date.now()-this.lastMove.time;g<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-g):this.startHover()}}startHover(){clearTimeout(this.restartTimeout);let {view:g,lastMove:e}=this;var k=g.docView.nearest(e.target);if(k){var r=1;if(k instanceof Rf)var x=k.posAtStart;else{if(x=g.posAtCoords(e),null==x)return;k=g.coordsAtPos(x);if(!k||e.y<k.top||e.y>k.bottom||e.x<k.left-g.defaultCharacterWidth||e.x>k.right+g.defaultCharacterWidth)return;r=(r=g.bidiSpans(g.state.doc.lineAt(x)).find(G=>
G.from<=x&&G.to>=x))&&r.dir==n.Direction.RTL?-1:1;r=e.x<k.left?-r:r}k=this.source(g,x,r);if(k?.then){let G=this.pending={pos:x};k.then(Q=>{this.pending==G&&(this.pending=null,Q&&(!Array.isArray(Q)||Q.length)&&g.dispatch({effects:this.setHover.of(Array.isArray(Q)?Q:[Q])}))},Q=>oa(g.state,Q,"hover tooltip"))}else k&&(!Array.isArray(k)||k.length)&&g.dispatch({effects:this.setHover.of(Array.isArray(k)?k:[k])})}}get tooltip(){let g=this.view.plugin(Bg),e=g?g.manager.tooltips.findIndex(k=>k.create==Af.create):
-1;return-1<e?g.manager.tooltipViews[e]:null}mousemove(g){var e,k;this.lastMove={x:g.clientX,y:g.clientY,target:g.target,time:Date.now()};0>this.hoverTimeout&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let {active:r,tooltip:x}=this;var G;if(G=r.length&&x){G=x.dom;let {left:aa,right:fa,top:ra,bottom:Aa}=G.getBoundingClientRect();if(G=G.querySelector(".cm-tooltip-arrow"))G=G.getBoundingClientRect(),ra=Math.min(G.top,ra),Aa=Math.max(G.bottom,Aa);G=!(g.clientX>=aa-Cg&&g.clientX<=fa+
Cg&&g.clientY>=ra-Cg&&g.clientY<=Aa+Cg)}if(G||this.pending){var {pos:Q}=r[0]||this.pending;G=null!==(k=null===(e=r[0])||void 0===e?void 0:e.end)&&void 0!==k?k:Q;if(Q==G)g=this.view.posAtCoords(this.lastMove)!=Q;else{{e=this.view;k=Q;Q=g.clientX;g=g.clientY;let aa=e.scrollDOM.getBoundingClientRect(),fa=e.documentTop+e.documentPadding.top+e.contentHeight;aa.left>Q||aa.right<Q||aa.top>g||Math.min(aa.bottom,fa)<g?g=!1:(g=e.posAtCoords({x:Q,y:g},!1),g=g>=k&&g<=G)}g=!g}g&&(this.view.dispatch({effects:this.setHover.of([])}),
this.pending=null)}}mouseleave(g){clearTimeout(this.hoverTimeout);this.hoverTimeout=-1;var {active:e}=this;e.length&&({tooltip:e}=this,e&&e.dom.contains(g.relatedTarget)?this.watchTooltipLeave(e.dom):this.view.dispatch({effects:this.setHover.of([])}))}watchTooltipLeave(g){let e=k=>{g.removeEventListener("mouseleave",e);this.active.length&&!this.view.dom.contains(k.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};g.addEventListener("mouseleave",e)}destroy(){clearTimeout(this.hoverTimeout);
this.view.dom.removeEventListener("mouseleave",this.mouseleave);this.view.dom.removeEventListener("mousemove",this.mousemove)}},Cg=4,Ni=$a.StateEffect.define(),ie=Ni.of(null),De=$a.Facet.define({combine(g){let e,k;for(let r of g)e=e||r.topContainer,k=k||r.bottomContainer;return{topContainer:e,bottomContainer:k}}}),Dg=Xd.fromClass(class{constructor(g){this.input=g.state.facet(Se);this.specs=this.input.filter(k=>k);this.panels=this.specs.map(k=>k(g));let e=g.state.facet(De);this.top=new Bf(g,!0,e.topContainer);
this.bottom=new Bf(g,!1,e.bottomContainer);this.top.sync(this.panels.filter(k=>k.top));this.bottom.sync(this.panels.filter(k=>!k.top));for(let k of this.panels)k.dom.classList.add("cm-panel"),k.mount&&k.mount()}update(g){var e=g.state.facet(De);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Bf(g.view,!0,e.topContainer));this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Bf(g.view,!1,e.bottomContainer));this.top.syncClasses();this.bottom.syncClasses();
e=g.state.facet(Se);if(e!=this.input){var k=e.filter(Q=>Q);e=[];let r=[],x=[],G=[];for(let Q of k){let aa=this.specs.indexOf(Q),fa;0>aa?(fa=Q(g.view),G.push(fa)):(fa=this.panels[aa],fa.update&&fa.update(g));e.push(fa);(fa.top?r:x).push(fa)}this.specs=k;this.panels=e;this.top.sync(r);this.bottom.sync(x);for(let Q of G)Q.dom.classList.add("cm-panel"),Q.mount&&Q.mount()}else for(k of this.panels)k.update&&k.update(g)}destroy(){this.top.sync([]);this.bottom.sync([])}},{provide:g=>ad.scrollMargins.of(e=>
(e=e.plugin(g))&&{top:e.top.scrollMargin(),bottom:e.bottom.scrollMargin()})}),Bf=class{constructor(g,e,k){this.view=g;this.top=e;this.container=k;this.dom=void 0;this.classes="";this.panels=[];this.syncClasses()}sync(g){for(let e of this.panels)e.destroy&&0>g.indexOf(e)&&e.destroy();this.panels=g;this.syncDOM()}syncDOM(){if(0==this.panels.length)this.dom&&(this.dom.remove(),this.dom=void 0);else{if(!this.dom){this.dom=document.createElement("div");this.dom.className=this.top?"cm-panels cm-panels-top":
"cm-panels cm-panels-bottom";this.dom.style[this.top?"top":"bottom"]="0";var g=this.container||this.view.dom;g.insertBefore(this.dom,this.top?g.firstChild:null)}g=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;g!=e.dom;)g=ia(g);g=g.nextSibling}else this.dom.insertBefore(e.dom,g);for(;g;)g=ia(g)}}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,
this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let g of this.classes.split(" "))g&&this.container.classList.remove(g);for(let g of(this.classes=this.view.themeClasses).split(" "))g&&this.container.classList.add(g)}}},Se=$a.Facet.define({enables:Dg}),re=class extends $a.RangeValue{compare(g){return this==g||this.constructor==g.constructor&&this.eq(g)}eq(g){return!1}destroy(g){}};re.prototype.elementClass=
"";re.prototype.toDOM=void 0;re.prototype.mapMode=$a.MapMode.TrackBefore;re.prototype.startSide=re.prototype.endSide=-1;re.prototype.point=!0;var Cf=$a.Facet.define(),Te=$a.Facet.define(),Eg={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>$a.RangeSet.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Fg=$a.Facet.define(),Mf=$a.Facet.define({combine:g=>g.some(e=>e)}),Yd=Xd.fromClass(class{constructor(g){this.view=
g;this.prevViewport=g.viewport;this.dom=document.createElement("div");this.dom.className="cm-gutters";this.dom.setAttribute("aria-hidden","true");this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px";this.gutters=g.state.facet(Fg).map(e=>new wh(g,e));for(let e of this.gutters)this.dom.appendChild(e.dom);(this.fixed=!g.state.facet(Mf))&&(this.dom.style.position="sticky");this.syncGutters(!1);g.scrollDOM.insertBefore(this.dom,g.contentDOM)}update(g){if(this.updateGutters(g)){let e=
this.prevViewport,k=g.view.viewport;this.syncGutters(Math.min(e.to,k.to)-Math.max(e.from,k.from)<.8*(k.to-k.from))}g.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px");this.view.state.facet(Mf)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"");this.prevViewport=g.view.viewport}syncGutters(g){let e=this.dom.nextSibling;g&&this.dom.remove();let k=$a.RangeSet.iter(this.view.state.facet(Cf),this.view.viewport.from),r=[],x=this.gutters.map(G=>
new Oi(G,this.view.viewport,-this.view.documentPadding.top));for(let G of this.view.viewportLineBlocks)if(r.length&&(r=[]),Array.isArray(G.type)){let Q=!0;for(let aa of G.type)if(aa.type==n.BlockType.Text&&Q){cb(k,r,aa.from);for(let fa of x)fa.line(this.view,aa,r);Q=!1}else if(aa.widget)for(let fa of x)fa.widget(this.view,aa)}else if(G.type==n.BlockType.Text){cb(k,r,G.from);for(let Q of x)Q.line(this.view,G,r)}else if(G.widget)for(let Q of x)Q.widget(this.view,G);for(let G of x)G.finish();g&&this.view.scrollDOM.insertBefore(this.dom,
e)}updateGutters(g){let e=g.startState.facet(Fg);var k=g.state.facet(Fg);let r=g.docChanged||g.heightChanged||g.viewportChanged||!$a.RangeSet.eq(g.startState.facet(Cf),g.state.facet(Cf),g.view.viewport.from,g.view.viewport.to);if(e==k)for(var x of this.gutters)x.update(g)&&(r=!0);else{r=!0;x=[];for(let G of k)k=e.indexOf(G),0>k?x.push(new wh(this.view,G)):(this.gutters[k].update(g),x.push(this.gutters[k]));for(let G of this.gutters)G.dom.remove(),0>x.indexOf(G)&&G.destroy();for(let G of x)this.dom.appendChild(G.dom);
this.gutters=x}return r}destroy(){for(let g of this.gutters)g.destroy();this.dom.remove()}},{provide:g=>ad.scrollMargins.of(e=>{let k=e.plugin(g);return k&&0!=k.gutters.length&&k.fixed?e.textDirection==n.Direction.LTR?{left:k.dom.offsetWidth*e.scaleX}:{right:k.dom.offsetWidth*e.scaleX}:null})}),Oi=class{constructor(g,e,k){this.gutter=g;this.height=k;this.i=0;this.cursor=$a.RangeSet.iter(g.markers,e.from)}addElement(g,e,k){let {gutter:r}=this,x=(e.top-this.height)/g.scaleY,G=e.height/g.scaleY;this.i==
r.elements.length?(g=new Ue(g,G,x,k),r.elements.push(g),r.dom.appendChild(g.dom)):r.elements[this.i].update(g,G,x,k);this.height=e.bottom;this.i++}line(g,e,k){let r=[];cb(this.cursor,r,e.from);k.length&&(r=r.concat(k));(k=this.gutter.config.lineMarker(g,e,r))&&r.unshift(k);k=this.gutter;0==r.length&&!k.config.renderEmptyElements||this.addElement(g,e,r)}widget(g,e){var k=this.gutter.config.widgetMarker(g,e.widget,e);k=k?[k]:null;for(let r of g.state.facet(Te)){let x=r(g,e.widget,e);x&&(k||=[]).push(x)}k&&
this.addElement(g,e,k)}finish(){let g=this.gutter;for(;g.elements.length>this.i;){let e=g.elements.pop();g.dom.removeChild(e.dom);e.destroy()}}},wh=class{constructor(g,e){this.view=g;this.config=e;this.elements=[];this.spacer=null;this.dom=document.createElement("div");this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let k in e.domEventHandlers)this.dom.addEventListener(k,r=>{var x=r.target;if(x!=this.dom&&this.dom.contains(x)){for(;x.parentNode!=this.dom;)x=x.parentNode;
x=x.getBoundingClientRect();x=(x.top+x.bottom)/2}else x=r.clientY;x=g.lineBlockAtHeight(x-g.documentTop);e.domEventHandlers[k](g,x,r)&&r.preventDefault()});this.markers=Ia(e.markers(g));e.initialSpacer&&(this.spacer=new Ue(g,0,0,[e.initialSpacer(g)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(g){let e=this.markers;if(this.markers=Ia(this.config.markers(g.view)),this.spacer&&this.config.updateSpacer){var k=this.config.updateSpacer(this.spacer.markers[0],
g);k!=this.spacer.markers[0]&&this.spacer.update(g.view,0,0,[k])}k=g.view.viewport;return!$a.RangeSet.eq(this.markers,e,k.from,k.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(g):!1)}destroy(){for(let g of this.elements)g.destroy()}},Ue=class{constructor(g,e,k,r){this.height=-1;this.above=0;this.markers=[];this.dom=document.createElement("div");this.dom.className="cm-gutterElement";this.update(g,e,k,r)}update(g,e,k,r){this.height!=e&&(this.height=e,this.dom.style.height=e+"px");this.above!=
k&&(this.dom.style.marginTop=(this.above=k)?k+"px":"");a:if(e=this.markers,e.length!=r.length)e=!1;else{for(k=0;k<e.length;k++)if(!e[k].compare(r[k])){e=!1;break a}e=!0}e||this.setMarkers(g,r)}setMarkers(g,e){let k="cm-gutterElement",r=this.dom.firstChild;for(let G=0,Q=0;;){let aa=Q,fa=G<e.length?e[G++]:null,ra=!1;if(fa){var x=fa.elementClass;x&&(k+=" "+x);for(x=Q;x<this.markers.length;x++)if(this.markers[x].compare(fa)){aa=x;ra=!0;break}}else aa=this.markers.length;for(;Q<aa;)x=this.markers[Q++],
x.toDOM&&(x.destroy(r),x=r.nextSibling,r.remove(),r=x);if(!fa)break;fa.toDOM&&(ra?r=r.nextSibling:this.dom.insertBefore(fa.toDOM(g),r));ra&&Q++}this.dom.className=k;this.markers=e}destroy(){this.setMarkers(null,[])}},xh=$a.Facet.define(),Pi=$a.Facet.define(),sf=$a.Facet.define({combine(g){return $a.combineConfig(g,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,k){e=Object.assign({},e);for(let r in k){let x=e[r],G=k[r];e[r]=x?(Q,aa,fa)=>x(Q,aa,fa)||G(Q,aa,fa):G}return e}})}}),hf=class extends re{constructor(g){super();
this.number=g}eq(g){return this.number==g.number}toDOM(){return document.createTextNode(this.number)}},Qi=Fg.compute([sf],g=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(xh)},lineMarker(e,k,r){return r.some(x=>x.toDOM)?null:new hf(jb(e,e.state.doc.lineAt(k.from).number))},widgetMarker:(e,k,r)=>{for(let x of e.state.facet(Pi)){let G=x(e,k,r);if(G)return G}return null},lineMarkerChange:e=>e.startState.facet(sf)!=e.state.facet(sf),initialSpacer(e){return new hf(jb(e,
Eb(e.state.doc.lines)))},updateSpacer(e,k){k=jb(k.view,Eb(k.view.state.doc.lines));return k==e.number?e:new hf(k)},domEventHandlers:g.facet(sf).domEventHandlers})),Xf=new class extends re{constructor(){super(...arguments);this.elementClass="cm-activeLineGutter"}},Xj=Cf.compute(["selection"],g=>{let e=[],k=-1;for(let r of g.selection.ranges){let x=g.doc.lineAt(r.head).from;x>k&&(k=x,e.push(Xf.range(x)))}return $a.RangeSet.of(e)}),di=xa.mark({class:"cm-highlightTab"}),Yj=xa.mark({class:"cm-highlightSpace"}),
Ri=vc(new gh({regexp:/\t| /g,decoration:g=>"\t"==g[0]?di:Yj,boundary:/\S/})),Si=vc(new gh({regexp:/\s+$/g,decoration:xa.mark({class:"cm-trailingSpace"}),boundary:/\S/})),Zj={HeightMap:Rd,HeightOracle:oh,MeasuredHeights:Be,QueryType:sd,ChangedRange:ye,computeOrder:bb,moveVisually:db,clearHeightChangeFlag:function(){ne=!1},getHeightChangeFlag:()=>ne};n.BidiSpan=rc;n.BlockInfo=te;n.Decoration=xa;n.EditorView=ad;n.GutterMarker=re;n.MatchDecorator=gh;n.RectangleMarker=ch;n.ViewPlugin=Xd;n.ViewUpdate=kh;
n.WidgetType=Ga;n.__test=Zj;n.closeHoverTooltips=ie;n.crosshairCursor=function(g={}){let [e,k]=Wf[g.key||"Alt"],r=Xd.fromClass(class{constructor(x){this.view=x;this.isDown=!1}set(x){this.isDown!=x&&(this.isDown=x,this.view.update([]))}},{eventObservers:{keydown(x){this.set(x.keyCode==e||k(x))},keyup(x){x.keyCode!=e&&k(x)||this.set(!1)},mousemove(x){this.set(k(x))}}});return[r,ad.contentAttributes.of(x=>{var G;return null!==(G=x.plugin(r))&&void 0!==G&&G.isDown?Ag:null})]};n.drawSelection=function(g=
{}){return[cf.of(g),Rj,xg,Sj,hh.of(!0)]};n.dropCursor=function(){return[yg,Tj]};n.getDrawSelectionConfig=function(g){return g.facet(cf)};n.getPanel=function(g,e){e=(g=g.plugin(Dg))?g.specs.indexOf(e):-1;return-1<e?g.panels[e]:null};n.getTooltip=function(g,e){g=g.plugin(Bg);if(!g)return null;e=g.manager.tooltips.indexOf(e);return 0>e?null:g.manager.tooltipViews[e]};n.gutter=function(g){return[ma(),Fg.of(Object.assign(Object.assign({},Eg),g))]};n.gutterLineClass=Cf;n.gutterWidgetClass=Te;n.gutters=
ma;n.hasHoverTooltips=function(g){return g.facet(zf).some(e=>e)};n.highlightActiveLine=function(){return Uj};n.highlightActiveLineGutter=function(){return Xj};n.highlightSpecialChars=function(g={}){return[fh.of(g),ud()]};n.highlightTrailingWhitespace=function(){return Si};n.highlightWhitespace=function(){return Ri};n.hoverTooltip=function(g,e={}){let k=$a.StateEffect.define(),r=$a.StateField.define({create(){return[]},update(x,G){if(x.length&&(e.hideOnChange&&(G.docChanged||G.selection)?x=[]:e.hideOn&&
(x=x.filter(Q=>!e.hideOn(G,Q))),G.docChanged)){let Q=[];for(let aa of x)if(x=G.changes.mapPos(aa.pos,-1,$a.MapMode.TrackDel),null!=x){let fa=Object.assign(Object.create(null),aa);fa.pos=x;null!=fa.end&&(fa.end=G.changes.mapPos(fa.end));Q.push(fa)}x=Q}for(let Q of G.effects)Q.is(k)&&(x=Q.value),Q.is(Ni)&&(x=[]);return x},provide:x=>zf.from(x)});return{active:r,extension:[r,Xd.define(x=>new Wj(x,g,r,k,e.hoverTime||300)),Vj]}};n.keymap=rf;n.layer=sc;n.lineNumberMarkers=xh;n.lineNumberWidgetMarker=Pi;
n.lineNumbers=function(g={}){return[sf.of(g),ma(),Qi]};n.logException=oa;n.panels=function(g){return g?[De.of(g)]:[]};n.placeholder=function(g){return Xd.fromClass(class{constructor(e){this.view=e;this.placeholder=g?xa.set([xa.widget({widget:new Jd(g),side:1}).range(0)]):xa.none}get decorations(){return this.view.state.doc.length?xa.none:this.placeholder}},{decorations:e=>e.decorations})};n.rectangularSelection=function(g){let e=g?.eventFilter||(k=>k.altKey&&0==k.button);return ad.mouseSelectionStyle.of((k,
r)=>e(r)?ze(k,r):null)};n.repositionTooltips=function(g){(g=g.plugin(Bg))&&g.maybeMeasure()};n.runScopeHandlers=function(g,e,k){return eb(wa(g.state),e,g,k)};n.scrollPastEnd=function(){return[gf,vf.of(g=>{var e;return(null===(e=g.plugin(gf))||void 0===e?void 0:e.attrs)||null})]};n.showPanel=Se;n.showTooltip=th;n.tooltips=function(g={}){return sh.of(g)}}),ak=va(n=>{function p(N,M,Z,pa){switch(N){case -2:return Z<M;case -1:return pa>=M&&Z<M;case 0:return Z<M&&pa>M;case 1:return Z<=M&&pa>M;case 2:return pa>
M;case 4:return!0}}function q(N,M,Z,pa){for(var Ja;N.from==N.to||(1>Z?N.from>=M:N.from>M)||(-1<Z?N.to<=M:N.to<M);){var Sa=!pa&&N instanceof $b&&0>N.index?null:N.parent;if(!Sa)return N;N=Sa}Sa=pa?0:n.IterMode.IgnoreOverlays;if(pa)for(let Za=N,tb=Za.parent;tb;Za=tb,tb=Za.parent)Za instanceof $b&&0>Za.index&&(null===(Ja=tb.enter(M,Z,Sa))||void 0===Ja?void 0:Ja.from)!=Za.from&&(N=tb);for(;;){pa=N.enter(M,Z,Sa);if(!pa)return N;N=pa}}function u(N,M,Z,pa){N=N.cursor();let Ja=[];if(!N.firstChild())return Ja;
if(null!=Z)for(let Sa=!1;!Sa;)if(Sa=N.type.is(Z),!N.nextSibling())return Ja;for(;;){if(null!=pa&&N.type.is(pa))return Ja;if(N.type.is(M)&&Ja.push(N.node),!N.nextSibling())return null==pa?Ja:[]}}function w(N,M,Z=M.length-1){for(;0<=Z;N=N.parent){if(!N)return!1;if(!N.type.isAnonymous){if(M[Z]&&M[Z]!=N.name)return!1;Z--}}return!0}function y(N){if(!N.length)return null;let M=0,Z=N[0];for(var pa=1;pa<N.length;pa++){let Ja=N[pa];(Ja.from>Z.from||Ja.to<Z.to)&&(Z=Ja,M=pa)}pa=Z instanceof $b&&0>Z.index?null:
Z.parent;N=N.slice();return pa?N[M]=pa:N.splice(M,1),new Bb(N,Z)}function B(N){return N.children.some(M=>M instanceof Lb||!M.type.isAnonymous||B(M))}function z(N){function M(wc,zc,da,Ca,Ea,Ta){let {id:mb,start:Fb,end:Hb,size:ic}=hc,Jc=Nc,$c=Ic;for(;0>ic;){if(hc.next(),-1==ic){da.push(ec[mb]);Ca.push(Fb-wc);return}if(-3==ic){Ic=mb;return}if(-4==ic){Nc=mb;return}throw new RangeError(`Unrecognized record size: ${ic}`);}var Cc=Fc[mb],Tc=Fb-wc,Vc;if(Vc=Hb-Fb<=Jb){var qd=hc.pos-zc;zc=hc.fork();var wd=Vc=
0,Yc=0,nd=zc.end-Jb,V={size:0,start:0,skip:0};a:for(var A=zc.pos-qd;zc.pos>A;){var J=zc.size;if(zc.id==Ea&&0<=J){V.size=Vc;V.start=wd;V.skip=Yc;Yc+=4;Vc+=4;zc.next();continue}var W=zc.pos-J;if(0>J||W<A||zc.start<nd)break;var ea=zc.id>=yc?4:0;let qa=zc.start;for(zc.next();zc.pos>W;){if(0>zc.size)if(-3==zc.size)ea+=4;else break a;else zc.id>=yc&&(ea+=4);zc.next()}wd=qa;Vc+=J;Yc+=ea}Vc=qd=((0>Ea||Vc==qd)&&(V.size=Vc,V.start=wd,V.skip=Yc),4<V.size?V:void 0)}if(Vc){Tc=new Uint16Array(qd.size-qd.skip);
Cc=hc.pos-qd.size;for(Ta=Tc.length;hc.pos>Cc;)Ta=Sa(qd.start,Tc,Ta);Cc=new Lb(Tc,Hb-qd.start,Pb);Tc=qd.start-wc}else{wd=hc.pos-ic;hc.next();wc=[];Ea=[];Yc=mb>=yc?mb:-1;nd=0;for(V=Hb;hc.pos>wd;)if(0<=Yc&&hc.id==Yc&&0<=hc.size)hc.end<=V-Jb&&(pa(wc,Ea,Fb,nd,hc.end,V,Yc,Jc,$c),nd=wc.length,V=hc.end),hc.next();else if(2500<Ta){qd=Fb;J=wd;zc=wc;Vc=Ea;A=[];W=0;for(ea=-1;hc.pos>J;){let {id:qa,start:za,end:Wa,size:fb}=hc;if(!(4<fb)){if(-1<ea&&za<ea)break;0>ea&&(ea=Wa-Jb);A.push(qa,za,Wa);W++}hc.next()}if(W){J=
new Uint16Array(4*W);W=A[A.length-2];for(let qa=A.length-3,za=0;0<=qa;qa-=3)J[za++]=A[qa],J[za++]=A[qa+1]-W,J[za++]=A[qa+2]-W,J[za++]=za;zc.push(new Lb(J,A[2]-W,Pb));Vc.push(W-qd)}}else M(Fb,wd,wc,Ea,Yc,Ta+1);(0<=Yc&&0<nd&&nd<wc.length&&pa(wc,Ea,Fb,nd,Fb,V,Yc,Jc,$c),wc.reverse(),Ea.reverse(),-1<Yc&&0<nd)?(Ta=Z(Cc,$c),Cc=H(Cc,wc,Ea,0,wc.length,0,Hb-Fb,Ta,Ta)):Cc=Ja(Cc,wc,Ea,Hb-Fb,Jc-Hb,$c)}da.push(Cc);Ca.push(Tc)}function Z(wc,zc){return(da,Ca,Ea)=>{let Ta=0,mb=da.length-1,Fb,Hb;if(0<=mb&&(Fb=da[mb])instanceof
gb){if(!mb&&Fb.type==wc&&Fb.length==Ea)return Fb;(Hb=Fb.prop(sa.lookAhead))&&(Ta=Ca[mb]+Fb.length+Hb)}return Ja(wc,da,Ca,Ea,Ta,zc)}}function pa(wc,zc,da,Ca,Ea,Ta,mb,Fb,Hb){let ic=[],Jc=[];for(;wc.length>Ca;)ic.push(wc.pop()),Jc.push(zc.pop()+da-Ea);wc.push(Ja(Pb.types[mb],ic,Jc,Ta-Ea,Fb-Ta,Hb));zc.push(Ea-da)}function Ja(wc,zc,da,Ca,Ea,Ta,mb){Ta&&(Ta=[sa.contextHash,Ta],mb=mb?[Ta].concat(mb):[Ta]);25<Ea&&(Ea=[sa.lookAhead,Ea],mb=mb?[Ea].concat(mb):[Ea]);return new gb(wc,zc,da,Ca,mb)}function Sa(wc,
zc,da){let {id:Ca,start:Ea,end:Ta,size:mb}=hc;if(hc.next(),0<=mb&&Ca<yc){let Fb=da;if(4<mb){let Hb=hc.pos-(mb-4);for(;hc.pos>Hb;)da=Sa(wc,zc,da)}zc[--da]=Fb;zc[--da]=Ta-wc;zc[--da]=Ea-wc;zc[--da]=Ca}else-3==mb?Ic=Ca:-4==mb&&(Nc=Ca);return da}var Za;let {buffer:tb,nodeSet:Pb,maxBufferLength:Jb=1024,reused:ec=[],minRepeatType:yc=Pb.types.length}=N,hc=Array.isArray(tb)?new qb(tb,tb.length):tb,Fc=Pb.types,Ic=0,Nc=0,Dc=[],cd=[];for(;0<hc.pos;)M(N.start||0,N.bufferStart||0,Dc,cd,-1,0);let jd=null!==(Za=
N.length)&&void 0!==Za?Za:Dc.length?cd[0]+Dc[0].length:0;return new gb(Fc[N.topID],Dc.reverse(),cd.reverse(),jd)}function E(N,M){if(!N.isAnonymous||M instanceof Lb||M.type!=N)return 1;let Z=Cb.get(M);if(null==Z){Z=1;for(let pa of M.children){if(pa.type!=N||!(pa instanceof gb)){Z=1;break}Z+=E(N,pa)}Cb.set(M,Z)}return Z}function H(N,M,Z,pa,Ja,Sa,Za,tb,Pb){function Jb(Ic,Nc,Dc,cd,jd){for(;Dc<cd;){let zc=Dc;var wc=Nc[Dc];let da=E(N,Ic[Dc]);for(Dc++;Dc<cd;Dc++){let Ca=E(N,Ic[Dc]);if(da+Ca>=yc)break;da+=
Ca}if(Dc==zc+1){if(da>yc){wc=Ic[zc];Jb(wc.children,wc.positions,0,wc.children.length,Nc[zc]+jd);continue}hc.push(Ic[zc])}else hc.push(H(N,Ic,Nc,zc,Dc,wc,Nc[Dc-1]+Ic[Dc-1].length-wc,null,Pb));Fc.push(wc+jd-Sa)}}let ec=0;for(let Ic=pa;Ic<Ja;Ic++)ec+=E(N,M[Ic]);let yc=Math.ceil(1.5*ec/8),hc=[],Fc=[];return Jb(M,Z,pa,Ja,0),(tb||Pb)(hc,Fc,Za)}function T(N){if(!N.length||N.some(M=>M.from>=M.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(N));}function ca(N,M,Z){for(let pa of N){if(pa.from>=
Z)break;if(pa.to>M)return pa.from<=M&&pa.to>=Z?2:1}return 0}function ha(N){function M(Jb,ec,yc,hc,Fc,Ic){var Nc=pa[Ic];let Dc=[],cd=[];var jd=Za;if(Jb<Nc){let wc=jd.buffer[Jb+1];Dc.push(jd.slice(Jb,Nc,wc));cd.push(wc-hc)}Jb=tb[Nc+1];jd=tb[Nc+2];Pb.push(Dc.length);Ic=Ic?M(Nc+4,tb[Nc+3],Za.set.types[tb[Nc]],Jb,jd-Jb,Ic-1):Z.toTree();Dc.push(Ic);cd.push(Jb-hc);Ic=Za;Nc=tb[Nc+3];Nc<ec&&(Jb=Ic.buffer[Nc+1],Dc.push(Ic.slice(Nc,ec,Jb)),cd.push(Jb-hc));return new gb(yc,Dc,cd,Fc)}let {node:Z}=N,pa=[];var Ja=
Z.context.buffer;do pa.push(N.index),N.parent();while(!N.tree);let Sa=N.tree;Ja=Sa.children.indexOf(Ja);let Za=Sa.children[Ja],tb=Za.buffer,Pb=[Ja];Sa.children[Ja]=M(0,tb.length,kb.none,0,Za.length,pa.length-1);for(let Jb of Pb)N.yield(new $b(N.tree.children[Jb],N.tree.positions[Jb]+N.from,Jb,N._tree))}function Da(N,M){let Z=null,pa=M;for(let Ja=1,Sa=0;Ja<N.length;Ja++){let Za=N[Ja-1].to,tb=N[Ja].from;for(;Sa<pa.length;Sa++){let Pb=pa[Sa];if(Pb.from>=tb)break;Pb.to<=Za||(Z||(pa=Z=M.slice()),Pb.from<
Za?(Z[Sa]=new Ha(Pb.from,Za),Pb.to>tb&&Z.splice(Sa+1,0,new Ha(tb,Pb.to))):Pb.to>tb?Z[Sa--]=new Ha(tb,Pb.to):Z.splice(Sa--,1))}}return pa}function Fa(N,M,Z,pa){let Ja=0,Sa=0,Za=!1,tb=!1,Pb=-1E9,Jb=[];for(;;){let ec=Ja==N.length?1E9:Za?N[Ja].to:N[Ja].from,yc=Sa==M.length?1E9:tb?M[Sa].to:M[Sa].from;if(Za!=tb){let hc=Math.max(Pb,Z),Fc=Math.min(ec,yc,pa);hc<Fc&&Jb.push(new Ha(hc,Fc))}if(Pb=Math.min(ec,yc),1E9==Pb)break;ec==Pb&&(Za?(Za=!1,Ja++):Za=!0);yc==Pb&&(tb?(tb=!1,Sa++):tb=!0)}return Jb}function ua(N,
M){let Z=[];for(let {pos:Sa,mount:Za,frag:tb}of N){N=Sa+(Za.overlay?Za.overlay[0].from:0);var pa=N+Za.tree.length,Ja=Math.max(tb.from,N);let Pb=Math.min(tb.to,pa);if(Za.overlay){pa=Za.overlay.map(Jb=>new Ha(Jb.from+Sa,Jb.to+Sa));pa=Fa(M,pa,Ja,Pb);for(let Jb=0,ec=Ja;;Jb++){let yc=(Ja=Jb==pa.length)?Pb:pa[Jb].from;if(yc>ec&&Z.push(new sb(ec,yc,Za.tree,-N,tb.from>=ec||tb.openStart,tb.to<=yc||tb.openEnd)),Ja)break;ec=pa[Jb].to}}else Z.push(new sb(Ja,Pb,Za.tree,-N,tb.from>=N||tb.openStart,tb.to<=pa||tb.openEnd))}return Z}
var Va=0,Ha=class{constructor(N,M){this.from=N;this.to=M}},sa=class{constructor(N={}){this.id=Va++;this.perNode=!!N.perNode;this.deserialize=N.deserialize||(()=>{throw Error("This node type doesn't define a deserialize function");})}add(N){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof N&&(N=kb.match(N)),M=>{M=N(M);return void 0===M?null:[this,M]}}};sa.closedBy=new sa({deserialize:N=>N.split(" ")});sa.openedBy=new sa({deserialize:N=>N.split(" ")});
sa.group=new sa({deserialize:N=>N.split(" ")});sa.isolate=new sa({deserialize:N=>{if(N&&"rtl"!=N&&"ltr"!=N&&"auto"!=N)throw new RangeError("Invalid value for isolate: "+N);return N||"auto"}});sa.contextHash=new sa({perNode:!0});sa.lookAhead=new sa({perNode:!0});sa.mounted=new sa({perNode:!0});var Na=class{constructor(N,M,Z){this.tree=N;this.overlay=M;this.parser=Z}static get(N){return N&&N.props&&N.props[sa.mounted.id]}},Qa=Object.create(null),kb=class N{constructor(M,Z,pa,Ja=0){this.name=M;this.props=
Z;this.id=pa;this.flags=Ja}static define(M){let Z=M.props&&M.props.length?Object.create(null):Qa,pa=new N(M.name||"",Z,M.id,(M.top?1:0)|(M.skipped?2:0)|(M.error?4:0)|(null==M.name?8:0));if(M.props)for(let Ja of M.props)if(Array.isArray(Ja)||(Ja=Ja(pa)),Ja){if(Ja[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");Z[Ja[0].id]=Ja[1]}return pa}prop(M){return this.props[M.id]}get isTop(){return 0<(this.flags&1)}get isSkipped(){return 0<(this.flags&2)}get isError(){return 0<(this.flags&
4)}get isAnonymous(){return 0<(this.flags&8)}is(M){if("string"==typeof M){if(this.name==M)return!0;let Z=this.prop(sa.group);return Z?-1<Z.indexOf(M):!1}return this.id==M}static match(M){let Z=Object.create(null);for(let pa in M)for(let Ja of pa.split(" "))Z[Ja]=M[pa];return pa=>{for(let Ja=pa.prop(sa.group),Sa=-1;Sa<(Ja?Ja.length:0);Sa++){let Za=Z[0>Sa?pa.name:Ja[Sa]];if(Za)return Za}}}};kb.none=new kb("",Object.create(null),0,8);var pb=class N{constructor(M){this.types=M;for(let Z=0;Z<M.length;Z++)if(M[Z].id!=
Z)throw new RangeError("Node type ids should correspond to array positions when creating a node set");}extend(...M){let Z=[];for(let pa of this.types){let Ja=null;for(let Sa of M){let Za=Sa(pa);Za&&(Ja||=Object.assign({},pa.props),Ja[Za[0].id]=Za[1])}Z.push(Ja?new kb(pa.name,Ja,pa.id,pa.flags):pa)}return new N(Z)}},ib=new WeakMap,zb=new WeakMap;n.IterMode=void 0;(function(N){N[N.ExcludeBuffers=1]="ExcludeBuffers";N[N.IncludeAnonymous=2]="IncludeAnonymous";N[N.IgnoreMounts=4]="IgnoreMounts";N[N.IgnoreOverlays=
8]="IgnoreOverlays"})(n.IterMode||(n.IterMode={}));var gb=class N{constructor(M,Z,pa,Ja,Sa){if(this.type=M,this.children=Z,this.positions=pa,this.length=Ja,this.props=null,Sa&&Sa.length){this.props=Object.create(null);for(let [Za,tb]of Sa)this.props["number"==typeof Za?Za:Za.id]=tb}}toString(){var M=Na.get(this);if(M&&!M.overlay)return M.tree.toString();M="";for(let Z of this.children){let pa=Z.toString();pa&&(M&&(M+=","),M+=pa)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?
JSON.stringify(this.type.name):this.type.name)+(M.length?"("+M+")":""):M}cursor(M=0){return new Db(this.topNode,M)}cursorAt(M,Z=0,pa){pa=ib.get(this)||this.topNode;pa=new Db(pa);return pa.moveTo(M,Z),ib.set(this,pa._tree),pa}get topNode(){return new $b(this,0,0,null)}resolve(M,Z=0){M=q(ib.get(this)||this.topNode,M,Z,!1);return ib.set(this,M),M}resolveInner(M,Z=0){M=q(zb.get(this)||this.topNode,M,Z,!0);return zb.set(this,M),M}resolveStack(M,Z=0){let pa=this.resolveInner(M,Z),Ja=null;for(var Sa=pa instanceof
$b?pa:pa.context.parent;Sa;Sa=Sa.parent)if(0>Sa.index)Sa=Sa.parent,(Ja||=[pa]).push(Sa.resolve(M,Z));else{var Za=Na.get(Sa.tree);Za&&Za.overlay&&Za.overlay[0].from<=M&&Za.overlay[Za.overlay.length-1].to>=M&&(Za=new $b(Za.tree,Za.overlay[0].from+Sa.from,-1,Sa),(Ja||=[pa]).push(q(Za,M,Z,!1)))}return Ja?y(Ja):pa}iterate(M){let {enter:Z,leave:pa,from:Ja=0,to:Sa=this.length}=M;var Za=M.mode||0;M=0<(Za&n.IterMode.IncludeAnonymous);for(Za=this.cursor(Za|n.IterMode.IncludeAnonymous);;){let tb=!1;if(Za.from<=
Sa&&Za.to>=Ja&&(!M&&Za.type.isAnonymous||!1!==Z(Za))){if(Za.firstChild())continue;tb=!0}for(;tb&&pa&&(M||!Za.type.isAnonymous)&&pa(Za),!Za.nextSibling();){if(!Za.parent())return;tb=!0}}}prop(M){return M.perNode?this.props?this.props[M.id]:void 0:this.type.prop(M)}get propValues(){let M=[];if(this.props)for(let Z in this.props)M.push([+Z,this.props[Z]]);return M}balance(M={}){return 8>=this.children.length?this:H(kb.none,this.children,this.positions,0,this.children.length,0,this.length,(Z,pa,Ja)=>
new N(this.type,Z,pa,Ja,this.propValues),M.makeTree||((Z,pa,Ja)=>new N(kb.none,Z,pa,Ja)))}static build(M){return z(M)}};gb.empty=new gb(kb.none,[],[],0);var qb=class N{constructor(M,Z){this.buffer=M;this.index=Z}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new N(this.buffer,this.index)}},Lb=class N{constructor(M,
Z,pa){this.buffer=M;this.length=Z;this.set=pa}get type(){return kb.none}toString(){let M=[];for(let Z=0;Z<this.buffer.length;)M.push(this.childString(Z)),Z=this.buffer[Z+3];return M.join(",")}childString(M){let Z=this.buffer[M+3];var pa=this.set.types[this.buffer[M]];let Ja=pa.name;if(/\W/.test(Ja)&&!pa.isError&&(Ja=JSON.stringify(Ja)),M+=4,Z==M)return Ja;for(pa=[];M<Z;)pa.push(this.childString(M)),M=this.buffer[M+3];return Ja+"("+pa.join(",")+")"}findChild(M,Z,pa,Ja,Sa){let {buffer:Za}=this,tb=-1;
for(;M!=Z&&!(p(Sa,Ja,Za[M+1],Za[M+2])&&(tb=M,0<pa));M=Za[M+3]);return tb}slice(M,Z,pa){let Ja=this.buffer,Sa=new Uint16Array(Z-M),Za=0;for(let tb=M,Pb=0;tb<Z;){Sa[Pb++]=Ja[tb++];Sa[Pb++]=Ja[tb++]-pa;let Jb=Sa[Pb++]=Ja[tb++]-pa;Sa[Pb++]=Ja[tb++]-M;Za=Math.max(Za,Jb)}return new N(Sa,Za,this.set)}},Xb=class{cursor(N=0){return new Db(this,N)}getChild(N,M=null,Z=null){N=u(this,N,M,Z);return N.length?N[0]:null}getChildren(N,M=null,Z=null){return u(this,N,M,Z)}resolve(N,M=0){return q(this,N,M,!1)}resolveInner(N,
M=0){return q(this,N,M,!0)}matchContext(N){return w(this.parent,N)}enterUnfinishedNodesBefore(N){N=this.childBefore(N);let M=this;for(;N;){let Z=N.lastChild;if(!Z||Z.to!=N.to)break;Z.type.isError&&Z.from==Z.to?(M=N,N=Z.prevSibling):N=Z}return M}get node(){return this}get next(){return this.parent}},$b=class N extends Xb{constructor(M,Z,pa,Ja){super();this._tree=M;this.from=Z;this.index=pa;this._parent=Ja}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+
this._tree.length}nextChild(M,Z,pa,Ja,Sa=0){for(let Za=this;;){for(let {children:tb,positions:Pb}=Za._tree,Jb=0<Z?tb.length:-1;M!=Jb;M+=Z){let ec=tb[M],yc=Pb[M]+Za.from;if(p(Ja,pa,yc,yc+ec.length))if(ec instanceof Lb){if(Sa&n.IterMode.ExcludeBuffers)continue;let hc=ec.findChild(0,ec.buffer.length,Z,pa-yc,Ja);if(-1<hc)return new yb(new pc(Za,ec,M,yc),null,hc)}else if(Sa&n.IterMode.IncludeAnonymous||!ec.type.isAnonymous||B(ec)){let hc;if(!(Sa&n.IterMode.IgnoreMounts)&&(hc=Na.get(ec))&&!hc.overlay)return new N(hc.tree,
yc,M,Za);M=new N(ec,yc,M,Za);return Sa&n.IterMode.IncludeAnonymous||!M.type.isAnonymous?M:M.nextChild(0>Z?ec.children.length-1:0,Z,pa,Ja)}}if(Sa&n.IterMode.IncludeAnonymous||!Za.type.isAnonymous||(0<=Za.index?M=Za.index+Z:M=0>Z?-1:Za._parent._tree.children.length,Za=Za._parent,!Za))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(M){return this.nextChild(0,1,M,2)}childBefore(M){return this.nextChild(this._tree.children.length-
1,-1,M,-2)}enter(M,Z,pa=0){let Ja;if(!(pa&n.IterMode.IgnoreOverlays)&&(Ja=Na.get(this._tree))&&Ja.overlay){let Sa=M-this.from;for(let {from:Za,to:tb}of Ja.overlay)if((0<Z?Za<=Sa:Za<Sa)&&(0>Z?tb>=Sa:tb>Sa))return new N(Ja.tree,Ja.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,M,Z,pa)}nextSignificantParent(){let M=this;for(;M.type.isAnonymous&&M._parent;)M=M._parent;return M}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&
0<=this.index?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&0<=this.index?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}},pc=class{constructor(N,M,Z,pa){this.parent=N;this.buffer=M;this.index=Z;this.start=pa}},yb=class N extends Xb{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+
this.context.buffer.buffer[this.index+2]}constructor(M,Z,pa){super();this.context=M;this._parent=Z;this.index=pa;this.type=M.buffer.set.types[M.buffer.buffer[pa]]}child(M,Z,pa){let {buffer:Ja}=this.context;M=Ja.findChild(this.index+4,Ja.buffer[this.index+3],M,Z-this.context.start,pa);return 0>M?null:new N(this.context,this,M)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(M){return this.child(1,M,2)}childBefore(M){return this.child(-1,M,-2)}enter(M,
Z,pa=0){if(pa&n.IterMode.ExcludeBuffers)return null;({buffer:pa}=this.context);M=pa.findChild(this.index+4,pa.buffer[this.index+3],0<Z?1:-1,M-this.context.start,Z);return 0>M?null:new N(this.context,this,M)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(M){return this._parent?null:this.context.parent.nextChild(this.context.index+M,M,0,4)}get nextSibling(){let {buffer:M}=this.context,Z=M.buffer[this.index+3];return Z<(this._parent?M.buffer[this._parent.index+
3]:M.buffer.length)?new N(this.context,this._parent,Z):this.externalSibling(1)}get prevSibling(){let {buffer:M}=this.context,Z=this._parent?this._parent.index+4:0;return this.index==Z?this.externalSibling(-1):new N(this.context,this._parent,M.findChild(Z,this.index,-1,0,4))}get tree(){return null}toTree(){let M=[],Z=[],{buffer:pa}=this.context,Ja=this.index+4,Sa=pa.buffer[this.index+3];Sa>Ja&&(M.push(pa.slice(Ja,Sa,pa.buffer[this.index+1])),Z.push(0));return new gb(this.type,M,Z,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}},
Bb=class{constructor(N,M){this.heads=N;this.node=M}get next(){return y(this.heads)}},Db=class{get name(){return this.type.name}constructor(N,M=0){if(this.mode=M,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,N instanceof $b)this.yieldNode(N);else{this._tree=N.context.parent;this.buffer=N.context;for(M=N._parent;M;M=M._parent)this.stack.unshift(M.index);this.bufferNode=N;this.yieldBuf(N.index)}}yieldNode(N){return N?(this._tree=N,this.type=N.type,this.from=N.from,this.to=N.to,!0):
!1}yieldBuf(N,M){this.index=N;let {start:Z,buffer:pa}=this.buffer;return this.type=M||pa.set.types[pa.buffer[N]],this.from=Z+pa.buffer[N+1],this.to=Z+pa.buffer[N+2],!0}yield(N){return N?N instanceof $b?(this.buffer=null,this.yieldNode(N)):(this.buffer=N.context,this.yieldBuf(N.index,N.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(N,M,Z){if(!this.buffer)return this.yield(this._tree.nextChild(0>N?this._tree._tree.children.length-
1:0,N,M,Z,this.mode));let {buffer:pa}=this.buffer;N=pa.findChild(this.index+4,pa.buffer[this.index+3],N,M-this.buffer.start,Z);return 0>N?!1:(this.stack.push(this.index),this.yieldBuf(N))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(N){return this.enterChild(1,N,2)}childBefore(N){return this.enterChild(-1,N,-2)}enter(N,M,Z=this.mode){return this.buffer?Z&n.IterMode.ExcludeBuffers?!1:this.enterChild(1,N,M):this.yield(this._tree.enter(N,M,Z))}parent(){if(!this.buffer)return this.yieldNode(this.mode&
n.IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let N=this.mode&n.IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(N)}sibling(N){if(!this.buffer)return this._tree._parent?this.yield(0>this._tree.index?null:this._tree._parent.nextChild(this._tree.index+N,N,0,4,this.mode)):!1;let {buffer:M}=this.buffer,Z=this.stack.length-1;if(0>N){var pa=0>Z?0:
this.stack[Z]+4;if(this.index!=pa)return this.yieldBuf(M.findChild(pa,this.index,-1,0,4))}else if(pa=M.buffer[this.index+3],pa<(0>Z?M.buffer.length:M.buffer[this.stack[Z]+3]))return this.yieldBuf(pa);return 0>Z?this.yield(this.buffer.parent.nextChild(this.buffer.index+N,N,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(N){var M,Z;({buffer:Z}=this);if(Z){if(0<N){if(this.index<Z.buffer.buffer.length)return!1}else for(M=0;M<this.index;M++)if(Z.buffer.buffer[M+
3]<this.index)return!1;({index:M,parent:Z}=Z)}else({index:M,_parent:Z}=this._tree);for(;Z;{index:M,_parent:Z}=Z)if(-1<M)for(let pa=M+N,Ja=0>N?-1:Z._tree.children.length;pa!=Ja;pa+=N)if(M=Z._tree.children[pa],this.mode&n.IterMode.IncludeAnonymous||M instanceof Lb||!M.type.isAnonymous||B(M))return!1;return!0}move(N,M){if(M&&this.enterChild(N,0,4))return!0;for(;;){if(this.sibling(N))return!0;if(this.atLastNode(N)||!this.parent())return!1}}next(N=!0){return this.move(1,N)}prev(N=!0){return this.move(-1,
N)}moveTo(N,M=0){for(;(this.from==this.to||(1>M?this.from>=N:this.from>N)||(-1<M?this.to<=N:this.to<N))&&this.parent(););for(;this.enterChild(1,N,M););return this}get node(){if(!this.buffer)return this._tree;var N=this.bufferNode;let M=null,Z=0;if(N&&N.context==this.buffer)a:for(let pa=this.index,Ja=this.stack.length;0<=Ja;){for(let Sa=N;Sa;Sa=Sa._parent)if(Sa.index==pa){if(pa==this.index)return Sa;M=Sa;Z=Ja+1;break a}pa=this.stack[--Ja]}for(N=Z;N<this.stack.length;N++)M=new yb(this.buffer,M,this.stack[N]);
return this.bufferNode=new yb(this.buffer,M,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(N,M){for(let Z=0;;){let pa=!1;if(this.type.isAnonymous||!1!==N(this)){if(this.firstChild()){Z++;continue}this.type.isAnonymous||(pa=!0)}for(;;){if(pa&&M&&M(this),!Z)return;if(this.nextSibling())break;this.parent();Z--;pa=!0}}}matchContext(N){if(!this.buffer)return w(this.node.parent,N);let {buffer:M}=this.buffer,{types:Z}=M.set;for(let pa=N.length-1,Ja=this.stack.length-1;0<=pa;Ja--){if(0>
Ja)return w(this._tree,N,pa);let Sa=Z[M.buffer[this.stack[Ja]]];if(!Sa.isAnonymous){if(N[pa]&&N[pa]!=Sa.name)return!1;pa--}}return!0}},Cb=new WeakMap;Xb=class{constructor(){this.map=new WeakMap}setBuffer(N,M,Z){let pa=this.map.get(N);pa||this.map.set(N,pa=new Map);pa.set(M,Z)}getBuffer(N,M){return(N=this.map.get(N))&&N.get(M)}set(N,M){N instanceof yb?this.setBuffer(N.context.buffer,N.index,M):N instanceof $b&&this.map.set(N.tree,M)}get(N){return N instanceof yb?this.getBuffer(N.context.buffer,N.index):
N instanceof $b?this.map.get(N.tree):void 0}cursorSet(N,M){N.buffer?this.setBuffer(N.buffer.buffer,N.index,M):this.map.set(N.tree,M)}cursorGet(N){return N.buffer?this.getBuffer(N.buffer.buffer,N.index):this.map.get(N.tree)}};var sb=class N{constructor(M,Z,pa,Ja,Sa=!1,Za=!1){this.from=M;this.to=Z;this.tree=pa;this.offset=Ja;this.open=(Sa?1:0)|(Za?2:0)}get openStart(){return 0<(this.open&1)}get openEnd(){return 0<(this.open&2)}static addTree(M,Z=[],pa=!1){pa=[new N(0,M.length,M,0,!1,pa)];for(let Ja of Z)Ja.to>
M.length&&pa.push(Ja);return pa}static applyChanges(M,Z,pa=128){if(!Z.length)return M;let Ja=[],Sa=1,Za=M.length?M[0]:null;for(let tb=0,Pb=0,Jb=0;;tb++){let ec=tb<Z.length?Z[tb]:null,yc=ec?ec.fromA:1E9;if(yc-Pb>=pa)for(;Za&&Za.from<yc;){let hc=Za;if(Pb>=hc.from||yc<=hc.to||Jb){let Fc=Math.max(hc.from,Pb)-Jb,Ic=Math.min(hc.to,yc)-Jb;hc=Fc>=Ic?null:new N(Fc,Ic,hc.tree,hc.offset+Jb,0<tb,!!ec)}if(hc&&Ja.push(hc),Za.to>yc)break;Za=Sa<M.length?M[Sa++]:null}if(!ec)break;Pb=ec.toA;Jb=ec.toA-ec.toB}return Ja}},
Sb=class{startParse(N,M,Z){return"string"==typeof N&&(N=new lc(N)),Z=Z?Z.length?Z.map(pa=>new Ha(pa.from,pa.to)):[new Ha(0,0)]:[new Ha(0,N.length)],this.createParse(N,M||[],Z)}parse(N,M,Z){for(N=this.startParse(N,M,Z);;)if(M=N.advance())return M}},lc=class{constructor(N){this.string=N}get length(){return this.string.length}chunk(N){return this.string.slice(N)}get lineChunks(){return!1}read(N,M){return this.string.slice(N,M)}},qc=class{constructor(N,M,Z,pa,Ja){this.parser=N;this.parse=M;this.overlay=
Z;this.target=pa;this.from=Ja}},oc=class{constructor(N,M,Z,pa,Ja,Sa,Za){this.parser=N;this.predicate=M;this.mounts=Z;this.index=pa;this.start=Ja;this.target=Sa;this.prev=Za;this.depth=0;this.ranges=[]}},bb=new sa({perNode:!0}),db=class{constructor(N,M,Z,pa,Ja){this.nest=M;this.input=Z;this.fragments=pa;this.ranges=Ja;this.inner=[];this.innerDone=0;this.stoppedAt=this.baseTree=null;this.baseParse=N}advance(){if(this.baseParse){var N=this.baseParse.advance();if(!N)return null;if(this.baseParse=null,
this.baseTree=N,this.startInner(),null!=this.stoppedAt)for(var M of this.inner)M.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length)return N=this.baseTree,null!=this.stoppedAt&&(N=new gb(N.type,N.children,N.positions,N.length,N.propValues.concat([[bb,this.stoppedAt]]))),N;N=this.inner[this.innerDone];if(M=N.parse.advance()){this.innerDone++;let Z=Object.assign(Object.create(null),N.target.props);Z[sa.mounted.id]=new Na(M,N.overlay,N.parser);N.target.props=Z}return null}get parsedPos(){if(this.baseParse)return 0;
let N=this.input.length;for(let M=this.innerDone;M<this.inner.length;M++)this.inner[M].from<N&&(N=Math.min(N,this.inner[M].parse.parsedPos));return N}stopAt(N){if(this.stoppedAt=N,this.baseParse)this.baseParse.stopAt(N);else for(let M=this.innerDone;M<this.inner.length;M++)this.inner[M].parse.stopAt(N)}startInner(){let N=new ya(this.fragments),M=null,Z=null,pa=new Db(new $b(this.baseTree,this.ranges[0].from,0,null),n.IterMode.IncludeAnonymous|n.IterMode.IgnoreMounts);a:for(let Za,tb;;){var Ja=!0;
let Pb;if(null!=this.stoppedAt&&pa.from>=this.stoppedAt)Ja=!1;else if(N.hasNode(pa)){if(M&&(Ja=M.mounts.find(Jb=>Jb.frag.from<=pa.from&&Jb.frag.to>=pa.to&&Jb.mount.overlay)))for(let Jb of Ja.mount.overlay){let ec=Jb.from+Ja.pos,yc=Jb.to+Ja.pos;ec>=pa.from&&yc<=pa.to&&!M.ranges.some(hc=>hc.from<yc&&hc.to>ec)&&M.ranges.push({from:ec,to:yc})}Ja=!1}else if(Z&&(tb=ca(Z.ranges,pa.from,pa.to)))Ja=2!=tb;else if(!pa.type.isAnonymous&&(Za=this.nest(pa,this.input))&&(pa.from<pa.to||!Za.overlay)){pa.tree||ha(pa);
var Sa=N.findMounts(pa.from,Za.parser);if("function"==typeof Za.overlay)M=new oc(Za.parser,Za.overlay,Sa,this.inner.length,pa.from,pa.tree,M);else{let Jb=Da(this.ranges,Za.overlay||(pa.from<pa.to?[new Ha(pa.from,pa.to)]:[]));Jb.length&&T(Jb);!Jb.length&&Za.overlay||this.inner.push(new qc(Za.parser,Jb.length?Za.parser.startParse(this.input,ua(Sa,Jb),Jb):Za.parser.startParse(""),Za.overlay?Za.overlay.map(ec=>new Ha(ec.from-pa.from,ec.to-pa.from)):null,pa.tree,Jb.length?Jb[0].from:pa.from));Za.overlay?
Jb.length&&(Z={ranges:Jb,depth:0,prev:Z}):Ja=!1}}else M&&(Pb=M.predicate(pa))&&(!0===Pb&&(Pb=new Ha(pa.from,pa.to)),Pb.from<Pb.to)&&(Sa=M.ranges.length-1,0<=Sa&&M.ranges[Sa].to==Pb.from?M.ranges[Sa]={from:M.ranges[Sa].from,to:Pb.to}:M.ranges.push(Pb));if(Ja&&pa.firstChild())M&&M.depth++,Z&&Z.depth++;else for(;!pa.nextSibling();){if(!pa.parent())break a;M&&!--M.depth&&(Ja=Da(this.ranges,M.ranges),Ja.length&&(T(Ja),this.inner.splice(M.index,0,new qc(M.parser,M.parser.startParse(this.input,ua(M.mounts,
Ja),Ja),M.ranges.map(Jb=>new Ha(Jb.from-M.start,Jb.to-M.start)),M.target,Ja[0].from))),M=M.prev);Z&&!--Z.depth&&(Z=Z.prev)}}}},oa=class{constructor(N,M){this.offset=M;this.done=!1;this.cursor=N.cursor(n.IterMode.IncludeAnonymous|n.IterMode.IgnoreMounts)}moveTo(N){let {cursor:M}=this,Z=N-this.offset;for(;!this.done&&M.from<Z;)M.to>=N&&M.enter(Z,1,n.IterMode.IgnoreOverlays|n.IterMode.ExcludeBuffers)||M.next(!1)||(this.done=!0)}hasNode(N){if(this.moveTo(N.from),!this.done&&this.cursor.from+this.offset==
N.from&&this.cursor.tree)for(let M=this.cursor.tree;;){if(M==N.tree)return!0;if(M.children.length&&0==M.positions[0]&&M.children[0]instanceof gb)M=M.children[0];else break}return!1}},ya=class{constructor(N){var M;(this.fragments=N,this.curTo=0,this.fragI=0,N.length)?(N=this.curFrag=N[0],this.curTo=null!==(M=N.tree.prop(bb))&&void 0!==M?M:N.to,this.inner=new oa(N.tree,-N.offset)):this.curFrag=this.inner=null}hasNode(N){for(;this.curFrag&&N.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=
N.from&&this.curTo>=N.to&&this.inner.hasNode(N)}nextFrag(){var N;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let M=this.curFrag=this.fragments[this.fragI];this.curTo=null!==(N=M.tree.prop(bb))&&void 0!==N?N:M.to;this.inner=new oa(M.tree,-M.offset)}}findMounts(N,M){var Z;let pa=[];if(this.inner)for(this.inner.cursor.moveTo(N,1),N=this.inner.cursor.node;N;N=N.parent){let Ja=null===(Z=N.tree)||void 0===Z?void 0:Z.prop(sa.mounted);if(Ja&&Ja.parser==M)for(let Sa=
this.fragI;Sa<this.fragments.length;Sa++){let Za=this.fragments[Sa];if(Za.from>=N.to)break;Za.tree==this.curFrag.tree&&pa.push({frag:Za,pos:N.from-Za.offset,mount:Ja})}}return pa}};n.DefaultBufferLength=1024;n.MountedTree=Na;n.NodeProp=sa;n.NodeSet=pb;n.NodeType=kb;n.NodeWeakMap=Xb;n.Parser=Sb;n.Tree=gb;n.TreeBuffer=Lb;n.TreeCursor=Db;n.TreeFragment=sb;n.parseMixed=function(N){return(M,Z,pa,Ja)=>new db(M,N,Z,pa,Ja)}}),Pp=va(n=>{function p(yb,Bb){return yb.length==Bb.length&&yb.every((Db,Cb)=>Db==
Bb[Cb])}function q(yb){let Bb=[[]];for(let Db=0;Db<yb.length;Db++)for(let Cb=0,sb=Bb.length;Cb<sb;Cb++)Bb.push(Bb[Cb].concat(yb[Db]));return Bb.sort((Db,Cb)=>Cb.length-Db.length)}function u(yb,Bb){let Db=Object.create(null);for(let Sb of yb)if(Array.isArray(Sb.tag))for(let lc of Sb.tag)Db[lc.id]=Sb.class;else Db[Sb.tag.id]=Sb.class;let {scope:Cb,all:sb=null}=Bb||{};return{style:Sb=>{let lc=sb;for(let qc of Sb)for(let oc of qc.set)if(Sb=Db[oc.id]){lc=lc?lc+" "+Sb:Sb;break}return lc},scope:Cb}}function w(yb,
Bb){let Db=null;for(let Cb of yb)(yb=Cb.style(Bb))&&(Db=Db?Db+" "+yb:yb);return Db}function y(yb,Bb,Db,Cb=0,sb=yb.length){Bb=new Fa(Cb,Array.isArray(Bb)?Bb:[Bb],Db);Bb.highlightRange(yb.cursor(),Cb,sb,"",Bb.highlighters);Bb.flush(sb)}function B(yb){let Bb=yb.type.prop(ha);for(;Bb&&Bb.context&&!yb.matchContext(Bb.context);)Bb=Bb.next;return Bb||null}Object.defineProperty(n,"__esModule",{value:!0});var z=ak(),E=0,H=class yb{constructor(Bb,Db,Cb,sb){this.name=Bb;this.set=Db;this.base=Cb;this.modified=
sb;this.id=E++}toString(){let {name:Bb}=this;for(let Db of this.modified)Db.name&&(Bb=`${Db.name}(${Bb})`);return Bb}static define(Bb,Db){if(Bb instanceof yb&&(Db=Bb),Db?.base)throw Error("Can not derive from a modified tag");Bb=new yb("string"==typeof Bb?Bb:"?",[],null,[]);if(Bb.set.push(Bb),Db)for(let Cb of Db.set)Bb.set.push(Cb);return Bb}static defineModifier(Bb){let Db=new ca(Bb);return Cb=>-1<Cb.modified.indexOf(Db)?Cb:ca.get(Cb.base||Cb,Cb.modified.concat(Db).sort((sb,Sb)=>sb.id-Sb.id))}},
T=0,ca=class yb{constructor(Bb){this.name=Bb;this.instances=[];this.id=T++}static get(Bb,Db){if(!Db.length)return Bb;var Cb=Db[0].instances.find(lc=>lc.base==Bb&&p(Db,lc.modified));if(Cb)return Cb;Cb=[];let sb=new H(Bb.name,Cb,Bb,Db);for(var Sb of Db)Sb.instances.push(sb);Sb=q(Db);for(let lc of Bb.set)if(!lc.modified.length)for(let qc of Sb)Cb.push(yb.get(lc,qc));return sb}},ha=new z.NodeProp,Da=class{constructor(yb,Bb,Db,Cb){this.tags=yb;this.mode=Bb;this.context=Db;this.next=Cb}get opaque(){return 0==
this.mode}get inherit(){return 1==this.mode}sort(yb){return!yb||yb.depth<this.depth?(this.next=yb,this):(yb.next=this.sort(yb.next),yb)}get depth(){return this.context?this.context.length:0}};Da.empty=new Da([],2,null);var Fa=class{constructor(yb,Bb,Db){this.at=yb;this.highlighters=Bb;this.span=Db;this.class=""}startSpan(yb,Bb){Bb!=this.class&&(this.flush(yb),yb>this.at&&(this.at=yb),this.class=Bb)}flush(yb){yb>this.at&&this.class&&this.span(this.at,yb,this.class)}highlightRange(yb,Bb,Db,Cb,sb){let {type:Sb,
from:lc,to:qc}=yb;if(!(lc>=Db||qc<=Bb)){Sb.isTop&&(sb=this.highlighters.filter(ya=>!ya.scope||ya.scope(Sb)));var oc=Cb,bb=B(yb)||Da.empty,db=w(sb,bb.tags);if(db&&(oc&&(oc+=" "),oc+=db,1==bb.mode&&(Cb+=(Cb?" ":"")+db)),this.startSpan(Math.max(Bb,lc),oc),!bb.opaque){var oa=yb.tree&&yb.tree.prop(z.NodeProp.mounted);if(oa&&oa.overlay){bb=yb.node.enter(oa.overlay[0].from+lc,1);db=this.highlighters.filter(N=>!N.scope||N.scope(oa.tree.type));let ya=yb.firstChild();for(let N=0,M=lc;;N++){let Z=N<oa.overlay.length?
oa.overlay[N]:null,pa=Z?Z.from+lc:qc,Ja=Math.max(Bb,M),Sa=Math.min(Db,pa);if(Ja<Sa&&ya)for(;yb.from<Sa&&(this.highlightRange(yb,Ja,Sa,Cb,sb),this.startSpan(Math.min(Sa,yb.to),oc),!(yb.to>=pa)&&yb.nextSibling()););if(!Z||pa>Db)break;M=Z.to+lc;M>Bb&&(this.highlightRange(bb.cursor(),Math.max(Bb,Z.from+lc),Math.min(Db,M),"",db),this.startSpan(Math.min(Db,M),oc))}ya&&yb.parent()}else if(yb.firstChild()){oa&&(Cb="");do if(!(yb.to<=Bb)){if(yb.from>=Db)break;this.highlightRange(yb,Bb,Db,Cb,sb);this.startSpan(Math.min(Db,
yb.to),oc)}while(yb.nextSibling());yb.parent()}}}}},ua=H.define,Va=ua(),Ha=ua(),sa=ua(Ha),Na=ua(Ha),Qa=ua(),kb=ua(Qa),pb=ua(Qa),ib=ua(),zb=ua(ib),gb=ua(),qb=ua(),Lb=ua(),Xb=ua(Lb),$b=ua();ua={comment:Va,lineComment:ua(Va),blockComment:ua(Va),docComment:ua(Va),name:Ha,variableName:ua(Ha),typeName:sa,tagName:ua(sa),propertyName:Na,attributeName:ua(Na),className:ua(Ha),labelName:ua(Ha),namespace:ua(Ha),macroName:ua(Ha),literal:Qa,string:kb,docString:ua(kb),character:ua(kb),attributeValue:ua(kb),number:pb,
integer:ua(pb),float:ua(pb),bool:ua(Qa),regexp:ua(Qa),escape:ua(Qa),color:ua(Qa),url:ua(Qa),keyword:gb,self:ua(gb),null:ua(gb),atom:ua(gb),unit:ua(gb),modifier:ua(gb),operatorKeyword:ua(gb),controlKeyword:ua(gb),definitionKeyword:ua(gb),moduleKeyword:ua(gb),operator:qb,derefOperator:ua(qb),arithmeticOperator:ua(qb),logicOperator:ua(qb),bitwiseOperator:ua(qb),compareOperator:ua(qb),updateOperator:ua(qb),definitionOperator:ua(qb),typeOperator:ua(qb),controlOperator:ua(qb),punctuation:Lb,separator:ua(Lb),
bracket:Xb,angleBracket:ua(Xb),squareBracket:ua(Xb),paren:ua(Xb),brace:ua(Xb),content:ib,heading:zb,heading1:ua(zb),heading2:ua(zb),heading3:ua(zb),heading4:ua(zb),heading5:ua(zb),heading6:ua(zb),contentSeparator:ua(ib),list:ua(ib),quote:ua(ib),emphasis:ua(ib),strong:ua(ib),link:ua(ib),monospace:ua(ib),strikethrough:ua(ib),inserted:ua(),deleted:ua(),changed:ua(),invalid:ua(),meta:$b,documentMeta:ua($b),annotation:ua($b),processingInstruction:ua($b),definition:H.defineModifier("definition"),constant:H.defineModifier("constant"),
function:H.defineModifier("function"),standard:H.defineModifier("standard"),local:H.defineModifier("local"),special:H.defineModifier("special")};for(var pc in ua)Va=ua[pc],Va instanceof H&&(Va.name=pc);pc=u([{tag:ua.link,class:"tok-link"},{tag:ua.heading,class:"tok-heading"},{tag:ua.emphasis,class:"tok-emphasis"},{tag:ua.strong,class:"tok-strong"},{tag:ua.keyword,class:"tok-keyword"},{tag:ua.atom,class:"tok-atom"},{tag:ua.bool,class:"tok-bool"},{tag:ua.url,class:"tok-url"},{tag:ua.labelName,class:"tok-labelName"},
{tag:ua.inserted,class:"tok-inserted"},{tag:ua.deleted,class:"tok-deleted"},{tag:ua.literal,class:"tok-literal"},{tag:ua.string,class:"tok-string"},{tag:ua.number,class:"tok-number"},{tag:[ua.regexp,ua.escape,ua.special(ua.string)],class:"tok-string2"},{tag:ua.variableName,class:"tok-variableName"},{tag:ua.local(ua.variableName),class:"tok-variableName tok-local"},{tag:ua.definition(ua.variableName),class:"tok-variableName tok-definition"},{tag:ua.special(ua.variableName),class:"tok-variableName2"},
{tag:ua.definition(ua.propertyName),class:"tok-propertyName tok-definition"},{tag:ua.typeName,class:"tok-typeName"},{tag:ua.namespace,class:"tok-namespace"},{tag:ua.className,class:"tok-className"},{tag:ua.macroName,class:"tok-macroName"},{tag:ua.propertyName,class:"tok-propertyName"},{tag:ua.operator,class:"tok-operator"},{tag:ua.comment,class:"tok-comment"},{tag:ua.meta,class:"tok-meta"},{tag:ua.invalid,class:"tok-invalid"},{tag:ua.punctuation,class:"tok-punctuation"}]);n.Tag=H;n.classHighlighter=
pc;n.getStyleTags=B;n.highlightCode=function(yb,Bb,Db,Cb,sb,Sb=0,lc=yb.length){function qc(bb,db){if(!(bb<=oc)){for(let oa=yb.slice(oc,bb),ya=0;;){let N=oa.indexOf("\n",ya),M=0>N?oa.length:N;if(M>ya&&Cb(oa.slice(ya,M),db),0>N)break;sb();ya=N+1}oc=bb}}let oc=Sb;y(Bb,Db,(bb,db,oa)=>{qc(bb,"");qc(db,oa)},Sb,lc);qc(lc,"")};n.highlightTree=y;n.styleTags=function(yb){let Bb=Object.create(null);for(let Sb in yb){let lc=yb[Sb];Array.isArray(lc)||(lc=[lc]);for(let qc of Sb.split(" "))if(qc){var Db=[];let oc=
2;var Cb=qc;for(var sb=0;;){if("..."==Cb&&0<sb&&sb+3==qc.length){oc=1;break}Cb=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(Cb);if(!Cb)throw new RangeError("Invalid path: "+qc);if(Db.push("*"==Cb[0]?"":'"'==Cb[0][0]?JSON.parse(Cb[0]):Cb[0]),sb+=Cb[0].length,sb==qc.length)break;Cb=qc[sb++];if(sb==qc.length&&"!"==Cb){oc=0;break}if("/"!=Cb)throw new RangeError("Invalid path: "+qc);Cb=qc.slice(sb)}Cb=Db.length-1;sb=Db[Cb];if(!sb)throw new RangeError("Invalid path: "+qc);Db=new Da(lc,oc,0<Cb?Db.slice(0,Cb):null);
Bb[sb]=Db.sort(Bb[sb])}}return ha.add(Bb)};n.tagHighlighter=u;n.tags=ua}),bk=va(n=>{function p(L){return N.Facet.define({combine:L?O=>O.concat(L):void 0})}function q(L,O,ia){var ma=L.facet(Dc);L=u(L).topNode;if(!ma||ma.allowsNesting)for(ma=L;ma;ma=ma.enter(O,ia,ya.IterMode.ExcludeBuffers))ma.type.isTop&&(L=ma);return L}function u(L){return(L=L.field(tb.state,!1))?L.tree:ya.Tree.empty}function w(L,O,ia=50){var ma;L=null===(ma=L.field(tb.state,!1))||void 0===ma?void 0:ma.context;if(!L)return null;ma=
L.viewport;L.updateViewport({from:0,to:O});O=L.isDone(O)||L.work(ia,O)?L.tree:null;return L.updateViewport(ma),O}function y(L,O,ia){return ya.TreeFragment.applyChanges(L,[{fromA:O,toA:ia,fromB:O,toB:ia}])}function B(L){let O=L.facet(zc);return 9==O.charCodeAt(0)?L.tabSize*O.length:O.length}function z(L,O){let ia="";var ma=L.tabSize;L=L.facet(zc)[0];if("\t"==L){for(;O>=ma;)ia+="\t",O-=ma;L=" "}for(ma=0;ma<O;ma++)ia+=L;return ia}function E(L,O){L instanceof N.EditorState&&(L=new da(L));for(var ia of L.state.facet(wc)){var ma=
ia(L,O);if(void 0!==ma)return ma}ma=u(L.state);if(ma.length>=O){ia=ma.resolveStack(O);var Ia=ma.resolveInner(O,-1).resolve(O,0).enterUnfinishedNodesBefore(O);if(Ia!=ia.node){for(ma=[];Ia&&(Ia.from!=ia.node.from||Ia.type!=ia.node.type);Ia=Ia.parent)ma.push(Ia);for(Ia=ma.length-1;0<=Ia;Ia--)ia={node:ma[Ia],next:ia}}O=H(ia,L,O)}else O=null;return O}function H(L,O,ia){for(;L;L=L.next){let ma=T(L.node);if(ma)return ma(Ea.create(O,ia,L))}return 0}function T(L){var O=L.type.prop(Ca);if(O)return O;O=L.firstChild;
let ia;if(O&&(ia=O.type.prop(ya.NodeProp.closedBy))){let ma=L.lastChild,Ia=ma&&-1<ia.indexOf(ma.name);return cb=>Da(cb,!0,1,void 0,!Ia||cb.pos==cb.options.simulateBreak&&cb.options.simulateDoubleBreak?void 0:ma.from)}return null==L.parent?ca:null}function ca(){return 0}function ha(L){var O=L.node;let ia=O.childAfter(O.from),ma=O.lastChild;if(!ia)return null;var Ia=L.options.simulateBreak;L=L.state.doc.lineAt(ia.from);Ia=null==Ia||Ia<=L.from?L.to:Math.min(L.to,Ia);for(var cb=ia.to;;){cb=O.childAfter(cb);
if(!cb||cb==ma)return null;if(!cb.type.isSkipped){if(cb.from>=Ia)return null;O=/^ */.exec(L.text.slice(ia.to-L.from))[0].length;return{from:ia.from,to:ia.to+O}}cb=cb.to}}function Da(L,O,ia,ma,Ia){let cb=L.textAfter,jb=cb.match(/^\s*/)[0].length;ma=ma&&cb.slice(jb,jb+ma.length)==ma||Ia==L.pos+jb;return(O=O?ha(L):null)?ma?L.column(O.from):L.column(O.to):L.baseIndent+(ma?0:L.unit*ia)}function Fa(L,O,ia){for(var ma of L.facet(Ta)){var Ia=ma(L,O,ia);if(Ia)return Ia}Ia=u(L);if(Ia.length<ia)L=null;else{var cb=
Ia.resolveStack(ia,1);for(ma=null;cb;cb=cb.next){var jb=cb.node;if(jb.to<=ia||jb.from>ia)continue;if(ma&&jb.from<O)break;let vc=jb.type.prop(mb);var Eb;(Eb=vc)&&!(Eb=jb.to<Ia.length-50||Ia.length==L.doc.length)&&(Eb=jb.lastChild,Eb=!(Eb&&Eb.to==jb.to&&Eb.type.isError));Eb&&(jb=vc(jb,L))&&jb.from<=ia&&jb.from>=O&&jb.to>ia&&(ma=jb)}L=ma}return L}function ua(L,O){let ia=O.mapPos(L.from,1);L=O.mapPos(L.to,-1);return ia>=L?void 0:{from:ia,to:L}}function Va(L){let O=[];for(let {head:ia}of L.state.selection.ranges)O.some(ma=>
ma.from<=ia&&ma.to>=ia)||O.push(L.lineBlockAt(ia));return O}function Ha(L,O,ia){var ma;let Ia=null;return null===(ma=L.field(ic,!1))||void 0===ma||ma.between(O,ia,(cb,jb)=>{(!Ia||Ia.from>cb)&&(Ia={from:cb,to:jb})}),Ia}function sa(L,O,ia){let ma=!1;return L.between(O,O,(Ia,cb)=>{Ia==O&&cb==ia&&(ma=!0)}),ma}function Na(L,O){return L.field(ic,!1)?O:O.concat(N.StateEffect.appendConfig.of(kb()))}function Qa(L,O,ia=!0){let ma=L.state.doc.lineAt(O.from).number;O=L.state.doc.lineAt(O.to).number;return M.EditorView.announce.of(`${L.state.phrase(ia?
"Folded lines":"Unfolded lines")} ${ma} ${L.state.phrase("to")} ${O}.`)}function kb(L){let O=[ic,J];return L&&O.push(wd.of(L)),O}function pb(L,O){let {state:ia}=L,ma=ia.facet(wd),Ia=cb=>{var jb=L.lineBlockAt(L.posAtDOM(cb.target));(jb=Ha(L.state,jb.from,jb.to))&&L.dispatch({effects:Hb.of(jb)});cb.preventDefault()};if(ma.placeholderDOM)return ma.placeholderDOM(L,Ia,O);O=document.createElement("span");return O.textContent=ma.placeholderText,O.setAttribute("aria-label",ia.phrase("folded code")),O.title=
ia.phrase("unfold"),O.className="cm-foldPlaceholder",O.onclick=Ia,O}function ib(L){let O=L.facet(ea);return O.length?O:L.facet(qa)}function zb(L){let O=[],ia=L.matched?Ib:uc;return O.push(ia.range(L.start.from,L.start.to)),L.end&&O.push(ia.range(L.end.from,L.end.to)),O}function gb(L,O,ia){let ma=L.prop(0>O?ya.NodeProp.openedBy:ya.NodeProp.closedBy);return ma?ma:1==L.name.length&&(L=ia.indexOf(L.name),-1<L&&L%2==(0>O?1:0))?[ia[L+O]]:null}function qb(L){let O=L.type.prop(R);return O?O(L.node):L}function Lb(L,
O,ia,ma={}){var Ia=ma.maxScanDistance||1E4;ma=ma.brackets||"()[]{}";var cb=u(L),jb=cb.resolveInner(O,ia);for(var Eb=jb;Eb;Eb=Eb.parent){var vc=gb(Eb.type,ia,ma);if(vc&&Eb.from<Eb.to){var $a=qb(Eb);if($a&&(0<ia?O>=$a.from&&O<$a.to:O>$a.from&&O<=$a.to)){a:{O=ia;ia=Eb;L=$a;Ia=vc;cb=ma;ma={from:L.from,to:L.to};vc=0;if((L=ia.parent?.cursor())&&(0>O?L.childBefore(ia.from):L.childAfter(ia.to))){do if(0>O?L.to<=ia.from:L.from>=ia.to)if(0==vc&&-1<Ia.indexOf(L.type.name)&&L.from<L.to){O=qb(L);ma={start:ma,
end:O?{from:O.from,to:O.to}:void 0,matched:!0};break a}else if(gb(L.type,O,cb))vc++;else if(gb(L.type,-O,cb)){if(0==vc){O=qb(L);ma={start:ma,end:O&&O.from<O.to?{from:O.from,to:O.to}:void 0,matched:!1};break a}vc--}while(0>O?L.prevSibling():L.nextSibling())}ma={start:ma,matched:!1}}return ma}}}a:if(vc=jb.type,$a=0>ia?L.sliceDoc(O-1,O):L.sliceDoc(O,O+1),Eb=ma.indexOf($a),0>Eb||0==Eb%2!=0<ia)ma=null;else{$a={from:0>ia?O-1:O,to:0<ia?O+1:O};L=L.doc.iterRange(O,0<ia?L.doc.length:0);jb=0;for(let xd=0;!L.next().done&&
xd<=Ia;){let Pd=L.value;0>ia&&(xd+=Pd.length);let qe=O+xd*ia;for(let Ud=0<ia?0:Pd.length-1,Hf=0<ia?Pd.length:-1;Ud!=Hf;Ud+=ia){let rd=ma.indexOf(Pd[Ud]);if(!(0>rd||cb.resolveInner(qe+Ud,1).type!=vc))if(0==rd%2==0<ia)jb++;else{if(1==jb){ma={start:$a,end:{from:qe+Ud,to:qe+Ud+1},matched:rd>>1==Eb>>1};break a}jb--}}0<ia&&(xd+=Pd.length)}ma=L.done?{start:$a,matched:!1}:null}return ma}function Xb(L,O,ia,ma=0,Ia=0){for(null==O&&(O=L.search(/[^\s\u00a0]/),-1==O&&(O=L.length));ma<O;ma++)9==L.charCodeAt(ma)?
Ia+=ia-Ia%ia:Ia++;return Ia}function $b(L){return{name:L.name||"",token:L.token,blankLine:L.blankLine||(()=>{}),startState:L.startState||(()=>!0),copyState:L.copyState||pc,indent:L.indent||(()=>null),languageData:L.languageData||{},tokenTable:L.tokenTable||eb,mergeTokens:!1!==L.mergeTokens}}function pc(L){if("object"!=typeof L)return L;let O={};for(let ia in L){let ma=L[ia];O[ia]=ma instanceof Array?ma.slice():ma}return O}function yb(L,O,ia,ma,Ia){var cb=ia>=ma&&ia+O.length<=Ia&&O.prop(L.stateAfter);
if(cb)return{state:L.streamParser.copyState(cb),pos:ia+O.length};for(cb=O.children.length-1;0<=cb;cb--){var jb=O.children[cb];let Eb=ia+O.positions[cb];if(jb=jb instanceof ya.Tree&&Eb<Ia&&yb(L,jb,Eb,ma,Ia))return jb}return null}function Bb(L,O,ia,ma,Ia){if(Ia&&0>=ia&&ma>=O.length)return O;!Ia&&0==ia&&O.type==L.topNode&&(Ia=!0);for(let cb=O.children.length-1;0<=cb;cb--){let jb=O.positions[cb],Eb=O.children[cb];if(jb<ma&&Eb instanceof ya.Tree){if(!(L=Bb(L,Eb,ia-jb,ma-jb,Ia)))break;return Ia?new ya.Tree(O.type,
O.children.slice(0,cb).concat(L),O.positions.slice(0,cb+1),jb+L.length):L}}return null}function Db(L,O,ia,ma,Ia){for(let cb of O){O=cb.to-(cb.openEnd?25:0);O=cb.from+(cb.openStart?25:0)<=ia&&O>ia&&yb(L,cb.tree,0-cb.offset,ia,O);let jb;if(O&&O.pos<=ma&&(jb=Bb(L,cb.tree,ia+cb.offset,O.pos+cb.offset,!1)))return{state:O.state,tree:jb}}return{state:L.streamParser.startState(Ia?B(Ia):4),tree:ya.Tree.empty}}function Cb(L,O,ia){O.start=O.pos;for(let ma=0;10>ma;ma++){let Ia=L(O,ia);if(O.pos>O.start)return Ia}throw Error("Stream parser failed to advance stream.");
}function sb(L,O){-1<Nb.indexOf(L)||(Nb.push(L),console.warn(O))}function Sb(L,O){var ia=[];for(var ma of O.split(" ")){let Ia=[];for(let cb of ma.split(".")){let jb=L[cb]||Z.tags[cb];jb?"function"==typeof jb?Ia.length?Ia=Ia.map(jb):sb(cb,`Modifier ${cb} used at start of tag`):Ia.length?sb(cb,`Tag ${cb} used as modifier`):Ia=Array.isArray(jb)?jb:[jb]:sb(cb,`Unknown highlighting tag ${cb}`)}for(let cb of Ia)ia.push(cb)}if(!ia.length)return 0;L=O.replace(/ /g,"_");O=L+" "+ia.map(Ia=>Ia.id);if(ma=sc[O])return ma.id;
ia=sc[O]=ya.NodeType.define({id:Ya.length,name:L,props:[Z.styleTags({[L]:ia})]});return Ya.push(ia),ia.id}function lc(L,O){let ia=ya.NodeType.define({id:Ya.length,name:"Document",props:[Sa.add(()=>L),Ca.add(()=>ma=>O.getIndent(ma))],top:!0});return Ya.push(ia),ia}function qc(L){return 4096>=L.length&&/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/.test(L)}function oc(L){for(L=L.iter();!L.next().done;)if(qc(L.value))return!0;return!1}function bb(L){let O=!1;return L.iterChanges((ia,ma,Ia,
cb,jb)=>{!O&&oc(jb)&&(O=!0)}),O}function db(L,O,ia){let ma=new N.RangeSetBuilder,Ia=L.visibleRanges;ia||(Ia=oa(Ia,L.state.doc));for(let {from:cb,to:jb}of Ia)O.iterate({enter:Eb=>{let vc=Eb.type.prop(ya.NodeProp.isolate);vc&&ma.add(Eb.from,Eb.to,ze[vc])},from:cb,to:jb});return ma.finish()}function oa(L,O){O=O.iter();let ia=0,ma=[],Ia=null;for(let {from:cb,to:jb}of L)if(!(Ia&&Ia.to>cb&&(cb=Ia.to,cb>=jb)))for(ia+O.value.length<cb&&(O.next(cb-(ia+O.value.length)),ia=cb);;){L=ia;let Eb=ia+O.value.length;
if(!O.lineBreak&&qc(O.value)&&(Ia&&Ia.to>L-10?Ia.to=Math.min(jb,Eb):ma.push(Ia={from:L,to:Math.min(jb,Eb)})),Eb>=jb)break;ia=Eb;O.next()}return ma}var ya=ak(),N=hg(),M=Gg(),Z=Pp(),pa=am(),Ja,Sa=new ya.NodeProp,Za=new ya.NodeProp,tb=class{constructor(L,O,ia=[],ma=""){this.data=L;this.name=ma;N.EditorState.prototype.hasOwnProperty("tree")||Object.defineProperty(N.EditorState.prototype,"tree",{get(){return u(this)}});this.parser=O;this.extension=[Dc.of(this),N.EditorState.languageData.of((Ia,cb,jb)=>
{let Eb=q(Ia,cb,jb);var vc=Eb.type.prop(Sa);if(!vc)return[];vc=Ia.facet(vc);let $a=Eb.type.prop(Za);if($a){cb=Eb.resolve(cb-Eb.from,jb);for(let xd of $a)if(xd.test(cb,Ia))return Ia=Ia.facet(xd.facet),"replace"==xd.type?Ia:Ia.concat(vc)}return vc})].concat(ia)}isActiveAt(L,O,ia=-1){return q(L,O,ia).type.prop(Sa)==this.data}findRegions(L){let O=L.facet(Dc);if(O?.data==this.data)return[{from:0,to:L.doc.length}];if(!O||!O.allowsNesting)return[];let ia=[],ma=(Ia,cb)=>{if(Ia.prop(Sa)==this.data)ia.push({from:cb,
to:cb+Ia.length});else{var jb=Ia.prop(ya.NodeProp.mounted);if(jb){if(jb.tree.prop(Sa)==this.data){if(jb.overlay)for(var Eb of jb.overlay)ia.push({from:Eb.from+cb,to:Eb.to+cb});else ia.push({from:cb,to:cb+Ia.length});return}if(jb.overlay&&(Eb=ia.length,ma(jb.tree,jb.overlay[0].from+cb),ia.length>Eb))return}for(jb=0;jb<Ia.children.length;jb++)Eb=Ia.children[jb],Eb instanceof ya.Tree&&ma(Eb,Ia.positions[jb]+cb)}};return ma(u(L),0),ia}get allowsNesting(){return!0}};tb.setState=N.StateEffect.define();
var Pb=class L extends tb{constructor(O,ia,ma){super(O,ia,[],ma);this.parser=ia}static define(O){let ia=p(O.languageData);return new L(ia,O.parser.configure({props:[Sa.add(ma=>ma.isTop?ia:void 0)]}),O.name)}configure(O,ia){return new L(this.data,this.parser.configure(O),ia||this.name)}get allowsNesting(){return this.parser.hasWrappers()}},Jb=class{constructor(L){this.doc=L;this.cursorPos=0;this.string="";this.cursor=L.iter()}get length(){return this.doc.length}syncTo(L){return this.string=this.cursor.next(L-
this.cursorPos).value,this.cursorPos=L+this.string.length,this.cursorPos-this.string.length}chunk(L){return this.syncTo(L),this.string}get lineChunks(){return!0}read(L,O){let ia=this.cursorPos-this.string.length;return L<ia||O>=this.cursorPos?this.doc.sliceString(L,O):this.string.slice(L-ia,O-ia)}},ec=null,yc=class L{constructor(O,ia,ma=[],Ia,cb,jb,Eb,vc){this.parser=O;this.state=ia;this.fragments=ma;this.tree=Ia;this.treeLen=cb;this.viewport=jb;this.skipped=Eb;this.scheduleOn=vc;this.parse=null;
this.tempSkipped=[]}static create(O,ia,ma){return new L(O,ia,[],ya.Tree.empty,0,ma,[],null)}startParse(){return this.parser.startParse(new Jb(this.state.doc),this.fragments)}work(O,ia){return null!=ia&&ia>=this.state.doc.length&&(ia=void 0),this.tree!=ya.Tree.empty&&this.isDone(ia??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var ma;if("number"==typeof O){let Ia=Date.now()+O;O=()=>Date.now()>Ia}this.parse||(this.parse=this.startParse());for(null!=ia&&(null==this.parse.stoppedAt||
this.parse.stoppedAt>ia)&&ia<this.state.doc.length&&this.parse.stopAt(ia);;){let Ia=this.parse.advance();if(Ia)if(this.fragments=this.withoutTempSkipped(ya.TreeFragment.addTree(Ia,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(ma=this.parse.stoppedAt)&&void 0!==ma?ma:this.state.doc.length,this.tree=Ia,this.parse=null,this.treeLen<(ia??this.state.doc.length))this.parse=this.startParse();else return!0;if(O())return!1}})}takeTree(){let O,ia;this.parse&&(O=this.parse.parsedPos)>=this.treeLen&&
((null==this.parse.stoppedAt||this.parse.stoppedAt>O)&&this.parse.stopAt(O),this.withContext(()=>{for(;!(ia=this.parse.advance()););}),this.treeLen=O,this.tree=ia,this.fragments=this.withoutTempSkipped(ya.TreeFragment.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(O){let ia=ec;ec=this;try{return O()}finally{ec=ia}}withoutTempSkipped(O){for(let ia;ia=this.tempSkipped.pop();)O=y(O,ia.from,ia.to);return O}changes(O,ia){let {fragments:ma,tree:Ia,treeLen:cb,viewport:jb,skipped:Eb}=
this;if(this.takeTree(),!O.empty){let vc=[];if(O.iterChangedRanges(($a,xd,Pd,qe)=>vc.push({fromA:$a,toA:xd,fromB:Pd,toB:qe})),ma=ya.TreeFragment.applyChanges(ma,vc),Ia=ya.Tree.empty,cb=0,jb={from:O.mapPos(jb.from,-1),to:O.mapPos(jb.to,1)},this.skipped.length){Eb=[];for(let $a of this.skipped){let xd=O.mapPos($a.from,1),Pd=O.mapPos($a.to,-1);xd<Pd&&Eb.push({from:xd,to:Pd})}}}return new L(this.parser,ia,ma,Ia,cb,jb,Eb,this.scheduleOn)}updateViewport(O){if(this.viewport.from==O.from&&this.viewport.to==
O.to)return!1;this.viewport=O;let ia=this.skipped.length;for(let ma=0;ma<this.skipped.length;ma++){let {from:Ia,to:cb}=this.skipped[ma];Ia<O.to&&cb>O.from&&(this.fragments=y(this.fragments,Ia,cb),this.skipped.splice(ma--,1))}return this.skipped.length>=ia?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(O,ia){this.skipped.push({from:O,to:ia})}static getSkippingParser(O){return new class extends ya.Parser{createParse(ia,ma,Ia){let cb=Ia[0].from,jb=Ia[Ia.length-
1].to;return{parsedPos:cb,advance(){let Eb=ec;if(Eb){for(let vc of Ia)Eb.tempSkipped.push(vc);O&&(Eb.scheduleOn=Eb.scheduleOn?Promise.all([Eb.scheduleOn,O]):O)}return this.parsedPos=jb,new ya.Tree(ya.NodeType.none,[],[],jb-cb)},stoppedAt:null,stopAt(){}}}}}isDone(O){O=Math.min(O,this.state.doc.length);let ia=this.fragments;return this.treeLen>=O&&ia.length&&0==ia[0].from&&ia[0].to>=O}static get(){return ec}},hc=class L{constructor(O){this.context=O;this.tree=O.tree}apply(O){if(!O.docChanged&&this.tree==
this.context.tree)return this;let ia=this.context.changes(O.changes,O.state);O=this.context.treeLen==O.startState.doc.length?void 0:Math.max(O.changes.mapPos(this.context.treeLen),ia.viewport.to);return ia.work(20,O)||ia.takeTree(),new L(ia)}static init(O){let ia=Math.min(3E3,O.doc.length);O=yc.create(O.facet(Dc).parser,O,{from:0,to:ia});return O.work(20,ia)||O.takeTree(),new L(O)}};tb.state=N.StateField.define({create:hc.init,update(L,O){for(let ia of O.effects)if(ia.is(tb.setState))return ia.value;
return O.startState.facet(Dc)!=O.state.facet(Dc)?hc.init(O.state):L.apply(O)}});var Fc=L=>{let O=setTimeout(()=>L(),500);return()=>clearTimeout(O)};"u">typeof requestIdleCallback&&(Fc=L=>{let O=-1,ia=setTimeout(()=>{O=requestIdleCallback(L,{timeout:400})},100);return()=>0>O?clearTimeout(ia):cancelIdleCallback(O)});var Ic="u">typeof navigator&&null!==(Ja=navigator.scheduling)&&void 0!==Ja&&Ja.isInputPending?()=>navigator.scheduling.isInputPending():null,Nc=M.ViewPlugin.fromClass(class{constructor(L){this.view=
L;this.working=null;this.workScheduled=0;this.chunkBudget=this.chunkEnd=-1;this.work=this.work.bind(this);this.scheduleWork()}update(L){let O=this.view.state.field(tb.state).context;(O.updateViewport(L.view.viewport)||this.view.viewport.to>O.treeLen)&&this.scheduleWork();(L.docChanged||L.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork());this.checkAsyncSchedule(O)}scheduleWork(){if(!this.working){var {state:L}=this.view,O=L.field(tb.state);O.tree==O.context.tree&&O.context.isDone(L.doc.length)||
(this.working=Fc(this.work))}}work(L){this.working=null;let O=Date.now();if(!(this.chunkEnd<O&&(0>this.chunkEnd||this.view.hasFocus)&&(this.chunkEnd=O+3E4,this.chunkBudget=3E3),0>=this.chunkBudget)){var {state:ia,viewport:{to:ma}}=this.view,Ia=ia.field(tb.state);if(Ia.tree!=Ia.context.tree||!Ia.context.isDone(ma+1E5)){var cb=Date.now()+Math.min(this.chunkBudget,100,L&&!Ic?Math.max(25,L.timeRemaining()-5):1E9);L=Ia.context.treeLen<ma&&ia.doc.length>ma+1E3;var jb=Ia.context.work(()=>Ic&&Ic()||Date.now()>
cb,ma+(L?0:1E5));this.chunkBudget-=Date.now()-O;(jb||0>=this.chunkBudget)&&(Ia.context.takeTree(),this.view.dispatch({effects:tb.setState.of(new hc(Ia.context))}));0<this.chunkBudget&&(!jb||L)&&this.scheduleWork();this.checkAsyncSchedule(Ia.context)}}}checkAsyncSchedule(L){L.scheduleOn&&(this.workScheduled++,L.scheduleOn.then(()=>this.scheduleWork()).catch(O=>M.logException(this.view.state,O)).then(()=>this.workScheduled--),L.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||
0<this.workScheduled)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Dc=N.Facet.define({combine(L){return L.length?L[0]:null},enables:L=>[tb.state,Nc,M.EditorView.contentAttributes.compute([L],O=>(O=O.facet(L))&&O.name?{"data-language":O.name}:{})]}),cd=class{constructor(L,O=[]){this.language=L;this.support=O;this.extension=[L,O]}},jd=class L{constructor(O,ia,ma,Ia,cb,jb){this.name=O;this.alias=ia;this.extensions=ma;this.filename=Ia;this.loadFunc=cb;this.support=jb;this.loading=null}load(){return this.loading||
(this.loading=this.loadFunc().then(O=>this.support=O,O=>{throw this.loading=null,O;}))}static of(O){let {load:ia,support:ma}=O;if(!ia){if(!ma)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");ia=()=>Promise.resolve(ma)}return new L(O.name,(O.alias||[]).concat(O.name).map(Ia=>Ia.toLowerCase()),O.extensions||[],O.filename,ia,ma)}static matchFilename(O,ia){for(let ma of O)if(ma.filename&&ma.filename.test(ia))return ma;if(ia=/\.([^.]+)$/.exec(ia))for(let ma of O)if(-1<
ma.extensions.indexOf(ia[1]))return ma;return null}static matchLanguageName(O,ia,ma=!0){ia=ia.toLowerCase();for(let Ia of O)if(Ia.alias.some(cb=>cb==ia))return Ia;if(ma)for(let Ia of O)for(let cb of Ia.alias)if(O=ia.indexOf(cb),-1<O&&(2<cb.length||!/\w/.test(ia[O-1])&&!/\w/.test(ia[O+cb.length])))return Ia;return null}},wc=N.Facet.define(),zc=N.Facet.define({combine:L=>{if(!L.length)return"  ";let O=L[0];if(!O||/\S/.test(O)||Array.from(O).some(ia=>ia!=O[0]))throw Error("Invalid indent unit: "+JSON.stringify(L[0]));
return O}}),da=class{constructor(L,O={}){this.state=L;this.options=O;this.unit=B(L)}lineAt(L,O=1){let ia=this.state.doc.lineAt(L),{simulateBreak:ma,simulateDoubleBreak:Ia}=this.options;return null!=ma&&ma>=ia.from&&ma<=ia.to?Ia&&ma==L?{text:"",from:L}:(0>O?ma<L:ma<=L)?{text:ia.text.slice(ma-ia.from),from:ma}:{text:ia.text.slice(0,ma-ia.from),from:ia.from}:ia}textAfterPos(L,O=1){if(this.options.simulateDoubleBreak&&L==this.options.simulateBreak)return"";let {text:ia,from:ma}=this.lineAt(L,O);return ia.slice(L-
ma,Math.min(ia.length,L+100-ma))}column(L,O=1){let {text:ia,from:ma}=this.lineAt(L,O);L=this.countColumn(ia,L-ma);O=this.options.overrideIndentation?this.options.overrideIndentation(ma):-1;return-1<O&&(L+=O-this.countColumn(ia,ia.search(/\S|$/))),L}countColumn(L,O=L.length){return N.countColumn(L,this.state.tabSize,O)}lineIndent(L,O=1){let {text:ia,from:ma}=this.lineAt(L,O);if(L=this.options.overrideIndentation)if(L=L(ma),-1<L)return L;return this.countColumn(ia,ia.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||
null}},Ca=new ya.NodeProp,Ea=class L extends da{constructor(O,ia,ma){super(O.state,O.options);this.base=O;this.pos=ia;this.context=ma}get node(){return this.context.node}static create(O,ia,ma){return new L(O,ia,ma)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(O){let ia=this.state.doc.lineAt(O.from);for(;;){let Ia=O.resolve(ia.from);for(;Ia.parent&&Ia.parent.from==Ia.from;)Ia=Ia.parent;var ma;a:{for(ma=O;ma;ma=ma.parent)if(Ia==
ma){ma=!0;break a}ma=!1}if(ma)break;ia=this.state.doc.lineAt(Ia.from)}return this.lineIndent(ia.from)}continue(){return H(this.context.next,this.base,this.pos)}},Ta=N.Facet.define(),mb=new ya.NodeProp,Fb=N.StateEffect.define({map:ua}),Hb=N.StateEffect.define({map:ua}),ic=N.StateField.define({create(){return M.Decoration.none},update(L,O){L=L.map(O.changes);for(let ma of O.effects)if(ma.is(Fb)&&!sa(L,ma.value.from,ma.value.to)){var {preparePlaceholder:ia}=O.state.facet(wd);ia=ia?M.Decoration.replace({widget:new nd(ia(O.state,
ma.value))}):Yc;L=L.update({add:[ia.range(ma.value.from,ma.value.to)]})}else ma.is(Hb)&&(L=L.update({filter:(Ia,cb)=>ma.value.from!=Ia||ma.value.to!=cb,filterFrom:ma.value.from,filterTo:ma.value.to}));if(O.selection){let ma=!1,{head:Ia}=O.selection.main;L.between(Ia,Ia,(cb,jb)=>{cb<Ia&&jb>Ia&&(ma=!0)});ma&&(L=L.update({filterFrom:Ia,filterTo:Ia,filter:(cb,jb)=>jb<=Ia||cb>=Ia}))}return L},provide:L=>M.EditorView.decorations.from(L),toJSON(L,O){let ia=[];return L.between(0,O.doc.length,(ma,Ia)=>{ia.push(ma,
Ia)}),ia},fromJSON(L){if(!Array.isArray(L)||L.length%2)throw new RangeError("Invalid JSON for fold state");let O=[];for(let ia=0;ia<L.length;){let ma=L[ia++],Ia=L[ia++];if("number"!=typeof ma||"number"!=typeof Ia)throw new RangeError("Invalid JSON for fold state");O.push(Yc.range(ma,Ia))}return M.Decoration.set(O,!0)}}),Jc=L=>{for(let O of Va(L)){let ia=Fa(L.state,O.from,O.to);if(ia)return L.dispatch({effects:Na(L.state,[Fb.of(ia),Qa(L,ia)])}),!0}return!1},$c=L=>{if(!L.state.field(ic,!1))return!1;
let O=[];for(let ia of Va(L)){let ma=Ha(L.state,ia.from,ia.to);ma&&O.push(Hb.of(ma),Qa(L,ma,!1))}return O.length&&L.dispatch({effects:O}),0<O.length},Cc=L=>{let {state:O}=L,ia=[];for(var ma=0;ma<O.doc.length;){ma=L.lineBlockAt(ma);let Ia=Fa(O,ma.from,ma.to);Ia&&ia.push(Fb.of(Ia));ma=(Ia?L.lineBlockAt(Ia.to):ma).to+1}return ia.length&&L.dispatch({effects:Na(L.state,ia)}),!!ia.length},Tc=L=>{let O=L.state.field(ic,!1);if(!O||!O.size)return!1;let ia=[];return O.between(0,L.state.doc.length,(ma,Ia)=>
{ia.push(Hb.of({from:ma,to:Ia}))}),L.dispatch({effects:ia}),!0},Vc=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Jc},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:$c},{key:"Ctrl-Alt-[",run:Cc},{key:"Ctrl-Alt-]",run:Tc}],qd={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},wd=N.Facet.define({combine(L){return N.combineConfig(L,qd)}}),Yc=M.Decoration.replace({widget:new class extends M.WidgetType{toDOM(L){return pb(L,null)}}}),nd=class extends M.WidgetType{constructor(L){super();this.value=
L}eq(L){return this.value==L.value}toDOM(L){return pb(L,this.value)}},V={openText:"\u2304",closedText:"\u203a",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1},A=class extends M.GutterMarker{constructor(L,O){super();this.config=L;this.open=O}eq(L){return this.config==L.config&&this.open==L.open}toDOM(L){if(this.config.markerDOM)return this.config.markerDOM(this.open);let O=document.createElement("span");return O.textContent=this.open?this.config.openText:this.config.closedText,O.title=L.state.phrase(this.open?
"Fold line":"Unfold line"),O}},J=M.EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}}),W=class L{constructor(O,ia){function ma(Eb){let vc=pa.StyleModule.newName();return(Ia||=Object.create(null))["."+vc]=Eb,vc}this.specs=O;let Ia,cb="string"==typeof ia.all?ia.all:ia.all?ma(ia.all):void 0,jb=ia.scope;this.scope=jb instanceof
tb?Eb=>Eb.prop(Sa)==jb.data:jb?Eb=>Eb==jb:void 0;this.style=Z.tagHighlighter(O.map(Eb=>({tag:Eb.tag,class:Eb.class||ma(Object.assign({},Eb,{tag:null}))})),{all:cb}).style;this.module=Ia?new pa.StyleModule(Ia):null;this.themeType=ia.themeType}static define(O,ia){return new L(O,ia||{})}},ea=N.Facet.define(),qa=N.Facet.define({combine(L){return L.length?[L[0]]:null}}),za=N.Prec.high(M.ViewPlugin.fromClass(class{constructor(L){this.markCache=Object.create(null);this.tree=u(L.state);this.decorations=this.buildDeco(L,
ib(L.state));this.decoratedTo=L.viewport.to}update(L){let O=u(L.state),ia=ib(L.state),ma=ia!=ib(L.startState),{viewport:Ia}=L.view,cb=L.changes.mapPos(this.decoratedTo,1);O.length<Ia.to&&!ma&&O.type==this.tree.type&&cb>=Ia.to?(this.decorations=this.decorations.map(L.changes),this.decoratedTo=cb):(O!=this.tree||L.viewportChanged||ma)&&(this.tree=O,this.decorations=this.buildDeco(L.view,ia),this.decoratedTo=Ia.to)}buildDeco(L,O){if(!O||!this.tree.length)return M.Decoration.none;let ia=new N.RangeSetBuilder;
for(let {from:ma,to:Ia}of L.visibleRanges)Z.highlightTree(this.tree,O,(cb,jb,Eb)=>{ia.add(cb,jb,this.markCache[Eb]||(this.markCache[Eb]=M.Decoration.mark({class:Eb})))},ma,Ia);return ia.finish()}},{decorations:L=>L.decorations})),Wa=W.define([{tag:Z.tags.meta,color:"#404740"},{tag:Z.tags.link,textDecoration:"underline"},{tag:Z.tags.heading,textDecoration:"underline",fontWeight:"bold"},{tag:Z.tags.emphasis,fontStyle:"italic"},{tag:Z.tags.strong,fontWeight:"bold"},{tag:Z.tags.strikethrough,textDecoration:"line-through"},
{tag:Z.tags.keyword,color:"#708"},{tag:[Z.tags.atom,Z.tags.bool,Z.tags.url,Z.tags.contentSeparator,Z.tags.labelName],color:"#219"},{tag:[Z.tags.literal,Z.tags.inserted],color:"#164"},{tag:[Z.tags.string,Z.tags.deleted],color:"#a11"},{tag:[Z.tags.regexp,Z.tags.escape,Z.tags.special(Z.tags.string)],color:"#e40"},{tag:Z.tags.definition(Z.tags.variableName),color:"#00f"},{tag:Z.tags.local(Z.tags.variableName),color:"#30a"},{tag:[Z.tags.typeName,Z.tags.namespace],color:"#085"},{tag:Z.tags.className,color:"#167"},
{tag:[Z.tags.special(Z.tags.variableName),Z.tags.macroName],color:"#256"},{tag:Z.tags.definition(Z.tags.propertyName),color:"#00c"},{tag:Z.tags.comment,color:"#940"},{tag:Z.tags.invalid,color:"#f00"}]),fb=M.EditorView.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Ab=N.Facet.define({combine(L){return N.combineConfig(L,{afterCursor:!0,brackets:"()[]{}",maxScanDistance:1E4,renderMatch:zb})}}),Ib=M.Decoration.mark({class:"cm-matchingBracket"}),
uc=M.Decoration.mark({class:"cm-nonmatchingBracket"}),xc=[N.StateField.define({create(){return M.Decoration.none},update(L,O){if(!O.docChanged&&!O.selection)return L;L=[];let ia=O.state.facet(Ab);for(let ma of O.state.selection.ranges){if(!ma.empty)continue;let Ia=Lb(O.state,ma.head,-1,ia)||0<ma.head&&Lb(O.state,ma.head-1,1,ia)||ia.afterCursor&&(Lb(O.state,ma.head,1,ia)||ma.head<O.state.doc.length&&Lb(O.state,ma.head+1,-1,ia));Ia&&(L=L.concat(ia.renderMatch(Ia,O.state)))}return M.Decoration.set(L,
!0)},provide:L=>M.EditorView.decorations.from(L)}),fb],R=new ya.NodeProp,U=class{constructor(L,O,ia,ma){this.string=L;this.tabSize=O;this.indentUnit=ia;this.overrideIndent=ma;this.lastColumnValue=this.lastColumnPos=this.start=this.pos=0}eol(){return this.pos>=this.string.length}sol(){return 0==this.pos}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(L){let O=this.string.charAt(this.pos),ia;if("string"==typeof L?ia=
O==L:ia=O&&(L instanceof RegExp?L.test(O):L(O)),ia)return++this.pos,O}eatWhile(L){let O=this.pos;for(;this.eat(L););return this.pos>O}eatSpace(){let L=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>L}skipToEnd(){this.pos=this.string.length}skipTo(L){L=this.string.indexOf(L,this.pos);if(-1<L)return this.pos=L,!0}backUp(L){this.pos-=L}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Xb(this.string,this.start,this.tabSize,this.lastColumnPos,
this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var L;return null!==(L=this.overrideIndent)&&void 0!==L?L:Xb(this.string,null,this.tabSize)}match(L,O,ia){if("string"==typeof L){var ma=this.string.substr(this.pos,L.length);ma=ia?ma.toLowerCase():ma;ia=ia?L.toLowerCase():L;return ma==ia?(!1!==O&&(this.pos+=L.length),!0):null}return(L=this.string.slice(this.pos).match(L))&&0<L.index?null:(L&&!1!==O&&(this.pos+=L[0].length),L)}current(){return this.string.slice(this.start,
this.pos)}},na=new WeakMap,wa=class L extends tb{constructor(O){let ia=p(O.languageData),ma=$b(O),Ia,cb=new class extends ya.Parser{createParse(jb,Eb,vc){return new La(Ia,jb,Eb,vc)}};super(ia,cb,[],O.name);this.topNode=lc(ia,this);Ia=this;this.streamParser=ma;this.stateAfter=new ya.NodeProp({perNode:!0});this.tokenTable=O.tokenTable?new Kc(ma.tokenTable):ed}static define(O){return new L(O)}getIndent(O){let ia,{overrideIndentation:ma}=O.options;ma&&(ia=na.get(O.state),null!=ia&&ia<O.pos-1E4&&(ia=void 0));
var Ia=yb(this,O.node.tree,O.node.from,O.node.from,ia??O.pos),cb;let jb;if(Ia?(jb=Ia.state,cb=Ia.pos+1):(jb=this.streamParser.startState(O.unit),cb=O.node.from),1E4<O.pos-cb)return null;for(;cb<O.pos;){Ia=O.state.doc.lineAt(cb);cb=Math.min(O.pos,Ia.to);if(Ia.length){var Eb=ma?ma(Ia.from):-1;for(Eb=new U(Ia.text,O.state.tabSize,O.unit,0>Eb?void 0:Eb);Eb.pos<cb-Ia.from;)Cb(this.streamParser.token,Eb,jb)}else this.streamParser.blankLine(jb,O.unit);if(cb==O.pos)break;cb=Ia.to+1}Ia=O.lineAt(O.pos);return ma&&
null==ia&&na.set(O.state,Ia.from),this.streamParser.indent(jb,/^\s*(.*)/.exec(Ia.text)[1],O)}get allowsNesting(){return!1}},La=class{constructor(L,O,ia,ma){this.lang=L;this.input=O;this.fragments=ia;this.ranges=ma;this.stoppedAt=null;this.chunks=[];this.chunkPos=[];this.chunk=[];this.chunkReused=void 0;this.rangeIndex=0;this.to=ma[ma.length-1].to;let Ia=yc.get();O=ma[0].from;let {state:cb,tree:jb}=Db(L,ia,O,this.to,Ia?.state);this.state=cb;this.parsedPos=this.chunkStart=O+jb.length;for(L=0;L<jb.children.length;L++)this.chunks.push(jb.children[L]),
this.chunkPos.push(jb.positions[L]);Ia&&this.parsedPos<Ia.viewport.from-1E5&&ma.some(Eb=>Eb.from<=Ia.viewport.from&&Eb.to>=Ia.viewport.from)&&(this.state=this.lang.streamParser.startState(B(Ia.state)),Ia.skipUntilInView(this.parsedPos,Ia.viewport.from),this.parsedPos=Ia.viewport.from);this.moveRangeIndex()}advance(){let L=yc.get(),O=null==this.stoppedAt?this.to:Math.min(this.to,this.stoppedAt),ia=Math.min(O,this.chunkStart+2048);for(L&&(ia=Math.min(ia,L.viewport.to));this.parsedPos<ia;)this.parseLine(L);
return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=O?this.finish():L&&this.parsedPos>=L.viewport.to?(L.skipUntilInView(this.parsedPos,O),this.finish()):null}stopAt(L){this.stoppedAt=L}lineAfter(L){let O=this.input.chunk(L);if(this.input.lineChunks)"\n"==O&&(O="");else{let ia=O.indexOf("\n");-1<ia&&(O=O.slice(0,ia))}return L+O.length<=this.to?O:O.slice(0,this.to-L)}nextLine(){var L=this.parsedPos;let O=this.lineAfter(L);var ia=L+O.length;for(L=this.rangeIndex;;){var ma=this.ranges[L].to;
if(ma>=ia||(O=O.slice(0,ma-(ia-O.length)),L++,L==this.ranges.length))break;ia=this.ranges[L].from;ma=this.lineAfter(ia);O+=ma;ia+=ma.length}return{line:O,end:ia}}skipGapsTo(L,O,ia){for(;;){let Ia=this.ranges[this.rangeIndex].to;var ma=L+O;if(0<ia?Ia>ma:Ia>=ma)break;ma=this.ranges[++this.rangeIndex].from;O+=ma-Ia}return O}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(L,O,ia,ma){let Ia=4;if(1<this.ranges.length){ma=this.skipGapsTo(O,ma,1);O+=ma;var cb=
this.chunk.length;ma=this.skipGapsTo(ia,ma,-1);ia+=ma;Ia+=this.chunk.length-cb}cb=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&4==Ia&&0<=cb&&this.chunk[cb]==L&&this.chunk[cb+2]==O?this.chunk[cb+2]=ia:this.chunk.push(L,O,ia,Ia),ma}parseLine(L){let {line:O,end:ia}=this.nextLine(),ma=0,{streamParser:Ia}=this.lang;L=new U(O,L?L.state.tabSize:4,L?B(L.state):2);if(L.eol())Ia.blankLine(this.state,L.indentUnit);else for(;!L.eol();){let cb=Cb(Ia.token,L,this.state);if(cb&&(ma=this.emitToken(this.lang.tokenTable.resolve(cb),
this.parsedPos+L.start,this.parsedPos+L.pos,ma)),1E4<L.start)break}this.parsedPos=ia;this.moveRangeIndex();this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let L=ya.Tree.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:hb,topID:0,maxBufferLength:2048,reused:this.chunkReused});L=new ya.Tree(L.type,L.children,L.positions,L.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]);this.chunks.push(L);this.chunkPos.push(this.chunkStart-
this.ranges[0].from);this.chunk=[];this.chunkReused=void 0;this.chunkStart=this.parsedPos}finish(){return(new ya.Tree(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from)).balance()}},eb=Object.create(null),Ya=[ya.NodeType.none],hb=new ya.NodeSet(Ya),Nb=[],sc=Object.create(null),Ec=Object.create(null);for(let [L,O]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute",
"attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Ec[L]=Sb(eb,O);var Kc=class{constructor(L){this.extra=L;this.table=Object.assign(Object.create(null),Ec)}resolve(L){return L?this.table[L]||(this.table[L]=Sb(this.extra,L)):0}},ed=new Kc(eb),ud=N.Facet.define({combine:L=>L.some(O=>O)}),he=M.ViewPlugin.fromClass(class{constructor(L){this.always=L.state.facet(ud)||L.textDirection!=M.Direction.LTR||
L.state.facet(M.EditorView.perLineTextDirection);this.hasRTL=!this.always&&oc(L.state.doc);this.tree=u(L.state);this.decorations=this.always||this.hasRTL?db(L,this.tree,this.always):M.Decoration.none}update(L){let O=L.state.facet(ud)||L.view.textDirection!=M.Direction.LTR||L.state.facet(M.EditorView.perLineTextDirection);if(!O&&!this.hasRTL&&bb(L.changes)&&(this.hasRTL=!0),O||this.hasRTL){var ia=u(L.state);(O!=this.always||ia!=this.tree||L.docChanged||L.viewportChanged)&&(this.tree=ia,this.always=
O,this.decorations=db(L.view,ia,O))}}},{provide:L=>{function O(ia){var ma,Ia;return null!==(Ia=null===(ma=ia.plugin(L))||void 0===ma?void 0:ma.decorations)&&void 0!==Ia?Ia:M.Decoration.none}return[M.EditorView.outerDecorations.of(O),N.Prec.lowest(M.EditorView.bidiIsolatedRanges.of(O))]}}),ze={rtl:M.Decoration.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"rtl"},bidiIsolate:M.Direction.RTL}),ltr:M.Decoration.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"ltr"},bidiIsolate:M.Direction.LTR}),
auto:M.Decoration.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"auto"},bidiIsolate:null})};n.DocInput=Jb;n.HighlightStyle=W;n.IndentContext=da;n.LRLanguage=Pb;n.Language=tb;n.LanguageDescription=jd;n.LanguageSupport=cd;n.ParseContext=yc;n.StreamLanguage=wa;n.StringStream=U;n.TreeIndentContext=Ea;n.bidiIsolates=function(L={}){let O=[he];return L.alwaysIsolate&&O.push(ud.of(!0)),O};n.bracketMatching=function(L={}){return[Ab.of(L),xc]};n.bracketMatchingHandle=R;n.codeFolding=kb;n.continuedIndent=
function({except:L,units:O=1}={}){return ia=>{let ma=L&&L.test(ia.textAfter);return ia.baseIndent+(ma?0:O*ia.unit)}};n.defaultHighlightStyle=Wa;n.defineLanguageFacet=p;n.delimitedIndent=function({closing:L,align:O=!0,units:ia=1}){return ma=>Da(ma,O,ia,L)};n.ensureSyntaxTree=w;n.flatIndent=L=>L.baseIndent;n.foldAll=Cc;n.foldCode=Jc;n.foldEffect=Fb;n.foldGutter=function(L={}){let O=Object.assign(Object.assign({},V),L),ia=new A(O,!0),ma=new A(O,!1),Ia=M.ViewPlugin.fromClass(class{constructor(jb){this.from=
jb.viewport.from;this.markers=this.buildMarkers(jb)}update(jb){(jb.docChanged||jb.viewportChanged||jb.startState.facet(Dc)!=jb.state.facet(Dc)||jb.startState.field(ic,!1)!=jb.state.field(ic,!1)||u(jb.startState)!=u(jb.state)||O.foldingChanged(jb))&&(this.markers=this.buildMarkers(jb.view))}buildMarkers(jb){let Eb=new N.RangeSetBuilder;for(let vc of jb.viewportLineBlocks){let $a=Ha(jb.state,vc.from,vc.to)?ma:Fa(jb.state,vc.from,vc.to)?ia:null;$a&&Eb.add(vc.from,vc.from,$a)}return Eb.finish()}}),{domEventHandlers:cb}=
O;return[Ia,M.gutter({class:"cm-foldGutter",markers(jb){var Eb;return(null===(Eb=jb.plugin(Ia))||void 0===Eb?void 0:Eb.markers)||N.RangeSet.empty},initialSpacer(){return new A(O,!1)},domEventHandlers:Object.assign(Object.assign({},cb),{click:(jb,Eb,vc)=>cb.click&&cb.click(jb,Eb,vc)?!0:(vc=Ha(jb.state,Eb.from,Eb.to))?(jb.dispatch({effects:Hb.of(vc)}),!0):(Eb=Fa(jb.state,Eb.from,Eb.to))?(jb.dispatch({effects:Fb.of(Eb)}),!0):!1})}),kb()]};n.foldInside=function(L){let O=L.firstChild,ia=L.lastChild;return O&&
O.to<ia.from?{from:O.to,to:ia.type.isError?L.to:ia.from}:null};n.foldKeymap=Vc;n.foldNodeProp=mb;n.foldService=Ta;n.foldState=ic;n.foldable=Fa;n.foldedRanges=function(L){return L.field(ic,!1)||N.RangeSet.empty};n.forceParsing=function(L,O=L.viewport.to,ia=100){O=w(L.state,O,ia);return O!=u(L.state)&&L.dispatch({}),!!O};n.getIndentUnit=B;n.getIndentation=E;n.highlightingFor=function(L,O,ia){var ma=ib(L);L=null;if(ma)for(let Ia of ma)(!Ia.scope||ia&&Ia.scope(ia))&&(ma=Ia.style(O))&&(L=L?L+" "+ma:ma);
return L};n.indentNodeProp=Ca;n.indentOnInput=function(){return N.EditorState.transactionFilter.of(L=>{if(!L.docChanged||!L.isUserEvent("input.type")&&!L.isUserEvent("input.complete"))return L;var O=L.startState.languageDataAt("indentOnInput",L.startState.selection.main.head);if(!O.length)return L;var ia=L.newDoc,{head:ma}=L.newSelection.main,Ia=ia.lineAt(ma);if(ma>Ia.from+200)return L;let cb=ia.sliceString(Ia.from,ma);if(!O.some(Eb=>Eb.test(cb)))return L;({state:O}=L);ia=-1;ma=[];for(let {head:Eb}of O.selection.ranges){Ia=
O.doc.lineAt(Eb);if(Ia.from==ia)continue;ia=Ia.from;var jb=E(O,Ia.from);if(null==jb)continue;let vc=/^\s*/.exec(Ia.text)[0];jb=z(O,jb);vc!=jb&&ma.push({from:Ia.from,to:Ia.from+vc.length,insert:jb})}return ma.length?[L,{changes:ma,sequential:!0}]:L})};n.indentRange=function(L,O,ia){let ma=Object.create(null),Ia=new da(L,{overrideIndentation:jb=>{var Eb;return null!==(Eb=ma[jb])&&void 0!==Eb?Eb:-1}}),cb=[];for(;O<=ia;){let jb=L.doc.lineAt(O);O=jb.to+1;let Eb=E(Ia,jb.from);if(null==Eb)continue;/\S/.test(jb.text)||
(Eb=0);let vc=/^\s*/.exec(jb.text)[0],$a=z(L,Eb);vc!=$a&&(ma[jb.from]=Eb,cb.push({from:jb.from,to:jb.from+vc.length,insert:$a}))}return L.changes(cb)};n.indentService=wc;n.indentString=z;n.indentUnit=zc;n.language=Dc;n.languageDataProp=Sa;n.matchBrackets=Lb;n.sublanguageProp=Za;n.syntaxHighlighting=function(L,O){let ia=[za],ma;return L instanceof W&&(L.module&&ia.push(M.EditorView.styleModule.of(L.module)),ma=L.themeType),O?.fallback?ia.push(qa.of(L)):ma?ia.push(ea.computeN([M.EditorView.darkTheme],
Ia=>Ia.facet(M.EditorView.darkTheme)==("dark"==ma)?[L]:[])):ia.push(ea.of(L)),ia};n.syntaxParserRunning=function(L){var O;return(null===(O=L.plugin(Nc))||void 0===O?void 0:O.isWorking())||!1};n.syntaxTree=u;n.syntaxTreeAvailable=function(L,O=L.doc.length){var ia;return(null===(ia=L.field(tb.state,!1))||void 0===ia?void 0:ia.context.isDone(O))||!1};n.toggleFold=L=>{let O=[];for(let Ia of Va(L)){var ia=Ha(L.state,Ia.from,Ia.to);if(ia)O.push(Hb.of(ia),Qa(L,ia,!1));else{a:{ia=L;var ma=Ia;for(let cb=ma;;){let jb=
Fa(ia.state,cb.from,cb.to);if(jb&&jb.to>ma.from){ia=jb;break a}if(!cb.from){ia=null;break a}cb=ia.lineBlockAt(cb.from-1)}}ia&&O.push(Fb.of(ia),Qa(L,ia))}}return 0<O.length&&L.dispatch({effects:Na(L.state,O)}),!!O.length};n.unfoldAll=Tc;n.unfoldCode=$c;n.unfoldEffect=Hb}),Qp=va(n=>{function p(S,ka){return({state:Ga,dispatch:xa})=>{if(Ga.readOnly)return!1;let Pa=S(ka,Ga);return Pa?(xa(Ga.update(Pa)),!0):!1}}function q(S,ka){S=S.languageDataAt("commentTokens",ka,1);return S.length?S[0]:{}}function u(S,
{open:ka,close:Ga},xa,Pa){var Ma=S.sliceDoc(xa-Ic,xa),rb=S.sliceDoc(Pa,Pa+Ic);let Gb=/\s*$/.exec(Ma)[0].length,gc=/^\s*/.exec(rb)[0].length,Lc=Ma.length-Gb;if(Ma.slice(Lc-ka.length,Lc)==ka&&rb.slice(gc,gc+Ga.length)==Ga)return{open:{pos:xa-Gb,margin:Gb&&1},close:{pos:Pa+gc,margin:gc&&1}};let Oc,Dd;Pa-xa<=2*Ic?Oc=Dd=S.sliceDoc(xa,Pa):(Oc=S.sliceDoc(xa,xa+Ic),Dd=S.sliceDoc(Pa-Ic,Pa));S=/^\s*/.exec(Oc)[0].length;Ma=/\s*$/.exec(Dd)[0].length;rb=Dd.length-Ma-Ga.length;return Oc.slice(S,S+ka.length)==ka&&
Dd.slice(rb,rb+Ga.length)==Ga?{open:{pos:xa+S+ka.length,margin:/\s/.test(Oc.charAt(S+ka.length))?1:0},close:{pos:Pa-Ma-Ga.length,margin:/\s/.test(Dd.charAt(rb-1))?1:0}}:null}function w(S,ka,Ga=ka.selection.ranges){let xa=Ga.map(Ma=>q(ka,Ma.from).block);if(!xa.every(Ma=>Ma))return null;let Pa=Ga.map((Ma,rb)=>u(ka,xa[rb],Ma.from,Ma.to));if(2!=S&&!Pa.every(Ma=>Ma))return{changes:ka.changes(Ga.map((Ma,rb)=>Pa[rb]?[]:[{from:Ma.from,insert:xa[rb].open+" "},{from:Ma.to,insert:" "+xa[rb].close}]))};if(1!=
S&&Pa.some(Ma=>Ma)){S=[];for(let Ma=0,rb;Ma<Pa.length;Ma++)if(rb=Pa[Ma]){Ga=xa[Ma];let {open:Gb,close:gc}=rb;S.push({from:Gb.pos-Ga.open.length,to:Gb.pos+Gb.margin},{from:gc.pos-gc.margin,to:gc.pos+Ga.close.length})}return{changes:S}}return null}function y(S,ka,Ga=ka.selection.ranges){var xa=[];let Pa=-1;for(let {from:Gb,to:gc}of Ga){Ga=xa.length;let Lc=1E9;var Ma=q(ka,Gb).line;if(Ma){for(var rb=Gb;rb<=gc;){rb=ka.doc.lineAt(rb);if(rb.from>Pa&&(Gb==gc||gc>rb.from)){Pa=rb.from;let Oc=/^\s*/.exec(rb.text)[0].length,
Dd=Oc==rb.length,Uc=rb.text.slice(Oc,Oc+Ma.length)==Ma?Oc:-1;Oc<rb.text.length&&Oc<Lc&&(Lc=Oc);xa.push({line:rb,comment:Uc,token:Ma,indent:Oc,empty:Dd,single:!1})}rb=rb.to+1}if(1E9>Lc)for(Ma=Ga;Ma<xa.length;Ma++)xa[Ma].indent<xa[Ma].line.text.length&&(xa[Ma].indent=Lc);xa.length==Ga+1&&(xa[Ga].single=!0)}}if(2!=S&&xa.some(Gb=>0>Gb.comment&&(!Gb.empty||Gb.single))){S=[];for(let {line:Gb,token:gc,indent:Lc,empty:Oc,single:Dd}of xa)!Dd&&Oc||S.push({from:Gb.from+Lc,insert:gc+" "});xa=ka.changes(S);return{changes:xa,
selection:ka.selection.map(xa,1)}}if(1!=S&&xa.some(Gb=>0<=Gb.comment)){ka=[];for(let {line:Gb,comment:gc,token:Lc}of xa)0<=gc&&(xa=Gb.from+gc,S=xa+Lc.length," "==Gb.text[S-Gb.from]&&S++,ka.push({from:xa,to:S}));return{changes:ka}}return null}function B(S,ka){return function({state:Ga,dispatch:xa}){if(!ka&&Ga.readOnly)return!1;let Pa=Ga.field(wc,!1);return Pa?(Ga=Pa.pop(S,Ga,ka))?(xa(Ga),!0):!1:!1}}function z(S){return function(ka){ka=ka.field(wc,!1);if(!ka)return 0;ka=0==S?ka.done:ka.undone;return ka.length-
(ka.length&&!ka[0].changes?1:0)}}function E(S,ka,Ga,xa){S=S.slice(ka+1>Ga+20?ka-Ga-1:0,ka);return S.push(xa),S}function H(S,ka){let Ga=[],xa=!1;return S.iterChangedRanges((Pa,Ma)=>Ga.push(Pa,Ma)),ka.iterChangedRanges((Pa,Ma,rb,Gb)=>{for(Pa=0;Pa<Ga.length;){Ma=Ga[Pa++];let gc=Ga[Pa++];Gb>=Ma&&rb<=gc&&(xa=!0)}}),xa}function T(S,ka){return S.ranges.length==ka.ranges.length&&0===S.ranges.filter((Ga,xa)=>Ga.empty!=ka.ranges[xa].empty).length}function ca(S,ka){return S.length?ka.length?S.concat(ka):S:ka}
function ha(S,ka){if(S.length){let Ga=S[S.length-1],xa=Ga.selectionsAfter.slice(Math.max(0,Ga.selectionsAfter.length-Jc));return xa.length&&xa[xa.length-1].eq(ka)?S:(xa.push(ka),E(S,S.length-1,1E9,Ga.setSelAfter(xa)))}return[Hb.selection([ka])]}function Da(S,ka){if(!S.length)return S;let Ga=S.length;for(var xa=ic;Ga;){xa=Fa(S[Ga-1],ka,xa);if(xa.changes&&!xa.changes.empty||xa.effects.length)return S=S.slice(0,Ga),S[Ga-1]=xa,S;ka=xa.mapped;Ga--;xa=xa.selectionsAfter}return xa.length?[Hb.selection(xa)]:
ic}function Fa(S,ka,Ga){Ga=ca(S.selectionsAfter.length?S.selectionsAfter.map(rb=>rb.map(ka)):ic,Ga);if(!S.changes)return Hb.selection(Ga);let xa=S.changes.map(ka),Pa=ka.mapDesc(S.changes,!0),Ma=S.mapped?S.mapped.composeDesc(Pa):Pa;return new Hb(xa,Z.StateEffect.mapEffects(S.effects,ka),Ma,S.startSelection.map(Pa),Ga)}function ua(S,ka){return Z.EditorSelection.create(S.ranges.map(ka),S.mainIndex)}function Va(S,ka){return S.update({selection:ka,scrollIntoView:!0,userEvent:"select"})}function Ha({state:S,
dispatch:ka},Ga){Ga=ua(S.selection,Ga);return Ga.eq(S.selection,!0)?!1:(ka(Va(S,Ga)),!0)}function sa(S,ka){return Z.EditorSelection.cursor(ka?S.to:S.from)}function Na(S,ka){return Ha(S,Ga=>Ga.empty?S.moveByChar(Ga,ka):sa(Ga,ka))}function Qa(S){return S.textDirectionAt(S.state.selection.main.head)==pa.Direction.LTR}function kb(S,ka,Ga){ka=ka.head;let xa=S.doc.lineAt(ka);return ka==(Ga?xa.to:xa.from)?ka=Ga?Math.min(S.doc.length,xa.to+1):Math.max(0,xa.from-1):ka=xa.from+Z.findClusterBreak(xa.text,ka-
xa.from,Ga),Z.EditorSelection.cursor(ka,Ga?-1:1)}function pb(S,ka){return Ha(S,Ga=>Ga.empty?kb(S.state,Ga,ka):sa(Ga,ka))}function ib(S,ka){return Ha(S,Ga=>Ga.empty?S.moveByGroup(Ga,ka):sa(Ga,ka))}function zb(S,ka,Ga){let xa=S.state.charCategorizer(ka),Pa=xa(Ga),Ma=Pa!=Z.CharCategory.Space;return rb=>{rb=xa(rb);return rb!=Z.CharCategory.Space?Ma&&rb==Pa:(Ma=!1,!0)}}function gb(S,ka,Ga){let xa=S.state.charCategorizer(ka.from),Pa=Z.CharCategory.Space,Ma=ka.from,rb=0,Gb=!1,gc=!1,Lc=!1,Oc=ge=>{if(Gb)return!1;
Ma+=Ga?ge.length:-ge.length;let If=xa(ge),Jf;if(If==Z.CharCategory.Word&&128>ge.charCodeAt(0)&&/[\W_]/.test(ge)&&(If=-1),Pa==Z.CharCategory.Space&&(Pa=If),Pa!=If)return!1;if(Pa==Z.CharCategory.Word)if(ge.toLowerCase()==ge){if(!Ga&&gc)return!1;Lc=!0}else if(Lc){if(Ga)return!1;Gb=!0}else{if(gc&&Ga&&xa(Jf=S.state.sliceDoc(Ma,Ma+1))==Z.CharCategory.Word&&Jf.toLowerCase()==Jf)return!1;gc=!0}return rb++,!0},Dd=S.moveByChar(ka,Ga,ge=>(Oc(ge),Oc));if(nd&&Pa==Z.CharCategory.Word&&Dd.from==ka.from+rb*(Ga?1:
-1)){var Uc=S.state.sliceDoc(Math.min(ka.head,Dd.head),Math.max(ka.head,Dd.head));if(1<Uc.length&&/[\u4E00-\uffff]/.test(Uc)&&(Uc=Array.from(nd.segment(Uc)),1<Uc.length))return Ga?Z.EditorSelection.cursor(ka.head+Uc[1].index,-1):Z.EditorSelection.cursor(Dd.head+Uc[Uc.length-1].index,1)}return Dd}function qb(S,ka){return Ha(S,Ga=>Ga.empty?gb(S,Ga,ka):sa(Ga,ka))}function Lb(S,ka,Ga){let xa=Ja.syntaxTree(S).resolveInner(ka.head),Pa=Ga?Sa.NodeProp.closedBy:Sa.NodeProp.openedBy;for(ka=ka.head;;){let Lc=
Ga?xa.childAfter(ka):xa.childBefore(ka);if(!Lc)break;a:{var Ma=S;var rb=Lc;if(rb.type.prop(Pa)){Ma=!0;break a}let Oc=rb.to-rb.from;Ma=Oc&&(2<Oc||/[^\s,.;:]/.test(Ma.sliceDoc(rb.from,rb.to)))||rb.firstChild}Ma?xa=Lc:ka=Ga?Lc.to:Lc.from}let Gb,gc;return xa.type.prop(Pa)&&(Gb=Ga?Ja.matchBrackets(S,xa.from,1):Ja.matchBrackets(S,xa.to,-1))&&Gb.matched?gc=Ga?Gb.end.to:Gb.end.from:gc=Ga?xa.to:xa.from,Z.EditorSelection.cursor(gc,Ga?-1:1)}function Xb(S,ka){return Ha(S,Ga=>{if(!Ga.empty)return sa(Ga,ka);let xa=
S.moveVertically(Ga,ka);return xa.head!=Ga.head?xa:S.moveToLineBoundary(Ga,ka)})}function $b(S){let ka=S.scrollDOM.clientHeight<S.scrollDOM.scrollHeight-2,Ga=0,xa=0;if(ka){for(Pa of S.state.facet(pa.EditorView.scrollMargins)){let Ma=Pa(S);Ma?.top&&(Ga=Math.max(Ma?.top,Ga));Ma?.bottom&&(xa=Math.max(Ma?.bottom,xa))}var Pa=S.scrollDOM.clientHeight-Ga-xa}else Pa=(S.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:Ga,marginBottom:xa,selfScroll:ka,height:Math.max(S.defaultLineHeight,
Pa-5)}}function pc(S,ka){let Ga=$b(S),{state:xa}=S,Pa=ua(xa.selection,Gb=>Gb.empty?S.moveVertically(Gb,ka,Ga.height):sa(Gb,ka));if(Pa.eq(xa.selection))return!1;let Ma;if(Ga.selfScroll){let Gb=S.coordsAtPos(xa.selection.main.head);var rb=S.scrollDOM.getBoundingClientRect();let gc=rb.top+Ga.marginTop;rb=rb.bottom-Ga.marginBottom;Gb&&Gb.top>gc&&Gb.bottom<rb&&(Ma=pa.EditorView.scrollIntoView(Pa.main.head,{y:"start",yMargin:Gb.top-gc}))}return S.dispatch(Va(xa,Pa),{effects:Ma}),!0}function yb(S,ka,Ga){let xa=
S.lineBlockAt(ka.head),Pa=S.moveToLineBoundary(ka,Ga);(Pa.head==ka.head&&Pa.head!=(Ga?xa.to:xa.from)&&(Pa=S.moveToLineBoundary(ka,Ga,!1)),!Ga&&Pa.head==xa.from&&xa.length)&&(S=/^\s*/.exec(S.state.sliceDoc(xa.from,Math.min(xa.from+100,xa.to)))[0].length)&&ka.head!=xa.from+S&&(Pa=Z.EditorSelection.cursor(xa.from+S));return Pa}function Bb(S,ka,Ga){let xa=!1,Pa=ua(S.selection,Ma=>{var rb=Ja.matchBrackets(S,Ma.head,-1)||Ja.matchBrackets(S,Ma.head,1)||0<Ma.head&&Ja.matchBrackets(S,Ma.head-1,1)||Ma.head<
S.doc.length&&Ja.matchBrackets(S,Ma.head+1,-1);if(!rb||!rb.end)return Ma;xa=!0;rb=rb.start.from==Ma.head?rb.end.to:rb.end.from;return Ga?Z.EditorSelection.range(Ma.anchor,rb):Z.EditorSelection.cursor(rb)});return xa?(ka(Va(S,Pa)),!0):!1}function Db(S,ka){let Ga=ua(S.state.selection,xa=>{let Pa=ka(xa);return Z.EditorSelection.range(xa.anchor,Pa.head,Pa.goalColumn,Pa.bidiLevel||void 0)});return Ga.eq(S.state.selection)?!1:(S.dispatch(Va(S.state,Ga)),!0)}function Cb(S,ka){return Db(S,Ga=>S.moveByChar(Ga,
ka))}function sb(S,ka){return Db(S,Ga=>S.moveByGroup(Ga,ka))}function Sb(S,ka){return Db(S,Ga=>gb(S,Ga,ka))}function lc(S,ka){return Db(S,Ga=>S.moveVertically(Ga,ka))}function qc(S,ka){return Db(S,Ga=>S.moveVertically(Ga,ka,$b(S).height))}function oc(S,ka){if(S.state.readOnly)return!1;let Ga="delete.selection",{state:xa}=S,Pa=xa.changeByRange(Ma=>{let {from:rb,to:Gb}=Ma;if(rb==Gb){let gc=ka(Ma);gc<rb?(Ga="delete.backward",gc=bb(S,gc,!1)):gc>rb&&(Ga="delete.forward",gc=bb(S,gc,!0));rb=Math.min(rb,
gc);Gb=Math.max(Gb,gc)}else rb=bb(S,rb,!1),Gb=bb(S,Gb,!0);return rb==Gb?{range:Ma}:{changes:{from:rb,to:Gb},range:Z.EditorSelection.cursor(rb,rb<Ma.head?-1:1)}});return Pa.changes.empty?!1:(S.dispatch(xa.update(Pa,{scrollIntoView:!0,userEvent:Ga,effects:"delete.selection"==Ga?pa.EditorView.announce.of(xa.phrase("Selection deleted")):void 0})),!0)}function bb(S,ka,Ga){if(S instanceof pa.EditorView)for(let xa of S.state.facet(pa.EditorView.atomicRanges).map(Pa=>Pa(S)))xa.between(ka,ka,(Pa,Ma)=>{Pa<
ka&&Ma>ka&&(ka=Ga?Ma:Pa)});return ka}function db(S){let ka=[];var Ga=-1;for(let xa of S.selection.ranges){let Pa=S.doc.lineAt(xa.from),Ma=S.doc.lineAt(xa.to);(!xa.empty&&xa.to==Ma.from&&(Ma=S.doc.lineAt(xa.to-1)),Ga>=Pa.number)?(Ga=ka[ka.length-1],Ga.to=Ma.to,Ga.ranges.push(xa)):ka.push({from:Pa.from,to:Ma.to,ranges:[xa]});Ga=Ma.number+1}return ka}function oa(S,ka,Ga){if(S.readOnly)return!1;let xa=[],Pa=[];for(let Ma of db(S)){if(Ga?Ma.to==S.doc.length:0==Ma.from)continue;let rb=S.doc.lineAt(Ga?Ma.to+
1:Ma.from-1),Gb=rb.length+1;if(Ga){xa.push({from:Ma.to,to:rb.to},{from:Ma.from,insert:rb.text+S.lineBreak});for(let gc of Ma.ranges)Pa.push(Z.EditorSelection.range(Math.min(S.doc.length,gc.anchor+Gb),Math.min(S.doc.length,gc.head+Gb)))}else{xa.push({from:rb.from,to:Ma.from},{from:Ma.to,insert:S.lineBreak+rb.text});for(let gc of Ma.ranges)Pa.push(Z.EditorSelection.range(gc.anchor-Gb,gc.head-Gb))}}return xa.length?(ka(S.update({changes:xa,scrollIntoView:!0,selection:Z.EditorSelection.create(Pa,S.selection.mainIndex),
userEvent:"move.line"})),!0):!1}function ya(S,ka,Ga){if(S.readOnly)return!1;let xa=[];for(let Pa of db(S))Ga?xa.push({from:Pa.from,insert:S.doc.slice(Pa.from,Pa.to)+S.lineBreak}):xa.push({from:Pa.to,insert:S.lineBreak+S.doc.slice(Pa.from,Pa.to)});return ka(S.update({changes:xa,scrollIntoView:!0,userEvent:"input.copyline"})),!0}function N(S){return({state:ka,dispatch:Ga})=>{if(ka.readOnly)return!1;let xa=ka.changeByRange(Pa=>{let {from:Ma,to:rb}=Pa;Pa=ka.doc.lineAt(Ma);var Gb;if(Gb=!S&&Ma==rb)if(Gb=
Ma,/\(\)|\[\]|\{\}/.test(ka.sliceDoc(Gb-1,Gb+1)))Gb={from:Gb,to:Gb};else{var gc=Ja.syntaxTree(ka).resolveInner(Gb),Lc=gc.childBefore(Gb);gc=gc.childAfter(Gb);var Oc;Gb=Lc&&gc&&Lc.to<=Gb&&gc.from>=Gb&&(Oc=Lc.type.prop(Sa.NodeProp.closedBy))&&-1<Oc.indexOf(gc.name)&&ka.doc.lineAt(Lc.to).from==ka.doc.lineAt(gc.from).from&&!/\S/.test(ka.sliceDoc(Lc.to,gc.from))?{from:Lc.to,to:gc.from}:null}Oc=Gb;S&&(Ma=rb=(rb<=Pa.to?Pa:ka.doc.lineAt(rb)).to);Lc=new Ja.IndentContext(ka,{simulateBreak:Ma,simulateDoubleBreak:!!Oc});
Gb=Ja.getIndentation(Lc,Ma);for(null==Gb&&(Gb=Z.countColumn(/^\s*/.exec(ka.doc.lineAt(Ma).text)[0],ka.tabSize));rb<Pa.to&&/\s/.test(Pa.text[rb-Pa.from]);)rb++;Oc?{from:Ma,to:rb}=Oc:Ma>Pa.from&&Ma<Pa.from+100&&!/\S/.test(Pa.text.slice(0,Ma))&&(Ma=Pa.from);Gb=["",Ja.indentString(ka,Gb)];return Oc&&Gb.push(Ja.indentString(ka,Lc.lineIndent(Pa.from,-1))),{changes:{from:Ma,to:rb,insert:Z.Text.of(Gb)},range:Z.EditorSelection.cursor(Ma+1+Gb[1].length)}});return Ga(ka.update(xa,{scrollIntoView:!0,userEvent:"input"})),
!0}}function M(S,ka){let Ga=-1;return S.changeByRange(xa=>{let Pa=[];for(var Ma=xa.from;Ma<=xa.to;)Ma=S.doc.lineAt(Ma),Ma.number>Ga&&(xa.empty||xa.to>Ma.from)&&(ka(Ma,Pa,xa),Ga=Ma.number),Ma=Ma.to+1;Ma=S.changes(Pa);return{changes:Pa,range:Z.EditorSelection.range(Ma.mapPos(xa.anchor,1),Ma.mapPos(xa.head,1))}})}var Z=hg(),pa=Gg(),Ja=bk(),Sa=ak(),Za=S=>{var {state:ka}=S;ka=ka.doc.lineAt(ka.selection.main.from);ka=q(S.state,ka.from);return ka.line?tb(S):ka.block?Fc(S):!1},tb=p(y,0),Pb=p(y,1),Jb=p(y,
2),ec=p(w,0),yc=p(w,1),hc=p(w,2),Fc=p((S,ka)=>{let Ga=[];for(let xa of ka.selection.ranges){let Pa=ka.doc.lineAt(xa.from),Ma=xa.to<=Pa.to?Pa:ka.doc.lineAt(xa.to);Ma.from>Pa.from&&Ma.from==xa.to&&(Ma=xa.to==Pa.to+1?Pa:ka.doc.lineAt(xa.to-1));let rb=Ga.length-1;0<=rb&&Ga[rb].to>Pa.from?Ga[rb].to=Ma.to:Ga.push({from:Pa.from+/^\s*/.exec(Pa.text)[0].length,to:Ma.to})}return w(S,ka,Ga)},0),Ic=50,Nc=Z.Annotation.define(),Dc=Z.Annotation.define(),cd=Z.Facet.define(),jd=Z.Facet.define({combine(S){return Z.combineConfig(S,
{minDepth:100,newGroupDelay:500,joinToEvent:(ka,Ga)=>Ga},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(ka,Ga)=>(xa,Pa)=>ka(xa,Pa)||Ga(xa,Pa)})}}),wc=Z.StateField.define({create(){return Cc.empty},update(S,ka){let Ga=ka.state.facet(jd);var xa=ka.annotation(Nc);if(xa){var Pa=Hb.fromTransaction(ka,xa.selection),Ma=xa.side;S=0==Ma?S.undone:S.done;return Pa?S=E(S,S.length,Ga.minDepth,Pa):S=ha(S,ka.startState.selection),new Cc(0==Ma?xa.rest:S,0==Ma?S:xa.rest)}xa=ka.annotation(Dc);if(("full"==xa||
"before"==xa)&&(S=S.isolate()),!1===ka.annotation(Z.Transaction.addToHistory))return ka.changes.empty?S:S.addMapping(ka.changes.desc);Pa=Hb.fromTransaction(ka);Ma=ka.annotation(Z.Transaction.time);let rb=ka.annotation(Z.Transaction.userEvent);return Pa?S=S.addChanges(Pa,Ma,rb,Ga,ka):ka.selection&&(S=S.addSelection(ka.startState.selection,Ma,rb,Ga.newGroupDelay)),("full"==xa||"after"==xa)&&(S=S.isolate()),S},toJSON(S){return{done:S.done.map(ka=>ka.toJSON()),undone:S.undone.map(ka=>ka.toJSON())}},fromJSON(S){return new Cc(S.done.map(Hb.fromJSON),
S.undone.map(Hb.fromJSON))}}),zc=wc,da=B(0,!1),Ca=B(1,!1),Ea=B(0,!0),Ta=B(1,!0),mb=z(0),Fb=z(1),Hb=class S{constructor(ka,Ga,xa,Pa,Ma){this.changes=ka;this.effects=Ga;this.mapped=xa;this.startSelection=Pa;this.selectionsAfter=Ma}setSelAfter(ka){return new S(this.changes,this.effects,this.mapped,this.startSelection,ka)}toJSON(){var ka,Ga,xa;return{changes:null===(ka=this.changes)||void 0===ka?void 0:ka.toJSON(),mapped:null===(Ga=this.mapped)||void 0===Ga?void 0:Ga.toJSON(),startSelection:null===(xa=
this.startSelection)||void 0===xa?void 0:xa.toJSON(),selectionsAfter:this.selectionsAfter.map(Pa=>Pa.toJSON())}}static fromJSON(ka){return new S(ka.changes&&Z.ChangeSet.fromJSON(ka.changes),[],ka.mapped&&Z.ChangeDesc.fromJSON(ka.mapped),ka.startSelection&&Z.EditorSelection.fromJSON(ka.startSelection),ka.selectionsAfter.map(Z.EditorSelection.fromJSON))}static fromTransaction(ka,Ga){let xa=ic;for(let Pa of ka.startState.facet(cd)){let Ma=Pa(ka);Ma.length&&(xa=xa.concat(Ma))}return!xa.length&&ka.changes.empty?
null:new S(ka.changes.invert(ka.startState.doc),xa,void 0,Ga||ka.startState.selection,ic)}static selection(ka){return new S(void 0,ic,void 0,void 0,ka)}},ic=[],Jc=200,$c=/^(input\.type|delete)($|\.)/,Cc=class S{constructor(ka,Ga,xa=0,Pa){this.done=ka;this.undone=Ga;this.prevTime=xa;this.prevUserEvent=Pa}isolate(){return this.prevTime?new S(this.done,this.undone):this}addChanges(ka,Ga,xa,Pa,Ma){let rb=this.done,Gb=rb[rb.length-1];return Gb&&Gb.changes&&!Gb.changes.empty&&ka.changes&&(!xa||$c.test(xa))&&
(!Gb.selectionsAfter.length&&Ga-this.prevTime<Pa.newGroupDelay&&Pa.joinToEvent(Ma,H(Gb.changes,ka.changes))||"input.type.compose"==xa)?rb=E(rb,rb.length-1,Pa.minDepth,new Hb(ka.changes.compose(Gb.changes),ca(Z.StateEffect.mapEffects(ka.effects,Gb.changes),Gb.effects),Gb.mapped,Gb.startSelection,ic)):rb=E(rb,rb.length,Pa.minDepth,ka),new S(rb,ic,Ga,xa)}addSelection(ka,Ga,xa,Pa){let Ma=this.done.length?this.done[this.done.length-1].selectionsAfter:ic;return 0<Ma.length&&Ga-this.prevTime<Pa&&xa==this.prevUserEvent&&
xa&&/^select($|\.)/.test(xa)&&T(Ma[Ma.length-1],ka)?this:new S(ha(this.done,ka),this.undone,Ga,xa)}addMapping(ka){return new S(Da(this.done,ka),Da(this.undone,ka),this.prevTime,this.prevUserEvent)}pop(ka,Ga,xa){var Pa=0==ka?this.done:this.undone;if(0==Pa.length)return null;var Ma=Pa[Pa.length-1];let rb=Ma.selectionsAfter[0]||Ga.selection;if(xa&&Ma.selectionsAfter.length){xa=Ga.update;Ma=Ma.selectionsAfter[Ma.selectionsAfter.length-1];var Gb=Nc.of;let gc=Pa[Pa.length-1],Lc=Pa.slice();Pa=(Lc[Pa.length-
1]=gc.setSelAfter(gc.selectionsAfter.slice(0,gc.selectionsAfter.length-1)),Lc);return xa.call(Ga,{selection:Ma,annotations:Gb.call(Nc,{side:ka,rest:Pa,selection:rb}),userEvent:0==ka?"select.undo":"select.redo",scrollIntoView:!0})}return Ma.changes?(Pa=1==Pa.length?ic:Pa.slice(0,Pa.length-1),Ma.mapped&&(Pa=Da(Pa,Ma.mapped)),Ga.update({changes:Ma.changes,selection:Ma.startSelection,effects:Ma.effects,annotations:Nc.of({side:ka,rest:Pa,selection:rb}),filter:!1,userEvent:0==ka?"undo":"redo",scrollIntoView:!0})):
null}};Cc.empty=new Cc(ic,ic);var Tc=[{key:"Mod-z",run:da,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Ca,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Ca,preventDefault:!0},{key:"Mod-u",run:Ea,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Ta,preventDefault:!0}],Vc=S=>Na(S,!Qa(S)),qd=S=>Na(S,Qa(S)),wd=S=>ib(S,!Qa(S)),Yc=S=>ib(S,Qa(S)),nd="u">typeof Intl&&Intl.Segmenter?new Intl.Segmenter(void 0,{granularity:"word"}):null,V=S=>Ha(S,ka=>Lb(S.state,ka,!Qa(S))),A=S=>Ha(S,ka=>Lb(S.state,
ka,Qa(S))),J=S=>Xb(S,!1),W=S=>Xb(S,!0),ea=S=>pc(S,!1),qa=S=>pc(S,!0),za=S=>Ha(S,ka=>yb(S,ka,!0)),Wa=S=>Ha(S,ka=>yb(S,ka,!1)),fb=S=>Ha(S,ka=>yb(S,ka,!Qa(S))),Ab=S=>Ha(S,ka=>yb(S,ka,Qa(S))),Ib=S=>Ha(S,ka=>Z.EditorSelection.cursor(S.lineBlockAt(ka.head).from,1)),uc=S=>Ha(S,ka=>Z.EditorSelection.cursor(S.lineBlockAt(ka.head).to,-1)),xc=({state:S,dispatch:ka})=>Bb(S,ka,!1),R=S=>Cb(S,!Qa(S)),U=S=>Cb(S,Qa(S)),na=S=>sb(S,!Qa(S)),wa=S=>sb(S,Qa(S)),La=S=>Db(S,ka=>Lb(S.state,ka,!Qa(S))),eb=S=>Db(S,ka=>Lb(S.state,
ka,Qa(S))),Ya=S=>lc(S,!1),hb=S=>lc(S,!0),Nb=S=>qc(S,!1),sc=S=>qc(S,!0),Ec=S=>Db(S,ka=>yb(S,ka,!0)),Kc=S=>Db(S,ka=>yb(S,ka,!1)),ed=S=>Db(S,ka=>yb(S,ka,!Qa(S))),ud=S=>Db(S,ka=>yb(S,ka,Qa(S))),he=S=>Db(S,ka=>Z.EditorSelection.cursor(S.lineBlockAt(ka.head).from)),ze=S=>Db(S,ka=>Z.EditorSelection.cursor(S.lineBlockAt(ka.head).to)),L=({state:S,dispatch:ka})=>(ka(Va(S,{anchor:0})),!0),O=({state:S,dispatch:ka})=>(ka(Va(S,{anchor:S.doc.length})),!0),ia=({state:S,dispatch:ka})=>(ka(Va(S,{anchor:S.selection.main.anchor,
head:0})),!0),ma=({state:S,dispatch:ka})=>(ka(Va(S,{anchor:S.selection.main.anchor,head:S.doc.length})),!0),Ia=({state:S,dispatch:ka})=>(ka(S.update({selection:{anchor:0,head:S.doc.length},userEvent:"select"})),!0),cb=({state:S,dispatch:ka})=>{let Ga=db(S).map(({from:xa,to:Pa})=>Z.EditorSelection.range(xa,Math.min(Pa+1,S.doc.length)));return ka(S.update({selection:Z.EditorSelection.create(Ga),userEvent:"select"})),!0},jb=({state:S,dispatch:ka})=>{let Ga=ua(S.selection,xa=>{var Pa=Ja.syntaxTree(S),
Ma=Pa.resolveStack(xa.from,1);xa.empty&&(Pa=Pa.resolveStack(xa.from,-1),Pa.node.from>=Ma.node.from&&Pa.node.to<=Ma.node.to&&(Ma=Pa));for(;Ma;Ma=Ma.next)if({node:Pa}=Ma,(Pa.from<xa.from&&Pa.to>=xa.to||Pa.to>xa.to&&Pa.from<=xa.from)&&Ma.next)return Z.EditorSelection.range(Pa.to,Pa.from);return xa});return Ga.eq(S.selection)?!1:(ka(Va(S,Ga)),!0)},Eb=({state:S,dispatch:ka})=>{let Ga=S.selection,xa=null;return 1<Ga.ranges.length?xa=Z.EditorSelection.create([Ga.main]):Ga.main.empty||(xa=Z.EditorSelection.create([Z.EditorSelection.cursor(Ga.main.head)])),
xa?(ka(Va(S,xa)),!0):!1},vc=(S,ka,Ga)=>oc(S,xa=>{xa=xa.from;var {state:Pa}=S,Ma=Pa.doc.lineAt(xa),rb;if(Ga&&!ka&&xa>Ma.from&&xa<Ma.from+200&&!/[^ \t]/.test(rb=Ma.text.slice(0,xa-Ma.from))){if("\t"==rb[rb.length-1])return xa-1;Pa=Z.countColumn(rb,Pa.tabSize)%Ja.getIndentUnit(Pa)||Ja.getIndentUnit(Pa);for(Ma=0;Ma<Pa&&" "==rb[rb.length-1-Ma];Ma++)xa--;rb=xa}else rb=Z.findClusterBreak(Ma.text,xa-Ma.from,ka,ka)+Ma.from,rb==xa&&Ma.number!=(ka?Pa.doc.lines:1)?rb+=ka?1:-1:!ka&&/[\ufe00-\ufe0f]/.test(Ma.text.slice(rb-
Ma.from,xa-Ma.from))&&(rb=Z.findClusterBreak(Ma.text,rb-Ma.from,!1,!1)+Ma.from);return rb}),$a=S=>vc(S,!1,!0),xd=S=>vc(S,!0,!1),Pd=(S,ka)=>oc(S,Ga=>{let xa=Ga.head,{state:Pa}=S,Ma=Pa.doc.lineAt(xa),rb=Pa.charCategorizer(xa);for(let Gb=null;;){if(xa==(ka?Ma.to:Ma.from)){xa==Ga.head&&Ma.number!=(ka?Pa.doc.lines:1)&&(xa+=ka?1:-1);break}let gc=Z.findClusterBreak(Ma.text,xa-Ma.from,ka)+Ma.from,Lc=Ma.text.slice(Math.min(xa,gc)-Ma.from,Math.max(xa,gc)-Ma.from),Oc=rb(Lc);if(null!=Gb&&Oc!=Gb)break;" "==Lc&&
xa==Ga.head||(Gb=Oc);xa=gc}return xa}),qe=S=>Pd(S,!1),Ud=S=>Pd(S,!0),Hf=S=>oc(S,ka=>{let Ga=S.lineBlockAt(ka.head).to;return ka.head<Ga?Ga:Math.min(S.state.doc.length,ka.head+1)}),rd=S=>oc(S,ka=>{let Ga=S.moveToLineBoundary(ka,!1).head;return ka.head>Ga?Ga:Math.max(0,ka.head-1)}),Ae=S=>oc(S,ka=>{let Ga=S.moveToLineBoundary(ka,!0).head;return ka.head<Ga?Ga:Math.min(S.state.doc.length,ka.head+1)}),od=({state:S,dispatch:ka})=>{if(S.readOnly)return!1;let Ga=S.changeByRange(xa=>({changes:{from:xa.from,
to:xa.to,insert:Z.Text.of(["",""])},range:Z.EditorSelection.cursor(xa.from)}));return ka(S.update(Ga,{scrollIntoView:!0,userEvent:"input"})),!0},Nf=({state:S,dispatch:ka})=>{if(S.readOnly)return!1;let Ga=S.changeByRange(xa=>{if(!xa.empty||0==xa.from||xa.from==S.doc.length)return{range:xa};xa=xa.from;var Pa=S.doc.lineAt(xa);let Ma=xa==Pa.from?xa-1:Z.findClusterBreak(Pa.text,xa-Pa.from,!1)+Pa.from;Pa=xa==Pa.to?xa+1:Z.findClusterBreak(Pa.text,xa-Pa.from,!0)+Pa.from;return{changes:{from:Ma,to:Pa,insert:S.doc.slice(xa,
Pa).append(S.doc.slice(Ma,xa))},range:Z.EditorSelection.cursor(Pa)}});return Ga.changes.empty?!1:(ka(S.update(Ga,{scrollIntoView:!0,userEvent:"move.character"})),!0)},Ld=({state:S,dispatch:ka})=>oa(S,ka,!1),Of=({state:S,dispatch:ka})=>oa(S,ka,!0),Zd=({state:S,dispatch:ka})=>ya(S,ka,!1),rg=({state:S,dispatch:ka})=>ya(S,ka,!0),Pf=S=>{if(S.state.readOnly)return!1;let {state:ka}=S,Ga=ka.changes(db(ka).map(({from:Pa,to:Ma})=>(0<Pa?Pa--:Ma<ka.doc.length&&Ma++,{from:Pa,to:Ma}))),xa=ua(ka.selection,Pa=>{let Ma;
if(S.lineWrapping){let rb=S.lineBlockAt(Pa.head),Gb=S.coordsAtPos(Pa.head,Pa.assoc||1);Gb&&(Ma=rb.bottom+S.documentTop-Gb.bottom+S.defaultLineHeight/2)}return S.moveVertically(Pa,!0,Ma)}).map(Ga);return S.dispatch({changes:Ga,selection:xa,scrollIntoView:!0,userEvent:"delete.line"}),!0},Ge=N(!1),Qf=N(!0),Re=({state:S,dispatch:ka})=>{if(S.readOnly)return!1;let Ga=Object.create(null),xa=new Ja.IndentContext(S,{overrideIndentation:Ma=>Ga[Ma]??-1}),Pa=M(S,(Ma,rb,Gb)=>{let gc=Ja.getIndentation(xa,Ma.from);
if(null!=gc){/\S/.test(Ma.text)||(gc=0);var Lc=/^\s*/.exec(Ma.text)[0],Oc=Ja.indentString(S,gc);(Lc!=Oc||Gb.from<Ma.from+Lc.length)&&(Ga[Ma.from]=gc,rb.push({from:Ma.from,to:Ma.from+Lc.length,insert:Oc}))}});return Pa.changes.empty||ka(S.update(Pa,{userEvent:"indent"})),!0},df=({state:S,dispatch:ka})=>S.readOnly?!1:(ka(S.update(M(S,(Ga,xa)=>{xa.push({from:Ga.from,insert:S.facet(Ja.indentUnit)})}),{userEvent:"input.indent"})),!0),ef=({state:S,dispatch:ka})=>S.readOnly?!1:(ka(S.update(M(S,(Ga,xa)=>
{let Pa=/^\s*/.exec(Ga.text)[0];if(Pa){var Ma=Z.countColumn(Pa,S.tabSize),rb=0;for(Ma=Ja.indentString(S,Math.max(0,Ma-Ja.getIndentUnit(S)));rb<Pa.length&&rb<Ma.length&&Pa.charCodeAt(rb)==Ma.charCodeAt(rb);)rb++;xa.push({from:Ga.from+rb,to:Ga.from+Pa.length,insert:Ma.slice(rb)})}}),{userEvent:"delete.dedent"})),!0),sg=S=>(S.setTabFocusMode(),!0),mc=[{key:"Ctrl-b",run:Vc,shift:R,preventDefault:!0},{key:"Ctrl-f",run:qd,shift:U},{key:"Ctrl-p",run:J,shift:Ya},{key:"Ctrl-n",run:W,shift:hb},{key:"Ctrl-a",
run:Ib,shift:he},{key:"Ctrl-e",run:uc,shift:ze},{key:"Ctrl-d",run:xd},{key:"Ctrl-h",run:$a},{key:"Ctrl-k",run:Hf},{key:"Ctrl-Alt-h",run:qe},{key:"Ctrl-o",run:od},{key:"Ctrl-t",run:Nf},{key:"Ctrl-v",run:qa}],xe=[{key:"ArrowLeft",run:Vc,shift:R,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:wd,shift:na,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:fb,shift:ed,preventDefault:!0},{key:"ArrowRight",run:qd,shift:U,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Yc,shift:wa,
preventDefault:!0},{mac:"Cmd-ArrowRight",run:Ab,shift:ud,preventDefault:!0},{key:"ArrowUp",run:J,shift:Ya,preventDefault:!0},{mac:"Cmd-ArrowUp",run:L,shift:ia},{mac:"Ctrl-ArrowUp",run:ea,shift:Nb},{key:"ArrowDown",run:W,shift:hb,preventDefault:!0},{mac:"Cmd-ArrowDown",run:O,shift:ma},{mac:"Ctrl-ArrowDown",run:qa,shift:sc},{key:"PageUp",run:ea,shift:Nb},{key:"PageDown",run:qa,shift:sc},{key:"Home",run:Wa,shift:Kc,preventDefault:!0},{key:"Mod-Home",run:L,shift:ia},{key:"End",run:za,shift:Ec,preventDefault:!0},
{key:"Mod-End",run:O,shift:ma},{key:"Enter",run:Ge,shift:Ge},{key:"Mod-a",run:Ia},{key:"Backspace",run:$a,shift:$a},{key:"Delete",run:xd},{key:"Mod-Backspace",mac:"Alt-Backspace",run:qe},{key:"Mod-Delete",mac:"Alt-Delete",run:Ud},{mac:"Mod-Backspace",run:rd},{mac:"Mod-Delete",run:Ae}].concat(mc.map(S=>({mac:S.key,run:S.run,shift:S.shift}))),Ze=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:V,shift:La},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:A,shift:eb},{key:"Alt-ArrowUp",run:Ld},{key:"Shift-Alt-ArrowUp",
run:Zd},{key:"Alt-ArrowDown",run:Of},{key:"Shift-Alt-ArrowDown",run:rg},{key:"Escape",run:Eb},{key:"Mod-Enter",run:Qf},{key:"Alt-l",mac:"Ctrl-l",run:cb},{key:"Mod-i",run:jb,preventDefault:!0},{key:"Mod-[",run:ef},{key:"Mod-]",run:df},{key:"Mod-Alt-\\",run:Re},{key:"Shift-Mod-k",run:Pf},{key:"Shift-Mod-\\",run:xc},{key:"Mod-/",run:Za},{key:"Alt-A",run:ec},{key:"Ctrl-m",mac:"Shift-Alt-m",run:sg}].concat(xe),Rf={key:"Tab",run:df,shift:ef};n.blockComment=yc;n.blockUncomment=hc;n.copyLineDown=rg;n.copyLineUp=
Zd;n.cursorCharBackward=S=>Na(S,!1);n.cursorCharBackwardLogical=S=>pb(S,!1);n.cursorCharForward=S=>Na(S,!0);n.cursorCharForwardLogical=S=>pb(S,!0);n.cursorCharLeft=Vc;n.cursorCharRight=qd;n.cursorDocEnd=O;n.cursorDocStart=L;n.cursorGroupBackward=S=>ib(S,!1);n.cursorGroupForward=S=>ib(S,!0);n.cursorGroupForwardWin=S=>Ha(S,ka=>ka.empty?S.moveByChar(ka,!0,Ga=>zb(S,ka.head,Ga)):sa(ka,!0));n.cursorGroupLeft=wd;n.cursorGroupRight=Yc;n.cursorLineBoundaryBackward=Wa;n.cursorLineBoundaryForward=za;n.cursorLineBoundaryLeft=
fb;n.cursorLineBoundaryRight=Ab;n.cursorLineDown=W;n.cursorLineEnd=uc;n.cursorLineStart=Ib;n.cursorLineUp=J;n.cursorMatchingBracket=xc;n.cursorPageDown=qa;n.cursorPageUp=ea;n.cursorSubwordBackward=S=>qb(S,!1);n.cursorSubwordForward=S=>qb(S,!0);n.cursorSyntaxLeft=V;n.cursorSyntaxRight=A;n.defaultKeymap=Ze;n.deleteCharBackward=$a;n.deleteCharBackwardStrict=S=>vc(S,!1,!1);n.deleteCharForward=xd;n.deleteGroupBackward=qe;n.deleteGroupForward=Ud;n.deleteLine=Pf;n.deleteLineBoundaryBackward=rd;n.deleteLineBoundaryForward=
Ae;n.deleteToLineEnd=Hf;n.deleteToLineStart=S=>oc(S,ka=>{let Ga=S.lineBlockAt(ka.head).from;return ka.head>Ga?Ga:Math.max(0,ka.head-1)});n.deleteTrailingWhitespace=({state:S,dispatch:ka})=>{if(S.readOnly)return!1;let Ga=[];for(let xa=0,Pa="",Ma=S.doc.iter();;){if(Ma.next(),Ma.lineBreak||Ma.done){let rb=Pa.search(/\s+$/);if(-1<rb&&Ga.push({from:xa-(Pa.length-rb),to:xa}),Ma.done)break;Pa=""}else Pa=Ma.value;xa+=Ma.value.length}return Ga.length?(ka(S.update({changes:Ga,userEvent:"delete"})),!0):!1};
n.emacsStyleKeymap=mc;n.history=function(S={}){return[wc,jd.of(S),pa.EditorView.domEventHandlers({beforeinput(ka,Ga){let xa="historyUndo"==ka.inputType?da:"historyRedo"==ka.inputType?Ca:null;return xa?(ka.preventDefault(),xa(Ga)):!1}})]};n.historyField=zc;n.historyKeymap=Tc;n.indentLess=ef;n.indentMore=df;n.indentSelection=Re;n.indentWithTab=Rf;n.insertBlankLine=Qf;n.insertNewline=({state:S,dispatch:ka})=>(ka(S.update(S.replaceSelection(S.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0);n.insertNewlineAndIndent=
Ge;n.insertNewlineKeepIndent=({state:S,dispatch:ka})=>(ka(S.update(S.changeByRange(Ga=>{let xa=/^\s*/.exec(S.doc.lineAt(Ga.from).text)[0];return{changes:{from:Ga.from,to:Ga.to,insert:S.lineBreak+xa},range:Z.EditorSelection.cursor(Ga.from+xa.length+1)}}),{scrollIntoView:!0,userEvent:"input"})),!0);n.insertTab=({state:S,dispatch:ka})=>S.selection.ranges.some(Ga=>!Ga.empty)?df({state:S,dispatch:ka}):(ka(S.update(S.replaceSelection("\t"),{scrollIntoView:!0,userEvent:"input"})),!0);n.invertedEffects=cd;
n.isolateHistory=Dc;n.lineComment=Pb;n.lineUncomment=Jb;n.moveLineDown=Of;n.moveLineUp=Ld;n.redo=Ca;n.redoDepth=Fb;n.redoSelection=Ta;n.selectAll=Ia;n.selectCharBackward=S=>Cb(S,!1);n.selectCharBackwardLogical=S=>Db(S,ka=>kb(S.state,ka,!1));n.selectCharForward=S=>Cb(S,!0);n.selectCharForwardLogical=S=>Db(S,ka=>kb(S.state,ka,!0));n.selectCharLeft=R;n.selectCharRight=U;n.selectDocEnd=ma;n.selectDocStart=ia;n.selectGroupBackward=S=>sb(S,!1);n.selectGroupForward=S=>sb(S,!0);n.selectGroupForwardWin=S=>
Db(S,ka=>S.moveByChar(ka,!0,Ga=>zb(S,ka.head,Ga)));n.selectGroupLeft=na;n.selectGroupRight=wa;n.selectLine=cb;n.selectLineBoundaryBackward=Kc;n.selectLineBoundaryForward=Ec;n.selectLineBoundaryLeft=ed;n.selectLineBoundaryRight=ud;n.selectLineDown=hb;n.selectLineEnd=ze;n.selectLineStart=he;n.selectLineUp=Ya;n.selectMatchingBracket=({state:S,dispatch:ka})=>Bb(S,ka,!0);n.selectPageDown=sc;n.selectPageUp=Nb;n.selectParentSyntax=jb;n.selectSubwordBackward=S=>Sb(S,!1);n.selectSubwordForward=S=>Sb(S,!0);
n.selectSyntaxLeft=La;n.selectSyntaxRight=eb;n.simplifySelection=Eb;n.splitLine=od;n.standardKeymap=xe;n.temporarilySetTabFocusMode=S=>(S.setTabFocusMode(2E3),!0);n.toggleBlockComment=ec;n.toggleBlockCommentByLine=Fc;n.toggleComment=Za;n.toggleLineComment=tb;n.toggleTabFocusMode=sg;n.transposeChars=Nf;n.undo=da;n.undoDepth=mb;n.undoSelection=Ea}),bm=va((n,p)=>{function q(u,w){if("string"==typeof w)u.appendChild(document.createTextNode(w));else if(null!=w)if(null!=w.nodeType)u.appendChild(w);else if(Array.isArray(w))for(var y=
0;y<w.length;y++)q(u,w[y]);else throw new RangeError("Unsupported child node: "+w);}p.exports=function(){var u=arguments[0];"string"==typeof u&&(u=document.createElement(u));var w=1,y=arguments[1];if(y&&"object"==typeof y&&null==y.nodeType&&!Array.isArray(y)){for(var B in y)if(Object.prototype.hasOwnProperty.call(y,B)){var z=y[B];"string"==typeof z?u.setAttribute(B,z):null!=z&&(u[B]=z)}w++}for(;w<arguments.length;w++)q(u,arguments[w]);return u}}),Rp=va(n=>{function p(da,Ca){if(Ca>=da.length)return Ca;
da=da.lineAt(Ca);let Ea;for(;Ca<da.to&&56320<=(Ea=da.text.charCodeAt(Ca-da.from))&&57344>Ea;)Ca++;return Ca}function q(da){function Ca(){var mb=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(Ta.value);if(mb){var {state:Fb}=da,Hb=Fb.doc.lineAt(Fb.selection.main.head),[,ic,Jc,$c,Cc]=mb;mb=$c?+$c.slice(1):0;var Tc=Jc?+Jc:Hb.number;Jc&&Cc?(Tc/=100,ic&&(Tc=Tc*("-"==ic?-1:1)+Hb.number/Fb.doc.lines),Tc=Math.round(Fb.doc.lines*Tc)):Jc&&ic&&(Tc=Tc*("-"==ic?-1:1)+Hb.number);Fb=Fb.doc.line(Math.max(1,Math.min(Fb.doc.lines,
Tc)));Fb=sa.EditorSelection.cursor(Fb.from+Math.max(0,Math.min(mb,Fb.length)));da.dispatch({effects:[Xb.of(!1),Ha.EditorView.scrollIntoView(Fb.from,{y:"center"})],selection:Fb});da.focus()}}let Ea=String(da.state.doc.lineAt(da.state.selection.main.head).number),Ta=Na("input",{class:"cm-textfield",name:"line",value:Ea});return{dom:Na("form",{class:"cm-gotoLine",onkeydown:mb=>{27==mb.keyCode?(mb.preventDefault(),da.dispatch({effects:Xb.of(!1)}),da.focus()):13==mb.keyCode&&(mb.preventDefault(),Ca())},
onsubmit:mb=>{mb.preventDefault();Ca()}},Na("label",da.state.phrase("Go to line"),": ",Ta)," ",Na("button",{class:"cm-button",type:"submit"},da.state.phrase("go")),Na("button",{name:"close",onclick:()=>{da.dispatch({effects:Xb.of(!1)});da.focus()},"aria-label":da.state.phrase("close"),type:"button"},["\u00d7"]))}}function u(da,Ca,Ea,Ta){return(0==Ea||da(Ca.sliceDoc(Ea-1,Ea))!=sa.CharCategory.Word)&&(Ta==Ca.doc.length||da(Ca.sliceDoc(Ta,Ta+1))!=sa.CharCategory.Word)}function w(da,Ca){let {main:Ea,
ranges:Ta}=da.selection;var mb=da.wordAt(Ea.head);mb=mb&&mb.from==Ea.from&&mb.to==Ea.to;for(let Fb=!1,Hb=new kb(da.doc,Ca,Ta[Ta.length-1].to);;)if(Hb.next(),Hb.done){if(Fb)return null;Hb=new kb(da.doc,Ca,0,Math.max(0,Ta[Ta.length-1].from-1));Fb=!0}else if(!Fb||!Ta.some(ic=>ic.from==Hb.value.from)){if(mb){let ic=da.wordAt(Hb.value.from);if(!ic||ic.from!=Hb.value.from||ic.to!=Hb.value.to)continue}return Hb.value}}function y(da,Ca,Ea,Ta){return new kb(Ca.doc,da.unquoted,Ea,Ta,da.caseSensitive?void 0:
mb=>mb.toLowerCase(),da.wholeWord?B(Ca.doc,Ca.charCategorizer(Ca.selection.main.head)):void 0)}function B(da,Ca){return(Ea,Ta,mb,Fb)=>((Fb>Ea||Fb+mb.length<Ta)&&(Fb=Math.max(0,Ea-2),mb=da.sliceString(Fb,Math.min(da.length,Ta+2))),(Ca(E(mb,Ea-Fb))!=sa.CharCategory.Word||Ca(H(mb,Ea-Fb))!=sa.CharCategory.Word)&&(Ca(H(mb,Ta-Fb))!=sa.CharCategory.Word||Ca(E(mb,Ta-Fb))!=sa.CharCategory.Word))}function z(da,Ca,Ea,Ta){return new zb(Ca.doc,da.search,{ignoreCase:!da.caseSensitive,test:da.wholeWord?T(Ca.charCategorizer(Ca.selection.main.head)):
void 0},Ea,Ta)}function E(da,Ca){return da.slice(sa.findClusterBreak(da,Ca,!1),Ca)}function H(da,Ca){return da.slice(Ca,sa.findClusterBreak(da,Ca))}function T(da){return(Ca,Ea,Ta)=>!Ta[0].length||(da(E(Ta.input,Ta.index))!=sa.CharCategory.Word||da(H(Ta.input,Ta.index))!=sa.CharCategory.Word)&&(da(H(Ta.input,Ta.index+Ta[0].length))!=sa.CharCategory.Word||da(E(Ta.input,Ta.index+Ta[0].length))!=sa.CharCategory.Word)}function ca(da){return Ca=>{let Ea=Ca.state.field(pa,!1);return Ea&&Ea.query.spec.valid?
da(Ca,Ea):Fc(Ca)}}function ha(da){return da.state.facet(bb).createPanel(da)}function Da(da,Ca){var Ea,Ta,mb,Fb,Hb,ic=da.selection.main;ic=ic.empty||ic.to>ic.from+100?"":da.sliceDoc(ic.from,ic.to);if(Ca&&!ic)return Ca;da=da.facet(bb);return new db({search:(null!==(Ea=Ca?.literal)&&void 0!==Ea?Ea:da.literal)?ic:ic.replace(/\n/g,"\\n"),caseSensitive:null!==(Ta=Ca?.caseSensitive)&&void 0!==Ta?Ta:da.caseSensitive,literal:null!==(mb=Ca?.literal)&&void 0!==mb?mb:da.literal,regexp:null!==(Fb=Ca?.regexp)&&
void 0!==Fb?Fb:da.regexp,wholeWord:null!==(Hb=Ca?.wholeWord)&&void 0!==Hb?Hb:da.wholeWord})}function Fa(da){return(da=Ha.getPanel(da,ha))&&da.dom.querySelector("[main-field]")}function ua(da){let Ca=Fa(da);Ca&&Ca==da.root.activeElement&&Ca.select()}function Va(da,{from:Ca,to:Ea}){let Ta=da.state.doc.lineAt(Ca);var mb=da.state.doc.lineAt(Ea).to;Ca=Math.max(Ta.from,Ca-cd);let Fb=Math.min(mb,Ea+cd);Ea=da.state.sliceDoc(Ca,Fb);if(Ca!=Ta.from)for(Ca=0;Ca<cd;Ca++)if(!jd.test(Ea[Ca+1])&&jd.test(Ea[Ca])){Ea=
Ea.slice(Ca);break}if(Fb!=mb)for(mb=Ea.length-1;mb>Ea.length-cd;mb--)if(!jd.test(Ea[mb-1])&&jd.test(Ea[mb])){Ea=Ea.slice(0,mb);break}return Ha.EditorView.announce.of(`${da.state.phrase("current match")}. ${Ea} ${da.state.phrase("on line")} ${Ta.number}.`)}var Ha=Gg(),sa=hg(),Na=bm(),Qa="function"==typeof String.prototype.normalize?da=>da.normalize("NFKD"):da=>da,kb=class{constructor(da,Ca,Ea=0,Ta=da.length,mb,Fb){this.test=Fb;this.value={from:0,to:0};this.done=!1;this.matches=[];this.buffer="";this.bufferPos=
0;this.iter=da.iterRange(Ea,Ta);this.bufferStart=Ea;this.normalize=mb?Hb=>mb(Qa(Hb)):Qa;this.query=this.normalize(Ca)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0;this.buffer=this.iter.value}return sa.codePointAt(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){var da=this.peek();if(0>da)return this.done=!0,this;let Ca=
sa.fromCodePoint(da),Ea=this.bufferStart+this.bufferPos;this.bufferPos+=sa.codePointSize(da);da=this.normalize(Ca);if(da.length)for(let Ta=0,mb=Ea;;Ta++){let Fb=da.charCodeAt(Ta),Hb=this.match(Fb,mb,this.bufferPos+this.bufferStart);if(Ta==da.length-1){if(Hb)return this.value=Hb,this;break}mb==Ea&&Ta<Ca.length&&Ca.charCodeAt(Ta)==Fb&&mb++}}}match(da,Ca,Ea){let Ta=null;for(let mb=0;mb<this.matches.length;mb+=2){let Fb=this.matches[mb],Hb=!1;this.query.charCodeAt(Fb)==da&&(Fb==this.query.length-1?Ta=
{from:this.matches[mb+1],to:Ea}:(this.matches[mb]++,Hb=!0));Hb||(this.matches.splice(mb,2),mb-=2)}return this.query.charCodeAt(0)==da&&(1==this.query.length?Ta={from:Ca,to:Ea}:this.matches.push(1,Ca)),Ta&&this.test&&!this.test(Ta.from,Ta.to,this.buffer,this.bufferStart)&&(Ta=null),Ta}};"u">typeof Symbol&&(kb.prototype[Symbol.iterator]=function(){return this});var pb={from:-1,to:-1,match:/.*/.exec("")},ib="gm"+(null==/x/.unicode?"":"u"),zb=class{constructor(da,Ca,Ea,Ta=0,mb=da.length){if(this.text=
da,this.to=mb,this.curLine="",this.done=!1,this.value=pb,/\\[sWDnr]|\n|\r|\[\^/.test(Ca))return new Lb(da,Ca,Ea,Ta,mb);this.re=new RegExp(Ca,ib+(Ea?.ignoreCase?"i":""));this.test=Ea?.test;this.iter=da.iter();this.curLineStart=da.lineAt(Ta).from;this.matchPos=p(da,Ta);this.getLine(this.curLineStart)}getLine(da){this.iter.next(da);this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),
this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1;this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(var da=this.matchPos-this.curLineStart;;)if(this.re.lastIndex=da,da=this.matchPos<=this.to&&this.re.exec(this.curLine)){let Ca=this.curLineStart+da.index,Ea=Ca+da[0].length;if(this.matchPos=p(this.text,Ea+(Ca==Ea?1:0)),Ca==this.curLineStart+this.curLine.length&&this.nextLine(),(Ca<Ea||Ca>this.value.to)&&(!this.test||this.test(Ca,Ea,da)))return this.value=
{from:Ca,to:Ea,match:da},this;da=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),da=0;else return this.done=!0,this}},gb=new WeakMap,qb=class da{constructor(Ca,Ea){this.from=Ca;this.text=Ea}get to(){return this.from+this.text.length}static get(Ca,Ea,Ta){let mb=gb.get(Ca);if(!mb||mb.from>=Ta||mb.to<=Ea)return Ea=new da(Ea,Ca.sliceString(Ea,Ta)),gb.set(Ca,Ea),Ea;if(mb.from==Ea&&mb.to==Ta)return mb;let {text:Fb,from:Hb}=mb;return Hb>Ea&&(Fb=Ca.sliceString(Ea,
Hb)+Fb,Hb=Ea),mb.to<Ta&&(Fb+=Ca.sliceString(mb.to,Ta)),gb.set(Ca,new da(Hb,Fb)),new da(Ea,Fb.slice(Ea-Hb,Ta-Hb))}},Lb=class{constructor(da,Ca,Ea,Ta,mb){this.text=da;this.to=mb;this.done=!1;this.value=pb;this.matchPos=p(da,Ta);this.re=new RegExp(Ca,ib+(Ea?.ignoreCase?"i":""));this.test=Ea?.test;this.flat=qb.get(da,Ta,this.chunkEnd(Ta+5E3))}chunkEnd(da){return da>=this.to?this.to:this.text.lineAt(da).to}next(){for(;;){var da=this.re.lastIndex=this.matchPos-this.flat.from;let Ca=this.re.exec(this.flat.text);
if(Ca&&!Ca[0]&&Ca.index==da&&(this.re.lastIndex=da+1,Ca=this.re.exec(this.flat.text)),Ca){da=this.flat.from+Ca.index;let Ea=da+Ca[0].length;if((this.flat.to>=this.to||Ca.index+Ca[0].length<=this.flat.text.length-10)&&(!this.test||this.test(da,Ea,Ca)))return this.value={from:da,to:Ea,match:Ca},this.matchPos=p(this.text,Ea+(da==Ea?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=qb.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}};"u">typeof Symbol&&
(zb.prototype[Symbol.iterator]=Lb.prototype[Symbol.iterator]=function(){return this});var Xb=sa.StateEffect.define(),$b=sa.StateField.define({create(){return!0},update(da,Ca){for(let Ea of Ca.effects)Ea.is(Xb)&&(da=Ea.value);return da},provide:da=>Ha.showPanel.from(da,Ca=>Ca?q:null)}),pc=da=>{var Ca=Ha.getPanel(da,q);Ca||(Ca=[Xb.of(!0)],null==da.state.field($b,!1)&&Ca.push(sa.StateEffect.appendConfig.of([$b,yb])),da.dispatch({effects:Ca}),Ca=Ha.getPanel(da,q));return Ca&&Ca.dom.querySelector("input").select(),
!0},yb=Ha.EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),Bb={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},Db=sa.Facet.define({combine(da){return sa.combineConfig(da,Bb,{highlightWordAroundCursor:(Ca,Ea)=>Ca||Ea,minSelectionLength:Math.min,maxMatches:Math.min})}}),
Cb=Ha.Decoration.mark({class:"cm-selectionMatch"}),sb=Ha.Decoration.mark({class:"cm-selectionMatch cm-selectionMatch-main"}),Sb=Ha.ViewPlugin.fromClass(class{constructor(da){this.decorations=this.getDeco(da)}update(da){(da.selectionSet||da.docChanged||da.viewportChanged)&&(this.decorations=this.getDeco(da.view))}getDeco(da){let Ca=da.state.facet(Db),{state:Ea}=da;var Ta=Ea.selection;if(1<Ta.ranges.length)return Ha.Decoration.none;Ta=Ta.main;let mb=null;if(Ta.empty){if(!Ca.highlightWordAroundCursor)return Ha.Decoration.none;
var Fb=Ea.wordAt(Ta.head);if(!Fb)return Ha.Decoration.none;mb=Ea.charCategorizer(Ta.head);Fb=Ea.sliceDoc(Fb.from,Fb.to)}else{var Hb=Ta.to-Ta.from;if(Hb<Ca.minSelectionLength||200<Hb)return Ha.Decoration.none;if(Ca.wholeWords){Fb=Ea.sliceDoc(Ta.from,Ta.to);mb=Ea.charCategorizer(Ta.head);if(Hb=u(mb,Ea,Ta.from,Ta.to)){Hb=mb;var ic=Ta.from,Jc=Ta.to;Hb=Hb(Ea.sliceDoc(ic,ic+1))==sa.CharCategory.Word&&Hb(Ea.sliceDoc(Jc-1,Jc))==sa.CharCategory.Word}if(!Hb)return Ha.Decoration.none}else if(Fb=Ea.sliceDoc(Ta.from,
Ta.to),!Fb)return Ha.Decoration.none}Hb=[];for(let $c of da.visibleRanges)for(da=new kb(Ea.doc,Fb,$c.from,$c.to);!da.next().done;){let {from:Cc,to:Tc}=da.value;if((!mb||u(mb,Ea,Cc,Tc))&&(Ta.empty&&Cc<=Ta.from&&Tc>=Ta.to?Hb.push(sb.range(Cc,Tc)):(Cc>=Ta.to||Tc<=Ta.from)&&Hb.push(Cb.range(Cc,Tc)),Hb.length>Ca.maxMatches))return Ha.Decoration.none}return Ha.Decoration.set(Hb)}},{decorations:da=>da.decorations}),lc=Ha.EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),
qc=({state:da,dispatch:Ca})=>{let {selection:Ea}=da,Ta=sa.EditorSelection.create(Ea.ranges.map(mb=>da.wordAt(mb.head)||sa.EditorSelection.cursor(mb.head)),Ea.mainIndex);return Ta.eq(Ea)?!1:(Ca(da.update({selection:Ta})),!0)},oc=({state:da,dispatch:Ca})=>{var {ranges:Ea}=da.selection;if(Ea.some(mb=>mb.from===mb.to))return qc({state:da,dispatch:Ca});let Ta=da.sliceDoc(Ea[0].from,Ea[0].to);return da.selection.ranges.some(mb=>da.sliceDoc(mb.from,mb.to)!=Ta)?!1:(Ea=w(da,Ta))?(Ca(da.update({selection:da.selection.addRange(sa.EditorSelection.range(Ea.from,
Ea.to),!1),effects:Ha.EditorView.scrollIntoView(Ea.to)})),!0):!1},bb=sa.Facet.define({combine(da){return sa.combineConfig(da,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:Ca=>new Dc(Ca),scrollToMatch:Ca=>Ha.EditorView.scrollIntoView(Ca)})}}),db=class{constructor(da){this.search=da.search;this.caseSensitive=!!da.caseSensitive;this.literal=!!da.literal;this.regexp=!!da.regexp;this.replace=da.replace||"";var Ca;if((Ca=!!this.search)&&!(Ca=!this.regexp))try{Ca=(new RegExp(this.search,
ib),!0)}catch{Ca=!1}this.valid=Ca;this.unquoted=this.unquote(this.search);this.wholeWord=!!da.wholeWord}unquote(da){return this.literal?da:da.replace(/\\([nrt\\])/g,(Ca,Ea)=>"n"==Ea?"\n":"r"==Ea?"\r":"t"==Ea?"\t":"\\")}eq(da){return this.search==da.search&&this.replace==da.replace&&this.caseSensitive==da.caseSensitive&&this.regexp==da.regexp&&this.wholeWord==da.wholeWord}create(){return this.regexp?new N(this):new ya(this)}getCursor(da,Ca=0,Ea){da=da.doc?da:sa.EditorState.create({doc:da});return null==
Ea&&(Ea=da.doc.length),this.regexp?z(this,da,Ca,Ea):y(this,da,Ca,Ea)}},oa=class{constructor(da){this.spec=da}},ya=class extends oa{constructor(da){super(da)}nextMatch(da,Ca,Ea){let Ta=y(this.spec,da,Ea,da.doc.length).nextOverlapping();Ta.done&&(Ta=y(this.spec,da,0,Math.min(da.doc.length,Ca+this.spec.unquoted.length)).nextOverlapping());return Ta.done||Ta.value.from==Ca&&Ta.value.to==Ea?null:Ta.value}prevMatchInRange(da,Ca,Ea){for(;;){let Ta=Math.max(Ca,Ea-1E4-this.spec.unquoted.length),mb=y(this.spec,
da,Ta,Ea),Fb=null;for(;!mb.nextOverlapping().done;)Fb=mb.value;if(Fb)return Fb;if(Ta==Ca)return null;Ea-=1E4}}prevMatch(da,Ca,Ea){let Ta=this.prevMatchInRange(da,0,Ca);return Ta||=this.prevMatchInRange(da,Math.max(0,Ea-this.spec.unquoted.length),da.doc.length),!Ta||Ta.from==Ca&&Ta.to==Ea?null:Ta}getReplacement(da){return this.spec.unquote(this.spec.replace)}matchAll(da,Ca){da=y(this.spec,da,0,da.doc.length);let Ea=[];for(;!da.next().done;){if(Ea.length>=Ca)return null;Ea.push(da.value)}return Ea}highlight(da,
Ca,Ea,Ta){for(da=y(this.spec,da,Math.max(0,Ca-this.spec.unquoted.length),Math.min(Ea+this.spec.unquoted.length,da.doc.length));!da.next().done;)Ta(da.value.from,da.value.to)}},N=class extends oa{nextMatch(da,Ca,Ea){Ea=z(this.spec,da,Ea,da.doc.length).next();return Ea.done&&(Ea=z(this.spec,da,0,Ca).next()),Ea.done?null:Ea.value}prevMatchInRange(da,Ca,Ea){for(let Ta=1;;Ta++){let mb=Math.max(Ca,Ea-1E4*Ta),Fb=z(this.spec,da,mb,Ea),Hb=null;for(;!Fb.next().done;)Hb=Fb.value;if(Hb&&(mb==Ca||Hb.from>mb+10))return Hb;
if(mb==Ca)return null}}prevMatch(da,Ca,Ea){return this.prevMatchInRange(da,0,Ca)||this.prevMatchInRange(da,Ea,da.doc.length)}getReplacement(da){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(Ca,Ea)=>{if("&"==Ea)return da.match[0];if("$"==Ea)return"$";for(let Ta=Ea.length;0<Ta;Ta--){let mb=+Ea.slice(0,Ta);if(0<mb&&mb<da.match.length)return da.match[mb]+Ea.slice(Ta)}return Ca})}matchAll(da,Ca){da=z(this.spec,da,0,da.doc.length);let Ea=[];for(;!da.next().done;){if(Ea.length>=Ca)return null;
Ea.push(da.value)}return Ea}highlight(da,Ca,Ea,Ta){for(da=z(this.spec,da,Math.max(0,Ca-250),Math.min(Ea+250,da.doc.length));!da.next().done;)Ta(da.value.from,da.value.to)}},M=sa.StateEffect.define(),Z=sa.StateEffect.define(),pa=sa.StateField.define({create(da){return new Ja(Da(da).create(),null)},update(da,Ca){for(let Ea of Ca.effects)Ea.is(M)?da=new Ja(Ea.value.create(),da.panel):Ea.is(Z)&&(da=new Ja(da.query,Ea.value?ha:null));return da},provide:da=>Ha.showPanel.from(da,Ca=>Ca.panel)}),Ja=class{constructor(da,
Ca){this.query=da;this.panel=Ca}},Sa=Ha.Decoration.mark({class:"cm-searchMatch"}),Za=Ha.Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"});oa=Ha.ViewPlugin.fromClass(class{constructor(da){this.view=da;this.decorations=this.highlight(da.state.field(pa))}update(da){let Ca=da.state.field(pa);(Ca!=da.startState.field(pa)||da.docChanged||da.selectionSet||da.viewportChanged)&&(this.decorations=this.highlight(Ca))}highlight({query:da,panel:Ca}){if(!Ca||!da.spec.valid)return Ha.Decoration.none;
let {view:Ea}=this,Ta=new sa.RangeSetBuilder;for(let mb=0,Fb=Ea.visibleRanges,Hb=Fb.length;mb<Hb;mb++){let {from:ic,to:Jc}=Fb[mb];for(;mb<Hb-1&&Jc>Fb[mb+1].from-500;)Jc=Fb[++mb].to;da.highlight(Ea.state,ic,Jc,($c,Cc)=>{let Tc=Ea.state.selection.ranges.some(Vc=>Vc.from==$c&&Vc.to==Cc);Ta.add($c,Cc,Tc?Za:Sa)})}return Ta.finish()}},{decorations:da=>da.decorations});var tb=ca((da,{query:Ca})=>{var {to:Ea}=da.state.selection.main;Ca=Ca.nextMatch(da.state,Ea,Ea);if(!Ca)return!1;Ea=sa.EditorSelection.single(Ca.from,
Ca.to);let Ta=da.state.facet(bb);return da.dispatch({selection:Ea,effects:[Va(da,Ca),Ta.scrollToMatch(Ea.main,da)],userEvent:"select.search"}),ua(da),!0}),Pb=ca((da,{query:Ca})=>{var {state:Ea}=da,{from:Ta}=Ea.selection.main;Ca=Ca.prevMatch(Ea,Ta,Ta);if(!Ca)return!1;Ea=sa.EditorSelection.single(Ca.from,Ca.to);Ta=da.state.facet(bb);return da.dispatch({selection:Ea,effects:[Va(da,Ca),Ta.scrollToMatch(Ea.main,da)],userEvent:"select.search"}),ua(da),!0}),Jb=ca((da,{query:Ca})=>(Ca=Ca.matchAll(da.state,
1E3))&&Ca.length?(da.dispatch({selection:sa.EditorSelection.create(Ca.map(Ea=>sa.EditorSelection.range(Ea.from,Ea.to))),userEvent:"select.search.matches"}),!0):!1),ec=({state:da,dispatch:Ca})=>{var Ea=da.selection;if(1<Ea.ranges.length||Ea.main.empty)return!1;let {from:Ta,to:mb}=Ea.main;Ea=[];let Fb=0;for(let Hb=new kb(da.doc,da.sliceDoc(Ta,mb));!Hb.next().done;){if(1E3<Ea.length)return!1;Hb.value.from==Ta&&(Fb=Ea.length);Ea.push(sa.EditorSelection.range(Hb.value.from,Hb.value.to))}return Ca(da.update({selection:sa.EditorSelection.create(Ea,
Fb),userEvent:"select.search.matches"})),!0},yc=ca((da,{query:Ca})=>{let {state:Ea}=da,{from:Ta,to:mb}=Ea.selection.main;if(Ea.readOnly)return!1;let Fb=Ca.nextMatch(Ea,Ta,Ta);if(!Fb)return!1;let Hb=Fb,ic=[],Jc,$c,Cc=[];if(Hb.from==Ta&&Hb.to==mb&&($c=Ea.toText(Ca.getReplacement(Hb)),ic.push({from:Hb.from,to:Hb.to,insert:$c}),Hb=Ca.nextMatch(Ea,Hb.from,Hb.to),Cc.push(Ha.EditorView.announce.of(Ea.phrase("replaced match on line $",Ea.doc.lineAt(Ta).number)+"."))),Hb)Ca=0==ic.length||ic[0].from>=Fb.to?
0:Fb.to-Fb.from-$c.length,Jc=sa.EditorSelection.single(Hb.from-Ca,Hb.to-Ca),Cc.push(Va(da,Hb)),Cc.push(Ea.facet(bb).scrollToMatch(Jc.main,da));return da.dispatch({changes:ic,selection:Jc,effects:Cc,userEvent:"input.replace"}),!0}),hc=ca((da,{query:Ca})=>{if(da.state.readOnly)return!1;let Ea=Ca.matchAll(da.state,1E9).map(mb=>{let {from:Fb,to:Hb}=mb;return{from:Fb,to:Hb,insert:Ca.getReplacement(mb)}});if(!Ea.length)return!1;let Ta=da.state.phrase("replaced $ matches",Ea.length)+".";return da.dispatch({changes:Ea,
effects:Ha.EditorView.announce.of(Ta),userEvent:"input.replace.all"}),!0}),Fc=da=>{var Ca=da.state.field(pa,!1);if(Ca&&Ca.panel){let Ea=Fa(da);Ea&&Ea!=da.root.activeElement&&(Ca=Da(da.state,Ca.query.spec),Ca.valid&&da.dispatch({effects:M.of(Ca)}),Ea.focus(),Ea.select())}else da.dispatch({effects:[Z.of(!0),Ca?M.of(Da(da.state,Ca.query.spec)):sa.StateEffect.appendConfig.of(zc)]});return!0},Ic=da=>{var Ca=da.state.field(pa,!1);if(!Ca||!Ca.panel)return!1;Ca=Ha.getPanel(da,ha);return Ca&&Ca.dom.contains(da.root.activeElement)&&
da.focus(),da.dispatch({effects:Z.of(!1)}),!0},Nc=[{key:"Mod-f",run:Fc,scope:"editor search-panel"},{key:"F3",run:tb,shift:Pb,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:tb,shift:Pb,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Ic,scope:"editor search-panel"},{key:"Mod-Shift-l",run:ec},{key:"Mod-Alt-g",run:pc},{key:"Mod-d",run:oc,preventDefault:!0}],Dc=class{constructor(da){function Ca(Ta,mb,Fb){return Na("button",{class:"cm-button",name:Ta,onclick:mb,type:"button"},
Fb)}this.view=da;let Ea=this.query=da.state.field(pa).query.spec;this.commit=this.commit.bind(this);this.searchField=Na("input",{value:Ea.search,placeholder:da.state.phrase("Find"),"aria-label":da.state.phrase("Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit});this.replaceField=Na("input",{value:Ea.replace,placeholder:da.state.phrase("Replace"),"aria-label":da.state.phrase("Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,
onkeyup:this.commit});this.caseField=Na("input",{type:"checkbox",name:"case",form:"",checked:Ea.caseSensitive,onchange:this.commit});this.reField=Na("input",{type:"checkbox",name:"re",form:"",checked:Ea.regexp,onchange:this.commit});this.wordField=Na("input",{type:"checkbox",name:"word",form:"",checked:Ea.wholeWord,onchange:this.commit});this.dom=Na("div",{onkeydown:Ta=>this.keydown(Ta),class:"cm-search"},[this.searchField,Ca("next",()=>tb(da),[da.state.phrase("next")]),Ca("prev",()=>Pb(da),[da.state.phrase("previous")]),
Ca("select",()=>Jb(da),[da.state.phrase("all")]),Na("label",null,[this.caseField,da.state.phrase("match case")]),Na("label",null,[this.reField,da.state.phrase("regexp")]),Na("label",null,[this.wordField,da.state.phrase("by word")]),...(da.state.readOnly?[]:[Na("br"),this.replaceField,Ca("replace",()=>yc(da),[da.state.phrase("replace")]),Ca("replaceAll",()=>hc(da),[da.state.phrase("replace all")])]),Na("button",{name:"close",onclick:()=>Ic(da),"aria-label":da.state.phrase("close"),type:"button"},["\u00d7"])])}commit(){let da=
new db({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});da.eq(this.query)||(this.query=da,this.view.dispatch({effects:M.of(da)}))}keydown(da){Ha.runScopeHandlers(this.view,da,"search-panel")?da.preventDefault():13==da.keyCode&&da.target==this.searchField?(da.preventDefault(),(da.shiftKey?Pb:tb)(this.view)):13==da.keyCode&&da.target==this.replaceField&&(da.preventDefault(),yc(this.view))}update(da){for(let Ca of da.transactions)for(let Ea of Ca.effects)Ea.is(M)&&
!Ea.value.eq(this.query)&&this.setQuery(Ea.value)}setQuery(da){this.query=da;this.searchField.value=da.search;this.replaceField.value=da.replace;this.caseField.checked=da.caseSensitive;this.reField.checked=da.regexp;this.wordField.checked=da.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(bb).top}},cd=30,jd=/[\s\.,:;?!]/,wc=Ha.EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",
top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),zc=[pa,sa.Prec.low(oa),
wc];n.RegExpCursor=zb;n.SearchCursor=kb;n.SearchQuery=db;n.closeSearchPanel=Ic;n.findNext=tb;n.findPrevious=Pb;n.getSearchQuery=function(da){let Ca=da.field(pa,!1);return Ca?Ca.query.spec:Da(da)};n.gotoLine=pc;n.highlightSelectionMatches=function(da){let Ca=[lc,Sb];return da&&Ca.push(Db.of(da)),Ca};n.openSearchPanel=Fc;n.replaceAll=hc;n.replaceNext=yc;n.search=function(da){return da?[bb.of(da),zc]:zc};n.searchKeymap=Nc;n.searchPanelOpen=function(da){var Ca;return null!=(null===(Ca=da.field(pa,!1))||
void 0===Ca?void 0:Ca.panel)};n.selectMatches=Jb;n.selectNextOccurrence=oc;n.selectSelectionMatches=ec;n.setSearchQuery=M}),Sp=va(n=>{function p(R){R=Object.keys(R).join("");let U=/\w/.test(R);return U&&(R=R.replace(/\w/g,"")),`[${U?"\\w":""}${R.replace(/[^\w\s]/g,"\\$&")}]`}function q(R){var U=Object.create(null);let na=Object.create(null);for(let {label:wa}of R)for(U[wa[0]]=!0,R=1;R<wa.length;R++)na[wa[R]]=!0;U=p(U)+p(na)+"*$";return[new RegExp("^"+U),new RegExp(U)]}function u(R){let U=R.map(La=>
"string"==typeof La?{label:La}:La),[na,wa]=U.every(La=>/^\w+$/.test(La.label))?[/\w*$/,/\w+$/]:q(U);return La=>{let eb=La.matchBefore(wa);return eb||La.explicit?{from:eb?eb.from:La.pos,options:U,validFor:na}:null}}function w(R,U){var na;let {source:wa}=R;U=U&&"^"!=wa[0];let La="$"!=wa[wa.length-1];return U||La?new RegExp(`${U?"^":""}(?:${wa})${La?"$":""}`,null!==(na=R.flags)&&void 0!==na?na:R.ignoreCase?"i":""):R}function y(R,U,na,wa){let {main:La}=R.selection,eb=na-La.from,Ya=wa-La.from;return Object.assign(Object.assign({},
R.changeByRange(hb=>{if(hb!=La&&na!=wa&&R.sliceDoc(hb.from+eb,hb.from+Ya)!=R.sliceDoc(na,wa))return{range:hb};let Nb=R.toText(U);return{changes:{from:hb.from+eb,to:wa==La.from?hb.to:hb.from+Ya,insert:Nb},range:sb.EditorSelection.cursor(hb.from+eb+Nb.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}function B(R){if(!Array.isArray(R))return R;let U=db.get(R);return U||db.set(R,U=u(R)),U}function z(R,U){return R?U?R+" "+U:R:U}function E(R,U,na,wa,La,eb){let Ya=R=R.textDirection==Sb.Direction.RTL,
hb=!1,Nb="top",sc;var Ec=U.left-La.left;let Kc=La.right-U.right,ed=wa.right-wa.left;wa=wa.bottom-wa.top;(Ya&&Ec<Math.min(ed,Kc)?Ya=!1:!Ya&&Kc<Math.min(ed,Ec)&&(Ya=!0),ed<=(Ya?Ec:Kc))?(sc=Math.max(La.top,Math.min(na.top,La.bottom-wa))-U.top,Ec=Math.min(400,Ya?Ec:Kc)):(hb=!0,Ec=Math.min(400,(R?U.right:La.right-U.left)-30),La=La.bottom-U.bottom,La>=wa||La>U.top?sc=na.bottom-U.top:(Nb="bottom",sc=U.bottom-na.top));return{style:`${Nb}: ${sc/((U.bottom-U.top)/eb.offsetHeight)}px; max-width: ${Ec/((U.right-
U.left)/eb.offsetWidth)}px`,class:"cm-completionInfo-"+(hb?R?"left-narrow":"right-narrow":Ya?"left":"right")}}function H(R){let U=R.addToOptions.slice();return R.icons&&U.push({render(na){let wa=document.createElement("div");return wa.classList.add("cm-completionIcon"),na.type&&wa.classList.add(...na.type.split(/\s+/g).map(La=>"cm-completionIcon-"+La)),wa.setAttribute("aria-hidden","true"),wa},position:20}),U.push({render(na,wa,La,eb){wa=document.createElement("span");wa.className="cm-completionLabel";
na=na.displayLabel||na.label;var Ya=0;for(La=0;La<eb.length;){let hb=eb[La++],Nb=eb[La++];hb>Ya&&wa.appendChild(document.createTextNode(na.slice(Ya,hb)));Ya=wa.appendChild(document.createElement("span"));Ya.appendChild(document.createTextNode(na.slice(hb,Nb)));Ya.className="cm-completionMatchedText";Ya=Nb}return Ya<na.length&&wa.appendChild(document.createTextNode(na.slice(Ya))),wa},position:50},{render(na){if(!na.detail)return null;let wa=document.createElement("span");return wa.className="cm-completionDetail",
wa.textContent=na.detail,wa},position:80}),U.sort((na,wa)=>na.position-wa.position).map(na=>na.render)}function T(R,U,na){if(R<=na)return{from:0,to:R};if(0>U&&(U=0),U<=R>>1)return R=Math.floor(U/na),{from:R*na,to:(R+1)*na};U=Math.floor((R-U)/na);return{from:R-(U+1)*na,to:R-U*na}}function ca(R){return 100*(R.boost||0)+(R.apply?10:0)+(R.info?5:0)+(R.type?1:0)}function ha(R,U){let na=[],wa=null;var La=Kc=>{na.push(Kc);({section:Kc}=Kc.completion);if(Kc){wa||=[];let ed="string"==typeof Kc?Kc:Kc.name;
wa.some(ud=>ud.name==ed)||wa.push("string"==typeof Kc?{name:ed}:Kc)}},eb=U.facet(Z);for(var Ya of R)if(Ya.hasResult())if(R=Ya.result.getMatch,!1===Ya.result.filter)for(let Kc of Ya.result.options)La(new oc(Kc,Ya.source,R?R(Kc):[],1E9-na.length));else{var hb=U.sliceDoc(Ya.from,Ya.to);let Kc=eb.filterStrict?new M(hb):new N(hb);for(let ed of Ya.result.options)if(hb=Kc.match(ed.label)){let ud=ed.displayLabel?R?R(ed,hb.matched):[]:hb.matched;La(new oc(ed,Ya.source,ud,hb.score+(ed.boost||0)))}}if(wa){U=
Object.create(null);La=0;Ya=(Kc,ed)=>{var ud,he;return(null!==(ud=Kc.rank)&&void 0!==ud?ud:1E9)-(null!==(he=ed.rank)&&void 0!==he?he:1E9)||(Kc.name<ed.name?-1:1)};for(var Nb of wa.sort(Ya))La-=1E5,U[Nb.name]=La;for(var sc of na)({section:Nb}=sc.completion),Nb&&(sc.score+=U["string"==typeof Nb?Nb:Nb.name])}sc=[];Nb=null;let Ec=eb.compareCompletions;for(let Kc of na.sort((ed,ud)=>ud.score-ed.score||Ec(ed.completion,ud.completion)))eb=Kc.completion,!Nb||Nb.label!=eb.label||Nb.detail!=eb.detail||null!=
Nb.type&&null!=eb.type&&Nb.type!=eb.type||Nb.apply!=eb.apply||Nb.boost!=eb.boost?sc.push(Kc):ca(Kc.completion)>ca(Nb)&&(sc[sc.length-1]=Kc),Nb=Kc.completion;return sc}function Da(R,U){if(R==U)return!0;for(let na=0,wa=0;;){for(;na<R.length&&!R[na].hasResult();)na++;for(;wa<U.length&&!U[wa].hasResult();)wa++;let La=na==R.length,eb=wa==U.length;if(La||eb)return La==eb;if(R[na++].result!=U[wa++].result)return!1}}function Fa(R,U){let na={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":R};
return-1<U&&(na["aria-activedescendant"]=R+"-"+U),na}function ua(R,U){if(R.isUserEvent("input.complete")){var na=R.annotation(bb);if(na&&U.activateOnCompletion(na))return 12}return(na=R.isUserEvent("input.type"))&&U.activateOnTyping?5:na?1:R.isUserEvent("delete.backward")?2:R.selection?8:R.docChanged?16:0}function Va(R,U){let na=U.completion.apply||U.completion.label,wa=R.state.field(Fc).active.find(La=>La.source==U.source);return wa instanceof ec?("string"==typeof na?R.dispatch(Object.assign(Object.assign({},
y(R.state,na,wa.from,wa.to)),{annotations:bb.of(U.completion)})):na(R,U.completion,wa.from,wa.to),!0):!1}function Ha(R,U="option"){return na=>{var wa=na.state.field(Fc,!1);if(!wa||!wa.open||wa.open.disabled||Date.now()-wa.open.timestamp<na.state.facet(Z).interactionDelay)return!1;let La=1;var eb;"page"==U&&(eb=Sb.getTooltip(na,wa.open.tooltip))&&(La=Math.max(2,Math.floor(eb.dom.offsetHeight/eb.dom.querySelector("li").offsetHeight)-1));({length:eb}=wa.open.options);wa=-1<wa.open.selected?wa.open.selected+
La*(R?1:-1):R?0:eb-1;return 0>wa?wa="page"==U?0:eb-1:wa>=eb&&(wa="page"==U?eb-1:0),na.dispatch({effects:hc.of(wa)}),!0}}function sa(R,U){return sb.EditorSelection.create(R.filter(na=>na.field==U).map(na=>sb.EditorSelection.range(na.from,na.to)))}function Na(R){let U=mb.parse(R);return(na,wa,La,eb)=>{let {text:Ya,ranges:hb}=U.instantiate(na.state,La),{main:Nb}=na.state.selection;wa={changes:{from:La,to:eb==Nb.from?Nb.to:eb,insert:sb.Text.of(Ya)},scrollIntoView:!0,annotations:wa?[bb.of(wa),sb.Transaction.userEvent.of("input.complete")]:
void 0};if(hb.length&&(wa.selection=sa(hb,0)),hb.some(sc=>0<sc.field))La=new ic(hb,0),La=wa.effects=[Jc.of(La)],void 0===na.state.field(Cc,!1)&&La.push(sb.StateEffect.appendConfig.of([Cc,nd,V,Ca]));na.dispatch(na.state.update(wa))}}function Qa(R){return({state:U,dispatch:na})=>{let wa=U.field(Cc,!1);if(!wa||0>R&&0==wa.active)return!1;let La=wa.active+R,eb=0<R&&!wa.ranges.some(Ya=>Ya.field==La+R);return na(U.update({selection:sa(wa.ranges,La),effects:Jc.of(eb?null:new ic(wa.ranges,La)),scrollIntoView:!0})),
!0}}function kb(R){R=R.replace(/[\]\-\\]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${R}]+`,"ug")}catch{return new RegExp(`[w${R}]`,"g")}}function pb(R,U){return new RegExp(U(R.source),R.unicode?"u":"")}function ib(R,U,na,wa,La){for(let eb=R.iterLines(),Ya=0;!eb.next().done;){({value:R}=eb);let hb;for(U.lastIndex=0;hb=U.exec(R);)if(!wa[hb[0]]&&Ya+hb.index!=La&&(na.push({type:"text",label:hb[0]}),wa[hb[0]]=!0,2E3<=na.length))return;Ya+=R.length+1}}function zb(R,U,na,wa,La){let eb=
1E3<=R.length;var Ya=eb&&U.get(R);if(Ya)return Ya;Ya=[];let hb=Object.create(null);if(R.children){let Nb=0;for(let sc of R.children){if(1E3<=sc.length)for(let Ec of zb(sc,U,na,wa-Nb,La-Nb))hb[Ec.label]||(hb[Ec.label]=!0,Ya.push(Ec));else ib(sc,na,Ya,hb,La-Nb);Nb+=sc.length+1}}else ib(R,na,Ya,hb,La);return eb&&2E3>Ya.length&&U.set(R,Ya),Ya}function gb(R){for(let U=0;16>U;U+=2)if("()[]{}<>\u00ab\u00bb\u00bb\u00ab\uff3b\uff3d\uff5b\uff5d".charCodeAt(U)==R)return"()[]{}<>\u00ab\u00bb\u00bb\u00ab\uff3b\uff3d\uff5b\uff5d".charAt(U+
1);return sb.fromCodePoint(128>R?R:R+1)}function qb(R,U){let na=R.languageDataAt("closeBrackets",R.selection.main.head)[0]||J,wa=na.brackets||J.brackets;for(let La of wa){let eb=gb(sb.codePointAt(La,0));if(U==La)return eb==La?yb(R,La,-1<wa.indexOf(La+La+La),na):$b(R,La,eb,na.before||J.before);if(U==eb&&Lb(R,R.selection.main.from))return pc(R,La,eb)}return null}function Lb(R,U){let na=!1;return R.field(qa).between(0,R.doc.length,wa=>{wa==U&&(na=!0)}),na}function Xb(R,U){R=R.sliceString(U,U+2);return R.slice(0,
sb.codePointSize(sb.codePointAt(R,0)))}function $b(R,U,na,wa){let La=null,eb=R.changeByRange(Ya=>{if(!Ya.empty)return{changes:[{insert:U,from:Ya.from},{insert:na,from:Ya.to}],effects:W.of(Ya.to+U.length),range:sb.EditorSelection.range(Ya.anchor+U.length,Ya.head+U.length)};let hb=Xb(R.doc,Ya.head);return!hb||/\s/.test(hb)||-1<wa.indexOf(hb)?{changes:{insert:U+na,from:Ya.head},effects:W.of(Ya.head+U.length),range:sb.EditorSelection.cursor(Ya.head+U.length)}:{range:La=Ya}});return La?null:R.update(eb,
{scrollIntoView:!0,userEvent:"input.type"})}function pc(R,U,na){let wa=null;U=R.changeByRange(La=>La.empty&&Xb(R.doc,La.head)==na?{changes:{from:La.head,to:La.head+na.length,insert:na},range:sb.EditorSelection.cursor(La.head+na.length)}:wa={range:La});return wa?null:R.update(U,{scrollIntoView:!0,userEvent:"input.type"})}function yb(R,U,na,wa){let La=wa.stringPrefixes||J.stringPrefixes,eb=null;wa=R.changeByRange(Ya=>{if(!Ya.empty)return{changes:[{insert:U,from:Ya.from},{insert:U,from:Ya.to}],effects:W.of(Ya.to+
U.length),range:sb.EditorSelection.range(Ya.anchor+U.length,Ya.head+U.length)};let hb=Ya.head,Nb=Xb(R.doc,hb),sc;if(Nb==U){if(Bb(R,hb))return{changes:{insert:U+U,from:hb},effects:W.of(hb+U.length),range:sb.EditorSelection.cursor(hb+U.length)};if(Lb(R,hb))return Ya=na&&R.sliceDoc(hb,hb+3*U.length)==U+U+U?U+U+U:U,{changes:{from:hb,to:hb+Ya.length,insert:Ya},range:sb.EditorSelection.cursor(hb+Ya.length)}}else{if(na&&R.sliceDoc(hb-2*U.length,hb)==U+U&&-1<(sc=Cb(R,hb-2*U.length,La))&&Bb(R,sc))return{changes:{insert:U+
U+U+U,from:hb},effects:W.of(hb+U.length),range:sb.EditorSelection.cursor(hb+U.length)};if(R.charCategorizer(hb)(Nb)!=sb.CharCategory.Word&&-1<Cb(R,hb,La)&&!Db(R,hb,U,La))return{changes:{insert:U+U,from:hb},effects:W.of(hb+U.length),range:sb.EditorSelection.cursor(hb+U.length)}}return{range:eb=Ya}});return eb?null:R.update(wa,{scrollIntoView:!0,userEvent:"input.type"})}function Bb(R,U){R=lc.syntaxTree(R).resolveInner(U+1);return R.parent&&R.from==U}function Db(R,U,na,wa){var La=lc.syntaxTree(R).resolveInner(U,
-1);let eb=wa.reduce((Ya,hb)=>Math.max(Ya,hb.length),0);for(let Ya=0;5>Ya;Ya++){let hb=R.sliceDoc(La.from,Math.min(La.to,La.from+na.length+eb)),Nb=hb.indexOf(na);if(!Nb||-1<Nb&&-1<wa.indexOf(hb.slice(0,Nb))){for(U=La.firstChild;U&&U.from==La.from&&U.to-U.from>na.length+Nb;){if(R.sliceDoc(U.to-na.length,U.to)==na)return!1;U=U.firstChild}return!0}La=La.to==U&&La.parent;if(!La)break}return!1}function Cb(R,U,na){let wa=R.charCategorizer(U);if(wa(R.sliceDoc(U-1,U))!=sb.CharCategory.Word)return U;for(let La of na)if(na=
U-La.length,R.sliceDoc(na,U)==La&&wa(R.sliceDoc(na-1,na))!=sb.CharCategory.Word)return na;return-1}var sb=hg(),Sb=Gg(),lc=bk(),qc=class{constructor(R,U,na,wa){this.state=R;this.pos=U;this.explicit=na;this.view=wa;this.abortListeners=[];this.abortOnDocChange=!1}tokenBefore(R){let U=lc.syntaxTree(this.state).resolveInner(this.pos,-1);for(;U&&0>R.indexOf(U.name);)U=U.parent;return U?{from:U.from,to:this.pos,text:this.state.sliceDoc(U.from,this.pos),type:U.type}:null}matchBefore(R){var U=this.state.doc.lineAt(this.pos);
let na=Math.max(U.from,this.pos-250);U=U.text.slice(na-U.from,this.pos-U.from);R=U.search(w(R,!1));return 0>R?null:{from:na+R,to:this.pos,text:U.slice(R)}}get aborted(){return null==this.abortListeners}addEventListener(R,U,na){"abort"==R&&this.abortListeners&&(this.abortListeners.push(U),na&&na.onDocChange&&(this.abortOnDocChange=!0))}},oc=class{constructor(R,U,na,wa){this.completion=R;this.source=U;this.match=na;this.score=wa}},bb=sb.Annotation.define(),db=new WeakMap,oa=sb.StateEffect.define(),
ya=sb.StateEffect.define(),N=class{constructor(R){this.pattern=R;this.chars=[];this.folded=[];this.any=[];this.precise=[];this.byWord=[];this.score=0;this.matched=[];for(let na=0;na<R.length;){var U=sb.codePointAt(R,na);let wa=sb.codePointSize(U);this.chars.push(U);U=R.slice(na,na+wa);let La=U.toUpperCase();this.folded.push(sb.codePointAt(La==U?U.toLowerCase():La,0));na+=wa}this.astral=R.length!=this.chars.length}ret(R,U){return this.score=R,this.matched=U,this}match(R){if(0==this.pattern.length)return this.ret(-100,
[]);if(R.length<this.pattern.length)return null;let {chars:U,folded:na,any:wa,precise:La,byWord:eb}=this;if(1==U.length){var Ya=sb.codePointAt(R,0),hb=sb.codePointSize(Ya);R=hb==R.length?0:-100;if(Ya!=U[0])if(Ya==na[0])R+=-200;else return null;return this.ret(R,[0,hb])}Ya=R.indexOf(this.pattern);if(0==Ya)return this.ret(R.length==this.pattern.length?0:-100,[0,this.pattern.length]);hb=U.length;var Nb=0;if(0>Ya){for(let L=0,O=Math.min(R.length,200);L<O&&Nb<hb;){var sc=sb.codePointAt(R,L);sc!=U[Nb]&&
sc!=na[Nb]||(wa[Nb++]=L);L+=sb.codePointSize(sc)}if(Nb<hb)return null}sc=Nb=0;let Ec=!1,Kc=0,ed=-1,ud=-1,he=/[a-z]/.test(R),ze=!0;for(let L=0,O=Math.min(R.length,200),ia=0;L<O&&sc<hb;){let ma=sb.codePointAt(R,L);0>Ya&&(Nb<hb&&ma==U[Nb]&&(La[Nb++]=L),Kc<hb&&(ma==U[Kc]||ma==na[Kc]?(0==Kc&&(ed=L),ud=L+1,Kc++):Kc=0));let Ia,cb=255>ma?48<=ma&&57>=ma||97<=ma&&122>=ma?2:65<=ma&&90>=ma?1:0:(Ia=sb.fromCodePoint(ma))!=Ia.toLowerCase()?1:Ia!=Ia.toUpperCase()?2:0;(!L||1==cb&&he||0==ia&&0!=cb)&&(U[sc]==ma||na[sc]==
ma&&(Ec=!0)?eb[sc++]=L:eb.length&&(ze=!1));ia=cb;L+=sb.codePointSize(ma)}return sc==hb&&0==eb[0]&&ze?this.result(-100+(Ec?-200:0),eb,R):Kc==hb&&0==ed?this.ret(-200-R.length+(ud==R.length?0:-100),[0,ud]):-1<Ya?this.ret(-700-R.length,[Ya,Ya+this.pattern.length]):Kc==hb?this.ret(-900-R.length,[ed,ud]):sc==hb?this.result((Ec?-200:0)+-800+(ze?0:-1100),eb,R):2==U.length?null:this.result((wa[0]?-700:0)+-1300,wa,R)}result(R,U,na){let wa=[],La=0;for(let eb of U)U=eb+(this.astral?sb.codePointSize(sb.codePointAt(na,
eb)):1),La&&wa[La-1]==eb?wa[La-1]=U:(wa[La++]=eb,wa[La++]=U);return this.ret(R-na.length,wa)}},M=class{constructor(R){this.pattern=R;this.matched=[];this.score=0;this.folded=R.toLowerCase()}match(R){if(R.length<this.pattern.length)return null;let U=R.slice(0,this.pattern.length),na=U==this.pattern?0:U.toLowerCase()==this.folded?-200:null;return null==na?null:(this.matched=[0,U.length],this.score=na+(R.length==this.pattern.length?0:-100),this)}},Z=sb.Facet.define({combine(R){return sb.combineConfig(R,
{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:E,filterStrict:!1,compareCompletions:(U,na)=>U.label.localeCompare(na.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(U,na)=>U&&na,closeOnBlur:(U,na)=>U&&na,icons:(U,na)=>U&&na,tooltipClass:(U,na)=>wa=>z(U(wa),na(wa)),optionClass:(U,na)=>
wa=>z(U(wa),na(wa)),addToOptions:(U,na)=>U.concat(na),filterStrict:(U,na)=>U||na})}}),pa=class{constructor(R,U,na){this.view=R;this.stateField=U;this.applyCompletion=na;this.infoDestroy=this.info=null;this.placeInfoReq={read:()=>this.measureInfo(),write:Ya=>this.placeInfo(Ya),key:this};this.space=null;this.currentClass="";na=R.state.field(U);let {options:wa,selected:La}=na.open,eb=R.state.facet(Z);this.optionContent=H(eb);this.optionClass=eb.optionClass;this.tooltipClass=eb.tooltipClass;this.range=
T(wa.length,La,eb.maxRenderedOptions);this.dom=document.createElement("div");this.dom.className="cm-tooltip-autocomplete";this.updateTooltipClass(R.state);this.dom.addEventListener("mousedown",Ya=>{let {options:hb}=R.state.field(U).open;for(let Nb=Ya.target,sc;Nb&&Nb!=this.dom;Nb=Nb.parentNode)if("LI"==Nb.nodeName&&(sc=/-(\d+)$/.exec(Nb.id))&&+sc[1]<hb.length){this.applyCompletion(R,hb[+sc[1]]);Ya.preventDefault();break}});this.dom.addEventListener("focusout",Ya=>{let hb=R.state.field(this.stateField,
!1);hb&&hb.tooltip&&R.state.facet(Z).closeOnBlur&&Ya.relatedTarget!=R.contentDOM&&R.dispatch({effects:ya.of(null)})});this.showOptions(wa,na.id)}mount(){this.updateSel()}showOptions(R,U){this.list&&this.list.remove();this.list=this.dom.appendChild(this.createListBox(R,U,this.range));this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(R){var U;let na=R.state.field(this.stateField),wa=R.startState.field(this.stateField);if(this.updateTooltipClass(R.state),
na!=wa){let {options:La,selected:eb,disabled:Ya}=na.open;wa.open&&wa.open.options==La||(this.range=T(La.length,eb,R.state.facet(Z).maxRenderedOptions),this.showOptions(La,na.id));this.updateSel();Ya!=(null===(U=wa.open)||void 0===U?void 0:U.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!Ya)}}updateTooltipClass(R){R=this.tooltipClass(R);if(R!=this.currentClass){for(let U of this.currentClass.split(" "))U&&this.dom.classList.remove(U);for(let U of R.split(" "))U&&this.dom.classList.add(U);
this.currentClass=R}}positioned(R){this.space=R;this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let R=this.view.state.field(this.stateField);var U=R.open;if((-1<U.selected&&U.selected<this.range.from||U.selected>=this.range.to)&&(this.range=T(U.options.length,U.selected,this.view.state.facet(Z).maxRenderedOptions),this.showOptions(U.options,R.id)),this.updateSelectedOption(U.selected)){this.destroyInfo();let {completion:na}=U.options[U.selected];({info:U}=na);U&&(U="string"==typeof U?
document.createTextNode(U):U(na))&&("then"in U?U.then(wa=>{wa&&this.view.state.field(this.stateField,!1)==R&&this.addInfoPane(wa,na)}).catch(wa=>Sb.logException(this.view.state,wa,"completion info")):this.addInfoPane(U,na))}}addInfoPane(R,U){this.destroyInfo();U=this.info=document.createElement("div");if(U.className="cm-tooltip cm-completionInfo",null!=R.nodeType)U.appendChild(R),this.infoDestroy=null;else{let {dom:na,destroy:wa}=R;U.appendChild(na);this.infoDestroy=wa||null}this.dom.appendChild(U);
this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(R){let U=null;for(let wa=this.list.firstChild,La=this.range.from;wa;wa=wa.nextSibling,La++)"LI"==wa.nodeName&&wa.id?La==R?wa.hasAttribute("aria-selected")||(wa.setAttribute("aria-selected","true"),U=wa):wa.hasAttribute("aria-selected")&&wa.removeAttribute("aria-selected"):La--;if(U){R=this.list;var na=U;let wa=R.getBoundingClientRect();na=na.getBoundingClientRect();let La=wa.height/R.offsetHeight;na.top<wa.top?R.scrollTop-=(wa.top-na.top)/
La:na.bottom>wa.bottom&&(R.scrollTop+=(na.bottom-wa.bottom)/La)}return U}measureInfo(){var R=this.dom.querySelector("[aria-selected]");if(!R||!this.info)return null;let U=this.dom.getBoundingClientRect(),na=this.info.getBoundingClientRect();R=R.getBoundingClientRect();var wa=this.space;wa||(wa=this.dom.ownerDocument.documentElement,wa={left:0,top:0,right:wa.clientWidth,bottom:wa.clientHeight});return R.top>Math.min(wa.bottom,U.bottom)-10||R.bottom<Math.max(wa.top,U.top)+10?null:this.view.state.facet(Z).positionInfo(this.view,
U,R,na,wa,this.dom)}placeInfo(R){this.info&&(R?(R.style&&(this.info.style.cssText=R.style),this.info.className="cm-tooltip cm-completionInfo "+(R.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(R,U,na){let wa=document.createElement("ul");wa.id=U;wa.setAttribute("role","listbox");wa.setAttribute("aria-expanded","true");wa.setAttribute("aria-label",this.view.state.phrase("Completions"));wa.addEventListener("mousedown",hb=>{hb.target==wa&&hb.preventDefault()});let La=null;for(let hb=
na.from;hb<na.to;hb++){let {completion:Nb,match:sc}=R[hb];var {section:eb}=Nb;if(eb){var Ya="string"==typeof eb?eb:eb.name;Ya!=La&&(hb>na.from||0==na.from)&&((La=Ya,"string"!=typeof eb&&eb.header)?wa.appendChild(eb.header(eb)):wa.appendChild(document.createElement("completion-section")).textContent=Ya)}eb=wa.appendChild(document.createElement("li"));eb.id=U+"-"+hb;eb.setAttribute("role","option");(Ya=this.optionClass(Nb))&&(eb.className=Ya);for(let Ec of this.optionContent)(Ya=Ec(Nb,this.view.state,
this.view,sc))&&eb.appendChild(Ya)}return na.from&&wa.classList.add("cm-completionListIncompleteTop"),na.to<R.length&&wa.classList.add("cm-completionListIncompleteBottom"),wa}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}},Ja=class R{constructor(U,na,wa,La,eb,Ya){this.options=U;this.attrs=na;this.tooltip=wa;this.timestamp=La;this.selected=eb;this.disabled=Ya}setSelected(U,na){return U==this.selected||U>=this.options.length?
this:new R(this.options,Fa(na,U),this.tooltip,this.timestamp,U,this.disabled)}static build(U,na,wa,La,eb,Ya){if(La&&!Ya&&U.some(hb=>hb.isPending))return La.setDisabled();Ya=ha(U,na);if(!Ya.length)return La&&U.some(hb=>hb.isPending)?La.setDisabled():null;na=na.facet(Z).selectOnOpen?0:-1;if(La&&La.selected!=na&&-1!=La.selected){let hb=La.options[La.selected].completion;for(let Nb=0;Nb<Ya.length;Nb++)if(Ya[Nb].completion==hb){na=Nb;break}}return new R(Ya,Fa(wa,na),{pos:U.reduce((hb,Nb)=>Nb.hasResult()?
Math.min(hb,Nb.from):hb,1E8),create:Ic,above:eb.aboveCursor},La?La.timestamp:Date.now(),na,!1)}map(U){return new R(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:U.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new R(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}},Sa=class R{constructor(U,na,wa){this.active=U;this.id=na;this.open=wa}static start(){return new R(Pb,"cm-ac-"+Math.floor(2E6*Math.random()).toString(36),
null)}update(U){let {state:na}=U,wa=na.facet(Z),La=(wa.override||na.languageDataAt("autocomplete",na.selection.main.from).map(B)).map(hb=>(this.active.find(Nb=>Nb.source==hb)||new Jb(hb,this.active.some(Nb=>0!=Nb.state)?1:0)).update(U,wa));La.length==this.active.length&&La.every((hb,Nb)=>hb==this.active[Nb])&&(La=this.active);let eb=this.open,Ya=U.effects.some(hb=>hb.is(yc));eb&&U.docChanged&&(eb=eb.map(U.changes));U.selection||La.some(hb=>hb.hasResult()&&U.changes.touchesRange(hb.from,hb.to))||!Da(La,
this.active)||Ya?eb=Ja.build(La,na,this.id,eb,wa,Ya):eb&&eb.disabled&&!La.some(hb=>hb.isPending)&&(eb=null);!eb&&La.every(hb=>!hb.isPending)&&La.some(hb=>hb.hasResult())&&(La=La.map(hb=>hb.hasResult()?new Jb(hb.source,0):hb));for(let hb of U.effects)hb.is(hc)&&(eb=eb&&eb.setSelected(hb.value,this.id));return La==this.active&&eb==this.open?this:new R(La,this.id,eb)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?Za:tb}},Za={"aria-autocomplete":"list"},
tb={},Pb=[],Jb=class R{constructor(U,na,wa=!1){this.source=U;this.state=na;this.explicit=wa}hasResult(){return!1}get isPending(){return 1==this.state}update(U,na){na=ua(U,na);let wa=this;(na&8||na&16&&this.touches(U))&&(wa=new R(wa.source,0));na&4&&0==wa.state&&(wa=new R(this.source,1));wa=wa.updateFor(U,na);for(let La of U.effects)if(La.is(oa))wa=new R(wa.source,1,La.value);else if(La.is(ya))wa=new R(wa.source,0);else if(La.is(yc))for(let eb of La.value)eb.source==wa.source&&(wa=eb);return wa}updateFor(U,
na){return this.map(U.changes)}map(U){return this}touches(U){return U.changes.touchesRange(U.state.selection.main.from)}},ec=class R extends Jb{constructor(U,na,wa,La,eb,Ya){super(U,3,na);this.limit=wa;this.result=La;this.from=eb;this.to=Ya}hasResult(){return!0}updateFor(U,na){var wa;if(!(na&3))return this.map(U.changes);let La=this.result;La.map&&!U.changes.empty&&(La=La.map(La,U.changes));let eb=U.changes.mapPos(this.from),Ya=U.changes.mapPos(this.to,1),hb=U.state.selection.main.from;if(hb>Ya||
!La||na&2&&(U.startState.selection.main.from==this.from||hb<this.limit))return new Jb(this.source,na&4?1:0);na=U.changes.mapPos(this.limit);var Nb=La.validFor;var sc=U.state;if(Nb){var Ec=sc.sliceDoc(eb,Ya);Nb="function"==typeof Nb?Nb(Ec,eb,Ya,sc):w(Nb,!0).test(Ec)}else Nb=!1;return Nb?new R(this.source,this.explicit,na,La,eb,Ya):La.update&&(La=La.update(La,eb,Ya,new qc(U.state,hb,!1)))?new R(this.source,this.explicit,na,La,La.from,null!==(wa=La.to)&&void 0!==wa?wa:U.state.selection.main.from):new Jb(this.source,
1,this.explicit)}map(U){return U.empty?this:(this.result.map?this.result.map(this.result,U):this.result)?new R(this.source,this.explicit,U.mapPos(this.limit),this.result,U.mapPos(this.from),U.mapPos(this.to,1)):new Jb(this.source,0)}touches(U){return U.changes.touchesRange(this.from,this.to)}},yc=sb.StateEffect.define({map(R,U){return R.map(na=>na.map(U))}}),hc=sb.StateEffect.define(),Fc=sb.StateField.define({create(){return Sa.start()},update(R,U){return R.update(U)},provide:R=>[Sb.showTooltip.from(R,
U=>U.tooltip),Sb.EditorView.contentAttributes.from(R,U=>U.attrs)]}),Ic=function(R,U){return na=>new pa(na,R,U)}(Fc,Va),Nc=R=>{let U=R.state.field(Fc,!1);return R.state.readOnly||!U||!U.open||0>U.open.selected||U.open.disabled||Date.now()-U.open.timestamp<R.state.facet(Z).interactionDelay?!1:Va(R,U.open.options[U.open.selected])},Dc=R=>R.state.field(Fc,!1)?(R.dispatch({effects:oa.of(!0)}),!0):!1,cd=R=>{let U=R.state.field(Fc,!1);return U&&U.active.some(na=>0!=na.state)?(R.dispatch({effects:ya.of(null)}),
!0):!1},jd=class{constructor(R,U){this.active=R;this.context=U;this.time=Date.now();this.updates=[];this.done=void 0}},wc=Sb.ViewPlugin.fromClass(class{constructor(R){this.view=R;this.debounceUpdate=-1;this.running=[];this.debounceAccept=-1;this.pendingStart=!1;this.composing=0;for(let U of R.state.field(Fc).active)U.isPending&&this.startQuery(U)}update(R){let U=R.state.field(Fc),na=R.state.facet(Z);if(R.selectionSet||R.docChanged||R.startState.field(Fc)!=U){var wa=R.transactions.some(La=>{let eb=
ua(La,na);return eb&8||(La.selection||La.docChanged)&&!(eb&3)});for(let La=0;La<this.running.length;La++){let eb=this.running[La];if(wa||eb.context.abortOnDocChange&&R.docChanged||50<eb.updates.length+R.transactions.length&&1E3<Date.now()-eb.time){for(let Ya of eb.context.abortListeners)try{Ya()}catch(hb){Sb.logException(this.view.state,hb)}eb.context.abortListeners=null;this.running.splice(La--,1)}else eb.updates.push(...R.transactions)}-1<this.debounceUpdate&&clearTimeout(this.debounceUpdate);R.transactions.some(La=>
La.effects.some(eb=>eb.is(oa)))&&(this.pendingStart=!0);wa=this.pendingStart?50:na.activateOnTypingDelay;if(this.debounceUpdate=U.active.some(La=>La.isPending&&!this.running.some(eb=>eb.active.source==La.source))?setTimeout(()=>this.startUpdate(),wa):-1,0!=this.composing)for(let La of R.transactions)La.isUserEvent("input.type")?this.composing=2:2==this.composing&&La.selection&&(this.composing=3)}}startUpdate(){this.debounceUpdate=-1;this.pendingStart=!1;var {state:R}=this.view;R=R.field(Fc);for(let U of R.active)U.isPending&&
!this.running.some(na=>na.active.source==U.source)&&this.startQuery(U);this.running.length&&R.open&&R.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Z).updateSyncTime))}startQuery(R){var {state:U}=this.view;U=new qc(U,U.selection.main.from,R.explicit,this.view);let na=new jd(R,U);this.running.push(na);Promise.resolve(R.source(U)).then(wa=>{na.context.aborted||(na.done=wa||null,this.scheduleAccept())},wa=>{this.view.dispatch({effects:ya.of(null)});Sb.logException(this.view.state,
wa)})}scheduleAccept(){this.running.every(R=>void 0!==R.done)?this.accept():0>this.debounceAccept&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Z).updateSyncTime))}accept(){var R;-1<this.debounceAccept&&clearTimeout(this.debounceAccept);this.debounceAccept=-1;let U=[],na=this.view.state.facet(Z),wa=this.view.state.field(Fc);for(let eb=0;eb<this.running.length;eb++){let Ya=this.running[eb];if(void 0!==Ya.done){if(this.running.splice(eb--,1),Ya.done){var La=(Ya.updates.length?
Ya.updates[0].startState:this.view.state).selection.main.from;let hb=new ec(Ya.active.source,Ya.active.explicit,Math.min(La,Ya.done.from+(Ya.active.explicit?0:1)),Ya.done,Ya.done.from,null!==(R=Ya.done.to)&&void 0!==R?R:La);for(let Nb of Ya.updates)hb=hb.update(Nb,na);if(hb.hasResult()){U.push(hb);continue}}if((La=wa.active.find(hb=>hb.source==Ya.active.source))&&La.isPending)if(null==Ya.done){La=new Jb(Ya.active.source,0);for(let hb of Ya.updates)La=La.update(hb,na);La.isPending||U.push(La)}else this.startQuery(La)}}(U.length||
wa.open&&wa.open.disabled)&&this.view.dispatch({effects:yc.of(U)})}},{eventHandlers:{blur(R){var U=this.view.state.field(Fc,!1);U&&U.tooltip&&this.view.state.facet(Z).closeOnBlur&&((U=U.open&&Sb.getTooltip(this.view,U.open.tooltip))&&U.dom.contains(R.relatedTarget)||setTimeout(()=>this.view.dispatch({effects:ya.of(null)}),10))},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout(()=>this.view.dispatch({effects:oa.of(!1)}),20);this.composing=0}}}),zc="object"==typeof navigator&&
/Win/.test(navigator.platform),da=sb.Prec.highest(Sb.EditorView.domEventHandlers({keydown(R,U){var na=U.state.field(Fc,!1);if(!na||!na.open||na.open.disabled||0>na.open.selected||1<R.key.length||R.ctrlKey&&(!zc||!R.altKey)||R.metaKey)return!1;let wa=na.open.options[na.open.selected];na=na.active.find(La=>La.source==wa.source);na=wa.completion.commitCharacters||na.result.commitCharacters;return na&&-1<na.indexOf(R.key)&&Va(U,wa),!1}})),Ca=Sb.EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",
whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",
color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\u00b7\u00b7\u00b7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",
width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,
height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25cb'"}},
".cm-completionIcon-interface":{"&:after":{content:"'\u25cc'"}},".cm-completionIcon-variable":{"&:after":{content:"'\ud835\udc65'"}},".cm-completionIcon-constant":{"&:after":{content:"'\ud835\udc36'"}},".cm-completionIcon-type":{"&:after":{content:"'\ud835\udc61'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222a'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25a1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\ud83d\udd11\ufe0e'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25a2'"}},
".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Ea=class{constructor(R,U,na,wa){this.field=R;this.line=U;this.from=na;this.to=wa}},Ta=class R{constructor(U,na,wa){this.field=U;this.from=na;this.to=wa}map(U){let na=U.mapPos(this.from,-1,sb.MapMode.TrackDel);U=U.mapPos(this.to,1,sb.MapMode.TrackDel);return null==na||null==U?null:new R(this.field,na,U)}},mb=class R{constructor(U,na){this.lines=U;this.fieldPositions=na}instantiate(U,na){let wa=[],La=[na];
var eb=U.doc.lineAt(na);eb=/^\s*/.exec(eb.text)[0];for(let Ya of this.lines){if(wa.length){let hb=eb,Nb=/^\t*/.exec(Ya)[0].length;for(let sc=0;sc<Nb;sc++)hb+=U.facet(lc.indentUnit);La.push(na+hb.length-Nb);Ya=hb+Ya.slice(Nb)}wa.push(Ya);na+=Ya.length+1}U=this.fieldPositions.map(Ya=>new Ta(Ya.field,La[Ya.line]+Ya.from,La[Ya.line]+Ya.to));return{text:wa,ranges:U}}static parse(U){let na=[],wa=[],La=[];for(let Ya of U.split(/\r\n?|\n/)){for(;U=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(Ya);){let hb=
U[1]?+U[1]:null,Nb=U[2]||U[3]||"";var eb=-1;let sc=Nb.replace(/\\[{}]/g,Ec=>Ec[1]);for(let Ec=0;Ec<na.length;Ec++)(null!=hb?na[Ec].seq==hb:sc&&na[Ec].name==sc)&&(eb=Ec);if(0>eb){for(eb=0;eb<na.length&&(null==hb||null!=na[eb].seq&&na[eb].seq<hb);)eb++;na.splice(eb,0,{seq:hb,name:sc});for(let Ec of La)Ec.field>=eb&&Ec.field++}La.push(new Ea(eb,wa.length,U.index,U.index+sc.length));Ya=Ya.slice(0,U.index)+Nb+Ya.slice(U.index+U[0].length)}Ya=Ya.replace(/\\([{}])/g,(hb,Nb,sc)=>{for(let Ec of La)Ec.line==
wa.length&&Ec.from>sc&&(Ec.from--,Ec.to--);return Nb});wa.push(Ya)}return new R(wa,La)}},Fb=Sb.Decoration.widget({widget:new class extends Sb.WidgetType{toDOM(){let R=document.createElement("span");return R.className="cm-snippetFieldPosition",R}ignoreEvent(){return!1}}}),Hb=Sb.Decoration.mark({class:"cm-snippetField"}),ic=class R{constructor(U,na){this.ranges=U;this.active=na;this.deco=Sb.Decoration.set(U.map(wa=>(wa.from==wa.to?Fb:Hb).range(wa.from,wa.to)))}map(U){let na=[];for(let wa of this.ranges){let La=
wa.map(U);if(!La)return null;na.push(La)}return new R(na,this.active)}selectionInsideField(U){return U.ranges.every(na=>this.ranges.some(wa=>wa.field==this.active&&wa.from<=na.from&&wa.to>=na.to))}},Jc=sb.StateEffect.define({map(R,U){return R&&R.map(U)}}),$c=sb.StateEffect.define(),Cc=sb.StateField.define({create(){return null},update(R,U){for(let na of U.effects){if(na.is(Jc))return na.value;if(na.is($c)&&R)return new ic(R.ranges,na.value)}return R&&U.docChanged&&(R=R.map(U.changes)),R&&U.selection&&
!R.selectionInsideField(U.selection)&&(R=null),R},provide:R=>Sb.EditorView.decorations.from(R,U=>U?U.deco:Sb.Decoration.none)}),Tc=({state:R,dispatch:U})=>R.field(Cc,!1)?(U(R.update({effects:Jc.of(null)})),!0):!1,Vc=Qa(1),qd=Qa(-1),wd=[{key:"Tab",run:Vc,shift:qd},{key:"Escape",run:Tc}],Yc=sb.Facet.define({combine(R){return R.length?R[0]:wd}}),nd=sb.Prec.highest(Sb.keymap.compute([Yc],R=>R.facet(Yc))),V=Sb.EditorView.domEventHandlers({mousedown(R,U){let na=U.state.field(Cc,!1),wa;if(!na||null==(wa=
U.posAtCoords({x:R.clientX,y:R.clientY})))return!1;let La=na.ranges.find(eb=>eb.from<=wa&&eb.to>=wa);return La&&La.field!=na.active?(U.dispatch({selection:sa(na.ranges,La.field),effects:Jc.of(na.ranges.some(eb=>eb.field>La.field)?new ic(na.ranges,La.field):null),scrollIntoView:!0}),!0):!1}}),A=Object.create(null),J={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},W=sb.StateEffect.define({map(R,U){return U.mapPos(R,-1,sb.MapMode.TrackAfter)??void 0}}),ea=new class extends sb.RangeValue{};
ea.startSide=1;ea.endSide=-1;var qa=sb.StateField.define({create(){return sb.RangeSet.empty},update(R,U){if(R=R.map(U.changes),U.selection){let na=U.state.doc.lineAt(U.selection.main.head);R=R.update({filter:wa=>wa>=na.from&&wa<=na.to})}for(let na of U.effects)na.is(W)&&(R=R.update({add:[ea.range(na.value,na.value+1)]}));return R}}),za="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),Wa=Sb.EditorView.inputHandler.of((R,U,na,wa)=>{if((za?R.composing:R.compositionStarted)||R.state.readOnly)return!1;
let La=R.state.selection.main;return 2<wa.length||2==wa.length&&1==sb.codePointSize(sb.codePointAt(wa,0))||U!=La.from||na!=La.to?!1:(U=qb(R.state,wa))?(R.dispatch(U),!0):!1}),fb=({state:R,dispatch:U})=>{if(R.readOnly)return!1;let na=(R.languageDataAt("closeBrackets",R.selection.main.head)[0]||J).brackets||J.brackets,wa=null,La=R.changeByRange(eb=>{if(eb.empty){var Ya=eb.head;Ya=R.doc.sliceString(Ya-2,Ya);Ya=sb.codePointSize(sb.codePointAt(Ya,0))==Ya.length?Ya:Ya.slice(1);for(let hb of na)if(hb==Ya&&
Xb(R.doc,eb.head)==gb(sb.codePointAt(hb,0)))return{changes:{from:eb.head-hb.length,to:eb.head+hb.length},range:sb.EditorSelection.cursor(eb.head-hb.length)}}return{range:wa=eb}});return wa||U(R.update(La,{scrollIntoView:!0,userEvent:"delete.backward"})),!wa},Ab=[{key:"Backspace",run:fb}],Ib=[{key:"Ctrl-Space",run:Dc},{mac:"Alt-`",run:Dc},{key:"Escape",run:cd},{key:"ArrowDown",run:Ha(!0)},{key:"ArrowUp",run:Ha(!1)},{key:"PageDown",run:Ha(!0,"page")},{key:"PageUp",run:Ha(!1,"page")},{key:"Enter",run:Nc}],
uc=sb.Prec.highest(Sb.keymap.computeN([Z],R=>R.facet(Z).defaultKeymap?[Ib]:[])),xc=new WeakMap;n.CompletionContext=qc;n.acceptCompletion=Nc;n.autocompletion=function(R={}){return[da,Fc,Z.of(R),wc,uc,Ca]};n.clearSnippet=Tc;n.closeBrackets=function(){return[Wa,qa]};n.closeBracketsKeymap=Ab;n.closeCompletion=cd;n.completeAnyWord=R=>{let U=R.state.languageDataAt("wordChars",R.pos).join(""),na=kb(U);var wa=R.matchBefore(pb(na,La=>La+"$"));if(!wa&&!R.explicit)return null;wa=wa?wa.from:R.pos;R=zb(R.state.doc,
A[U]||(A[U]=new WeakMap),na,5E4,wa);return{from:wa,options:R,validFor:pb(na,La=>"^"+La)}};n.completeFromList=u;n.completionKeymap=Ib;n.completionStatus=function(R){return(R=R.field(Fc,!1))&&R.active.some(U=>U.isPending)?"pending":R&&R.active.some(U=>0!=U.state)?"active":null};n.currentCompletions=function(R){var U;R=null===(U=R.field(Fc,!1))||void 0===U?void 0:U.open;if(!R||R.disabled)return[];U=xc.get(R.options);return U||xc.set(R.options,U=R.options.map(na=>na.completion)),U};n.deleteBracketPair=
fb;n.hasNextSnippetField=function(R){let U=R.field(Cc,!1);return!(!U||!U.ranges.some(na=>na.field==U.active+1))};n.hasPrevSnippetField=function(R){R=R.field(Cc,!1);return!!(R&&0<R.active)};n.ifIn=function(R,U){return na=>{for(let wa=lc.syntaxTree(na.state).resolveInner(na.pos,-1);wa;wa=wa.parent){if(-1<R.indexOf(wa.name))return U(na);if(wa.type.isTop)break}return null}};n.ifNotIn=function(R,U){return na=>{for(let wa=lc.syntaxTree(na.state).resolveInner(na.pos,-1);wa;wa=wa.parent){if(-1<R.indexOf(wa.name))return null;
if(wa.type.isTop)break}return U(na)}};n.insertBracket=qb;n.insertCompletionText=y;n.moveCompletionSelection=Ha;n.nextSnippetField=Vc;n.pickedCompletion=bb;n.prevSnippetField=qd;n.selectedCompletion=function(R){var U;return(R=null===(U=R.field(Fc,!1))||void 0===U?void 0:U.open)&&!R.disabled&&0<=R.selected?R.options[R.selected].completion:null};n.selectedCompletionIndex=function(R){var U;return(R=null===(U=R.field(Fc,!1))||void 0===U?void 0:U.open)&&!R.disabled&&0<=R.selected?R.selected:null};n.setSelectedCompletion=
function(R){return hc.of(R)};n.snippet=Na;n.snippetCompletion=function(R,U){return Object.assign(Object.assign({},U),{apply:Na(R)})};n.snippetKeymap=Yc;n.startCompletion=Dc}),Tp=va(n=>{function p(oa,ya=null,N=0){let M=null;return oa.between(N,1E9,(Z,pa,{spec:Ja})=>{if(!(ya&&0>Ja.diagnostics.indexOf(ya)))if(M){if(0>Ja.diagnostics.indexOf(M.diagnostic))return!1;M=new Ha(M.from,pa,M.diagnostic)}else M=new Ha(Z,pa,ya||Ja.diagnostics[0])}),M}function q(oa,ya){var N=ya.pos;let M=ya.end||N;N=oa.state.facet($b).hideOn(oa,
N,M);if(null!=N)return N;ya=oa.startState.doc.lineAt(ya.pos);return!(!oa.effects.some(Z=>Z.is(Na))&&!oa.changes.touchesRange(ya.from,Math.max(ya.to,M)))}function u(oa,ya){return oa.field(pb,!1)?ya:ya.concat(ua.StateEffect.appendConfig.of(bb))}function w(oa,ya){return{effects:u(oa,[Na.of(ya)])}}function y(oa,ya){return Va("ul",{class:"cm-tooltip-lint"},ya.map(N=>E(oa,N,!1)))}function B(oa,ya,N){let M=[],Z=-1;for(let pa of oa)pa.then(Ja=>{M.push(Ja);clearTimeout(Z);M.length==oa.length?ya(M):Z=setTimeout(()=>
ya(M),200)},N)}function z(oa){let ya=[];if(oa)a:for(let {name:N}of oa){for(oa=0;oa<N.length;oa++){let M=N[oa];if(/[a-zA-Z]/.test(M)&&!ya.some(Z=>Z.toLowerCase()==M.toLowerCase())){ya.push(M);continue a}}ya.push("")}return ya}function E(oa,ya,N){var M;let Z=N?z(ya.actions):[];return Va("li",{class:"cm-diagnostic cm-diagnostic-"+ya.severity},Va("span",{class:"cm-diagnosticText"},ya.renderMessage?ya.renderMessage(oa):ya.message),null===(M=ya.actions)||void 0===M?void 0:M.map((pa,Ja)=>{let Sa=!1,Za=ec=>
{(ec.preventDefault(),Sa)||(Sa=!0,(ec=p(oa.state.field(pb).diagnostics,ya))&&pa.apply(oa,ec.from,ec.to))},{name:tb}=pa,Pb=Z[Ja]?tb.indexOf(Z[Ja]):-1,Jb=0>Pb?tb:[tb.slice(0,Pb),Va("u",tb.slice(Pb,Pb+1)),tb.slice(Pb+1)];return Va("button",{type:"button",class:"cm-diagnosticAction",onclick:Za,onmousedown:Za,"aria-label":` Action: ${tb}${0>Pb?"":` (access key "${Z[Ja]})"`}.`},Jb)}),ya.source&&Va("div",{class:"cm-diagnosticSource"},ya.source))}function H(oa,ya='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${ya}>${encodeURIComponent(oa)}</svg>')`}
function T(oa){return H(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${oa}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}function ca(oa){let ya="hint",N=1;for(let M of oa)oa=M.severity,oa="error"==oa?4:"warning"==oa?3:"info"==oa?2:1,oa>N&&(N=oa,ya=M.severity);return ya}function ha(oa,ya){let N=M=>{let Z=ya.getBoundingClientRect();if(!(M.clientX>Z.left-10&&M.clientX<Z.right+10&&M.clientY>Z.top-10&&M.clientY<Z.bottom+10)){for(M=M.target;M;M=M.parentNode)if(1==M.nodeType&&M.classList.contains("cm-tooltip-lint"))return;
window.removeEventListener("mousemove",N);oa.state.field(qc)&&oa.dispatch({effects:lc.of(null)})}};window.addEventListener("mousemove",N)}function Da(oa,ya,N){function M(){let Ja=oa.elementAtHeight(ya.getBoundingClientRect().top+5-oa.documentTop);oa.coordsAtPos(Ja.from)&&oa.dispatch({effects:lc.of({pos:Ja.from,above:!1,clip:!1,create(){return{dom:y(oa,N),getCoords:()=>ya.getBoundingClientRect()}}})});ya.onmouseout=ya.onmousemove=null;ha(oa,ya)}let {hoverTime:Z}=oa.state.facet(db),pa=setTimeout(M,
Z);ya.onmouseout=()=>{clearTimeout(pa);ya.onmouseout=ya.onmousemove=null};ya.onmousemove=()=>{clearTimeout(pa);pa=setTimeout(M,Z)}}var Fa=Gg(),ua=hg(),Va=bm(),Ha=class{constructor(oa,ya,N){this.from=oa;this.to=ya;this.diagnostic=N}},sa=class oa{constructor(ya,N,M){this.diagnostics=ya;this.panel=N;this.selected=M}static init(ya,N,M){var Z=M.facet($b).markerFilter;Z&&(ya=Z(ya,M));ya=ya.slice().sort((tb,Pb)=>tb.from-Pb.from||tb.to-Pb.to);Z=new ua.RangeSetBuilder;let pa=[];var Ja=0;for(let tb=0;;){var Sa=
tb==ya.length?null:ya[tb];if(!Sa&&!pa.length)break;var Za=void 0;let Pb;for(pa.length?(Za=Ja,Pb=pa.reduce((Jb,ec)=>Math.min(Jb,ec.to),Sa&&Sa.from>Za?Sa.from:1E8)):(Za=Sa.from,Pb=Sa.to,pa.push(Sa),tb++);tb<ya.length;)if(Ja=ya[tb],Ja.from==Za&&(Ja.to>Ja.from||Ja.to==Za))pa.push(Ja),tb++,Pb=Math.min(Ja.to,Pb);else{Pb=Math.min(Ja.from,Pb);break}Ja=ca(pa);pa.some(Jb=>Jb.from==Jb.to||Jb.from==Jb.to-1&&M.doc.lineAt(Jb.from).to==Jb.from)?Z.add(Za,Za,Fa.Decoration.widget({widget:new pc(Ja),diagnostics:pa.slice()})):
(Sa=pa.reduce((Jb,ec)=>ec.markClass?Jb+" "+ec.markClass:Jb,""),Z.add(Za,Pb,Fa.Decoration.mark({class:"cm-lintRange cm-lintRange-"+Ja+Sa,diagnostics:pa.slice(),inclusiveEnd:pa.some(Jb=>Jb.to>Pb)})));Ja=Pb;for(Sa=0;Sa<pa.length;Sa++)pa[Sa].to<=Ja&&pa.splice(Sa--,1)}Za=Z.finish();return new oa(Za,N,p(Za))}},Na=ua.StateEffect.define(),Qa=ua.StateEffect.define(),kb=ua.StateEffect.define(),pb=ua.StateField.define({create(){return new sa(Fa.Decoration.none,null,null)},update(oa,ya){if(ya.docChanged&&oa.diagnostics.size){let M=
oa.diagnostics.map(ya.changes);var N=null;let Z=oa.panel;oa.selected&&(N=ya.changes.mapPos(oa.selected.from,1),N=p(M,oa.selected.diagnostic,N)||p(M,null,N));!M.size&&Z&&ya.state.facet($b).autoPanel&&(Z=null);oa=new sa(M,Z,N)}for(let M of ya.effects)M.is(Na)?(oa=ya.state.facet($b).autoPanel?M.value.length?Bb.open:null:oa.panel,oa=sa.init(M.value,oa,ya.state)):M.is(Qa)?oa=new sa(oa.diagnostics,M.value?Bb.open:null,oa.selected):M.is(kb)&&(oa=new sa(oa.diagnostics,oa.panel,M.value));return oa},provide:oa=>
[Fa.showPanel.from(oa,ya=>ya.panel),Fa.EditorView.decorations.from(oa,ya=>ya.diagnostics)]}),ib=Fa.Decoration.mark({class:"cm-lintRange cm-lintRange-active"}),zb=oa=>{let ya=oa.state.field(pb,!1);ya&&ya.panel||oa.dispatch({effects:u(oa.state,[Qa.of(!0)])});oa=Fa.getPanel(oa,Bb.open);return oa&&oa.dom.querySelector(".cm-panel-lint ul").focus(),!0},gb=oa=>{let ya=oa.state.field(pb,!1);return ya&&ya.panel?(oa.dispatch({effects:Qa.of(!1)}),!0):!1},qb=oa=>{let ya=oa.state.field(pb,!1);if(!ya)return!1;
let N=oa.state.selection.main,M=ya.diagnostics.iter(N.to+1);return!M.value&&(M=ya.diagnostics.iter(0),!M.value||M.from==N.from&&M.to==N.to)?!1:(oa.dispatch({selection:{anchor:M.from,head:M.to},scrollIntoView:!0}),!0)},Lb=[{key:"Mod-Shift-m",run:zb,preventDefault:!0},{key:"F8",run:qb}],Xb=Fa.ViewPlugin.fromClass(class{constructor(oa){this.view=oa;this.timeout=-1;this.set=!0;({delay:oa}=oa.state.facet($b));this.lintTime=Date.now()+oa;this.run=this.run.bind(this);this.timeout=setTimeout(this.run,oa)}run(){clearTimeout(this.timeout);
var oa=Date.now();if(oa<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-oa);else{this.set=!1;let {state:ya}=this.view;({sources:oa}=ya.facet($b));oa.length&&B(oa.map(N=>Promise.resolve(N(this.view))),N=>{this.view.state.doc==ya.doc&&this.view.dispatch(w(this.view.state,N.reduce((M,Z)=>M.concat(Z))))},N=>{Fa.logException(this.view.state,N)})}}update(oa){let ya=oa.state.facet($b);(oa.docChanged||ya!=oa.startState.facet($b)||ya.needsRefresh&&ya.needsRefresh(oa))&&(this.lintTime=Date.now()+
ya.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,ya.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),$b=ua.Facet.define({combine(oa){return Object.assign({sources:oa.map(ya=>ya.source).filter(ya=>null!=ya)},ua.combineConfig(oa.map(ya=>ya.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(ya,N)=>ya?N?M=>ya(M)||N(M):ya:N}))}}),pc=class extends Fa.WidgetType{constructor(oa){super();
this.sev=oa}eq(oa){return oa.sev==this.sev}toDOM(){return Va("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}},yb=class{constructor(oa,ya){this.diagnostic=ya;this.id="item_"+Math.floor(4294967295*Math.random()).toString(16);this.dom=E(oa,ya,!0);this.dom.id=this.id;this.dom.setAttribute("role","option")}},Bb=class oa{constructor(ya){this.view=ya;this.items=[];this.list=Va("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:N=>{if(27==N.keyCode)gb(this.view),
this.view.focus();else if(38==N.keyCode||33==N.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==N.keyCode||34==N.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==N.keyCode)this.moveSelection(0);else if(35==N.keyCode)this.moveSelection(this.items.length-1);else if(13==N.keyCode)this.view.focus();else if(65<=N.keyCode&&90>=N.keyCode&&0<=this.selectedIndex){let {diagnostic:M}=this.items[this.selectedIndex],Z=z(M.actions);
for(let pa=0;pa<Z.length;pa++)if(Z[pa].toUpperCase().charCodeAt(0)==N.keyCode){let Ja=p(this.view.state.field(pb).diagnostics,M);Ja&&M.actions[pa].apply(ya,Ja.from,Ja.to)}}else return;N.preventDefault()},onclick:N=>{for(let M=0;M<this.items.length;M++)this.items[M].dom.contains(N.target)&&this.moveSelection(M)}});this.dom=Va("div",{class:"cm-panel-lint"},this.list,Va("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>gb(this.view)},"\u00d7"));this.update()}get selectedIndex(){let ya=
this.view.state.field(pb).selected;if(!ya)return-1;for(let N=0;N<this.items.length;N++)if(this.items[N].diagnostic==ya.diagnostic)return N;return-1}update(){let {diagnostics:ya,selected:N}=this.view.state.field(pb),M=0,Z=!1,pa=null,Ja=new Set;for(ya.between(0,this.view.state.doc.length,(Sa,Za,{spec:tb})=>{for(let Pb of tb.diagnostics){if(Ja.has(Pb))continue;Ja.add(Pb);Sa=-1;let Jb;for(Za=M;Za<this.items.length;Za++)if(this.items[Za].diagnostic==Pb){Sa=Za;break}0>Sa?(Jb=new yb(this.view,Pb),this.items.splice(M,
0,Jb),Z=!0):(Jb=this.items[Sa],Sa>M&&(this.items.splice(M,Sa-M),Z=!0));N&&Jb.diagnostic==N.diagnostic?Jb.dom.hasAttribute("aria-selected")||(Jb.dom.setAttribute("aria-selected","true"),pa=Jb):Jb.dom.hasAttribute("aria-selected")&&Jb.dom.removeAttribute("aria-selected");M++}});M<this.items.length&&!(1==this.items.length&&0>this.items[0].diagnostic.from);)Z=!0,this.items.pop();0==this.items.length&&(this.items.push(new yb(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),
Z=!0);pa?(this.list.setAttribute("aria-activedescendant",pa.id),this.view.requestMeasure({key:this,read:()=>({sel:pa.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:Sa,panel:Za})=>{let tb=Za.height/this.list.offsetHeight;Sa.top<Za.top?this.list.scrollTop-=(Za.top-Sa.top)/tb:Sa.bottom>Za.bottom&&(this.list.scrollTop+=(Sa.bottom-Za.bottom)/tb)}})):0>this.selectedIndex&&this.list.removeAttribute("aria-activedescendant");Z&&this.sync()}sync(){function ya(){let M=N;N=
M.nextSibling;M.remove()}let N=this.list.firstChild;for(let M of this.items)if(M.dom.parentNode==this.list){for(;N!=M.dom;)ya();N=M.dom.nextSibling}else this.list.insertBefore(M.dom,N);for(;N;)ya()}moveSelection(ya){if(!(0>this.selectedIndex)){var N=this.view.state.field(pb);(ya=p(N.diagnostics,this.items[ya].diagnostic))&&this.view.dispatch({selection:{anchor:ya.from,head:ya.to},scrollIntoView:!0,effects:kb.of(ya)})}}static open(ya){return new oa(ya)}},Db=Fa.EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",
marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",
backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:T("#d11")},".cm-lintRange-warning":{backgroundImage:T("orange")},".cm-lintRange-info":{backgroundImage:T("#999")},".cm-lintRange-hint":{backgroundImage:T("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",
borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},
"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),Cb=class extends Fa.GutterMarker{constructor(oa){super();this.diagnostics=oa;this.severity=ca(oa)}toDOM(oa){let ya=document.createElement("div");ya.className="cm-lint-marker cm-lint-marker-"+this.severity;let N=this.diagnostics,M=oa.state.facet(db).tooltipFilter;return M&&(N=M(N,oa.state)),N.length&&(ya.onmouseover=()=>
Da(oa,ya,N)),ya}},sb=Fa.gutter({class:"cm-gutter-lint",markers:oa=>oa.state.field(Sb),widgetMarker:(oa,ya,N)=>{let M=[];return oa.state.field(Sb).between(N.from,N.to,(Z,pa,Ja)=>{Z>N.from&&Z<N.to&&M.push(...Ja.diagnostics)}),M.length?new Cb(M):null}}),Sb=ua.StateField.define({create(){return ua.RangeSet.empty},update(oa,ya){oa=oa.map(ya.changes);let N=ya.state.facet(db).markerFilter;for(let pa of ya.effects)if(pa.is(Na)){var M=pa.value;N&&(M=N(M||[],ya.state));oa=ya.state.doc;var Z=M.slice(0);M=Object.create(null);
for(let Ja of Z)Z=oa.lineAt(Ja.from),(M[Z.from]||(M[Z.from]=[])).push(Ja);oa=[];for(let Ja in M)oa.push((new Cb(M[Ja])).range(+Ja));oa=ua.RangeSet.of(oa,!0)}return oa}}),lc=ua.StateEffect.define(),qc=ua.StateField.define({create(){return null},update(oa,ya){return oa&&ya.docChanged&&(oa=q(ya,oa)?null:Object.assign(Object.assign({},oa),{pos:ya.changes.mapPos(oa.pos)})),ya.effects.reduce((N,M)=>M.is(lc)?M.value:N,oa)},provide:oa=>Fa.showTooltip.from(oa)}),oc=Fa.EditorView.baseTheme({".cm-gutter-lint":{width:"1.4em",
"& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:H('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:H('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:H('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),bb=[pb,Fa.EditorView.decorations.compute([pb],
oa=>{let {selected:ya,panel:N}=oa.field(pb);return ya&&N&&ya.from!=ya.to?Fa.Decoration.set([ib.range(ya.from,ya.to)]):Fa.Decoration.none}),Fa.hoverTooltip(function(oa,ya,N){var {diagnostics:M}=oa.state.field(pb);let Z,pa=-1,Ja=-1;M.between(ya-(0>N?1:0),ya+(0<N?1:0),(Sa,Za,{spec:tb})=>{if(ya>=Sa&&ya<=Za&&(Sa==Za||(ya>Sa||0<N)&&(ya<Za||0>N)))return Z=tb.diagnostics,pa=Sa,Ja=Za,!1});M=oa.state.facet($b).tooltipFilter;return Z&&M&&(Z=M(Z,oa.state)),Z?{pos:pa,end:Ja,above:oa.state.doc.lineAt(pa).to<Ja,
create(){return{dom:y(oa,Z)}}}:null},{hideOn:q}),Db],db=ua.Facet.define({combine(oa){return ua.combineConfig(oa,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});n.closeLintPanel=gb;n.diagnosticCount=function(oa){return(oa=oa.field(pb,!1))?oa.diagnostics.size:0};n.forEachDiagnostic=function(oa,ya){var N=oa.field(pb,!1);if(N&&N.diagnostics.size){oa=[];let M=[],Z=-1;for(N=ua.RangeSet.iter([N.diagnostics]);;N.next()){for(let pa=0;pa<oa.length;pa++)(!N.value||0>N.value.spec.diagnostics.indexOf(oa[pa]))&&
(ya(oa[pa],M[pa],Z),oa.splice(pa,1),M.splice(pa--,1));if(!N.value)break;for(let pa of N.value.spec.diagnostics)0>oa.indexOf(pa)&&(oa.push(pa),M.push(N.from));Z=N.to}}};n.forceLinting=function(oa){(oa=oa.plugin(Xb))&&oa.force()};n.lintGutter=function(oa={}){return[db.of(oa),Sb,sb,oc,qc]};n.lintKeymap=Lb;n.linter=function(oa,ya={}){return[$b.of({source:oa,config:ya}),Xb,bb]};n.nextDiagnostic=qb;n.openLintPanel=zb;n.previousDiagnostic=oa=>{let {state:ya}=oa,N=ya.field(pb,!1);if(!N)return!1;let M=ya.selection.main,
Z,pa,Ja,Sa;return N.diagnostics.between(0,ya.doc.length,(Za,tb)=>{tb<M.to&&(null==Z||Z<Za)&&(Z=Za,pa=tb);(null==Ja||Za>Ja)&&(Ja=Za,Sa=tb)}),null==Ja||null==Z&&Ja==M.from?!1:(oa.dispatch({selection:{anchor:Z??Ja,head:pa??Sa},scrollIntoView:!0}),!0)};n.setDiagnostics=w;n.setDiagnosticsEffect=Na}),Up=va(n=>{Object.defineProperty(n,"__esModule",{value:!0});var p=Gg(),q=hg(),u=bk(),w=Qp(),y=Rp(),B=Sp(),z=Tp();q=[p.lineNumbers(),p.highlightActiveLineGutter(),p.highlightSpecialChars(),w.history(),u.foldGutter(),
p.drawSelection(),p.dropCursor(),q.EditorState.allowMultipleSelections.of(!0),u.indentOnInput(),u.syntaxHighlighting(u.defaultHighlightStyle,{fallback:!0}),u.bracketMatching(),B.closeBrackets(),B.autocompletion(),p.rectangularSelection(),p.crosshairCursor(),p.highlightActiveLine(),y.highlightSelectionMatches(),p.keymap.of([...B.closeBracketsKeymap,...w.defaultKeymap,...y.searchKeymap,...w.historyKeymap,...u.foldKeymap,...B.completionKeymap,...z.lintKeymap])];u=[p.highlightSpecialChars(),w.history(),
p.drawSelection(),u.syntaxHighlighting(u.defaultHighlightStyle,{fallback:!0}),p.keymap.of([...w.defaultKeymap,...w.historyKeymap])];Object.defineProperty(n,"EditorView",{enumerable:!0,get:function(){return p.EditorView}});n.basicSetup=q;n.minimalSetup=u}),Yq=va((n,p)=>{function q(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function u(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function w(a,b,c){if(b){c=a.prototype;
for(var d=0;d<b.length;d++){var f=b[d];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(c,H(f.key),f)}}return Object.defineProperty(a,"prototype",{writable:!1}),a}function y(a,b){var c="u">typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||(c=ca(a))||b){c&&(a=c);var d=0;b=function(){};return{s:b,n:function(){return d>=a.length?{done:!0}:{done:!1,value:a[d++]}},e:function(m){throw m;},f:b}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}var f,h=!0,l=!1;return{s:function(){c=c.call(a)},n:function(){var m=c.next();return h=m.done,m},e:function(m){l=!0;f=m},f:function(){try{h||null==c.return||c.return()}finally{if(l)throw f;}}}}function B(a,b,c){return(b=H(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function z(a,b){var c=Array.isArray(a)?a:void 0;if(!c)a:{var d=null==a?null:"u">typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=d){var f,h,l,m=[],t=!0,v=!1;try{if(h=(d=d.call(a)).next,
0===b){if(Object(d)!==d){c=void 0;break a}t=!1}else for(;!(t=(f=h.call(d)).done)&&(m.push(f.value),m.length!==b);t=!0);}catch(D){v=!0;var C=D}finally{try{if(!t&&null!=d.return&&(l=d.return(),Object(l)!==l)){c=void 0;break a}}finally{if(v)throw C;}}c=m}else c=void 0}if(!(a=c||ca(a,b)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return a}function E(a){var b=Array.isArray(a)?q(a):void 0;
b||(b="u">typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"]?Array.from(a):void 0);if(!(a=b||ca(a)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return a}function H(a){a:if("object"==typeof a&&a){var b=a[Symbol.toPrimitive];if(void 0!==b){a=b.call(a,"string");if("object"!=typeof a)break a;throw new TypeError("@@toPrimitive must return a primitive value.");}a=String(a)}return"symbol"==
typeof a?a:a+""}function T(a){"@babel/helpers - typeof";return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&"function"==typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},T(a)}function ca(a,b){if(a){if("string"==typeof a)return q(a,b);var c={}.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?
q(a,b):void 0}}function ha(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function Da(){if(Wh)return uf;Wh=1;return uf=function(a){var b=typeof a;return null!=a&&("object"==b||"function"==b)},uf}function Fa(){if(Tf)return Xg;Tf=1;if(Oh)var a=jg;else Oh=1,a=(jg="object"==typeof vf&&vf&&vf.Object===Object&&vf,jg);var b="object"==typeof self&&self&&self.Object===Object&&self;return Xg=a||b||Function("return this")(),Xg}function ua(){if(kh)return ye;kh=1;var a=
Fa();return ye=function(){return a.Date.now()},ye}function Va(){if(xi)return lh;xi=1;var a=/\s/;return lh=function(b){for(var c=b.length;c--&&a.test(b.charAt(c)););return c},lh}function Ha(){if(Yh)return Xh;Yh=1;var a=Va(),b=/^\s+/;return Xh=function(c){return c&&c.slice(0,a(c)+1).replace(b,"")},Xh}function sa(){if(Di)return Zh;Di=1;return Zh=Fa().Symbol,Zh}function Na(){if(Ci)return mh;Ci=1;var a=sa(),b=Object.prototype,c=b.hasOwnProperty,d=b.toString,f=a?a.toStringTag:void 0;return mh=function(h){var l=
c.call(h,f),m=h[f];try{h[f]=void 0;var t=!0}catch{}var v=d.call(h);return t&&(l?h[f]=m:delete h[f]),v},mh}function Qa(){if(Ei)return bh;Ei=1;var a=Object.prototype.toString;return bh=function(b){return a.call(b)},bh}function kb(){if(me)return le;me=1;var a=sa(),b=Na(),c=Qa(),d=a?a.toStringTag:void 0;return le=function(f){return null==f?void 0===f?"[object Undefined]":"[object Null]":d&&d in Object(f)?b(f):c(f)},le}function pb(){if(yi)return nh;yi=1;return nh=function(a){return null!=a&&"object"==
typeof a},nh}function ib(){if(Ph)return Zg;Ph=1;var a=kb(),b=pb();return Zg=function(c){return"symbol"==typeof c||b(c)&&"[object Symbol]"==a(c)},Zg}function zb(){if(Yg)return $g;Yg=1;var a=Ha(),b=Da(),c=ib(),d=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,h=/^0o[0-7]+$/i,l=parseInt;return $g=function(m){if("number"==typeof m)return m;if(c(m))return NaN;b(m)&&(m="function"==typeof m.valueOf?m.valueOf():m,m=b(m)?m+"":m);if("string"!=typeof m)return 0===m?m:+m;m=a(m);var t=f.test(m);return t||h.test(m)?l(m.slice(2),
t?2:8):d.test(m)?NaN:+m},$g}function gb(){return Ai||(Ai=1,function(a,b){(function(){var c=Math.floor;var d=Math.min;var f=function(X,Y){return X<Y?-1:X>Y?1:0};var h=function(X,Y,ta,ja,Ba){if(null==ta&&(ta=0),null==Ba&&(Ba=f),0>ta)throw Error("lo must be non-negative");for(null==ja&&(ja=X.length);ta<ja;){var Ua=c((ta+ja)/2);0>Ba(Y,X[Ua])?ja=Ua:ta=Ua+1}return[].splice.apply(X,[ta,ta-ta].concat(Y)),Y};var l=function(X,Y,ta){return null==ta&&(ta=f),X.push(Y),K(X,0,X.length-1,ta)};var m=function(X,Y){var ta,
ja;return null==Y&&(Y=f),ta=X.pop(),X.length?(ja=X[0],X[0]=ta,P(X,0,Y)):ja=ta,ja};var t=function(X,Y,ta){var ja;return null==ta&&(ta=f),ja=X[0],X[0]=Y,P(X,0,ta),ja};var v=function(X,Y,ta){var ja;return null==ta&&(ta=f),X.length&&0>ta(X[0],Y)&&(ja=[X[0],Y],Y=ja[0],X[0]=ja[1],P(X,0,ta)),Y};var C=function(X,Y){var ta,ja;null==Y&&(Y=f);var Ba=function(){ja=[];for(var Mb=0,Ub=c(X.length/2);0<=Ub?Mb<Ub:Mb>Ub;0<=Ub?Mb++:Mb--)ja.push(Mb);return ja}.apply(this).reverse();var Ua=[];var ab=0;for(ta=Ba.length;ab<
ta;ab++){var Qb=Ba[ab];Ua.push(P(X,Qb,Y))}return Ua};var D=function(X,Y,ta){var ja;if(null==ta&&(ta=f),ja=X.indexOf(Y),-1!==ja)return K(X,0,ja,ta),P(X,ja,ta)};var F=function(X,Y,ta){var ja,Ba;if(null==ta&&(ta=f),ja=X.slice(0,Y),!ja.length)return ja;C(ja,ta);var Ua=X.slice(Y);Y=0;for(Ba=Ua.length;Y<Ba;Y++)X=Ua[Y],v(ja,X,ta);return ja.sort(ta).reverse()};var I=function(X,Y,ta){var ja,Ba;if(null==ta&&(ta=f),10*Y<=X.length){if(ja=X.slice(0,Y).sort(ta),!ja.length)return ja;var Ua=ja[ja.length-1];var ab=
X.slice(Y);Y=0;for(Ba=ab.length;Y<Ba;Y++)X=ab[Y],0>ta(X,Ua)&&(h(ja,X,0,null,ta),ja.pop(),Ua=ja[ja.length-1]);return ja}C(X,ta);ja=[];Ua=0;for(Y=d(Y,X.length);0<=Y?Ua<Y:Ua>Y;0<=Y?++Ua:--Ua)ja.push(m(X,ta));return ja};var K=function(X,Y,ta,ja){var Ba,Ua,ab;null==ja&&(ja=f);for(Ba=X[ta];ta>Y;)if(ab=ta-1>>1,Ua=X[ab],0>ja(Ba,Ua))X[ta]=Ua,ta=ab;else break;return X[ta]=Ba};var P=function(X,Y,ta){var ja;null==ta&&(ta=f);var Ba=X.length;var Ua=Y;var ab=X[Y];for(ja=2*Y+1;ja<Ba;){var Qb=ja+1;Qb<Ba&&!(0>ta(X[ja],
X[Qb]))&&(ja=Qb);X[Y]=X[ja];Y=ja;ja=2*Y+1}return X[Y]=ab,K(X,Ua,Y,ta)};var ba=function(){function X(Y){this.cmp=Y??f;this.nodes=[]}X.push=l;X.pop=m;X.replace=t;X.pushpop=v;X.heapify=C;X.updateItem=D;X.nlargest=F;X.nsmallest=I;return X.prototype.push=function(Y){return l(this.nodes,Y,this.cmp)},X.prototype.pop=function(){return m(this.nodes,this.cmp)},X.prototype.peek=function(){return this.nodes[0]},X.prototype.contains=function(Y){return-1!==this.nodes.indexOf(Y)},X.prototype.replace=function(Y){return t(this.nodes,
Y,this.cmp)},X.prototype.pushpop=function(Y){return v(this.nodes,Y,this.cmp)},X.prototype.heapify=function(){return C(this.nodes,this.cmp)},X.prototype.updateItem=function(Y){return D(this.nodes,Y,this.cmp)},X.prototype.clear=function(){return this.nodes=[]},X.prototype.empty=function(){return 0===this.nodes.length},X.prototype.size=function(){return this.nodes.length},X.prototype.clone=function(){var Y;return Y=new X,Y.nodes=this.nodes.slice(0),Y},X.prototype.toArray=function(){return this.nodes.slice(0)},
X.prototype.insert=X.prototype.push,X.prototype.top=X.prototype.peek,X.prototype.front=X.prototype.peek,X.prototype.has=X.prototype.contains,X.prototype.copy=X.prototype.clone,X}();(function(X,Y){return a.exports=Y()})(this,function(){return ba})}).call(ch)}(mg)),mg.exports}function qb(a,b){function c(v){for(var C=[],D=0;D<v.length;D++){var F=v[D],I=v[(D+1)%v.length],K=-(I.y-F.y);F=I.x-F.x;I=Math.sqrt(K*K+F*F);C.push({x:K/I,y:F/I})}return C}function d(v,C){var D=1/0,F=-1/0;v=y(v);var I;try{for(v.s();!(I=
v.n()).done;){var K=I.value,P=K.x*C.x+K.y*C.y;D=Math.min(D,P);F=Math.max(F,P)}}catch(ba){v.e(ba)}finally{v.f()}return{min:D,max:F}}var f=[].concat(E(c(a)),E(c(b)));f=y(f);var h;try{for(f.s();!(h=f.n()).done;){var l=h.value,m=d(a,l),t=d(b,l);if(m.max<t.min||t.max<m.min)return!1}}catch(v){f.e(v)}finally{f.f()}return!0}function Lb(a,b,c,d,f,h){var l;return Gc(a)?l=a:l=Q[a]||Q.euclidean,0===b&&Gc(a)?l(f,h):l(b,c,d,f,h)}function Xb(){if(cm)return ck;cm=1;return ck=Array.isArray,ck}function $b(){if(dm)return dk;
dm=1;var a=Xb(),b=ib(),c=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,d=/^\w*$/;return dk=function(f,h){if(a(f))return!1;var l=typeof f;return"number"==l||"symbol"==l||"boolean"==l||null==f||b(f)?!0:d.test(f)||!c.test(f)||null!=h&&f in Object(h)},dk}function pc(){if(em)return ek;em=1;var a=kb(),b=Da();return ek=function(c){if(!b(c))return!1;c=a(c);return"[object Function]"==c||"[object GeneratorFunction]"==c||"[object AsyncFunction]"==c||"[object Proxy]"==c},ek}function yb(){if(fm)return fk;
fm=1;if(gm)var a=gk;else gm=1,a=(gk=Fa()["__core-js_shared__"],gk);var b=function(){var c=/[^.]+$/.exec(a&&a.keys&&a.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}();return fk=function(c){return!!b&&b in c},fk}function Bb(){if(hm)return hk;hm=1;var a=Function.prototype.toString;return hk=function(b){if(null!=b){try{return a.call(b)}catch{}return b+""}return""},hk}function Db(){if(im)return ik;im=1;var a=pc(),b=yb(),c=Da(),d=Bb(),f=/^\[object .+?Constructor\]$/,h=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,
"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return ik=function(l){return!c(l)||b(l)?!1:(a(l)?h:f).test(d(l))},ik}function Cb(){if(jm)return jk;jm=1;return jk=function(a,b){return a?.[b]},jk}function sb(){if(km)return kk;km=1;var a=Db(),b=Cb();return kk=function(c,d){c=b(c,d);return a(c)?c:void 0},kk}function Sb(){if(lm)return lk;lm=1;return lk=sb()(Object,"create"),lk}function lc(){if(mm)return mk;mm=1;var a=Sb();return mk=function(){this.__data__=a?a(null):
{};this.size=0},mk}function qc(){if(nm)return nk;nm=1;return nk=function(a){a=this.has(a)&&delete this.__data__[a];return this.size-=a?1:0,a},nk}function oc(){if(om)return ok;om=1;var a=Sb(),b=Object.prototype.hasOwnProperty;return ok=function(c){var d=this.__data__;return a?(c=d[c],"__lodash_hash_undefined__"===c?void 0:c):b.call(d,c)?d[c]:void 0},ok}function bb(){if(pm)return pk;pm=1;var a=Sb(),b=Object.prototype.hasOwnProperty;return pk=function(c){var d=this.__data__;return a?void 0!==d[c]:b.call(d,
c)},pk}function db(){if(qm)return qk;qm=1;var a=Sb();return qk=function(b,c){var d=this.__data__;return this.size+=this.has(b)?0:1,d[b]=a&&void 0===c?"__lodash_hash_undefined__":c,this},qk}function oa(){function a(l){var m=-1,t=null==l?0:l.length;for(this.clear();++m<t;){var v=l[m];this.set(v[0],v[1])}}if(rm)return rk;rm=1;var b=lc(),c=qc(),d=oc(),f=bb(),h=db();return a.prototype.clear=b,a.prototype.delete=c,a.prototype.get=d,a.prototype.has=f,a.prototype.set=h,rk=a,rk}function ya(){if(sm)return sk;
sm=1;return sk=function(){this.__data__=[];this.size=0},sk}function N(){if(tm)return tk;tm=1;return tk=function(a,b){return a===b||a!==a&&b!==b},tk}function M(){if(um)return uk;um=1;var a=N();return uk=function(b,c){for(var d=b.length;d--;)if(a(b[d][0],c))return d;return-1},uk}function Z(){if(vm)return vk;vm=1;var a=M(),b=Array.prototype.splice;return vk=function(c){var d=this.__data__;c=a(d,c);return 0>c?!1:(c==d.length-1?d.pop():b.call(d,c,1),--this.size,!0)},vk}function pa(){if(wm)return wk;wm=
1;var a=M();return wk=function(b){var c=this.__data__;b=a(c,b);return 0>b?void 0:c[b][1]},wk}function Ja(){if(xm)return xk;xm=1;var a=M();return xk=function(b){return-1<a(this.__data__,b)},xk}function Sa(){if(ym)return yk;ym=1;var a=M();return yk=function(b,c){var d=this.__data__,f=a(d,b);return 0>f?(++this.size,d.push([b,c])):d[f][1]=c,this},yk}function Za(){function a(l){var m=-1,t=null==l?0:l.length;for(this.clear();++m<t;){var v=l[m];this.set(v[0],v[1])}}if(zm)return zk;zm=1;var b=ya(),c=Z(),
d=pa(),f=Ja(),h=Sa();return a.prototype.clear=b,a.prototype.delete=c,a.prototype.get=d,a.prototype.has=f,a.prototype.set=h,zk=a,zk}function tb(){if(Am)return Ak;Am=1;var a=sb(),b=Fa();return Ak=a(b,"Map"),Ak}function Pb(){if(Bm)return Bk;Bm=1;var a=oa(),b=Za(),c=tb();return Bk=function(){this.size=0;this.__data__={hash:new a,map:new (c||b),string:new a}},Bk}function Jb(){if(Cm)return Ck;Cm=1;return Ck=function(a){var b=typeof a;return"string"==b||"number"==b||"symbol"==b||"boolean"==b?"__proto__"!==
a:null===a},Ck}function ec(){if(Dm)return Dk;Dm=1;var a=Jb();return Dk=function(b,c){b=b.__data__;return a(c)?b["string"==typeof c?"string":"hash"]:b.map},Dk}function yc(){if(Em)return Ek;Em=1;var a=ec();return Ek=function(b){b=a(this,b).delete(b);return this.size-=b?1:0,b},Ek}function hc(){if(Fm)return Fk;Fm=1;var a=ec();return Fk=function(b){return a(this,b).get(b)},Fk}function Fc(){if(Gm)return Gk;Gm=1;var a=ec();return Gk=function(b){return a(this,b).has(b)},Gk}function Ic(){if(Hm)return Hk;Hm=
1;var a=ec();return Hk=function(b,c){var d=a(this,b),f=d.size;return d.set(b,c),this.size+=d.size==f?0:1,this},Hk}function Nc(){function a(l){var m=-1,t=null==l?0:l.length;for(this.clear();++m<t;){var v=l[m];this.set(v[0],v[1])}}if(Im)return Ik;Im=1;var b=Pb(),c=yc(),d=hc(),f=Fc(),h=Ic();return a.prototype.clear=b,a.prototype.delete=c,a.prototype.get=d,a.prototype.has=f,a.prototype.set=h,Ik=a,Ik}function Dc(){function a(c,d){if("function"!=typeof c||null!=d&&"function"!=typeof d)throw new TypeError("Expected a function");
var f=function(){var h=arguments,l=d?d.apply(this,h):h[0],m=f.cache;if(m.has(l))return m.get(l);h=c.apply(this,h);return f.cache=m.set(l,h)||m,h};return f.cache=new (a.Cache||b),f}if(Jm)return Jk;Jm=1;var b=Nc();return a.Cache=b,Jk=a,Jk}function cd(){if(Km)return Kk;Km=1;var a=Dc();return Kk=function(b){b=a(b,function(d){return 500===c.size&&c.clear(),d});var c=b.cache;return b},Kk}function jd(){if(Lm)return Lk;Lm=1;var a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,
b=/\\(\\)?/g;return Lk=cd()(function(c){var d=[];return 46===c.charCodeAt(0)&&d.push(""),c.replace(a,function(f,h,l,m){d.push(l?m.replace(b,"$1"):h||f)}),d}),Lk}function wc(){if(Mm)return Mk;Mm=1;return Mk=function(a,b){for(var c=-1,d=null==a?0:a.length,f=Array(d);++c<d;)f[c]=b(a[c],c,a);return f},Mk}function zc(){function a(l){if("string"==typeof l)return l;if(d(l))return c(l,a)+"";if(f(l))return h?h.call(l):"";var m=l+"";return"0"==m&&1/l==-1/0?"-0":m}if(Nm)return Nk;Nm=1;var b=sa(),c=wc(),d=Xb(),
f=ib(),h=(b=b?b.prototype:void 0)?b.toString:void 0;return Nk=a,Nk}function da(){if(Om)return Ok;Om=1;var a=zc();return Ok=function(b){return null==b?"":a(b)},Ok}function Ca(){if(Pm)return Pk;Pm=1;var a=Xb(),b=$b(),c=jd(),d=da();return Pk=function(f,h){return a(f)?f:b(f,h)?[f]:c(d(f))},Pk}function Ea(){if(Qm)return Qk;Qm=1;var a=ib();return Qk=function(b){if("string"==typeof b||a(b))return b;var c=b+"";return"0"==c&&1/b==-1/0?"-0":c},Qk}function Ta(){if(Rm)return Rk;Rm=1;var a=Ca(),b=Ea();return Rk=
function(c,d){d=a(d,c);for(var f=0,h=d.length;null!=c&&f<h;)c=c[b(d[f++])];return f&&f==h?c:void 0},Rk}function mb(){if(Sm)return Sk;Sm=1;var a=sb();a:{try{var b=a(Object,"defineProperty");var c=(b({},"",{}),b);break a}catch{}c=void 0}return Sk=c,Sk}function Fb(){if(Tm)return Tk;Tm=1;var a=mb();return Tk=function(b,c,d){"__proto__"==c&&a?a(b,c,{configurable:!0,enumerable:!0,value:d,writable:!0}):b[c]=d},Tk}function Hb(){if(Um)return Uk;Um=1;var a=Fb(),b=N(),c=Object.prototype.hasOwnProperty;return Uk=
function(d,f,h){var l=d[f];c.call(d,f)&&b(l,h)&&(void 0!==h||f in d)||a(d,f,h)},Uk}function ic(){if(Vm)return Vk;Vm=1;var a=/^(?:0|[1-9]\d*)$/;return Vk=function(b,c){var d=typeof b;return c=c??9007199254740991,!!c&&("number"==d||"symbol"!=d&&a.test(b))&&-1<b&&0==b%1&&b<c},Vk}function Jc(){if(Wm)return Wk;Wm=1;var a=Hb(),b=Ca(),c=ic(),d=Da(),f=Ea();return Wk=function(h,l,m,t){if(!d(h))return h;l=b(l,h);for(var v=-1,C=l.length,D=C-1,F=h;null!=F&&++v<C;){var I=f(l[v]),K=m;if("__proto__"===I||"constructor"===
I||"prototype"===I)break;if(v!=D){var P=F[I];K=t?t(P,I,F):void 0;void 0===K&&(K=d(P)?P:c(l[v+1])?[]:{})}a(F,I,K);F=F[I]}return h},Wk}function $c(){if(Xm)return Xk;Xm=1;return Xk=function(a,b){var c=-1,d=a.length;for(b||=Array(d);++c<d;)b[c]=a[c];return b},Xk}function Cc(a,b,c,d){for(var f=[],h=new rf,l=a.cy().hasCompoundNodes(),m=0;m<a.length;m++){var t=a[m];c?f.push(t):l&&d(f,h,t)}for(;0<f.length;)c=f.shift(),b(c),h.add(c.id()),l&&d(f,h,c);return a}function Tc(a,b,c){if(c.isParent()){c=c._private.children;
for(var d=0;d<c.length;d++){var f=c[d];b.has(f.id())||a.push(f)}}}function Vc(a,b,c){c.isChild()&&(c=c._private.parent,b.has(c.id())||a.push(c))}function qd(a,b,c){Vc(a,b,c);Tc(a,b,c)}function wd(a){return function(b){if((void 0===b&&(b=!0),0!==this.length)&&this.isNode()&&!this.removed()){for(var c=0,d=this[0],f=d._private.edges,h=0;h<f.length;h++){var l=f[h];!b&&l.isLoop()||(c+=a(d,l))}return c}}}function Yc(a,b){return function(c){for(var d,f=this.nodes(),h=0;h<f.length;h++){var l=f[h][a](c);void 0!==
l&&(void 0===d||b(l,d))&&(d=l)}return d}}function nd(){return!1}function V(){return!0}function A(){for(var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Vp,b=1<arguments.length?arguments[1]:void 0,c=0;c<Ym.length;c++){var d=Ym[c];this[d]=a[d]||Zm[d]}this.context=b||this.context;this.listeners=[];this.emitting=0}function J(a,b,c){var d=c._private;d=d.styleCache=d.styleCache||[];var f;return null!=(f=d[a])||(f=d[a]=b(c)),f}function W(a,b){return a=wf(a),function(c){return J(a,b,c)}}function ea(a,
b){a=wf(a);var c=function(d){return b.call(d)};return function(){var d=this[0];if(d)return J(a,c,d)}}function qa(a,b){if(a=a._private.data.parent?a.parents():null)for(var c=0;c<a.length;c++)if(!b(a[c]))return!1;return!0}function za(a){var b=a.ok,c=a.edgeOkViaNode||a.ok,d=a.parentOk||a.ok;return function(){var f=this.cy();if(!f.styleEnabled())return!0;var h=this[0];f=f.hasCompoundNodes();if(h){var l=h._private;if(!b(h))return!1;if(h.isNode())return!f||qa(h,d);h=l.source;l=l.target;return c(h)&&(!f||
qa(h,c))&&(h===l||c(l)&&(!f||qa(l,c)))}}}function Wa(a){return function(){var b=arguments,c=[];if(2===b.length)this.on(a.event,b[0],b[1]);else if(1===b.length&&Gc(b[0]))this.on(a.event,b[0]);else if(0===b.length||1===b.length&&kd(b[0])){b=1===b.length?b[0]:null;for(var d=0;d<this.length;d++){var f=this[d],h=!a.ableField||f._private[a.ableField],l=f._private[a.field]!=a.value;if(a.overrideAble){var m=a.overrideAble(f);if(void 0!==m&&(h=m,!m))return this}h&&(f._private[a.field]=a.value,l&&c.push(f))}c=
this.spawn(c);c.updateStyle();c.emit(a.event);b&&c.emit(b)}return this}}function fb(a){Yf[a.field]=function(){var b=this[0];if(b){if(a.overrideField){var c=a.overrideField(b);if(void 0!==c)return c}return b._private[a.field]}};Yf[a.on]=Wa({event:a.on,field:a.field,ableField:a.ableField,overrideAble:a.overrideAble,value:!0});Yf[a.off]=Wa({event:a.off,field:a.field,ableField:a.ableField,overrideAble:a.overrideAble,value:!1})}function Ab(a){return function(b){for(var c=[],d=0;d<this.length;d++){var f=
this[d]._private[a.attr];f&&c.push(f)}return this.spawn(c,!0).filter(b)}}function Ib(a){return function(b){var c=[],d=this._private.cy,f=a||{};rc(b)&&(b=d.$(b));for(d=0;d<b.length;d++)for(var h=b[d]._private.edges,l=0;l<h.length;l++){var m=h[l],t=m._private.data,v=this.hasElementWithId(t.source)&&b.hasElementWithId(t.target);t=b.hasElementWithId(t.source)&&this.hasElementWithId(t.target);(v||t)&&((f.thisIsSrc||f.thisIsTgt)&&(f.thisIsSrc&&!v||f.thisIsTgt&&!t)||c.push(m))}return this.spawn(c,!0)}}function uc(a){return a=
Bc({},{codirected:!1},a),function(b){for(var c=[],d=this.edges(),f=a,h=0;h<d.length;h++){var l=d[h]._private,m=l.source,t=m._private.data.id;l=l.data.target;m=m._private.edges;for(var v=0;v<m.length;v++){var C=m[v],D=C._private.data,F=D.target,I=D.source;D=F===l&&I===t;F=t===F&&l===I;(f.codirected&&D||!f.codirected&&(D||F))&&c.push(C)}}return this.spawn(c,!0).filter(b)}}function xc(a,b,c,d){function f(C,D,F){return(((1-3*F+3*D)*C+(3*F-6*D))*C+3*D)*C}var h="u">typeof Float32Array;if(4!==arguments.length)return!1;
for(var l=0;4>l;++l)if("number"!=typeof arguments[l]||isNaN(arguments[l])||!isFinite(arguments[l]))return!1;a=Math.min(a,1);c=Math.min(c,1);a=Math.max(a,0);c=Math.max(c,0);var m=h?new Float32Array(11):Array(11),t=!1;h=function(C){if(!t&&(t=!0,a!==b||c!==d))for(var D=0;11>D;++D)m[D]=f(.1*D,a,c);if(a!==b||c!==d)if(0===C)C=0;else if(1===C)C=1;else{var F=0;for(D=1;10!==D&&m[D]<=C;++D)F+=.1;--D;D=F+(C-m[D])/(m[D+1]-m[D])*.1;var I=3*(1-3*c+3*a)*D*D+2*(3*c-6*a)*D+3*a;if(.001<=I){for(F=0;4>F;++F){I=3*(1-
3*c+3*a)*D*D+2*(3*c-6*a)*D+3*a;if(0===I)break;var K=f(D,a,c)-C;D-=K/I}C=D}else if(0===I)C=D;else{D=F;F+=.1;var P=0;do K=D+(F-D)/2,I=f(K,a,c)-C,0<I?F=K:D=K;while(1E-7<Math.abs(I)&&10>++P);C=K}C=f(C,b,d)}return C};h.getControlPoints=function(){return[{x:a,y:b},{x:c,y:d}]};var v="generateBezier("+[a,b,c,d]+")";return h.toString=function(){return v},h}function R(a,b,c,d,f){if(1===d||b===c)return c;b=f(b,c,d);return null==a||((a.roundValue||a.color)&&(b=Math.round(b)),void 0!==a.min&&(b=Math.max(b,a.min)),
void 0!==a.max&&(b=Math.min(b,a.max))),b}function U(a,b){return null!=a.pfValue||null!=a.value?null==a.pfValue||null!=b&&"%"===b.type.units?a.value:a.pfValue:a}function na(a,b,c,d,f){var h=null!=f?f.type:null;0>c?c=0:1<c&&(c=1);a=U(a,f);b=U(b,f);if(cc(a)&&cc(b))return R(h,a,b,c,d);if(kd(a)&&kd(b)){f=[];for(var l=0;l<b.length;l++){var m=a[l],t=b[l];null!=m&&null!=t?(m=R(h,m,t,c,d),f.push(m)):f.push(t)}return f}}function wa(a,b,c,d){var f=!d,h=a._private;b=b._private;var l=b.easing,m=b.startTime,t=
(d?a:a.cy()).style();if(!b.easingImpl)if(null==l)b.easingImpl=Ti.linear;else{l=rc(l)?t.parse("transition-timing-function",l).value:l;var v,C;rc(l)?(v=l,C=[]):(v=l[1],C=l.slice(2).map(function(F){return+F}));0<C.length?("spring"===v&&C.push(b.duration),b.easingImpl=Ti[v].apply(null,C)):b.easingImpl=Ti[v]}v=b.easingImpl;var D;if(0===b.duration?D=1:D=(c-m)/b.duration,b.applying&&(D=b.progress),0>D?D=0:1<D&&(D=1),null==b.delay)if(c=b.startPosition,(m=b.position)&&f&&!a.locked()&&(C={},La(c.x,m.x)&&(C.x=
na(c.x,m.x,D,v)),La(c.y,m.y)&&(C.y=na(c.y,m.y,D,v)),a.position(C)),m=b.startPan,C=b.pan,l=h.pan,(c=null!=C&&d)&&(La(m.x,C.x)&&(l.x=na(m.x,C.x,D,v)),La(m.y,C.y)&&(l.y=na(m.y,C.y,D,v)),a.emit("pan")),m=b.startZoom,C=b.zoom,(d=null!=C&&d)&&(La(m,C)&&(h.zoom=Ag(h.minZoom,na(m,C,D,v),h.maxZoom)),a.emit("zoom")),(c||d)&&a.emit("viewport"),(h=b.style)&&0<h.length&&f){for(f=0;f<h.length;f++)c=h[f],d=c.name,m=b.startStyle[d],c=na(m,c,D,v,t.properties[m.name]),t.overrideBypass(a,d,c);a.emit("style")}return b.progress=
D,D}function La(a,b){return null==a||null==b?!1:cc(a)&&cc(b)?!0:!(!a||!b)}function eb(a,b,c,d){a=b._private;a.started=!0;a.startTime=c-a.progress*a.duration}function Ya(a,b){function c(t,v){var C=t._private,D=C.animation.current;C=C.animation.queue;var F=!1;if(0===D.length){var I=C.shift();I&&D.push(I)}I=function(X){for(var Y=X.length-1;0<=Y;Y--)(0,X[Y])();X.splice(0,X.length)};for(var K=D.length-1;0<=K;K--){var P=D[K],ba=P._private;ba.stopped?(D.splice(K,1),ba.hooked=!1,ba.playing=!1,ba.started=
!1,I(ba.frames)):!ba.playing&&!ba.applying||(ba.playing&&ba.applying&&(ba.applying=!1),ba.started||eb(t,P,a),wa(t,P,a,v),ba.applying&&(ba.applying=!1),I(ba.frames),null!=ba.step&&ba.step(a),P.completed()&&(D.splice(K,1),ba.hooked=!1,ba.playing=!1,ba.started=!1,I(ba.completes)),F=!0)}return!v&&0===D.length&&0===C.length&&f.push(t),F}for(var d=b._private.aniEles,f=[],h=!1,l=0;l<d.length;l++){var m=c(d[l]);h=h||m}l=c(b,!0);(h||l)&&(0<d.length?b.notify("draw",d):b.notify("draw"));d.unmerge(f);b.emit("step")}
function hb(a){this.options=Bc({},Wp,Xp,a)}function Nb(a){this.options=Bc({},Yp,a)}function sc(a){this.options=Bc({},Zp,a)}function Ec(a){this.options=Bc({},$p,a);this.options.layout=this;var b=this.options.eles.nodes();a=this.options.eles.edges().filter(function(c){var d=c.source().data("id"),f=c.target().data("id");c=b.some(function(l){return l.data("id")===d});var h=b.some(function(l){return l.data("id")===f});return!c||!h});this.options.eles=this.options.eles.not(a)}function Kc(a){this.options=
Bc({},aq,a)}function ed(a){this.options=Bc({},bq,a)}function ud(a){this.options=Bc({},cq,a)}function he(a){this.options=Bc({},dq,a)}function ze(a){this.options=a;this.notifications=0}function L(a,b){0===b.radius?a.lineTo(b.cx,b.cy):a.arc(b.cx,b.cy,b.radius,b.startAngle,b.endAngle,b.counterClockwise)}function O(a,b,c,d){var f=4<arguments.length&&void 0!==arguments[4]?arguments[4]:!0;if(0===d||0===b.radius)f={cx:b.x,cy:b.y,radius:0,startX:b.x,startY:b.y,stopX:b.x,stopY:b.y,startAngle:void 0,endAngle:void 0,
counterClockwise:void 0};else{if(a!==$m)an(b,a,jf);else{var h=Ie,l=jf;l.x=-1*h.x;l.y=-1*h.y;l.nx=-1*h.nx;l.ny=-1*h.ny;l.ang=0<h.ang?-(Math.PI-h.ang):Math.PI+h.ang}(an(b,c,Ie),bn=jf.nx*Ie.ny-jf.ny*Ie.nx,cn=jf.nx*Ie.nx-jf.ny*-Ie.ny,Df=Math.asin(Math.max(-1,Math.min(1,bn))),1E-6>Math.abs(Df))?(Yk=b.x,Zk=b.y,Hg=yh=0):(Ig=1,Ui=!1,0>cn?0>Df?Df=Math.PI+Df:(Df=Math.PI-Df,Ig=-1,Ui=!0):0<Df&&(Ig=-1,Ui=!0),void 0!==b.radius?yh=b.radius:yh=d,Jg=Df/2,Vi=Math.min(jf.len/2,Ie.len/2),f?(kf=Math.abs(Math.cos(Jg)*
yh/Math.sin(Jg)),kf>Vi?(kf=Vi,Hg=Math.abs(kf*Math.sin(Jg)/Math.cos(Jg))):Hg=yh):(kf=Math.min(Vi,yh),Hg=Math.abs(kf*Math.sin(Jg)/Math.cos(Jg))),$k=b.x+Ie.nx*kf,al=b.y+Ie.ny*kf,Yk=$k-Ie.ny*Hg*Ig,Zk=al+Ie.nx*Hg*Ig,dn=b.x+jf.nx*kf,en=b.y+jf.ny*kf,$m=b);f={cx:Yk,cy:Zk,radius:Hg,startX:dn,startY:en,stopX:$k,stopY:al,startAngle:jf.ang+Math.PI/2*Ig,endAngle:Ie.ang-Math.PI/2*Ig,counterClockwise:Ui}}return f}function ia(a){var b=[];if(null!=a){for(var c=0;c<a.length;c+=2)b.push({x:a[c],y:a[c+1]});return b}}
function ma(a,b){for(var c=0;c<b.length;c++){var d=b[c];a.lineTo(d.x,d.y)}}function Ia(a,b,c){for(var d,f=0;f<b.length;f++){var h=b[f];0===f&&(d=h);a.lineTo(h.x,h.y)}a.quadraticCurveTo(c.x,c.y,d.x,d.y)}function cb(a,b,c){a.beginPath&&a.beginPath();for(var d=0;d<b.length;d++){var f=b[d];a.lineTo(f.x,f.y)}b=c[0];a.moveTo(b.x,b.y);for(d=1;d<c.length;d++)f=c[d],a.lineTo(f.x,f.y);a.closePath&&a.closePath()}function jb(a,b,c,d,f){a.beginPath&&a.beginPath();a.arc(c,d,f,0,2*Math.PI,!1);c=b[0];a.moveTo(c.x,
c.y);for(c=0;c<b.length;c++)d=b[c],a.lineTo(d.x,d.y);a.closePath&&a.closePath()}function Eb(a,b,c,d){a.arc(b,c,d,0,2*Math.PI,!1)}function vc(a,b,c,d,f){var h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:5,l=6<arguments.length?arguments[6]:void 0;a.beginPath();a.moveTo(b+h,c);a.lineTo(b+d-h,c);a.quadraticCurveTo(b+d,c,b+d,c+h);a.lineTo(b+d,c+f-h);a.quadraticCurveTo(b+d,c+f,b+d-h,c+f);a.lineTo(b+h,c+f);a.quadraticCurveTo(b,c+f,b,c+f-h);a.lineTo(b,c+h);a.quadraticCurveTo(b,c,b+h,c);a.closePath();
l?a.stroke():a.fill()}function $a(a,b,c){b=a.createShader(b);if(a.shaderSource(b,c),a.compileShader(b),!a.getShaderParameter(b,a.COMPILE_STATUS))throw Error(a.getShaderInfoLog(b));return b}function xd(a,b,c){b=$a(a,a.VERTEX_SHADER,b);c=$a(a,a.FRAGMENT_SHADER,c);var d=a.createProgram();if(a.attachShader(d,b),a.attachShader(d,c),a.linkProgram(d),!a.getProgramParameter(d,a.LINK_STATUS))throw Error("Could not initialize shaders");return d}function Pd(a,b,c){void 0===c&&(c=b);var d=a.makeOffscreenCanvas(b,
c),f=d.context=d.getContext("2d");return d.clear=function(){return f.clearRect(0,0,d.width,d.height)},d.clear(),d}function qe(a){var b=a.pixelRatio,c=a.cy.zoom();a=a.cy.pan();return{zoom:c*b,pan:{x:a.x*b,y:a.y*b}}}function Ud(a){return"solid"!==a.pstyle("background-fill").value||"none"!==a.pstyle("background-image").strValue?!1:0===a.pstyle("border-width").value||0===a.pstyle("border-opacity").value?!0:"solid"===a.pstyle("border-style").value}function Hf(a,b){if(a.length!==b.length)return!1;for(var c=
0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function rd(a,b,c){var d=a[1]/255,f=a[2]/255;c=c||Array(4);return c[0]=a[0]/255*b,c[1]=d*b,c[2]=f*b,c[3]=b,c}function Ae(a,b){b=b||Array(4);return b[0]=(a>>0&255)/255,b[1]=(a>>8&255)/255,b[2]=(a>>16&255)/255,b[3]=(a>>24&255)/255,b}function od(a,b){var c=a.createTexture();return c.buffer=function(d){a.bindTexture(a.TEXTURE_2D,c);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);
a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,d);a.generateMipmap(a.TEXTURE_2D);a.bindTexture(a.TEXTURE_2D,null)},c.deleteTexture=function(){a.deleteTexture(c)},c}function Nf(a,b){switch(b){case "float":return[1,a.FLOAT,4];case "vec2":return[2,a.FLOAT,4];case "vec3":return[3,a.FLOAT,4];case "vec4":return[4,
a.FLOAT,4];case "int":return[1,a.INT,4];case "ivec2":return[2,a.INT,4]}}function Ld(a,b,c){switch(b){case a.FLOAT:return new Float32Array(c);case a.INT:return new Int32Array(c)}}function Of(a,b,c,d,f,h){switch(b){case a.FLOAT:return new Float32Array(c.buffer,h*d,f);case a.INT:return new Int32Array(c.buffer,h*d,f)}}function Zd(a,b,c,d){c=Nf(a,c);var f=z(c,3),h=f[0];c=f[1];f=f[2];var l=Ld(a,c,b*h);f*=h;var m=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,m);a.bufferData(a.ARRAY_BUFFER,b*f,a.DYNAMIC_DRAW);
a.enableVertexAttribArray(d);c===a.FLOAT?a.vertexAttribPointer(d,h,c,!1,f,0):c===a.INT&&a.vertexAttribIPointer(d,h,c,f,0);a.vertexAttribDivisor(d,1);a.bindBuffer(a.ARRAY_BUFFER,null);var t=Array(b);for(d=0;d<b;d++)t[d]=Of(a,c,l,f,h,d);return m.dataArray=l,m.stride=f,m.size=h,m.getView=function(v){return t[v]},m.setPoint=function(v,C,D){v=t[v];v[0]=C;v[1]=D},m.bufferSubData=function(v){a.bindBuffer(a.ARRAY_BUFFER,m);v?a.bufferSubData(a.ARRAY_BUFFER,0,l,0,v*h):a.bufferSubData(a.ARRAY_BUFFER,0,l)},m}
function rg(a,b,c){for(var d=new Float32Array(9*b),f=Array(b),h=0;h<b;h++)f[h]=new Float32Array(d.buffer,36*h,9);var l=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,l);a.bufferData(a.ARRAY_BUFFER,d.byteLength,a.DYNAMIC_DRAW);for(b=0;3>b;b++)h=c+b,a.enableVertexAttribArray(h),a.vertexAttribPointer(h,3,a.FLOAT,!1,36,12*b),a.vertexAttribDivisor(h,1);return a.bindBuffer(a.ARRAY_BUFFER,null),l.getMatrixView=function(m){return f[m]},l.setData=function(m,t){f[t].set(m,0)},l.bufferSubData=function(){a.bindBuffer(a.ARRAY_BUFFER,
l);a.bufferSubData(a.ARRAY_BUFFER,0,d)},l}function Pf(a){var b=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,b);var c=a.createTexture();return a.bindTexture(a.TEXTURE_2D,c),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,c,0),a.bindFramebuffer(a.FRAMEBUFFER,null),b.setFramebufferAttachmentSizes=
function(d,f){a.bindTexture(a.TEXTURE_2D,c);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,d,f,0,a.RGBA,a.UNSIGNED_BYTE,null)},b}function Ge(){var a=new fn(9);return fn!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function Qf(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a}function Re(a,b,c){var d=b[0],f=b[1],h=b[2],l=b[3],m=b[4],t=b[5],v=b[6],C=b[7];b=b[8];var D=c[0];c=c[1];return a[0]=d,a[1]=f,a[2]=h,a[3]=l,a[4]=m,a[5]=t,a[6]=D*d+c*l+v,a[7]=D*
f+c*m+C,a[8]=D*h+c*t+b,a}function df(a,b,c){var d=b[0],f=b[1],h=b[2],l=b[3],m=b[4],t=b[5],v=b[6],C=b[7];b=b[8];var D=Math.sin(c);c=Math.cos(c);return a[0]=c*d+D*l,a[1]=c*f+D*m,a[2]=c*h+D*t,a[3]=c*l-D*d,a[4]=c*m-D*f,a[5]=c*t-D*h,a[6]=v,a[7]=C,a[8]=b,a}function ef(a,b,c){var d=c[0];c=c[1];return a[0]=d*b[0],a[1]=d*b[1],a[2]=d*b[2],a[3]=c*b[3],a[4]=c*b[4],a[5]=c*b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a}function sg(a,b){return a.intersection?a.intersection(b):new Set(E(a).filter(function(c){return b.has(c)}))}
function mc(a){a=a.cy.container();return Sf(a&&a.style&&a.style.backgroundColor||"white")}function xe(a){var b=a.render;a.render=function(h){h=h||{};var l=a.cy;a.webgl&&(7.99<l.zoom()?(l=a.data.contexts[a.WEBGL],l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),b.call(a,h)):(Ze(a),xa(a,h,ei.SCREEN)))};var c=a.matchCanvasSize;a.matchCanvasSize=function(h){c.call(a,h);a.pickingFrameBuffer.setFramebufferAttachmentSizes(a.canvasWidth,a.canvasHeight);a.pickingFrameBuffer.needsDraw=!0};a.findNearestElements=
function(h,l,m,t){t=qe(a);m=t.pan;t=t.zoom;h=h*t+m.x;m=l*t+m.y;l=(m=Math.round(a.canvasHeight-m),[h,m]);h=z(l,2);l=h[1];h=h[0]-3;m=l-3;t=a.data.contexts[a.WEBGL];t.bindFramebuffer(t.FRAMEBUFFER,a.pickingFrameBuffer);a.pickingFrameBuffer.needsDraw&&(t.viewport(0,0,t.canvas.width,t.canvas.height),xa(a,null,ei.PICKING),a.pickingFrameBuffer.needsDraw=!1);l=new Uint8Array(144);t.readPixels(h,m,6,6,t.RGBA,t.UNSIGNED_BYTE,l);t.bindFramebuffer(t.FRAMEBUFFER,null);h=new Set;for(m=0;36>m;m++)t=l.slice(4*m,
4*m+4),t=t[0]+(t[1]<<8)+(t[2]<<16)+(t[3]<<24)-1,0<=t&&h.add(t);l=a.getCachedZSortedEles();var v,C;h=y(h);var D;try{for(h.s();!(D=h.n()).done;){var F=l[D.value];if(!v&&F.isNode()&&(v=F),!C&&F.isEdge()&&(C=F),v&&C)break}}catch(I){h.e(I)}finally{h.f()}return[v,C].filter(Boolean)};var d=a.invalidateCachedZSortedEles;a.invalidateCachedZSortedEles=function(){d.call(a);a.pickingFrameBuffer.needsDraw=!0};var f=a.notify;a.notify=function(h,l){f.call(a,h,l);"viewport"===h||"bounds"===h?a.pickingFrameBuffer.needsDraw=
!0:"background"===h&&a.drawing.invalidate(l,{type:"node-body"})}}function Ze(a){var b=function(c){c.save();c.setTransform(1,0,0,1,0,0);c.clearRect(0,0,a.canvasWidth,a.canvasHeight);c.restore()};b(a.data.contexts[a.NODE]);b(a.data.contexts[a.DRAG])}function Rf(a,b){var c=a.canvasWidth,d=a.canvasHeight,f=qe(a);a=f.pan;f=f.zoom;b.setTransform(1,0,0,1,0,0);b.clearRect(0,0,c,d);b.translate(a.x,a.y);b.scale(f,f)}function S(a,b){a.drawSelectionRectangle(b,function(c){return Rf(a,c)})}function ka(a){var b=
function(d,f,h){f=d.atlasManager.getAtlasCollection(f);d=a.data.contexts[a.NODE];f=f.atlases;for(var l=0;l<f.length;l++){var m=f[l].canvas;if(m){var t=m.width,v=m.height,C=t*l,D=m.height*h;d.save();d.scale(.4,.4);d.drawImage(m,C,D);d.strokeStyle="black";d.rect(C,D,t,v);d.stroke();d.restore()}}},c=0;b(a.drawing,"node",c++);b(a.drawing,"label",c++)}function Ga(a,b,c){a=a.drawing;b+=1;c.isNode()?(a.drawNode(c,b,"node-underlay"),a.drawNode(c,b,"node-body"),a.drawTexture(c,b,"label"),a.drawNode(c,b,"node-overlay")):
(a.drawEdgeLine(c,b),a.drawEdgeArrow(c,b,"source"),a.drawEdgeArrow(c,b,"target"),a.drawTexture(c,b,"label"),a.drawTexture(c,b,"edge-source-label"),a.drawTexture(c,b,"edge-target-label"))}function xa(a,b,c){var d;a.webglDebug&&(d=performance.now());var f=a.drawing,h=0;if(c.screen&&a.data.canvasNeedsRedraw[a.SELECT_BOX]&&S(a,b),a.data.canvasNeedsRedraw[a.NODE]||c.picking){h=a.data.contexts[a.WEBGL];c.screen?(h.clearColor(0,0,0,0),h.enable(h.BLEND),h.blendFunc(h.ONE,h.ONE_MINUS_SRC_ALPHA)):h.disable(h.BLEND);
h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT);h.viewport(0,0,h.canvas.width,h.canvas.height);b=a.canvasWidth;var l=a.canvasHeight;h=qe(a);var m=h.pan,t=h.zoom;h=Ge();Re(h,h,[m.x,m.y]);ef(h,h,[t,t]);var v=Ge();v[0]=2/b;v[1]=0;v[2]=0;v[3]=0;v[4]=-2/l;v[5]=0;v[6]=-1;v[7]=1;v[8]=1;b=Ge();l=v[0];m=v[1];t=v[2];var C=v[3],D=v[4],F=v[5],I=v[6],K=v[7];v=v[8];var P=h[0],ba=h[1],X=h[2],Y=h[3],ta=h[4],ja=h[5],Ba=h[6],Ua=h[7];h=h[8];b[0]=P*l+ba*C+X*I;b[1]=P*m+ba*D+X*K;b[2]=P*t+ba*F+X*v;b[3]=Y*l+ta*C+ja*I;b[4]=
Y*m+ta*D+ja*K;b[5]=Y*t+ta*F+ja*v;b[6]=Ba*l+Ua*C+h*I;b[7]=Ba*m+Ua*D+h*K;b[8]=Ba*t+Ua*F+h*v;l=a.getCachedZSortedEles();if(h=l.length,f.startFrame(b,c),c.screen){for(b=0;b<l.nondrag.length;b++)Ga(a,b,l.nondrag[b]);for(b=0;b<l.drag.length;b++)Ga(a,b,l.drag[b])}else if(c.picking)for(b=0;b<l.length;b++)Ga(a,b,l[b]);f.endFrame();c.screen&&a.webglDebugShowAtlases&&(b=a.data.contexts[a.NODE],b.save(),Rf(a,b),b.strokeStyle="rgba(0, 0, 0, 0.3)",b.beginPath(),b.moveTo(-1E3,0),b.lineTo(1E3,0),b.stroke(),b.beginPath(),
b.moveTo(0,-1E3),b.lineTo(0,1E3),b.stroke(),b.restore(),ka(a));a.data.canvasNeedsRedraw[a.NODE]=!1;a.data.canvasNeedsRedraw[a.DRAG]=!1}if(a.webglDebug){b=performance.now();d=Math.ceil(b-d);b=f.getDebugInfo();h=["".concat(h," elements"),"".concat(b.totalInstances," instances"),"".concat(b.batchCount," batches"),"".concat(b.totalAtlases," atlases"),"".concat(b.wrappedCount," wrapped textures"),"".concat(b.simpleCount," simple shapes")].join(", ");console.log("WebGL (".concat(c.name,") - frame time ").concat(d,
"ms"));console.log("Totals:");console.log("  ".concat(h));console.log("Texture Atlases Used:");c=y(b.atlasInfo);var ab;try{for(c.s();!(ab=c.n()).done;){var Qb=ab.value;console.log("  ".concat(Qb.type,": ").concat(Qb.keyCount," keys, ").concat(Qb.atlasCount," atlases"))}}catch(Mb){c.e(Mb)}finally{c.f()}console.log("")}a.data.gc&&(console.log("Garbage Collect!"),a.data.gc=!1,f.gc())}function Pa(a,b){a=atob(a);for(var c=new ArrayBuffer(a.length),d=new Uint8Array(c),f=0;f<a.length;f++)d[f]=a.charCodeAt(f);
return new Blob([c],{type:b})}function Ma(a){var b=a.indexOf(",");return a.substr(b+1)}function rb(a,b,c){switch(a.output){case "blob-promise":return new zh(function(d,f){try{b.toBlob(function(h){null!=h?d(h):f(Error("`canvas.toBlob()` sent a null value in its callback"))},c,a.quality)}catch(h){f(h)}});case "blob":return Pa(Ma(b.toDataURL(c,a.quality)),c);case "base64":return Ma(b.toDataURL(c,a.quality));default:return b.toDataURL(c,a.quality)}}function Gb(a){var b=this,c=b.cy.window().document;a.webgl&&
(Rc.CANVAS_LAYERS=b.CANVAS_LAYERS=4,console.log("webgl rendering enabled"));b.data={canvases:Array(Rc.CANVAS_LAYERS),contexts:Array(Rc.CANVAS_LAYERS),canvasNeedsRedraw:Array(Rc.CANVAS_LAYERS),bufferCanvases:Array(Rc.BUFFER_COUNT),bufferContexts:Array(Rc.CANVAS_LAYERS)};b.data.canvasContainer=c.createElement("div");var d=b.data.canvasContainer.style;b.data.canvasContainer.style["-webkit-tap-highlight-color"]="rgba(0,0,0,0)";d.position="relative";d.zIndex="0";d.overflow="hidden";d=a.cy.container();
d.appendChild(b.data.canvasContainer);d.style["-webkit-tap-highlight-color"]="rgba(0,0,0,0)";var f={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};ge&&ge.userAgent.match(/msie|trident|edge/i)&&(f["-ms-touch-action"]="none",f["touch-action"]="none");for(d=0;d<Rc.CANVAS_LAYERS;d++){var h=b.data.canvases[d]=c.createElement("canvas"),l=Rc.CANVAS_TYPES[d];b.data.contexts[d]=h.getContext(l);b.data.contexts[d]||
vd("Could not create canvas of type "+l);Object.keys(f).forEach(function(vb){h.style[vb]=f[vb]});h.style.position="absolute";h.setAttribute("data-id","layer"+d);h.style.zIndex=String(Rc.CANVAS_LAYERS-d);b.data.canvasContainer.appendChild(h);b.data.canvasNeedsRedraw[d]=!1}b.data.topCanvas=b.data.canvases[0];b.data.canvases[Rc.NODE].setAttribute("data-id","layer"+Rc.NODE+"-node");b.data.canvases[Rc.SELECT_BOX].setAttribute("data-id","layer"+Rc.SELECT_BOX+"-selectbox");b.data.canvases[Rc.DRAG].setAttribute("data-id",
"layer"+Rc.DRAG+"-drag");b.data.canvases[Rc.WEBGL]&&b.data.canvases[Rc.WEBGL].setAttribute("data-id","layer"+Rc.WEBGL+"-webgl");for(d=0;d<Rc.BUFFER_COUNT;d++)b.data.bufferCanvases[d]=c.createElement("canvas"),b.data.bufferContexts[d]=b.data.bufferCanvases[d].getContext("2d"),b.data.bufferCanvases[d].style.position="absolute",b.data.bufferCanvases[d].setAttribute("data-id","buffer"+d),b.data.bufferCanvases[d].style.zIndex=String(-d-1),b.data.bufferCanvases[d].style.visibility="hidden";b.pathsEnabled=
!0;var m=ae(),t=function(vb){return{x:-vb.w/2,y:-vb.h/2}};c=function(vb){return vb[0]._private.nodeKey};d=function(vb){return vb[0]._private.labelStyleKey};l=function(vb){return vb[0]._private.sourceLabelStyleKey};var v=function(vb){return vb[0]._private.targetLabelStyleKey},C=function(vb,Tb,jc,kc,tc){return b.drawElement(vb,Tb,jc,!1,!1,tc)},D=function(vb,Tb,jc,kc,tc){return b.drawElementText(vb,Tb,jc,kc,"main",tc)},F=function(vb,Tb,jc,kc,tc){return b.drawElementText(vb,Tb,jc,kc,"source",tc)},I=function(vb,
Tb,jc,kc,tc){return b.drawElementText(vb,Tb,jc,kc,"target",tc)},K=function(vb){return vb.boundingBox(),vb[0]._private.bodyBounds},P=function(vb){return vb.boundingBox(),vb[0]._private.labelBounds.main||m},ba=function(vb){return vb.boundingBox(),vb[0]._private.labelBounds.source||m},X=function(vb){return vb.boundingBox(),vb[0]._private.labelBounds.target||m},Y=function(vb,Tb){return Tb},ta=function(vb){vb=K(vb);return{x:(vb.x1+vb.x2)/2,y:(vb.y1+vb.y2)/2}},ja=function(vb,Tb,jc){vb=vb?vb+"-":"";return{x:Tb.x+
jc.pstyle(vb+"text-margin-x").pfValue,y:Tb.y+jc.pstyle(vb+"text-margin-y").pfValue}},Ba=function(vb,Tb,jc){vb=vb[0]._private.rscratch;return{x:vb[Tb],y:vb[jc]}},Ua=function(vb){return ja("",Ba(vb,"labelX","labelY"),vb)},ab=function(vb){return ja("source",Ba(vb,"sourceLabelX","sourceLabelY"),vb)},Qb=function(vb){return ja("target",Ba(vb,"targetLabelX","targetLabelY"),vb)},Mb=function(vb){return t(K(vb))},Ub=function(vb){return t(ba(vb))},Wb=function(vb){return t(X(vb))},Yb=function(vb){var Tb=P(vb),
jc=t(P(vb));if(vb.isNode()){switch(vb.pstyle("text-halign").value){case "left":jc.x=-Tb.w-(Tb.leftPad||0);break;case "right":jc.x=-(Tb.rightPad||0)}switch(vb.pstyle("text-valign").value){case "top":jc.y=-Tb.h-(Tb.topPad||0);break;case "bottom":jc.y=-(Tb.botPad||0)}}return jc},ub=b.data.eleTxrCache=new fi(b,{getKey:c,doesEleInvalidateKey:function(vb){vb=vb[0]._private;return vb.oldBackgroundTimestamp!==vb.backgroundTimestamp},drawElement:C,getBoundingBox:K,getRotationPoint:ta,getRotationOffset:Mb,
allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),Kb=b.data.lblTxrCache=new fi(b,{getKey:d,drawElement:D,getBoundingBox:P,getRotationPoint:Ua,getRotationOffset:Yb,isVisible:Y}),Zb=b.data.slbTxrCache=new fi(b,{getKey:l,drawElement:F,getBoundingBox:ba,getRotationPoint:ab,getRotationOffset:Ub,isVisible:Y}),dc=b.data.tlbTxrCache=new fi(b,{getKey:v,drawElement:I,getBoundingBox:X,getRotationPoint:Qb,getRotationOffset:Wb,isVisible:Y}),ac=b.data.lyrTxrCache=new gn(b);b.onUpdateEleCalcs(function(vb,Tb){ub.invalidateElements(Tb);
Kb.invalidateElements(Tb);Zb.invalidateElements(Tb);dc.invalidateElements(Tb);ac.invalidateElements(Tb);for(vb=0;vb<Tb.length;vb++){var jc=Tb[vb]._private;jc.oldBackgroundTimestamp=jc.backgroundTimestamp}});Y=function(vb){for(var Tb=0;Tb<vb.length;Tb++)ac.enqueueElementRefinement(vb[Tb].ele)};ub.onDequeue(Y);Kb.onDequeue(Y);Zb.onDequeue(Y);dc.onDequeue(Y);a.webgl&&b.initWebgl(a,{getStyleKey:c,getLabelKey:d,getSourceLabelKey:l,getTargetLabelKey:v,drawElement:C,drawLabel:D,drawSourceLabel:F,drawTargetLabel:I,
getElementBox:K,getLabelBox:P,getSourceLabelBox:ba,getTargetLabelBox:X,getElementRotationPoint:ta,getElementRotationOffset:Mb,getLabelRotationPoint:Ua,getSourceLabelRotationPoint:ab,getTargetLabelRotationPoint:Qb,getLabelRotationOffset:Yb,getSourceLabelRotationOffset:Ub,getTargetLabelRotationOffset:Wb})}function gc(a,b,c){var d=c,f=function(K){fd("Can not register `"+b+"` for `"+a+"` since `"+K+"` already exists in the prototype and can not be overridden")};if("core"===a){if(gi.prototype[b])return f(b);
gi.prototype[b]=c}else if("collection"===a){if(be.prototype[b])return f(b);be.prototype[b]=c}else if("layout"===a){f=function(K){this.options=K;c.call(this,K);Zc(this._private)||(this._private={});this._private.cy=K.cy;this._private.listeners=[];this.createEmitter()};var h=f.prototype=Object.create(c.prototype),l=[];for(d=0;d<l.length;d++){var m=l[d];h[m]=h[m]||function(){return this}}h.start&&!h.run?h.run=function(){return this.start(),this}:!h.start&&h.run&&(h.start=function(){return this.run(),
this});var t=c.prototype.stop;h.stop=function(){var K=this.options;if(K&&K.animate&&(K=this.animations))for(var P=0;P<K.length;P++)K[P].stop();return t?t.call(this):this.emit("layoutstop"),this};h.destroy||(h.destroy=function(){return this});h.cy=function(){return this._private.cy};var v={addEventFields:function(K,P){P.layout=K;P.cy=K._private.cy;P.target=K},bubble:function(){return!0},parent:function(K){return K._private.cy}};Bc(h,{createEmitter:function(){return this._private.emitter=new A(v,this),
this},emitter:function(){return this._private.emitter},on:function(K,P){return this.emitter().on(K,P),this},one:function(K,P){return this.emitter().one(K,P),this},once:function(K,P){return this.emitter().one(K,P),this},removeListener:function(K,P){return this.emitter().removeListener(K,P),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(K,P){return this.emitter().emit(K,P),this}});ld.eventAliasesOn(h);d=f}else if("renderer"===a&&"null"!==b&&"base"!==
b){var C=Lc("renderer","base");d=C.prototype;m=c.prototype;var D=function(){C.apply(this,arguments);c.apply(this,arguments)},F=D.prototype;for(h in d){var I=d[h];if(null!=m[h])return f(h);F[h]=I}for(l in m)F[l]=m[l];d.clientFunctions.forEach(function(K){F[K]=F[K]||function(){vd("Renderer does not implement `renderer."+K+"()` on its prototype")}});d=D}else if("__proto__"===a||"constructor"===a||"prototype"===a)return vd(a+" is an illegal type to be registered, possibly lead to prototype pollutions");
return jh({map:hn,keys:[a,b],value:d})}function Lc(a,b){return Vh({map:hn,keys:[a,b]})}function Oc(a,b,c,d,f){return jh({map:jn,keys:[a,b,c,d],value:f})}function Dd(a,b,c,d){return Vh({map:jn,keys:[a,b,c,d]})}var Uc="u"<typeof window?null:window,ge=Uc?Uc.navigator:null;Uc&&Uc.document;var If=T(""),Jf=T({}),Nh=T(function(){}),se="u"<typeof HTMLElement?"undefined":T(HTMLElement),$e=function(a){return a&&a.instanceString&&Gc(a.instanceString)?a.instanceString():null},rc=function(a){return null!=a&&T(a)==
If},Gc=function(a){return null!=a&&T(a)===Nh},kd=function(a){return!$d(a)&&(Array.isArray?Array.isArray(a):null!=a&&a instanceof Array)},Zc=function(a){return null!=a&&T(a)===Jf&&!kd(a)&&a.constructor===Object},cc=function(a){return null!=a&&T(a)===T(1)&&!isNaN(a)},Bi=function(a){return cc(a)&&Math.floor(a)===a},ig=function(a){if("undefined"!==se)return null!=a&&a instanceof HTMLElement},$d=function(a){return Kf(a)||Qh(a)},Kf=function(a){return"collection"===$e(a)&&a._private.single},Qh=function(a){return"collection"===
$e(a)&&!a._private.single},Fe=function(a){return null==a?!0:!(""!==a&&!a.match(/^\s+$/))},Uh=function(a){return null!=a&&T(a)===Jf&&Gc(a.then)},tf=function(a,b){b||=function(){if(1===arguments.length)return arguments[0];if(0===arguments.length)return"undefined";for(var d=[],f=0;f<arguments.length;f++)d.push(arguments[f]);return d.join("$")};var c=function(){var d=arguments,f,h=b.apply(this,d),l=c.cache;return(f=l[h])||(f=l[h]=a.apply(this,d)),f};return c.cache={},c},hh=tf(function(a){return a.replace(/([A-Z])/g,
function(b){return"-"+b.toLowerCase()})}),tg=tf(function(a){return a.replace(/(-\w)/g,function(b){return b[1].toUpperCase()})}),ih=tf(function(a,b){return a+b[0].toUpperCase()+b.substring(1)},function(a,b){return a+"$"+b}),ug=function(a){return Fe(a)?a:a.charAt(0).toUpperCase()+a.substring(1)},Bc=null!=Object.assign?Object.assign.bind(Object):function(a){for(var b=arguments,c=1;c<b.length;c++){var d=b[c];if(null!=d)for(var f=Object.keys(d),h=0;h<f.length;h++){var l=f[h];a[l]=d[l]}}return a},Ne=function(a){function b(m,
t,v){return 0>v&&(v+=1),1<v&&--v,v<1/6?m+6*(t-m)*v:.5>v?t:v<2/3?m+(t-m)*(2/3-v)*6:m}var c,d,f,h,l;if(a=RegExp("^hsl[a]?\\(((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])(?:\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)$").exec(a)){if(d=parseInt(a[1]),0>d?d=(360- -1*d%360)%360:360<d&&(d%=360),d/=360,f=parseFloat(a[2]),0>f||100<f||(f/=100,h=parseFloat(a[3]),
0>h||100<h)||(h/=100,l=a[4],void 0!==l&&(l=parseFloat(l),0>l||1<l)))return;0===f?h=c=d=Math.round(255*h):(f=.5>h?h*(1+f):h+f-h*f,a=2*h-f,h=Math.round(255*b(a,f,d+1/3)),c=Math.round(255*b(a,f,d)),d=Math.round(255*b(a,f,d-1/3)));c=[h,c,d,l]}return c},Oj=function(a){if(a=RegExp("^rgb[a]?\\(((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)(?:\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)$").exec(a)){var b=
[];for(var c=[],d=1;3>=d;d++){var f=a[d];if("%"===f[f.length-1]&&(c[d]=!0),f=parseFloat(f),c[d]&&(f=f/100*255),0>f||255<f)return;b.push(Math.floor(f))}d=c[1]&&c[2]&&c[3];if((c[1]||c[2]||c[3])&&!d)return;a=a[4];if(void 0!==a){if(a=parseFloat(a),0>a||1<a)return;b.push(a)}}return b},Sf=function(a){var b;if(!(b=(kd(a)?a:null)||Xd[a.toLowerCase()]))if(4!==a.length&&7!==a.length||"#"!==a[0])b=void 0;else{var c,d,f;b=(4===a.length?(c=parseInt(a[1]+a[1],16),d=parseInt(a[2]+a[2],16),f=parseInt(a[3]+a[3],16)):
(c=parseInt(a[1]+a[2],16),d=parseInt(a[3]+a[4],16),f=parseInt(a[5]+a[6],16)),[c,d,f])}return b||Oj(a)||Ne(a)},Xd={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],
cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,
206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,
255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],
lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,
0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,
164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},jh=function(a){for(var b=
a.map,c=a.keys,d=c.length,f=0;f<d;f++){var h=c[f];if(Zc(h))throw Error("Tried to set map with object key");f<c.length-1?(null==b[h]&&(b[h]={}),b=b[h]):b[h]=a.value}},Vh=function(a){var b=a.map;a=a.keys;for(var c=a.length,d=0;d<c;d++){var f=a[d];if(Zc(f))throw Error("Tried to get map with object key");if(b=b[f],null==b)break}return b},vf="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof global?global:"u">typeof self?self:{},uf,Wh,jg,Oh,Xg,Tf,ye,kh,lh,xi,Xh,Yh,Zh,Di,mh,Ci,bh,Ei,le,
me,nh,yi,Zg,Ph,$g,Yg,ah,Rh,Fi=function(){if(Rh)return ah;Rh=1;var a=Da(),b=ua(),c=zb(),d=Math.max,f=Math.min;return ah=function(h,l,m){function t(ab){var Qb=I,Mb=K;return I=K=void 0,ta=ab,ba=h.apply(Mb,Qb),ba}function v(ab){var Qb=ab-Y;ab-=ta;return void 0===Y||Qb>=l||0>Qb||Ba&&ab>=P}function C(){var ab=b();if(v(ab))return D(ab);var Qb=setTimeout;var Mb=ab-ta;ab=l-(ab-Y);Mb=Ba?f(ab,P-Mb):ab;X=Qb(C,Mb)}function D(ab){return X=void 0,Ua&&I?t(ab):(I=K=void 0,ba)}function F(){var ab=b(),Qb=v(ab);if(I=
arguments,K=this,Y=ab,Qb){if(void 0===X)return ab=Y,ta=ab,X=setTimeout(C,l),ja?t(ab):ba;if(Ba)return clearTimeout(X),X=setTimeout(C,l),t(Y)}return void 0===X&&(X=setTimeout(C,l)),ba}var I,K,P,ba,X,Y,ta=0,ja=!1,Ba=!1,Ua=!0;if("function"!=typeof h)throw new TypeError("Expected a function");l=c(l)||0;a(m)&&(ja=!!m.leading,Ba="maxWait"in m,P=Ba?d(c(m.maxWait)||0,l):P,Ua="trailing"in m?!!m.trailing:Ua);return F.cancel=function(){void 0!==X&&clearTimeout(X);ta=0;I=Y=K=X=void 0},F.flush=function(){return void 0===
X?ba:D(b())},F},ah}(),ne=ha(Fi),oh=Uc?Uc.performance:null,Be=oh&&oh.now?function(){return oh.now()}:function(){return Date.now()},te=function(){if(Uc){if(Uc.requestAnimationFrame)return function(a){Uc.requestAnimationFrame(a)};if(Uc.mozRequestAnimationFrame)return function(a){Uc.mozRequestAnimationFrame(a)};if(Uc.webkitRequestAnimationFrame)return function(a){Uc.webkitRequestAnimationFrame(a)};if(Uc.msRequestAnimationFrame)return function(a){Uc.msRequestAnimationFrame(a)}}return function(a){a&&setTimeout(function(){a(Be())},
1E3/60)}}(),sd=function(a){for(var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:9261,c;c=a.next(),!c.done;)b=65599*b+c.value|0;return b},Rd=function(a){return 65599*(1<arguments.length&&void 0!==arguments[1]?arguments[1]:9261)+a|0},xf=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:5381;return(b<<5)+b+a|0},Qd=function(a){return 2097152*a[0]+a[1]},Oe=function(a,b){return[Rd(a[0],b[0]),xf(a[1],b[1])]},Gi=function(a,b){var c={value:0,done:!1},d=0,f=a.length;return sd({next:function(){return d<
f?c.value=a[d++]:c.done=!0,c}},b)},wf=function(a,b){var c={value:0,done:!1},d=0,f=a.length;return sd({next:function(){return d<f?c.value=a.charCodeAt(d++):c.done=!0,c}},b)},zi=function(){for(var a=arguments,b,c=0;c<a.length;c++){var d=a[c];0===c?b=wf(d):b=wf(d,b)}return b},ph=!0,Pj=null!=console.warn,Hi=null!=console.trace,Uf=Number.MAX_SAFE_INTEGER||9007199254740991,$h=function(){return!0},qh=function(){return!1},vg=function(){return 0},wg=function(){},vd=function(a){throw Error(a);},ai=function(a){if(void 0!==
a)ph=!!a;else return ph},fd=function(a){ai()&&(Pj?console.warn(a):(console.log(a),Hi&&console.trace()))},Ce=function(a){return null==a?a:kd(a)?a.slice():Zc(a)?Bc({},a):a},Ii=function(a,b){for(b=a="";36>a++;b+=51*a&52?(a^15?8^Math.random()*(a^20?16:4):4).toString(16):"-");return b},Ji={},Id=function(a){var b=Object.keys(a);return function(c){for(var d={},f=0;f<b.length;f++){var h=b[f],l=c?.[h];d[h]=void 0===l?a[h]:l}return d}},ff=function(a,b,c){for(c=a.length-1;0<=c;c--)a[c]===b&&a.splice(c,1)},bi=
function(a){a.splice(0,a.length)},ad=function(a,b){for(var c=0;c<b.length;c++)a.push(b[c])},Ed=function(a,b,c){return c&&(b=ih(c,b)),a[b]},He=function(a,b,c,d){c&&(b=ih(c,b));a[b]=d},Ki=function(){function a(){u(this,a);this._obj={}}return w(a,[{key:"set",value:function(b,c){return this._obj[b]=c,this}},{key:"delete",value:function(b){return this._obj[b]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(b){return void 0!==this._obj[b]}},{key:"get",value:function(b){return this._obj[b]}}])}(),
Pe="u">typeof Map?Map:Ki,Qj=function(){function a(b){if(u(this,a),this._obj=Object.create(null),this.size=0,null!=b){var c;null!=b.instanceString&&b.instanceString()===this.instanceString()?c=b.toArray():c=b;for(b=0;b<c.length;b++)this.add(c[b])}}return w(a,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(b){var c=this._obj;1!==c[b]&&(c[b]=1,this.size++)}},{key:"delete",value:function(b){var c=this._obj;1===c[b]&&(c[b]=0,this.size--)}},{key:"clear",value:function(){this._obj=
Object.create(null)}},{key:"has",value:function(b){return 1===this._obj[b]}},{key:"toArray",value:function(){var b=this;return Object.keys(this._obj).filter(function(c){return b.has(c)})}},{key:"forEach",value:function(b,c){return this.toArray().forEach(b,c)}}])}(),rf="undefined"!==("u"<typeof Set?"undefined":T(Set))?Set:Qj,kg=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0;if(void 0===a||void 0===b||"core"!==$e(a))vd("An element must have a core reference and parameters set");
else{var d=b.group;if(null==d&&(b.data&&null!=b.data.source&&null!=b.data.target?d="edges":d="nodes"),"nodes"!==d&&"edges"!==d)vd("An element must be of type `nodes` or `edges`; you specified `"+d+"`");else{this.length=1;this[0]=this;d=this._private={cy:a,single:!0,data:b.data||{},position:b.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:d,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!b.selected,selectable:void 0===
b.selectable?!0:!!b.selectable,locked:!!b.locked,grabbed:!1,grabbable:void 0===b.grabbable?!0:!!b.grabbable,pannable:void 0===b.pannable?"edges"===d:!!b.pannable,active:!1,classes:new rf,animation:{current:[],queue:[]},rscratch:{},scratch:b.scratch||{},edges:[],children:[],parent:b.parent&&b.parent.isNode()?b.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,
target:null,"mid-source":null,"mid-target":null}};if(null==d.position.x&&(d.position.x=0),null==d.position.y&&(d.position.y=0),b.renderedPosition){var f=b.renderedPosition,h=a.pan(),l=a.zoom();d.position={x:(f.x-h.x)/l,y:(f.y-h.y)/l}}f=[];kd(b.classes)?f=b.classes:rc(b.classes)&&(f=b.classes.split(/\s+/));h=0;for(l=f.length;h<l;h++){var m=f[h];!m||""===m||d.classes.add(m)}this.createEmitter();(void 0===c||c)&&this.restore();(c=b.style||b.css)&&(fd("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),
this.style(c))}}},Qe=function(a){return a={bfs:a.bfs||!a.dfs,dfs:a.dfs||!a.bfs},function(b,c,d){var f;Zc(b)&&!$d(b)&&(f=b,b=f.roots||f.root,c=f.visit,d=f.directed);d=2!==arguments.length||Gc(c)?d:c;c=Gc(c)?c:function(){};f=this._private.cy;var h=b=rc(b)?this.filter(b):b,l=[],m=[],t={},v={},C={},D=0,F,I=this.byGroup(),K=I.nodes,P=I.edges;for(I=0;I<h.length;I++){var ba=h[I],X=ba.id();ba.isNode()&&(l.unshift(ba),a.bfs&&(C[X]=!0,m.push(ba)),v[X]=0)}h=function(){var ta=a.bfs?l.shift():l.pop(),ja=ta.id();
if(a.dfs){if(C[ja])return 0;C[ja]=!0;m.push(ta)}var Ba=v[ja],Ua=t[ja],ab=null!=Ua?Ua.source():null,Qb=null!=Ua?Ua.target():null;ab=null==Ua?void 0:ta.same(ab)?Qb[0]:ab[0];var Mb;if(Mb=c(ta,Ua,ab,D++,Ba),!0===Mb)return F=ta,1;if(!1===Mb)return 1;Ba=ta.connectedEdges().filter(function(Ub){return(!d||Ub.source().same(ta))&&P.has(Ub)});for(Ua=0;Ua<Ba.length;Ua++)Mb=Ba[Ua],ab=Mb.connectedNodes().filter(function(Ub){return!Ub.same(ta)&&K.has(Ub)}),Qb=ab.id(),0!==ab.length&&!C[Qb]&&(ab=ab[0],l.push(ab),
a.bfs&&(C[Qb]=!0,m.push(ab)),t[Qb]=Mb,v[Qb]=v[ja]+1)};for(var Y;0!==l.length&&(Y=h(),0===Y||1!==Y););Y=f.collection();for(h=0;h<m.length;h++)I=m[h],ba=t[I.id()],null!=ba&&Y.push(ba),Y.push(I);return{path:f.collection(Y),found:f.collection(F)}}},lg={breadthFirstSearch:Qe({bfs:!0}),depthFirstSearch:Qe({dfs:!0})};lg.bfs=lg.breadthFirstSearch;lg.dfs=lg.depthFirstSearch;var mg={exports:{}},ch=mg.exports,Ai,qg,cf,Rj=(cf||(cf=1,qg=gb()),qg),xg=ha(Rj),Sj=Id({root:null,weight:function(a){return 1},directed:!1}),
Li=Id({root:null,goal:null,weight:function(a){return 1},heuristic:function(a){return 0},directed:!1}),yg=Id({weight:function(a){return 1},directed:!1}),Tj=Id({weight:function(a){return 1},directed:!1,root:null}),gh=Math.sqrt(2),zg=function(a,b,c,d){for(;c>d;){var f=Math.floor(Math.random()*b.length),h=a,l=b;0===l.length&&vd("Karger-Stein must be run on a connected (sub)graph");b=l[f];f=h[b[1]];b=h[b[2]];for(var m=l.length-1;0<=m;m--){var t=l[m],v=t[1];t=t[2];(h[v]===f&&h[t]===b||h[v]===b&&h[t]===
f)&&l.splice(m,1)}for(m=0;m<l.length;m++)v=l[m],v[1]===b?(l[m]=v.slice(),l[m][1]=f):v[2]===b&&(l[m]=v.slice(),l[m][2]=f);for(m=0;m<h.length;m++)h[m]===b&&(h[m]=f);b=l;c--}return b},rh=function(a,b,c){return{x:a.x*b+c.x,y:a.y*b+c.y}},Vf=function(a){return{x:a[0],y:a[1]}},ci=function(a){for(var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:a.length,c=1/0,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;d<b;d++){var f=a[d];isFinite(f)&&(c=Math.min(f,c))}return c},fh=function(a){for(var b=
2<arguments.length&&void 0!==arguments[2]?arguments[2]:a.length,c=-1/0,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;d<b;d++){var f=a[d];isFinite(f)&&(c=Math.max(f,c))}return c},Mj=function(a){for(var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:a.length,c=0,d=0,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;f<b;f++){var h=a[f];isFinite(h)&&(c+=h,d++)}return c/d},Nj=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&
void 0!==arguments[2]?arguments[2]:a.length,d=4<arguments.length&&void 0!==arguments[4]?arguments[4]:!0,f=5<arguments.length&&void 0!==arguments[5]?arguments[5]:!0;(3<arguments.length&&void 0!==arguments[3]?arguments[3]:1)?a=a.slice(b,c):(c<a.length&&a.splice(c,a.length-c),0<b&&a.splice(0,b));b=0;for(c=a.length-1;0<=c;c--){var h=a[c];f?isFinite(h)||(a[c]=-1/0,b++):a.splice(c,1)}d&&a.sort(function(l,m){return l-m});d=a.length;f=Math.floor(d/2);return 0!==d%2?a[f+1+b]:(a[f-1+b]+a[f+b])/2},Th=Math.log2||
function(a){return Math.log(a)/Math.log(2)},gf=function(a,b){return Math.sqrt(yf(a,b))},yf=function(a,b){var c=b.x-a.x;a=b.y-a.y;return c*c+a*a},Uj=function(a){for(var b=a.length,c=0,d=0;d<b;d++)c+=a[d];for(d=0;d<b;d++)a[d]/=c;return a},Jd=function(a,b,c,d){return(1-d)*(1-d)*a+2*(1-d)*d*b+d*d*c},Wf=function(a,b,c,d){return{x:Jd(a.x,b.x,c.x,d),y:Jd(a.y,b.y,c.y,d)}},Ag=function(a,b,c){return Math.max(a,Math.min(c,b))},ae=function(a){if(null==a)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(null!=
a.x1&&null!=a.y1){if(null!=a.x2&&null!=a.y2&&a.x2>=a.x1&&a.y2>=a.y1)return{x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,w:a.x2-a.x1,h:a.y2-a.y1};if(null!=a.w&&null!=a.h&&0<=a.w&&0<=a.h)return{x1:a.x1,y1:a.y1,x2:a.x1+a.w,y2:a.y1+a.h,w:a.w,h:a.h}}},sh=function(a){return{x1:a.x1,x2:a.x2,w:a.w,y1:a.y1,y2:a.y2,h:a.h}},Mi=function(a){a.x1=1/0;a.y1=1/0;a.x2=-1/0;a.y2=-1/0;a.w=0;a.h=0},Bg=function(a,b){a.x1=Math.min(a.x1,b.x1);a.x2=Math.max(a.x2,b.x2);a.w=a.x2-a.x1;a.y1=Math.min(a.y1,b.y1);a.y2=Math.max(a.y2,b.y2);a.h=
a.y2-a.y1},vh=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return a.x1-=b,a.x2+=b,a.y1-=b,a.y2+=b,a.w=a.x2-a.x1,a.h=a.y2-a.y1,a},uh=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0],c,d,f;if(1===b.length)var h=c=d=f=b[0];else 2===b.length?(h=d=b[0],f=c=b[1]):4===b.length&&(b=z(b,4),h=b[0],c=b[1],d=b[2],f=b[3]);return a.x1-=f,a.x2+=c,a.y1-=h,a.y2+=d,a.w=a.x2-a.x1,a.h=a.y2-a.y1,a},th=function(a,b){a.x1=b.x1;a.y1=b.y1;a.x2=b.x2;a.y2=b.y2;a.w=a.x2-
a.x1;a.h=a.y2-a.y1},zf=function(a,b){return!(a.x1>b.x2||b.x1>a.x2||a.x2<b.x1||b.x2<a.x1||a.y2<b.y1||b.y2<a.y1||a.y1>b.y2||b.y1>a.y2)},Af=function(a,b,c){return a.x1<=b&&b<=a.x2&&a.y1<=c&&c<=a.y2},Vj=function(a,b){return Af(a,b.x,b.y)},Wj=function(a,b){return Af(a,b.x1,b.y1)&&Af(a,b.x2,b.y2)},Cg=function(a,b,c,d,f,h,l){var m=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"auto";m="auto"===m?Ue(f,h):m;var t=f/2,v=h/2;m=Math.min(m,t,v);var C=m!==t,D=m!==v,F;if(C){var I=d-v-l;if(F=Te(a,b,c,d,
c-t+m-l,I,c+t-m+l,I,!1),0<F.length)return F}if(D&&(I=c+t+l,F=Te(a,b,c,d,I,d-v+m-l,I,d+v-m+l,!1),0<F.length)||C&&(C=d+v+l,F=Te(a,b,c,d,c-t+m-l,C,c+t-m+l,C,!1),0<F.length)||D&&(D=c-t-l,F=Te(a,b,c,d,D,d-v+m-l,D,d+v-m+l,!1),0<F.length))return F;var K;F=c-t+m;D=d-v+m;if(K=re(a,b,c,d,F,D,m+l),0<K.length&&K[0]<=F&&K[1]<=D)return[K[0],K[1]];F=c+t-m;D=d-v+m;if(K=re(a,b,c,d,F,D,m+l),0<K.length&&K[0]>=F&&K[1]<=D)return[K[0],K[1]];F=c+t-m;D=d+v-m;if(K=re(a,b,c,d,F,D,m+l),0<K.length&&K[0]>=F&&K[1]>=D)return[K[0],
K[1]];t=c-t+m;v=d+v-m;return(K=re(a,b,c,d,t,v,m+l),0<K.length&&K[0]<=t&&K[1]>=v)?[K[0],K[1]]:[]},Ni=function(a,b,c,d){c=b*b-4*a*(c-d);if(0>c)return[];c=Math.sqrt(c);a*=2;return[(-b+c)/a,(-b-c)/a]},ie=function(a,b,c){for(var d,f,h,l,m=0,t=0;t<c.length/2;t++)if(d=c[2*t],f=c[2*t+1],t+1<c.length/2?(h=c[2*(t+1)],l=c[2*(t+1)+1]):(h=c[2*(t+1-c.length/2)],l=c[2*(t+1-c.length/2)+1]),d!=a||h!=a)if(d>=a&&a>=h||d<=a&&a<=h)f=(a-d)/(h-d)*(l-f)+f,f>b&&m++;return 0!==m%2},De=function(a,b,c,d,f,h,l,m,t){var v=Array(c.length),
C;null!=m[0]?(C=Math.atan(m[1]/m[0]),0>m[0]?C+=Math.PI/2:C=-C-Math.PI/2):C=m;m=Math.cos(-C);C=Math.sin(-C);for(var D=0;D<v.length/2;D++)v[2*D]=h/2*(c[2*D]*m-c[2*D+1]*C),v[2*D+1]=l/2*(c[2*D+1]*m+c[2*D]*C),v[2*D]+=d,v[2*D+1]+=f;0<t?(c=Bf(v,-t),c=Dg(c)):c=v;return ie(a,b,c)},Dg=function(a){for(var b=Array(a.length/2),c,d,f,h,l,m,t,v,C=0;C<a.length/4;C++)c=a[4*C],d=a[4*C+1],f=a[4*C+2],h=a[4*C+3],C<a.length/4-1?(l=a[4*(C+1)],m=a[4*(C+1)+1],t=a[4*(C+1)+2],v=a[4*(C+1)+3]):(l=a[0],m=a[1],t=a[2],v=a[3]),c=
Te(c,d,f,h,l,m,t,v,!0),b[2*C]=c[0],b[2*C+1]=c[1];return b},Bf=function(a,b){for(var c=Array(2*a.length),d,f,h,l,m=0;m<a.length/2;m++){d=a[2*m];f=a[2*m+1];m<a.length/2-1?(h=a[2*(m+1)],l=a[2*(m+1)+1]):(h=a[0],l=a[1]);var t=l-f,v=-(h-d),C=Math.sqrt(t*t+v*v);t/=C;v/=C;c[4*m]=d+t*b;c[4*m+1]=f+v*b;c[4*m+2]=h+t*b;c[4*m+3]=l+v*b}return c},Se=function(a,b,c,d,f,h,l){return a-=f,b-=h,a/=c/2+l,b/=d/2+l,1>=a*a+b*b},re=function(a,b,c,d,f,h,l){c=[c-a,d-b];d=[a-f,b-h];f=c[0]*c[0]+c[1]*c[1];h=2*(d[0]*c[0]+d[1]*c[1]);
d=h*h-4*f*(d[0]*d[0]+d[1]*d[1]-l*l);if(0>d)return[];l=(-h+Math.sqrt(d))/(2*f);h=(-h-Math.sqrt(d))/(2*f);f=Math.min(l,h);h=Math.max(l,h);l=[];if(0<=f&&1>=f&&l.push(f),0<=h&&1>=h&&l.push(h),0===l.length)return[];f=l[0]*c[0]+a;h=l[0]*c[1]+b;return 1<l.length?l[0]==l[1]?[f,h]:[f,h,l[1]*c[0]+a,l[1]*c[1]+b]:[f,h]},Cf=function(a,b,c){return b<=a&&a<=c||c<=a&&a<=b?a:a<=b&&b<=c||c<=b&&b<=a?b:c},Te=function(a,b,c,d,f,h,l,m,t){var v=a-f,C=c-a,D=l-f,F=b-h,I=d-b,K=m-h,P=D*F-K*v;v=C*F-I*v;D=K*C-D*I;return 0!==
D?(c=P/D,d=v/D,-.001<=c&&1.001>=c&&-.001<=d&&1.001>=d?[a+c*C,b+c*I]:t?[a+c*C,b+c*I]:[]):0===P||0===v?Cf(a,c,l)===l?[l,m]:Cf(a,c,f)===f?[f,h]:Cf(f,l,c)===c?[c,d]:[]:[]},Eg=function(a,b,c,d,f,h,l,m){var t=[],v=Array(c.length),C=!0;null==h&&(C=!1);if(C){for(C=0;C<v.length/2;C++)v[2*C]=c[2*C]*h+d,v[2*C+1]=c[2*C+1]*l+f;0<m?(c=Bf(v,-m),c=Dg(c)):c=v}var D,F;for(h=0;h<c.length/2;h++)l=c[2*h],m=c[2*h+1],h<c.length/2-1?(D=c[2*(h+1)],F=c[2*(h+1)+1]):(D=c[0],F=c[1]),l=Te(a,b,d,f,l,m,D,F),0!==l.length&&t.push(l[0],
l[1]);return t},Fg=function(a,b,c,d,f,h,l,m,t){var v=[],C=Array(2*c.length);t.forEach(function(F,I){0===I?(C[C.length-2]=F.startX,C[C.length-1]=F.startY):(C[4*I-2]=F.startX,C[4*I-1]=F.startY);C[4*I]=F.stopX;C[4*I+1]=F.stopY;D=re(a,b,d,f,F.cx,F.cy,F.radius);0!==D.length&&v.push(D[0],D[1])});for(c=0;c<C.length/4;c++){var D=Te(a,b,d,f,C[4*c],C[4*c+1],C[4*c+2],C[4*c+3],!1);0!==D.length&&v.push(D[0],D[1])}if(2<v.length){c=[v[0],v[1]];h=Math.pow(c[0]-a,2)+Math.pow(c[1]-b,2);for(l=1;l<v.length/2;l++)m=Math.pow(v[2*
l]-a,2)+Math.pow(v[2*l+1]-b,2),m<=h&&(c[0]=v[2*l],c[1]=v[2*l+1],h=m);return c}return v},Mf=function(a,b,c){a=[a[0]-b[0],a[1]-b[1]];var d=Math.sqrt(a[0]*a[0]+a[1]*a[1]);c=(d-c)/d;return 0>c&&(c=1E-5),[b[0]+c*a[0],b[1]+c*a[1]]},Yd=function(a,b){a=wh(a,b);return a=Oi(a),a},Oi=function(a){for(var b,c,d=a.length/2,f=1/0,h=1/0,l=-1/0,m=-1/0,t=0;t<d;t++)b=a[2*t],c=a[2*t+1],f=Math.min(f,b),l=Math.max(l,b),h=Math.min(h,c),m=Math.max(m,c);t=2/(l-f);for(var v=2/(m-h),C=0;C<d;C++)b=a[2*C]*=t,c=a[2*C+1]*=v,f=
Math.min(f,b),l=Math.max(l,b),h=Math.min(h,c),m=Math.max(m,c);if(-1>h)for(b=0;b<d;b++)a[2*b+1]+=-1-h;return a},wh=function(a,b){var c=1/a*2*Math.PI,d=0===a%2?Math.PI/2+c/2:Math.PI/2;d+=b;b=Array(2*a);for(var f,h=0;h<a;h++)f=h*c+d,b[2*h]=Math.cos(f),b[2*h+1]=Math.sin(-f);return b},Ue=function(a,b){return Math.min(a/4,b/4,8)},xh=function(a,b){return{heightOffset:Math.min(15,.05*b),widthOffset:Math.min(100,.25*a),ctrlPtOffsetPct:.05}},Pi=Id({dampingFactor:.8,precision:1E-6,iterations:200,weight:function(a){return 1}}),
sf=Id({root:null,weight:function(a){return 1},directed:!1,alpha:0}),hf={degreeCentralityNormalized:function(a){a=sf(a);var b=this.cy(),c=this.nodes(),d=c.length;if(a.directed){for(var f={},h={},l=0,m=0,t=0;t<d;t++){var v=c[t],C=v.id();a.root=v;v=this.degreeCentrality(a);l<v.indegree&&(l=v.indegree);m<v.outdegree&&(m=v.outdegree);f[C]=v.indegree;h[C]=v.outdegree}return{indegree:function(I){return 0==l?0:(rc(I)&&(I=b.filter(I)),f[I.id()]/l)},outdegree:function(I){return 0===m?0:(rc(I)&&(I=b.filter(I)),
h[I.id()]/m)}}}var D={},F=0;for(t=0;t<d;t++)C=c[t],a.root=C,v=this.degreeCentrality(a),F<v.degree&&(F=v.degree),D[C.id()]=v.degree;return{degree:function(I){return 0===F?0:(rc(I)&&(I=b.filter(I)),D[I.id()]/F)}}},degreeCentrality:function(a){a=sf(a);var b=this.cy(),c=this,d=a,f=d.root;a=d.weight;var h=d.directed;d=d.alpha;if(f=b.collection(f)[0],h){h=f.connectedEdges();b=h.filter(function(D){return D.target().same(f)&&c.has(D)});h=h.filter(function(D){return D.source().same(f)&&c.has(D)});for(var l=
b.length,m=h.length,t=0,v=0,C=0;C<b.length;C++)t+=a(b[C]);for(b=0;b<h.length;b++)v+=a(h[b]);return{indegree:Math.pow(l,1-d)*Math.pow(t,d),outdegree:Math.pow(m,1-d)*Math.pow(v,d)}}b=f.connectedEdges().intersection(c);h=b.length;for(m=l=0;m<b.length;m++)l+=a(b[m]);return{degree:Math.pow(h,1-d)*Math.pow(l,d)}}};hf.dc=hf.degreeCentrality;hf.dcn=hf.degreeCentralityNormalised=hf.degreeCentralityNormalized;var Qi=Id({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),Xf={closenessCentralityNormalized:function(a){var b=
Qi(a);a=b.harmonic;var c=b.weight,d=b.directed,f=this.cy(),h={},l=0;b=this.nodes();c=this.floydWarshall({weight:c,directed:d});for(d=0;d<b.length;d++){for(var m=0,t=b[d],v=0;v<b.length;v++)if(d!==v){var C=c.distance(t,b[v]);a?m+=1/C:m+=C}a||(m=1/m);l<m&&(l=m);h[t.id()]=m}return{closeness:function(D){return 0==l?0:(rc(D)?D=f.filter(D)[0].id():D=D.id(),h[D]/l)}}},closenessCentrality:function(a){var b=Qi(a);a=b.root;var c=b.weight,d=b.directed;b=b.harmonic;a=this.filter(a)[0];c=this.dijkstra({root:a,
weight:c,directed:d});d=0;for(var f=this.nodes(),h=0;h<f.length;h++){var l=f[h];l.same(a)||(l=c.distanceTo(l),b?d+=1/l:d+=l)}return b?d:1/d}};Xf.cc=Xf.closenessCentrality;Xf.ccn=Xf.closenessCentralityNormalised=Xf.closenessCentralityNormalized;var Xj=Id({weight:null,directed:!1}),di={betweennessCentrality:function(a){var b=Xj(a);a=b.directed;var c=b.weight,d=null!=c,f=this.cy(),h=this.nodes(),l={},m={},t=0,v={set:function(I,K){m[I]=K;K>t&&(t=K)},get:function(I){return m[I]}};for(b=0;b<h.length;b++){var C=
h[b],D=C.id();a?l[D]=C.outgoers().nodes():l[D]=C.openNeighborhood().nodes();v.set(D,0)}a=function(){for(var I=h[F].id(),K=[],P={},ba={},X={},Y=new xg(function(ab,Qb){return X[ab]-X[Qb]}),ta=0;ta<h.length;ta++){var ja=h[ta].id();P[ja]=[];ba[ja]=0;X[ja]=1/0}ba[I]=1;X[I]=0;for(Y.push(I);!Y.empty();)if(I=Y.pop(),K.push(I),d)for(ta=0;ta<l[I].length;ta++){ja=l[I][ta];var Ba=f.getElementById(I),Ua=void 0;0<Ba.edgesTo(ja).length?Ua=Ba.edgesTo(ja)[0]:Ua=ja.edgesTo(Ba)[0];Ba=c(Ua);ja=ja.id();X[ja]>X[I]+Ba&&
(X[ja]=X[I]+Ba,0>Y.nodes.indexOf(ja)?Y.push(ja):Y.updateItem(ja),ba[ja]=0,P[ja]=[]);X[ja]==X[I]+Ba&&(ba[ja]+=ba[I],P[ja].push(I))}else for(ta=0;ta<l[I].length;ta++)ja=l[I][ta].id(),X[ja]==1/0&&(Y.push(ja),X[ja]=X[I]+1),X[ja]==X[I]+1&&(ba[ja]+=ba[I],P[ja].push(I));Y={};for(I=0;I<h.length;I++)Y[h[I].id()]=0;for(;0<K.length;){I=K.pop();for(ta=0;ta<P[I].length;ta++)ja=P[I][ta],Y[ja]+=ba[ja]/ba[I]*(1+Y[I]);I!=h[F].id()&&v.set(I,v.get(I)+Y[I])}};for(var F=0;F<h.length;F++)a();a={betweenness:function(I){I=
f.collection(I).id();return v.get(I)},betweennessNormalized:function(I){if(0==t)return 0;I=f.collection(I).id();return v.get(I)/t}};return a.betweennessNormalised=a.betweennessNormalized,a}};di.bc=di.betweennessCentrality;var Yj=Id({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(a){return 1}]}),Ri=function(a,b){for(var c,d=0;d<b;d++){for(var f=c=0;f<b;f++)c+=a[f*b+d];for(f=0;f<b;f++)a[f*b+d]/=c}},Si=function(a){var b=this.nodes(),c=this.edges(),d=this.cy(),f=Yj(a),
h={};for(a=0;a<b.length;a++)h[b[a].id()]=a;a=b.length;var l=a*a,m=Array(l),t;for(t=0;t<l;t++)m[t]=0;for(t=0;t<c.length;t++){for(var v=c[t],C=h[v.source().id()],D=h[v.target().id()],F=f.attributes,I=0,K=0;K<F.length;K++)I+=F[K](v);v=I;m[C*a+D]+=v;m[D*a+C]+=v}c=m;h=f.multFactor;for(t=0;t<a;t++)c[t*a+t]=h;Ri(m,a);c=!0;for(h=0;c&&h<f.maxIterations;){c=!1;v=m;m=a;t=f.expandFactor;C=v.slice(0);for(D=1;D<t;D++){F=C;I=m;K=Array(I*I);for(var P=0;P<I;P++){for(var ba=0;ba<I;ba++)K[P*I+ba]=0;for(ba=0;ba<I;ba++)for(var X=
0;X<I;X++)K[P*I+X]+=v[P*I+ba]*F[ba*I+X]}v=K}m=t=v;C=a;D=f.inflateFactor;v=Array(C*C);for(F=0;F<C*C;F++)v[F]=Math.pow(m[F],D);m=(Ri(v,C),v);a:{for(C=0;C<l;C++)if(Math.round(m[C]*Math.pow(10,4))/Math.pow(10,4)!==Math.round(t[C]*Math.pow(10,4))/Math.pow(10,4)){t=!1;break a}t=!0}t||(c=!0);h++}var Y;f=m;l=[];for(c=0;c<a;c++){h=[];for(m=0;m<a;m++)0<Math.round(1E3*f[c*a+m])/1E3&&h.push(b[m]);0!==h.length&&l.push(d.collection(h))}b=l;for(d=0;d<b.length;d++)for(a=0;a<b.length;a++){if(f=d!=a)a:{f=b[d];l=b[a];
for(c=0;c<f.length;c++)if(!l[c]||f[c].id()!==l[c].id()){f=!1;break a}f=!0}f&&b.splice(a,1)}return Y=b,Y},Zj={markovClustering:Si,mcl:Si},g=function(a){return a},e=function(a,b,c){return a+Math.abs(c-b)},k=function(a,b,c){return a+Math.pow(c-b,2)},r=function(a){return Math.sqrt(a)},x=function(a,b,c){return Math.max(a,Math.abs(c-b))},G=function(a,b,c,d,f){for(var h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:g,l=d,m,t,v=0;v<a;v++)m=b(v),t=c(v),l=f(l,m,t);return h(l)},Q={euclidean:function(a,
b,c){return 2<=a?G(a,b,c,0,k,r):G(a,b,c,0,e)},squaredEuclidean:function(a,b,c){return G(a,b,c,0,k)},manhattan:function(a,b,c){return G(a,b,c,0,e)},max:function(a,b,c){return G(a,b,c,-1/0,x)}};Q["squared-euclidean"]=Q.squaredEuclidean;Q.squaredeuclidean=Q.squaredEuclidean;var aa=Id({k:2,m:2,sensitivityThreshold:1E-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),fa=function(a,b,c,d,f){return Lb(a,d.length,"kMedoids"!==f?function(h){return c[h]}:function(h){return d[h](c)},
function(h){return d[h](b)},c,b)},ra=function(a,b,c){for(var d=c.length,f=Array(d),h=Array(d),l=Array(b),m=0;m<d;m++)f[m]=a.min(c[m]).value,h[m]=a.max(c[m]).value;for(c=0;c<b;c++){a=[];for(m=0;m<d;m++)a[m]=Math.random()*(h[m]-f[m])+f[m];l[c]=a}return l},Aa=function(a,b,c,d,f){for(var h=1/0,l=0,m=0;m<b.length;m++){var t=fa(c,a,b[m],d,f);t<h&&(h=t,l=m)}return l},Oa=function(a,b,c){for(var d=[],f,h=0;h<b.length;h++)f=b[h],c[f.id()]===a&&d.push(f);return d},Ka=function(a,b,c){for(var d=0;d<c;d++)if(a===
b[d])return!0;return!1},Ra=function(a,b){var c=Array(b);if(50>a.length)for(var d=0;d<b;d++){for(var f=a[Math.floor(Math.random()*a.length)];Ka(f,c,d);)f=a[Math.floor(Math.random()*a.length)];c[d]=f}else for(d=0;d<b;d++)c[d]=a[Math.floor(Math.random()*a.length)];return c},nb=function(a,b,c){for(var d=0,f=0;f<b.length;f++)d+=fa("manhattan",b[f],a,c,"kMedoids");return d},xb=function(a){var b=this.cy(),c=this.nodes(),d=aa(a),f,h;var l=Array(c.length);for(a=0;a<c.length;a++)l[a]=Array(d.k);a=Array(c.length);
for(f=0;f<c.length;f++)a[f]=Array(d.k);for(f=0;f<c.length;f++){for(var m=h=0;m<d.k;m++)a[f][m]=Math.random(),h+=a[f][m];for(m=0;m<d.k;m++)a[f][m]/=h}f=Array(d.k);for(h=0;h<d.k;h++)f[h]=Array(d.attributes.length);h=Array(c.length);for(m=0;m<c.length;m++)h[m]=Array(d.k);m=!0;for(var t=0;m&&t<d.maxIterations;){m=!1;var v,C=f,D=c;var F=a;var I=h,K=d;for(v=0;v<D.length;v++)for(var P=0;P<C.length;P++)I[v][P]=Math.pow(F[v][P],K.m);for(P=0;P<C.length;P++)for(var ba=0;ba<K.attributes.length;ba++){for(var X=
F=v=0;X<D.length;X++)v+=I[X][P]*K.attributes[ba](D[X]),F+=I[X][P];C[P][ba]=v/F}C=a;F=l;D=f;I=c;K=d;for(v=0;v<C.length;v++)F[v]=C[v].slice();ba=2/(K.m-1);for(X=0;X<D.length;X++)for(var Y=0;Y<I.length;Y++){for(var ta=P=0;ta<D.length;ta++)v=fa(K.distance,I[Y],D[X],K.attributes,"cmeans"),F=fa(K.distance,I[Y],D[ta],K.attributes,"cmeans"),P+=Math.pow(v/F,ba);C[Y][X]=1/P}a:{for(C=0;C<a.length;C++)for(D=0;D<a[C].length;D++)if(Math.abs(a[C][D]-l[C][D])>d.sensitivityThreshold){C=!1;break a}C=!0}C||(m=!0);t++}d=
Array(d.k);for(l=0;l<d.length;l++)d[l]=[];for(h=0;h<a.length;h++){l=-1/0;f=-1;for(m=0;m<a[0].length;m++)a[h][m]>l&&(l=a[h][m],f=m);d[f].push(c[h])}for(c=0;c<d.length;c++)d[c]=b.collection(d[c]);return{clusters:d,degreeOfMembership:a}},Rb={kMeans:function(a){var b=this.cy(),c=this.nodes(),d=aa(a),f=Array(d.k),h={},l;d.testMode?"number"==typeof d.testCentroids?(d.testCentroids,l=ra(c,d.k,d.attributes)):"object"===T(d.testCentroids)?l=d.testCentroids:l=ra(c,d.k,d.attributes):l=ra(c,d.k,d.attributes);
for(var m=!0,t=0;m&&t<d.maxIterations;){for(m=0;m<c.length;m++)a=c[m],h[a.id()]=Aa(a,l,d.distance,d.attributes,"kMeans");m=!1;for(var v=0;v<d.k;v++){var C=Oa(v,c,h);if(0!==C.length){for(var D=d.attributes.length,F=l[v],I=Array(D),K=Array(D),P=0;P<D;P++){for(var ba=K[P]=0;ba<C.length;ba++)a=C[ba],K[P]+=d.attributes[P](a);I[P]=K[P]/C.length;Math.abs(F[P]-I[P])<=d.sensitivityThreshold||(m=!0)}l[v]=I;f[v]=b.collection(C)}}t++}return f},kMedoids:function(a){var b=this.cy(),c=this.nodes();a=aa(a);var d=
Array(a.k),f,h={},l=Array(a.k);a.testMode?"number"==typeof a.testCentroids||("object"===T(a.testCentroids)?f=a.testCentroids:f=Ra(c,a.k)):f=Ra(c,a.k);for(var m=!0,t=0;m&&t<a.maxIterations;){for(m=0;m<c.length;m++){var v=c[m];h[v.id()]=Aa(v,f,a.distance,a.attributes,"kMedoids")}m=!1;for(var C=0;C<f.length;C++){var D=Oa(C,c,h);if(0!==D.length){l[C]=nb(f[C],D,a.attributes);for(var F=0;F<D.length;F++)v=nb(D[F],D,a.attributes),v<l[C]&&(l[C]=v,f[C]=D[F],m=!0);d[C]=b.collection(D)}}t++}return d},fuzzyCMeans:xb,
fcm:xb},fc=Id({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),dd={single:"min",complete:"max"},bd=function(a){a=fc(a);var b=dd[a.linkage];return null!=b&&(a.linkage=b),a},Wc=function(a,b,c,d,f){for(var h=0,l=1/0,m,t=f.attributes,v=function(K,P){return Lb(f.distance,t.length,function(ba){return t[ba](K)},function(ba){return t[ba](P)},K,P)},C=0;C<a.length;C++){var D=a[C].key,F=c[D][d[D]];F<l&&(h=D,l=F)}if("threshold"===f.mode&&l>=
f.threshold||"dendrogram"===f.mode&&1===a.length)return!1;l=b[h];h=b[d[h]];var I;"dendrogram"===f.mode?I={left:l,right:h,key:l.key}:I={value:l.value.concat(h.value),key:l.key};a[l.index]=I;a.splice(h.index,1);b[l.key]=I;for(b=0;b<a.length;b++)I=a[b],l.key===I.key?m=1/0:"min"===f.linkage?(m=c[l.key][I.key],c[l.key][I.key]>c[h.key][I.key]&&(m=c[h.key][I.key])):"max"===f.linkage?(m=c[l.key][I.key],c[l.key][I.key]<c[h.key][I.key]&&(m=c[h.key][I.key])):"mean"===f.linkage?m=(c[l.key][I.key]*l.size+c[h.key][I.key]*
h.size)/(l.size+h.size):"dendrogram"===f.mode?m=v(I.value,l.value):m=v(I.value[0],l.value[0]),c[l.key][I.key]=c[I.key][l.key]=m;for(m=0;m<a.length;m++){v=a[m].key;if(d[v]===l.key||d[v]===h.key){b=v;for(I=0;I<a.length;I++)C=a[I].key,c[v][C]<c[v][b]&&(b=C);d[v]=b}a[m].index=m}return l.key=h.key=l.index=h.index=null,!0},Vd=function(a,b,c){a&&(a.value?b.push(a.value):(a.left&&Vd(a.left,b),a.right&&Vd(a.right,b)))},Od=function(a,b){if(!a)return"";if(a.left&&a.right){var c=Od(a.left,b);a=Od(a.right,b);
var d=b.add({group:"nodes",data:{id:c+","+a}});return b.add({group:"edges",data:{source:c,target:d.id()}}),b.add({group:"edges",data:{source:a,target:d.id()}}),d.id()}if(a.value)return a.value.id()},og=function(a,b,c){if(!a)return[];var d=[],f=[],h=[];return 0===b?(a.left&&Vd(a.left,d),a.right&&Vd(a.right,f),h=d.concat(f),[c.collection(h)]):1===b?a.value?[c.collection(a.value)]:(a.left&&Vd(a.left,d),a.right&&Vd(a.right,f),[c.collection(d),c.collection(f)]):a.value?[c.collection(a.value)]:(a.left&&
(d=og(a.left,b-1,c)),a.right&&(f=og(a.right,b-1,c)),d.concat(f))},pg=function(a){var b=this.cy(),c=this.nodes(),d=bd(a),f=d.attributes,h=function(F,I){return Lb(d.distance,f.length,function(K){return f[K](F)},function(K){return f[K](I)},F,I)};a=[];for(var l=[],m=[],t=[],v=0;v<c.length;v++){var C={value:"dendrogram"===d.mode?c[v]:[c[v]],key:v,index:v};a[v]=C;t[v]=C;l[v]=[];m[v]=0}for(c=0;c<a.length;c++)for(v=0;v<=c;v++)C=void 0,"dendrogram"===d.mode?C=c===v?1/0:h(a[c].value,a[v].value):C=c===v?1/0:
h(a[c].value[0],a[v].value[0]),l[c][v]=C,l[v][c]=C,C<l[c][m[c]]&&(m[c]=v);for(h=Wc(a,t,l,m,d);h;)h=Wc(a,t,l,m,d);var D;return"dendrogram"===d.mode?(D=og(a[0],d.dendrogramDepth,b),d.addDendrogram&&Od(a[0],b)):(D=Array(a.length),a.forEach(function(F,I){F.key=F.index=null;D[I]=b.collection(F.value)})),D},dh={hierarchicalClustering:pg,hca:pg},eh=Id({distance:"euclidean",preference:"median",damping:.8,maxIterations:1E3,minIterations:100,attributes:[]}),oe=function(a){var b=a.damping,c=a.preference;.5<=
b&&1>b||vd("Damping must range on [0.5, 1).  Got: ".concat(b));b=["median","mean","min","max"];return b.some(function(d){return d===c})||cc(c)||vd("Preference must be one of [".concat(b.map(function(d){return"'".concat(d,"'")}).join(", "),"] or a number.  Got: ").concat(c)),eh(a)},af=function(a,b,c,d){return-Lb(a,d.length,function(f){return d[f](b)},function(f){return d[f](c)},b,c)},pe=function(a,b,c){for(var d=[],f=0;f<a;f++){for(var h=-1,l=-1/0,m=0;m<c.length;m++){var t=c[m];b[f*a+t]>l&&(h=t,l=
b[f*a+t])}0<h&&d.push(h)}for(a=0;a<c.length;a++)d[c[a]]=c[a];return d},bf=function(a){var b=this.cy(),c=this.nodes(),d=oe(a);a={};for(var f=0;f<c.length;f++)a[c[f].id()]=f;var h,l;f=c.length;var m=f*f;var t=Array(m);for(h=0;h<m;h++)t[h]=-1/0;for(h=0;h<f;h++)for(l=0;l<f;l++)h!==l&&(t[h*f+l]=af(d.distance,c[h],c[l],d.attributes));l=d.preference;var v=null;h=("median"===l?v=Nj(t):"mean"===l?v=Mj(t):"min"===l?v=ci(t):"max"===l?v=fh(t):v=l,v);for(l=0;l<f;l++)t[l*f+l]=h;h=Array(m);for(l=0;l<m;l++)h[l]=
0;l=Array(m);for(v=0;v<m;v++)l[v]=0;m=Array(f);v=Array(f);for(var C=Array(f),D=0;D<f;D++)m[D]=0,v[D]=0,C[D]=0;D=Array(f*d.minIterations);for(var F=0;F<D.length;F++)D[F]=0;for(F=0;F<d.maxIterations;F++){for(var I=0;I<f;I++){for(var K=-1/0,P=-1/0,ba=-1,X,Y=0;Y<f;Y++)m[Y]=h[I*f+Y],X=l[I*f+Y]+t[I*f+Y],X>=K?(P=K,K=X,ba=Y):X>P&&(P=X);for(X=0;X<f;X++)h[I*f+X]=(1-d.damping)*(t[I*f+X]-K)+d.damping*m[X];h[I*f+ba]=(1-d.damping)*(t[I*f+ba]-P)+d.damping*m[ba]}for(I=0;I<f;I++){for(P=K=0;P<f;P++)m[P]=l[P*f+I],v[P]=
Math.max(0,h[P*f+I]),K+=v[P];K-=v[I];v[I]=h[I*f+I];K+=v[I];for(P=0;P<f;P++)l[P*f+I]=(1-d.damping)*Math.min(0,K-v[P])+d.damping*m[P];l[I*f+I]=(1-d.damping)*(K-v[I])+d.damping*m[I]}for(K=I=0;K<f;K++)P=0<l[K*f+K]+h[K*f+K]?1:0,D[F%d.minIterations*f+K]=P,I+=P;if(0<I&&(F>=d.minIterations-1||F==d.maxIterations-1)){for(K=I=0;K<f;K++){for(P=C[K]=0;P<d.minIterations;P++)C[K]+=D[P*f+K];0!==C[K]&&C[K]!==d.minIterations||I++}if(I===f)break}}d=[];for(m=0;m<f;m++)0<h[m*f+m]+l[m*f+m]&&d.push(m);h=pe(f,t,d);for(l=
0;l<d.length;l++){m=[];for(v=0;v<h.length;v++)h[v]===d[l]&&m.push(v);v=-1;C=-1/0;for(D=0;D<m.length;D++){for(I=F=0;I<m.length;I++)F+=t[m[I]*f+m[D]];F>C&&(v=D,C=F)}d[l]=m[v]}t=(h=pe(f,t,d),h);f={};for(h=0;h<d.length;h++)f[d[h]]=[];for(h=0;h<c.length;h++)l=a[c[h].id()],l=t[l],null!=l&&f[l].push(c[h]);c=Array(d.length);for(a=0;a<d.length;a++)c[a]=b.collection(f[d[a]]);return c},ng={affinityPropagation:bf,ap:bf},Sh=Id({root:void 0,directed:!1}),Lf=function(){var a=this,b={},c=0,d=0,f=[],h=[],l={},m=function(C,
D){for(var F=h.length-1,I=[],K=a.spawn();h[F].x!=C||h[F].y!=D;)I.push(h.pop().edge),F--;I.push(h.pop().edge);I.forEach(function(P){var ba=P.connectedNodes().intersection(a);K.merge(P);ba.forEach(function(X){var Y=X.id(),ta=X.connectedEdges().intersection(a);K.merge(X);b[Y].cutVertex?K.merge(ta.filter(function(ja){return ja.isLoop()})):K.merge(ta)})});f.push(K)},t=function(C,D,F){C===F&&(d+=1);b[D]={id:c,low:c++,cutVertex:!1};var I=a.getElementById(D).connectedEdges().intersection(a);if(0===I.size())f.push(a.spawn(a.getElementById(D)));
else{var K,P,ba,X;I.forEach(function(Y){K=Y.source().id();P=Y.target().id();ba=K===D?P:K;ba!==F&&(X=Y.id(),l[X]||(l[X]=!0,h.push({x:D,y:ba,edge:Y})),ba in b?b[D].low=Math.min(b[D].low,b[ba].id):(t(C,ba,D),b[D].low=Math.min(b[D].low,b[ba].low),b[D].id<=b[ba].low&&(b[D].cutVertex=!0,m(D,ba))))})}};a.forEach(function(C){C.isNode()&&(C=C.id(),C in b||(d=0,t(C,C),b[C].cutVertex=1<d))});var v=Object.keys(b).filter(function(C){return b[C].cutVertex}).map(function(C){return a.getElementById(C)});return{cut:a.spawn(v),
components:f}},Wi=function(){var a=this,b={},c=0,d=[],f=[],h=a.spawn(a),l=function(m){f.push(m);b[m]={index:c,low:c++,explored:!1};if(a.getElementById(m).connectedEdges().intersection(a).forEach(function(C){C=C.target().id();C!==m&&(C in b||l(C),b[C].explored||(b[m].low=Math.min(b[m].low,b[C].low)))}),b[m].index===b[m].low){for(var t=a.spawn();;){var v=f.pop();if(t.merge(a.getElementById(v)),b[v].low=b[m].index,b[v].explored=!0,v===m)break}v=t.edgesWith(t);t=t.merge(v);d.push(t);h=h.difference(t)}};
return a.forEach(function(m){m.isNode()&&(m=m.id(),m in b||l(m))}),{cut:h,components:d}},kn={};[lg,{dijkstra:function(a){if(!Zc(a)){var b=arguments;a={root:b[0],weight:b[1],directed:b[2]}}b=Sj(a);var c=b.root,d=b.directed,f=this,h=b.weight;c=rc(c)?this.filter(c)[0]:c[0];var l={},m={},t={};b=this.byGroup();var v=b.nodes,C=b.edges;C.unmergeBy(function(ja){return ja.isLoop()});b=function(ja,Ba){l[ja.id()]=Ba;D.updateItem(ja)};for(var D=new xg(function(ja,Ba){return l[ja.id()]-l[Ba.id()]}),F=0;F<v.length;F++){var I=
v[F];l[I.id()]=I.same(c)?0:1/0;D.push(I)}for(c=function(ja,Ba){ja=(d?ja.edgesTo(Ba):ja.edgesWith(Ba)).intersect(C);Ba=1/0;for(var Ua,ab=0;ab<ja.length;ab++){var Qb=ja[ab],Mb=h(Qb);(Mb<Ba||!Ua)&&(Ba=Mb,Ua=Qb)}return{edge:Ua,dist:Ba}};0<D.size();){F=D.pop();I=l[F.id()];var K=F.id();if(t[K]=I,I!==1/0){K=F.neighborhood().intersect(v);for(var P=0;P<K.length;P++){var ba=K[P],X=ba.id(),Y=c(F,ba),ta=I+Y.dist;ta<l[ba.id()]&&(b(ba,ta),m[X]={node:F,edge:Y.edge})}}}return{distanceTo:function(ja){ja=rc(ja)?v.filter(ja)[0]:
ja[0];return t[ja.id()]},pathTo:function(ja){var Ba=rc(ja)?v.filter(ja)[0]:ja[0];ja=[];var Ua=Ba.id();if(0<Ba.length)for(ja.unshift(Ba);m[Ua];)Ba=m[Ua],ja.unshift(Ba.edge),ja.unshift(Ba.node),Ba=Ba.node,Ua=Ba.id();return f.spawn(ja)}}}},{kruskal:function(a){a=a||function(D){return 1};var b=this.byGroup(),c=b.nodes,d=b.edges,f=c.length,h=Array(f);b=function(D){for(var F=0;F<h.length;F++)if(h[F].has(D))return F};for(var l=0;l<f;l++)h[l]=this.spawn(c[l]);d=d.sort(function(D,F){return a(D)-a(F)});for(f=
0;f<d.length;f++){l=d[f];var m=l.source()[0],t=l.target()[0];m=b(m);t=b(t);var v=h[m],C=h[t];m!==t&&(c.merge(l),v.merge(C),h.splice(t,1))}return c}},{aStar:function(a){var b=this.cy();a=Li(a);var c=a.root,d=a.goal,f=a.heuristic,h=a.directed,l=a.weight;c=b.collection(c)[0];d=b.collection(d)[0];var m=c.id(),t=d.id();b={};var v={},C={},D=new xg(function(Ua,ab){return v[Ua.id()]-v[ab.id()]}),F=new rf;a={};var I={},K=function(Ua,ab){D.push(Ua);F.add(ab)};K(c,m);b[m]=0;v[m]=f(c);for(m=0;0<D.size();){var P=
D.pop();c=P.id();F.delete(c);if(m++,c===t){f=[];h=t;for(t=I[h];f.unshift(d),null!=t&&f.unshift(t),d=a[h],null!=d;)h=d.id(),t=I[h];return{found:!0,distance:b[c],path:this.spawn(f),steps:m}}C[c]=!0;for(var ba=P._private.edges,X=0;X<ba.length;X++){var Y=ba[X];if(this.hasElementWithId(Y.id())&&(!h||Y.data("source")===c)){var ta=Y.source(),ja=Y.target();ta=ta.id()!==c?ta:ja;ja=ta.id();if(this.hasElementWithId(ja)&&!C[ja]){var Ba=b[c]+l(Y);F.has(ja)?Ba<b[ja]&&(b[ja]=Ba,v[ja]=Ba+f(ta),a[ja]=P,I[ja]=Y):(b[ja]=
Ba,v[ja]=Ba+f(ta),K(ta,ja),a[ja]=P,I[ja]=Y)}}}}return{found:!1,distance:void 0,path:void 0,steps:m}}},{floydWarshall:function(a){var b=this.cy(),c=yg(a);a=c.directed;c=c.weight;var d=this.byGroup(),f=d.nodes;d=d.edges;for(var h=f.length,l=h*h,m=Array(l),t=0;t<l;t++){var v=t%h;(t-v)/h===v?m[t]=0:m[t]=1/0}var C=Array(l),D=Array(l);for(l=0;l<d.length;l++){t=d[l];v=t.source()[0];var F=t.target()[0];if(v!==F){v=f.indexOf(v);var I=f.indexOf(F),K=v*h+I;F=c(t);(m[K]>F&&(m[K]=F,C[K]=I,D[K]=t),a)||(I=I*h+v,
!a&&m[I]>F&&(m[I]=F,C[I]=v,D[I]=t))}}for(a=0;a<h;a++)for(c=0;c<h;c++)for(d=c*h+a,l=0;l<h;l++)t=c*h+l,v=a*h+l,m[d]+m[v]<m[t]&&(m[t]=m[d]+m[v],C[t]=C[d]);var P=function(ba){return(rc(ba)?b.filter(ba):ba)[0]};return{distance:function(ba,X){ba=f.indexOf(P(ba));X=f.indexOf(P(X));return m[ba*h+X]},path:function(ba,X){ba=f.indexOf(P(ba));X=f.indexOf(P(X));var Y=f[ba];if(ba===X)return Y.collection();if(null==C[ba*h+X])return b.collection();var ta=b.collection();for(ta.merge(Y);ba!==X;)Y=ba,ba=C[ba*h+X],Y=
D[Y*h+ba],ta.merge(Y),ta.merge(f[ba]);return ta}}}},{bellmanFord:function(a){var b=this,c=Tj(a),d=c.directed,f=c.root;c=c.weight;var h=this,l=this.cy(),m=this.byGroup(),t=m.edges,v=m.nodes,C=v.length,D=new Pe;m=!1;var F=[];f=l.collection(f)[0];t.unmergeBy(function(Mb){return Mb.isLoop()});for(var I=t.length,K=function(Mb){var Ub=D.get(Mb.id());return Ub||(Ub={},D.set(Mb.id(),Ub)),Ub},P=function(Mb){return(rc(Mb)?l.$(Mb):Mb)[0]},ba=0;ba<C;ba++){var X=v[ba],Y=K(X);X.same(f)?Y.dist=0:Y.dist=1/0;Y.pred=
null;Y.edge=null}var ta=!1;v=function(Mb,Ub,Wb,Yb,ub,Kb){Ub=Yb.dist+Kb;Ub<ub.dist&&!Wb.same(Yb.edge)&&(ub.dist=Ub,ub.pred=Mb,ub.edge=Wb,ta=!0)};for(ba=1;ba<C;ba++){ta=!1;for(X=0;X<I;X++){Y=t[X];var ja=Y.source(),Ba=Y.target(),Ua=c(Y),ab=K(ja),Qb=K(Ba);v(ja,Ba,Y,ab,Qb,Ua);d||v(Ba,ja,Y,Qb,ab,Ua)}if(!ta)break}if(ta)for(C=[],v=0;v<I;v++)if(ba=t[v],X=ba.source(),Y=ba.target(),ja=c(ba),Ba=K(X).dist,Ua=K(Y).dist,Ba+ja<Ua||!d&&Ua+ja<Ba)if(m||(fd("Graph contains a negative weight cycle for Bellman-Ford"),
m=!0),!1!==a.findNegativeWeightCycles)for(ba=[],Ba+ja<Ua&&ba.push(X),!d&&Ua+ja<Ba&&ba.push(Y),X=ba.length,Y=0;Y<X;Y++){Ba=ba[Y];ja=[Ba];ja.push(K(Ba).edge);for(Ba=K(Ba).pred;-1===ja.indexOf(Ba);)ja.push(Ba),ja.push(K(Ba).edge),Ba=K(Ba).pred;ja=ja.slice(ja.indexOf(Ba));Ba=ja[0].id();Ua=0;for(ab=2;ab<ja.length;ab+=2)ja[ab].id()<Ba&&(Ba=ja[ab].id(),Ua=ab);ja=ja.slice(Ua).concat(ja.slice(0,Ua));ja.push(ja[0]);Ba=ja.map(function(Mb){return Mb.id()}).join(",");-1===C.indexOf(Ba)&&(F.push(h.spawn(ja)),C.push(Ba))}else break;
return{distanceTo:function(Mb){return K(P(Mb)).dist},pathTo:function(Mb){for(var Ub=1<arguments.length&&void 0!==arguments[1]?arguments[1]:f,Wb=[],Yb=P(Mb);;){if(null==Yb)return b.spawn();var ub=K(Yb),Kb=ub.edge;ub=ub.pred;if(Wb.unshift(Yb[0]),Yb.same(Ub)&&0<Wb.length)break;null!=Kb&&Wb.unshift(Kb);Yb=ub}return h.spawn(Wb)},hasNegativeWeightCycle:m,negativeWeightCycles:F}}},{kargerStein:function(){var a=this,b=this.byGroup(),c=b.nodes,d=b.edges;d.unmergeBy(function(X){return X.isLoop()});var f=c.length;
b=d.length;var h=Math.ceil(Math.pow(Math.log(f)/Math.LN2,2)),l=Math.floor(f/gh);if(2>f)vd("At least 2 nodes are required for Karger-Stein algorithm");else{for(var m=[],t=0;t<b;t++){var v=d[t];m.push([t,c.indexOf(v.source()),c.indexOf(v.target())])}t=1/0;v=[];b=Array(f);for(var C=Array(f),D=Array(f),F=function(X,Y){for(var ta=0;ta<f;ta++)Y[ta]=X[ta]},I=0;I<=h;I++){for(var K=0;K<f;K++)C[K]=K;var P=zg(C,m.slice(),f,l);K=P.slice();F(C,D);P=zg(C,P,l,2);K=zg(D,K,l,2);P.length<=K.length&&P.length<t?(t=P.length,
v=P,F(C,b)):K.length<=P.length&&K.length<t&&(t=K.length,v=K,F(D,b))}var ba=this.spawn(v.map(function(X){return d[X[0]]}));h=this.spawn();l=this.spawn();m=b[0];for(t=0;t<b.length;t++)v=c[t],b[t]===m?h.merge(v):l.merge(v);c=function(X){var Y=a.spawn();return X.forEach(function(ta){Y.merge(ta);ta.connectedEdges().forEach(function(ja){a.contains(ja)&&!ba.contains(ja)&&Y.merge(ja)})}),Y};c=[c(h),c(l)];return{cut:ba,components:c,partition1:h,partition2:l}}}},{pageRank:function(a){var b=Pi(a),c=b.dampingFactor;
a=b.precision;var d=b.iterations,f=b.weight,h=this._private.cy;b=this.byGroup();var l=b.nodes,m=b.edges;b=l.length;var t=m.length,v=Array(b*b),C=Array(b);c=(1-c)/b;for(var D=0;D<b;D++){for(var F=0;F<b;F++)v[D*b+F]=0;C[D]=0}for(D=0;D<t;D++){F=m[D];var I=F.data("source"),K=F.data("target");I!==K&&(I=l.indexOfId(I),K=l.indexOfId(K),F=f(F),v[K*b+I]+=F,C[I]+=F)}f=1/b+c;for(m=0;m<b;m++)if(0===C[m])for(t=0;t<b;t++)v[t*b+m]=f;else for(t=0;t<b;t++)D=t*b+m,v[D]=v[D]/C[m]+c;var P=Array(b);C=Array(b);for(c=0;c<
b;c++)P[c]=1;for(c=0;c<d;c++){for(f=0;f<b;f++)C[f]=0;for(f=0;f<b;f++)for(m=0;m<b;m++)C[f]+=v[f*b+m]*P[m];Uj(C);f=P;P=C;C=f;for(t=m=0;t<b;t++)D=f[t]-P[t],m+=D*D;if(m<a)break}return{rank:function(ba){return ba=h.collection(ba)[0],P[l.indexOf(ba)]}}}},hf,Xf,di,Zj,Rb,dh,ng,{hierholzer:function(a){if(!Zc(a)){var b=arguments;a={root:b[0],directed:b[1]}}b=Sh(a);var c=b.root,d=b.directed,f=!1,h,l,m;c&&(m=rc(c)?this.filter(c)[0].id():c[0].id());var t={},v={};d?this.forEach(function(I){var K=I.id();if(I.isNode()){var P=
I.indegree(!0),ba=I.outdegree(!0),X=P-ba;P=ba-P;1==X?h?f=!0:h=K:1==P?l?f=!0:l=K:(1<P||1<X)&&(f=!0);t[K]=[];I.outgoers().forEach(function(Y){Y.isEdge()&&t[K].push(Y.id())})}else v[K]=[void 0,I.target().id()]}):this.forEach(function(I){var K=I.id();I.isNode()?(I.degree(!0)%2&&(h?l?f=!0:l=K:h=K),t[K]=[],I.connectedEdges().forEach(function(P){return t[K].push(P.id())})):v[K]=[I.source().id(),I.target().id()]});b={found:!1,trail:void 0};if(f)return b;if(l&&h)if(d){if(m&&l!=m)return b;m=l}else{if(m&&l!=
m&&h!=m)return b;m||=l}else m||=this[0].id();c=function(I){var K=I;I=[I];for(var P,ba,X;t[K].length;)P=t[K].shift(),ba=v[P][0],X=v[P][1],K!=X?(t[X]=t[X].filter(function(Y){return Y!=P}),K=X):!d&&K!=ba&&(t[ba]=t[ba].filter(function(Y){return Y!=P}),K=ba),I.unshift(P),I.unshift(K);return I};var C=[],D=[];for(D=c(m);1!=D.length;)0==t[D[0]].length?(C.unshift(this.getElementById(D.shift())),C.unshift(this.getElementById(D.shift()))):D=c(D.shift()).concat(D);C.unshift(this.getElementById(D.shift()));for(var F in t)if(t[F].length)return b;
return b.found=!0,b.trail=this.spawn(C,!0),b}},{hopcroftTarjanBiconnected:Lf,htbc:Lf,htb:Lf,hopcroftTarjanBiconnectedComponents:Lf},{tarjanStronglyConnected:Wi,tsc:Wi,tscc:Wi,tarjanStronglyConnectedComponents:Wi}].forEach(function(a){Bc(kn,a)});var Ve=function(a){if(!(this instanceof Ve))return new Ve(a);this.id="Thenable/1.0.7";this.state=0;this.rejectReason=this.fulfillValue=void 0;this.onFulfilled=[];this.onRejected=[];this.proxy={then:this.then.bind(this)};"function"==typeof a&&a.call(this,this.fulfill.bind(this),
this.reject.bind(this))};Ve.prototype={fulfill:function(a){return ln(this,1,"fulfillValue",a)},reject:function(a){return ln(this,2,"rejectReason",a)},then:function(a,b){var c=new Ve;return this.onFulfilled.push(mn(a,c,"fulfill")),this.onRejected.push(mn(b,c,"reject")),nn(this),c.proxy}};var ln=function(a,b,c,d){return 0===a.state&&(a.state=b,a[c]=d,nn(a)),a},nn=function(a){1===a.state?on(a,"onFulfilled",a.fulfillValue):2===a.state&&on(a,"onRejected",a.rejectReason)},on=function(a,b,c){if(0!==a[b].length){var d=
a[b];a[b]=[];a=function(){for(var f=0;f<d.length;f++)d[f](c)};"function"==typeof setImmediate?setImmediate(a):setTimeout(a,0)}},mn=function(a,b,c){return function(d){if("function"!=typeof a)b[c].call(b,d);else{try{var f=a(d)}catch(h){b.reject(h);return}pn(b,f)}}},pn=function(a,b){if(a===b||a.proxy===b)a.reject(new TypeError("cannot resolve promise with itself"));else{if("object"===T(b)&&null!==b||"function"==typeof b)try{var c=b.then}catch(f){a.reject(f);return}if("function"==typeof c){var d=!1;try{c.call(b,
function(f){d||(d=!0,f===b?a.reject(new TypeError("circular thenable chain")):pn(a,f))},function(f){d||(d=!0,a.reject(f))})}catch(f){d||a.reject(f)}}else a.fulfill(b)}};Ve.all=function(a){return new Ve(function(b,c){for(var d=Array(a.length),f=0,h=0;h<a.length;h++)(function(l){var m=a[l];null!=m&&null!=m.then?m.then(function(t){d[l]=t;f++;f===a.length&&b(d)},function(t){c(t)}):(d[l]=m,f++,f===a.length&&b(d))})(h)})};Ve.resolve=function(a){return new Ve(function(b,c){b(a)})};Ve.reject=function(a){return new Ve(function(b,
c){c(a)})};var zh="u">typeof Promise?Promise:Ve,bl=function(a,b,c){var d="core"===$e(a),f=!d;b=this._private=Bc({duration:1E3},b,c);if(b.target=a,b.style=b.style||b.css,b.started=!1,b.playing=!1,b.hooked=!1,b.applying=!1,b.progress=0,b.completes=[],b.frames=[],b.complete&&Gc(b.complete)&&b.completes.push(b.complete),f)f=a.position(),b.startPosition=b.startPosition||{x:f.x,y:f.y},b.startStyle=b.startStyle||a.cy().style().getAnimationStartStyle(a,b.style);d&&(d=a.pan(),b.startPan={x:d.x,y:d.y},b.startZoom=
a.zoom());this.length=1;this[0]=this},Kg=bl.prototype;Bc(Kg,{instanceString:function(){return"animation"},hook:function(){var a=this._private;if(!a.hooked){var b,c=a.target._private.animation;a.queue?b=c.queue:b=c.current;b.push(this);$d(a.target)&&a.target.cy().addToAnimationPool(a.target);a.hooked=!0}return this},play:function(){var a=this._private;return 1===a.progress&&(a.progress=0),a.playing=!0,a.started=!1,a.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var a=
this._private;return a.applying=!0,a.started=!1,a.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var a=this._private;return a.playing=!1,a.started=!1,this},stop:function(){var a=this._private;return a.playing=!1,a.started=!1,a.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(a){var b=this._private;return void 0===a?b.progress*b.duration:this.progress(a/b.duration)},progress:function(a){var b=
this._private,c=b.playing;return void 0===a?b.progress:(c&&this.pause(),b.progress=a,b.started=!1,c&&this.play(),this)},completed:function(){return 1===this._private.progress},reverse:function(){var a=this._private,b=a.playing;b&&this.pause();a.progress=1-a.progress;a.started=!1;var c=function(l,m){var t=a[l];null!=t&&(a[l]=a[m],a[m]=t)};if(c("zoom","startZoom"),c("pan","startPan"),c("position","startPosition"),a.style)for(c=0;c<a.style.length;c++){var d=a.style[c],f=d.name,h=a.startStyle[f];a.startStyle[f]=
d;a.style[c]=h}return b&&this.play(),this},promise:function(a){var b=this._private;switch(a){case "frame":var c=b.frames;break;default:case "complete":case "completed":c=b.completes}return new zh(function(d,f){c.push(function(){d()})})}});Kg.complete=Kg.completed;Kg.run=Kg.play;Kg.running=Kg.playing;var ck,cm,dk,dm,ek,em,gk,gm,fk,fm,hk,hm,ik,im,jk,jm,kk,km,lk,lm,mk,mm,nk,nm,ok,om,pk,pm,qk,qm,rk,rm,sk,sm,tk,tm,uk,um,vk,vm,wk,wm,xk,xm,yk,ym,zk,zm,Ak,Am,Bk,Bm,Ck,Cm,Dk,Dm,Ek,Em,Fk,Fm,Gk,Gm,Hk,Hm,Ik,Im,
Jk,Jm,Kk,Km,Lk,Lm,Mk,Mm,Nk,Nm,Ok,Om,Pk,Pm,Qk,Qm,Rk,Rm,cl,qn,eq=function(){if(qn)return cl;qn=1;var a=Ta();return cl=function(b,c,d){b=null==b?void 0:a(b,c);return void 0===b?d:b},cl}(),fq=ha(eq),Sk,Sm,Tk,Tm,Uk,Um,Vk,Vm,Wk,Wm,dl,rn,gq=function(){if(rn)return dl;rn=1;var a=Jc();return dl=function(b,c,d){return null==b?b:a(b,c,d)},dl}(),hq=ha(gq),Xk,Xm,el,sn,iq=function(){if(sn)return el;sn=1;var a=wc(),b=$c(),c=Xb(),d=ib(),f=jd(),h=Ea(),l=da();return el=function(m){return c(m)?a(m,h):d(m)?[m]:b(f(l(m)))},
el}(),jq=ha(iq),ld={};[{animated:function(){return function(){var a=void 0!==this.length?this:[this];if(!(this._private.cy||this).styleEnabled())return!1;if(a=a[0])return 0<a._private.animation.current.length}},clearQueue:function(){return function(){var a=void 0!==this.length?this:[this];if(!(this._private.cy||this).styleEnabled())return this;for(var b=0;b<a.length;b++)a[b]._private.animation.queue=[];return this}},delay:function(){return function(a,b){return(this._private.cy||this).styleEnabled()?
this.animate({delay:a,duration:a,complete:b}):this}},delayAnimation:function(){return function(a,b){return(this._private.cy||this).styleEnabled()?this.animation({delay:a,duration:a,complete:b}):this}},animation:function(){return function(a,b){var c=void 0!==this.length,d=c?this:[this],f=this._private.cy||this;c=!c;var h=!c;if(!f.styleEnabled())return this;var l=f.style();a=Bc({},a,b);if(0===Object.keys(a).length)return new bl(d[0],a);switch(void 0===a.duration&&(a.duration=400),a.duration){case "slow":a.duration=
600;break;case "fast":a.duration=200}if(h&&(a.style=l.getPropsList(a.style||a.css),a.css=void 0),h&&null!=a.renderedPosition)b=a.renderedPosition,h=f.pan(),l=f.zoom(),a.position={x:(b.x-h.x)/l,y:(b.y-h.y)/l};c&&null!=a.panBy&&(b=a.panBy,h=f.pan(),a.pan={x:h.x+b.x,y:h.y+b.y});b=a.center||a.centre;c&&null!=b&&(b=f.getCenterPan(b.eles,a.zoom),null!=b&&(a.pan=b));c&&null!=a.fit&&(b=a.fit,b=f.getFitViewport(b.eles||b.boundingBox,b.padding),null!=b&&(a.pan=b.pan,a.zoom=b.zoom));c&&Zc(a.zoom)&&(f=f.getZoomedViewport(a.zoom),
null!=f?(f.zoomed&&(a.zoom=f.zoom),f.panned&&(a.pan=f.pan)):a.zoom=null);return new bl(d[0],a)}},animate:function(){return function(a,b){var c=void 0!==this.length?this:[this];if(!(this._private.cy||this).styleEnabled())return this;b&&(a=Bc({},a,b));for(b=0;b<c.length;b++){var d=c[b],f=d.animated()&&(void 0===a.queue||a.queue);d.animation(a,f?{queue:!0}:void 0).play()}return this}},stop:function(){return function(a,b){var c=void 0!==this.length?this:[this],d=this._private.cy||this;if(!d.styleEnabled())return this;
for(var f=0;f<c.length;f++){for(var h=c[f]._private,l=h.animation.current,m=0;m<l.length;m++){var t=l[m]._private;b&&(t.duration=0)}a&&(h.animation.queue=[]);b||(h.animation.current=[])}return d.notify("draw"),this}}},{data:function(a){return a=Bc({},{field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(b){},beforeSet:function(b,c){},onSet:function(b){},
canSet:function(b){return!0}},a),function(b,c){var d=a,f=void 0!==this.length,h=f?this:[this];f=f?this[0]:this;if(rc(b)){var l=-1!==b.indexOf(".")&&jq(b);if(d.allowGetting&&void 0===c){var m;return f&&(d.beforeGet(f),l&&void 0===f._private[d.field][b]?m=fq(f._private[d.field],l):m=f._private[d.field][b]),m}if(d.allowSetting&&void 0!==c&&!d.immutableKeys[b]){m=B({},b,c);d.beforeSet(this,m);m=0;for(var t=h.length;m<t;m++){var v=h[m];d.canSet(v)&&(l&&void 0===f._private[d.field][b]?hq(v._private[d.field],
l,c):v._private[d.field][b]=c)}d.updateStyle&&this.updateStyle();d.onSet(this);d.settingTriggersEvent&&this[d.triggerFnName](d.settingEvent)}}else if(d.allowSetting&&Zc(b)){l=Object.keys(b);d.beforeSet(this,b);for(m=0;m<l.length;m++)if(c=l[m],f=b[c],!d.immutableKeys[c])for(t=0;t<h.length;t++)v=h[t],d.canSet(v)&&(v._private[d.field][c]=f);d.updateStyle&&this.updateStyle();d.onSet(this);d.settingTriggersEvent&&this[d.triggerFnName](d.settingEvent)}else if(d.allowBinding&&Gc(b))this.on(d.bindingEvent,
b);else if(d.allowGetting&&void 0===b)return f&&(d.beforeGet(f),l=f._private[d.field]),l;return this}},removeData:function(a){return a=Bc({},{field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}},a),function(b){var c=a,d=void 0!==this.length?this:[this];if(rc(b)){b=b.split(/\s+/);for(var f=b.length,h=0;h<f;h++){var l=b[h];if(!Fe(l)&&!c.immutableKeys[l])for(var m=0,t=d.length;m<t;m++)d[m]._private[c.field][l]=void 0}c.triggerEvent&&this[c.triggerFnName](c.event)}else if(void 0===
b){b=0;for(f=d.length;b<f;b++)for(h=d[b]._private[c.field],l=Object.keys(h),m=0;m<l.length;m++)t=l[m],!c.immutableKeys[t]&&(h[t]=void 0);c.triggerEvent&&this[c.triggerFnName](c.event)}return this}}},{eventAliasesOn:function(a){a.addListener=a.listen=a.bind=a.on;a.unlisten=a.unbind=a.off=a.removeListener;a.trigger=a.emit;a.pon=a.promiseOn=function(b,c){var d=this,f=Array.prototype.slice.call(arguments,0);return new zh(function(h,l){l=f.concat([function(t){d.off.apply(d,m);h(t)}]);var m=l.concat([]);
d.on.apply(d,l)})}}}].forEach(function(a){Bc(ld,a)});var kq={animate:ld.animate(),animation:ld.animation(),animated:ld.animated(),clearQueue:ld.clearQueue(),delay:ld.delay(),delayAnimation:ld.delayAnimation(),stop:ld.stop()},Xi={classes:function(a){if(void 0===a){var b=[];return this[0]._private.classes.forEach(function(C){return b.push(C)}),b}kd(a)||(a=(a||"").match(/\S+/g)||[]);for(var c=[],d=new rf(a),f=0;f<this.length;f++){for(var h=this[f],l=h._private,m=l.classes,t=!1,v=0;v<a.length;v++)if(!m.has(a[v])){t=
!0;break}t||=m.size!==a.length;t&&(l.classes=d,c.push(h))}return 0<c.length&&this.spawn(c).updateStyle().emit("class"),this},addClass:function(a){return this.toggleClass(a,!0)},hasClass:function(a){var b=this[0];return null!=b&&b._private.classes.has(a)},toggleClass:function(a,b){kd(a)||(a=a.match(/\S+/g)||[]);for(var c=void 0===b,d=[],f=0,h=this.length;f<h;f++)for(var l=this[f],m=l._private.classes,t=!1,v=0;v<a.length;v++){var C=a[v],D=m.has(C),F=!1;b||c&&!D?(m.add(C),F=!0):(!b||c&&D)&&(m.delete(C),
F=!0);!t&&F&&(d.push(l),t=!0)}return 0<d.length&&this.spawn(d).updateStyle().emit("class"),this},removeClass:function(a){return this.toggleClass(a,!1)},flashClass:function(a,b){var c=this;if(null==b)b=250;else if(0===b)return c;return c.addClass(a),setTimeout(function(){c.removeClass(a)},b),c}};Xi.className=Xi.classNames=Xi.classes;var Ah="=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=";(function(){var a;var b=Ah.split("|");for(a=0;a<b.length;a++){var c=b[a];Ah+="|@"+c}b=Ah.split("|");for(a=0;a<b.length;a++)c=b[a],
0<=c.indexOf("!")||"="===c||(Ah+="|\\!"+c)})();var td=function(){return{checks:[]}},fl=[{selector:":selected",matches:function(a){return a.selected()}},{selector:":unselected",matches:function(a){return!a.selected()}},{selector:":selectable",matches:function(a){return a.selectable()}},{selector:":unselectable",matches:function(a){return!a.selectable()}},{selector:":locked",matches:function(a){return a.locked()}},{selector:":unlocked",matches:function(a){return!a.locked()}},{selector:":visible",matches:function(a){return a.visible()}},
{selector:":hidden",matches:function(a){return!a.visible()}},{selector:":transparent",matches:function(a){return a.transparent()}},{selector:":grabbed",matches:function(a){return a.grabbed()}},{selector:":free",matches:function(a){return!a.grabbed()}},{selector:":removed",matches:function(a){return a.removed()}},{selector:":inside",matches:function(a){return!a.removed()}},{selector:":grabbable",matches:function(a){return a.grabbable()}},{selector:":ungrabbable",matches:function(a){return!a.grabbable()}},
{selector:":animated",matches:function(a){return a.animated()}},{selector:":unanimated",matches:function(a){return!a.animated()}},{selector:":parent",matches:function(a){return a.isParent()}},{selector:":childless",matches:function(a){return a.isChildless()}},{selector:":child",matches:function(a){return a.isChild()}},{selector:":orphan",matches:function(a){return a.isOrphan()}},{selector:":nonorphan",matches:function(a){return a.isChild()}},{selector:":compound",matches:function(a){return a.isNode()?
a.isParent():a.source().isParent()||a.target().isParent()}},{selector:":loop",matches:function(a){return a.isLoop()}},{selector:":simple",matches:function(a){return a.isSimple()}},{selector:":active",matches:function(a){return a.active()}},{selector:":inactive",matches:function(a){return!a.active()}},{selector:":backgrounding",matches:function(a){return a.backgrounding()}},{selector:":nonbackgrounding",matches:function(a){return!a.backgrounding()}}].sort(function(a,b){a=a.selector;b=b.selector;return-1*
(a<b?-1:a>b?1:0)}),lq=function(){for(var a={},b,c=0;c<fl.length;c++)b=fl[c],a[b.selector]=b.matches;return a}(),Bh=function(a){return a.replace(RegExp("\\\\([\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~])","g"),function(b,c){return c})},gl=[{name:"group",query:!0,regex:"(node|edge|\\*)",populate:function(a,b,c){a=z(c,1)[0];b.checks.push({type:0,value:"*"===a?a:a+"s"})}},{name:"state",query:!0,regex:"("+fl.map(function(a){return a.selector}).join("|")+")",
populate:function(a,b,c){a=z(c,1)[0];b.checks.push({type:7,value:a})}},{name:"id",query:!0,regex:"\\#((?:[\\w-.]|(?:\\\\[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]))+)",populate:function(a,b,c){a=z(c,1)[0];b.checks.push({type:8,value:Bh(a)})}},{name:"className",query:!0,regex:"\\.((?:[\\w-]|(?:\\\\[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]))+)",populate:function(a,b,c){a=z(c,1)[0];b.checks.push({type:9,
value:Bh(a)})}},{name:"dataExists",query:!0,regex:"\\[\\s*((?:[\\w-.]|(?:\\\\[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]))+)\\s*\\]",populate:function(a,b,c){a=z(c,1)[0];b.checks.push({type:4,field:Bh(a)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*((?:[\\w-.]|(?:\\\\[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]))+)\\s*("+Ah+")\\s*(\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*\\]",
populate:function(a,b,c){var d=z(c,3);a=d[0];c=d[1];d=d[2];null!=RegExp("^\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'$").exec(d)?d=d.substring(1,d.length-1):d=parseFloat(d);b.checks.push({type:3,field:Bh(a),operator:c,value:d})}},{name:"dataBool",query:!0,regex:"\\[\\s*(\\?|\\!|\\^)\\s*((?:[\\w-.]|(?:\\\\[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]))+)\\s*\\]",populate:function(a,b,c){a=z(c,2);c=a[0];b.checks.push({type:5,field:Bh(a[1]),operator:c})}},{name:"metaCompare",
query:!0,regex:"\\[\\[\\s*(degree|indegree|outdegree)\\s*("+Ah+")\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*\\]\\]",populate:function(a,b,c){a=z(c,3);c=a[1];var d=a[2];b.checks.push({type:6,field:Bh(a[0]),operator:c,value:parseFloat(d)})}},{name:"nextQuery",separator:!0,regex:"\\s*,\\s*",populate:function(a,b){b=a.currentSubject;var c=a.edgeCount,d=a.compoundCount,f=a[a.length-1];null!=b&&(f.subject=b,a.currentSubject=null);f.edgeCount=c;f.compoundCount=d;a.edgeCount=0;a.compoundCount=
0;return a[a.length++]=td()}},{name:"directedEdge",separator:!0,regex:"\\s+->\\s+",populate:function(a,b){if(null==a.currentSubject){var c=td(),d=td();c.checks.push({type:11,source:b,target:d});a[a.length-1]=c;return a.edgeCount++,d}c=td();d=td();c.checks.push({type:12,source:b,target:d});a[a.length-1]=c;return a.edgeCount++,d}},{name:"undirectedEdge",separator:!0,regex:"\\s+<->\\s+",populate:function(a,b){if(null==a.currentSubject){var c=td(),d=td();c.checks.push({type:10,nodes:[b,d]});a[a.length-
1]=c;return a.edgeCount++,d}c=td();d=td();c.checks.push({type:14,node:b,neighbor:d});a[a.length-1]=c;return d}},{name:"child",separator:!0,regex:"\\s+>\\s+",populate:function(a,b){if(null==a.currentSubject){b=td();var c=td();b.checks.push({type:15,parent:a[a.length-1],child:c});a[a.length-1]=b;return a.compoundCount++,c}if(a.currentSubject===b){c=td();var d=a[a.length-1],f=td(),h=td(),l=td(),m=td();c.checks.push({type:19,left:d,right:f,subject:h});h.checks=b.checks;b.checks=[{type:20}];m.checks.push({type:20});
f.checks.push({type:17,parent:m,child:l});a[a.length-1]=c;return a.currentSubject=h,a.compoundCount++,l}c=td();d=td();f=[{type:17,parent:c,child:d}];return c.checks=b.checks,b.checks=f,a.compoundCount++,d}},{name:"descendant",separator:!0,regex:"\\s+",populate:function(a,b){if(null==a.currentSubject){b=td();var c=td();b.checks.push({type:16,ancestor:a[a.length-1],descendant:c});a[a.length-1]=b;return a.compoundCount++,c}if(a.currentSubject===b){c=td();var d=a[a.length-1],f=td(),h=td(),l=td(),m=td();
c.checks.push({type:19,left:d,right:f,subject:h});h.checks=b.checks;b.checks=[{type:20}];m.checks.push({type:20});f.checks.push({type:18,ancestor:m,descendant:l});a[a.length-1]=c;return a.currentSubject=h,a.compoundCount++,l}c=td();d=td();f=[{type:18,ancestor:c,descendant:d}];return c.checks=b.checks,b.checks=f,a.compoundCount++,d}},{name:"subject",modifier:!0,regex:"\\$",populate:function(a,b){if(null!=a.currentSubject&&a.currentSubject!==b)return fd("Redefinition of subject in selector `"+a.toString()+
"`"),!1;a.currentSubject=b;a=a[a.length-1].checks[0];b=null==a?null:a.type;11===b?a.type=13:10===b&&(a.type=14,a.node=a.nodes[1],a.neighbor=a.nodes[0],a.nodes=null)}}];gl.forEach(function(a){return a.regexObj=new RegExp("^"+a.regex)});var tn=function(a,b,c){var d=rc(a),f=cc(a),h=rc(c),l,m,t=!1,v=!1,C=!1;switch(0<=b.indexOf("!")&&(b=b.replace("!",""),v=!0),0<=b.indexOf("@")&&(b=b.replace("@",""),t=!0),(d||h||t)&&(l=d||f?""+a:"",m=""+c),t&&(a=l=l.toLowerCase(),c=m=m.toLowerCase()),b){case "*=":b=0<=
l.indexOf(m);break;case "$=":b=0<=l.indexOf(m,l.length-m.length);break;case "^=":b=0===l.indexOf(m);break;case "=":b=a===c;break;case ">":C=!0;b=a>c;break;case ">=":C=!0;b=a>=c;break;case "<":C=!0;b=a<c;break;case "<=":C=!0;b=a<=c;break;default:b=!1}return v&&(null!=a||!C)&&(b=!b),b},Hd=[],Fd=function(a,b){return a.checks.every(function(c){return Hd[c.type](c,b)})};Hd[0]=function(a,b){a=a.value;return"*"===a||a===b.group()};Hd[7]=function(a,b){return lq[a.value](b)};Hd[8]=function(a,b){a=a.value;
return b.id()===a};Hd[9]=function(a,b){return b.hasClass(a.value)};Hd[6]=function(a,b){var c=a.operator,d=a.value;return tn(b[a.field](),c,d)};Hd[3]=function(a,b){var c=a.operator,d=a.value;return tn(b.data(a.field),c,d)};Hd[5]=function(a,b){var c=a.operator;a:{a=b.data(a.field);switch(c){case "?":c=!!a;break a;case "!":c=!a;break a;case "^":c=void 0===a;break a}c=void 0}return c};Hd[4]=function(a,b){var c=a.field;return a.operator,void 0!==b.data(c)};Hd[10]=function(a,b){var c=a.nodes[0];a=a.nodes[1];
var d=b.source();b=b.target();return Fd(c,d)&&Fd(a,b)||Fd(a,d)&&Fd(c,b)};Hd[14]=function(a,b){return Fd(a.node,b)&&b.neighborhood().some(function(c){return c.isNode()&&Fd(a.neighbor,c)})};Hd[11]=function(a,b){return Fd(a.source,b.source())&&Fd(a.target,b.target())};Hd[12]=function(a,b){return Fd(a.source,b)&&b.outgoers().some(function(c){return c.isNode()&&Fd(a.target,c)})};Hd[13]=function(a,b){return Fd(a.target,b)&&b.incomers().some(function(c){return c.isNode()&&Fd(a.source,c)})};Hd[15]=function(a,
b){return Fd(a.child,b)&&Fd(a.parent,b.parent())};Hd[17]=function(a,b){return Fd(a.parent,b)&&b.children().some(function(c){return Fd(a.child,c)})};Hd[16]=function(a,b){return Fd(a.descendant,b)&&b.ancestors().some(function(c){return Fd(a.ancestor,c)})};Hd[18]=function(a,b){return Fd(a.ancestor,b)&&b.descendants().some(function(c){return Fd(a.descendant,c)})};Hd[19]=function(a,b){return Fd(a.subject,b)&&Fd(a.left,b)&&Fd(a.right,b)};Hd[20]=function(){return!0};Hd[1]=function(a,b){return a.value.has(b)};
Hd[2]=function(a,b){a=a.value;return a(b)};var Zf=function(a){this.inputText=a;this.currentSubject=null;this.length=this.edgeCount=this.compoundCount=0;null==a||rc(a)&&a.match(/^\s*$/)||($d(a)?this.addQuery({checks:[{type:1,value:a.collection()}]}):Gc(a)?this.addQuery({checks:[{type:2,value:a}]}):rc(a)?this.parse(a)||(this.invalid=!0):vd("A selector must be created from a string; found "))},$f=Zf.prototype;[{parse:function(a){var b,c,d=this.inputText=a,f=this[0]=td();this.length=1;for((c=d.match(/^\s+/))&&
(d=d.substring(c[0].length));;){var h=b=void 0;c=d;for(var l=0;l<gl.length;l++){var m=gl[l],t=c.match(m.regexObj);if(null!=t){b=t;h=m;c=c.substring(t[0].length);break}}if(null==h)return fd("The selector `"+a+"`is invalid"),!1;b=b.slice(1);b=h.populate(this,f,b);if(!1===b)return!1;if(null!=b&&(f=b),d=c,d.match(/^\s*$/))break}f=this[this.length-1];null!=this.currentSubject&&(f.subject=this.currentSubject);f.edgeCount=this.edgeCount;f.compoundCount=this.compoundCount;for(f=0;f<this.length;f++){d=this[f];
if(0<d.compoundCount&&0<d.edgeCount)return fd("The selector `"+a+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(1<d.edgeCount)return fd("The selector `"+a+"` is invalid because it uses multiple edge selectors"),!1;1===d.edgeCount&&fd("The selector `"+a+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},
toString:function(){if(null!=this.toStringCache)return this.toStringCache;for(var a=function(l){return rc(l)?'"'+l+'"':l??""},b=function(l,m){var t=l.value;switch(l.type){case 0:return l=t??"",l.substring(0,l.length-1);case 3:return"["+l.field+(" "+(l.operator??"")+" ")+a(t)+"]";case 5:return"["+(l.operator??"")+l.field+"]";case 4:return"["+l.field+"]";case 6:return"[["+l.field+(" "+(l.operator??"")+" ")+a(t)+"]]";case 7:return t;case 8:return"#"+t;case 9:return"."+t;case 17:case 15:return c(l.parent,
m)+" > "+c(l.child,m);case 18:case 16:return c(l.ancestor,m)+" "+c(l.descendant,m);case 19:t=c(l.left,m);var v=c(l.subject,m);l=c(l.right,m);return t+(0<t.length?" ":"")+v+l;case 20:return""}},c=function(l,m){return l.checks.reduce(function(t,v,C){return t+(m===l&&0===C?"$":"")+b(v,m)},"")},d="",f=0;f<this.length;f++){var h=this[f];d+=c(h,h.subject);1<this.length&&f<this.length-1&&(d+=", ")}return this.toStringCache=d,d}},{matches:function(a){for(var b=0;b<this.length;b++)if(Fd(this[b],a))return!0;
return!1},filter:function(a){var b=this;if(1===b.length&&1===b[0].checks.length&&8===b[0].checks[0].type)return a.getElementById(b[0].checks[0].value).collection();var c=function(d){for(var f=0;f<b.length;f++)if(Fd(b[f],d))return!0;return!1};return null==b.text()&&(c=function(){return!0}),a.filter(c)}}].forEach(function(a){return Bc($f,a)});$f.text=function(){return this.inputText};$f.size=function(){return this.length};$f.eq=function(a){return this[a]};$f.sameText=function(a){return!this.invalid&&
!a.invalid&&this.text()===a.text()};$f.addQuery=function(a){this[this.length++]=a};$f.selector=$f.toString;var ag={allAre:function(a){var b=new Zf(a);return this.every(function(c){return b.matches(c)})},is:function(a){var b=new Zf(a);return this.some(function(c){return b.matches(c)})},some:function(a,b){for(var c=0;c<this.length;c++)if(b?a.apply(b,[this[c],c,this]):a(this[c],c,this))return!0;return!1},every:function(a,b){for(var c=0;c<this.length;c++)if(b?!a.apply(b,[this[c],c,this]):!a(this[c],c,
this))return!1;return!0},same:function(a){if(this===a)return!0;a=this.cy().collection(a);var b=this.length;return b!==a.length?!1:1===b?this[0]===a[0]:this.every(function(c){return a.hasElementWithId(c.id())})},anySame:function(a){return a=this.cy().collection(a),this.some(function(b){return a.hasElementWithId(b.id())})},allAreNeighbors:function(a){a=this.cy().collection(a);var b=this.neighborhood();return a.every(function(c){return b.hasElementWithId(c.id())})},contains:function(a){a=this.cy().collection(a);
var b=this;return a.every(function(c){return b.hasElementWithId(c.id())})}};ag.allAreNeighbours=ag.allAreNeighbors;ag.has=ag.contains;ag.equal=ag.equals=ag.same;var Je=function(a,b){return function(c,d,f,h){var l;if(null==c?l="":$d(c)&&1===c.length&&(l=c.id()),1===this.length&&l){var m=this[0]._private;m=m.traversalCache=m.traversalCache||{};m=m[b]=m[b]||[];l=wf(l);return m[l]||(m[l]=a.call(this,c,d,f,h))}return a.call(this,c,d,f,h)}},hl={parent:function(a){var b=[];if(1===this.length){var c=this[0]._private.parent;
if(c)return c}for(c=0;c<this.length;c++){var d=this[c]._private.parent;d&&b.push(d)}return this.spawn(b,!0).filter(a)},parents:function(a){for(var b=[],c=this.parent();c.nonempty();){for(var d=0;d<c.length;d++)b.push(c[d]);c=c.parent()}return this.spawn(b,!0).filter(a)},commonAncestors:function(a){for(var b,c=0;c<this.length;c++){var d=this[c].parents();b=b||d;b=b.intersect(d)}return b.filter(a)},orphans:function(a){return this.stdFilter(function(b){return b.isOrphan()}).filter(a)},nonorphans:function(a){return this.stdFilter(function(b){return b.isChild()}).filter(a)},
children:Je(function(a){for(var b=[],c=0;c<this.length;c++)for(var d=this[c]._private.children,f=0;f<d.length;f++)b.push(d[f]);return this.spawn(b,!0).filter(a)},"children"),siblings:function(a){return this.parent().children().not(this).filter(a)},isParent:function(){var a=this[0];if(a)return a.isNode()&&0!==a._private.children.length},isChildless:function(){var a=this[0];if(a)return a.isNode()&&0===a._private.children.length},isChild:function(){var a=this[0];if(a)return a.isNode()&&null!=a._private.parent},
isOrphan:function(){var a=this[0];if(a)return a.isNode()&&null==a._private.parent},descendants:function(a){function b(d){for(var f=0;f<d.length;f++){var h=d[f];c.push(h);h.children().nonempty()&&b(h.children())}}var c=[];return b(this.children()),this.spawn(c,!0).filter(a)},forEachDown:function(a){return Cc(this,a,1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,Tc)},forEachUp:function(a){return Cc(this,a,1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,Vc)},forEachUpAndDown:function(a){return Cc(this,
a,1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,qd)}};hl.ancestors=hl.parents;var un;var Yi=un={data:ld.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:ld.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),
scratch:ld.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:ld.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:ld.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:ld.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var a=
this[0];if(a)return a._private.data.id}};Yi.attr=Yi.data;Yi.removeAttr=Yi.removeData;var Zi={};Bc(Zi,{degree:wd(function(a,b){return b.source().same(b.target())?2:1}),indegree:wd(function(a,b){return b.target().same(a)?1:0}),outdegree:wd(function(a,b){return b.source().same(a)?1:0})});Bc(Zi,{minDegree:Yc("degree",function(a,b){return a<b}),maxDegree:Yc("degree",function(a,b){return a>b}),minIndegree:Yc("indegree",function(a,b){return a<b}),maxIndegree:Yc("indegree",function(a,b){return a>b}),minOutdegree:Yc("outdegree",
function(a,b){return a<b}),maxOutdegree:Yc("outdegree",function(a,b){return a>b})});Bc(Zi,{totalDegree:function(a){for(var b=0,c=this.nodes(),d=0;d<c.length;d++)b+=c[d].degree(a);return b}});var vn,wn=function(a,b,c){for(var d=0;d<a.length;d++){var f=a[d];if(!f.locked()){var h=f._private.position;h={x:null!=b.x?b.x-h.x:0,y:null!=b.y?b.y-h.y:0};f.isParent()&&(0!==h.x||0!==h.y)&&f.children().shift(h,c);f.dirtyBoundingBoxCache()}}},xn={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,
settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(a){a.updateCompoundBounds()},beforeSet:function(a,b){wn(a,b,!1)},onSet:function(a){a.dirtyCompoundBoundsCache()},canSet:function(a){return!a.locked()}};var lf=vn={position:ld.data(xn),silentPosition:ld.data(Bc({},xn,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(a,b){wn(a,b,!0)},onSet:function(a){a.dirtyCompoundBoundsCache()}})),
positions:function(a,b){if(Zc(a))b?this.silentPosition(a):this.position(a);else if(Gc(a)){var c=this.cy();c.startBatch();for(var d=0;d<this.length;d++){var f=this[d],h=void 0;(h=a(f,d))&&(b?f.silentPosition(h):f.position(h))}c.endBatch()}return this},silentPositions:function(a){return this.positions(a,!0)},shift:function(a,b,c){var d;if(Zc(a)?(d={x:cc(a.x)?a.x:0,y:cc(a.y)?a.y:0},c=b):rc(a)&&cc(b)&&(d={x:0,y:0},d[a]=b),null!=d){a=this.cy();a.startBatch();for(b=0;b<this.length;b++){var f=this[b];if(!(a.hasCompoundNodes()&&
f.isChild()&&f.ancestors().anySame(this))){var h=f.position();h={x:h.x+d.x,y:h.y+d.y};c?f.silentPosition(h):f.position(h)}}a.endBatch()}return this},silentShift:function(a,b){return Zc(a)?this.shift(a,!0):rc(a)&&cc(b)&&this.shift(a,b,!0),this},renderedPosition:function(a,b){var c=this[0],d=this.cy(),f=d.zoom();d=d.pan();var h=Zc(a)?a:void 0,l=void 0!==h||void 0!==b&&rc(a);if(c&&c.isNode())if(l)for(c=0;c<this.length;c++)l=this[c],void 0!==b?l.position(a,(b-d[a])/f):void 0!==h&&l.position({x:(h.x-d.x)/
f,y:(h.y-d.y)/f});else return b=c.position(),h=rh(b,f,d),void 0===a?h:h[a];else if(!l)return;return this},relativePosition:function(a,b){var c=this[0],d=this.cy(),f=Zc(a)?a:void 0,h=void 0!==f||void 0!==b&&rc(a);d=d.hasCompoundNodes();if(c&&c.isNode())if(h)for(c=0;c<this.length;c++){h=this[c];var l=d?h.parent():null,m=l&&0<l.length,t=m;m&&(l=l[0]);l=t?l.position():{x:0,y:0};void 0!==b?h.position(a,b+l[a]):void 0!==f&&h.position({x:f.x+l.x,y:f.y+l.y})}else return b=c.position(),(c=(d=d?c.parent():
null)&&0<d.length)&&(d=d[0]),d=c?d.position():{x:0,y:0},f={x:b.x-d.x,y:b.y-d.y},void 0===a?f:f[a];else if(!h)return;return this}};lf.modelPosition=lf.point=lf.position;lf.modelPositions=lf.points=lf.positions;lf.renderedPoint=lf.renderedPosition;lf.relativePoint=lf.relativePosition;var bg;var hi=bg={};bg.renderedBoundingBox=function(a){a=this.boundingBox(a);var b=this.cy(),c=b.zoom(),d=b.pan();b=a.x1*c+d.x;var f=a.x2*c+d.x,h=a.y1*c+d.y;a=a.y2*c+d.y;return{x1:b,x2:f,y1:h,y2:a,w:f-b,h:a-h}};bg.dirtyCompoundBoundsCache=
function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!1,b=this.cy();return b.styleEnabled()&&b.hasCompoundNodes()?(this.forEachUp(function(c){if(c.isParent()){var d=c._private;d.compoundBoundsClean=!1;d.bbCache=null;a||c.emitAndNotify("bounds")}}),this):this};bg.updateCompoundBounds=function(){function a(l){function m(Y,ta,ja){var Ba=0,Ua=0,ab=ta+ja;return 0<Y&&0<ab&&(Ba=ta/ab*Y,Ua=ja/ab*Y),{biasDiff:Ba,biasComplementDiff:Ua}}if(l.isParent()){var t=l._private,v=l.children(),C="include"===
l.pstyle("compound-sizing-wrt-labels").value,D=l.pstyle("min-width").pfValue,F=l.pstyle("min-width-bias-left"),I=l.pstyle("min-width-bias-right"),K=l.pstyle("min-height").pfValue,P=l.pstyle("min-height-bias-top"),ba=l.pstyle("min-height-bias-bottom");v=v.boundingBox({includeLabels:C,includeOverlays:!1,useCache:!1});C=t.position;(0===v.w||0===v.h)&&(v={w:l.pstyle("width").pfValue,h:l.pstyle("height").pfValue},v.x1=C.x-v.w/2,v.x2=C.x+v.w/2,v.y1=C.y-v.h/2,v.y2=C.y+v.h/2);var X=F.value;"px"===F.units&&
0<D&&(X=100*X/D);F=I.value;"px"===I.units&&0<D&&(F=100*F/D);I=P.value;"px"===P.units&&0<K&&(I=100*I/K);P=ba.value;"px"===ba.units&&0<K&&(P=100*P/K);X=m(D-v.w,X,F);ba=X.biasDiff;X=X.biasComplementDiff;I=m(K-v.h,I,P);P=I.biasDiff;I=I.biasComplementDiff;t.autoPadding=function(Y,ta,ja,Ba){if("%"===ja.units)switch(Ba){case "width":return 0<Y?ja.pfValue*Y:0;case "height":return 0<ta?ja.pfValue*ta:0;case "average":return 0<Y&&0<ta?ja.pfValue*(Y+ta)/2:0;case "min":return 0<Y&&0<ta?Y>ta?ja.pfValue*ta:ja.pfValue*
Y:0;case "max":return 0<Y&&0<ta?Y>ta?ja.pfValue*Y:ja.pfValue*ta:0;default:return 0}else return"px"===ja.units?ja.pfValue:0}(v.w,v.h,l.pstyle("padding"),l.pstyle("padding-relative-to").value);t.autoWidth=Math.max(v.w,D);C.x=(-ba+v.x1+v.x2+X)/2;t.autoHeight=Math.max(v.h,K);C.y=(-P+v.y1+v.y2+I)/2}}var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!1,c=this.cy();if(!c.styleEnabled()||!c.hasCompoundNodes()||!b&&c.batching())return this;for(var d=0;d<this.length;d++){var f=this[d],h=f._private;
(!h.compoundBoundsClean||b)&&(a(f),c.batching()||(h.compoundBoundsClean=!0))}return this};var Ke=function(a){return a===1/0||a===-1/0?0:a},We=function(a,b,c,d,f){0===d-b||0===f-c||null==b||null==c||null==d||null==f||(a.x1=b<a.x1?b:a.x1,a.x2=d>a.x2?d:a.x2,a.y1=c<a.y1?c:a.y1,a.y2=f>a.y2?f:a.y2,a.w=a.x2-a.x1,a.h=a.y2-a.y1)},Lg=function(a,b){return null==b?a:We(a,b.x1,b.y1,b.x2,b.y2)},$i=function(a,b,c){if(!b.cy().headless()){var d=b._private,f=d.rstyle,h=f.arrowWidth/2,l,m;"none"!==b.pstyle(c+"-arrow-shape").value&&
("source"===c?(l=f.srcX,m=f.srcY):"target"===c?(l=f.tgtX,m=f.tgtY):(l=f.midX,m=f.midY),b=d.arrowBounds=d.arrowBounds||{},c=b[c]=b[c]||{},c.x1=l-h,c.y1=m-h,c.x2=l+h,c.y2=m+h,c.w=c.x2-c.x1,c.h=c.y2-c.y1,vh(c,1),We(a,c.x1,c.y1,c.x2,c.y2))}},il=function(a,b,c){if(!b.cy().headless()){var d;c?d=c+"-":d="";var f=b._private,h=f.rstyle;if(b.pstyle(d+"label").strValue){var l=b.pstyle("text-halign"),m=b.pstyle("text-valign"),t=Ed(h,"labelWidth",c),v=Ed(h,"labelHeight",c),C=Ed(h,"labelX",c),D=Ed(h,"labelY",c),
F=b.pstyle(d+"text-margin-x").pfValue,I=b.pstyle(d+"text-margin-y").pfValue;h=b.isEdge();d=b.pstyle(d+"text-rotation");var K=b.pstyle("text-outline-width").pfValue,P=b.pstyle("text-border-width").pfValue/2;b=b.pstyle("text-background-padding").pfValue;var ba=t/2,X=v/2;if(h){var Y=C-ba;var ta=C+ba;var ja=D-X;var Ba=D+X}else{switch(l.value){case "left":Y=C-t;ta=C;break;case "center":Y=C-ba;ta=C+ba;break;case "right":Y=C,ta=C+t}switch(m.value){case "top":ja=D-v;Ba=D;break;case "center":ja=D-X;Ba=D+X;
break;case "bottom":ja=D,Ba=D+v}}t=F-Math.max(K,P)-b-2;v=F+Math.max(K,P)+b+2;C=I-Math.max(K,P)-b-2;P=I+Math.max(K,P)+b+2;Y+=t;ta+=v;ja+=C;Ba+=P;K=c||"main";I=f.labelBounds;F=I[K]=I[K]||{};F.x1=Y;F.y1=ja;F.x2=ta;F.y2=Ba;F.w=ta-Y;F.h=Ba-ja;F.leftPad=t;F.rightPad=v;F.topPad=C;F.botPad=P;P=h&&"autorotate"===d.strValue;t=null!=d.pfValue&&0!==d.pfValue;if(P||t){c=P?Ed(f.rstyle,"labelAngle",c):d.pfValue;var Ua=Math.cos(c),ab=Math.sin(c),Qb=(Y+ta)/2,Mb=(ja+Ba)/2;if(!h){switch(l.value){case "left":Qb=ta;break;
case "right":Qb=Y}switch(m.value){case "top":Mb=Ba;break;case "bottom":Mb=ja}}h=function(Ub,Wb){return Ub-=Qb,Wb-=Mb,{x:Ub*Ua-Wb*ab+Qb,y:Ub*ab+Wb*Ua+Mb}};l=h(Y,ja);m=h(Y,Ba);c=h(ta,ja);Ba=h(ta,Ba);Y=Math.min(l.x,m.x,c.x,Ba.x);ta=Math.max(l.x,m.x,c.x,Ba.x);ja=Math.min(l.y,m.y,c.y,Ba.y);Ba=Math.max(l.y,m.y,c.y,Ba.y)}l=K+"Rot";l=I[l]=I[l]||{};l.x1=Y;l.y1=ja;l.x2=ta;l.y2=Ba;l.w=ta-Y;l.h=Ba-ja;We(a,Y,ja,ta,Ba);We(f.labelBounds.all,Y,ja,ta,Ba)}return a}},mq=function(a,b){if(!b.cy().headless()){var c=b.pstyle("outline-opacity").value,
d=b.pstyle("outline-width").value;if(0<c&&0<d){c=b.pstyle("outline-offset").value;b=b.pstyle("shape").value;d+=c;c=(a.w+2*d)/a.w;var f=(a.h+2*d)/a.h,h=0;["diamond","pentagon","round-triangle"].includes(b)?(c=(a.w+2.4*d)/a.w,h=-d/3.6):["concave-hexagon","rhomboid","right-rhomboid"].includes(b)?c=(a.w+2.4*d)/a.w:"star"===b?(c=(a.w+2.8*d)/a.w,f=(a.h+2.6*d)/a.h,h=-d/3.8):"triangle"===b?(c=(a.w+2.8*d)/a.w,f=(a.h+2.4*d)/a.h,h=-d/1.4):"vee"===b&&(c=(a.w+4.4*d)/a.w,f=(a.h+3.8*d)/a.h,h=.5*-d);(uh(a,[Math.ceil((a.h*
f-a.h)/2),Math.ceil((a.w*c-a.w)/2)]),0!==h)&&Bg(a,{x1:a.x1+0,x2:a.x2+0,y1:a.y1+h,y2:a.y2+h,w:a.w,h:a.h})}}},nq=function(a,b){var c=a._private.cy,d=c.styleEnabled(),f=c.headless();c=ae();var h=a._private,l=a.isNode(),m=a.isEdge(),t=h.rstyle,v=l&&d?a.pstyle("bounds-expansion").pfValue:[0],C=function(ta){return"none"!==ta.pstyle("display").value};if(C=!d||C(a)&&(!m||C(a.source())&&C(a.target()))){var D=0,F=0;d&&b.includeOverlays&&(D=a.pstyle("overlay-opacity").value,0!==D&&(F=a.pstyle("overlay-padding").value));
var I=D=0;d&&b.includeUnderlays&&(D=a.pstyle("underlay-opacity").value,0!==D&&(I=a.pstyle("underlay-padding").value));F=Math.max(F,I);D=I=0;if(d&&(I=a.pstyle("width").pfValue,D=I/2),l&&b.includeNodes){var K=a.position();var P=K.x;var ba=K.y;var X=a.outerWidth()/2;D=a.outerHeight()/2;K=P-X;P+=X;X=ba-D;ba+=D;We(c,K,X,P,ba);d&&b.includeOutlines&&mq(c,a)}else if(m&&b.includeEdges)if(d&&!f)if(f=a.pstyle("curve-style").strValue,K=Math.min(t.srcX,t.midX,t.tgtX),P=Math.max(t.srcX,t.midX,t.tgtX),X=Math.min(t.srcY,
t.midY,t.tgtY),ba=Math.max(t.srcY,t.midY,t.tgtY),K-=D,P+=D,X-=D,ba+=D,We(c,K,X,P,ba),"haystack"===f){var Y=t.haystackPts;if(Y&&2===Y.length){if(K=Y[0].x,X=Y[0].y,P=Y[1].x,ba=Y[1].y,K>P)Y=K,K=P,P=Y;X>ba&&(Y=X,X=ba,ba=Y);We(c,K-D,X-D,P+D,ba+D)}}else{if("bezier"===f||"unbundled-bezier"===f||f.endsWith("segments")||f.endsWith("taxi")){switch(f){case "bezier":case "unbundled-bezier":Y=t.bezierPts;break;case "segments":case "taxi":case "round-segments":case "round-taxi":Y=t.linePts}if(null!=Y)for(t=0;t<
Y.length;t++)ba=Y[t],K=ba.x-D,P=ba.x+D,X=ba.y-D,ba=ba.y+D,We(c,K,X,P,ba)}}else{Y=a.source().position();t=a.target().position();if(K=Y.x,P=t.x,X=Y.y,ba=t.y,K>P)Y=K,K=P,P=Y;X>ba&&(Y=X,X=ba,ba=Y);K-=D;P+=D;X-=D;ba+=D;We(c,K,X,P,ba)}(d&&b.includeEdges&&m&&($i(c,a,"mid-source"),$i(c,a,"mid-target"),$i(c,a,"source"),$i(c,a,"target")),d)&&"yes"===a.pstyle("ghost").value&&(D=a.pstyle("ghost-offset-x").pfValue,Y=a.pstyle("ghost-offset-y").pfValue,We(c,c.x1+D,c.y1+Y,c.x2+D,c.y2+Y));D=h.bodyBounds=h.bodyBounds||
{};th(D,c);uh(D,v);vh(D,1);d&&(K=c.x1,P=c.x2,X=c.y1,ba=c.y2,We(c,K-F,X-F,P+F,ba+F));K=h.overlayBounds=h.overlayBounds||{};th(K,c);uh(K,v);vh(K,1);h=h.labelBounds=h.labelBounds||{};null!=h.all?Mi(h.all):h.all=ae();d&&b.includeLabels&&(b.includeMainLabels&&il(c,a,null),m&&(b.includeSourceLabels&&il(c,a,"source"),b.includeTargetLabels&&il(c,a,"target")))}return c.x1=Ke(c.x1),c.y1=Ke(c.y1),c.x2=Ke(c.x2),c.y2=Ke(c.y2),c.w=Ke(c.x2-c.x1),c.h=Ke(c.y2-c.y1),0<c.w&&0<c.h&&C&&(uh(c,v),vh(c,1)),c},yn=function(a){var b=
0,c=function(f){return(f?1:0)<<b++},d=0;return d+=c(a.incudeNodes),d+=c(a.includeEdges),d+=c(a.includeLabels),d+=c(a.includeMainLabels),d+=c(a.includeSourceLabels),d+=c(a.includeTargetLabels),d+=c(a.includeOverlays),d+=c(a.includeOutlines),d},zn=function(a){if(a.isEdge()){var b=a.source().position();a=a.target().position();return Gi([Math.round(b.x),Math.round(b.y),Math.round(a.x),Math.round(a.y)])}b=a.position();return Gi([Math.round(b.x),Math.round(b.y)])},Bn=function(a,b){var c=a._private,d,f=
a.isEdge(),h=(null==b?An:yn(b))===An;(null==c.bbCache?(d=nq(a,ii),c.bbCache=d,c.bbCachePosKey=zn(a)):d=c.bbCache,h)||(a=a.isNode(),d=ae(),(b.includeNodes&&a||b.includeEdges&&!a)&&(b.includeOverlays?Lg(d,c.overlayBounds):Lg(d,c.bodyBounds)),b.includeLabels&&(b.includeMainLabels&&(!f||b.includeSourceLabels&&b.includeTargetLabels)?Lg(d,c.labelBounds.all):(b.includeMainLabels&&Lg(d,c.labelBounds.mainRot),b.includeSourceLabels&&Lg(d,c.labelBounds.sourceRot),b.includeTargetLabels&&Lg(d,c.labelBounds.targetRot))),
d.w=d.x2-d.x1,d.h=d.y2-d.y1);return d},ii={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},An=yn(ii),Cn=Id(ii);bg.boundingBox=function(a){var b=void 0===a||void 0===a.useCache||!0===a.useCache,c=tf(function(h){var l=h._private;return null==l.bbCache||l.styleDirty||l.bbCachePosKey!==zn(h)},function(h){return h.id()});if(b&&1===this.length&&!c(this[0])){void 0===
a?a=ii:a=Cn(a);var d=Bn(this[0],a)}else{d=ae();a=a||ii;a=Cn(a);var f=this.cy().styleEnabled();this.edges().forEach(c);this.nodes().forEach(c);f&&this.recalculateRenderedStyle(b);this.updateCompoundBounds(!b);for(b=0;b<this.length;b++)f=this[b],c(f)&&f.dirtyBoundingBoxCache(),Lg(d,Bn(f,a))}return d.x1=Ke(d.x1),d.y1=Ke(d.y1),d.x2=Ke(d.x2),d.y2=Ke(d.y2),d.w=Ke(d.x2-d.x1),d.h=Ke(d.y2-d.y1),d};bg.dirtyBoundingBoxCache=function(){for(var a=0;a<this.length;a++){var b=this[a]._private;b.bbCache=null;b.bbCachePosKey=
null;b.bodyBounds=null;b.overlayBounds=null;b.labelBounds.all=null;b.labelBounds.source=null;b.labelBounds.target=null;b.labelBounds.main=null;b.labelBounds.sourceRot=null;b.labelBounds.targetRot=null;b.labelBounds.mainRot=null;b.arrowBounds.source=null;b.arrowBounds.target=null;b.arrowBounds["mid-source"]=null;b.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};bg.boundingBoxAt=function(a){var b=this.nodes(),c=this.cy(),d=c.hasCompoundNodes(),f=c.collection();if(d&&(f=b.filter(function(m){return m.isParent()}),
b=b.not(f)),Zc(a)){var h=a;a=function(){return h}}c.startBatch();b.forEach(function(m,t){return m._private.bbAtOldPos=a(m,t)}).silentPositions(a);d&&(f.dirtyCompoundBoundsCache(),f.dirtyBoundingBoxCache(),f.updateCompoundBounds(!0));var l=sh(this.boundingBox({useCache:!1}));return b.silentPositions(function(m){return m._private.bbAtOldPos}),d&&(f.dirtyCompoundBoundsCache(),f.dirtyBoundingBoxCache(),f.updateCompoundBounds(!0)),c.endBatch(),l};hi.boundingbox=hi.bb=hi.boundingBox;hi.renderedBoundingbox=
hi.renderedBoundingBox;var ji;var aj=ji={};var Dn=function(a){a.uppercaseName=ug(a.name);a.autoName="auto"+a.uppercaseName;a.labelName="label"+a.uppercaseName;a.outerName="outer"+a.uppercaseName;a.uppercaseOuterName=ug(a.outerName);aj[a.name]=function(){var b=this[0],c=b._private,d=c.cy._private.styleEnabled;if(b)if(d){if(b.isParent())return b.updateCompoundBounds(),c[a.autoName]||0;d=b.pstyle(a.name);switch(d.strValue){case "label":return b.recalculateRenderedStyle(),c.rstyle[a.labelName]||0;default:return d.pfValue}}else return 1};
aj["outer"+a.uppercaseName]=function(){var b=this[0],c=b._private.cy._private.styleEnabled;if(b){if(c){c=b[a.name]();var d=b.pstyle("border-position").value,f;"center"===d?f=b.pstyle("border-width").pfValue:"outside"===d?f=2*b.pstyle("border-width").pfValue:f=0;b=2*b.padding();return c+f+b}return 1}};aj["rendered"+a.uppercaseName]=function(){var b=this[0];if(b)return b[a.name]()*this.cy().zoom()};aj["rendered"+a.uppercaseOuterName]=function(){var b=this[0];if(b)return b[a.outerName]()*this.cy().zoom()}};
Dn({name:"width"});Dn({name:"height"});ji.padding=function(){var a=this[0],b=a._private;return a.isParent()?(a.updateCompoundBounds(),void 0!==b.autoPadding?b.autoPadding:a.pstyle("padding").pfValue):a.pstyle("padding").pfValue};ji.paddedHeight=function(){var a=this[0];return a.height()+2*a.padding()};ji.paddedWidth=function(){var a=this[0];return a.width()+2*a.padding()};var oq=function(a,b){if(a.isEdge()&&a.takesUpSpace()){var c=a.cy(),d=c.pan(),f=c.zoom();return b(a).map(function(h){return rh(h,
f,d)})}},En={controlPoints:{get:function(a){return a.renderer().getControlPoints(a)},mult:!0},segmentPoints:{get:function(a){return a.renderer().getSegmentPoints(a)},mult:!0},sourceEndpoint:{get:function(a){return a.renderer().getSourceEndpoint(a)}},targetEndpoint:{get:function(a){return a.renderer().getTargetEndpoint(a)}},midpoint:{get:function(a){return a.renderer().getEdgeMidpoint(a)}}},pq=function(a){return"rendered"+a[0].toUpperCase()+a.substr(1)},qq=Object.keys(En).reduce(function(a,b){var c=
En[b],d=pq(b);return a[b]=function(){var f=c.get;f=this.isEdge()&&this.takesUpSpace()?f(this):void 0;return f},c.mult?a[d]=function(){return oq(this,c.get)}:a[d]=function(){var f=c.get;if(this.isEdge()&&this.takesUpSpace()){var h=this.cy();f=rh(f(this),h.zoom(),h.pan())}else f=void 0;return f},a},{}),rq=Bc({},vn,bg,ji,qq),Fn=function(a,b){this.recycle(a,b)};Fn.prototype={instanceString:function(){return"event"},recycle:function(a,b){if(this.isImmediatePropagationStopped=this.isPropagationStopped=
this.isDefaultPrevented=nd,null!=a&&a.preventDefault?(this.type=a.type,this.isDefaultPrevented=a.defaultPrevented?V:nd):null!=a&&a.type?b=a:this.type=a,null!=b&&(this.originalEvent=b.originalEvent,this.type=null!=b.type?b.type:this.type,this.cy=b.cy,this.target=b.target,this.position=b.position,this.renderedPosition=b.renderedPosition,this.namespace=b.namespace,this.layout=b.layout),null!=this.cy&&null!=this.position&&null==this.renderedPosition){b=this.position;var c=this.cy.zoom(),d=this.cy.pan();
this.renderedPosition={x:b.x*c+d.x,y:b.y*c+d.y}}this.timeStamp=a&&a.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=V;var a=this.originalEvent;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){this.isPropagationStopped=V;var a=this.originalEvent;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=V;this.stopPropagation()},isDefaultPrevented:nd,isPropagationStopped:nd,isImmediatePropagationStopped:nd};
var Gn=/^([^.]+)(\.(?:[^.]+))?$/,Zm={qualifierCompare:function(a,b){return a===b},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(a){return a},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},Ym=Object.keys(Zm),Vp={},cg=A.prototype,Hn=function(a,b,c,d,f,h,l){Gc(d)&&(f=d,d=null);l&&(null==h?h=l:h=Bc({},h,l));c=kd(c)?c:c.split(/\s+/);for(l=0;l<c.length;l++){var m=c[l];if(!Fe(m)){var t=m.match(Gn);
if(t&&!1===b(a,m,t[1],t[2]?t[2]:null,d,f,h))break}}},In=function(a,b){return a.addEventFields(a.context,b),new Fn(b.type,b)},sq=function(a,b,c){if("event"===$e(c))b(a,c);else if(Zc(c))b(a,In(a,c));else{c=kd(c)?c:c.split(/\s+/);for(var d=0;d<c.length;d++){var f=c[d];!Fe(f)&&(f=f.match(Gn))&&(f=In(a,{type:f[1],namespace:f[2]?f[2]:null,target:a.context}),b(a,f))}}};cg.on=cg.addListener=function(a,b,c,d,f){return Hn(this,function(h,l,m,t,v,C,D){Gc(C)&&h.listeners.push({event:l,callback:C,type:m,namespace:t,
qualifier:v,conf:D})},a,b,c,d,f),this};cg.one=function(a,b,c,d){return this.on(a,b,c,d,{one:!0})};cg.removeListener=cg.off=function(a,b,c,d){var f=this;0!==this.emitting&&(this.listeners=this.listeners.slice());for(var h=this.listeners,l=function(t){var v=h[t];Hn(f,function(C,D,F,I,K,P){if(!(v.type!==F&&"*"!==a||(I||".*"===v.namespace)&&v.namespace!==I||K&&!C.qualifierCompare(v.qualifier,K)||P&&v.callback!==P))return h.splice(t,1),!1},a,b,c,d)},m=h.length-1;0<=m;m--)l(m);return this};cg.removeAllListeners=
function(){return this.removeListener("*")};cg.emit=cg.trigger=function(a,b,c){var d=this.listeners,f=d.length;return this.emitting++,kd(b)||(b=[b]),sq(this,function(h,l){null!=c&&(d=[{event:l.event,type:l.type,namespace:l.namespace,callback:c}],f=d.length);for(var m=function(){var v=d[t];if(v.type===l.type&&(!v.namespace||v.namespace===l.namespace||".*"===v.namespace)&&h.eventMatches(h.context,v,l)){var C=[l];null!=b&&ad(C,b);h.beforeEmit(h.context,v,l);v.conf&&v.conf.one&&(h.listeners=h.listeners.filter(function(F){return F!==
v}));var D=h.callbackContext(h.context,v,l);C=v.callback.apply(D,C);h.afterEmit(h.context,v,l);!1===C&&(l.stopPropagation(),l.preventDefault())}},t=0;t<f;t++)m();h.bubble(h.context)&&!l.isPropagationStopped()&&h.parent(h.context).emit(l,b)},a),this.emitting--,this};var tq={qualifierCompare:function(a,b){return null==a||null==b?null==a&&null==b:a.sameText(b)},eventMatches:function(a,b,c){b=b.qualifier;return null!=b?a!==c.target&&Kf(c.target)&&b.matches(c.target):!0},addEventFields:function(a,b){b.cy=
a.cy();b.target=a},callbackContext:function(a,b,c){return null!=b.qualifier?c.target:a},beforeEmit:function(a,b){b.conf&&b.conf.once&&b.conf.onceCollection.removeListener(b.event,b.qualifier,b.callback)},bubble:function(){return!0},parent:function(a){return a.isChild()?a.parent():a.cy()}},bj=function(a){return rc(a)?new Zf(a):a},Jn={createEmitter:function(){for(var a=0;a<this.length;a++){var b=this[a],c=b._private;c.emitter||(c.emitter=new A(tq,b))}return this},emitter:function(){return this._private.emitter},
on:function(a,b,c){b=bj(b);for(var d=0;d<this.length;d++)this[d].emitter().on(a,b,c);return this},removeListener:function(a,b,c){b=bj(b);for(var d=0;d<this.length;d++)this[d].emitter().removeListener(a,b,c);return this},removeAllListeners:function(){for(var a=0;a<this.length;a++)this[a].emitter().removeAllListeners();return this},one:function(a,b,c){b=bj(b);for(var d=0;d<this.length;d++)this[d].emitter().one(a,b,c);return this},once:function(a,b,c){b=bj(b);for(var d=0;d<this.length;d++)this[d].emitter().on(a,
b,c,{once:!0,onceCollection:this})},emit:function(a,b){for(var c=0;c<this.length;c++)this[c].emitter().emit(a,b);return this},emitAndNotify:function(a,b){if(0!==this.length)return this.cy().notify(a,this),this.emit(a,b),this}};ld.eventAliasesOn(Jn);var gd={nodes:function(a){return this.filter(function(b){return b.isNode()}).filter(a)},edges:function(a){return this.filter(function(b){return b.isEdge()}).filter(a)},byGroup:function(){for(var a=this.spawn(),b=this.spawn(),c=0;c<this.length;c++){var d=
this[c];d.isNode()?a.push(d):b.push(d)}return{nodes:a,edges:b}},filter:function(a,b){if(void 0===a)return this;if(rc(a)||$d(a))return(new Zf(a)).filter(this);if(Gc(a)){for(var c=this.spawn(),d=0;d<this.length;d++){var f=this[d];(b?a.apply(b,[f,d,this]):a(f,d,this))&&c.push(f)}return c}return this.spawn()},not:function(a){if(a){rc(a)&&(a=this.filter(a));for(var b=this.spawn(),c=0;c<this.length;c++){var d=this[c];a.has(d)||b.push(d)}return b}return this},absoluteComplement:function(){return this.cy().mutableElements().not(this)},
intersect:function(a){if(rc(a))return this.filter(a);var b=this.spawn(),c=this.length<a.length,d=c?this:a;a=c?a:this;for(c=0;c<d.length;c++){var f=d[c];a.has(f)&&b.push(f)}return b},xor:function(a){var b=this._private.cy;rc(a)&&(a=b.$(a));var c=this.spawn();b=function(d,f){for(var h=0;h<d.length;h++){var l=d[h];f.hasElementWithId(l._private.data.id)||c.push(l)}};return b(this,a),b(a,this),c},diff:function(a){var b=this._private.cy;rc(a)&&(a=b.$(a));b=this.spawn();var c=this.spawn(),d=this.spawn(),
f=function(h,l,m){for(var t=0;t<h.length;t++){var v=h[t];l.hasElementWithId(v._private.data.id)?d.merge(v):m.push(v)}};return f(this,a,b),f(a,this,c),{left:b,right:c,both:d}},add:function(a){var b=this._private.cy;if(!a)return this;rc(a)&&(a=b.mutableElements().filter(a));b=this.spawnSelf();for(var c=0;c<a.length;c++){var d=a[c];!this.has(d)&&b.push(d)}return b},merge:function(a){var b=this._private,c=b.cy;if(!a)return this;a&&rc(a)&&(a=c.mutableElements().filter(a));b=b.map;for(c=0;c<a.length;c++){var d=
a[c],f=d._private.data.id;if(!b.has(f)){var h=this.length++;this[h]=d;b.set(f,{ele:d,index:h})}}return this},unmergeAt:function(a){var b=this[a].id(),c=this._private.map;this[a]=void 0;c.delete(b);b=a===this.length-1;if(1<this.length&&!b){b=this.length-1;var d=this[b],f=d._private.data.id;this[b]=void 0;this[a]=d;c.set(f,{ele:d,index:a})}return this.length--,this},unmergeOne:function(a){a=a[0];return(a=this._private.map.get(a._private.data.id))?(this.unmergeAt(a.index),this):this},unmerge:function(a){var b=
this._private.cy;if(!a)return this;a&&rc(a)&&(a=b.mutableElements().filter(a));for(b=0;b<a.length;b++)this.unmergeOne(a[b]);return this},unmergeBy:function(a){for(var b=this.length-1;0<=b;b--)a(this[b])&&this.unmergeAt(b);return this},map:function(a,b){for(var c=[],d=0;d<this.length;d++){var f=this[d];f=b?a.apply(b,[f,d,this]):a(f,d,this);c.push(f)}return c},reduce:function(a,b){for(var c=0;c<this.length;c++)b=a(b,this[c],c,this);return b},max:function(a,b){for(var c=-1/0,d,f=0;f<this.length;f++){var h=
this[f],l=b?a.apply(b,[h,f,this]):a(h,f,this);l>c&&(c=l,d=h)}return{value:c,ele:d}},min:function(a,b){for(var c=1/0,d,f=0;f<this.length;f++){var h=this[f],l=b?a.apply(b,[h,f,this]):a(h,f,this);l<c&&(c=l,d=h)}return{value:c,ele:d}}};gd.u=gd["|"]=gd["+"]=gd.union=gd.or=gd.add;gd["\\"]=gd["!"]=gd["-"]=gd.difference=gd.relativeComplement=gd.subtract=gd.not;gd.n=gd["&"]=gd["."]=gd.and=gd.intersection=gd.intersect;gd["^"]=gd["(+)"]=gd["(-)"]=gd.symmetricDifference=gd.symdiff=gd.xor;gd.fnFilter=gd.filterFn=
gd.stdFilter=gd.filter;gd.complement=gd.abscomp=gd.absoluteComplement;var Kn=function(a,b){function c(l){var m=l.pstyle("z-compound-depth");return"auto"===m.value?f?l.zDepth():0:"bottom"===m.value?-1:"top"===m.value?Uf:0}function d(l){return"auto"===l.pstyle("z-index-compare").value&&l.isNode()?1:0}var f=a.cy().hasCompoundNodes(),h=c(a)-c(b);if(0!==h)return h;h=d(a)-d(b);if(0!==h)return h;h=a.pstyle("z-index").value-b.pstyle("z-index").value;return 0!==h?h:a.poolIndex()-b.poolIndex()},cj={forEach:function(a,
b){if(Gc(a))for(var c=this.length,d=0;d<c;d++){var f=this[d];if(!1===(b?a.apply(b,[f,d,this]):a(f,d,this)))break}return this},toArray:function(){for(var a=[],b=0;b<this.length;b++)a.push(this[b]);return a},slice:function(a,b){var c=[],d=this.length;null==b&&(b=d);null==a&&(a=0);0>a&&(a=d+a);for(0>b&&(b=d+b);0<=a&&a<b&&a<d;a++)c.push(this[a]);return this.spawn(c)},size:function(){return this.length},eq:function(a){return this[a]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-
1]||this.spawn()},empty:function(){return 0===this.length},nonempty:function(){return!this.empty()},sort:function(a){if(!Gc(a))return this;a=this.toArray().sort(a);return this.spawn(a)},sortByZIndex:function(){return this.sort(Kn)},zDepth:function(){var a=this[0];if(a){var b=a._private;if("nodes"===b.group)return b=b.data.parent?a.parents().size():0,a.isParent()?b:Uf-1;a=b.target;b=b.source.zDepth();a=a.zDepth();return Math.max(b,a,0)}}};cj.each=cj.forEach;(function(){"undefined"!=("u"<typeof Symbol?
"undefined":T(Symbol))&&"undefined"!=T(Symbol.iterator)&&(cj[Symbol.iterator]=function(){var a=this,b={value:void 0,done:!1},c=0,d=this.length;return B({next:function(){return c<d?b.value=a[c++]:(b.value=void 0,b.done=!0),b}},Symbol.iterator,function(){return this})})})();var uq=Id({nodeDimensionsIncludeLabels:!1}),dj={layoutDimensions:function(a){a=uq(a);this.takesUpSpace()?a.nodeDimensionsIncludeLabels?(a=this.boundingBox(),a={w:a.w,h:a.h}):a={w:this.outerWidth(),h:this.outerHeight()}:a={w:0,h:0};
return(0===a.w||0===a.h)&&(a.w=a.h=1),a},layoutPositions:function(a,b,c){var d=this.nodes().filter(function(F){return!F.isParent()}),f=this.cy(),h=b.eles,l=function(F){return F.id()},m=tf(c,l);a.emit({type:"layoutstart",layout:a});a.animations=[];var t=b.spacingFactor&&1!==b.spacingFactor,v=function(){if(!t)return null;for(var F=ae(),I=0;I<d.length;I++){var K=m(d[I],I),P=F,ba=K.x;K=K.y;P.x1=Math.min(P.x1,ba);P.x2=Math.max(P.x2,ba);P.w=P.x2-P.x1;P.y1=Math.min(P.y1,K);P.y2=Math.max(P.y2,K);P.h=P.y2-
P.y1}return F}();c=tf(function(F,I){I=m(F,I);if(t){var K=Math.abs(b.spacingFactor),P=v.x1+v.w/2,ba=v.y1+v.h/2;I={x:P+(I.x-P)*K,y:ba+(I.y-ba)*K}}return null!=b.transform&&(I=b.transform(F,I)),I},l);if(b.animate){for(l=0;l<d.length;l++){var C=d[l],D=c(C,l);null==b.animateFilter||b.animateFilter(C,l)?(C=C.animation({position:D,duration:b.animationDuration,easing:b.animationEasing}),a.animations.push(C)):C.position(D)}b.fit?(f=f.animation({fit:{boundingBox:h.boundingBoxAt(c),padding:b.padding},duration:b.animationDuration,
easing:b.animationEasing}),a.animations.push(f)):void 0!==b.zoom&&void 0!==b.pan&&(f=f.animation({zoom:b.zoom,pan:b.pan,duration:b.animationDuration,easing:b.animationEasing}),a.animations.push(f));a.animations.forEach(function(F){return F.play()});a.one("layoutready",b.ready);a.emit({type:"layoutready",layout:a});zh.all(a.animations.map(function(F){return F.promise()})).then(function(){a.one("layoutstop",b.stop);a.emit({type:"layoutstop",layout:a})})}else d.positions(c),b.fit&&f.fit(b.eles,b.padding),
null!=b.zoom&&f.zoom(b.zoom),b.pan&&f.pan(b.pan),a.one("layoutready",b.ready),a.emit({type:"layoutready",layout:a}),a.one("layoutstop",b.stop),a.emit({type:"layoutstop",layout:a});return this},layout:function(a){return this.cy().makeLayout(Bc({},a,{eles:this}))}};dj.createLayout=dj.makeLayout=dj.layout;var ce={recalculateRenderedStyle:function(a){var b=this.cy(),c=b.renderer();b=b.styleEnabled();return c&&b&&c.recalculateRenderedStyle(this,a),this},dirtyStyleCache:function(){var a=function(c){return c._private.styleCache=
null};if(this.cy().hasCompoundNodes()){var b=this.spawnSelf().merge(this.descendants()).merge(this.parents());b.merge(b.connectedEdges());b.forEach(a)}else this.forEach(function(c){a(c);c.connectedEdges().forEach(a)});return this},updateStyle:function(a){var b=this._private.cy;if(!b.styleEnabled())return this;if(b.batching())return b._private.batchStyleEles.merge(this),this;var c=b.hasCompoundNodes();b=this;a=!(!a&&void 0!==a);c&&(b=this.spawnSelf().merge(this.descendants()).merge(this.parents()));
c=b;return a?c.emitAndNotify("style"):c.emit("style"),b.forEach(function(d){return d._private.styleDirty=!0}),this},cleanStyle:function(){var a=this.cy();if(a.styleEnabled())for(var b=0;b<this.length;b++){var c=this[b];c._private.styleDirty&&(c._private.styleDirty=!1,a.style().apply(c))}},parsedStyle:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,c=this[0],d=c.cy();if(d.styleEnabled()&&c)return c._private.styleDirty&&(c._private.styleDirty=!1,d.style().apply(c)),c._private.style[a]??
(b?d.style().getDefaultProperty(a):null)},numericStyle:function(a){var b=this[0];if(b.cy().styleEnabled()&&b)return a=b.pstyle(a),void 0!==a.pfValue?a.pfValue:a.value},numericStyleUnits:function(a){var b=this[0];if(b.cy().styleEnabled()&&b)return b.pstyle(a).units},renderedStyle:function(a){var b=this.cy();if(!b.styleEnabled())return this;var c=this[0];if(c)return b.style().getRenderedStyle(c,a)},style:function(a,b){var c=this.cy();if(!c.styleEnabled())return this;c=c.style();if(Zc(a))c.applyBypass(this,
a,!1),this.emitAndNotify("style");else if(rc(a)){if(void 0===b)return(b=this[0])?c.getStylePropertyValue(b,a):void 0;c.applyBypass(this,a,b,!1);this.emitAndNotify("style")}else if(void 0===a)return(a=this[0])?c.getRawStyle(a):void 0;return this},removeStyle:function(a){var b=this.cy();if(!b.styleEnabled())return this;b=b.style();if(void 0===a)for(a=0;a<this.length;a++)b.removeAllBypasses(this[a],!1);else{a=a.split(/\s+/);for(var c=0;c<this.length;c++)b.removeBypasses(this[c],a,!1)}return this.emitAndNotify("style"),
this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var a=this.cy();if(!a.styleEnabled())return 1;var b=a.hasCompoundNodes(),c=this[0];if(c){var d=c._private;a=c.pstyle("opacity").value;if(!b)return a;if(b=d.data.parent?c.parents():null)for(c=0;c<b.length;c++)a*=b[c].pstyle("opacity").value;return a}},transparent:function(){if(!this.cy().styleEnabled())return!1;var a=this[0],b=a.cy().hasCompoundNodes();
if(a)return b?0===a.effectiveOpacity():0===a.pstyle("opacity").value},backgrounding:function(){return this.cy().styleEnabled()?!!this[0]._private.backgrounding:!1}},Ch=W("eleTakesUpSpace",function(a){return"element"===a.pstyle("display").value&&0!==a.width()&&(a.isNode()?0!==a.height():!0)});ce.takesUpSpace=ea("takesUpSpace",za({ok:Ch}));var vq=W("eleInteractive",function(a){return"yes"===a.pstyle("events").value&&"visible"===a.pstyle("visibility").value&&Ch(a)}),wq=W("parentInteractive",function(a){return"visible"===
a.pstyle("visibility").value&&Ch(a)});ce.interactive=ea("interactive",za({ok:vq,parentOk:wq,edgeOkViaNode:Ch}));ce.noninteractive=function(){var a=this[0];if(a)return!a.interactive()};var xq=W("eleVisible",function(a){return"visible"===a.pstyle("visibility").value&&0!==a.pstyle("opacity").pfValue&&Ch(a)});ce.visible=ea("visible",za({ok:xq,edgeOkViaNode:Ch}));ce.hidden=function(){var a=this[0];if(a)return!a.visible()};ce.isBundledBezier=ea("isBundledBezier",function(){return this.cy().styleEnabled()?
!this.removed()&&"bezier"===this.pstyle("curve-style").value&&this.takesUpSpace():!1});ce.bypass=ce.css=ce.style;ce.renderedCss=ce.renderedStyle;ce.removeBypass=ce.removeCss=ce.removeStyle;ce.pstyle=ce.parsedStyle;var Yf={};fb({field:"locked",overrideField:function(a){return a.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});fb({field:"grabbable",overrideField:function(a){return a.cy().autoungrabify()||a.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});fb({field:"selected",ableField:"selectable",
overrideAble:function(a){return a.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});fb({field:"selectable",overrideField:function(a){return a.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});Yf.deselect=Yf.unselect;Yf.grabbed=function(){var a=this[0];if(a)return a._private.grabbed};fb({field:"active",on:"activate",off:"unactivate"});fb({field:"pannable",on:"panify",off:"unpanify"});Yf.inactive=function(){var a=this[0];if(a)return!a._private.active};var je={},Ln=function(a){return function(b){for(var c=
[],d=0;d<this.length;d++){var f=this[d];if(f.isNode()){for(var h=!1,l=f.connectedEdges(),m=0;m<l.length;m++){var t=l[m],v=t.source();t=t.target();if(a.noIncomingEdges&&t===f&&v!==f||a.noOutgoingEdges&&v===f&&t!==f){h=!0;break}}h||c.push(f)}}return this.spawn(c,!0).filter(b)}},Mn=function(a){return function(b){for(var c=[],d=0;d<this.length;d++){var f=this[d];if(f.isNode())for(var h=f.connectedEdges(),l=0;l<h.length;l++){var m=h[l],t=m.source(),v=m.target();a.outgoing&&t===f?(c.push(m),c.push(v)):
a.incoming&&v===f&&(c.push(m),c.push(t))}}return this.spawn(c,!0).filter(b)}},Nn=function(a){return function(b){for(var c=this,d=[],f={};;){c=a.outgoing?c.outgoers():c.incomers();if(0===c.length)break;for(var h=!1,l=0;l<c.length;l++){var m=c[l],t=m.id();f[t]||(f[t]=!0,d.push(m),h=!0)}if(!h)break}return this.spawn(d,!0).filter(b)}};je.clearTraversalCache=function(){for(var a=0;a<this.length;a++)this[a]._private.traversalCache=null};Bc(je,{roots:Ln({noIncomingEdges:!0}),leaves:Ln({noOutgoingEdges:!0}),
outgoers:Je(Mn({outgoing:!0}),"outgoers"),successors:Nn({outgoing:!0}),incomers:Je(Mn({incoming:!0}),"incomers"),predecessors:Nn({})});Bc(je,{neighborhood:Je(function(a){for(var b=[],c=this.nodes(),d=0;d<c.length;d++)for(var f=c[d],h=f.connectedEdges(),l=0;l<h.length;l++){var m=h[l],t=m.source(),v=m.target();t=f===t?v:t;0<t.length&&b.push(t[0]);b.push(m[0])}return this.spawn(b,!0).filter(a)},"neighborhood"),closedNeighborhood:function(a){return this.neighborhood().add(this).filter(a)},openNeighborhood:function(a){return this.neighborhood(a)}});
je.neighbourhood=je.neighborhood;je.closedNeighbourhood=je.closedNeighborhood;je.openNeighbourhood=je.openNeighborhood;Bc(je,{source:Je(function(a){var b=this[0],c;return b&&(c=b._private.source||b.cy().collection()),c&&a?c.filter(a):c},"source"),target:Je(function(a){var b=this[0],c;return b&&(c=b._private.target||b.cy().collection()),c&&a?c.filter(a):c},"target"),sources:Ab({attr:"source"}),targets:Ab({attr:"target"})});Bc(je,{edgesWith:Je(Ib(),"edgesWith"),edgesTo:Je(Ib({thisIsSrc:!0}),"edgesTo")});
Bc(je,{connectedEdges:Je(function(a){for(var b=[],c=0;c<this.length;c++){var d=this[c];if(d.isNode()){d=d._private.edges;for(var f=0;f<d.length;f++)b.push(d[f])}}return this.spawn(b,!0).filter(a)},"connectedEdges"),connectedNodes:Je(function(a){for(var b=[],c=0;c<this.length;c++){var d=this[c];d.isEdge()&&(b.push(d.source()[0]),b.push(d.target()[0]))}return this.spawn(b,!0).filter(a)},"connectedNodes"),parallelEdges:Je(uc(),"parallelEdges"),codirectedEdges:Je(uc({codirected:!0}),"codirectedEdges")});
Bc(je,{components:function(a){var b=this,c=b.cy(),d=c.collection(),f=null==a?b.nodes():a.nodes(),h=[];null!=a&&f.empty()&&(f=a.sources());var l=function(m,t){d.merge(m);f.unmerge(m);t.merge(m)};if(f.empty())return b.spawn();a=function(){var m=c.collection();h.push(m);var t=f[0];l(t,m);b.bfs({directed:!1,roots:t,visit:function(v){return l(v,m)}});m.forEach(function(v){v.connectedEdges().forEach(function(C){b.has(C)&&m.has(C.source())&&m.has(C.target())&&m.merge(C)})})};do a();while(0<f.length);return h},
component:function(){var a=this[0];return a.cy().mutableElements().components(a)[0]}});je.componentsOf=je.components;var be=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!1;if(void 0===a)vd("A collection must have a reference to the core");else{var f=new Pe,h=!1;if(!b)b=[];else if(0<b.length&&Zc(b[0])&&!Kf(b[0])){h=!0;for(var l=[],m=new rf,t=0,v=b.length;t<v;t++){var C=b[t];null==C.data&&(C.data={});var D=C.data;
if(null==D.id)D.id=Ii();else if(a.hasElementWithId(D.id)||m.has(D.id))continue;C=new kg(a,C,!1);l.push(C);m.add(D.id)}b=l}l=this.length=0;for(m=b.length;l<m;l++)t=b[l][0],null!=t&&(v=t._private.data.id,c&&f.has(v)||(c&&f.set(v,{index:this.length,ele:t}),this[this.length]=t,this.length++));this._private={eles:this,cy:a,get map(){return null==this.lazyMap&&this.rebuildMap(),this.lazyMap},set map(F){this.lazyMap=F},rebuildMap:function(){for(var F=this.lazyMap=new Pe,I=this.eles,K=0;K<I.length;K++){var P=
I[K];F.set(P.id(),{index:K,ele:P})}}};c&&(this._private.map=f);h&&!d&&this.restore()}},yd=kg.prototype=be.prototype=Object.create(Array.prototype);yd.instanceString=function(){return"collection"};yd.spawn=function(a,b){return new be(this.cy(),a,b)};yd.spawnSelf=function(){return this.spawn(this)};yd.cy=function(){return this._private.cy};yd.renderer=function(){return this._private.cy.renderer()};yd.element=function(){return this[0]};yd.collection=function(){return Qh(this)?this:new be(this._private.cy,
[this])};yd.unique=function(){return new be(this._private.cy,this,!0)};yd.hasElementWithId=function(a){return a=""+a,this._private.map.has(a)};yd.getElementById=function(a){var b=this._private.cy;return(a=this._private.map.get(""+a))?a.ele:new be(b)};yd.$id=yd.getElementById;yd.poolIndex=function(){return this._private.cy._private.elements._private.map.get(this[0]._private.data.id).index};yd.indexOf=function(a){return this._private.map.get(a[0]._private.data.id).index};yd.indexOfId=function(a){return a=
""+a,this._private.map.get(a).index};yd.json=function(a){var b=this.element(),c=this.cy();if(null==b&&a)return this;if(null!=b){var d=b._private;if(Zc(a)){if(c.startBatch(),a.data){b.data(a.data);var f=d.data;if(b.isEdge()){var h=!1,l={},m=a.data.source,t=a.data.target;null!=m&&m!=f.source&&(l.source=""+m,h=!0);null!=t&&t!=f.target&&(l.target=""+t,h=!0);h&&(b=b.move(l))}else h=a.data.parent,"parent"in a.data&&(null!=h||null!=f.parent)&&h!=f.parent&&(void 0===h&&(h=null),null!=h&&(h=""+h),b=b.move({parent:h}))}a.position&&
b.position(a.position);f=function(D,F,I){var K=a[D];null!=K&&K!==d[D]&&(K?b[F]():b[I]())};return f("removed","remove","restore"),f("selected","select","unselect"),f("selectable","selectify","unselectify"),f("locked","lock","unlock"),f("grabbable","grabify","ungrabify"),f("pannable","panify","unpanify"),null!=a.classes&&b.classes(a.classes),c.endBatch(),this}if(void 0===a){var v={data:Ce(d.data),position:Ce(d.position),group:d.group,removed:d.removed,selected:d.selected,selectable:d.selectable,locked:d.locked,
grabbable:d.grabbable,pannable:d.pannable,classes:""},C=0;return d.classes.forEach(function(D){return v.classes+=0===C++?D:" "+D}),v}}};yd.jsons=function(){for(var a=[],b=0;b<this.length;b++){var c=this[b].json();a.push(c)}return a};yd.clone=function(){for(var a=this.cy(),b=[],c=0;c<this.length;c++){var d=this[c].json();d=new kg(a,d,!1);b.push(d)}return new be(a,b)};yd.copy=yd.clone;yd.restore=function(){for(var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0,b=1<arguments.length&&void 0!==
arguments[1]?arguments[1]:!0,c=this.cy(),d=c._private,f=[],h=[],l,m=0,t=this.length;m<t;m++){var v=this[m];b&&!v.removed()||(v.isNode()?f.push(v):h.push(v))}l=f.concat(h);var C;h=function(){l.splice(C,1);C--};for(C=0;C<l.length;C++){m=l[C];t=m._private;var D=t.data;if(m.clearTraversalCache(),b||t.removed)if(void 0===D.id)D.id=Ii();else if(cc(D.id))D.id=""+D.id;else if(Fe(D.id)||!rc(D.id)){vd("Can not create element with invalid string ID `"+D.id+"`");h();continue}else if(c.hasElementWithId(D.id)){vd("Can not create second element with ID `"+
D.id+"`");h();continue}v=D.id;if(m.isNode()){var F=t.position;null==F.x&&(F.x=0);null==F.y&&(F.y=0)}if(m.isEdge()){F=m;for(var I=["source","target"],K=I.length,P=!1,ba=0;ba<K;ba++){var X=I[ba],Y=D[X];cc(Y)&&(Y=D[X]=""+D[X]);null==Y||""===Y?(vd("Can not create edge `"+v+"` with unspecified "+X),P=!0):c.hasElementWithId(Y)||(vd("Can not create edge `"+v+"` with nonexistant "+X+" `"+Y+"`"),P=!0)}if(P){h();continue}I=c.getElementById(D.source);D=c.getElementById(D.target);I.same(D)?I._private.edges.push(F):
(I._private.edges.push(F),D._private.edges.push(F));F._private.source=I;F._private.target=D}t.map=new Pe;t.map.set(v,{ele:m,index:0});t.removed=!1;b&&c.addToPool(m)}for(h=0;h<f.length;h++)if(m=f[h],t=m._private.data,cc(t.parent)&&(t.parent=""+t.parent),v=t.parent,null!=v||m._private.parent)if(v=m._private.parent?c.collection().merge(m._private.parent):c.getElementById(v),v.empty())t.parent=void 0;else if(v[0].removed())fd("Node added with missing parent, reference to parent removed"),t.parent=void 0,
m._private.parent=null;else{D=!1;for(F=v;!F.empty();){if(m.same(F)){D=!0;t.parent=void 0;break}F=F.parent()}D||(v[0]._private.children.push(m),m._private.parent=v[0],d.hasCompoundNodes=!0)}if(0<l.length){f=l.length===this.length?this:new be(c,l);for(h=0;h<f.length;h++)m=f[h],m.isNode()||(m.parallelEdges().clearTraversalCache(),m.source().clearTraversalCache(),m.target().clearTraversalCache());var ta;d.hasCompoundNodes?ta=c.collection().merge(f).merge(f.connectedNodes()).merge(f.parent()):ta=f;ta.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(a);
a?f.emitAndNotify("add"):b&&f.emit("add")}return this};yd.removed=function(){var a=this[0];return a&&a._private.removed};yd.inside=function(){var a=this[0];return a&&!a._private.removed};yd.remove=function(){function a(K){var P=l[K.id()];if(!(f&&K.removed()||P))if(l[K.id()]=!0,K.isNode()){h.push(K);P=K._private.edges;for(var ba=0;ba<P.length;ba++)a(P[ba]);K=K._private.children;for(P=0;P<K.length;P++)a(K[P])}else h.unshift(K)}function b(K,P){ff(K._private.edges,P);K.clearTraversalCache()}function c(K,
P){P=P[0];K=K[0];var ba=K._private.children,X=K.id();ff(ba,P);P._private.parent=null;C.ids[X]||(C.ids[X]=!0,C.push(K))}for(var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,h=[],l={},m=this._private.cy,t=0,v=this.length;t<v;t++)a(this[t]);var C=[];C.ids={};this.dirtyCompoundBoundsCache();f&&m.removeFromPool(h);for(t=0;t<h.length;t++){v=h[t];if(v.isEdge()){var D=v.source()[0],F=v.target()[0];b(D,v);b(F,v);D=v.parallelEdges();
for(F=0;F<D.length;F++){var I=D[F];I.clearTraversalCache();I.isBundledBezier()&&I.dirtyBoundingBoxCache()}}else D=v.parent(),0!==D.length&&c(D,v);f&&(v._private.removed=!0)}t=m._private.elements;m._private.hasCompoundNodes=!1;for(v=0;v<t.length;v++)if(t[v].isParent()){m._private.hasCompoundNodes=!0;break}m=new be(this.cy(),h);0<m.size()&&(d?m.emitAndNotify("remove"):f&&m.emit("remove"));for(d=0;d<C.length;d++)t=C[d],f&&t.removed()||t.updateStyle();return m};yd.move=function(a){var b=this._private.cy,
c=this,d=function(v){return null==v?v:""+v};if(void 0!==a.source||void 0!==a.target){var f=d(a.source),h=d(a.target),l=null!=f&&b.hasElementWithId(f),m=null!=h&&b.hasElementWithId(h);(l||m)&&(b.batch(function(){c.remove(!1,!1);c.emitAndNotify("moveout");for(var v=0;v<c.length;v++){var C=c[v],D=C._private.data;C.isEdge()&&(l&&(D.source=f),m&&(D.target=h))}c.restore(!1,!1)}),c.emitAndNotify("move"))}else if(void 0!==a.parent&&(a=d(a.parent),null===a||b.hasElementWithId(a))){var t=null===a?void 0:a;
b.batch(function(){var v=c.remove(!1,!1);v.emitAndNotify("moveout");for(var C=0;C<c.length;C++){var D=c[C],F=D._private.data;D.isNode()&&(F.parent=t)}v.restore(!1,!1)});c.emitAndNotify("move")}return this};[kn,kq,Xi,ag,hl,un,Zi,rq,Jn,gd,{isNode:function(){return"nodes"===this.group()},isEdge:function(){return"edges"===this.group()},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var a=
this[0];if(a)return a._private.group}},cj,dj,ce,Yf,je].forEach(function(a){Bc(yd,a)});var yq=function(){function a(c,d,f){var h=c.v+f.dv*d;return{dx:h,dv:-c.tension*(c.x+f.dx*d)-c.friction*h}}function b(c,d){var f={dx:c.v,dv:-c.tension*c.x-c.friction*c.v},h=a(c,.5*d,f),l=a(c,.5*d,h),m=a(c,d,l),t=1/6*(f.dv+2*(h.dv+l.dv)+m.dv);return c.x+=1/6*(f.dx+2*(h.dx+l.dx)+m.dx)*d,c.v+=t*d,c}return function l(d,f,h){var m={x:-1,v:0,tension:null,friction:null},t=[0],v=0,C,D,F;d=parseFloat(d)||500;f=parseFloat(f)||
20;h=h||null;m.tension=d;m.friction=f;for((C=null!==h)?(v=l(d,f),D=v/h*.016):D=.016;F=b(F||m,D),t.push(1+F.x),v+=16,1E-4<Math.abs(F.x)&&1E-4<Math.abs(F.v););return C?function(I){return t[I*(t.length-1)|0]}:v}}(),zd=function(a,b,c,d){var f=xc(a,b,c,d);return function(h,l,m){return h+(l-h)*f(m)}},Ti={linear:function(a,b,c){return a+(b-a)*c},ease:zd(.25,.1,.25,1),"ease-in":zd(.42,0,1,1),"ease-out":zd(0,0,.58,1),"ease-in-out":zd(.42,0,.58,1),"ease-in-sine":zd(.47,0,.745,.715),"ease-out-sine":zd(.39,.575,
.565,1),"ease-in-out-sine":zd(.445,.05,.55,.95),"ease-in-quad":zd(.55,.085,.68,.53),"ease-out-quad":zd(.25,.46,.45,.94),"ease-in-out-quad":zd(.455,.03,.515,.955),"ease-in-cubic":zd(.55,.055,.675,.19),"ease-out-cubic":zd(.215,.61,.355,1),"ease-in-out-cubic":zd(.645,.045,.355,1),"ease-in-quart":zd(.895,.03,.685,.22),"ease-out-quart":zd(.165,.84,.44,1),"ease-in-out-quart":zd(.77,0,.175,1),"ease-in-quint":zd(.755,.05,.855,.06),"ease-out-quint":zd(.23,1,.32,1),"ease-in-out-quint":zd(.86,0,.07,1),"ease-in-expo":zd(.95,
.05,.795,.035),"ease-out-expo":zd(.19,1,.22,1),"ease-in-out-expo":zd(1,0,0,1),"ease-in-circ":zd(.6,.04,.98,.335),"ease-out-circ":zd(.075,.82,.165,1),"ease-in-out-circ":zd(.785,.135,.15,.86),spring:function(a,b,c){if(0===c)return Ti.linear;var d=yq(a,b,c);return function(f,h,l){return f+(h-f)*d(l)}},"cubic-bezier":zd},zq={animate:ld.animate(),animation:ld.animation(),animated:ld.animated(),clearQueue:ld.clearQueue(),delay:ld.delay(),delayAnimation:ld.delayAnimation(),stop:ld.stop(),addToAnimationPool:function(a){this.styleEnabled()&&
this._private.aniEles.merge(a)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){function a(){b._private.animationsRunning&&te(function(d){Ya(d,b);a()})}var b=this;if(b._private.animationsRunning=!0,b.styleEnabled()){var c=b.renderer();c&&c.beforeRender?c.beforeRender(function(d,f){Ya(f,b)},c.beforeRenderPriorities.animations):a()}}},Aq={qualifierCompare:function(a,b){return null==a||null==b?null==a&&null==b:a.sameText(b)},eventMatches:function(a,b,c){b=
b.qualifier;return null!=b?a!==c.target&&Kf(c.target)&&b.matches(c.target):!0},addEventFields:function(a,b){b.cy=a;b.target=a},callbackContext:function(a,b,c){return null!=b.qualifier?c.target:a}},ej=function(a){return rc(a)?new Zf(a):a},On={createEmitter:function(){var a=this._private;return a.emitter||(a.emitter=new A(Aq,this)),this},emitter:function(){return this._private.emitter},on:function(a,b,c){return this.emitter().on(a,ej(b),c),this},removeListener:function(a,b,c){return this.emitter().removeListener(a,
ej(b),c),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(a,b,c){return this.emitter().one(a,ej(b),c),this},once:function(a,b,c){return this.emitter().one(a,ej(b),c),this},emit:function(a,b){return this.emitter().emit(a,b),this},emitAndNotify:function(a,b){return this.emit(a),this.notify(a,b),this}};ld.eventAliasesOn(On);var jl={png:function(a){var b=this._private.renderer;return a=a||{},b.png(a)},jpg:function(a){var b=this._private.renderer;return a=
a||{},a.bg=a.bg||"#fff",b.jpg(a)}};jl.jpeg=jl.jpg;var fj={layout:function(a){if(null==a)vd("Layout options must be specified to make a layout");else if(null==a.name)vd("A `name` must be specified to make a layout");else{var b=a.name,c=this.extension("layout",b);if(null==c)vd("No such layout `"+b+"` found.  Did you forget to import it and `cytoscape.use()` it?");else{var d;rc(a.eles)?d=this.$(a.eles):d=null!=a.eles?a.eles:this.$();return new c(Bc({},a,{cy:this,eles:d}))}}}};fj.createLayout=fj.makeLayout=
fj.layout;var Bq=Id({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),kl={renderTo:function(a,b,c,d){return this._private.renderer.renderTo(a,b,c,d),this},renderer:function(){return this._private.renderer},
forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(a){var b=this.extension("renderer",a.name);null==b?vd("Can not initialise: No such renderer `".concat(a.name,"` found. Did you forget to import it and `cytoscape.use()` it?")):(void 0!==a.wheelSensitivity&&fd("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine."),
a=Bq(a),a.cy=this,this._private.renderer=new b(a),this.notify("init"))},destroyRenderer:function(){this.notify("destroy");var a=this.container();if(a)for(a._cyreg=null;0<a.childNodes.length;)a.removeChild(a.childNodes[0]);this._private.renderer=null;this.mutableElements().forEach(function(b){b=b._private;b.rscratch={};b.rstyle={};b.animation.current=[];b.animation.queue=[]})},onRender:function(a){return this.on("render",a)},offRender:function(a){return this.off("render",a)}};kl.invalidateDimensions=
kl.resize;var gj={collection:function(a,b){return rc(a)?this.$(a):$d(a)?a.collection():kd(a)?(b||={},new be(this,a,b.unique,b.removed)):new be(this)},nodes:function(a){var b=this.$(function(c){return c.isNode()});return a?b.filter(a):b},edges:function(a){var b=this.$(function(c){return c.isEdge()});return a?b.filter(a):b},$:function(a){var b=this._private.elements;return a?b.filter(a):b.spawnSelf()},mutableElements:function(){return this._private.elements}};gj.elements=gj.filter=gj.$;var ll={getRenderedStyle:function(a,
b){return b?this.getStylePropertyValue(a,b,!0):this.getRawStyle(a,!0)},getRawStyle:function(a,b){if(a=a[0],a){for(var c={},d=0;d<this.properties.length;d++){var f=this.properties[d],h=this.getStylePropertyValue(a,f.name,b);null!=h&&(c[f.name]=h,c[tg(f.name)]=h)}return c}},getIndexedStyle:function(a,b,c,d){return a.pstyle(b)[c][d]??a.cy().style().getDefaultProperty(b)[c][0]},getStylePropertyValue:function(a,b,c){if(a=a[0],a){var d=this.properties[b];d.alias&&(d=d.pointsTo);b=d.type;var f=a.pstyle(d.name);
if(f){d=f.value;var h=f.units;f=f.strValue;if(c&&b.number&&null!=d&&cc(d)){var l=a.cy().zoom();return((a=kd(d))?h.every(function(m){return null!=m}):null!=h)?a?d.map(function(m,t){return m*l+h[t]}).join(" "):d*l+h:a?d.map(function(m){return rc(m)?m:""+m*l}).join(" "):""+d*l}if(null!=f)return f}return null}},getAnimationStartStyle:function(a,b){for(var c={},d=0;d<b.length;d++){var f=b[d].name,h=a.pstyle(f);void 0!==h&&(Zc(h)?h=this.parse(f,h.strValue):h=this.parse(f,h));h&&(c[f]=h)}return c},getPropsList:function(a){var b=
[],c=this.properties;if(a)for(var d=Object.keys(a),f=0;f<d.length;f++){var h=d[f],l=a[h];h=c[h]||c[hh(h)];(l=this.parse(h.name,l))&&b.push(l)}return b},getNonDefaultPropertiesHash:function(a,b,c){c=c.slice();var d,f,h,l;for(h=0;h<b.length;h++)if(d=b[h],f=a.pstyle(d,!1),null!=f)if(null!=f.pfValue)c[0]=Rd(t,c[0]),c[1]=xf(t,c[1]);else{var m=f.strValue;for(l=0;l<m.length;l++){var t=m.charCodeAt(l);c[0]=Rd(t,c[0]);c[1]=xf(t,c[1])}}return c}};ll.getPropertiesHash=ll.getNonDefaultPropertiesHash;var Md={};
(function(){var a=function(Wb){return"^"+Wb+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},b=function(Wb){return"^"+Wb+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*\\,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))|\\w+|rgb[a]?\\((?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)(?:\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)|hsl[a]?\\((?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])(?:\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)|\\#[0-9a-fA-F]{3}|\\#[0-9a-fA-F]{6})\\s*\\,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))|\\w+|rgb[a]?\\((?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)(?:\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)|hsl[a]?\\((?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])(?:\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)|\\#[0-9a-fA-F]{3}|\\#[0-9a-fA-F]{6})\\)$"},
c=["^url\\s*\\(\\s*['\"]?(.+?)['\"]?\\s*\\)$","^(none)$","^(.+)$"];Md.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,
min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:"horizontal leftward rightward vertical upward downward auto".split(" ")},
axisDirectionExplicit:{enums:["leftward","rightward","upward","downward"]},axisDirectionPrimary:{enums:["horizontal","vertical"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous",
"use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid",
"dotted","dashed","double"]},curveStyle:{enums:"bezier unbundled-bezier haystack segments straight straight-triangle taxi round-segments round-taxi".split(" ")},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none",
"underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:"rectangle roundrectangle round-rectangle cutrectangle cut-rectangle bottomroundrectangle bottom-round-rectangle barrel ellipse triangle round-triangle square pentagon round-pentagon hexagon round-hexagon concavehexagon concave-hexagon heptagon round-heptagon octagon round-octagon tag round-tag star diamond round-diamond vee rhomboid right-rhomboid polygon".split(" ")},
overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:"tee triangle triangle-tee circle-triangle triangle-cross triangle-backcurve vee square circle diamond chevron none".split(" ")},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden",
"visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:a("data")},layoutData:{mapping:!0,regex:a("layoutData")},scratch:{mapping:!0,regex:a("scratch")},mapData:{mapping:!0,regex:b("mapData")},mapLayoutData:{mapping:!0,regex:b("mapLayoutData")},mapScratch:{mapping:!0,regex:b("mapScratch")},
fn:{mapping:!0,fn:!0},url:{regexes:c,singleRegexMatchValue:!0},urls:{regexes:c,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",
enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(Wb,Yb){switch(Wb.length){case 2:return"deg"!==Yb[0]&&"rad"!==Yb[0]&&"deg"!==Yb[1]&&"rad"!==Yb[1];case 1:return rc(Wb[0])||"deg"===Yb[0]||"rad"===Yb[0];default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*\\)$"],
enums:"linear ease ease-in ease-out ease-in-out ease-in-sine ease-out-sine ease-in-out-sine ease-in-quad ease-out-quad ease-in-out-quad ease-in-cubic ease-out-cubic ease-in-out-cubic ease-in-quart ease-out-quart ease-in-out-quart ease-in-quint ease-out-quint ease-in-out-quint ease-in-expo ease-out-expo ease-in-out-expo ease-in-circ ease-out-circ ease-in-out-circ".split(" ")},gradientDirection:{enums:"to-bottom to-top to-left to-right to-bottom-right to-bottom-left to-top-right to-top-left to-right-bottom to-left-bottom to-right-top to-left-top".split(" ")},
boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(Wb){Wb=Wb.length;return 1===Wb||2===Wb||4===Wb}}};var d=function(Wb,Yb){return(null==Wb||null==Yb)&&Wb!==Yb||0==Wb&&0!=Yb?!0:0!=Wb&&0==Yb},f=function(Wb,Yb){return Wb!=Yb},h=Md.types;a=[{name:"label",type:h.text,triggersBounds:f,triggersZOrder:function(Wb,Yb){Wb=Fe(Wb);Yb=Fe(Yb);return Wb&&!Yb||!Wb&&Yb}},{name:"text-rotation",type:h.textRotation,triggersBounds:f},{name:"text-margin-x",type:h.bidirectionalSize,triggersBounds:f},{name:"text-margin-y",
type:h.bidirectionalSize,triggersBounds:f}];b=[{name:"source-label",type:h.text,triggersBounds:f},{name:"source-text-rotation",type:h.textRotation,triggersBounds:f},{name:"source-text-margin-x",type:h.bidirectionalSize,triggersBounds:f},{name:"source-text-margin-y",type:h.bidirectionalSize,triggersBounds:f},{name:"source-text-offset",type:h.size,triggersBounds:f}];c=[{name:"target-label",type:h.text,triggersBounds:f},{name:"target-text-rotation",type:h.textRotation,triggersBounds:f},{name:"target-text-margin-x",
type:h.bidirectionalSize,triggersBounds:f},{name:"target-text-margin-y",type:h.bidirectionalSize,triggersBounds:f},{name:"target-text-offset",type:h.size,triggersBounds:f}];var l=[{name:"font-family",type:h.fontFamily,triggersBounds:f},{name:"font-style",type:h.fontStyle,triggersBounds:f},{name:"font-weight",type:h.fontWeight,triggersBounds:f},{name:"font-size",type:h.size,triggersBounds:f},{name:"text-transform",type:h.textTransform,triggersBounds:f},{name:"text-wrap",type:h.textWrap,triggersBounds:f},
{name:"text-overflow-wrap",type:h.textOverflowWrap,triggersBounds:f},{name:"text-max-width",type:h.size,triggersBounds:f},{name:"text-outline-width",type:h.size,triggersBounds:f},{name:"line-height",type:h.positiveNumber,triggersBounds:f}],m=[{name:"text-valign",type:h.valign,triggersBounds:f},{name:"text-halign",type:h.halign,triggersBounds:f},{name:"color",type:h.color},{name:"text-outline-color",type:h.color},{name:"text-outline-opacity",type:h.zeroOneNumber},{name:"text-background-color",type:h.color},
{name:"text-background-opacity",type:h.zeroOneNumber},{name:"text-background-padding",type:h.size,triggersBounds:f},{name:"text-border-opacity",type:h.zeroOneNumber},{name:"text-border-color",type:h.color},{name:"text-border-width",type:h.size,triggersBounds:f},{name:"text-border-style",type:h.borderStyle,triggersBounds:f},{name:"text-background-shape",type:h.textBackgroundShape,triggersBounds:f},{name:"text-justification",type:h.justification},{name:"box-select-labels",type:h.bool,triggersBounds:f}],
t=[{name:"events",type:h.bool,triggersZOrder:f},{name:"text-events",type:h.bool,triggersZOrder:f}],v=[{name:"display",type:h.display,triggersZOrder:f,triggersBounds:f,triggersBoundsOfConnectedEdges:f,triggersBoundsOfParallelEdges:function(Wb,Yb,ub){return Wb===Yb?!1:"bezier"===ub.pstyle("curve-style").value}},{name:"visibility",type:h.visibility,triggersZOrder:f},{name:"opacity",type:h.zeroOneNumber,triggersZOrder:d},{name:"text-opacity",type:h.zeroOneNumber},{name:"min-zoomed-font-size",type:h.size},
{name:"z-compound-depth",type:h.zCompoundDepth,triggersZOrder:f},{name:"z-index-compare",type:h.zIndexCompare,triggersZOrder:f},{name:"z-index",type:h.number,triggersZOrder:f}],C=[{name:"overlay-padding",type:h.size,triggersBounds:f},{name:"overlay-color",type:h.color},{name:"overlay-opacity",type:h.zeroOneNumber,triggersBounds:d},{name:"overlay-shape",type:h.overlayShape,triggersBounds:f},{name:"overlay-corner-radius",type:h.cornerRadius}];d=[{name:"underlay-padding",type:h.size,triggersBounds:f},
{name:"underlay-color",type:h.color},{name:"underlay-opacity",type:h.zeroOneNumber,triggersBounds:d},{name:"underlay-shape",type:h.overlayShape,triggersBounds:f},{name:"underlay-corner-radius",type:h.cornerRadius}];var D=[{name:"transition-property",type:h.propList},{name:"transition-duration",type:h.time},{name:"transition-delay",type:h.time},{name:"transition-timing-function",type:h.easing}],F=function(Wb,Yb){return"label"===Yb.value?-Wb.poolIndex():Yb.pfValue};F=[{name:"height",type:h.nodeSize,
triggersBounds:f,hashOverride:F},{name:"width",type:h.nodeSize,triggersBounds:f,hashOverride:F},{name:"shape",type:h.nodeShape,triggersBounds:f},{name:"shape-polygon-points",type:h.polygonPointList,triggersBounds:f},{name:"corner-radius",type:h.cornerRadius},{name:"background-color",type:h.color},{name:"background-fill",type:h.fill},{name:"background-opacity",type:h.zeroOneNumber},{name:"background-blacken",type:h.nOneOneNumber},{name:"background-gradient-stop-colors",type:h.colors},{name:"background-gradient-stop-positions",
type:h.percentages},{name:"background-gradient-direction",type:h.gradientDirection},{name:"padding",type:h.sizeMaybePercent,triggersBounds:f},{name:"padding-relative-to",type:h.paddingRelativeTo,triggersBounds:f},{name:"bounds-expansion",type:h.boundsExpansion,triggersBounds:f}];var I=[{name:"border-color",type:h.color},{name:"border-opacity",type:h.zeroOneNumber},{name:"border-width",type:h.size,triggersBounds:f},{name:"border-style",type:h.borderStyle},{name:"border-cap",type:h.lineCap},{name:"border-join",
type:h.lineJoin},{name:"border-dash-pattern",type:h.numbers},{name:"border-dash-offset",type:h.number},{name:"border-position",type:h.linePosition}],K=[{name:"outline-color",type:h.color},{name:"outline-opacity",type:h.zeroOneNumber},{name:"outline-width",type:h.size,triggersBounds:f},{name:"outline-style",type:h.borderStyle},{name:"outline-offset",type:h.size,triggersBounds:f}],P=[{name:"background-image",type:h.urls},{name:"background-image-crossorigin",type:h.bgCrossOrigin},{name:"background-image-opacity",
type:h.zeroOneNumbers},{name:"background-image-containment",type:h.bgContainment},{name:"background-image-smoothing",type:h.bools},{name:"background-position-x",type:h.bgPos},{name:"background-position-y",type:h.bgPos},{name:"background-width-relative-to",type:h.bgRelativeTo},{name:"background-height-relative-to",type:h.bgRelativeTo},{name:"background-repeat",type:h.bgRepeat},{name:"background-fit",type:h.bgFit},{name:"background-clip",type:h.bgClip},{name:"background-width",type:h.bgWH},{name:"background-height",
type:h.bgWH},{name:"background-offset-x",type:h.bgPos},{name:"background-offset-y",type:h.bgPos}],ba=[{name:"position",type:h.position,triggersBounds:f},{name:"compound-sizing-wrt-labels",type:h.compoundIncludeLabels,triggersBounds:f},{name:"min-width",type:h.size,triggersBounds:f},{name:"min-width-bias-left",type:h.sizeMaybePercent,triggersBounds:f},{name:"min-width-bias-right",type:h.sizeMaybePercent,triggersBounds:f},{name:"min-height",type:h.size,triggersBounds:f},{name:"min-height-bias-top",
type:h.sizeMaybePercent,triggersBounds:f},{name:"min-height-bias-bottom",type:h.sizeMaybePercent,triggersBounds:f}],X=[{name:"line-style",type:h.lineStyle},{name:"line-color",type:h.color},{name:"line-fill",type:h.fill},{name:"line-cap",type:h.lineCap},{name:"line-opacity",type:h.zeroOneNumber},{name:"line-dash-pattern",type:h.numbers},{name:"line-dash-offset",type:h.number},{name:"line-outline-width",type:h.size},{name:"line-outline-color",type:h.color},{name:"line-gradient-stop-colors",type:h.colors},
{name:"line-gradient-stop-positions",type:h.percentages},{name:"curve-style",type:h.curveStyle,triggersBounds:f,triggersBoundsOfParallelEdges:function(Wb,Yb){return Wb===Yb?!1:"bezier"===Wb||"bezier"===Yb}},{name:"haystack-radius",type:h.zeroOneNumber,triggersBounds:f},{name:"source-endpoint",type:h.edgeEndpoint,triggersBounds:f},{name:"target-endpoint",type:h.edgeEndpoint,triggersBounds:f},{name:"control-point-step-size",type:h.size,triggersBounds:f},{name:"control-point-distances",type:h.bidirectionalSizes,
triggersBounds:f},{name:"control-point-weights",type:h.numbers,triggersBounds:f},{name:"segment-distances",type:h.bidirectionalSizes,triggersBounds:f},{name:"segment-weights",type:h.numbers,triggersBounds:f},{name:"segment-radii",type:h.numbers,triggersBounds:f},{name:"radius-type",type:h.radiusType,triggersBounds:f},{name:"taxi-turn",type:h.bidirectionalSizeMaybePercent,triggersBounds:f},{name:"taxi-turn-min-distance",type:h.size,triggersBounds:f},{name:"taxi-direction",type:h.axisDirection,triggersBounds:f},
{name:"taxi-radius",type:h.number,triggersBounds:f},{name:"edge-distances",type:h.edgeDistances,triggersBounds:f},{name:"arrow-scale",type:h.positiveNumber,triggersBounds:f},{name:"loop-direction",type:h.angle,triggersBounds:f},{name:"loop-sweep",type:h.angle,triggersBounds:f},{name:"source-distance-from-node",type:h.size,triggersBounds:f},{name:"target-distance-from-node",type:h.size,triggersBounds:f}],Y=[{name:"ghost",type:h.bool,triggersBounds:f},{name:"ghost-offset-x",type:h.bidirectionalSize,
triggersBounds:f},{name:"ghost-offset-y",type:h.bidirectionalSize,triggersBounds:f},{name:"ghost-opacity",type:h.zeroOneNumber}],ta=[{name:"selection-box-color",type:h.color},{name:"selection-box-opacity",type:h.zeroOneNumber},{name:"selection-box-border-color",type:h.color},{name:"selection-box-border-width",type:h.size},{name:"active-bg-color",type:h.color},{name:"active-bg-opacity",type:h.zeroOneNumber},{name:"active-bg-size",type:h.size},{name:"outside-texture-bg-color",type:h.color},{name:"outside-texture-bg-opacity",
type:h.zeroOneNumber}],ja=[];Md.pieBackgroundN=16;ja.push({name:"pie-size",type:h.sizeMaybePercent});ja.push({name:"pie-hole",type:h.sizeMaybePercent});ja.push({name:"pie-start-angle",type:h.angle});for(var Ba=1;Ba<=Md.pieBackgroundN;Ba++)ja.push({name:"pie-"+Ba+"-background-color",type:h.color}),ja.push({name:"pie-"+Ba+"-background-size",type:h.percent}),ja.push({name:"pie-"+Ba+"-background-opacity",type:h.zeroOneNumber});Ba=[];Md.stripeBackgroundN=16;Ba.push({name:"stripe-size",type:h.sizeMaybePercent});
Ba.push({name:"stripe-direction",type:h.axisDirectionPrimary});for(var Ua=1;Ua<=Md.stripeBackgroundN;Ua++)Ba.push({name:"stripe-"+Ua+"-background-color",type:h.color}),Ba.push({name:"stripe-"+Ua+"-background-size",type:h.percent}),Ba.push({name:"stripe-"+Ua+"-background-opacity",type:h.zeroOneNumber});var ab=[],Qb=Md.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:h.arrowShape,triggersBounds:f},{name:"arrow-color",type:h.color},{name:"arrow-fill",type:h.arrowFill},
{name:"arrow-width",type:h.arrowWidth}].forEach(function(Wb){Qb.forEach(function(Yb){ab.push({name:Yb+"-"+Wb.name,type:Wb.type,triggersBounds:Wb.triggersBounds})})},{});f=Md.properties=[].concat(t,D,v,C,d,Y,m,l,a,b,c,F,I,K,P,ja,Ba,ba,X,ab,ta);var Mb=Md.propertyGroups={behavior:t,transition:D,visibility:v,overlay:C,underlay:d,ghost:Y,commonLabel:m,labelDimensions:l,mainLabel:a,sourceLabel:b,targetLabel:c,nodeBody:F,nodeBorder:I,nodeOutline:K,backgroundImage:P,pie:ja,stripe:Ba,compound:ba,edgeLine:X,
edgeArrow:ab,core:ta},Ub=Md.propertyGroupNames={};(Md.propertyGroupKeys=Object.keys(Mb)).forEach(function(Wb){Ub[Wb]=Mb[Wb].map(function(Yb){return Yb.name});Mb[Wb].forEach(function(Yb){return Yb.groupKey=Wb})});a=Md.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",
pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];Md.propertyNames=f.map(function(Wb){return Wb.name});for(b=0;b<f.length;b++)c=f[b],f[c.name]=c;for(b=0;b<a.length;b++)c=a[b],l={name:c.name,alias:!0,pointsTo:f[c.pointsTo]},f.push(l),f[c.name]=l})();Md.getDefaultProperty=function(a){return this.getDefaultProperties()[a]};
Md.getDefaultProperties=function(){var a=this._private;if(null!=a.defaultProperties)return a.defaultProperties;for(var b=Bc({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,
color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif",
"font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,
"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","box-select-labels":"no","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none",
"background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000",
"border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999",
"background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%","pie-hole":0,"pie-start-angle":"0deg"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",
value:1}].reduce(function(l,m){for(var t=1;t<=Md.pieBackgroundN;t++){var v=m.name.replace("{{i}}",t);l[v]=m.value}return l},{}),{"stripe-size":"100%","stripe-direction":"horizontal"},[{name:"stripe-{{i}}-background-color",value:"black"},{name:"stripe-{{i}}-background-size",value:"0%"},{name:"stripe-{{i}}-background-opacity",value:1}].reduce(function(l,m){for(var t=1;t<=Md.stripeBackgroundN;t++){var v=m.name.replace("{{i}}",t);l[v]=m.value}return l},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid",
"line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg",
"loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(l,m){return Md.arrowPrefixes.forEach(function(t){l[t+"-"+m.name]=m.value}),l},{})),c={},d=0;d<this.properties.length;d++){var f=this.properties[d];if(!f.pointsTo){f=
f.name;var h=this.parse(f,b[f]);c[f]=h}}return a.defaultProperties=c,a.defaultProperties};Md.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9",
"line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25});this.defaultLength=this.length};var Wd=function(a){if(!(this instanceof Wd))return new Wd(a);"core"!==$e(a)?vd("A style must have a core reference"):(this._private=
{cy:a,coreStyle:{}},this.length=0,this.resetToDefault())},ke=Wd.prototype;ke.instanceString=function(){return"style"};ke.clear=function(){for(var a=this._private,b=a.cy.elements(),c=0;c<this.length;c++)this[c]=void 0;return this.length=0,a.contextStyles={},a.propDiffs={},this.cleanElements(b,!0),b.forEach(function(d){d=d[0]._private;d.styleDirty=!0;d.appliedInitStyle=!1}),this};ke.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};ke.core=function(a){return this._private.coreStyle[a]||
this.getDefaultProperty(a)};ke.selector=function(a){a="core"===a?null:new Zf(a);var b=this.length++;return this[b]={selector:a,properties:[],mappedProperties:[],index:b},this};ke.css=function(){var a=arguments;if(1===a.length){a=a[0];for(var b=0;b<this.properties.length;b++){var c=this.properties[b],d=a[c.name];void 0===d&&(d=a[tg(c.name)]);void 0!==d&&this.cssRule(c.name,d)}}else 2===a.length&&this.cssRule(a[0],a[1]);return this};ke.style=ke.css;ke.cssRule=function(a,b){if(a=this.parse(a,b))b=this.length-
1,this[b].properties.push(a),this[b].properties[a.name]=a,a.name.match(/pie-(\d+)-background-size/)&&a.value&&(this._private.hasPie=!0),a.name.match(/stripe-(\d+)-background-size/)&&a.value&&(this._private.hasStripe=!0),a.mapped&&this[b].mappedProperties.push(a),!this[b].selector&&(this._private.coreStyle[a.name]=a);return this};ke.append=function(a){return"stylesheet"===$e(a)?a.appendToStyle(this):kd(a)?this.appendFromJson(a):rc(a)&&this.appendFromString(a),this};Wd.fromJson=function(a,b){a=new Wd(a);
return a.fromJson(b),a};Wd.fromString=function(a,b){return(new Wd(a)).fromString(b)};[{apply:function(a){for(var b=this._private.cy.collection(),c=0;c<a.length;c++){var d=a[c],f=this.getContextMeta(d);if(!f.empty){var h=this.getContextStyle(f);f=this.applyContextStyle(f,h,d);d._private.appliedInitStyle?this.updateTransitions(d,f.diffProps):d._private.appliedInitStyle=!0;this.updateStyleHints(d)&&b.push(d)}}return b},getPropertiesDiff:function(a,b){var c=this._private.propDiffs=this._private.propDiffs||
{},d=a+"-"+b,f=c[d];if(f)return f;f=[];for(var h={},l=0;l<this.length;l++){var m=this[l],t="t"===b[l],v="t"===a[l]!==t,C=0<m.mappedProperties.length;if(v||t&&C)for(t=void 0,v&&C||v?t=m.properties:C&&(t=m.mappedProperties),m=0;m<t.length;m++){v=t[m];C=v.name;for(var D=!1,F=l+1;F<this.length;F++){var I=this[F];if("t"===b[F]&&(D=null!=I.properties[v.name],D))break}h[C]||D||(h[C]=!0,f.push(C))}}return c[d]=f,f},getContextMeta:function(a){for(var b="",c,d=a._private.styleCxtKey||"",f=0;f<this.length;f++){var h=
this[f];h.selector&&h.selector.matches(a)?b+="t":b+="f"}return c=this.getPropertiesDiff(d,b),a._private.styleCxtKey=b,{key:b,diffPropNames:c,empty:0===c.length}},getContextStyle:function(a){a=a.key;var b=this._private.contextStyles=this._private.contextStyles||{};if(b[a])return b[a];for(var c={_private:{key:a}},d=0;d<this.length;d++){var f=this[d];if("t"===a[d])for(var h=0;h<f.properties.length;h++){var l=f.properties[h];c[l.name]=l}}return b[a]=c,c},applyContextStyle:function(a,b,c){a=a.diffPropNames;
for(var d={},f=this.types,h=0;h<a.length;h++){var l=a[h],m=b[l],t=c.pstyle(l);if(!m)if(t)t.bypass?m={name:l,deleteBypassed:!0}:m={name:l,delete:!0};else continue;if(t!==m){if(m.mapped===f.fn&&null!=t&&null!=t.mapping&&t.mapping.value===m.value){var v=t.mapping;if((v.fnValue=m.value(c))===v.prevFnValue)continue}t=d[l]={prev:t};this.applyParsedProperty(c,m);t.next=c.pstyle(l);t.next&&t.next.bypass&&(t.next=t.next.bypassed)}}return{diffProps:d}},updateStyleHints:function(a){var b=a._private,c=this,d=
c.propertyGroupNames,f=c.propertyGroupKeys,h=function(ja,Ba,Ua){return c.getPropertiesHash(ja,Ba,Ua)},l=b.styleKey;if(a.removed())return!1;var m="nodes"===b.group,t=a._private.style;d=Object.keys(t);for(var v=0;v<f.length;v++)b.styleKeys[f[v]]=[9261,5381];v=function(ja,Ba){b.styleKeys[Ba][0]=Rd(ja,b.styleKeys[Ba][0]);b.styleKeys[Ba][1]=xf(ja,b.styleKeys[Ba][1])};for(var C=function(ja,Ba){for(var Ua=0;Ua<ja.length;Ua++){var ab=ja.charCodeAt(Ua);b.styleKeys[Ba][0]=Rd(ab,b.styleKeys[Ba][0]);b.styleKeys[Ba][1]=
xf(ab,b.styleKeys[Ba][1])}},D=0;D<d.length;D++){var F=d[D],I=t[F];if(null!=I){var K=this.properties[F],P=K.type;F=K.groupKey;var ba=void 0;null!=K.hashOverride?ba=K.hashOverride(a,I):null!=I.pfValue&&(ba=I.pfValue);var X=null==K.enums?I.value:null;K=null!=ba;var Y=null!=X,ta=K||Y;Y=I.units;P.number&&ta&&!P.multiple?(I=K?ba:X,v(-128<I&&128>I&&Math.floor(I)!==I?2E9-(1024*I|0):I,F),!K&&null!=Y&&C(Y,F)):C(I.strValue,F)}}d=[9261,5381];for(t=0;t<f.length;t++)v=b.styleKeys[f[t]],d[0]=Rd(v[0],d[0]),d[1]=
xf(v[1],d[1]);b.styleKey=2097152*d[0]+d[1];f=b.styleKeys;b.labelDimsKey=Qd(f.labelDimensions);d=h(a,["label"],f.labelDimensions);(b.labelKey=Qd(d),b.labelStyleKey=Qd(Oe(f.commonLabel,d)),m)||(d=h(a,["source-label"],f.labelDimensions),b.sourceLabelKey=Qd(d),b.sourceLabelStyleKey=Qd(Oe(f.commonLabel,d)),a=h(a,["target-label"],f.labelDimensions),b.targetLabelKey=Qd(a),b.targetLabelStyleKey=Qd(Oe(f.commonLabel,a)));m&&(h=b.styleKeys,m=h.pie,a=h.stripe,h=[h.nodeBody,h.nodeBorder,h.nodeOutline,h.backgroundImage,
h.compound,m,a].filter(function(ja){return null!=ja}).reduce(Oe,[9261,5381]),b.nodeKey=Qd(h),b.hasPie=null!=m&&9261!==m[0]&&5381!==m[1],b.hasStripe=null!=a&&9261!==a[0]&&5381!==a[1]);return l!==b.styleKey},clearStyleHints:function(a){a=a._private;a.styleCxtKey="";a.styleKeys={};a.styleKey=null;a.labelKey=null;a.labelStyleKey=null;a.sourceLabelKey=null;a.sourceLabelStyleKey=null;a.targetLabelKey=null;a.targetLabelStyleKey=null;a.nodeKey=null;a.hasPie=null;a.hasStripe=null},applyParsedProperty:function(a,
b){var c=this,d=b,f=a._private.style,h=c.types,l=c.properties[d.name].type,m=d.bypass,t=f[d.name],v=t&&t.bypass,C=a._private,D=function(){c.checkTriggers(a,d.name,null==t?null:null!=t.pfValue?t.pfValue:t.value,null==d?null:null!=d.pfValue?d.pfValue:d.value)};if("curve-style"===b.name&&a.isEdge()&&("bezier"!==b.value&&a.isLoop()||"haystack"===b.value&&(a.source().isParent()||a.target().isParent()))&&(d=b=this.parse(b.name,"bezier",m)),d.delete)return f[d.name]=void 0,D(),!0;if(d.deleteBypassed)return t?
t.bypass?(t.bypassed=void 0,D(),!0):!1:(D(),!0);if(d.deleteBypass)return t?t.bypass?(f[d.name]=t.bypassed,D(),!0):!1:(D(),!0);b=function(){fd("Do not assign mappings to elements without corresponding data (i.e. ele `"+a.id()+"` has no mapping for property `"+d.name+"` with data field `"+d.field+"`); try a `["+d.field+"]` selector to limit scope to elements with `"+d.field+"` defined")};switch(d.mapped){case h.mapData:var F=d.field.split(".");C=C.data;for(h=0;h<F.length&&C;h++)C=C[F[h]];if(null==C)return b(),
!1;var I;if(cc(C))F=d.fieldMax-d.fieldMin,0===F?I=0:I=(C-d.fieldMin)/F;else return fd("Do not use continuous mappers without specifying numeric data (i.e. `"+d.field+": "+C+"` for `"+a.id()+"` is non-numeric)"),!1;if(0>I?I=0:1<I&&(I=1),l.color)F=d.valueMin[0],l=d.valueMin[1],C=d.valueMin[2],h=null==d.valueMin[3]?1:d.valueMin[3],I=[Math.round(F+(d.valueMax[0]-F)*I),Math.round(l+(d.valueMax[1]-l)*I),Math.round(C+(d.valueMax[2]-C)*I),Math.round(h+((null==d.valueMax[3]?1:d.valueMax[3])-h)*I)],F={bypass:d.bypass,
name:d.name,value:I,strValue:"rgb("+I[0]+", "+I[1]+", "+I[2]+")"};else if(l.number)F=this.parse(d.name,d.valueMin+(d.valueMax-d.valueMin)*I,d.bypass,"mapping");else return!1;if(!F)return b(),!1;F.mapping=d;d=F;break;case h.data:I=d.field.split(".");l=C.data;for(C=0;C<I.length&&l;C++)l=l[I[C]];if(null!=l&&(F=this.parse(d.name,l,d.bypass,"mapping")),!F)return b(),!1;F.mapping=d;d=F;break;case h.fn:b=d.value;b=null!=d.fnValue?d.fnValue:b(a);if(d.prevFnValue=b,null==b)return fd("Custom function mappers may not return null (i.e. `"+
d.name+"` for ele `"+a.id()+"` is null)"),!1;if(F=this.parse(d.name,b,d.bypass,"mapping"),!F)return fd("Custom function mappers may not return invalid values for the property type (i.e. `"+d.name+"` for ele `"+a.id()+"` is invalid)"),!1;F.mapping=Ce(d);d=F;break;case void 0:break;default:return!1}return m?(v?d.bypassed=t.bypassed:d.bypassed=t,f[d.name]=d):v?t.bypassed=d:f[d.name]=d,D(),!0},cleanElements:function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(this.clearStyleHints(d),d.dirtyCompoundBoundsCache(),
d.dirtyBoundingBoxCache(),b){d=d._private.style;for(var f=Object.keys(d),h=0;h<f.length;h++){var l=f[h],m=d[l];null!=m&&(m.bypass?m.bypassed=null:d[l]=null)}}else d._private.style={}}},update:function(){this._private.cy.mutableElements().updateStyle()},updateTransitions:function(a,b){var c=this,d=a._private,f=a.pstyle("transition-property").value,h=a.pstyle("transition-duration").pfValue,l=a.pstyle("transition-delay").pfValue;if(0<f.length&&0<h){for(var m={},t=!1,v=0;v<f.length;v++){var C=f[v],D=
a.pstyle(C),F=b[C];if(F){var I=F.prev;D=null!=F.next?F.next:D;F=!1;var K=void 0;I&&(cc(I.pfValue)&&cc(D.pfValue)?(F=D.pfValue-I.pfValue,K=I.pfValue+1E-6*F):cc(I.value)&&cc(D.value)?(F=D.value-I.value,K=I.value+1E-6*F):kd(I.value)&&kd(D.value)&&(F=I.value[0]!==D.value[0]||I.value[1]!==D.value[1]||I.value[2]!==D.value[2],K=I.strValue),F&&(m[C]=D.strValue,this.applyBypass(a,C,K),t=!0))}}t&&(d.transitioning=!0,(new zh(function(P){0<l?a.delayAnimation(l).play().promise().then(P):P()})).then(function(){return a.animation({style:m,
duration:h,easing:a.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){c.removeBypasses(a,f);a.emitAndNotify("style");d.transitioning=!1}))}else d.transitioning&&(this.removeBypasses(a,f),a.emitAndNotify("style"),d.transitioning=!1)},checkTrigger:function(a,b,c,d,f,h){b=this.properties[b];f=f(b);a.removed()||null!=f&&f(c,d,a)&&h(b)},checkZOrderTrigger:function(a,b,c,d){var f=this;this.checkTrigger(a,b,c,d,function(h){return h.triggersZOrder},function(){f._private.cy.notify("zorder",
a)})},checkBoundsTrigger:function(a,b,c,d){this.checkTrigger(a,b,c,d,function(f){return f.triggersBounds},function(f){a.dirtyCompoundBoundsCache();a.dirtyBoundingBoxCache()})},checkConnectedEdgesBoundsTrigger:function(a,b,c,d){this.checkTrigger(a,b,c,d,function(f){return f.triggersBoundsOfConnectedEdges},function(f){a.connectedEdges().forEach(function(h){h.dirtyBoundingBoxCache()})})},checkParallelEdgesBoundsTrigger:function(a,b,c,d){this.checkTrigger(a,b,c,d,function(f){return f.triggersBoundsOfParallelEdges},
function(f){a.parallelEdges().forEach(function(h){h.dirtyBoundingBoxCache()})})},checkTriggers:function(a,b,c,d){a.dirtyStyleCache();this.checkZOrderTrigger(a,b,c,d);this.checkBoundsTrigger(a,b,c,d);this.checkConnectedEdgesBoundsTrigger(a,b,c,d);this.checkParallelEdgesBoundsTrigger(a,b,c,d)}},{applyBypass:function(a,b,c,d){var f=[];if("*"===b||"**"===b){if(void 0!==c)for(b=0;b<this.properties.length;b++){var h=this.parse(this.properties[b].name,c,!0);h&&f.push(h)}}else if(rc(b))(b=this.parse(b,c,
!0))&&f.push(b);else if(Zc(b))for(d=c,c=Object.keys(b),h=0;h<c.length;h++){var l=c[h],m=b[l];(void 0===m&&(m=b[tg(l)]),void 0!==m)&&(l=this.parse(l,m,!0))&&f.push(l)}else return!1;if(0===f.length)return!1;b=!1;for(c=0;c<a.length;c++){h=a[c];l={};var t=void 0;for(m=0;m<f.length;m++){var v=f[m];d&&(t=h.pstyle(v.name),t=l[v.name]={prev:t});b=this.applyParsedProperty(h,Ce(v))||b;d&&(t.next=h.pstyle(v.name))}b&&this.updateStyleHints(h);d&&this.updateTransitions(h,l,!0)}return b},overrideBypass:function(a,
b,c){b=hh(b);for(var d=0;d<a.length;d++){var f=a[d],h=f._private.style[b],l=this.properties[b].type,m=l.color;l=l.mutiple;var t=h?null!=h.pfValue?h.pfValue:h.value:null;h&&h.bypass?(h.value=c,null!=h.pfValue&&(h.pfValue=c),m?h.strValue="rgb("+c.join(",")+")":l?h.strValue=c.join(" "):h.strValue=""+c,this.updateStyleHints(f)):this.applyBypass(f,b,c);this.checkTriggers(f,b,t,c)}},removeAllBypasses:function(a,b){return this.removeBypasses(a,this.propertyNames,b)},removeBypasses:function(a,b,c){for(var d=
0;d<a.length;d++){for(var f=a[d],h={},l=0;l<b.length;l++){var m=b[l],t=this.properties[m],v=f.pstyle(t.name);v&&v.bypass&&(m=this.parse(m,"",!0),v=h[t.name]={prev:v},this.applyParsedProperty(f,m),v.next=f.pstyle(t.name))}this.updateStyleHints(f);c&&this.updateTransitions(f,h,!0)}}},{getEmSizeInPixels:function(){var a=this.containerCss("font-size");return null!=a?parseFloat(a):1},containerCss:function(a){var b=this._private.cy,c=b.container();if((b=b.window())&&c&&b.getComputedStyle)return b.getComputedStyle(c).getPropertyValue(a)}},
ll,{appendFromJson:function(a){for(var b=0;b<a.length;b++){var c=a[b],d=c.selector;c=c.style||c.css;var f=Object.keys(c);this.selector(d);for(d=0;d<f.length;d++){var h=f[d];this.css(h,c[h])}}return this},fromJson:function(a){return this.resetToDefault(),this.appendFromJson(a),this},json:function(){for(var a=[],b=this.defaultLength;b<this.length;b++){var c=this[b],d=c.selector;c=c.properties;for(var f={},h=0;h<c.length;h++){var l=c[h];f[l.name]=l.strValue}a.push({selector:d?d.toString():"core",style:f})}return a}},
{appendFromString:function(a){function b(){c.length>d.length?c=c.substr(d.length):c=""}var c=""+a;for(c=c.replace(/[/][*](\s|.)+?[*][/]/g,"");!c.match(/^\s*$/);){a=c.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!a){fd("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+c);break}var d=a[0];var f=a[1];if("core"!==f&&(new Zf(f)).invalid)fd("Skipping parsing of block: Invalid selector found in string stylesheet: "+f);else{var h=a[2],l=!1;var m=
h;for(a=[];!m.match(/^\s*$/);){var t=m.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!t){fd("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+h);l=!0;break}var v=t[0];var C=t[1];t=t[2];this.properties[C]?this.parse(C,t)?a.push({name:C,val:t}):fd("Skipping property: Invalid property definition in: "+v):fd("Skipping property: Invalid property name in: "+v);m.length>v.length?m=m.substr(v.length):m=""}if(l){b();break}this.selector(f);for(f=0;f<a.length;f++)m=
a[f],this.css(m.name,m.val)}b()}return this},fromString:function(a){return this.resetToDefault(),this.appendFromString(a),this}},Md,{parse:function(a,b,c,d){if(Gc(b))return this.parseImplWarn(a,b,c,d);var f=zi(a,""+b,c?"t":"f","mapping"===d||!0===d||!1===d||null==d?"dontcare":d),h=this.propCache=this.propCache||[],l;return(l=h[f])||(l=h[f]=this.parseImplWarn(a,b,c,d)),(c||"mapping"===d)&&(l=Ce(l),l&&(l.value=Ce(l.value))),l},parseImplWarn:function(a,b,c,d){c=this.parseImpl(a,b,c,d);return!c&&null!=
b&&fd("The style property `".concat(a,": ").concat(b,"` is invalid")),c&&("width"===c.name||"height"===c.name)&&"label"===b&&fd("The style value of `label` is deprecated for `"+c.name+"`"),c},parseImpl:function(a,b,c,d){a=hh(a);var f=this.properties[a],h=b,l=this.types;if(!f||void 0===b)return null;f.alias&&(f=f.pointsTo,a=f.name);var m=rc(b);m&&(b=b.trim());var t=f.type;if(!t)return null;if(c&&(""===b||null===b))return{name:a,value:b,bypass:!0,deleteBypass:!0};if(Gc(b))return{name:a,value:b,strValue:"fn",
mapped:l.fn,bypass:c};var v,C;if(!(!m||d||7>b.length||"a"!==b[1])){if(7<=b.length&&"d"===b[0]&&(v=(new RegExp(l.data.regex)).exec(b)))return c?!1:{name:a,value:v,strValue:""+b,mapped:l.data,field:v[1],bypass:c};if(10<=b.length&&"m"===b[0]&&(C=(new RegExp(l.mapData.regex)).exec(b))){if(c||t.multiple)return!1;var D=l.mapData;if(!t.color&&!t.number)return!1;var F=this.parse(a,C[4]);if(!F||F.mapped)return!1;h=this.parse(a,C[5]);return!h||h.mapped?!1:F.pfValue===h.pfValue||F.strValue===h.strValue?(fd("`"+
a+": "+b+"` is not a valid mapper because the output range is zero; converting to `"+a+": "+F.strValue+"`"),this.parse(a,F.strValue)):!t.color||(m=F.value,d=h.value,m[0]!==d[0]||m[1]!==d[1]||m[2]!==d[2]||m[3]!==d[3]&&(null!=m[3]&&1!==m[3]||null!=d[3]&&1!==d[3]))?{name:a,value:C,strValue:""+b,mapped:D,field:C[1],fieldMin:parseFloat(C[2]),fieldMax:parseFloat(C[3]),valueMin:F.value,valueMax:h.value,bypass:c}:!1}}if(t.multiple&&"multiple"!==d){if(m?D=b.split(/\s+/):kd(b)?D=b:D=[b],t.evenMultiple&&0!==
D.length%2)return null;C=[];F=[];h=[];m="";d=!1;for(f=0;f<D.length;f++)l=this.parse(a,D[f],c,"multiple"),d=d||rc(l.value),C.push(l.value),h.push(null!=l.pfValue?l.pfValue:l.value),F.push(l.units),m+=(0<f?" ":"")+l.strValue;return t.validate&&!t.validate(C,F)?null:t.singleEnum&&d?1===C.length&&rc(C[0])?{name:a,value:C[0],strValue:C[0],bypass:c}:null:{name:a,value:C,pfValue:h,strValue:m,bypass:c,units:F}}D=function(){for(var I=0;I<t.enums.length;I++)if(t.enums[I]===b)return{name:a,value:b,strValue:""+
b,bypass:c};return null};if(t.number){C="px";(t.units&&(F=t.units),t.implicitUnits&&(C=t.implicitUnits),t.unitless)||(m?(m="px|em"+(t.allowPercent?"|\\%":""),F&&(m=F),(m=b.match("^((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))("+m+")?$"))&&(b=m[1],F=m[2]||C)):F&&!t.implicitUnits||(F=C));if(b=parseFloat(b),isNaN(b)&&void 0===t.enums)return null;if(isNaN(b)&&void 0!==t.enums)return b=h,D();if(t.integer&&!Bi(b)||void 0!==t.min&&(b<t.min||t.strictMin&&b===t.min)||void 0!==t.max&&(b>t.max||t.strictMax&&
b===t.max))return null;D={name:a,value:b,strValue:""+b+(F||""),units:F,bypass:c};return t.unitless||"px"!==F&&"em"!==F?D.pfValue=b:D.pfValue="px"!==F&&F?this.getEmSizeInPixels()*b:b,("ms"===F||"s"===F)&&(D.pfValue="ms"===F?b:1E3*b),("deg"===F||"rad"===F)&&(D.pfValue="rad"===F?b:Math.PI*b/180),"%"===F&&(D.pfValue=b/100),D}if(t.propList){D=[];C=""+b;if("none"!==C){C=C.split(/\s*,\s*|\s+/);for(F=0;F<C.length;F++)h=C[F].trim(),this.properties[h]?D.push(h):fd("`"+h+"` is not a valid property name");if(0===
D.length)return null}return{name:a,value:D,strValue:0===D.length?"none":D.join(" "),bypass:c}}if(t.color)return(D=Sf(b))?{name:a,value:D,pfValue:D,strValue:"rgb("+D[0]+","+D[1]+","+D[2]+")",bypass:c}:null;if(t.regex||t.regexes){if(t.enums&&(D=D()))return D;D=t.regexes?t.regexes:[t.regex];for(C=0;C<D.length;C++)if(F=(new RegExp(D[C])).exec(b))return{name:a,value:t.singleRegexMatchValue?F[1]:F,strValue:""+b,bypass:c};return null}return t.string?{name:a,value:""+b,strValue:""+b,bypass:c}:t.enums?D():
null}}].forEach(function(a){Bc(ke,a)});Wd.types=ke.types;Wd.properties=ke.properties;Wd.propertyGroups=ke.propertyGroups;Wd.propertyGroupNames=ke.propertyGroupNames;Wd.propertyGroupKeys=ke.propertyGroupKeys;var Mg={autolock:function(a){if(void 0!==a)this._private.autolock=!!a;else return this._private.autolock;return this},autoungrabify:function(a){if(void 0!==a)this._private.autoungrabify=!!a;else return this._private.autoungrabify;return this},autounselectify:function(a){if(void 0!==a)this._private.autounselectify=
!!a;else return this._private.autounselectify;return this},selectionType:function(a){var b=this._private;if(null==b.selectionType&&(b.selectionType="single"),void 0!==a)"additive"!==a&&"single"!==a||(b.selectionType=a);else return b.selectionType;return this},panningEnabled:function(a){if(void 0!==a)this._private.panningEnabled=!!a;else return this._private.panningEnabled;return this},userPanningEnabled:function(a){if(void 0!==a)this._private.userPanningEnabled=!!a;else return this._private.userPanningEnabled;
return this},zoomingEnabled:function(a){if(void 0!==a)this._private.zoomingEnabled=!!a;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(a){if(void 0!==a)this._private.userZoomingEnabled=!!a;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(a){if(void 0!==a)this._private.boxSelectionEnabled=!!a;else return this._private.boxSelectionEnabled;return this},pan:function(){var a=arguments,b=this._private.pan,c;switch(a.length){case 0:return b;
case 1:if(rc(a[0]))return c=a[0],b[c];if(Zc(a[0])){if(!this._private.panningEnabled)return this;a=a[0];c=a.x;a=a.y;cc(c)&&(b.x=c);cc(a)&&(b.y=a);this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;c=a[0];a=a[1];("x"===c||"y"===c)&&cc(a)&&(b[c]=a);this.emit("pan viewport")}return this.notify("viewport"),this},panBy:function(a,b){var c=arguments,d=this._private.pan,f,h,l;if(!this._private.panningEnabled)return this;switch(c.length){case 1:Zc(a)&&(f=c[0],h=f.x,l=f.y,cc(h)&&
(d.x+=h),cc(l)&&(d.y+=l),this.emit("pan viewport"));break;case 2:c=a,f=b,("x"===c||"y"===c)&&cc(f)&&(d[c]+=f),this.emit("pan viewport")}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(a,b){if(a=this.getFitViewport(a,b))b=this._private,b.zoom=a.zoom,b.pan=a.pan,this.emit("pan zoom viewport"),this.notify("viewport");return this},getFitViewport:function(a,b){if(cc(a)&&void 0===b&&(b=a,a=void 0),this._private.panningEnabled&&this._private.zoomingEnabled){if(rc(a))a=
this.$(a);else{var c=a;if(Zc(c)&&cc(c.x1)&&cc(c.x2)&&cc(c.y1)&&cc(c.y2)){var d=a;d={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2};d.w=d.x2-d.x1;d.h=d.y2-d.y1}else $d(a)||(a=this.mutableElements())}if(!$d(a)||!a.empty())if(d=d||a.boundingBox(),a=this.width(),c=this.height(),b=cc(b)?b:0,!isNaN(a)&&!isNaN(c)&&0<a&&0<c&&!isNaN(d.w)&&!isNaN(d.h)&&0<d.w&&0<d.h)return b=Math.min((a-2*b)/d.w,(c-2*b)/d.h),b=b>this._private.maxZoom?this._private.maxZoom:b,b=b<this._private.minZoom?this._private.minZoom:b,{zoom:b,pan:{x:(a-
b*(d.x1+d.x2))/2,y:(c-b*(d.y1+d.y2))/2}}}},zoomRange:function(a,b){var c=this._private;null==b&&(b=a,a=b.min,b=b.max);return cc(a)&&cc(b)&&a<=b?(c.minZoom=a,c.maxZoom=b):cc(a)&&void 0===b&&a<=c.maxZoom?c.minZoom=a:cc(b)&&void 0===a&&b>=c.minZoom&&(c.maxZoom=b),this},minZoom:function(a){return void 0===a?this._private.minZoom:this.zoomRange({min:a})},maxZoom:function(a){return void 0===a?this._private.maxZoom:this.zoomRange({max:a})},getZoomedViewport:function(a){var b=this._private,c=b.pan,d=b.zoom,
f,h,l=!1;return(b.zoomingEnabled||(l=!0),cc(a)?h=a:Zc(a)&&(h=a.level,null!=a.position?f=rh(a.position,d,c):null!=a.renderedPosition&&(f=a.renderedPosition),null!=f&&!b.panningEnabled&&(l=!0)),h=h>b.maxZoom?b.maxZoom:h,h=h<b.minZoom?b.minZoom:h,!l&&cc(h)&&h!==d&&(null==f||cc(f.x)&&cc(f.y)))?null!=f?(a=h,{zoomed:!0,panned:!0,zoom:a,pan:{x:-a/d*(f.x-c.x)+f.x,y:-a/d*(f.y-c.y)+f.y}}):{zoomed:!0,panned:!1,zoom:h,pan:c}:null},zoom:function(a){if(void 0===a)return this._private.zoom;a=this.getZoomedViewport(a);
var b=this._private;return null!=a&&a.zoomed?(b.zoom=a.zoom,a.panned&&(b.pan.x=a.pan.x,b.pan.y=a.pan.y),this.emit("zoom"+(a.panned?" pan":"")+" viewport"),this.notify("viewport"),this):this},viewport:function(a){var b=this._private,c=!0,d=!0,f=[],h=!1,l=!1;if(!a||(cc(a.zoom)||(c=!1),Zc(a.pan)||(d=!1),!c&&!d))return this;c&&(c=a.zoom,c<b.minZoom||c>b.maxZoom||!b.zoomingEnabled?h=!0:(b.zoom=c,f.push("zoom")));!d||h&&a.cancelOnFailedZoom||!b.panningEnabled||(a=a.pan,cc(a.x)&&(b.pan.x=a.x,l=!1),cc(a.y)&&
(b.pan.y=a.y,l=!1),l||f.push("pan"));return 0<f.length&&(f.push("viewport"),this.emit(f.join(" ")),this.notify("viewport")),this},center:function(a){a=this.getCenterPan(a);return a&&(this._private.pan=a,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(a,b){if(this._private.panningEnabled&&(rc(a)?a=this.mutableElements().filter(a):$d(a)||(a=this.mutableElements()),0!==a.length)){a=a.boundingBox();var c=this.width(),d=this.height();b=void 0===b?this._private.zoom:b;return{x:(c-
b*(a.x1+a.x2))/2,y:(d-b*(a.y1+a.y2))/2}}},reset:function(){return this._private.panningEnabled&&this._private.zoomingEnabled?(this.viewport({pan:{x:0,y:0},zoom:1}),this):this},invalidateSize:function(){this._private.sizeCache=null},size:function(){var a=this._private,b=a.container,c;(c=a.sizeCache)||(b?(c=this.window().getComputedStyle(b),b={width:b.clientWidth-parseFloat(c.getPropertyValue("padding-left"))-parseFloat(c.getPropertyValue("padding-right")),height:b.clientHeight-parseFloat(c.getPropertyValue("padding-top"))-
parseFloat(c.getPropertyValue("padding-bottom"))}):b={width:1,height:1},c=b);return a.sizeCache=c},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var a=this._private.pan,b=this._private.zoom,c=this.renderedExtent();a={x1:(c.x1-a.x)/b,x2:(c.x2-a.x)/b,y1:(c.y1-a.y)/b,y2:(c.y2-a.y)/b};return a.w=a.x2-a.x1,a.h=a.y2-a.y1,a},renderedExtent:function(){var a=this.width(),b=this.height();return{x1:0,y1:0,x2:a,y2:b,w:a,h:b}},multiClickDebounceTime:function(a){if(a)this._private.multiClickDebounceTime=
a;else return this._private.multiClickDebounceTime;return this}};Mg.centre=Mg.center;Mg.autolockNodes=Mg.autolock;Mg.autoungrabifyNodes=Mg.autoungrabify;var ki={data:ld.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:ld.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:ld.data({field:"scratch",bindingEvent:"scratch",
allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:ld.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};ki.attr=ki.data;ki.removeAttr=ki.removeData;var gi=function(a){var b=this;a=Bc({},a);var c=a.container;c&&!ig(c)&&ig(c[0])&&(c=c[0]);var d=c?c._cyreg:null;(d=d||{},d.cy)&&(d.cy.destroy(),d={});var f=d.readies=d.readies||[];c&&(c._cyreg=d);d.cy=b;
var h=void 0!==Uc&&void 0!==c&&!a.headless,l=a;l.layout=Bc({name:h?"grid":"null"},l.layout);l.renderer=Bc({name:h?"canvas":"null"},l.renderer);a=function(v,C,D){return void 0!==C?C:void 0!==D?D:v};var m=this._private={container:c,ready:!1,options:l,elements:new be(this),listeners:[],aniEles:new be(this),data:l.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1E-50,maxZoom:1E50,zoomingEnabled:a(!0,l.zoomingEnabled),userZoomingEnabled:a(!0,l.userZoomingEnabled),
panningEnabled:a(!0,l.panningEnabled),userPanningEnabled:a(!0,l.userPanningEnabled),boxSelectionEnabled:a(!0,l.boxSelectionEnabled),autolock:a(!1,l.autolock,l.autolockNodes),autoungrabify:a(!1,l.autoungrabify,l.autoungrabifyNodes),autounselectify:a(!1,l.autounselectify),styleEnabled:void 0===l.styleEnabled?h:l.styleEnabled,zoom:cc(l.zoom)?l.zoom:1,pan:{x:Zc(l.pan)&&cc(l.pan.x)?l.pan.x:0,y:Zc(l.pan)&&cc(l.pan.y)?l.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:a(250,
l.multiClickDebounceTime)};this.createEmitter();this.selectionType(l.selectionType);this.zoomRange({min:l.minZoom,max:l.maxZoom});m.styleEnabled&&b.setStyle([]);c=Bc({},l,l.renderer);b.initRenderer(c);var t=function(v,C,D){b.notifications(!1);var F=b.mutableElements();0<F.length&&F.remove();null!=v&&(Zc(v)||kd(v))&&b.add(v);b.one("layoutready",function(I){b.notifications(!0);b.emit(I);b.one("load",C);b.emitAndNotify("load")}).one("layoutstop",function(){b.one("done",D);b.emit("done")});v=Bc({},b._private.options.layout);
v.eles=b.elements();b.layout(v).run()};(function(v,C){if(v.some(Uh))return zh.all(v).then(C);C(v)})([l.style,l.elements],function(v){var C=v[0];v=v[1];m.styleEnabled&&b.style().append(C);t(v,function(){b.startAnimationLoop();m.ready=!0;Gc(l.ready)&&b.on("ready",l.ready);for(var D=0;D<f.length;D++)b.on("ready",f[D]);d&&(d.readies=[]);b.emit("ready")},l.done)})},hj=gi.prototype;Bc(hj,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},
ready:function(a){return this.isReady()?this.emitter().emit("ready",[],a):this.on("ready",a),this},destroy:function(){if(!this.destroyed())return this.stopAnimationLoop(),this.destroyRenderer(),this.emit("destroy"),this._private.destroyed=!0,this},hasElementWithId:function(a){return this._private.elements.hasElementWithId(a)},getElementById:function(a){return this._private.elements.getElementById(a)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},
styleEnabled:function(){return this._private.styleEnabled},addToPool:function(a){return this._private.elements.merge(a),this},removeFromPool:function(a){return this._private.elements.unmerge(a),this},container:function(){return this._private.container||null},window:function(){if(null==this._private.container)return Uc;var a=this._private.container.ownerDocument;return void 0===a||null==a?Uc:a.defaultView||Uc},mount:function(a){if(null!=a){var b=this._private,c=b.options;return!ig(a)&&ig(a[0])&&(a=
a[0]),this.stopAnimationLoop(),this.destroyRenderer(),b.container=a,b.styleEnabled=!0,this.invalidateSize(),this.initRenderer(Bc({},c,c.renderer,{name:"null"===c.renderer.name?"canvas":c.renderer.name})),this.startAnimationLoop(),this.style(c.style),this.emit("mount"),this}},unmount:function(){return this.stopAnimationLoop(),this.destroyRenderer(),this.initRenderer({name:"null"}),this.emit("unmount"),this},options:function(){return Ce(this._private.options)},json:function(a){var b=this,c=b._private,
d=b.mutableElements();if(Zc(a)){if(b.startBatch(),a.elements){var f={},h=function(F,I){for(var K=[],P=[],ba=0;ba<F.length;ba++){var X=F[ba];if(X.data.id){var Y=""+X.data.id,ta=b.getElementById(Y);f[Y]=!0;0!==ta.length?P.push({ele:ta,json:X}):(I&&(X.group=I),K.push(X))}else fd("cy.json() cannot handle elements without an ID attribute")}b.add(K);for(F=0;F<P.length;F++)I=P[F],I.ele.json(I.json)};if(kd(a.elements))h(a.elements);else for(var l=["nodes","edges"],m=0;m<l.length;m++){var t=l[m],v=a.elements[t];
kd(v)&&h(v,t)}var C=b.collection();d.filter(function(F){return!f[F.id()]}).forEach(function(F){F.isParent()?C.merge(F):F.remove()});C.forEach(function(F){return F.children().move({parent:null})});C.forEach(function(F){return b.getElementById(F.id()).remove()})}a.style&&b.style(a.style);null!=a.zoom&&a.zoom!==c.zoom&&b.zoom(a.zoom);a.pan&&(a.pan.x!==c.pan.x||a.pan.y!==c.pan.y)&&b.pan(a.pan);a.data&&b.data(a.data);c="minZoom maxZoom zoomingEnabled userZoomingEnabled panningEnabled userPanningEnabled boxSelectionEnabled autolock autoungrabify autounselectify multiClickDebounceTime".split(" ");
for(d=0;d<c.length;d++)h=c[d],null!=a[h]&&b[h](a[h]);return b.endBatch(),this}var D={};a?D.elements=this.elements().map(function(F){return F.json()}):(D.elements={},d.forEach(function(F){var I=F.group();D.elements[I]||(D.elements[I]=[]);D.elements[I].push(F.json())}));this._private.styleEnabled&&(D.style=b.style().json());D.data=Ce(b.data());a=c.options;return D.zoomingEnabled=c.zoomingEnabled,D.userZoomingEnabled=c.userZoomingEnabled,D.zoom=c.zoom,D.minZoom=c.minZoom,D.maxZoom=c.maxZoom,D.panningEnabled=
c.panningEnabled,D.userPanningEnabled=c.userPanningEnabled,D.pan=Ce(c.pan),D.boxSelectionEnabled=c.boxSelectionEnabled,D.renderer=Ce(a.renderer),D.hideEdgesOnViewport=a.hideEdgesOnViewport,D.textureOnViewport=a.textureOnViewport,D.wheelSensitivity=a.wheelSensitivity,D.motionBlur=a.motionBlur,D.multiClickDebounceTime=a.multiClickDebounceTime,D}});hj.$id=hj.getElementById;[{add:function(a){if($d(a))if(a._private.cy===this)a=a.restore();else{for(var b=[],c=0;c<a.length;c++)b.push(a[c].json());a=new be(this,
b)}else if(kd(a))a=new be(this,a);else if(Zc(a)&&(kd(a.nodes)||kd(a.edges))){b=[];c=["nodes","edges"];for(var d=0,f=c.length;d<f;d++){var h=c[d],l=a[h];if(kd(l))for(var m=0,t=l.length;m<t;m++){var v=Bc({group:h},l[m]);b.push(v)}}a=new be(this,b)}else a=(new kg(this,a)).collection();return a},remove:function(a){$d(a)||rc(a)&&(a=this.$(a));return a.remove()}},zq,On,jl,fj,{notify:function(a,b){var c=this._private;this.batching()?(c.batchNotifications=c.batchNotifications||{},a=c.batchNotifications[a]=
c.batchNotifications[a]||this.collection(),null!=b&&a.merge(b)):c.notificationsEnabled&&(c=this.renderer(),this.destroyed()||!c||c.notify(a,b))},notifications:function(a){var b=this._private;return void 0===a?b.notificationsEnabled:(b.notificationsEnabled=!!a,this)},noNotifications:function(a){this.notifications(!1);a();this.notifications(!0)},batching:function(){return 0<this._private.batchCount},startBatch:function(){var a=this._private;return null==a.batchCount&&(a.batchCount=0),0===a.batchCount&&
(a.batchStyleEles=this.collection(),a.batchNotifications={}),a.batchCount++,this},endBatch:function(){var a=this._private;if(0===a.batchCount)return this;if(a.batchCount--,0===a.batchCount){a.batchStyleEles.updateStyle();var b=this.renderer();Object.keys(a.batchNotifications).forEach(function(c){var d=a.batchNotifications[c];d.empty()?b.notify(c):b.notify(c,d)})}return this},batch:function(a){return this.startBatch(),a(),this.endBatch(),this},batchData:function(a){var b=this;return this.batch(function(){for(var c=
Object.keys(a),d=0;d<c.length;d++){var f=c[d],h=a[f];b.getElementById(f).data(h)}})}},kl,gj,{style:function(a){a&&this.setStyle(a).update();return this._private.style},setStyle:function(a){var b=this._private;return"stylesheet"===$e(a)?b.style=a.generateStyle(this):kd(a)?b.style=Wd.fromJson(this,a):rc(a)?b.style=Wd.fromString(this,a):b.style=Wd(this),b.style},updateStyle:function(){this.mutableElements().updateStyle()}},Mg,ki].forEach(function(a){Bc(hj,a)});var Wp={fit:!0,directed:!1,padding:30,circle:!1,
grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(a,b){return!0},ready:void 0,stop:void 0,transform:function(a,b){return b}},Xp={maximal:!1,acyclic:!1},Dh=function(a){return a.scratch("breadthfirst")},Pn=function(a,b){return a.scratch("breadthfirst",b)};hb.prototype.run=function(){var a=this.options,b=a.cy,c=a.eles,d=c.nodes().filter(function(ub){return ub.isChildless()}),
f=a.directed,h=a.acyclic||a.maximal||0<a.maximalAdjustments,l=!!a.boundingBox,m=b.extent(),t=ae(l?a.boundingBox:{x1:m.x1,y1:m.y1,w:m.w,h:m.h});if($d(a.roots))var v=a.roots;else if(kd(a.roots)){m=[];for(var C=0;C<a.roots.length;C++){var D=b.getElementById(a.roots[C]);m.push(D)}v=b.collection(m)}else if(rc(a.roots))v=b.$(a.roots);else if(f)v=d.roots();else{var F=c.components();v=b.collection();b=function(){var ub=F[I],Kb=ub.maxDegree(!1);ub=ub.filter(function(Zb){return Zb.degree(!1)===Kb});v=v.add(ub)};
for(var I=0;I<F.length;I++)b()}var K=[],P={},ba=function(ub,Kb){null==K[Kb]&&(K[Kb]=[]);var Zb=K[Kb].length;K[Kb].push(ub);Pn(ub,{index:Zb,depth:Kb})},X=function(ub,Kb){var Zb=Dh(ub);K[Zb.depth][Zb.index]=null;ub.isChildless()&&ba(ub,Kb)};c.bfs({roots:v,directed:a.directed,visit:function(ub,Kb,Zb,dc,ac){ub=ub[0];Kb=ub.id();ub.isChildless()&&ba(ub,ac);P[Kb]=!0}});b=[];for(m=0;m<d.length;m++)C=d[m],P[C.id()]||b.push(C);var Y=function(ub){for(var Kb=K[ub],Zb=0;Zb<Kb.length;Zb++){var dc=Kb[Zb];null==
dc?(Kb.splice(Zb,1),Zb--):Pn(dc,{depth:ub,index:Zb})}};m=function(ub,Kb){for(var Zb=Dh(ub),dc=ub.incomers().filter(function(kc){return kc.isNode()&&c.has(kc)}),ac=-1,vb=ub.id(),Tb=0;Tb<dc.length;Tb++){var jc=Dh(dc[Tb]);ac=Math.max(ac,jc.depth)}if(Zb.depth<=ac){if(!a.acyclic&&Kb[vb])return null;Zb=ac+1;return X(ub,Zb),Kb[vb]=Zb,!0}return!1};if(f&&h){var ta=[];f={};h=function(ub){return ta.push(ub)};for(d.forEach(function(ub){return ta.push(ub)});0<ta.length;)if(C=ta.shift(),D=m(C,f))C.outgoers().filter(function(ub){return ub.isNode()&&
c.has(ub)}).forEach(h);else if(null===D){fd("Detected double maximal shift for node `"+C.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}var ja=0;if(a.avoidOverlap)for(f=0;f<d.length;f++)h=d[f].layoutDimensions(a),ja=Math.max(ja,h.w,h.h);var Ba={},Ua=function(ub){if(Ba[ub.id()])return Ba[ub.id()];for(var Kb=Dh(ub).depth,Zb=ub.neighborhood(),dc=0,ac=0,vb=0;vb<Zb.length;vb++){var Tb=Zb[vb];if(!Tb.isEdge()&&!Tb.isParent()&&d.has(Tb)){var jc=Dh(Tb);
if(null!=jc&&(Tb=jc.index,jc=jc.depth,null!=Tb&&null!=jc)){var kc=K[jc].length;jc<Kb&&(dc+=Tb/kc,ac++)}}}return ac=Math.max(1,ac),dc/=ac,0===ac&&(dc=0),Ba[ub.id()]=dc,dc};f=function(ub,Kb){var Zb=Ua(ub),dc=Ua(Kb);Zb-=dc;0===Zb?(ub=ub.id(),Kb=Kb.id(),Kb=ub<Kb?-1:ub>Kb?1:0):Kb=Zb;return Kb};void 0!==a.depthSort&&(f=a.depthSort);var ab=K.length;for(h=0;h<ab;h++)K[h].sort(f),Y(h);f=[];for(h=0;h<b.length;h++)f.push(b[h]);b=function(){for(var ub=0;ub<ab;ub++)Y(ub)};f.length&&(K.unshift(f),ab=K.length,b());
for(b=0;b<ab;b++);var Qb=t.x1+t.w/2,Mb=t.y1+t.h/2,Ub=d.reduce(function(ub,Kb){Kb=Kb.boundingBox({includeLabels:a.nodeDimensionsIncludeLabels});return{w:-1===ub.w?Kb.w:(ub.w+Kb.w)/2,h:-1===ub.h?Kb.h:(ub.h+Kb.h)/2}},{w:-1,h:-1}),Wb=Math.max(1===ab?0:l?(t.h-2*a.padding-Ub.h)/(ab-1):(t.h-2*a.padding-Ub.h)/(ab+1),ja),Yb=K.reduce(function(ub,Kb){return Math.max(ub,Kb.length)},0);return c.nodes().layoutPositions(this,a,function(ub){var Kb=Dh(ub);ub=Kb.depth;Kb=Kb.index;if(a.circle){var Zb=Math.min(t.w/2/
ab,t.h/2/ab);Zb=Math.max(Zb,ja);Zb=Zb*ub+Zb-(0<ab&&3>=K[0].length?Zb/2:0);Kb*=2*Math.PI/K[ub].length;return 0===ub&&1===K[0].length&&(Zb=1),{x:Qb+Zb*Math.cos(Kb),y:Mb+Zb*Math.sin(Kb)}}Zb=K[ub].length;return{x:Qb+(Kb+1-(Zb+1)/2)*Math.max(1===Zb?0:l?(t.w-2*a.padding-Ub.w)/((a.grid?Yb:Zb)-1):(t.w-2*a.padding-Ub.w)/((a.grid?Yb:Zb)+1),ja),y:Mb+(ub+1-(ab+1)/2)*Wb}}),this};var Yp={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:1.5*
Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(a,b){return!0},ready:void 0,stop:void 0,transform:function(a,b){return b}};Nb.prototype.run=function(){var a=this.options,b=a.cy,c=a.eles,d=void 0!==a.counterclockwise?!a.counterclockwise:a.clockwise,f=c.nodes().not(":parent");a.sort&&(f=f.sort(a.sort));for(var h=ae(a.boundingBox?a.boundingBox:{x1:0,y1:0,w:b.width(),h:b.height()}),l=h.x1+h.w/2,m=h.y1+h.h/2,t=(void 0===a.sweep?
2*Math.PI-2*Math.PI/f.length:a.sweep)/Math.max(1,f.length-1),v,C=b=0;C<f.length;C++){var D=f[C].layoutDimensions(a);b=Math.max(b,D.w,D.h)}if(cc(a.radius)?v=a.radius:1>=f.length?v=0:v=Math.min(h.h,h.w)/2-b,1<f.length&&a.avoidOverlap)b*=1.75,f=Math.cos(t)-Math.cos(0),h=Math.sin(t)-Math.sin(0),v=Math.max(Math.sqrt(b*b/(f*f+h*h)),v);return c.nodes().layoutPositions(this,a,function(F,I){F=a.startAngle+I*t*(d?1:-1);return{x:l+v*Math.cos(F),y:m+v*Math.sin(F)}}),this};var Zp={fit:!0,padding:30,startAngle:1.5*
Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(a){return a.degree()},levelWidth:function(a){return a.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(a,b){return!0},ready:void 0,stop:void 0,transform:function(a,b){return b}};sc.prototype.run=function(){var a=this.options,b=void 0!==a.counterclockwise?
!a.counterclockwise:a.clockwise,c=a.cy,d=a.eles,f=d.nodes().not(":parent"),h=ae(a.boundingBox?a.boundingBox:{x1:0,y1:0,w:c.width(),h:c.height()});c=h.x1+h.w/2;for(var l=h.y1+h.h/2,m=[],t=0,v=0;v<f.length;v++){var C=f[v],D=void 0;D=a.concentric(C);m.push({value:D,node:C});C._private.scratch.concentric=D}f.updateStyle();for(v=0;v<f.length;v++)C=f[v].layoutDimensions(a),t=Math.max(t,C.w,C.h);m.sort(function(K,P){return P.value-K.value});v=a.levelWidth(f);f=[[]];C=f[0];for(D=0;D<m.length;D++){var F=m[D];
0<C.length&&Math.abs(C[0].value-F.value)>=v&&(C=[],f.push(C));C.push(F)}m=t+a.minNodeSpacing;a.avoidOverlap||(m=Math.min(m,(Math.min(h.w,h.h)/2-m)/(f.length+(0<f.length&&1<f[0].length)?1:0)));for(t=h=0;t<f.length;t++)v=f[t],D=v.dTheta=(void 0===a.sweep?2*Math.PI-2*Math.PI/v.length:a.sweep)/Math.max(1,v.length-1),1<v.length&&a.avoidOverlap&&(C=Math.cos(D)-Math.cos(0),D=Math.sin(D)-Math.sin(0),h=Math.max(Math.sqrt(m*m/(C*C+D*D)),h)),v.r=h,h+=m;if(a.equidistant){for(t=m=h=0;t<f.length;t++)h=Math.max(h,
f[t].r-m);for(t=m=0;t<f.length;t++)v=f[t],0===t&&(m=v.r),v.r=m,m+=h}var I={};for(h=0;h<f.length;h++)for(m=f[h],t=m.dTheta,v=m.r,C=0;C<m.length;C++)D=a.startAngle+(b?1:-1)*t*C,D={x:c+v*Math.cos(D),y:l+v*Math.sin(D)},I[m[C].node.id()]=D;return d.nodes().layoutPositions(this,a,function(K){K=K.id();return I[K]}),this};var ml,$p={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(a,b){return!0},animationThreshold:250,refresh:20,fit:!0,
padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(a){return 2048},nodeOverlap:4,idealEdgeLength:function(a){return 32},edgeElasticity:function(a){return 32},nestingFactor:1.2,gravity:1,numIter:1E3,initialTemp:1E3,coolingFactor:.99,minTemp:1};Ec.prototype.run=function(){var a=this.options,b=a.cy,c=this;c.stopped=!1;!0!==a.animate&&!1!==a.animate||c.emit({type:"layoutstart",layout:c});!0===a.debug?ml=!0:ml=!1;var d=Cq(b,c,a);ml&&Dq(d);
a.randomize&&Eq(d);var f=Be(),h=function(){Fq(d,b,a);!0===a.fit&&b.fit(a.padding)},l=function(D){if(!(D=c.stopped||D>=a.numIter)){for(D=0;D<d.graphSet.length;D++)for(var F=d.graphSet[D],I=F.length,K=0;K<I;K++)for(var P=d.layoutNodes[d.idToIndex[F[K]]],ba=K+1;ba<I;ba++){var X=P,Y=d.layoutNodes[d.idToIndex[F[ba]]],ta=d,ja=a;if(X.cmptId===Y.cmptId||ta.isCompound){var Ba=Y.positionX-X.positionX;ta=Y.positionY-X.positionY;0===Ba&&0===ta&&(Ba=-1+2*Math.random(),ta=-1+2*Math.random());var Ua=0<Ba?X.maxX-
Y.minX:Y.maxX-X.minX;var ab=0<ta?X.maxY-Y.minY:Y.maxY-X.minY;Ua=0<=Ua&&0<=ab?Math.sqrt(Ua*Ua+ab*ab):0;0<Ua?(Ua*=ja.nodeOverlap,ja=Math.sqrt(Ba*Ba+ta*ta),Ba=Ua*Ba/ja,ta=Ua*ta/ja):(ja=ij(X,Ba,ta),Ba=ij(Y,-1*Ba,-1*ta),ta=Ba.x-ja.x,ab=Ba.y-ja.y,Ba=ta*ta+ab*ab,ja=Math.sqrt(Ba),Ua=(X.nodeRepulsion+Y.nodeRepulsion)/Ba,Ba=Ua*ta/ja,ta=Ua*ab/ja);X.isLocked||(X.offsetX-=Ba,X.offsetY-=ta);Y.isLocked||(Y.offsetX+=Ba,Y.offsetY+=ta)}}for(D=0;D<d.edgeSize;D++)if(K=d.layoutEdges[D],F=d.layoutNodes[d.idToIndex[K.sourceId]],
I=d.layoutNodes[d.idToIndex[K.targetId]],P=I.positionX-F.positionX,X=I.positionY-F.positionY,0!==P||0!==X)ba=ij(F,P,X),X=ij(I,-1*P,-1*X),P=X.x-ba.x,ba=X.y-ba.y,X=Math.sqrt(P*P+ba*ba),K=Math.pow(K.idealLength-X,2)/K.elasticity,0!==X?(P=K*P/X,K=K*ba/X):K=P=0,F.isLocked||(F.offsetX+=P,F.offsetY+=K),I.isLocked||(I.offsetX-=P,I.offsetY-=K);if(0!==a.gravity)for(D=0;D<d.graphSet.length;D++)for(F=d.graphSet[D],I=F.length,0===D?(K=d.clientHeight/2,P=d.clientWidth/2):(P=d.layoutNodes[d.idToIndex[d.layoutNodes[d.idToIndex[F[0]]].parentId]],
K=P.positionX,P=P.positionY),ba=0;ba<I;ba++)X=d.layoutNodes[d.idToIndex[F[ba]]],X.isLocked||(Y=K-X.positionX,Ba=P-X.positionY,ta=Math.sqrt(Y*Y+Ba*Ba),1<ta&&(Ba=a.gravity*Ba/ta,X.offsetX+=a.gravity*Y/ta,X.offsetY+=Ba));D=[];F=0;I=-1;D.push.apply(D,d.graphSet[0]);for(I+=d.graphSet[0].length;F<=I;)if(K=D[F++],K=d.layoutNodes[d.idToIndex[K]],P=K.children,0<P.length&&!K.isLocked){ba=K.offsetX;X=K.offsetY;for(Y=0;Y<P.length;Y++)ta=d.layoutNodes[d.idToIndex[P[Y]]],ta.offsetX+=ba,ta.offsetY+=X,D[++I]=P[Y];
K.offsetX=0;K.offsetY=0}for(D=0;D<d.nodeSize;D++)F=d.layoutNodes[D],0<F.children.length&&(F.maxX=void 0,F.minX=void 0,F.maxY=void 0,F.minY=void 0);for(D=0;D<d.nodeSize;D++)F=d.layoutNodes[D],0<F.children.length||F.isLocked||(I=F.offsetX,K=F.offsetY,P=d.temperature,ba=Math.sqrt(I*I+K*K),I=ba>P?{x:P*I/ba,y:P*K/ba}:{x:I,y:K},F.positionX+=I.x,F.positionY+=I.y,F.offsetX=0,F.offsetY=0,F.minX=F.positionX-F.width,F.maxX=F.positionX+F.width,F.minY=F.positionY-F.height,F.maxY=F.positionY+F.height,Qn(F,d));
for(D=0;D<d.nodeSize;D++)F=d.layoutNodes[D],0<F.children.length&&!F.isLocked&&(F.positionX=(F.maxX+F.minX)/2,F.positionY=(F.maxY+F.minY)/2,F.width=F.maxX-F.minX,F.height=F.maxY-F.minY);D=(d.temperature*=a.coolingFactor,d.temperature<a.minTemp)}return!D},m=function(){if(!0===a.animate||!1===a.animate)h(),c.one("layoutstop",a.stop),c.emit({type:"layoutstop",layout:c});else{var D=a.eles.nodes(),F=Rn(d,a,D);D.layoutPositions(c,a,F)}},t=0,v=!0;if(!0===a.animate){var C=function(){for(var D=0;v&&D<a.refresh;)v=
l(t),t++,D++;v?(Be()-f>=a.animationThreshold&&h(),te(C)):(Sn(d,a),m())};C()}else{for(;v;)v=l(t),t++;Sn(d,a);m()}return this};Ec.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};Ec.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var Cq=function(a,b,c){b=c.eles.edges();var d=c.eles.nodes(),f=ae(c.boundingBox?c.boundingBox:{x1:0,y1:0,w:a.width(),h:a.height()});a={isCompound:a.hasCompoundNodes(),layoutNodes:[],idToIndex:{},
nodeSize:d.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:b.size(),temperature:c.initialTemp,clientWidth:f.w,clientHeight:f.h,boundingBox:f};var h=c.eles.components(),l={};for(f=0;f<h.length;f++)for(var m=h[f],t=0;t<m.length;t++){var v=m[t];l[v.id()]=f}for(f=0;f<a.nodeSize;f++)t=d[f],h=t.layoutDimensions(c),v={},v.isLocked=t.locked(),v.id=t.data("id"),v.parentId=t.data("parent"),v.cmptId=l[t.id()],v.children=[],v.positionX=t.position("x"),v.positionY=t.position("y"),v.offsetX=0,v.offsetY=
0,v.height=h.w,v.width=h.h,v.maxX=v.positionX+v.width/2,v.minX=v.positionX-v.width/2,v.maxY=v.positionY+v.height/2,v.minY=v.positionY-v.height/2,v.padLeft=parseFloat(t.style("padding")),v.padRight=parseFloat(t.style("padding")),v.padTop=parseFloat(t.style("padding")),v.padBottom=parseFloat(t.style("padding")),v.nodeRepulsion=Gc(c.nodeRepulsion)?c.nodeRepulsion(t):c.nodeRepulsion,a.layoutNodes.push(v),a.idToIndex[v.id]=f;d=[];l=0;h=-1;v=[];for(f=0;f<a.nodeSize;f++)t=a.layoutNodes[f],m=t.parentId,null!=
m?a.layoutNodes[a.idToIndex[m]].children.push(t.id):(d[++h]=t.id,v.push(t.id));for(a.graphSet.push(v);l<=h;)if(f=d[l++],v=a.layoutNodes[a.idToIndex[f]],v=v.children,0<v.length)for(a.graphSet.push(v),f=0;f<v.length;f++)d[++h]=v[f];for(f=0;f<a.graphSet.length;f++)for(d=a.graphSet[f],t=0;t<d.length;t++)a.indexToGraph[a.idToIndex[d[t]]]=f;for(f=0;f<a.edgeSize;f++){v=b[f];d={};d.id=v.data("id");d.sourceId=v.data("source");d.targetId=v.data("target");t=Gc(c.idealEdgeLength)?c.idealEdgeLength(v):c.idealEdgeLength;
l=Gc(c.edgeElasticity)?c.edgeElasticity(v):c.edgeElasticity;v=a.idToIndex[d.sourceId];h=a.idToIndex[d.targetId];if(a.indexToGraph[v]!=a.indexToGraph[h]){m=Tn(d.sourceId,d.targetId,0,a);m=a.graphSet[2>m.count?0:m.graph];var C=0;for(v=a.layoutNodes[v];-1===m.indexOf(v.id);)v=a.layoutNodes[a.idToIndex[v.parentId]],C++;for(v=a.layoutNodes[h];-1===m.indexOf(v.id);)v=a.layoutNodes[a.idToIndex[v.parentId]],C++;t*=C*c.nestingFactor}d.idealLength=t;d.elasticity=l;a.layoutEdges.push(d)}return a},Tn=function(a,
b,c,d){var f=d.graphSet[c];if(-1<f.indexOf(a)&&-1<f.indexOf(b))return{count:2,graph:c};for(var h=0,l=0;l<f.length;l++){var m=d.layoutNodes[d.idToIndex[f[l]]].children;if(0!==m.length&&(m=Tn(a,b,d.indexToGraph[d.idToIndex[m[0]]],d),0!==m.count))if(1===m.count){if(h++,2===h)break}else return m}return{count:h,graph:c}},Dq,Eq=function(a,b){b=a.clientWidth;for(var c=a.clientHeight,d=0;d<a.nodeSize;d++){var f=a.layoutNodes[d];0===f.children.length&&!f.isLocked&&(f.positionX=Math.random()*b,f.positionY=
Math.random()*c)}},Rn=function(a,b,c){var d=a.boundingBox,f=1/0,h=-1/0,l=1/0,m=-1/0,t,v;return b.boundingBox&&(c.forEach(function(C){C=a.layoutNodes[a.idToIndex[C.data("id")]];f=Math.min(f,C.positionX);h=Math.max(h,C.positionX);l=Math.min(l,C.positionY);m=Math.max(m,C.positionY)}),t=h-f,v=m-l),function(C,D){C=a.layoutNodes[a.idToIndex[C.data("id")]];return b.boundingBox?{x:d.x1+(C.positionX-f)/t*d.w,y:d.y1+(C.positionY-l)/v*d.h}:{x:C.positionX,y:C.positionY}}},Fq=function(a,b,c){b=c.layout;var d=
c.eles.nodes(),f=Rn(a,c,d);d.positions(f);!0!==a.ready&&(a.ready=!0,b.one("layoutready",c.ready),b.emit({type:"layoutready",layout:this}))},ij=function(a,b,c){var d=a.positionX,f=a.positionY,h=a.height||1;a=a.width||1;var l=c/b,m=h/a,t={};return 0===b&&0<c||0===b&&0>c?(t.x=d,t.y=f+h/2,t):0<b&&-1*m<=l&&l<=m?(t.x=d+a/2,t.y=f+a*c/2/b,t):0>b&&-1*m<=l&&l<=m?(t.x=d-a/2,t.y=f-a*c/2/b,t):0<c&&(l<=-1*m||l>=m)?(t.x=d+h*b/2/c,t.y=f+h/2,t):(0>c&&(l<=-1*m||l>=m)&&(t.x=d-h*b/2/c,t.y=f-h/2),t)},Qn=function(a,b){var c=
a.parentId;if(null!=c){c=b.layoutNodes[b.idToIndex[c]];var d=!1;if((null==c.maxX||a.maxX+c.padRight>c.maxX)&&(c.maxX=a.maxX+c.padRight,d=!0),(null==c.minX||a.minX-c.padLeft<c.minX)&&(c.minX=a.minX-c.padLeft,d=!0),(null==c.maxY||a.maxY+c.padBottom>c.maxY)&&(c.maxY=a.maxY+c.padBottom,d=!0),(null==c.minY||a.minY-c.padTop<c.minY)&&(c.minY=a.minY-c.padTop,d=!0),d)return Qn(c,b)}},Sn=function(a,b){for(var c=a.layoutNodes,d=[],f=0;f<c.length;f++){var h=c[f],l=h.cmptId;(d[l]=d[l]||[]).push(h)}var m=0;for(f=
0;f<d.length;f++)if(c=d[f]){c.x1=1/0;c.x2=-1/0;c.y1=1/0;c.y2=-1/0;for(h=0;h<c.length;h++)l=c[h],c.x1=Math.min(c.x1,l.positionX-l.width/2),c.x2=Math.max(c.x2,l.positionX+l.width/2),c.y1=Math.min(c.y1,l.positionY-l.height/2),c.y2=Math.max(c.y2,l.positionY+l.height/2);c.w=c.x2-c.x1;c.h=c.y2-c.y1;m+=c.w*c.h}d.sort(function(F,I){return I.w*I.h-F.w*F.h});var t=0,v=0,C=0,D=0;a=Math.sqrt(m)*a.clientWidth/a.clientHeight;for(f=0;f<d.length;f++)if(c=d[f]){for(h=0;h<c.length;h++)l=c[h],l.isLocked||(l.positionX+=
t-c.x1,l.positionY+=v-c.y1);t+=c.w+b.componentSpacing;C+=c.w+b.componentSpacing;D=Math.max(D,c.h);C>a&&(v+=D+b.componentSpacing,t=0,C=0,D=0)}},aq={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(a){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(a,b){return!0},ready:void 0,stop:void 0,transform:function(a,b){return b}};Kc.prototype.run=
function(){var a=this.options,b=a.cy,c=a.eles,d=c.nodes().not(":parent");a.sort&&(d=d.sort(a.sort));var f=ae(a.boundingBox?a.boundingBox:{x1:0,y1:0,w:b.width(),h:b.height()});if(0===f.h||0===f.w)c.nodes().layoutPositions(this,a,function(X){return{x:f.x1,y:f.y1}});else{b=d.size();c=Math.sqrt(b*f.h/f.w);var h=Math.round(c),l=Math.round(f.w/f.h*c);c=function(X){if(null==X)return Math.min(h,l);Math.min(h,l)==h?h=X:l=X};var m=function(X){if(null==X)return Math.max(h,l);Math.max(h,l)==h?h=X:l=X},t=a.rows,
v=null!=a.cols?a.cols:a.columns;if(null!=t&&null!=v)h=t,l=v;else if(null!=t&&null==v)h=t,l=Math.ceil(b/h);else if(null==t&&null!=v)l=v,h=Math.ceil(b/l);else if(l*h>b)t=c(),v=m(),(t-1)*v>=b?c(t-1):(v-1)*t>=b&&m(v-1);else for(;l*h<b;)t=c(),v=m(),(v+1)*t>=b?m(v+1):c(t+1);var C=f.w/l,D=f.h/h;if(a.condense&&(C=0,D=0),a.avoidOverlap)for(b=0;b<d.length;b++)c=d[b],m=c._private.position,(null==m.x||null==m.y)&&(m.x=0,m.y=0),c=c.layoutDimensions(a),m=a.avoidOverlapPadding,t=c.h+m,C=Math.max(C,c.w+m),D=Math.max(D,
t);var F={},I=0,K=0,P=function(){K++;K>=l&&(K=0,I++)},ba={};for(b=0;b<d.length;b++)if(c=d[b],(m=a.position(c))&&(void 0!==m.row||void 0!==m.col)){m={row:m.row,col:m.col};if(void 0===m.col)for(m.col=0;F["c-"+m.row+"-"+m.col];)m.col++;else if(void 0===m.row)for(m.row=0;F["c-"+m.row+"-"+m.col];)m.row++;ba[c.id()]=m;F["c-"+m.row+"-"+m.col]=!0}d.layoutPositions(this,a,function(X,Y){if(X.locked()||X.isParent())return!1;if(Y=ba[X.id()])X=Y.col*C+C/2+f.x1,Y=Y.row*D+D/2+f.y1;else{for(;F["c-"+I+"-"+K];)P();
X=K*C+C/2+f.x1;Y=I*D+D/2+f.y1;F["c-"+I+"-"+K]=!0;P()}return{x:X,y:Y}})}return this};var bq={ready:function(){},stop:function(){}};ed.prototype.run=function(){var a=this.options,b=a.eles;return a.cy,this.emit("layoutstart"),b.nodes().positions(function(){return{x:0,y:0}}),this.one("layoutready",a.ready),this.emit("layoutready"),this.one("layoutstop",a.stop),this.emit("layoutstop"),this};ed.prototype.stop=function(){return this};var cq={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,
animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(a,b){return!0},ready:void 0,stop:void 0,transform:function(a,b){return b}};ud.prototype.run=function(){var a=this.options,b=a.eles.nodes(),c=Gc(a.positions);return b.layoutPositions(this,a,function(d,f){null==a.positions?(f=d.position(),f={x:f.x,y:f.y}):f=c?a.positions(d):a.positions[d._private.data.id]??null;return d.locked()||null==f?!1:f}),this};var dq={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,
animationEasing:void 0,animateFilter:function(a,b){return!0},ready:void 0,stop:void 0,transform:function(a,b){return b}};he.prototype.run=function(){var a=this.options,b=a.cy,c=a.eles,d=ae(a.boundingBox?a.boundingBox:{x1:0,y1:0,w:b.width(),h:b.height()});return c.nodes().layoutPositions(this,a,function(f,h){return{x:d.x1+Math.round(Math.random()*d.w),y:d.y1+Math.round(Math.random()*d.h)}}),this};var Gq=[{name:"breadthfirst",impl:hb},{name:"circle",impl:Nb},{name:"concentric",impl:sc},{name:"cose",
impl:Ec},{name:"grid",impl:Kc},{name:"null",impl:ed},{name:"preset",impl:ud},{name:"random",impl:he}],Un=function(){},Vn=function(){throw Error("A headless instance can not render images");};ze.prototype={recalculateRenderedStyle:Un,notify:function(){this.notifications++},init:Un,isHeadless:function(){return!0},png:Vn,jpg:Vn};var nl={calculateArrowAngles:function(a){a=a._private.rscratch;var b="haystack"===a.edgeType,c="bezier"===a.edgeType,d="multibezier"===a.edgeType,f="segments"===a.edgeType,h=
"compound"===a.edgeType,l="self"===a.edgeType,m,t,v,C,D,F;if(b?(m=a.haystackPts[0],t=a.haystackPts[1],v=a.haystackPts[2],C=a.haystackPts[3]):(m=a.arrowStartX,t=a.arrowStartY,v=a.arrowEndX,C=a.arrowEndY),D=a.midX,F=a.midY,f){var I=m-a.segpts[0];var K=t-a.segpts[1]}else if(d||h||l||c){var P=a.allpts;D=Jd(P[0],P[2],P[4],.1);P=Jd(P[1],P[3],P[5],.1);I=m-D;K=t-P}else I=m-D,K=t-F;a.srcArrowAngle=Math.atan2(K,I)-Math.PI/2;D=a.midX;F=a.midY;if(b&&(D=(m+v)/2,F=(t+C)/2),I=v-m,K=C-t,f)P=a.allpts,0===P.length/
2%2?(m=P.length/2,t=m-2,I=P[m]-P[t],K=P[m+1]-P[t+1]):a.isRound?(I=a.midVector[1],K=-a.midVector[0]):(m=P.length/2-1,t=m-2,I=P[m]-P[t],K=P[m+1]-P[t+1]);else if(d||h||l){P=a.allpts;if(0===a.ctrlpts.length/2%2){b=P.length/2-1;K=b+2;var ba=K+2;I=Jd(P[b],P[K],P[ba],0);m=Jd(P[b+1],P[K+1],P[ba+1],0);t=Jd(P[b],P[K],P[ba],1E-4);P=Jd(P[b+1],P[K+1],P[ba+1],1E-4)}else K=P.length/2-1,b=K-2,ba=K+2,I=Jd(P[b],P[K],P[ba],.4999),m=Jd(P[b+1],P[K+1],P[ba+1],.4999),t=Jd(P[b],P[K],P[ba],.5),P=Jd(P[b+1],P[K+1],P[ba+1],
.5);I=t-I;K=P-m}if(a.midtgtArrowAngle=Math.atan2(K,I)-Math.PI/2,a.midDispX=I,a.midDispY=K,I*=-1,K*=-1,f)P=a.allpts,0===P.length/2%2||a.isRound||(m=P.length/2-1,t=m+2,I=-(P[t]-P[m]),K=-(P[t+1]-P[m+1]));(a.midsrcArrowAngle=Math.atan2(K,I)-Math.PI/2,f)?(I=v-a.segpts[a.segpts.length-2],K=C-a.segpts[a.segpts.length-1]):d||h||l||c?(P=a.allpts,c=P.length,D=Jd(P[c-6],P[c-4],P[c-2],.9),P=Jd(P[c-5],P[c-3],P[c-1],.9),I=v-D,K=C-P):(I=v-D,K=C-F);a.tgtArrowAngle=Math.atan2(K,I)-Math.PI/2}};nl.getArrowWidth=nl.getArrowHeight=
function(a,b){var c=this.arrowWidthCache=this.arrowWidthCache||{},d=c[a+", "+b];return d||(d=Math.max(Math.pow(13.37*a,.9),29)*b,c[a+", "+b]=d,d)};var Yk,Zk,jf={},Ie={},bn,cn,Ig,Ui,Df,Jg,Hg,kf,yh,Vi,dn,en,$k,al,$m,an=function(a,b,c){c.x=b.x-a.x;c.y=b.y-a.y;c.len=Math.sqrt(c.x*c.x+c.y*c.y);c.nx=c.x/c.len;c.ny=c.y/c.len;c.ang=Math.atan2(c.ny,c.nx)},Hq=Math.sqrt(.02),Ef={recalculateNodeLabelProjection:function(a){var b=a.pstyle("label").strValue;if(!Fe(b)){var c=a._private;var d=a.width();var f=a.height();
var h=a.padding(),l=a.position(),m=a.pstyle("text-halign").strValue,t=a.pstyle("text-valign").strValue;b=c.rscratch;c=c.rstyle;switch(m){case "left":d=l.x-d/2-h;break;case "right":d=l.x+d/2+h;break;default:d=l.x}switch(t){case "top":f=l.y-f/2-h;break;case "bottom":f=l.y+f/2+h;break;default:f=l.y}b.labelX=d;b.labelY=f;c.labelX=d;c.labelY=f;this.calculateLabelAngles(a);this.applyLabelDimensions(a)}}},ol=function(a,b){b=Math.atan(b/a);return 0===a&&0>b&&(b*=-1),b};Ef.recalculateEdgeLabelProjections=
function(a){var b=a._private,c=b.rscratch,d=this,f={mid:a.pstyle("label").strValue,source:a.pstyle("source-label").strValue,target:a.pstyle("target-label").strValue};if(f.mid||f.source||f.target){var h={x:c.midX,y:c.midY};var l=function(v,C,D){He(b.rscratch,v,C,D);He(b.rstyle,v,C,D)};l("labelX",null,h.x);l("labelY",null,h.y);var m=ol(c.midDispX,c.midDispY);l("labelAutoAngle",null,m);var t=function(){function v(ba,X,Y,ta,ja){var Ba=gf(X,Y),Ua=ba.segments[ba.segments.length-1];ba.segments.push({p0:X,
p1:Y,t0:ta,t1:ja,startDist:Ua?Ua.startDist+Ua.length:0,length:Ba});ba.length+=Ba}if(t.cache)return t.cache;for(var C=[],D=0;D+5<c.allpts.length;D+=4)C.push({p0:{x:c.allpts[D],y:c.allpts[D+1]},p1:{x:c.allpts[D+2],y:c.allpts[D+3]},p2:{x:c.allpts[D+4],y:c.allpts[D+5]},startDist:0,length:0,segments:[]});D=b.rstyle.bezierPts;for(var F=d.bezierProjPcts.length,I=0;I<C.length;I++){var K=C[I],P=C[I-1];P&&(K.startDist=P.startDist+P.length);v(K,K.p0,D[I*F],0,d.bezierProjPcts[0]);for(P=0;P<F-1;P++)v(K,D[I*F+
P],D[I*F+P+1],d.bezierProjPcts[P],d.bezierProjPcts[P+1]);v(K,D[I*F+F-1],K.p2,d.bezierProjPcts[F-1],1)}return t.cache=C};m=function(v){var C="source"===v;if(f[v]){var D=a.pstyle(v+"-text-offset").pfValue;switch(c.edgeType){case "self":case "compound":case "bezier":case "multibezier":for(var F=t(),I,K=0,P=0,ba=0;ba<F.length;ba++){var X=F[C?ba:F.length-1-ba];for(var Y=0;Y<X.segments.length;Y++){var ta=X.segments[C?Y:X.segments.length-1-Y],ja=ba===F.length-1&&Y===X.segments.length-1;if(K=P,P+=ta.length,
P>=D||ja){I={cp:X,segment:ta};break}}if(I)break}F=I.cp;I=I.segment;D=(D-K)/I.length;K=I.t1-I.t0;I=C?I.t0+K*D:I.t1-K*D;I=Ag(0,I,1);h=Wf(F.p0,F.p1,F.p2,I);C=F.p0;D=F.p1;K=F.p2;F=Ag(0,I-.001,1);I=Ag(0,I+.001,1);F=Wf(C,D,K,F);C=Wf(C,D,K,I);X=ol(C.x-F.x,C.y-F.y);break;case "straight":case "segments":case "haystack":I=0;X=c.allpts.length;for(Y=0;Y+3<X&&(C?(K={x:c.allpts[Y],y:c.allpts[Y+1]},F={x:c.allpts[Y+2],y:c.allpts[Y+3]}):(K={x:c.allpts[X-2-Y],y:c.allpts[X-1-Y]},F={x:c.allpts[X-4-Y],y:c.allpts[X-3-
Y]}),P=gf(K,F),ba=I,I+=P,!(I>=D));Y+=2);I=Ag(0,(D-ba)/P,1);C=K;D=F;P=void 0;ba=D.x-C.x;X=D.y-C.y;D=gf(C,D);h=(I=I??0,P=P??I*D,{x:C.x+ba/D*P,y:C.y+X/D*P});X=ol(F.x-K.x,F.y-K.y)}l("labelX",v,h.x);l("labelY",v,h.y);l("labelAutoAngle",v,X)}};m("source");m("target");this.applyLabelDimensions(a)}};Ef.applyLabelDimensions=function(a){this.applyPrefixedLabelDimensions(a);a.isEdge()&&(this.applyPrefixedLabelDimensions(a,"source"),this.applyPrefixedLabelDimensions(a,"target"))};Ef.applyPrefixedLabelDimensions=
function(a,b){var c=a._private,d=this.getLabelText(a,b),f=wf(d,a._private.labelDimsKey);if(Ed(c.rscratch,"prefixedLabelDimsKey",b)!==f){He(c.rscratch,"prefixedLabelDimsKey",b,f);d=this.calculateLabelDimensions(a,d);f=a.pstyle("line-height").pfValue;a=a.pstyle("text-wrap").strValue;var h=Ed(c.rscratch,"labelWrapCachedLines",b)||[],l="wrap"!==a?1:Math.max(h.length,1),m=d.height/l;a=m*f;h=d.width;d=d.height+(l-1)*(f-1)*m;He(c.rstyle,"labelWidth",b,h);He(c.rscratch,"labelWidth",b,h);He(c.rstyle,"labelHeight",
b,d);He(c.rscratch,"labelHeight",b,d);He(c.rscratch,"labelLineHeight",b,a)}};Ef.getLabelText=function(a,b){var c=a._private,d=a.pstyle((b?b+"-":"")+"label").strValue,f=a.pstyle("text-transform").value,h=function(ta,ja){return ja?(He(c.rscratch,ta,b,ja),ja):Ed(c.rscratch,ta,b)};if(!d)return"";"none"==f||("uppercase"==f?d=d.toUpperCase():"lowercase"==f&&(d=d.toLowerCase()));f=a.pstyle("text-wrap").value;if("wrap"===f){f=h("labelKey");if(null!=f&&h("labelWrapKey")===f)return h("labelWrapCachedText");
d=d.split("\n");for(var l=a.pstyle("text-max-width").pfValue,m="anywhere"===a.pstyle("text-overflow-wrap").value,t=[],v=/[\s\u200b]+|$/g,C=0;C<d.length;C++){var D=d[C],F=this.calculateLabelDimensions(a,D).width;m&&(D=D.split("").join("\u200b"));if(F>l){var I=D.matchAll(v);F="";var K=0;I=y(I);var P;try{for(I.s();!(P=I.n()).done;){var ba=P.value,X=ba[0],Y=D.substring(K,ba.index);K=ba.index+X.length;this.calculateLabelDimensions(a,0===F.length?Y:F+Y+X).width<=l?F+=Y+X:(F&&t.push(F),F=Y+X)}}catch(ta){I.e(ta)}finally{I.f()}F.match(/^[\s\u200b]+$/)||
t.push(F)}else t.push(D)}h("labelWrapCachedLines",t);d=h("labelWrapCachedText",t.join("\n"));h("labelWrapKey",f)}else if("ellipsis"===f){h=a.pstyle("text-max-width").pfValue;P="";ba=!1;if(this.calculateLabelDimensions(a,d).width<h)return d;for(X=0;X<d.length&&!(this.calculateLabelDimensions(a,P+d[X]+"\u2026").width>h);X++)P+=d[X],X===d.length-1&&(ba=!0);return ba||(P+="\u2026"),P}return d};Ef.getLabelJustification=function(a){var b=a.pstyle("text-justification").strValue,c=a.pstyle("text-halign").strValue;
if("auto"===b)if(a.isNode())switch(c){case "left":return"right";case "right":return"left";default:return"center"}else return"center";else return b};Ef.calculateLabelDimensions=function(a,b){var c=this.cy.window().document,d=a.pstyle("font-style").strValue,f=a.pstyle("font-size").pfValue,h=a.pstyle("font-family").strValue,l=a.pstyle("font-weight").strValue,m=this.labelCalcCanvas;a=this.labelCalcCanvasContext;m||(m=this.labelCalcCanvas=c.createElement("canvas"),a=this.labelCalcCanvasContext=m.getContext("2d"),
c=m.style,c.position="absolute",c.left="-9999px",c.top="-9999px",c.zIndex="-1",c.visibility="hidden",c.pointerEvents="none");a.font="".concat(d," ").concat(l," ").concat(f,"px ").concat(h);h=d=0;b=b.split("\n");for(c=0;c<b.length;c++)l=a.measureText(b[c]),m=f,d=Math.max(Math.ceil(l.width),d),h+=m;return d+=0,h+=0,{width:d,height:h}};Ef.calculateLabelAngle=function(a,b){var c=a._private.rscratch,d=a.isEdge();a=a.pstyle((b?b+"-":"")+"text-rotation");b=a.strValue;return"none"===b?0:d&&"autorotate"===
b?c.labelAutoAngle:"autorotate"===b?0:a.pfValue};Ef.calculateLabelAngles=function(a){var b=a.isEdge(),c=a._private.rscratch;c.labelAngle=this.calculateLabelAngle(a);b&&(c.sourceLabelAngle=this.calculateLabelAngle(a,"source"),c.targetLabelAngle=this.calculateLabelAngle(a,"target"))};var Wn={},Xn=!1;Wn.getNodeShape=function(a){var b=a.pstyle("shape").value;return"cutrectangle"===b&&(28>a.width()||28>a.height())?(Xn||(fd("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),
Xn=!0),"rectangle"):a.isParent()?"rectangle"===b||"roundrectangle"===b||"round-rectangle"===b||"cutrectangle"===b||"cut-rectangle"===b||"barrel"===b?b:"rectangle":"polygon"===b?(a=a.pstyle("shape-polygon-points").value,this.nodeShapes.makePolygon(a).name):b};var Yn={};[{projectIntoViewport:function(a,b){var c=this.cy,d=this.findContainerClientCoords(),f=d[0],h=d[1];d=d[4];var l=c.pan();c=c.zoom();return[((a-f)/d-l.x)/c,((b-h)/d-l.y)/c]},findContainerClientCoords:function(){if(this.containerBB)return this.containerBB;
var a=this.container,b=a.getBoundingClientRect(),c=this.cy.window().getComputedStyle(a),d=function(D){return parseFloat(c.getPropertyValue(D))},f=d("padding-left"),h=d("padding-right"),l=d("padding-top"),m=d("padding-bottom"),t=d("border-left-width"),v=d("border-right-width"),C=d("border-top-width");d("border-bottom-width");d=a.clientWidth;return this.containerBB=[b.left+f+t,b.top+l+C,d-(f+h),a.clientHeight-(l+m),b.width/(d+(t+v))]},invalidateContainerClientCoordsCache:function(){this.containerBB=
null},findNearestElement:function(a,b,c,d){return this.findNearestElements(a,b,c,d)[0]},findNearestElements:function(a,b,c,d){function f(ja,Ba){if(ja.isNode()){if(ta)return;ta=ja;D.push(ja)}if(ja.isEdge()&&(null==Ba||Ba<X))if(Y){if(Y.pstyle("z-compound-depth").value===ja.pstyle("z-compound-depth").value&&Y.pstyle("z-compound-depth").value===ja.pstyle("z-compound-depth").value)for(var Ua=0;Ua<D.length;Ua++)if(D[Ua].isEdge()){Y=D[Ua]=ja;X=Ba??X;break}}else D.push(ja),Y=ja,X=Ba??X}function h(ja){var Ba=
ja.outerWidth()+2*P,Ua=ja.outerHeight()+2*P,ab=Ba/2,Qb=Ua/2,Mb=ja.position(),Ub="auto"===ja.pstyle("corner-radius").value?"auto":ja.pstyle("corner-radius").pfValue,Wb=ja._private.rscratch;if(Mb.x-ab<=a&&a<=Mb.x+ab&&Mb.y-Qb<=b&&b<=Mb.y+Qb&&v.nodeShapes[t.getNodeShape(ja)].checkPoint(a,b,0,Ba,Ua,Mb.x,Mb.y,Ub,Wb))return f(ja,0),!0}function l(ja){var Ba=ja._private,Ua=Ba.rscratch,ab=ja.pstyle("width").pfValue,Qb=ja.pstyle("arrow-scale").value,Mb=ab/2+K,Ub=Mb*Mb,Wb=2*Mb;Mb=Ba.source;var Yb=Ba.target;if("segments"===
Ua.edgeType||"straight"===Ua.edgeType||"haystack"===Ua.edgeType)for(var ub=Ua.allpts,Kb=0;Kb+3<ub.length;Kb+=2){var Zb=a,dc=b,ac=ub[Kb],vb=ub[Kb+1],Tb=ub[Kb+2],jc=ub[Kb+3],kc=Wb,tc=Math.max(ac,Tb),Xc=Math.min(vb,jc);vb=Math.max(vb,jc);if(Zb=Math.min(ac,Tb)-kc<=Zb&&Zb<=tc+kc&&Xc-kc<=dc&&dc<=vb+kc){var Ad=a;Zb=b;kc=ub[Kb];tc=ub[Kb+1];dc=ub[Kb+2];ac=ub[Kb+3];Tb=[Ad-kc,Zb-tc];Xc=[dc-kc,ac-tc];kc=Xc[0]*Xc[0]+Xc[1]*Xc[1];tc=Tb[0]*Tb[0]+Tb[1]*Tb[1];Tb=Tb[0]*Xc[0]+Tb[1]*Xc[1];Xc=Tb*Tb/kc;Zb=Ub>(Ad=0>Tb?tc:
Xc>kc?(Ad-dc)*(Ad-dc)+(Zb-ac)*(Zb-ac):tc-Xc)}if(Zb)return f(ja,Ad),!0}else if("bezier"===Ua.edgeType||"multibezier"===Ua.edgeType||"self"===Ua.edgeType||"compound"===Ua.edgeType)for(ub=Ua.allpts,Kb=0;Kb+5<Ua.allpts.length;Kb+=4){Zb=a;dc=b;ac=ub[Kb];vb=ub[Kb+1];Tb=ub[Kb+2];jc=ub[Kb+3];kc=ub[Kb+4];var Ac=ub[Kb+5];tc=Math.max(ac,kc,Tb)+Wb;Xc=Math.min(vb,Ac,jc)-Wb;vb=Math.max(vb,Ac,jc)+Wb;if(Zb=!(Zb<Math.min(ac,kc,Tb)-Wb||Zb>tc||dc<Xc||dc>vb)){var Pc,Sc;Ad=a;Zb=b;dc=ub[Kb];ac=ub[Kb+1];Tb=ub[Kb+2];kc=
ub[Kb+3];tc=ub[Kb+4];Xc=ub[Kb+5];vb=[];var pd=Sc=Pc=void 0;Ac=1*dc*dc-4*dc*Tb+2*dc*tc+4*Tb*Tb-4*Tb*tc+tc*tc+ac*ac-4*ac*kc+2*ac*Xc+4*kc*kc-4*kc*Xc+Xc*Xc;var Kd=9*dc*Tb-3*dc*dc-3*dc*tc-6*Tb*Tb+3*Tb*tc+9*ac*kc-3*ac*ac-3*ac*Xc-6*kc*kc+3*kc*Xc,de=3*dc*dc-6*dc*Tb+dc*tc-dc*Ad+2*Tb*Tb+2*Tb*Ad-tc*Ad+3*ac*ac-6*ac*kc+ac*Xc-ac*Zb+2*kc*kc+2*kc*Zb-Xc*Zb,ue=1*dc*Tb-dc*dc+dc*Ad-Tb*Ad+ac*kc-ac*ac+ac*Zb-kc*Zb;jc=vb;0===Ac&&(Ac=1E-5);Kd/=Ac;de/=Ac;ue/=Ac;(Sc=(3*de-Kd*Kd)/9,Pc=-(27*ue)+Kd*(9*de-2*Kd*Kd),Pc/=54,pd=Sc*
Sc*Sc+Pc*Pc,jc[1]=0,Ac=Kd/3,0<pd)?(Sc=Pc+Math.sqrt(pd),Sc=0>Sc?-Math.pow(-Sc,1/3):Math.pow(Sc,1/3),Pc-=Math.sqrt(pd),Pc=0>Pc?-Math.pow(-Pc,1/3):Math.pow(Pc,1/3),jc[0]=-Ac+Sc+Pc,Ac+=(Sc+Pc)/2,jc[4]=jc[2]=-Ac,Ac=Math.sqrt(3)*(-Pc+Sc)/2,jc[3]=Ac,jc[5]=-Ac):(jc[5]=jc[3]=0,0===pd)?(Pc=0>Pc?-Math.pow(-Pc,1/3):Math.pow(Pc,1/3),jc[0]=-Ac+2*Pc,jc[4]=jc[2]=-(Pc+Ac)):(Sc=-Sc,pd=Sc*Sc*Sc,pd=Math.acos(Pc/Math.sqrt(pd)),Pc=2*Math.sqrt(Sc),jc[0]=-Ac+Pc*Math.cos(pd/3),jc[2]=-Ac+Pc*Math.cos((pd+2*Math.PI)/3),jc[4]=
-Ac+Pc*Math.cos((pd+4*Math.PI)/3));jc=[];for(Ac=0;6>Ac;Ac+=2)1E-7>Math.abs(vb[Ac+1])&&0<=vb[Ac]&&1>=vb[Ac]&&jc.push(vb[Ac]);jc.push(1);jc.push(0);vb=-1;for(Ac=0;Ac<jc.length;Ac++)Sc=Math.pow(1-jc[Ac],2)*dc+2*(1-jc[Ac])*jc[Ac]*Tb+jc[Ac]*jc[Ac]*tc,Pc=Math.pow(1-jc[Ac],2)*ac+2*(1-jc[Ac])*jc[Ac]*kc+jc[Ac]*jc[Ac]*Xc,Pc=Math.pow(Sc-Ad,2)+Math.pow(Pc-Zb,2),0<=vb?Pc<vb&&(vb=Pc):vb=Pc;Zb=Ub>(Ad=vb)}if(Zb)return f(ja,Ad),!0}Mb=Mb||Ba.source;Yb=Yb||Ba.target;Ba=t.getArrowWidth(ab,Qb);Ua=[{name:"source",x:Ua.arrowStartX,
y:Ua.arrowStartY,angle:Ua.srcArrowAngle},{name:"target",x:Ua.arrowEndX,y:Ua.arrowEndY,angle:Ua.tgtArrowAngle},{name:"mid-source",x:Ua.midX,y:Ua.midY,angle:Ua.midsrcArrowAngle},{name:"mid-target",x:Ua.midX,y:Ua.midY,angle:Ua.midtgtArrowAngle}];for(Kb=0;Kb<Ua.length;Kb++)if(ab=Ua[Kb],Qb=v.arrowShapes[ja.pstyle(ab.name+"-arrow-shape").value],Ub=ja.pstyle("width").pfValue,Qb.roughCollide(a,b,Ba,ab.angle,{x:ab.x,y:ab.y},Ub,K)&&Qb.collide(a,b,Ba,ab.angle,{x:ab.x,y:ab.y},Ub,K))return f(ja),!0;I&&0<D.length&&
(h(Mb),h(Yb))}function m(ja,Ba){var Ua=ja._private,ab=ba,Qb;Ba?Qb=Ba+"-":Qb="";ja.boundingBox();var Mb=Ua.labelBounds[Ba||"main"],Ub=ja.pstyle(Qb+"label").value;if("yes"===ja.pstyle("text-events").strValue&&Ub){var Wb=Ed(Ua.rscratch,"labelX",Ba),Yb=Ed(Ua.rscratch,"labelY",Ba),ub=Ed(Ua.rscratch,"labelAngle",Ba);Ba=ja.pstyle(Qb+"text-margin-x").pfValue;Qb=ja.pstyle(Qb+"text-margin-y").pfValue;var Kb=Mb.x1-ab-Ba;Ua=Mb.x2+ab-Ba;Ub=Mb.y1-ab-Qb;ab=Mb.y2+ab-Qb;if(ub){var Zb=Math.cos(ub),dc=Math.sin(ub);
ub=function(ac,vb){return ac-=Wb,vb-=Yb,{x:ac*Zb-vb*dc+Wb,y:ac*dc+vb*Zb+Yb}};Mb=ub(Kb,Ub);Kb=ub(Kb,ab);Ub=ub(Ua,Ub);Ua=ub(Ua,ab);if(ie(a,b,[Mb.x+Ba,Mb.y+Qb,Ub.x+Ba,Ub.y+Qb,Ua.x+Ba,Ua.y+Qb,Kb.x+Ba,Kb.y+Qb]))return f(ja),!0}else if(Af(Mb,a,b))return f(ja),!0}}var t=this,v=this,C=v.getCachedZSortedEles(),D=[],F=v.cy.zoom(),I=v.cy.hasCompoundNodes(),K=(d?24:8)/F,P=(d?8:2)/F,ba=(d?8:2)/F,X=1/0,Y,ta;c&&(C=C.interactive);for(c=C.length-1;0<=c;c--)d=C[c],d.isNode()?h(d)||m(d):l(d)||m(d)||m(d,"source")||m(d,
"target");return D},getAllInBox:function(a,b,c,d){function f(C,D){var F=C._private,I=l;C.boundingBox();var K=F.labelBounds.main,P=Ed(F.rscratch,"labelX",D),ba=Ed(F.rscratch,"labelY",D);D=Ed(F.rscratch,"labelAngle",D);F=C.pstyle("text-margin-x").pfValue;var X=C.pstyle("text-margin-y").pfValue;C=K.x1-I-F;F=K.x2+I-F;var Y=K.y1-I-X;I=K.y2+I-X;if(D){var ta=Math.cos(D),ja=Math.sin(D);K=function(Ba,Ua){return Ba-=P,Ua-=ba,{x:Ba*ta-Ua*ja+P,y:Ba*ja+Ua*ta+ba}};return[K(C,Y),K(F,Y),K(F,I),K(C,I)]}return[{x:C,
y:Y},{x:F,y:Y},{x:F,y:I},{x:C,y:I}]}var h=this.getCachedZSortedEles().interactive,l=2/this.cy.zoom(),m=[],t=Math.max(a,c),v=Math.min(b,d);d=Math.max(b,d);a=Math.min(a,c);c=t;b=v;a=ae({x1:a,y1:b,x2:c,y2:d});for(b=0;b<h.length;b++)if(c=h[b],c.isNode())t="yes"===c.pstyle("text-events").strValue,v="yes"===c.pstyle("box-select-labels").strValue,t=c.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:v&&t}),zf(a,t)&&(t=f(c),qb(t,[{x:a.x1,y:a.y1},{x:a.x2,y:a.y1},{x:a.x2,y:a.y2},{x:a.x1,y:a.y2}])&&
m.push(c));else if(t=c._private,v=t.rscratch,(null==v.startX||null==v.startY||Af(a,v.startX,v.startY))&&(null==v.endX||null==v.endY||Af(a,v.endX,v.endY)))if("bezier"===v.edgeType||"multibezier"===v.edgeType||"self"===v.edgeType||"compound"===v.edgeType||"segments"===v.edgeType||"haystack"===v.edgeType){t=t.rstyle.bezierPts||t.rstyle.linePts||t.rstyle.haystackPts;v=!0;for(d=0;d<t.length;d++)if(!Vj(a,t[d])){v=!1;break}v&&m.push(c)}else"haystack"!==v.edgeType&&"straight"!==v.edgeType||m.push(c);return m}},
nl,{findMidptPtsEtc:function(a,b){var c=b.posPts,d=b.intersectionPts,f=b.vectorNormInverse,h=a.pstyle("source-endpoint");b=a.pstyle("target-endpoint");var l=null!=h.units&&null!=b.units;switch(a.pstyle("edge-distances").value){case "node-position":var m=c;break;case "intersection":m=d;break;case "endpoints":l?(c=this.manualEndptToPx(a.source()[0],h),d=z(c,2),c=d[0],d=d[1],a=this.manualEndptToPx(a.target()[0],b),a=z(a,2),b=a[0],f=a[1],a={x1:c,y1:d,x2:b,y2:f},d=f-d,b-=c,c=Math.sqrt(b*b+d*d),f={x:-d/
c,y:b/c},m=a):(fd("Edge ".concat(a.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),m=d)}return{midptPts:m,vectorNormInverse:f}},findHaystackPoints:function(a){for(var b=0;b<a.length;b++){var c=a[b],d=c._private,f=d.rscratch;if(!f.haystack){var h=2*Math.random()*Math.PI;f.source={x:Math.cos(h),y:Math.sin(h)};h=2*Math.random()*Math.PI;f.target={x:Math.cos(h),y:Math.sin(h)}}var l=
d.source,m=d.target;d=l.position();h=m.position();var t=l.width(),v=m.width();l=l.height();m=m.height();var C=c.pstyle("haystack-radius").value/2;f.haystackPts=f.allpts=[f.source.x*t*C+d.x,f.source.y*l*C+d.y,f.target.x*v*C+h.x,f.target.y*m*C+h.y];f.midX=(f.allpts[0]+f.allpts[2])/2;f.midY=(f.allpts[1]+f.allpts[3])/2;f.edgeType="haystack";f.haystack=!0;this.storeEdgeProjections(c);this.calculateArrowAngles(c);this.recalculateEdgeLabelProjections(c);this.calculateLabelAngles(c)}},findSegmentsPoints:function(a,
b){var c=a._private.rscratch,d=a.pstyle("segment-weights"),f=a.pstyle("segment-distances"),h=a.pstyle("segment-radii"),l=a.pstyle("radius-type"),m=Math.min(d.pfValue.length,f.pfValue.length),t=h.pfValue[h.pfValue.length-1],v=l.pfValue[l.pfValue.length-1];c.edgeType="segments";c.segpts=[];c.radii=[];c.isArcRadius=[];for(var C=0;C<m;C++){var D=d.pfValue[C],F=f.pfValue[C],I=1-D,K=this.findMidptPtsEtc(a,b),P=K.midptPts;K=K.vectorNormInverse;c.segpts.push(P.x1*I+P.x2*D+K.x*F,P.y1*I+P.y2*D+K.y*F);c.radii.push(void 0!==
h.pfValue[C]?h.pfValue[C]:t);c.isArcRadius.push("arc-radius"===(void 0!==l.pfValue[C]?l.pfValue[C]:v))}},findLoopPoints:function(a,b,c,d){c=a._private.rscratch;var f=b.dirCounts;b=b.srcPos;var h=a.pstyle("control-point-distances"),l=h?h.pfValue[0]:void 0;h=a.pstyle("loop-direction").pfValue;var m=a.pstyle("loop-sweep").pfValue;a=a.pstyle("control-point-step-size").pfValue;c.edgeType="self";d&&(a=l);l=h-Math.PI/2;d=l-m/2;l+=m/2;h=h+"_"+m;f=void 0===f[h]?f[h]=0:++f[h];c.ctrlpts=[b.x+1.4*Math.cos(d)*
a*(f/3+1),b.y+1.4*Math.sin(d)*a*(f/3+1),b.x+1.4*Math.cos(l)*a*(f/3+1),b.y+1.4*Math.sin(l)*a*(f/3+1)]},findCompoundLoopPoints:function(a,b,c,d){var f=a._private.rscratch;f.edgeType="compound";var h=b.srcPos,l=b.tgtPos,m=b.srcW,t=b.srcH,v=b.tgtW;b=b.tgtH;var C=a.pstyle("control-point-step-size").pfValue;a=(a=a.pstyle("control-point-distances"))?a.pfValue[0]:void 0;d&&(c=0,C=a);d=Math.min(h.x-m/2,l.x-v/2);h=Math.min(h.y-t/2,l.y-b/2);f.ctrlpts=[d,h-(1+Math.pow(50,1.12)/100)*C*(c/3+1)*Math.max(.5,Math.log(.01*
m)),d-(1+Math.pow(50,1.12)/100)*C*(c/3+1)*Math.max(.5,Math.log(.01*v)),h]},findStraightEdgePoints:function(a){a._private.rscratch.edgeType="straight"},findBezierPoints:function(a,b,c,d,f){var h=a._private.rscratch,l=a.pstyle("control-point-step-size").pfValue,m=a.pstyle("control-point-distances"),t=a.pstyle("control-point-weights"),v=m&&t?Math.min(m.value.length,t.value.length):1,C=m?m.pfValue[0]:void 0,D=t.value[0];h.edgeType=d?"multibezier":"bezier";h.ctrlpts=[];for(var F=0;F<v;F++){var I=(.5-b.eles.length/
2+c)*l*(f?-1:1),K=void 0,P=0<I?1:0>I?-1:0;d&&(C=m?m.pfValue[F]:l,D=t.value[F]);d?K=C:K=void 0!==C?P*C:void 0;I=void 0!==K?K:I;K=1-D;P=D;var ba=this.findMidptPtsEtc(a,b),X=ba.midptPts;ba=ba.vectorNormInverse;h.ctrlpts.push(X.x1*K+X.x2*P+ba.x*I,X.y1*K+X.y2*P+ba.y*I)}},findTaxiPoints:function(a,b){var c=a._private.rscratch;c.edgeType="segments";var d=b.posPts,f=b.srcW,h=b.srcH,l=b.tgtW;b=b.tgtH;var m="node-position"!==a.pstyle("edge-distances").value,t=a.pstyle("taxi-direction").value,v=t,C=a.pstyle("taxi-turn"),
D="%"===C.units,F=C.pfValue,I=0>F,K=a.pstyle("taxi-turn-min-distance").pfValue,P=m?(h+b)/2:0;C=d.x2-d.x1;var ba=d.y2-d.y1,X=function(Ba,Ua){return 0<Ba?Math.max(Ba-Ua,0):Math.min(Ba+Ua,0)},Y=X(C,m?(f+l)/2:0);P=X(ba,P);var ta=!1;"auto"===v?t=Math.abs(Y)>Math.abs(P)?"horizontal":"vertical":"upward"===v||"downward"===v?(t="vertical",ta=!0):("leftward"===v||"rightward"===v)&&(t="horizontal",ta=!0);var ja=(t="vertical"===t)?P:Y;Y=t?ba:C;P=0<Y?1:0>Y?-1:0;X=!1;(!ta||!D&&!I)&&("downward"===v&&0>Y||"upward"===
v&&0<Y||"leftward"===v&&0<Y||"rightward"===v&&0>Y)&&(P*=-1,ja=P*Math.abs(ja),X=!0);v=D?(0>F?1+F:F)*ja:(0>F?ja:0)+F*P;F=function(Ba){return Math.abs(Ba)<K||Math.abs(Ba)>=Math.abs(ja)};D=F(v);F=F(Math.abs(ja)-Math.abs(v));!D&&!F||X?t?(f=d.y1+v+(m?h/2*P:0),c.segpts=[d.x1,f,d.x2,f]):(f=d.x1+v+(m?f/2*P:0),c.segpts=[f,d.y1,f,d.y2]):t?(f=Math.abs(C)<=l/2,Math.abs(Y)<=h/2?(f=(d.x1+d.x2)/2,c.segpts=[f,d.y1,f,d.y2]):f?(f=(d.y1+d.y2)/2,c.segpts=[d.x1,f,d.x2,f]):c.segpts=[d.x1,d.y2]):(h=Math.abs(ba)<=b/2,Math.abs(Y)<=
f/2?(f=(d.y1+d.y2)/2,c.segpts=[d.x1,f,d.x2,f]):h?(f=(d.x1+d.x2)/2,c.segpts=[f,d.y1,f,d.y2]):c.segpts=[d.x2,d.y1]);c.isRound&&(d=a.pstyle("taxi-radius").value,a="arc-radius"===a.pstyle("radius-type").value[0],c.radii=Array(c.segpts.length/2).fill(d),c.isArcRadius=Array(c.segpts.length/2).fill(a))},tryToCorrectInvalidPoints:function(a,b){var c=a._private.rscratch;if("bezier"===c.edgeType){var d=b.srcPos,f=b.tgtPos,h=b.srcW,l=b.srcH,m=b.tgtW,t=b.tgtH,v=b.srcShape,C=b.tgtShape,D=b.srcCornerRadius,F=b.tgtCornerRadius,
I=b.srcRs,K=b.tgtRs,P=!cc(c.startX)||!cc(c.startY),ba=!cc(c.arrowStartX)||!cc(c.arrowStartY),X=!cc(c.endX)||!cc(c.endY),Y=!cc(c.arrowEndX)||!cc(c.arrowEndY);b=3*this.getArrowWidth(a.pstyle("width").pfValue,a.pstyle("arrow-scale").value)*this.arrowShapeWidth;var ta=gf({x:c.ctrlpts[0],y:c.ctrlpts[1]},{x:c.startX,y:c.startY}),ja=ta<b,Ba=gf({x:c.ctrlpts[0],y:c.ctrlpts[1]},{x:c.endX,y:c.endY}),Ua=Ba<b,ab=!1;if(P||ba||ja){ab=!0;P=c.ctrlpts[0]-d.x;ba=c.ctrlpts[1]-d.y;var Qb=Math.sqrt(P*P+ba*ba);P/=Qb;ba/=
Qb;Qb=Math.max(h,l);d=v.intersectLine(d.x,d.y,h,l,c.ctrlpts[0]+2*P*Qb,c.ctrlpts[1]+2*ba*Qb,0,D,I);ja?(c.ctrlpts[0]+=P*(b-ta),c.ctrlpts[1]+=ba*(b-ta)):(c.ctrlpts[0]=d[0]+P*b,c.ctrlpts[1]=d[1]+ba*b)}if(X||Y||Ua)ab=!0,d=c.ctrlpts[0]-f.x,v=c.ctrlpts[1]-f.y,D=Math.sqrt(d*d+v*v),d/=D,v/=D,h=Math.max(h,l),f=C.intersectLine(f.x,f.y,m,t,c.ctrlpts[0]+2*d*h,c.ctrlpts[1]+2*v*h,0,F,K),Ua?(c.ctrlpts[0]+=d*(b-Ba),c.ctrlpts[1]+=v*(b-Ba)):(c.ctrlpts[0]=f[0]+d*b,c.ctrlpts[1]=f[1]+v*b);ab&&this.findEndpoints(a)}},storeAllpts:function(a){a=
a._private.rscratch;if("multibezier"===a.edgeType||"bezier"===a.edgeType||"self"===a.edgeType||"compound"===a.edgeType){a.allpts=[];a.allpts.push(a.startX,a.startY);for(var b=0;b+1<a.ctrlpts.length;b+=2)a.allpts.push(a.ctrlpts[b],a.ctrlpts[b+1]),b+3<a.ctrlpts.length&&a.allpts.push((a.ctrlpts[b]+a.ctrlpts[b+2])/2,(a.ctrlpts[b+1]+a.ctrlpts[b+3])/2);a.allpts.push(a.endX,a.endY);var c;0===a.ctrlpts.length/2%2?(c=a.allpts.length/2-1,a.midX=a.allpts[c],a.midY=a.allpts[c+1]):(c=a.allpts.length/2-3,a.midX=
Jd(a.allpts[c],a.allpts[c+2],a.allpts[c+4],.5),a.midY=Jd(a.allpts[c+1],a.allpts[c+3],a.allpts[c+5],.5))}else if("straight"===a.edgeType)a.allpts=[a.startX,a.startY,a.endX,a.endY],a.midX=(a.startX+a.endX+a.arrowStartX+a.arrowEndX)/4,a.midY=(a.startY+a.endY+a.arrowStartY+a.arrowEndY)/4;else if("segments"===a.edgeType){if(a.allpts=[],a.allpts.push(a.startX,a.startY),a.allpts.push.apply(a.allpts,a.segpts),a.allpts.push(a.endX,a.endY),a.isRound)for(a.roundCorners=[],c=2;c+3<a.allpts.length;c+=2)b=a.radii[c/
2-1],a.roundCorners.push(O({x:a.allpts[c-2],y:a.allpts[c-1]},{x:a.allpts[c],y:a.allpts[c+1],radius:b},{x:a.allpts[c+2],y:a.allpts[c+3]},b,a.isArcRadius[c/2-1]));if(0===a.segpts.length%4)c=a.segpts.length/2,b=c-2,a.midX=(a.segpts[b]+a.segpts[c])/2,a.midY=(a.segpts[b+1]+a.segpts[c+1])/2;else{var d=a.segpts.length/2-1;if(a.isRound){c=a.segpts[d];b=a.segpts[d+1];var f=a.roundCorners[d/2];if(0===f.radius)f=a.segpts[d+2],d=a.segpts[d+3],a.midX=c,a.midY=b,a.midVector=[b-d,f-c];else{c=[c-f.cx,b-f.cy];var h=
f.radius/Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2));c=c.map(function(l){return l*h});a.midX=f.cx+c[0];a.midY=f.cy+c[1];a.midVector=c}}else a.midX=a.segpts[d],a.midY=a.segpts[d+1]}}},checkForInvalidEdgeWarning:function(a){var b=a[0]._private.rscratch;b.nodesOverlap||cc(b.startX)&&cc(b.startY)&&cc(b.endX)&&cc(b.endY)?b.loggedErr=!1:b.loggedErr||(b.loggedErr=!0,fd("Edge `"+a.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))},
findEdgeControlPoints:function(a){var b=this;if(a&&0!==a.length){for(var c=this,d=c.cy.hasCompoundNodes(),f=new Pe,h=function(ba,X){return[].concat(E(ba),[X?1:0]).join("-")},l=[],m=[],t=0;t<a.length;t++){var v=a[t],C=v._private,D=v.pstyle("curve-style").value;if(!v.removed()&&v.takesUpSpace())if("haystack"===D)m.push(v);else{var F="unbundled-bezier"===D||D.endsWith("segments")||"straight"===D||"straight-triangle"===D||D.endsWith("taxi");D="unbundled-bezier"===D||"bezier"===D;var I=C.target;C=C.source.poolIndex();
I=I.poolIndex();C=[C,I].sort();I=h(C,F);var K=f.get(I);null==K&&(K={eles:[]},l.push({pairId:C,edgeIsUnbundled:F}),f.set(I,K));K.eles.push(v);F&&(K.hasUnbundled=!0);D&&(K.hasBezier=!0)}}a=function(){var ba=l[P];ba=h(ba.pairId,ba.edgeIsUnbundled);var X=f.get(ba);X.hasUnbundled||(ba=X.eles[0].parallelEdges().filter(function(ue){return ue.isBundledBezier()}),bi(X.eles),ba.forEach(function(ue){return X.eles.push(ue)}),X.eles.sort(function(ue,Ng){return ue.poolIndex()-Ng.poolIndex()}));var Y=X.eles[0];
ba=Y.source();Y=Y.target();if(ba.poolIndex()>Y.poolIndex()){var ta=ba;ba=Y;Y=ta}ta=X.srcPos=ba.position();var ja=X.tgtPos=Y.position(),Ba=X.srcW=ba.outerWidth(),Ua=X.srcH=ba.outerHeight(),ab=X.tgtW=Y.outerWidth(),Qb=X.tgtH=Y.outerHeight(),Mb=X.srcShape=c.nodeShapes[b.getNodeShape(ba)],Ub=X.tgtShape=c.nodeShapes[b.getNodeShape(Y)],Wb=X.srcCornerRadius="auto"===ba.pstyle("corner-radius").value?"auto":ba.pstyle("corner-radius").pfValue,Yb=X.tgtCornerRadius="auto"===Y.pstyle("corner-radius").value?"auto":
Y.pstyle("corner-radius").pfValue,ub=X.tgtRs=Y._private.rscratch,Kb=X.srcRs=ba._private.rscratch;X.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var Zb=0;Zb<X.eles.length;Zb++){var dc=X.eles[Zb],ac=dc[0]._private.rscratch,vb=dc.pstyle("curve-style").value,Tb="unbundled-bezier"===vb||vb.endsWith("segments")||vb.endsWith("taxi"),jc=!ba.same(dc.source());if(!X.calculatedIntersection&&ba!==Y&&(X.hasBezier||X.hasUnbundled)){X.calculatedIntersection=!0;var kc=
Mb.intersectLine(ta.x,ta.y,Ba,Ua,ja.x,ja.y,0,Wb,Kb);var tc=X.srcIntn=kc,Xc=Ub.intersectLine(ja.x,ja.y,ab,Qb,ta.x,ta.y,0,Yb,ub),Ad=X.tgtIntn=Xc,Ac=X.intersectionPts={x1:kc[0],x2:Xc[0],y1:kc[1],y2:Xc[1]},Pc=X.posPts={x1:ta.x,x2:ja.x,y1:ta.y,y2:ja.y},Sc=Xc[1]-kc[1],pd=Xc[0]-kc[0],Kd=Math.sqrt(pd*pd+Sc*Sc);cc(Kd)&&Kd>=Hq||(Kd=Math.sqrt(Math.max(pd*pd,.01)+Math.max(Sc*Sc,.01)));Sc=X.vector={x:pd,y:Sc};pd=X.vectorNorm={x:Sc.x/Kd,y:Sc.y/Kd};var de={x:-pd.y,y:pd.x};X.nodesOverlap=!cc(Kd)||Ub.checkPoint(kc[0],
kc[1],0,ab,Qb,ja.x,ja.y,Yb,ub)||Mb.checkPoint(Xc[0],Xc[1],0,Ba,Ua,ta.x,ta.y,Wb,Kb);X.vectorNormInverse=de;kc={nodesOverlap:X.nodesOverlap,dirCounts:X.dirCounts,calculatedIntersection:!0,hasBezier:X.hasBezier,hasUnbundled:X.hasUnbundled,eles:X.eles,srcPos:ja,srcRs:ub,tgtPos:ta,tgtRs:Kb,srcW:ab,srcH:Qb,tgtW:Ba,tgtH:Ua,srcIntn:Ad,tgtIntn:tc,srcShape:Ub,tgtShape:Mb,posPts:{x1:Pc.x2,y1:Pc.y2,x2:Pc.x1,y2:Pc.y1},intersectionPts:{x1:Ac.x2,y1:Ac.y2,x2:Ac.x1,y2:Ac.y1},vector:{x:-Sc.x,y:-Sc.y},vectorNorm:{x:-pd.x,
y:-pd.y},vectorNormInverse:{x:-de.x,y:-de.y}}}tc=jc?kc:X;ac.nodesOverlap=tc.nodesOverlap;ac.srcIntn=tc.srcIntn;ac.tgtIntn=tc.tgtIntn;ac.isRound=vb.startsWith("round");d&&(ba.isParent()||ba.isChild()||Y.isParent()||Y.isChild())&&(ba.parents().anySame(Y)||Y.parents().anySame(ba)||ba.same(Y)&&ba.isParent())?b.findCompoundLoopPoints(dc,tc,Zb,Tb):ba===Y?b.findLoopPoints(dc,tc,Zb,Tb):vb.endsWith("segments")?b.findSegmentsPoints(dc,tc):vb.endsWith("taxi")?b.findTaxiPoints(dc,tc):"straight"===vb||!Tb&&1===
X.eles.length%2&&Zb===Math.floor(X.eles.length/2)?b.findStraightEdgePoints(dc):b.findBezierPoints(dc,tc,Zb,Tb,jc);b.findEndpoints(dc);b.tryToCorrectInvalidPoints(dc,tc);b.checkForInvalidEdgeWarning(dc);b.storeAllpts(dc);b.storeEdgeProjections(dc);b.calculateArrowAngles(dc);b.recalculateEdgeLabelProjections(dc);b.calculateLabelAngles(dc)}};for(var P=0;P<l.length;P++)a();this.findHaystackPoints(m)}},getSegmentPoints:function(a){var b=a[0]._private.rscratch;this.recalculateRenderedStyle(a);if("segments"===
b.edgeType)return ia(b.segpts)},getControlPoints:function(a){var b=a[0]._private.rscratch;this.recalculateRenderedStyle(a);a=b.edgeType;if("bezier"===a||"multibezier"===a||"self"===a||"compound"===a)return ia(b.ctrlpts)},getEdgeMidpoint:function(a){var b=a[0]._private.rscratch;return this.recalculateRenderedStyle(a),{x:b.midX,y:b.midY}}},{manualEndptToPx:function(a,b){var c=a.position(),d=a.outerWidth(),f=a.outerHeight(),h=a._private.rscratch;if(2===b.value.length)return a=[b.pfValue[0],b.pfValue[1]],
"%"===b.units[0]&&(a[0]*=d),"%"===b.units[1]&&(a[1]*=f),a[0]+=c.x,a[1]+=c.y,a;b=b.pfValue[0];b=-Math.PI/2+b;var l=2*Math.max(d,f);b=[c.x+Math.cos(b)*l,c.y+Math.sin(b)*l];return this.nodeShapes[this.getNodeShape(a)].intersectLine(c.x,c.y,d,f,b[0],b[1],0,"auto"===a.pstyle("corner-radius").value?"auto":a.pstyle("corner-radius").pfValue,h)},findEndpoints:function(a){var b=a.source()[0],c=a.target()[0],d=b.position(),f=c.position(),h=a.pstyle("target-arrow-shape").value,l=a.pstyle("source-arrow-shape").value,
m=a.pstyle("target-distance-from-node").pfValue,t=a.pstyle("source-distance-from-node").pfValue,v=b._private.rscratch,C=c._private.rscratch,D=a.pstyle("curve-style").value,F=a._private.rscratch,I=F.edgeType,K="self"===I||"compound"===I,P="bezier"===I||"multibezier"===I||K;var ba="bezier"!==I;var X="straight"===I||"segments"===I,Y="segments"===I;I=P||ba||X;var ta=K||"taxi"===D;D=a.pstyle("source-endpoint");K=ta?"outside-to-node":D.value;var ja="auto"===b.pstyle("corner-radius").value?"auto":b.pstyle("corner-radius").pfValue,
Ba=a.pstyle("target-endpoint");ta=ta?"outside-to-node":Ba.value;var Ua="auto"===c.pstyle("corner-radius").value?"auto":c.pstyle("corner-radius").pfValue;F.srcManEndpt=D;F.tgtManEndpt=Ba;var ab,Qb;if(P){var Mb=[F.ctrlpts[0],F.ctrlpts[1]];var Ub=ba?[F.ctrlpts[F.ctrlpts.length-2],F.ctrlpts[F.ctrlpts.length-1]]:Mb}else X&&(Mb=Y?F.segpts.slice(0,2):[f.x,f.y],Ub=Y?F.segpts.slice(F.segpts.length-2):[d.x,d.y]);if("inside-to-node"===ta)ba=[f.x,f.y];else if(Ba.units)ba=this.manualEndptToPx(c,Ba);else if("outside-to-line"===
ta)ba=F.tgtIntn;else if("outside-to-node"===ta||"outside-to-node-or-label"===ta?ab=Ub:("outside-to-line"===ta||"outside-to-line-or-label"===ta)&&(ab=[d.x,d.y]),ba=this.nodeShapes[this.getNodeShape(c)].intersectLine(f.x,f.y,c.outerWidth(),c.outerHeight(),ab[0],ab[1],0,Ua,C),"outside-to-node-or-label"===ta||"outside-to-line-or-label"===ta)Y=c._private.rscratch,C=Y.labelX,P=Y.labelY,X=Y.labelWidth/2,Y=Y.labelHeight/2,Ba=c.pstyle("text-valign").value,"top"===Ba?P-=Y:"bottom"===Ba&&(P+=Y),c=c.pstyle("text-halign").value,
"left"===c?C-=X:"right"===c&&(C+=X),ab=Eg(ab[0],ab[1],[C-X,P-Y,C+X,P-Y,C+X,P+Y,C-X,P+Y],f.x,f.y),0<ab.length&&(c=yf(d,Vf(ba)),C=yf(d,Vf(ab)),P=c,(C<c&&(ba=ab,P=C),2<ab.length)&&yf(d,{x:ab[2],y:ab[3]})<P&&(ba=[ab[2],ab[3]]));ab=Mf(ba,Ub,this.arrowShapes[h].spacing(a)+m);ba=Mf(ba,Ub,this.arrowShapes[h].gap(a)+m);if(F.endX=ba[0],F.endY=ba[1],F.arrowEndX=ab[0],F.arrowEndY=ab[1],"inside-to-node"===K)ba=[d.x,d.y];else if(D.units)ba=this.manualEndptToPx(b,D);else if("outside-to-line"===K)ba=F.srcIntn;else if("outside-to-node"===
K||"outside-to-node-or-label"===K?Qb=Mb:("outside-to-line"===K||"outside-to-line-or-label"===K)&&(Qb=[f.x,f.y]),ba=this.nodeShapes[this.getNodeShape(b)].intersectLine(d.x,d.y,b.outerWidth(),b.outerHeight(),Qb[0],Qb[1],0,ja,v),"outside-to-node-or-label"===K||"outside-to-line-or-label"===K)Ub=b._private.rscratch,v=Ub.labelX,h=Ub.labelY,m=Ub.labelWidth/2,Ub=Ub.labelHeight/2,D=b.pstyle("text-valign").value,"top"===D?h-=Ub:"bottom"===D&&(h+=Ub),b=b.pstyle("text-halign").value,"left"===b?v-=m:"right"===
b&&(v+=m),d=Eg(Qb[0],Qb[1],[v-m,h-Ub,v+m,h-Ub,v+m,h+Ub,v-m,h+Ub],d.x,d.y),0<d.length&&(Qb=yf(f,Vf(ba)),b=yf(f,Vf(d)),v=Qb,(b<Qb&&(ba=[d[0],d[1]],v=b),2<d.length)&&yf(f,{x:d[2],y:d[3]})<v&&(ba=[d[2],d[3]]));f=Mf(ba,Mb,this.arrowShapes[l].spacing(a)+t);a=Mf(ba,Mb,this.arrowShapes[l].gap(a)+t);F.startX=a[0];F.startY=a[1];F.arrowStartX=f[0];F.arrowStartY=f[1];I&&(cc(F.startX)&&cc(F.startY)&&cc(F.endX)&&cc(F.endY)?F.badLine=!1:F.badLine=!0)},getSourceEndpoint:function(a){var b=a[0]._private.rscratch;switch(this.recalculateRenderedStyle(a),
b.edgeType){case "haystack":return{x:b.haystackPts[0],y:b.haystackPts[1]};default:return{x:b.arrowStartX,y:b.arrowStartY}}},getTargetEndpoint:function(a){var b=a[0]._private.rscratch;switch(this.recalculateRenderedStyle(a),b.edgeType){case "haystack":return{x:b.haystackPts[2],y:b.haystackPts[3]};default:return{x:b.arrowEndX,y:b.arrowEndY}}}},{storeEdgeProjections:function(a){var b=a._private,c=b.rscratch,d=c.edgeType;if(b.rstyle.bezierPts=null,b.rstyle.linePts=null,b.rstyle.haystackPts=null,"multibezier"===
d||"bezier"===d||"self"===d||"compound"===d)for(b.rstyle.bezierPts=[],d=0;d+5<c.allpts.length;d+=4){var f=a,h=c.allpts.slice(d,d+6);f=f._private.rstyle.bezierPts;for(var l=0;l<this.bezierProjPcts.length;l++){var m=this.bezierProjPcts[l];f.push({x:Jd(h[0],h[2],h[4],m),y:Jd(h[1],h[3],h[5],m)})}}else if("segments"===d)for(h=b.rstyle.linePts=[],d=0;d+1<c.allpts.length;d+=2)h.push({x:c.allpts[d],y:c.allpts[d+1]});else"haystack"===d&&(c=c.haystackPts,b.rstyle.haystackPts=[{x:c[0],y:c[1]},{x:c[2],y:c[3]}]);
b.rstyle.arrowWidth=this.getArrowWidth(a.pstyle("width").pfValue,a.pstyle("arrow-scale").value)*this.arrowShapeWidth},recalculateEdgeProjections:function(a){this.findEdgeControlPoints(a)}},Ef,Wn,{registerCalculationListeners:function(){var a=this.cy,b=a.collection(),c=this,d=function(h){var l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0;if(b.merge(h),l)for(l=0;l<h.length;l++){var m=h[l]._private.rstyle;m.clean=!1;m.cleanConnected=!1}};c.binder(a).on("bounds.* dirty.*",function(h){d(h.target)}).on("style.* background.*",
function(h){d(h.target,!1)});var f=function(h){if(h){var l=c.onUpdateEleCalcsFns;b.cleanStyle();for(var m=0;m<b.length;m++){var t=b[m],v=t._private.rstyle;t.isNode()&&!v.cleanConnected&&(d(t.connectedEdges()),v.cleanConnected=!0)}if(l)for(m=0;m<l.length;m++)(0,l[m])(h,b);c.recalculateRenderedStyle(b);b=a.collection()}};c.flushRenderedStyleQueue=function(){f(!0)};c.beforeRender(f,c.beforeRenderPriorities.eleCalcs)},onUpdateEleCalcs:function(a){(this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[]).push(a)},
recalculateRenderedStyle:function(a,b){if(0!==a.length){var c=[],d=[];if(!this.destroyed){void 0===b&&(b=!0);for(var f=0;f<a.length;f++){var h=a[f],l=h._private,m=l.rstyle;!h.isEdge()||h.source()._private.rstyle.cleanConnected&&h.target()._private.rstyle.cleanConnected||(m.clean=!1);h.isEdge()&&h.isBundledBezier()&&h.parallelEdges().some(function(t){return!t._private.rstyle.clean&&t.isBundledBezier()})&&(m.clean=!1);!(b&&m.clean||h.removed())&&"none"!==h.pstyle("display").value&&("nodes"===l.group?
d.push(h):c.push(h),m.clean=!0)}for(a=0;a<d.length;a++)b=d[a],f=b._private.rstyle,h=b.position(),this.recalculateNodeLabelProjection(b),f.nodeX=h.x,f.nodeY=h.y,f.nodeW=b.pstyle("width").pfValue,f.nodeH=b.pstyle("height").pfValue;this.recalculateEdgeProjections(c);for(d=0;d<c.length;d++)b=c[d]._private,a=b.rstyle,b=b.rscratch,a.srcX=b.arrowStartX,a.srcY=b.arrowStartY,a.tgtX=b.arrowEndX,a.tgtY=b.arrowEndY,a.midX=b.midX,a.midY=b.midY,a.labelAngle=b.labelAngle,a.sourceLabelAngle=b.sourceLabelAngle,a.targetLabelAngle=
b.targetLabelAngle}}}},{updateCachedGrabbedEles:function(){var a=this.cachedZSortedEles;if(a){a.drag=[];a.nondrag=[];for(var b=[],c=0;c<a.length;c++){var d=a[c],f=d._private.rscratch;d.grabbed()&&!d.isParent()?b.push(d):f.inDragLayer?a.drag.push(d):a.nondrag.push(d)}for(c=0;c<b.length;c++)d=b[c],a.drag.push(d)}},invalidateCachedZSortedEles:function(){this.cachedZSortedEles=null},getCachedZSortedEles:function(a){a||!this.cachedZSortedEles?(a=this.cy.mutableElements().toArray(),a.sort(Kn),a.interactive=
a.filter(function(b){return b.interactive()}),this.cachedZSortedEles=a,this.updateCachedGrabbedEles()):a=this.cachedZSortedEles;return a}}].forEach(function(a){Bc(Yn,a)});var Zn={timeToRender:function(){return this.redrawTotalTime/this.redrawCount},redraw:function(a){a=a||Ji;void 0===this.averageRedrawTime&&(this.averageRedrawTime=0);void 0===this.lastRedrawTime&&(this.lastRedrawTime=0);void 0===this.lastDrawTime&&(this.lastDrawTime=0);this.requestedFrame=!0;this.renderOptions=a},beforeRender:function(a,
b){if(!this.destroyed){null==b&&vd("Priority is not optional for beforeRender");var c=this.beforeRenderCallbacks;c.push({fn:a,priority:b});c.sort(function(d,f){return f.priority-d.priority})}}},$n=function(a,b,c){a=a.beforeRenderCallbacks;for(var d=0;d<a.length;d++)a[d].fn(b,c)};Zn.startRenderLoop=function(){var a=this,b=a.cy;if(!a.renderLoopStarted){a.renderLoopStarted=!0;var c=function(d){if(!a.destroyed){if(!b.batching())if(a.requestedFrame&&!a.skipFrame){$n(a,!0,d);d=Be();a.render(a.renderOptions);
var f=a.lastDrawTime=Be();void 0===a.averageRedrawTime&&(a.averageRedrawTime=f-d);void 0===a.redrawCount&&(a.redrawCount=0);a.redrawCount++;void 0===a.redrawTotalTime&&(a.redrawTotalTime=0);d=f-d;a.redrawTotalTime+=d;a.lastRedrawTime=d;a.averageRedrawTime=a.averageRedrawTime/2+d/2;a.requestedFrame=!1}else $n(a,!1,d);a.skipFrame=!1;te(c)}};te(c)}};var ao=function(a){this.init(a)},Eh=ao.prototype;Eh.clientFunctions="redrawHint render renderTo matchCanvasSize nodeShapeImpl arrowShapeImpl".split(" ");
Eh.init=function(a){this.options=a;this.cy=a.cy;var b=this.container=a.cy.container(),c=this.cy.window();if(c){var d=c.document,f=d.head,h=null!=d.getElementById("__________cytoscape_stylesheet");(0>b.className.indexOf("__________cytoscape_container")&&(b.className=(b.className||"")+" __________cytoscape_container"),h)||(d=d.createElement("style"),d.id="__________cytoscape_stylesheet",d.textContent=".__________cytoscape_container { position: relative; }",f.insertBefore(d,f.children[0]));"static"===
c.getComputedStyle(b).getPropertyValue("position")&&fd("A Cytoscape container has style position:static and so can not use UI extensions properly")}this.selection=[void 0,void 0,void 0,void 0,0];this.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95];this.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1};this.dragData={possibleDragElements:[]};this.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,
singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]};this.redraws=0;this.showFps=a.showFps;this.debug=a.debug;this.webgl=a.webgl;this.hideEdgesOnViewport=a.hideEdgesOnViewport;this.textureOnViewport=a.textureOnViewport;this.wheelSensitivity=a.wheelSensitivity;this.motionBlurEnabled=a.motionBlur;this.forcedPixelRatio=cc(a.pixelRatio)?a.pixelRatio:null;this.motionBlur=a.motionBlur;this.motionBlurOpacity=a.motionBlurOpacity;this.motionBlurTransparency=1-this.motionBlurOpacity;
this.mbPxRBlurry=this.motionBlurPxRatio=1;this.minMbLowQualFrames=4;this.fullQualityMb=!1;this.clearedForMotionBlur=[];this.desktopTapThreshold=a.desktopTapThreshold;this.desktopTapThreshold2=a.desktopTapThreshold*a.desktopTapThreshold;this.touchTapThreshold=a.touchTapThreshold;this.touchTapThreshold2=a.touchTapThreshold*a.touchTapThreshold;this.tapholdDuration=500;this.bindings=[];this.beforeRenderCallbacks=[];this.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100};
this.registerNodeShapes();this.registerArrowShapes();this.registerCalculationListeners()};Eh.notify=function(a,b){b=this.cy;this.destroyed||("init"===a?this.load():"destroy"===a?this.destroy():(("add"===a||"remove"===a||"move"===a&&b.hasCompoundNodes()||"load"===a||"zorder"===a||"mount"===a)&&this.invalidateCachedZSortedEles(),"viewport"===a&&this.redrawHint("select",!0),"gc"===a&&this.redrawHint("gc",!0),"load"!==a&&"resize"!==a&&"mount"!==a||(this.invalidateContainerClientCoordsCache(),this.matchCanvasSize(this.container)),
this.redrawHint("eles",!0),this.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()))};Eh.destroy=function(){this.destroyed=!0;this.cy.stopAnimationLoop();for(var a=0;a<this.bindings.length;a++){var b=this.bindings[a],c=b.target;(c.off||c.removeEventListener).apply(c,b.args)}if(this.bindings=[],this.beforeRenderCallbacks=[],this.onUpdateEleCalcsFns=[],this.removeObserver&&this.removeObserver.disconnect(),this.styleObserver&&this.styleObserver.disconnect(),this.resizeObserver&&this.resizeObserver.disconnect(),
this.labelCalcDiv)try{document.body.removeChild(this.labelCalcDiv)}catch{}};Eh.isHeadless=function(){return!1};[{arrowShapeWidth:.3,registerArrowShapes:function(){var a=this.arrowShapes={},b=this,c=function(t,v,C,D,F,I,K){D=F.x+C/2+K;I=F.y-C/2-K;var P=F.y+C/2+K;return F.x-C/2-K<=t&&t<=D&&I<=v&&v<=P},d=function(t,v,C,D,F){return{x:(t*Math.cos(D)-v*Math.sin(D))*C+F.x,y:(t*Math.sin(D)+v*Math.cos(D))*C+F.y}},f=function(t,v,C,D){for(var F=[],I=0;I<t.length;I+=2)F.push(d(t[I],t[I+1],v,C,D));return F},h=
function(t){for(var v=[],C=0;C<t.length;C++){var D=t[C];v.push(D.x,D.y)}return v},l=function(t){return t.pstyle("width").pfValue*t.pstyle("arrow-scale").pfValue*2},m=function(t,v){rc(v)&&(v=a[v]);a[t]=Bc({name:t,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(C,D,F,I,K,P){F=h(f(this.points,F+2*P,I,K));return ie(C,D,F)},roughCollide:c,draw:function(C,D,F,I){D=f(this.points,D,F,I);b.arrowShapeImpl("polygon")(C,D)},spacing:function(C){return 0},gap:l},v)};m("none",{collide:qh,roughCollide:qh,
draw:wg,spacing:vg,gap:vg});m("triangle",{points:[-.15,-.3,0,0,.15,-.3]});m("arrow","triangle");m("triangle-backcurve",{points:a.triangle.points,controlPoint:[0,-.15],roughCollide:c,draw:function(t,v,C,D,F){F=f(this.points,v,C,D);var I=this.controlPoint;v=d(I[0],I[1],v,C,D);b.arrowShapeImpl(this.name)(t,F,v)},gap:function(t){return.8*l(t)}});m("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(t,v,C,D,F,I,K){I=h(f(this.points,C+2*K,D,F));
C=h(f(this.pointsTee,C+2*K,D,F));return ie(t,v,I)||ie(t,v,C)},draw:function(t,v,C,D,F){F=f(this.points,v,C,D);v=f(this.pointsTee,v,C,D);b.arrowShapeImpl(this.name)(t,F,v)}});m("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(t,v,C,D,F,I,K){I=Math.pow(F.x-t,2)+Math.pow(F.y-v,2)<=Math.pow((C+2*K)*this.radius,2);C=h(f(this.points,C+2*K,D,F));return ie(t,v,C)||I},draw:function(t,v,C,D,F){C=f(this.pointsTr,v,C,D);b.arrowShapeImpl(this.name)(t,C,D.x,D.y,this.radius*
v)},spacing:function(t){return b.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.radius}});m("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(t,v){var C=this.baseCrossLinePts.slice();t=v/t;return C[3]-=t,C[5]-=t,C},collide:function(t,v,C,D,F,I,K){var P=h(f(this.points,C+2*K,D,F));C=h(f(this.crossLinePts(C,I),C+2*K,D,F));return ie(t,v,P)||ie(t,v,C)},draw:function(t,v,C,D,F){var I=f(this.points,
v,C,D);v=f(this.crossLinePts(v,F),v,C,D);b.arrowShapeImpl(this.name)(t,I,v)}});m("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(t){return.525*l(t)}});m("circle",{radius:.15,collide:function(t,v,C,D,F,I,K){return Math.pow(F.x-t,2)+Math.pow(F.y-v,2)<=Math.pow((C+2*K)*this.radius,2)},draw:function(t,v,C,D,F){b.arrowShapeImpl(this.name)(t,D.x,D.y,this.radius*v)},spacing:function(t){return b.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.radius}});m("tee",{points:[-.15,
0,-.15,-.1,.15,-.1,.15,0],spacing:function(t){return 1},gap:function(t){return 1}});m("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]});m("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(t){return t.pstyle("width").pfValue*t.pstyle("arrow-scale").value}});m("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(t){return.95*t.pstyle("width").pfValue*t.pstyle("arrow-scale").value}})}},Yn,{getCachedImage:function(a,b,c){var d=this.imageCache=this.imageCache||{},f=
d[a];if(f)return f.image.complete||f.image.addEventListener("load",c),f.image;f=d[a]=d[a]||{};var h=f.image=new Image;h.addEventListener("load",c);h.addEventListener("error",function(){h.error=!0});return"data:"===a.substring(0,5).toLowerCase()||(b="null"===b?null:b,h.crossOrigin=b),h.src=a,h}},{registerBinding:function(a,b,c,d){var f=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(a)){for(var h=[],l=0;l<a.length;l++){var m=a[l];void 0!==m&&(m=this.binder(m),h.push(m.on.apply(m,f)))}return h}m=
this.binder(a);return m.on.apply(m,f)},binder:function(a){var b=this,c=b.cy.window(),d=a===c||a===c.document||a===c.document.body||("u"<typeof HTMLElement?!1:a instanceof HTMLElement);if(null==b.supportsPassiveEvents){var f=!1;try{var h=Object.defineProperty({},"passive",{get:function(){return f=!0,!0}});c.addEventListener("test",null,h)}catch{}b.supportsPassiveEvents=f}c=function(l,m,t){var v=Array.prototype.slice.call(arguments);return d&&b.supportsPassiveEvents&&(v[2]={capture:t??!1,passive:!1,
once:!1}),b.bindings.push({target:a,args:v}),(a.addEventListener||a.on).apply(a,v),this};return{on:c,addEventListener:c,addListener:c,bind:c}},nodeIsDraggable:function(a){return a&&a.isNode()&&!a.locked()&&a.grabbable()},nodeIsGrabbable:function(a){return this.nodeIsDraggable(a)&&a.interactive()},load:function(){var a=this,b=a.cy.window(),c=function(la){return la.selected()},d=function(la,Xa,ob,wb){null==la&&(la=a.cy);for(var lb=0;lb<Xa.length;lb++)la.emit({originalEvent:ob,type:Xa[lb],position:wb})},
f=function(la,Xa){var ob=!0;if(a.cy.hasCompoundNodes()&&la&&la.pannable())for(var wb=0;Xa&&wb<Xa.length;wb++){if(la=Xa[wb],la.isNode()&&la.isParent()&&!la.pannable()){ob=!1;break}}else ob=!0;return ob},h=function(la){la[0]._private.rscratch.inDragLayer=!0},l=function(la,Xa){Xa=Xa.addToList;Xa.has(la)||!la.grabbable()||la.locked()||(Xa.merge(la),la[0]._private.grabbed=!0)},m=function(la,Xa){!la.cy().hasCompoundNodes()||null==Xa.inDragLayer&&null==Xa.addToList||(la=la.descendants(),Xa.inDragLayer&&
(la.forEach(h),la.connectedEdges().forEach(h)),Xa.addToList&&l(la,Xa))},t=function(la,Xa){Xa=Xa||{};var ob=la.cy().hasCompoundNodes();Xa.inDragLayer&&(la.forEach(h),la.neighborhood().stdFilter(function(wb){return!ob||wb.isEdge()}).forEach(h));Xa.addToList&&la.forEach(function(wb){l(wb,Xa)});m(la,Xa);C(la,{inDragLayer:Xa.inDragLayer});a.updateCachedGrabbedEles()},v=function(la){la&&(a.getCachedZSortedEles().forEach(function(Xa){Xa[0]._private.grabbed=!1;Xa[0]._private.rscratch.inDragLayer=!1;Xa[0]._private.rscratch.isGrabTarget=
!1}),a.updateCachedGrabbedEles())},C=function(la,Xa){if((null!=Xa.inDragLayer||null!=Xa.addToList)&&la.cy().hasCompoundNodes()){var ob=la.ancestors().orphans();ob.same(la)||(la=ob.descendants().spawnSelf().merge(ob).unmerge(la).unmerge(la.descendants()),ob=la.connectedEdges(),Xa.inDragLayer&&(ob.forEach(h),la.forEach(h)),Xa.addToList&&la.forEach(function(wb){l(wb,Xa)}))}},D=function(){null!=document.activeElement&&null!=document.activeElement.blur&&document.activeElement.blur()},F="u">typeof MutationObserver,
I="u">typeof ResizeObserver;F?(a.removeObserver=new MutationObserver(function(la){for(var Xa=0;Xa<la.length;Xa++){var ob=la[Xa].removedNodes;if(ob)for(var wb=0;wb<ob.length;wb++)if(ob[wb]===a.container){a.destroy();break}}}),a.container.parentNode&&a.removeObserver.observe(a.container.parentNode,{childList:!0})):a.registerBinding(a.container,"DOMNodeRemoved",function(la){a.destroy()});var K=ne(function(){a.cy.resize()},100);F&&(a.styleObserver=new MutationObserver(K),a.styleObserver.observe(a.container,
{attributes:!0}));a.registerBinding(b,"resize",K);I&&(a.resizeObserver=new ResizeObserver(K),a.resizeObserver.observe(a.container));var P=function(){a.invalidateContainerClientCoordsCache()};(function(la,Xa){for(;null!=la;)Xa(la),la=la.parentNode})(a.container,function(la){a.registerBinding(la,"transitionend",P);a.registerBinding(la,"animationend",P);a.registerBinding(la,"scroll",P)});a.registerBinding(a.container,"contextmenu",function(la){la.preventDefault()});var ba=function(la){var Xa=a.findContainerClientCoords(),
ob=Xa[0],wb=Xa[1],lb=Xa[2];Xa=Xa[3];for(var Vb=la.touches?la.touches:[la],bc=!1,Ob=0;Ob<Vb.length;Ob++){var nc=Vb[Ob];if(ob<=nc.clientX&&nc.clientX<=ob+lb&&wb<=nc.clientY&&nc.clientY<=wb+Xa){bc=!0;break}}if(!bc)return!1;ob=a.container;la=la.target.parentNode;for(wb=!1;la;){if(la===ob){wb=!0;break}la=la.parentNode}return!!wb};a.registerBinding(a.container,"mousedown",function(la){if(ba(la)&&(1!==a.hoverData.which||1===la.which)){la.preventDefault();D();a.hoverData.capture=!0;a.hoverData.which=la.which;
var Xa=a.cy,ob=[la.clientX,la.clientY],wb=a.projectIntoViewport(ob[0],ob[1]),lb=a.selection,Vb=a.findNearestElements(wb[0],wb[1],!0,!1),bc=Vb[0],Ob=a.dragData.possibleDragElements;a.hoverData.mdownPos=wb;a.hoverData.mdownGPos=ob;ob=function(){a.hoverData.tapholdCancelled=!1;clearTimeout(a.hoverData.tapholdTimeout);a.hoverData.tapholdTimeout=setTimeout(function(){if(!a.hoverData.tapholdCancelled){var id=a.hoverData.down;id?id.emit({originalEvent:la,type:"taphold",position:{x:wb[0],y:wb[1]}}):Xa.emit({originalEvent:la,
type:"taphold",position:{x:wb[0],y:wb[1]}})}},a.tapholdDuration)};if(3==la.which)a.hoverData.cxtStarted=!0,Vb={originalEvent:la,type:"cxttapstart",position:{x:wb[0],y:wb[1]}},bc?(bc.activate(),bc.emit(Vb),a.hoverData.down=bc):Xa.emit(Vb),a.hoverData.downTime=(new Date).getTime(),a.hoverData.cxtDragged=!1;else if(1==la.which){bc&&bc.activate();if(null!=bc&&a.nodeIsGrabbable(bc)){var nc=function(id){return{originalEvent:la,type:id,position:{x:wb[0],y:wb[1]}}},Hc=function(id){id.emit(nc("grab"))};bc[0]._private.rscratch.isGrabTarget=
!0;if(bc.selected()){Ob=a.dragData.possibleDragElements=Xa.collection();var Qc=Xa.$(function(id){return id.isNode()&&id.selected()&&a.nodeIsGrabbable(id)});t(Qc,{addToList:Ob});bc.emit(nc("grabon"));Qc.forEach(Hc)}else Ob=a.dragData.possibleDragElements=Xa.collection(),t(bc,{addToList:Ob}),bc.emit(nc("grabon")).emit(nc("grab"));a.redrawHint("eles",!0);a.redrawHint("drag",!0)}a.hoverData.down=bc;a.hoverData.downs=Vb;a.hoverData.downTime=(new Date).getTime();d(bc,["mousedown","tapstart","vmousedown"],
la,{x:wb[0],y:wb[1]});null==bc?(lb[4]=1,a.data.bgActivePosistion={x:wb[0],y:wb[1]},a.redrawHint("select",!0),a.redraw()):bc.pannable()&&(lb[4]=1);ob()}lb[0]=lb[2]=wb[0];lb[1]=lb[3]=wb[1]}},!1);F=function(la){if((la=la.getRootNode())&&11===la.nodeType&&void 0!==la.host)return la}(a.container);a.registerBinding([b,F],"mousemove",function(la){if(a.hoverData.capture||ba(la)){var Xa=!1,ob=a.cy,wb=ob.zoom();Xa=[la.clientX,la.clientY];var lb=a.projectIntoViewport(Xa[0],Xa[1]),Vb=a.hoverData.mdownPos,bc=
a.hoverData.mdownGPos,Ob=a.selection,nc=null;a.hoverData.draggingEles||a.hoverData.dragging||a.hoverData.selecting||(nc=a.findNearestElement(lb[0],lb[1],!0,!1));var Hc=a.hoverData.last,Qc=a.hoverData.down,id=[lb[0]-Ob[2],lb[1]-Ob[3]],hd=a.dragData.possibleDragElements;if(bc){var md=Xa[0]-bc[0];Xa=Xa[1]-bc[1];a.hoverData.isOverThresholdDrag=md=md*md+Xa*Xa>=a.desktopTapThreshold2}bc=la.shiftKey||la.metaKey||la.ctrlKey;md&&(a.hoverData.tapholdCancelled=!0);var Bd=function(){var mf=a.hoverData.dragDelta=
a.hoverData.dragDelta||[];0===mf.length?(mf.push(id[0]),mf.push(id[1])):(mf[0]+=id[0],mf[1]+=id[1])};Xa=!0;d(nc,["mousemove","vmousemove","tapdrag"],la,{x:lb[0],y:lb[1]});var Sd=function(){a.data.bgActivePosistion=void 0;a.hoverData.selecting||ob.emit({originalEvent:la,type:"boxstart",position:{x:lb[0],y:lb[1]}});Ob[4]=1;a.hoverData.selecting=!0;a.redrawHint("select",!0);a.redraw()};if(3===a.hoverData.which)md&&(hd={originalEvent:la,type:"cxtdrag",position:{x:lb[0],y:lb[1]}},Qc?Qc.emit(hd):ob.emit(hd),
a.hoverData.cxtDragged=!0,a.hoverData.cxtOver&&nc===a.hoverData.cxtOver||(a.hoverData.cxtOver&&a.hoverData.cxtOver.emit({originalEvent:la,type:"cxtdragout",position:{x:lb[0],y:lb[1]}}),a.hoverData.cxtOver=nc,!nc||nc.emit({originalEvent:la,type:"cxtdragover",position:{x:lb[0],y:lb[1]}})));else if(a.hoverData.dragging){if(Xa=!0,ob.panningEnabled()&&ob.userPanningEnabled())a.hoverData.justStartedPan?(hd=a.hoverData.mdownPos,hd={x:(lb[0]-hd[0])*wb,y:(lb[1]-hd[1])*wb},a.hoverData.justStartedPan=!1):hd=
{x:id[0]*wb,y:id[1]*wb},ob.panBy(hd),ob.emit("dragpan"),a.hoverData.dragged=!0;lb=a.projectIntoViewport(la.clientX,la.clientY)}else if(1!=Ob[4]||null!=Qc&&!Qc.pannable()){if(Qc&&Qc.pannable()&&Qc.active()&&Qc.unactivate(),(!Qc||!Qc.grabbed())&&nc!=Hc&&(Hc&&d(Hc,["mouseout","tapdragout"],la,{x:lb[0],y:lb[1]}),nc&&d(nc,["mouseover","tapdragover"],la,{x:lb[0],y:lb[1]}),a.hoverData.last=nc),Qc)md?ob.boxSelectionEnabled()&&bc?(Qc&&Qc.grabbed()&&(v(hd),Qc.emit("freeon"),hd.emit("free"),a.dragData.didDrag&&
(Qc.emit("dragfreeon"),hd.emit("dragfree"))),Sd()):Qc&&Qc.grabbed()&&a.nodeIsDraggable(Qc)&&((nc=!a.dragData.didDrag)&&a.redrawHint("eles",!0),a.dragData.didDrag=!0,a.hoverData.draggingEles||t(hd,{inDragLayer:!0}),wb={x:0,y:0},cc(id[0])&&cc(id[1])&&(wb.x+=id[0],wb.y+=id[1],nc)&&(nc=a.hoverData.dragDelta)&&cc(nc[0])&&cc(nc[1])&&(wb.x+=nc[0],wb.y+=nc[1]),a.hoverData.draggingEles=!0,hd.silentShift(wb).emit("position drag"),a.redrawHint("drag",!0),a.redraw()):Bd();Xa=!0}else md&&(a.hoverData.dragging||
!ob.boxSelectionEnabled()||!bc&&ob.panningEnabled()&&ob.userPanningEnabled()?!a.hoverData.selecting&&ob.panningEnabled()&&ob.userPanningEnabled()&&f(Qc,a.hoverData.downs)&&(a.hoverData.dragging=!0,a.hoverData.justStartedPan=!0,Ob[4]=0,a.data.bgActivePosistion=Vf(Vb),a.redrawHint("select",!0),a.redraw()):Sd(),Qc&&Qc.pannable()&&Qc.active()&&Qc.unactivate());if(Ob[2]=lb[0],Ob[3]=lb[1],Xa)return la.stopPropagation&&la.stopPropagation(),la.preventDefault&&la.preventDefault(),!1}},!1);var X,Y,ta;a.registerBinding(b,
"mouseup",function(la){if((1!==a.hoverData.which||1===la.which||!a.hoverData.capture)&&a.hoverData.capture){a.hoverData.capture=!1;var Xa=a.cy,ob=a.projectIntoViewport(la.clientX,la.clientY),wb=a.selection,lb=a.findNearestElement(ob[0],ob[1],!0,!1),Vb=a.dragData.possibleDragElements,bc=a.hoverData.down,Ob=la.shiftKey||la.metaKey||la.ctrlKey;if(a.data.bgActivePosistion&&(a.redrawHint("select",!0),a.redraw()),a.hoverData.tapholdCancelled=!0,a.data.bgActivePosistion=void 0,bc&&bc.unactivate(),3===a.hoverData.which)Vb=
{originalEvent:la,type:"cxttapend",position:{x:ob[0],y:ob[1]}},(bc?bc.emit(Vb):Xa.emit(Vb),a.hoverData.cxtDragged)||(Vb={originalEvent:la,type:"cxttap",position:{x:ob[0],y:ob[1]}},bc?bc.emit(Vb):Xa.emit(Vb)),a.hoverData.cxtDragged=!1,a.hoverData.which=null;else if(1===a.hoverData.which){if(d(lb,["mouseup","tapend","vmouseup"],la,{x:ob[0],y:ob[1]}),!a.dragData.didDrag&&!a.hoverData.dragged&&!a.hoverData.selecting&&!a.hoverData.isOverThresholdDrag&&(d(bc,["click","tap","vclick"],la,{x:ob[0],y:ob[1]}),
Y=!1,la.timeStamp-ta<=Xa.multiClickDebounceTime()?(X&&clearTimeout(X),Y=!0,ta=null,d(bc,["dblclick","dbltap","vdblclick"],la,{x:ob[0],y:ob[1]})):(X=setTimeout(function(){Y||d(bc,["oneclick","onetap","voneclick"],la,{x:ob[0],y:ob[1]})},Xa.multiClickDebounceTime()),ta=la.timeStamp)),null==bc&&!a.dragData.didDrag&&!a.hoverData.selecting&&!a.hoverData.dragged&&!(la.shiftKey||la.metaKey||la.ctrlKey)&&(Xa.$(c).unselect(["tapunselect"]),0<Vb.length&&a.redrawHint("eles",!0),a.dragData.possibleDragElements=
Vb=Xa.collection()),lb==bc&&!a.dragData.didDrag&&!a.hoverData.selecting&&null!=lb&&lb._private.selectable&&(a.hoverData.dragging||("additive"===Xa.selectionType()||Ob?lb.selected()?lb.unselect(["tapunselect"]):lb.select(["tapselect"]):Ob||(Xa.$(c).unmerge(lb).unselect(["tapunselect"]),lb.select(["tapselect"]))),a.redrawHint("eles",!0)),a.hoverData.selecting)lb=Xa.collection(a.getAllInBox(wb[0],wb[1],wb[2],wb[3])),a.redrawHint("select",!0),0<lb.length&&a.redrawHint("eles",!0),Xa.emit({type:"boxend",
originalEvent:la,position:{x:ob[0],y:ob[1]}}),"additive"===Xa.selectionType()||Ob||Xa.$(c).unmerge(lb).unselect(),lb.emit("box").stdFilter(function(nc){return nc.selectable()&&!nc.selected()}).select().emit("boxselect"),a.redraw();(a.hoverData.dragging&&(a.hoverData.dragging=!1,a.redrawHint("select",!0),a.redrawHint("eles",!0),a.redraw()),wb[4])||(a.redrawHint("drag",!0),a.redrawHint("eles",!0),Xa=bc&&bc.grabbed(),v(Vb),Xa&&(bc.emit("freeon"),Vb.emit("free"),a.dragData.didDrag&&(bc.emit("dragfreeon"),
Vb.emit("dragfree"))))}wb[4]=0;a.hoverData.down=null;a.hoverData.cxtStarted=!1;a.hoverData.draggingEles=!1;a.hoverData.selecting=!1;a.hoverData.isOverThresholdDrag=!1;a.dragData.didDrag=!1;a.hoverData.dragged=!1;a.hoverData.dragDelta=[];a.hoverData.mdownPos=null;a.hoverData.mdownGPos=null;a.hoverData.which=null}},!1);var ja=[],Ba,Ua=1E5,ab=function(la,Xa){for(var ob=0;ob<la.length;ob++)if(0!==la[ob]%Xa)return!1;return!0},Qb=function(la){for(var Xa=Math.abs(la[0]),ob=1;ob<la.length;ob++)if(Math.abs(la[ob])!==
Xa)return!1;return!0},Mb=function(la){var Xa=!1,ob=la.deltaY;if(null==ob&&(null!=la.wheelDeltaY?ob=la.wheelDeltaY/4:null!=la.wheelDelta&&(ob=la.wheelDelta/4)),null==Ba)if(4<=ja.length){if(Ba=ab(ja,5),!Ba){var wb=Math.abs(ja[0]);Ba=Qb(ja)&&5<wb}if(Ba)for(wb=0;wb<ja.length;wb++)Ua=Math.min(Math.abs(ja[wb]),Ua)}else ja.push(ob),Xa=!0;else Ba&&(Ua=Math.min(Math.abs(ob),Ua));if(!a.scrollingPage){wb=a.cy;var lb=wb.zoom(),Vb=wb.pan(),bc=a.projectIntoViewport(la.clientX,la.clientY);lb=[bc[0]*lb+Vb.x,bc[1]*
lb+Vb.y];a.hoverData.draggingEles||a.hoverData.dragging||a.hoverData.cxtStarted||0!==a.selection[4]?la.preventDefault():wb.panningEnabled()&&wb.userPanningEnabled()&&wb.zoomingEnabled()&&wb.userZoomingEnabled()&&(la.preventDefault(),a.data.wheelZooming=!0,clearTimeout(a.data.wheelTimeout),a.data.wheelTimeout=setTimeout(function(){a.data.wheelZooming=!1;a.redrawHint("eles",!0);a.redraw()},150),Xa&&5<Math.abs(ob)&&(ob=5*(0<ob?1:0>ob?-1:0)),Xa=ob/-250,Ba&&(Xa/=Ua,Xa*=3),Xa*=a.wheelSensitivity,1===la.deltaMode&&
(Xa*=33),Xa=wb.zoom()*Math.pow(10,Xa),"gesturechange"===la.type&&(Xa=a.gestureStartZoom*la.scale),wb.zoom({level:Xa,renderedPosition:{x:lb[0],y:lb[1]}}),wb.emit("gesturechange"===la.type?"pinchzoom":"scrollzoom"))}};a.registerBinding(a.container,"wheel",Mb,!0);a.registerBinding(b,"scroll",function(la){a.scrollingPage=!0;clearTimeout(a.scrollingPageTimeout);a.scrollingPageTimeout=setTimeout(function(){a.scrollingPage=!1},250)},!0);a.registerBinding(a.container,"gesturestart",function(la){a.gestureStartZoom=
a.cy.zoom();a.hasTouchStarted||la.preventDefault()},!0);a.registerBinding(a.container,"gesturechange",function(la){a.hasTouchStarted||Mb(la)},!0);a.registerBinding(a.container,"mouseout",function(la){var Xa=a.projectIntoViewport(la.clientX,la.clientY);a.cy.emit({originalEvent:la,type:"mouseout",position:{x:Xa[0],y:Xa[1]}})},!1);a.registerBinding(a.container,"mouseover",function(la){var Xa=a.projectIntoViewport(la.clientX,la.clientY);a.cy.emit({originalEvent:la,type:"mouseover",position:{x:Xa[0],y:Xa[1]}})},
!1);var Ub,Wb,Yb,ub,Kb,Zb,dc,ac,vb,Tb,jc,kc,tc,Xc;a.registerBinding(a.container,"touchstart",Xc=function(la){if(a.hasTouchStarted=!0,ba(la)){D();a.touchData.capture=!0;a.data.bgActivePosistion=void 0;var Xa=a.cy,ob=a.touchData.now,wb=a.touchData.earlier;if(la.touches[0]){var lb=a.projectIntoViewport(la.touches[0].clientX,la.touches[0].clientY);ob[0]=lb[0];ob[1]=lb[1]}la.touches[1]&&(lb=a.projectIntoViewport(la.touches[1].clientX,la.touches[1].clientY),ob[2]=lb[0],ob[3]=lb[1]);la.touches[2]&&(lb=a.projectIntoViewport(la.touches[2].clientX,
la.touches[2].clientY),ob[4]=lb[0],ob[5]=lb[1]);if(la.touches[1]){a.touchData.singleTouchMoved=!0;v(a.dragData.touchDragEles);var Vb=a.findContainerClientCoords();vb=Vb[0];Tb=Vb[1];jc=Vb[2];kc=Vb[3];Ub=la.touches[0].clientX-vb;Wb=la.touches[0].clientY-Tb;Yb=la.touches[1].clientX-vb;ub=la.touches[1].clientY-Tb;tc=0<=Ub&&Ub<=jc&&0<=Yb&&Yb<=jc&&0<=Wb&&Wb<=kc&&0<=ub&&ub<=kc;Vb=Xa.pan();var bc=Xa.zoom();Kb=Math.sqrt((Yb-Ub)*(Yb-Ub)+(ub-Wb)*(ub-Wb));Zb=(Yb-Ub)*(Yb-Ub)+(ub-Wb)*(ub-Wb);dc=[(Ub+Yb)/2,(Wb+
ub)/2];ac=[(dc[0]-Vb.x)/bc,(dc[1]-Vb.y)/bc];if(4E4>Zb&&!la.touches[2]){wb=a.findNearestElement(ob[0],ob[1],!0,!0);lb=a.findNearestElement(ob[2],ob[3],!0,!0);wb&&wb.isNode()?(wb.activate().emit({originalEvent:la,type:"cxttapstart",position:{x:ob[0],y:ob[1]}}),a.touchData.start=wb):lb&&lb.isNode()?(lb.activate().emit({originalEvent:la,type:"cxttapstart",position:{x:ob[0],y:ob[1]}}),a.touchData.start=lb):Xa.emit({originalEvent:la,type:"cxttapstart",position:{x:ob[0],y:ob[1]}});a.touchData.start&&(a.touchData.start._private.grabbed=
!1);a.touchData.cxt=!0;a.touchData.cxtDragged=!1;a.data.bgActivePosistion=void 0;a.redraw();return}}if(la.touches[2])Xa.boxSelectionEnabled()&&la.preventDefault();else if(!la.touches[1]&&la.touches[0]){bc=a.findNearestElements(ob[0],ob[1],!0,!0);Vb=bc[0];if(null!=Vb&&(Vb.activate(),a.touchData.start=Vb,a.touchData.starts=bc,a.nodeIsGrabbable(Vb))){bc=a.dragData.touchDragEles=Xa.collection();var Ob=null;a.redrawHint("eles",!0);a.redrawHint("drag",!0);Vb.selected()?(Ob=Xa.$(function(Hc){return Hc.selected()&&
a.nodeIsGrabbable(Hc)}),t(Ob,{addToList:bc})):t(Vb,{addToList:bc});Vb[0]._private.rscratch.isGrabTarget=!0;var nc=function(Hc){return{originalEvent:la,type:Hc,position:{x:ob[0],y:ob[1]}}};Vb.emit(nc("grabon"));Ob?Ob.forEach(function(Hc){Hc.emit(nc("grab"))}):Vb.emit(nc("grab"))}d(Vb,["touchstart","tapstart","vmousedown"],la,{x:ob[0],y:ob[1]});null==Vb&&(a.data.bgActivePosistion={x:lb[0],y:lb[1]},a.redrawHint("select",!0),a.redraw());a.touchData.singleTouchMoved=!1;a.touchData.singleTouchStartTime=
+new Date;clearTimeout(a.touchData.tapholdTimeout);a.touchData.tapholdTimeout=setTimeout(function(){!1!==a.touchData.singleTouchMoved||a.pinching||a.touchData.selecting||d(a.touchData.start,["taphold"],la,{x:ob[0],y:ob[1]})},a.tapholdDuration)}if(1<=la.touches.length){Xa=a.touchData.startPosition=[null,null,null,null,null,null];for(lb=0;lb<ob.length;lb++)Xa[lb]=wb[lb]=ob[lb];Xa=la.touches[0];a.touchData.startGPosition=[Xa.clientX,Xa.clientY]}}},!1);var Ad;a.registerBinding(b,"touchmove",Ad=function(la){var Xa=
a.touchData.capture;if(Xa||ba(la)){var ob=a.selection,wb=a.cy,lb=a.touchData.now,Vb=a.touchData.earlier,bc=wb.zoom();if(la.touches[0]){var Ob=a.projectIntoViewport(la.touches[0].clientX,la.touches[0].clientY);lb[0]=Ob[0];lb[1]=Ob[1]}la.touches[1]&&(Ob=a.projectIntoViewport(la.touches[1].clientX,la.touches[1].clientY),lb[2]=Ob[0],lb[3]=Ob[1]);la.touches[2]&&(Ob=a.projectIntoViewport(la.touches[2].clientX,la.touches[2].clientY),lb[4]=Ob[0],lb[5]=Ob[1]);Ob=a.touchData.startGPosition;if(Xa&&la.touches[0]&&
Ob){for(var nc=[],Hc=0;Hc<lb.length;Hc++)nc[Hc]=lb[Hc]-Vb[Hc];var Qc=la.touches[0].clientX-Ob[0],id=la.touches[0].clientY-Ob[1];var hd=Qc*Qc+id*id>=a.touchTapThreshold2}if(Xa&&a.touchData.cxt){la.preventDefault();Ob=la.touches[0].clientX-vb;Hc=la.touches[0].clientY-Tb;var md=la.touches[1].clientX-vb,Bd=la.touches[1].clientY-Tb;Ob=(md-Ob)*(md-Ob)+(Bd-Hc)*(Bd-Hc);if(2.25<=Ob/Zb||22500<=Ob)a.touchData.cxt=!1,a.data.bgActivePosistion=void 0,a.redrawHint("select",!0),Ob={originalEvent:la,type:"cxttapend",
position:{x:lb[0],y:lb[1]}},a.touchData.start?(a.touchData.start.unactivate().emit(Ob),a.touchData.start=null):wb.emit(Ob)}if(Xa&&a.touchData.cxt){Ob={originalEvent:la,type:"cxtdrag",position:{x:lb[0],y:lb[1]}};a.data.bgActivePosistion=void 0;a.redrawHint("select",!0);a.touchData.start?a.touchData.start.emit(Ob):wb.emit(Ob);a.touchData.start&&(a.touchData.start._private.grabbed=!1);a.touchData.cxtDragged=!0;var Sd=a.findNearestElement(lb[0],lb[1],!0,!0);a.touchData.cxtOver&&Sd===a.touchData.cxtOver||
(a.touchData.cxtOver&&a.touchData.cxtOver.emit({originalEvent:la,type:"cxtdragout",position:{x:lb[0],y:lb[1]}}),a.touchData.cxtOver=Sd,!Sd||Sd.emit({originalEvent:la,type:"cxtdragover",position:{x:lb[0],y:lb[1]}}))}else if(Xa&&la.touches[2]&&wb.boxSelectionEnabled())la.preventDefault(),a.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,a.touchData.selecting||wb.emit({originalEvent:la,type:"boxstart",position:{x:lb[0],y:lb[1]}}),a.touchData.selecting=!0,a.touchData.didSelect=!0,ob[4]=1,
ob&&0!==ob.length&&void 0!==ob[0]?(ob[2]=(lb[0]+lb[2]+lb[4])/3,ob[3]=(lb[1]+lb[3]+lb[5])/3):(ob[0]=(lb[0]+lb[2]+lb[4])/3,ob[1]=(lb[1]+lb[3]+lb[5])/3,ob[2]=(lb[0]+lb[2]+lb[4])/3+1,ob[3]=(lb[1]+lb[3]+lb[5])/3+1),a.redrawHint("select",!0),a.redraw();else if(Xa&&la.touches[1]&&!a.touchData.didSelect&&wb.zoomingEnabled()&&wb.panningEnabled()&&wb.userZoomingEnabled()&&wb.userPanningEnabled()){la.preventDefault();a.data.bgActivePosistion=void 0;a.redrawHint("select",!0);if(ob=a.dragData.touchDragEles)for(a.redrawHint("drag",
!0),Hc=0;Hc<ob.length;Hc++)bc=ob[Hc]._private,bc.grabbed=!1,bc.rscratch.inDragLayer=!1;bc=a.touchData.start;Ob=la.touches[0].clientX-vb;Hc=la.touches[0].clientY-Tb;md=la.touches[1].clientX-vb;Bd=la.touches[1].clientY-Tb;nc=Math.sqrt((md-Ob)*(md-Ob)+(Bd-Hc)*(Bd-Hc));hd=nc/Kb;if(tc){Qc=(Ob-Ub+(md-Yb))/2;id=(Hc-Wb+(Bd-ub))/2;Sd=wb.zoom();hd*=Sd;ob=wb.pan();var mf=ac[0]*Sd+ob.x,bo=ac[1]*Sd+ob.y;Qc={x:-hd/Sd*(mf-ob.x-Qc)+mf,y:-hd/Sd*(bo-ob.y-id)+bo};bc&&bc.active()&&(ob=a.dragData.touchDragEles,v(ob),
a.redrawHint("drag",!0),a.redrawHint("eles",!0),bc.unactivate().emit("freeon"),ob.emit("free"),a.dragData.didDrag&&(bc.emit("dragfreeon"),ob.emit("dragfree")));wb.viewport({zoom:hd,pan:Qc,cancelOnFailedZoom:!0});wb.emit("pinchzoom");Kb=nc;Ub=Ob;Wb=Hc;Yb=md;ub=Bd;a.pinching=!0}la.touches[0]&&(Ob=a.projectIntoViewport(la.touches[0].clientX,la.touches[0].clientY),lb[0]=Ob[0],lb[1]=Ob[1]);la.touches[1]&&(Ob=a.projectIntoViewport(la.touches[1].clientX,la.touches[1].clientY),lb[2]=Ob[0],lb[3]=Ob[1]);la.touches[2]&&
(Ob=a.projectIntoViewport(la.touches[2].clientX,la.touches[2].clientY),lb[4]=Ob[0],lb[5]=Ob[1])}else if(la.touches[0]&&!a.touchData.didSelect){Ob=a.touchData.start;Hc=a.touchData.last;if(!a.hoverData.draggingEles&&!a.swipePanning&&(Sd=a.findNearestElement(lb[0],lb[1],!0,!0)),Xa&&null!=Ob&&la.preventDefault(),Xa&&null!=Ob&&a.nodeIsDraggable(Ob))hd?(ob=a.dragData.touchDragEles,(Bd=!a.dragData.didDrag)&&t(ob,{inDragLayer:!0}),a.dragData.didDrag=!0,md={x:0,y:0},cc(nc[0])&&cc(nc[1])&&(md.x+=nc[0],md.y+=
nc[1],Bd)&&(a.redrawHint("eles",!0),(Bd=a.touchData.dragDelta)&&cc(Bd[0])&&cc(Bd[1])&&(md.x+=Bd[0],md.y+=Bd[1])),a.hoverData.draggingEles=!0,ob.silentShift(md).emit("position drag"),a.redrawHint("drag",!0),a.touchData.startPosition[0]==Vb[0]&&a.touchData.startPosition[1]==Vb[1]&&a.redrawHint("eles",!0),a.redraw()):(Bd=a.touchData.dragDelta=a.touchData.dragDelta||[],0===Bd.length?(Bd.push(nc[0]),Bd.push(nc[1])):(Bd[0]+=nc[0],Bd[1]+=nc[1]));if(d(Ob||Sd,["touchmove","tapdrag","vmousemove"],la,{x:lb[0],
y:lb[1]}),(!Ob||!Ob.grabbed())&&Sd!=Hc&&(Hc&&Hc.emit({originalEvent:la,type:"tapdragout",position:{x:lb[0],y:lb[1]}}),Sd&&Sd.emit({originalEvent:la,type:"tapdragover",position:{x:lb[0],y:lb[1]}})),a.touchData.last=Sd,Xa)for(Hc=0;Hc<lb.length;Hc++)lb[Hc]&&a.touchData.startPosition[Hc]&&hd&&(a.touchData.singleTouchMoved=!0);Xa&&(null==Ob||Ob.pannable())&&wb.panningEnabled()&&wb.userPanningEnabled()&&(f(Ob,a.touchData.starts)&&(la.preventDefault(),a.data.bgActivePosistion||(a.data.bgActivePosistion=
Vf(a.touchData.startPosition)),a.swipePanning?(wb.panBy({x:nc[0]*bc,y:nc[1]*bc}),wb.emit("dragpan")):hd&&(a.swipePanning=!0,wb.panBy({x:Qc*bc,y:id*bc}),wb.emit("dragpan"),Ob&&(Ob.unactivate(),a.redrawHint("select",!0),a.touchData.start=null))),Ob=a.projectIntoViewport(la.touches[0].clientX,la.touches[0].clientY),lb[0]=Ob[0],lb[1]=Ob[1])}for(Hc=0;Hc<lb.length;Hc++)Vb[Hc]=lb[Hc];Xa&&0<la.touches.length&&!a.hoverData.draggingEles&&!a.swipePanning&&null!=a.data.bgActivePosistion&&(a.data.bgActivePosistion=
void 0,a.redrawHint("select",!0),a.redraw())}},!1);var Ac;a.registerBinding(b,"touchcancel",Ac=function(la){la=a.touchData.start;a.touchData.capture=!1;la&&la.unactivate()});var Pc,Sc,pd,Kd;if(a.registerBinding(b,"touchend",Pc=function(la){var Xa=a.touchData.start;if(a.touchData.capture){0===la.touches.length&&(a.touchData.capture=!1);la.preventDefault();var ob=a.selection;a.swipePanning=!1;a.hoverData.draggingEles=!1;var wb=a.cy,lb=wb.zoom(),Vb=a.touchData.now,bc=a.touchData.earlier;if(la.touches[0]){var Ob=
a.projectIntoViewport(la.touches[0].clientX,la.touches[0].clientY);Vb[0]=Ob[0];Vb[1]=Ob[1]}la.touches[1]&&(Ob=a.projectIntoViewport(la.touches[1].clientX,la.touches[1].clientY),Vb[2]=Ob[0],Vb[3]=Ob[1]);la.touches[2]&&(Ob=a.projectIntoViewport(la.touches[2].clientX,la.touches[2].clientY),Vb[4]=Ob[0],Vb[5]=Ob[1]);Xa&&Xa.unactivate();var nc;if(a.touchData.cxt)(nc={originalEvent:la,type:"cxttapend",position:{x:Vb[0],y:Vb[1]}},Xa?Xa.emit(nc):wb.emit(nc),a.touchData.cxtDragged)||(bc={originalEvent:la,type:"cxttap",
position:{x:Vb[0],y:Vb[1]}},Xa?Xa.emit(bc):wb.emit(bc)),a.touchData.start&&(a.touchData.start._private.grabbed=!1),a.touchData.cxt=!1,a.touchData.start=null,a.redraw();else{!la.touches[2]&&wb.boxSelectionEnabled()&&a.touchData.selecting&&(a.touchData.selecting=!1,Ob=wb.collection(a.getAllInBox(ob[0],ob[1],ob[2],ob[3])),ob[0]=void 0,ob[1]=void 0,ob[2]=void 0,ob[3]=void 0,ob[4]=0,a.redrawHint("select",!0),wb.emit({type:"boxend",originalEvent:la,position:{x:Vb[0],y:Vb[1]}}),Ob.emit("box").stdFilter(function(Hc){return Hc.selectable()&&
!Hc.selected()}).select().emit("boxselect"),Ob.nonempty()&&a.redrawHint("eles",!0),a.redraw());(Xa?.unactivate(),la.touches[2])?(a.data.bgActivePosistion=void 0,a.redrawHint("select",!0)):la.touches[1]||la.touches[0]||la.touches[0]||(a.data.bgActivePosistion=void 0,a.redrawHint("select",!0),ob=a.dragData.touchDragEles,null!=Xa?(Ob=Xa._private.grabbed,v(ob),a.redrawHint("drag",!0),a.redrawHint("eles",!0),Ob&&(Xa.emit("freeon"),ob.emit("free"),a.dragData.didDrag&&(Xa.emit("dragfreeon"),ob.emit("dragfree"))),
d(Xa,["touchend","tapend","vmouseup","tapdragout"],la,{x:Vb[0],y:Vb[1]}),Xa.unactivate(),a.touchData.start=null):(ob=a.findNearestElement(Vb[0],Vb[1],!0,!0),d(ob,["touchend","tapend","vmouseup","tapdragout"],la,{x:Vb[0],y:Vb[1]})),ob=a.touchData.startPosition[0]-Vb[0],Ob=a.touchData.startPosition[1]-Vb[1],lb*=(ob*ob+Ob*Ob)*lb,a.touchData.singleTouchMoved||(Xa||wb.$(":selected").unselect(["tapunselect"]),d(Xa,["tap","vclick"],la,{x:Vb[0],y:Vb[1]}),Sc=!1,la.timeStamp-Kd<=wb.multiClickDebounceTime()?
(pd&&clearTimeout(pd),Sc=!0,Kd=null,d(Xa,["dbltap","vdblclick"],la,{x:Vb[0],y:Vb[1]})):(pd=setTimeout(function(){Sc||d(Xa,["onetap","voneclick"],la,{x:Vb[0],y:Vb[1]})},wb.multiClickDebounceTime()),Kd=la.timeStamp)),null!=Xa&&!a.dragData.didDrag&&Xa._private.selectable&&lb<a.touchTapThreshold2&&!a.pinching&&("single"===wb.selectionType()?(wb.$(c).unmerge(Xa).unselect(["tapunselect"]),Xa.select(["tapselect"])):Xa.selected()?Xa.unselect(["tapunselect"]):Xa.select(["tapselect"]),a.redrawHint("eles",!0)),
a.touchData.singleTouchMoved=!0);for(wb=0;wb<Vb.length;wb++)bc[wb]=Vb[wb];a.dragData.didDrag=!1;0===la.touches.length&&(a.touchData.dragDelta=[],a.touchData.startPosition=[null,null,null,null,null,null],a.touchData.startGPosition=null,a.touchData.didSelect=!1);2>la.touches.length&&(1===la.touches.length&&(a.touchData.startGPosition=[la.touches[0].clientX,la.touches[0].clientY]),a.pinching=!1,a.redrawHint("eles",!0),a.redraw())}}},!1),"u"<typeof TouchEvent){var de=[],ue=function(la){return{clientX:la.clientX,
clientY:la.clientY,force:1,identifier:la.pointerId,pageX:la.pageX,pageY:la.pageY,radiusX:la.width/2,radiusY:la.height/2,screenX:la.screenX,screenY:la.screenY,target:la.target}},Ng=function(la){for(var Xa=0;Xa<de.length;Xa++)if(de[Xa].event.pointerId===la.pointerId){de.splice(Xa,1);break}},li=function(la){var Xa=de.filter(function(ob){return ob.event.pointerId===la.pointerId})[0];Xa.event=la;Xa.touch=ue(la)},dg=function(la){la.touches=de.map(function(Xa){return Xa.touch})},Mc=function(la){return"mouse"===
la.pointerType||4===la.pointerType};a.registerBinding(a.container,"pointerdown",function(la){Mc(la)||(la.preventDefault(),de.push({event:la,touch:ue(la)}),dg(la),Xc(la))});a.registerBinding(a.container,"pointerup",function(la){Mc(la)||(Ng(la),dg(la),Pc(la))});a.registerBinding(a.container,"pointercancel",function(la){Mc(la)||(Ng(la),dg(la),Ac(la))});a.registerBinding(a.container,"pointermove",function(la){Mc(la)||(la.preventDefault(),li(la),dg(la),Ad(la))})}}},{generatePolygon:function(a,b){return this.nodeShapes[a]=
{renderer:this,name:a,points:b,draw:function(c,d,f,h,l,m){this.renderer.nodeShapeImpl("polygon",c,d,f,h,l,this.points)},intersectLine:function(c,d,f,h,l,m,t,v){return Eg(l,m,this.points,c,d,f/2,h/2,t)},checkPoint:function(c,d,f,h,l,m,t,v){return De(c,d,this.points,m,t,h,l,[0,-1],f)}}},generateEllipse:function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(a,b,c,d,f,h){this.renderer.nodeShapeImpl(this.name,a,b,c,d,f)},intersectLine:function(a,b,c,d,f,h,l,m){c=(a-f)/(c/
2+l);d=(b-h)/(d/2+l);d=Math.sqrt(c*c+d*d);l=d-1;0>l?a=[]:(d=l/d,a=[(a-f)*d+f,(b-h)*d+h]);return a},checkPoint:function(a,b,c,d,f,h,l,m){return Se(a,b,d,f,h,l,c)}}},generateRoundPolygon:function(a,b){return this.nodeShapes[a]={renderer:this,name:a,points:b,getOrCreateCorners:function(c,d,f,h,l,m,t){if(void 0!==m[t]&&m[t+"-cx"]===c&&m[t+"-cy"]===d)return m[t];m[t]=Array(b.length/2);m[t+"-cx"]=c;m[t+"-cy"]=d;var v=f/2,C=h/2;l="auto"===l?Math.min(f/10,h/10,8):l;f=Array(b.length/2);for(h=0;h<b.length/
2;h++)f[h]={x:c+v*b[2*h],y:d+C*b[2*h+1]};h=f.length;d=f[h-1];for(c=0;c<h;c++)v=f[c%h],C=f[(c+1)%h],m[t][c]=O(d,v,C,l),d=v;return m[t]},draw:function(c,d,f,h,l,m,t){this.renderer.nodeShapeImpl("round-polygon",c,d,f,h,l,this.points,this.getOrCreateCorners(d,f,h,l,m,t,"drawCorners"))},intersectLine:function(c,d,f,h,l,m,t,v,C){return Fg(l,m,this.points,c,d,f,h,t,this.getOrCreateCorners(c,d,f,h,v,C,"corners"))},checkPoint:function(c,d,f,h,l,m,t,v,C){a:{f=this.points;h=this.getOrCreateCorners(m,t,h,l,v,
C,"corners");l=Array(2*f.length);for(m=0;m<h.length;m++)if(t=h[m],l[4*m]=t.startX,l[4*m+1]=t.startY,l[4*m+2]=t.stopX,l[4*m+3]=t.stopY,Math.pow(t.cx-c,2)+Math.pow(t.cy-d,2)<=Math.pow(t.radius,2)){c=!0;break a}c=ie(c,d,l)}return c}}},generateRoundRectangle:function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:Yd(4,0),draw:function(a,b,c,d,f,h){this.renderer.nodeShapeImpl(this.name,a,b,c,d,f,this.points,h)},intersectLine:function(a,
b,c,d,f,h,l,m){return Cg(f,h,a,b,c,d,l,m)},checkPoint:function(a,b,c,d,f,h,l,m){var t=d/2,v=f/2;m="auto"===m?Ue(d,f):m;m=Math.min(t,v,m);var C=2*m;return!!(De(a,b,this.points,h,l,d,f-C,[0,-1],c)||De(a,b,this.points,h,l,d-C,f,[0,-1],c)||Se(a,b,C,C,h-t+m,l-v+m,c)||Se(a,b,C,C,h+t-m,l-v+m,c)||Se(a,b,C,C,h+t-m,l+v-m,c)||Se(a,b,C,C,h-t+m,l+v-m,c))}}},generateCutRectangle:function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:8,points:Yd(4,
0),draw:function(a,b,c,d,f,h){this.renderer.nodeShapeImpl(this.name,a,b,c,d,f,null,h)},generateCutTrianglePts:function(a,b,c,d,f){f="auto"===f?this.cornerLength:f;b/=2;var h=a/2;a=c-h;c+=h;h=d-b;d+=b;return{topLeft:[a,h+f,a+f,h,a+f,h+f],topRight:[c-f,h,c,h+f,c-f,h+f],bottomRight:[c,d-f,c-f,d,c-f,d-f],bottomLeft:[a+f,d,a,d-f,a+f,d-f]}},intersectLine:function(a,b,c,d,f,h,l,m){c=this.generateCutTrianglePts(c+2*l,d+2*l,a,b,m);c=[].concat.apply([],[c.topLeft.splice(0,4),c.topRight.splice(0,4),c.bottomRight.splice(0,
4),c.bottomLeft.splice(0,4)]);return Eg(f,h,c,a,b)},checkPoint:function(a,b,c,d,f,h,l,m){m="auto"===m?this.cornerLength:m;if(De(a,b,this.points,h,l,d,f-2*m,[0,-1],c)||De(a,b,this.points,h,l,d-2*m,f,[0,-1],c))return!0;c=this.generateCutTrianglePts(d,f,h,l);return ie(a,b,c.topLeft)||ie(a,b,c.topRight)||ie(a,b,c.bottomRight)||ie(a,b,c.bottomLeft)}}},generateBarrel:function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:Yd(4,0),draw:function(a,b,c,d,f,h){this.renderer.nodeShapeImpl(this.name,
a,b,c,d,f)},intersectLine:function(a,b,c,d,f,h,l,m){c=this.generateBarrelBezierPts(c+2*l,d+2*l,a,b);d=function(t){var v=Wf({x:t[0],y:t[1]},{x:t[2],y:t[3]},{x:t[4],y:t[5]},.15),C=Wf({x:t[0],y:t[1]},{x:t[2],y:t[3]},{x:t[4],y:t[5]},.5),D=Wf({x:t[0],y:t[1]},{x:t[2],y:t[3]},{x:t[4],y:t[5]},.85);return[t[0],t[1],v.x,v.y,C.x,C.y,D.x,D.y,t[4],t[5]]};c=[].concat(d(c.topLeft),d(c.topRight),d(c.bottomRight),d(c.bottomLeft));return Eg(f,h,c,a,b)},generateBarrelBezierPts:function(a,b,c,d){var f=b/2,h=a/2,l=c-
h;c+=h;h=d-f;d+=f;var m=xh(a,b);b=m.heightOffset;f=m.widthOffset;a*=m.ctrlPtOffsetPct;l={topLeft:[l,h+b,l+a,h,l+f,h],topRight:[c-f,h,c-a,h,c,h+b],bottomRight:[c,d-b,c-a,d,c-f,d],bottomLeft:[l+f,d,l+a,d,l,d-b]};return l.topLeft.isTop=!0,l.topRight.isTop=!0,l.bottomLeft.isBottom=!0,l.bottomRight.isBottom=!0,l},checkPoint:function(a,b,c,d,f,h,l,m){m=xh(d,f);var t=m.widthOffset;if(De(a,b,this.points,h,l,d,f-2*m.heightOffset,[0,-1],c)||De(a,b,this.points,h,l,d-2*t,f,[0,-1],c))return!0;c=this.generateBarrelBezierPts(d,
f,h,l);d=function(v,C,D){var F=D[4],I=D[2],K=D[0],P=D[5],ba=D[1];D=Math.max(F,K);var X=Math.min(P,ba);P=Math.max(P,ba);return Math.min(F,K)<=v&&v<=D&&X<=C&&C<=P&&(C=[F-2*I+K,2*(I-F),F],v=Ni(C[0],C[1],C[2],v).filter(function(Y){return 0<=Y&&1>=Y}),0<v.length)?v[0]:null};f=Object.keys(c);for(h=0;h<f.length;h++)if(l=c[f[h]],m=d(a,b,l),null!=m&&(m=Jd(l[5],l[3],l[1],m),l.isTop&&m<=b||l.isBottom&&b<=m))return!0;return!1}}},generateBottomRoundrectangle:function(){return this.nodeShapes["bottom-round-rectangle"]=
this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:Yd(4,0),draw:function(a,b,c,d,f,h){this.renderer.nodeShapeImpl(this.name,a,b,c,d,f,this.points,h)},intersectLine:function(a,b,c,d,f,h,l,m){var t=b-(d/2+l);t=Te(f,h,a,b,a-(c/2+l),t,a+(c/2+l),t,!1);return 0<t.length?t:Cg(f,h,a,b,c,d,l,m)},checkPoint:function(a,b,c,d,f,h,l,m){m="auto"===m?Ue(d,f):m;var t=2*m;if(De(a,b,this.points,h,l,d,f-t,[0,-1],c)||De(a,b,this.points,h,l,d-t,f,[0,-1],c))return!0;var v=d/2+2*c,
C=f/2+2*c;return!!(ie(a,b,[h-v,l-C,h-v,l,h+v,l,h+v,l-C])||Se(a,b,t,t,h+d/2-m,l+f/2-m,c)||Se(a,b,t,t,h-d/2+m,l+f/2-m,c))}}},registerNodeShapes:function(){var a=this.nodeShapes={},b=this;this.generateEllipse();this.generatePolygon("triangle",Yd(3,0));this.generateRoundPolygon("round-triangle",Yd(3,0));this.generatePolygon("rectangle",Yd(4,0));a.square=a.rectangle;this.generateRoundRectangle();this.generateCutRectangle();this.generateBarrel();this.generateBottomRoundrectangle();var c=[0,1,1,0,0,-1,-1,
0];this.generatePolygon("diamond",c);this.generateRoundPolygon("round-diamond",c);this.generatePolygon("pentagon",Yd(5,0));this.generateRoundPolygon("round-pentagon",Yd(5,0));this.generatePolygon("hexagon",Yd(6,0));this.generateRoundPolygon("round-hexagon",Yd(6,0));this.generatePolygon("heptagon",Yd(7,0));this.generateRoundPolygon("round-heptagon",Yd(7,0));this.generatePolygon("octagon",Yd(8,0));this.generateRoundPolygon("round-octagon",Yd(8,0));c=Array(20);var d=wh(5,0),f=wh(5,Math.PI/5),h=.5*(3-
Math.sqrt(5));h*=1.57;for(var l=0;l<f.length/2;l++)f[2*l]*=h,f[2*l+1]*=h;for(l=0;5>l;l++)c[4*l]=d[2*l],c[4*l+1]=d[2*l+1],c[4*l+2]=f[2*l],c[4*l+3]=f[2*l+1];c=Oi(c);this.generatePolygon("star",c);this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]);this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]);this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]);this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);c=[-1,-1,.25,
-1,1,0,.25,1,-1,1];this.generatePolygon("tag",c);this.generateRoundPolygon("round-tag",c);a.makePolygon=function(m){var t="polygon-"+m.join("$"),v;return(v=this[t])?v:b.generatePolygon(t,m)}}},Zn].forEach(function(a){Bc(Eh,a)});var pl=1E3/60,co={setupDequeueing:function(a){return function(){var b=this,c=this.renderer;if(!b.dequeueingSetup){b.dequeueingSetup=!0;var d=ne(function(){c.redrawHint("eles",!0);c.redrawHint("drag",!0);c.redraw()},a.deqRedrawThreshold);c.beforeRender(function(f,h){var l=Be(),
m=c.averageRedrawTime,t=c.lastRedrawTime,v=[],C=c.cy.extent(),D=c.getPixelRatio();for(f||c.flushRenderedStyleQueue();;){var F=Be(),I=F-l;F-=h;if(t<pl){if(F>=a.deqFastCost*(pl-(f?m:0)))break}else if(f){if(I>=a.deqCost*t||I>=a.deqAvgCost*m)break}else if(F>=a.deqNoDrawCost*pl)break;I=a.deq(b,D,C);if(0<I.length)for(F=0;F<I.length;F++)v.push(I[F]);else break}0<v.length&&(a.onDeqd(b,v),!f&&a.shouldRedraw(b,v,D,C)&&d())},(a.priority||wg)(b))}}}},Iq=function(){function a(b){var c=1<arguments.length&&void 0!==
arguments[1]?arguments[1]:qh;u(this,a);this.idsByKey=new Pe;this.keyForId=new Pe;this.cachesByLvl=new Pe;this.lvls=[];this.getKey=b;this.doesEleInvalidateKey=c}return w(a,[{key:"getIdsFor",value:function(b){null==b&&vd("Can not get id list for null key");var c=this.idsByKey,d=this.idsByKey.get(b);return d||(d=new rf,c.set(b,d)),d}},{key:"addIdForKey",value:function(b,c){null!=b&&this.getIdsFor(b).add(c)}},{key:"deleteIdForKey",value:function(b,c){null!=b&&this.getIdsFor(b).delete(c)}},{key:"getNumberOfIdsForKey",
value:function(b){return null==b?0:this.getIdsFor(b).size}},{key:"updateKeyMappingFor",value:function(b){var c=b.id(),d=this.keyForId.get(c);b=this.getKey(b);this.deleteIdForKey(d,c);this.addIdForKey(b,c);this.keyForId.set(c,b)}},{key:"deleteKeyMappingFor",value:function(b){b=b.id();var c=this.keyForId.get(b);this.deleteIdForKey(c,b);this.keyForId.delete(b)}},{key:"keyHasChangedFor",value:function(b){var c=b.id();c=this.keyForId.get(c);b=this.getKey(b);return c!==b}},{key:"isInvalid",value:function(b){return this.keyHasChangedFor(b)||
this.doesEleInvalidateKey(b)}},{key:"getCachesAt",value:function(b){var c=this.cachesByLvl,d=this.lvls,f=c.get(b);return f||(f=new Pe,c.set(b,f),d.push(b)),f}},{key:"getCache",value:function(b,c){return this.getCachesAt(c).get(b)}},{key:"get",value:function(b,c){var d=this.getKey(b);c=this.getCache(d,c);return null!=c&&this.updateKeyMappingFor(b),c}},{key:"getForCachedKey",value:function(b,c){b=this.keyForId.get(b.id());return this.getCache(b,c)}},{key:"hasCache",value:function(b,c){return this.getCachesAt(c).has(b)}},
{key:"has",value:function(b,c){b=this.getKey(b);return this.hasCache(b,c)}},{key:"setCache",value:function(b,c,d){d.key=b;this.getCachesAt(c).set(b,d)}},{key:"set",value:function(b,c,d){var f=this.getKey(b);this.setCache(f,c,d);this.updateKeyMappingFor(b)}},{key:"deleteCache",value:function(b,c){this.getCachesAt(c).delete(b)}},{key:"delete",value:function(b,c){b=this.getKey(b);this.deleteCache(b,c)}},{key:"invalidateKey",value:function(b){var c=this;this.lvls.forEach(function(d){return c.deleteCache(b,
d)})}},{key:"invalidate",value:function(b){var c=b.id();c=this.keyForId.get(c);this.deleteKeyMappingFor(b);b=this.doesEleInvalidateKey(b);return b&&this.invalidateKey(c),b||0===this.getNumberOfIdsForKey(c)}}])}(),Fh={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},Jq=Id({getKey:null,doesEleInvalidateKey:qh,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:$h,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),fi=function(a,b){this.renderer=
a;this.onDequeues=[];a=Jq(b);Bc(this,a);this.lookup=new Iq(a.getKey,a.doesEleInvalidateKey);this.setupDequeueing()},Td=fi.prototype;Td.reasons=Fh;Td.getTextureQueue=function(a){return this.eleImgCaches=this.eleImgCaches||{},this.eleImgCaches[a]=this.eleImgCaches[a]||[]};Td.getRetiredTextureQueue=function(a){var b=this.eleImgCaches.retired=this.eleImgCaches.retired||{};return b[a]=b[a]||[]};Td.getElementQueue=function(){return this.eleCacheQueue=this.eleCacheQueue||new xg(function(a,b){return b.reqs-
a.reqs})};Td.getElementKeyToQueue=function(){return this.eleKeyToCacheQueue=this.eleKeyToCacheQueue||{}};Td.getElement=function(a,b,c,d,f){var h=this.renderer,l=h.cy.zoom(),m=this.lookup;if(!b||0===b.w||0===b.h||isNaN(b.w)||isNaN(b.h)||!a.visible()||a.removed()||!this.allowEdgeTxrCaching&&a.isEdge()||!this.allowParentTxrCaching&&a.isParent())return null;if(null==d&&(d=Math.ceil(Th(l*c))),-4>d)d=-4;else if(7.99<=l||3<d)return null;l=Math.pow(2,d);var t=b.h*l,v=b.w*l;h=h.eleTextBiggerThanMin(a,l);if(!this.isVisible(a,
h))return null;var C=m.get(a,d);if(C&&C.invalidated&&(C.invalidated=!1,C.texture.invalidatedWidth-=C.width),C)return C;var D;if(25>=t?D=25:50>=t?D=50:D=50*Math.ceil(t/50),1024<t||1024<v)return null;var F=this.getTextureQueue(D),I=F[F.length-2];I||=F[F.length-1];I||=this.recycleTexture(D,v)||this.addTexture(D,v);I.width-I.usedWidth<v&&(I=this.recycleTexture(D,v)||this.addTexture(D,v));F=f&&f===Fh.dequeue;var K=f&&f===Fh.highQuality;f=f&&f===Fh.downscale;for(var P,ba=d+1;3>=ba;ba++){var X=m.get(a,ba);
if(X){P=X;break}}var Y=P&&P.level===d+1?P:null;ba=function(){I.context.drawImage(Y.texture.canvas,Y.x,0,Y.width,Y.height,I.usedWidth,0,v,t)};if(I.context.setTransform(1,0,0,1,0,0),I.context.clearRect(I.usedWidth,0,v,D),Y&&Y.scaledLabelShown===h)ba();else if(P&&P.scaledLabelShown===h)if(K){for(var ta=P.level;ta>d;ta--)Y=this.getElement(a,b,c,ta,Fh.downscale);ba()}else return this.queueElement(a,P.level-1),P;else{if(!F&&!K&&!f)for(c=d-1;-4<=c;c--)if(D=m.get(a,c)){ta=D;break}if(ta&&ta.scaledLabelShown===
h)return this.queueElement(a,d),ta;I.context.translate(I.usedWidth,0);I.context.scale(l,l);this.drawElement(I.context,a,b,h,!1);I.context.scale(1/l,1/l);I.context.translate(-I.usedWidth,0)}return C={x:I.usedWidth,texture:I,level:d,scale:l,width:v,height:t,scaledLabelShown:h},I.usedWidth+=Math.ceil(v+8),I.eleCaches.push(C),m.set(a,d,C),this.checkTextureFullness(I),C};Td.invalidateElements=function(a){for(var b=0;b<a.length;b++)this.invalidateElement(a[b])};Td.invalidateElement=function(a){var b=this.lookup,
c=[];if(b.isInvalid(a)){for(var d=-4;3>=d;d++){var f=b.getForCachedKey(a,d);f&&c.push(f)}if(b.invalidate(a))for(b=0;b<c.length;b++)d=c[b],f=d.texture,f.invalidatedWidth+=d.width,d.invalidated=!0,this.checkTextureUtility(f);this.removeFromQueue(a)}};Td.checkTextureUtility=function(a){a.invalidatedWidth>=.2*a.width&&this.retireTexture(a)};Td.checkTextureFullness=function(a){var b=this.getTextureQueue(a.height);.8<a.usedWidth/a.width&&10<=a.fullnessChecks?ff(b,a):a.fullnessChecks++};Td.retireTexture=
function(a){var b=a.height,c=this.getTextureQueue(b),d=this.lookup;ff(c,a);a.retired=!0;c=a.eleCaches;for(var f=0;f<c.length;f++){var h=c[f];d.deleteCache(h.key,h.level)}bi(c);this.getRetiredTextureQueue(b).push(a)};Td.addTexture=function(a,b){var c={};return this.getTextureQueue(a).push(c),c.eleCaches=[],c.height=a,c.width=Math.max(1024,b),c.usedWidth=0,c.invalidatedWidth=0,c.fullnessChecks=0,c.canvas=this.renderer.makeOffscreenCanvas(c.width,c.height),c.context=c.canvas.getContext("2d"),c};Td.recycleTexture=
function(a,b){var c=this.getTextureQueue(a);a=this.getRetiredTextureQueue(a);for(var d=0;d<a.length;d++){var f=a[d];if(f.width>=b)return f.retired=!1,f.usedWidth=0,f.invalidatedWidth=0,f.fullnessChecks=0,bi(f.eleCaches),f.context.setTransform(1,0,0,1,0,0),f.context.clearRect(0,0,f.width,f.height),ff(a,f),c.push(f),f}};Td.queueElement=function(a,b){var c=this.getElementQueue(),d=this.getElementKeyToQueue(),f=this.getKey(a),h=d[f];h?(h.level=Math.max(h.level,b),h.eles.merge(a),h.reqs++,c.updateItem(h)):
(a={eles:a.spawn().merge(a),level:b,reqs:1,key:f},c.push(a),d[f]=a)};Td.dequeue=function(a){for(var b=this.getElementQueue(),c=this.getElementKeyToQueue(),d=[],f=this.lookup,h=0;1>h&&0<b.size();h++){var l=b.pop(),m=l.key,t=l.eles[0],v=f.hasCache(t,l.level);(c[m]=null,v)||(d.push(l),m=this.getBoundingBox(t),this.getElement(t,m,a,l.level,Fh.dequeue))}return d};Td.removeFromQueue=function(a){var b=this.getElementQueue(),c=this.getElementKeyToQueue(),d=this.getKey(a),f=c[d];null!=f&&(1===f.eles.length?
(f.reqs=Uf,b.updateItem(f),b.pop(),c[d]=null):f.eles.unmerge(a))};Td.onDequeue=function(a){this.onDequeues.push(a)};Td.offDequeue=function(a){ff(this.onDequeues,a)};Td.setupDequeueing=co.setupDequeueing({deqRedrawThreshold:100,deqCost:.15,deqAvgCost:.1,deqNoDrawCost:.9,deqFastCost:.9,deq:function(a,b,c){return a.dequeue(b,c)},onDeqd:function(a,b){for(var c=0;c<a.onDequeues.length;c++)(0,a.onDequeues[c])(b)},shouldRedraw:function(a,b,c,d){for(a=0;a<b.length;a++){c=b[a].eles;for(var f=0;f<c.length;f++){var h=
c[f].boundingBox();if(zf(h,d))return!0}}return!1},priority:function(a){return a.renderer.beforeRenderPriorities.eleTxrDeq}});var gn=function(a){var b=this;a=b.renderer=a;var c=a.cy;b.layersByLevel={};b.firstGet=!0;b.lastInvalidationTime=Be()-500;b.skipping=!1;b.eleTxrDeqs=c.collection();b.scheduleElementRefinement=ne(function(){b.refineElementTextures(b.eleTxrDeqs);b.eleTxrDeqs.unmerge(b.eleTxrDeqs)},50);a.beforeRender(function(d,f){250>=f-b.lastInvalidationTime?b.skipping=!0:b.skipping=!1},a.beforeRenderPriorities.lyrTxrSkip);
b.layersQueue=new xg(function(d,f){return f.reqs-d.reqs});b.setupDequeueing()},ee=gn.prototype,eo=0,Kq=Math.pow(2,53)-1;ee.makeLayer=function(a,b){var c=Math.pow(2,b),d=Math.ceil(a.w*c),f=Math.ceil(a.h*c),h=this.renderer.makeOffscreenCanvas(d,f);a={id:eo=++eo%Kq,bb:a,level:b,width:d,height:f,canvas:h,context:h.getContext("2d"),eles:[],elesQueue:[],reqs:0};b=a.context;d=-a.bb.x1;f=-a.bb.y1;return b.scale(c,c),b.translate(d,f),a};ee.getLayers=function(a,b,c){var d=this,f=d.renderer.cy.zoom(),h=d.firstGet;
if(d.firstGet=!1,null==c)if(c=Math.ceil(Th(f*b)),-4>c)c=-4;else if(3.99<=f||2<c)return null;d.validateLayersElesOrdering(c,a);var l=d.layersByLevel,m=Math.pow(2,c),t=l[c]=l[c]||[],v,C;if(d.levelIsComplete(c,a))return t;(function(){var X=function(ja){if(d.validateLayersElesOrdering(ja,a),d.levelIsComplete(ja,a))return C=l[ja],!0},Y=function(ja){if(!C)for(var Ba=c+ja;-4<=Ba&&2>=Ba&&!X(Ba);Ba+=ja);};Y(1);Y(-1);for(Y=t.length-1;0<=Y;Y--){var ta=t[Y];ta.invalid&&ff(t,ta)}})();f=function(X){X=X||{};var Y=
X.after;if(!v){v=ae();for(var ta=0;ta<a.length;ta++)Bg(v,a[ta].boundingBox())}ta=Math.ceil(v.w*m);var ja=Math.ceil(v.h*m);if(32767<ta||32767<ja||16E6<ta*ja)return null;ta=d.makeLayer(v,c);null!=Y?(X=t.indexOf(Y)+1,t.splice(X,0,ta)):(void 0===X.insert||X.insert)&&t.unshift(ta);return ta};if(d.skipping&&!h)return null;var D=null,F=a.length/1;h=!h;for(var I=0;I<a.length;I++){var K=a[I],P=K._private.rscratch;P=P.imgLayerCaches=P.imgLayerCaches||{};var ba=P[c];if(ba)D=ba;else{if((!D||D.eles.length>=F||
!Wj(D.bb,K.boundingBox()))&&(D=f({insert:!0,after:D}),!D))return null;C||h?d.queueLayer(D,K):d.drawEleInLayer(D,K,c,b);D.eles.push(K);P[c]=D}}return C||(h?null:t)};ee.getEleLevelForLayerLevel=function(a,b){return a};ee.drawEleInLayer=function(a,b,c,d){var f=this.renderer;a=a.context;var h=b.boundingBox();0===h.w||0===h.h||!b.visible()||(c=this.getEleLevelForLayerLevel(c,d),f.setImgSmoothing(a,!1),f.drawCachedElement(a,b,null,null,c,!0),f.setImgSmoothing(a,!0))};ee.levelIsComplete=function(a,b){a=
this.layersByLevel[a];if(!a||0===a.length)return!1;for(var c=0,d=0;d<a.length;d++){var f=a[d];if(0<f.reqs||f.invalid)return!1;c+=f.eles.length}return c===b.length};ee.validateLayersElesOrdering=function(a,b){if(a=this.layersByLevel[a])for(var c=0;c<a.length;c++){for(var d=a[c],f=-1,h=0;h<b.length;h++)if(d.eles[0]===b[h]){f=h;break}if(0>f)this.invalidateLayer(d);else for(h=0;h<d.eles.length;h++)if(d.eles[h]!==b[f+h]){this.invalidateLayer(d);break}}};ee.updateElementsInLayers=function(a,b){for(var c=
Kf(a[0]),d=0;d<a.length;d++){var f=c?null:a[d],h=c?a[d]:a[d].ele,l=h._private.rscratch;l=l.imgLayerCaches=l.imgLayerCaches||{};for(var m=-4;2>=m;m++){var t=l[m];t&&(f&&this.getEleLevelForLayerLevel(t.level)!==f.level||b(t,h,f))}}};ee.haveLayers=function(){for(var a=!1,b=-4;2>=b;b++){var c=this.layersByLevel[b];if(c&&0<c.length){a=!0;break}}return a};ee.invalidateElements=function(a){var b=this;0!==a.length&&(b.lastInvalidationTime=Be(),0!==a.length&&b.haveLayers()&&b.updateElementsInLayers(a,function(c,
d,f){b.invalidateLayer(c)}))};ee.invalidateLayer=function(a){if(this.lastInvalidationTime=Be(),!a.invalid){var b=a.level,c=a.eles;ff(this.layersByLevel[b],a);a.elesQueue=[];a.invalid=!0;a.replacement&&(a.replacement.invalid=!0);for(a=0;a<c.length;a++){var d=c[a]._private.rscratch.imgLayerCaches;d&&(d[b]=null)}}};ee.refineElementTextures=function(a){var b=this;b.updateElementsInLayers(a,function(c,d,f){d=c.replacement;if(d||(d=c.replacement=b.makeLayer(c.bb,c.level),d.replaces=c,d.eles=c.eles),!d.reqs)for(c=
0;c<d.eles.length;c++)b.queueLayer(d,d.eles[c])})};ee.enqueueElementRefinement=function(a){this.eleTxrDeqs.merge(a);this.scheduleElementRefinement()};ee.queueLayer=function(a,b){var c=this.layersQueue,d=a.elesQueue,f=d.hasId=d.hasId||{};if(!a.replacement){if(b){if(f[b.id()])return;d.push(b);f[b.id()]=!0}a.reqs?(a.reqs++,c.updateItem(a)):(a.reqs=1,c.push(a))}};ee.dequeue=function(a){for(var b=this.layersQueue,c=[],d=0;1>d&&0!==b.size();){var f=b.peek();if(f.replacement)b.pop();else if(f.replaces&&
f!==f.replaces.replacement)b.pop();else if(f.invalid)b.pop();else{var h=f.elesQueue.shift();h&&(this.drawEleInLayer(f,h,f.level,a),d++);0===c.length&&c.push(!0);0===f.elesQueue.length&&(b.pop(),f.reqs=0,f.replaces&&this.applyLayerReplacement(f),this.requestRedraw())}}return c};ee.applyLayerReplacement=function(a){var b=this.layersByLevel[a.level],c=a.replaces,d=b.indexOf(c);if(!(0>d||c.invalid)){b[d]=a;for(b=0;b<a.eles.length;b++)c=a.eles[b]._private,(c.imgLayerCaches=c.imgLayerCaches||{})[a.level]=
a;this.requestRedraw()}};ee.requestRedraw=ne(function(){var a=this.renderer;a.redrawHint("eles",!0);a.redrawHint("drag",!0);a.redraw()},100);ee.setupDequeueing=co.setupDequeueing({deqRedrawThreshold:50,deqCost:.15,deqAvgCost:.1,deqNoDrawCost:.9,deqFastCost:.9,deq:function(a,b){return a.dequeue(b)},onDeqd:wg,shouldRedraw:$h,priority:function(a){return a.renderer.beforeRenderPriorities.lyrTxrDeq}});var fo={},Lq;fo.arrowShapeImpl=function(a){return(Lq||={polygon:ma,"triangle-backcurve":Ia,"triangle-tee":cb,
"circle-triangle":jb,"triangle-cross":cb,circle:Eb})[a]};var Gh={drawElement:function(a,b,c,d,f,h){b.isNode()?this.drawNode(a,b,c,d,f,h):this.drawEdge(a,b,c,d,f,h)},drawElementOverlay:function(a,b){b.isNode()?this.drawNodeOverlay(a,b):this.drawEdgeOverlay(a,b)},drawElementUnderlay:function(a,b){b.isNode()?this.drawNodeUnderlay(a,b):this.drawEdgeUnderlay(a,b)},drawCachedElementPortion:function(a,b,c,d,f,h,l,m){var t=c.getBoundingBox(b);if(0!==t.w&&0!==t.h)if(d=c.getElement(b,t,d,f,h),null!=d){if(m=
m(this,b),0!==m){l=l(this,b);var v=t.x1;h=t.y1;f=t.w;t=t.h;var C;if(0!==l){var D=c.getRotationPoint(b);var F=D.x;D=D.y;a.translate(F,D);a.rotate(l);(C=this.getImgSmoothing(a))||this.setImgSmoothing(a,!0);c=c.getRotationOffset(b);b=c.x;c=c.y}else b=v,c=h;var I;1!==m&&(I=a.globalAlpha,a.globalAlpha=I*m);a.drawImage(d.texture.canvas,d.x,0,d.width,d.height,b,c,f,t);1!==m&&(a.globalAlpha=I);0!==l&&(a.rotate(-l),a.translate(-F,-D),C||this.setImgSmoothing(a,!1))}}else c.drawElement(a,b)}},Mq=function(){return 0},
Nq=function(a,b){return a.getTextAngle(b,null)},Oq=function(a,b){return a.getTextAngle(b,"source")},Pq=function(a,b){return a.getTextAngle(b,"target")},Qq=function(a,b){return b.effectiveOpacity()},ql=function(a,b){return b.pstyle("text-opacity").pfValue*b.effectiveOpacity()};Gh.drawCachedElement=function(a,b,c,d,f,h){var l=this.data,m=l.eleTxrCache,t=l.lblTxrCache,v=l.slbTxrCache;l=l.tlbTxrCache;var C=b.boundingBox();h=!0===h?m.reasons.highQuality:null;0===C.w||0===C.h||!b.visible()||d&&!zf(C,d)||
(d=b.isEdge(),C=b.element()._private.rscratch.badLine,this.drawElementUnderlay(a,b),this.drawCachedElementPortion(a,b,m,c,f,h,Mq,Qq),d&&C||this.drawCachedElementPortion(a,b,t,c,f,h,Nq,ql),d&&!C&&(this.drawCachedElementPortion(a,b,v,c,f,h,Oq,ql),this.drawCachedElementPortion(a,b,l,c,f,h,Pq,ql)),this.drawElementOverlay(a,b))};Gh.drawElements=function(a,b){for(var c=0;c<b.length;c++)this.drawElement(a,b[c])};Gh.drawCachedElements=function(a,b,c,d){for(var f=0;f<b.length;f++)this.drawCachedElement(a,
b[f],c,d)};Gh.drawCachedNodes=function(a,b,c,d){for(var f=0;f<b.length;f++){var h=b[f];h.isNode()&&this.drawCachedElement(a,h,c,d)}};Gh.drawLayeredElements=function(a,b,c,d){var f=this.data.lyrTxrCache.getLayers(b,c);if(f)for(b=0;b<f.length;b++)c=f[b],d=c.bb,0===d.w||0===d.h||a.drawImage(c.canvas,d.x1,d.y1,d.w,d.h);else this.drawCachedElements(a,b,c,d)};var eg={drawEdge:function(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!0,f=4<arguments.length&&void 0!==arguments[4]?arguments[4]:
!0,h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:!0,l=this,m=b._private.rscratch;if(!(h&&!b.visible()||m.badLine||null==m.allpts||isNaN(m.allpts[0]))){var t;c&&(t=c,a.translate(-t.x1,-t.y1));var v=h?b.pstyle("opacity").value:1;h=h?b.pstyle("line-opacity").value:1;var C=b.pstyle("curve-style").value,D=b.pstyle("line-style").value,F=b.pstyle("width").pfValue,I=b.pstyle("line-cap").value,K=b.pstyle("line-outline-width").value,P=b.pstyle("line-outline-color").value,ba=v*h,X=v*h;v=function(){var Ba=
0<arguments.length&&void 0!==arguments[0]?arguments[0]:ba;"straight-triangle"===C?(l.eleStrokeStyle(a,b,Ba),l.drawEdgeTrianglePath(b,a,m.allpts)):(a.lineWidth=F,a.lineCap=I,l.eleStrokeStyle(a,b,Ba),l.drawEdgePath(b,a,m.allpts,D),a.lineCap="butt")};var Y=function(){var Ba=0<arguments.length&&void 0!==arguments[0]?arguments[0]:ba;(a.lineWidth=F+K,a.lineCap=I,0<K)?(l.colorStrokeStyle(a,P[0],P[1],P[2],Ba),"straight-triangle"===C?l.drawEdgeTrianglePath(b,a,m.allpts):(l.drawEdgePath(b,a,m.allpts,D),a.lineCap=
"butt")):a.lineCap="butt"};h=function(){l.drawArrowheads(a,b,0<arguments.length&&void 0!==arguments[0]?arguments[0]:X)};a.lineJoin="round";if("yes"===b.pstyle("ghost").value){Y=b.pstyle("ghost-offset-x").pfValue;var ta=b.pstyle("ghost-offset-y").pfValue,ja=b.pstyle("ghost-opacity").value;ja*=ba;a.translate(Y,ta);v(ja);h(ja);a.translate(-Y,-ta)}else Y();f&&l.drawEdgeUnderlay(a,b);v();h();f&&l.drawEdgeOverlay(a,b);l.drawElementText(a,b,null,d);c&&a.translate(t.x1,t.y1)}}},go=function(a){if(!["overlay",
"underlay"].includes(a))throw Error("Invalid state");return function(b,c){if(c.visible()){var d=c.pstyle("".concat(a,"-opacity")).value;if(0!==d){var f=this.usePaths(),h=c._private.rscratch,l=2*c.pstyle("".concat(a,"-padding")).pfValue,m=c.pstyle("".concat(a,"-color")).value;b.lineWidth=l;"self"!==h.edgeType||f?b.lineCap="round":b.lineCap="butt";this.colorStrokeStyle(b,m[0],m[1],m[2],d);this.drawEdgePath(c,b,h.allpts,"solid")}}}};eg.drawEdgeOverlay=go("overlay");eg.drawEdgeUnderlay=go("underlay");
eg.drawEdgePath=function(a,b,c,d){var f=a._private.rscratch,h=b,l,m=!1,t=this.usePaths(),v=a.pstyle("line-dash-pattern").pfValue;a=a.pstyle("line-dash-offset").pfValue;if(t){var C=c.join("$");f.pathCacheKey&&f.pathCacheKey===C?(l=b=f.pathCache,m=!0):(l=b=new Path2D,f.pathCacheKey=C,f.pathCache=l)}if(h.setLineDash)switch(d){case "dotted":h.setLineDash([1,1]);break;case "dashed":h.setLineDash(v);h.lineDashOffset=a;break;case "solid":h.setLineDash([])}if(!m&&!f.badLine)switch(b.beginPath&&b.beginPath(),
b.moveTo(c[0],c[1]),f.edgeType){case "bezier":case "self":case "compound":case "multibezier":for(var D=2;D+3<c.length;D+=4)b.quadraticCurveTo(c[D],c[D+1],c[D+2],c[D+3]);break;case "straight":case "haystack":for(D=2;D+1<c.length;D+=2)b.lineTo(c[D],c[D+1]);break;case "segments":if(f.isRound){d=y(f.roundCorners);try{for(d.s();!(D=d.n()).done;)L(b,D.value)}catch(F){d.e(F)}finally{d.f()}b.lineTo(c[c.length-2],c[c.length-1])}else for(D=2;D+1<c.length;D+=2)b.lineTo(c[D],c[D+1])}b=h;t?b.stroke(l):b.stroke();
b.setLineDash&&b.setLineDash([])};eg.drawEdgeTrianglePath=function(a,b,c){b.fillStyle=b.strokeStyle;a=a.pstyle("width").pfValue;for(var d=0;d+1<c.length;d+=2){var f=[c[d+2]-c[d],c[d+3]-c[d+1]],h=Math.sqrt(f[0]*f[0]+f[1]*f[1]);f=[f[1]/h,-f[0]/h];f=[f[0]*a/2,f[1]*a/2];b.beginPath();b.moveTo(c[d]-f[0],c[d+1]-f[1]);b.lineTo(c[d]+f[0],c[d+1]+f[1]);b.lineTo(c[d+2],c[d+3]);b.closePath();b.fill()}};eg.drawArrowheads=function(a,b,c){var d=b._private.rscratch,f="haystack"===d.edgeType;f||this.drawArrowhead(a,
b,"source",d.arrowStartX,d.arrowStartY,d.srcArrowAngle,c);this.drawArrowhead(a,b,"mid-target",d.midX,d.midY,d.midtgtArrowAngle,c);this.drawArrowhead(a,b,"mid-source",d.midX,d.midY,d.midsrcArrowAngle,c);f||this.drawArrowhead(a,b,"target",d.arrowEndX,d.arrowEndY,d.tgtArrowAngle,c)};eg.drawArrowhead=function(a,b,c,d,f,h,l){if(!(isNaN(d)||null==d||isNaN(f)||null==f||isNaN(h)||null==h)){var m=b.pstyle(c+"-arrow-shape").value;if("none"!==m){var t="hollow"===b.pstyle(c+"-arrow-fill").value?"both":"filled",
v=b.pstyle(c+"-arrow-fill").value,C=b.pstyle("width").pfValue,D=b.pstyle(c+"-arrow-width"),F="match-line"===D.value?C:D.pfValue;"%"===D.units&&(F*=C);D=b.pstyle("opacity").value;void 0===l&&(l=D);D=a.globalCompositeOperation;(1!==l||"hollow"===v)&&(a.globalCompositeOperation="destination-out",this.colorFillStyle(a,255,255,255,1),this.colorStrokeStyle(a,255,255,255,1),this.drawArrowShape(b,a,t,C,m,F,d,f,h),a.globalCompositeOperation=D);c=b.pstyle(c+"-arrow-color").value;this.colorFillStyle(a,c[0],
c[1],c[2],l);this.colorStrokeStyle(a,c[0],c[1],c[2],l);this.drawArrowShape(b,a,v,C,m,F,d,f,h)}}};eg.drawArrowShape=function(a,b,c,d,f,h,l,m,t){var v=this.usePaths()&&"triangle-cross"!==f,C=!1,D,F=b,I={x:l,y:m};a=a.pstyle("arrow-scale").value;a=this.getArrowWidth(d,a);var K=this.arrowShapes[f];if(v){var P=this.arrowPathCache=this.arrowPathCache||[];f=wf(f);var ba=P[f];null!=ba?(D=b=ba,C=!0):(D=b=new Path2D,P[f]=D)}C||(b.beginPath&&b.beginPath(),v?K.draw(b,1,0,{x:0,y:0},1):K.draw(b,a,t,I,d),b.closePath&&
b.closePath());b=F;v&&(b.translate(l,m),b.rotate(t),b.scale(a,a));("filled"===c||"both"===c)&&(v?b.fill(D):b.fill());("hollow"===c||"both"===c)&&(b.lineWidth=h/(v?a:1),b.lineJoin="miter",v?b.stroke(D):b.stroke());v&&(b.scale(1/a,1/a),b.rotate(-t),b.translate(-l,-m))};var Og={drawNode:function(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!0,f=4<arguments.length&&void 0!==arguments[4]?arguments[4]:!0,h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:!0,l=this,m=b._private,
t=m.rscratch,v=b.position();if(cc(v.x)&&cc(v.y)&&(!h||b.visible())){var C=h?b.effectiveOpacity():1,D=l.usePaths(),F=!1;h=b.padding();var I=b.width()+2*h;var K=b.height()+2*h;var P;c&&(P=c,a.translate(-P.x1,-P.y1));h=b.pstyle("background-image").value;for(var ba=Array(h.length),X=Array(h.length),Y=0,ta=0;ta<h.length;ta++){var ja=h[ta];if(ba[ta]=null!=ja&&"none"!==ja){var Ba=b.cy().style().getIndexedStyle(b,"background-image-crossorigin","value",ta);Y++;X[ta]=l.getCachedImage(ja,Ba,function(){m.backgroundTimestamp=
Date.now();b.emitAndNotify("background")})}}var Ua=b.pstyle("background-blacken").value,ab=b.pstyle("border-width").pfValue,Qb=b.pstyle("background-opacity").value*C,Mb=b.pstyle("border-color").value,Ub=b.pstyle("border-style").value,Wb=b.pstyle("border-join").value,Yb=b.pstyle("border-cap").value,ub=b.pstyle("border-position").value,Kb=b.pstyle("border-dash-pattern").pfValue,Zb=b.pstyle("border-dash-offset").pfValue,dc=b.pstyle("border-opacity").value*C,ac=b.pstyle("outline-width").pfValue,vb=b.pstyle("outline-color").value,
Tb=b.pstyle("outline-style").value,jc=b.pstyle("outline-opacity").value*C,kc=b.pstyle("outline-offset").value,tc=b.pstyle("corner-radius").value;"auto"!==tc&&(tc=b.pstyle("corner-radius").pfValue);h=function(){l.eleFillStyle(a,b,0<arguments.length&&void 0!==arguments[0]?arguments[0]:Qb)};ta=function(){l.colorStrokeStyle(a,Mb[0],Mb[1],Mb[2],0<arguments.length&&void 0!==arguments[0]?arguments[0]:dc)};ja=function(){l.colorStrokeStyle(a,vb[0],vb[1],vb[2],0<arguments.length&&void 0!==arguments[0]?arguments[0]:
jc)};var Xc=function(Mc,la,Xa,ob){var wb=l.nodePathCache=l.nodePathCache||[];Mc=zi("polygon"===Xa?Xa+","+ob.join(","):Xa,""+la,""+Mc,""+tc);la=wb[Mc];var lb;Xa=!1;return null!=la?(lb=la,Xa=!0,t.pathCache=lb):(lb=new Path2D,wb[Mc]=t.pathCache=lb),{path:lb,cacheHit:Xa}};Ba=b.pstyle("shape").strValue;var Ad=b.pstyle("shape-polygon-points").pfValue;if(D){a.translate(v.x,v.y);Ba=Xc(I,K,Ba,Ad);var Ac=Ba.path;F=Ba.cacheHit}Ba=function(){if(!F){var Mc=v;D&&(Mc={x:0,y:0});l.nodeShapes[l.getNodeShape(b)].draw(Ac||
a,Mc.x,Mc.y,I,K,tc,t)}D?a.fill(Ac):a.fill()};Ad=function(){for(var Mc=0<arguments.length&&void 0!==arguments[0]?arguments[0]:C,la=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,Xa=m.backgrounding,ob=0,wb=0;wb<X.length;wb++){var lb=b.cy().style().getIndexedStyle(b,"background-image-containment","value",wb);la&&"over"===lb||!la&&"inside"===lb?ob++:ba[wb]&&X[wb].complete&&!X[wb].error&&(ob++,l.drawInscribedImage(a,X[wb],b,wb,Mc))}m.backgrounding=ob!==Y;Xa!==m.backgrounding&&b.updateStyle(!1)};
var Pc=function(){var Mc=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!1,la=1<arguments.length&&void 0!==arguments[1]?arguments[1]:C;l.hasPie(b)&&(l.drawPie(a,b,la),Mc&&(D||l.nodeShapes[l.getNodeShape(b)].draw(a,v.x,v.y,I,K,tc,t)))},Sc=function(){var Mc=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!1,la=1<arguments.length&&void 0!==arguments[1]?arguments[1]:C;l.hasStripe(b)&&(a.save(),D?a.clip(t.pathCache):(l.nodeShapes[l.getNodeShape(b)].draw(a,v.x,v.y,I,K,tc,t),a.clip()),l.drawStripe(a,
b,la),a.restore(),Mc&&(D||l.nodeShapes[l.getNodeShape(b)].draw(a,v.x,v.y,I,K,tc,t)))},pd=function(){var Mc=(0<Ua?Ua:-Ua)*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:C),la=0<Ua?0:255;0!==Ua&&(l.colorFillStyle(a,la,la,la,Mc),D?a.fill(Ac):a.fill())},Kd=function(){if(0<ab){if(a.lineWidth=ab,a.lineCap=Yb,a.lineJoin=Wb,a.setLineDash)switch(Ub){case "dotted":a.setLineDash([1,1]);break;case "dashed":a.setLineDash(Kb);a.lineDashOffset=Zb;break;case "solid":case "double":a.setLineDash([])}if("center"!==
ub){if(a.save(),a.lineWidth*=2,"inside"===ub)D?a.clip(Ac):a.clip();else{var Mc=new Path2D;Mc.rect(-I/2-ab,-K/2-ab,I+2*ab,K+2*ab);Mc.addPath(Ac);a.clip(Mc,"evenodd")}D?a.stroke(Ac):a.stroke();a.restore()}else D?a.stroke(Ac):a.stroke();"double"===Ub&&(a.lineWidth=ab/3,Mc=a.globalCompositeOperation,a.globalCompositeOperation="destination-out",D?a.stroke(Ac):a.stroke(),a.globalCompositeOperation=Mc);a.setLineDash&&a.setLineDash([])}},de=function(){if(0<ac){if(a.lineWidth=ac,a.lineCap="butt",a.setLineDash)switch(Tb){case "dotted":a.setLineDash([1,
1]);break;case "dashed":a.setLineDash([4,2]);break;case "solid":case "double":a.setLineDash([])}var Mc=v;D&&(Mc={x:0,y:0});var la=l.getNodeShape(b),Xa=ab;"inside"===ub&&(Xa=0);"outside"===ub&&(Xa*=2);var ob=(I+Xa+(ac+kc))/I,wb=(K+Xa+(ac+kc))/K,lb=I*ob,Vb=K*wb,bc=l.nodeShapes[la].points;if(D)var Ob=Xc(lb,Vb,la,bc).path;if("ellipse"===la)l.drawEllipsePath(Ob||a,Mc.x,Mc.y,lb,Vb);else if("round-diamond round-heptagon round-hexagon round-octagon round-pentagon round-polygon round-triangle round-tag".split(" ").includes(la)){var nc=
0,Hc=0,Qc=0;"round-diamond"===la?nc=1.4*(Xa+kc+ac):"round-heptagon"===la?(nc=1.075*(Xa+kc+ac),Qc=-(Xa/2+kc+ac)/35):"round-hexagon"===la?nc=1.12*(Xa+kc+ac):"round-pentagon"===la?(nc=1.13*(Xa+kc+ac),Qc=-(Xa/2+kc+ac)/15):"round-tag"===la?(nc=1.12*(Xa+kc+ac),Hc=.07*(Xa/2+ac+kc)):"round-triangle"===la&&(nc=Math.PI/2*(Xa+kc+ac),Qc=-(Xa+kc/2+ac)/Math.PI);0!==nc&&(ob=(I+nc)/I,lb=I*ob,["round-hexagon","round-tag"].includes(la)||(wb=(K+nc)/K,Vb=K*wb));tc="auto"===tc?Math.min(lb/10,Vb/10,8):tc;nc=lb/2;var id=
Vb/2;Vb=tc+(Xa+ac+kc)/2;la=Array(bc.length/2);lb=Array(bc.length/2);for(var hd=0;hd<bc.length/2;hd++)la[hd]={x:Mc.x+Hc+nc*bc[2*hd],y:Mc.y+Qc+id*bc[2*hd+1]};var md=la.length;id=la[md-1];for(nc=0;nc<md;nc++){hd=la[nc%md];var Bd=la[(nc+1)%md];lb[nc]=O(id,hd,Bd,Vb);id=hd}l.drawRoundPolygonPath(Ob||a,Mc.x+Hc,Mc.y+Qc,I*ob,K*wb,bc,lb)}else["roundrectangle","round-rectangle"].includes(la)?(tc="auto"===tc?Ue(lb,Vb):tc,l.drawRoundRectanglePath(Ob||a,Mc.x,Mc.y,lb,Vb,tc+(Xa+ac+kc)/2)):["cutrectangle","cut-rectangle"].includes(la)?
(tc="auto"===tc?8:tc,l.drawCutRectanglePath(Ob||a,Mc.x,Mc.y,lb,Vb,null,tc+(Xa+ac+kc)/4)):["bottomroundrectangle","bottom-round-rectangle"].includes(la)?(tc="auto"===tc?Ue(lb,Vb):tc,l.drawBottomRoundRectanglePath(Ob||a,Mc.x,Mc.y,lb,Vb,tc+(Xa+ac+kc)/2)):"barrel"===la?l.drawBarrelPath(Ob||a,Mc.x,Mc.y,lb,Vb):(bc=la.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(la)?Dg(Bf(bc,(Xa+ac+kc)/I)):Dg(Bf(bc,-((Xa+ac+kc)/I))),l.drawPolygonPath(Ob||a,Mc.x,Mc.y,I,K,bc));if(D?
a.stroke(Ob):a.stroke(),"double"===Tb)a.lineWidth=Xa/3,Mc=a.globalCompositeOperation,a.globalCompositeOperation="destination-out",D?a.stroke(Ob):a.stroke(),a.globalCompositeOperation=Mc;a.setLineDash&&a.setLineDash([])}};if("yes"===b.pstyle("ghost").value){var ue=b.pstyle("ghost-offset-x").pfValue,Ng=b.pstyle("ghost-offset-y").pfValue,li=b.pstyle("ghost-opacity").value,dg=li*C;a.translate(ue,Ng);ja();de();h(li*Qb);Ba();Ad(dg,!0);ta(li*dc);Kd();Pc(0!==Ua||0!==ab);Sc(0!==Ua||0!==ab);Ad(dg,!1);pd(dg);
a.translate(-ue,-Ng)}D&&a.translate(-v.x,-v.y);f&&l.drawNodeUnderlay(a,b,v,I,K);D&&a.translate(v.x,v.y);ja();de();h();Ba();Ad(C,!0);ta();Kd();Pc(0!==Ua||0!==ab);Sc(0!==Ua||0!==ab);Ad(C,!1);pd();D&&a.translate(-v.x,-v.y);l.drawElementText(a,b,null,d);f&&l.drawNodeOverlay(a,b,v,I,K);c&&a.translate(P.x1,P.y1)}}},ho=function(a){if(!["overlay","underlay"].includes(a))throw Error("Invalid state");return function(b,c,d,f,h){if(c.visible()){var l=c.pstyle("".concat(a,"-padding")).pfValue,m=c.pstyle("".concat(a,
"-opacity")).value,t=c.pstyle("".concat(a,"-color")).value,v=c.pstyle("".concat(a,"-shape")).value,C=c.pstyle("".concat(a,"-corner-radius")).value;if(0<m){if(d=d||c.position(),null==f||null==h)h=c.padding(),f=c.width()+2*h,h=c.height()+2*h;this.colorFillStyle(b,t[0],t[1],t[2],m);this.nodeShapes[v].draw(b,d.x,d.y,f+2*l,h+2*l,C);b.fill()}}}};Og.drawNodeOverlay=ho("overlay");Og.drawNodeUnderlay=ho("underlay");Og.hasPie=function(a){return a=a[0],a._private.hasPie};Og.hasStripe=function(a){return a=a[0],
a._private.hasStripe};Og.drawPie=function(a,b,c,d){b=b[0];d=d||b.position();var f=b.cy().style(),h=b.pstyle("pie-size"),l=b.pstyle("pie-hole"),m=b.pstyle("pie-start-angle").pfValue,t=d.x;d=d.y;var v=b.width(),C=b.height();v=Math.min(v,C)/2;var D;C=0;if(this.usePaths()&&(t=0,d=0),"%"===h.units?v*=h.pfValue:void 0!==h.pfValue&&(v=h.pfValue/2),"%"===l.units?D=v*l.pfValue:void 0!==l.pfValue&&(D=l.pfValue/2),!(D>=v))for(h=1;h<=f.pieBackgroundN;h++){l=b.pstyle("pie-"+h+"-background-size").value;var F=b.pstyle("pie-"+
h+"-background-color").value,I=b.pstyle("pie-"+h+"-background-opacity").value*c,K=l/100;1<K+C&&(K=1-C);var P=1.5*Math.PI+2*Math.PI*C;P+=m;var ba=P+2*Math.PI*K;0===l||1<=C||1<C+K||(0===D?(a.beginPath(),a.moveTo(t,d),a.arc(t,d,v,P,ba),a.closePath()):(a.beginPath(),a.arc(t,d,v,P,ba),a.arc(t,d,D,ba,P,!0),a.closePath()),this.colorFillStyle(a,F[0],F[1],F[2],I),a.fill(),C+=K)}};Og.drawStripe=function(a,b,c,d){b=b[0];d=d||b.position();var f=b.cy().style(),h=d.x;d=d.y;var l=b.width(),m=b.height(),t=0,v=this.usePaths();
a.save();var C=b.pstyle("stripe-direction").value,D=b.pstyle("stripe-size");switch(C){case "righward":a.rotate(-Math.PI/2)}"%"===D.units?(l*=D.pfValue,m*=D.pfValue):void 0!==D.pfValue&&(l=D.pfValue,m=D.pfValue);v&&(h=0,d=0);d-=l/2;h-=m/2;for(v=1;v<=f.stripeBackgroundN;v++){D=b.pstyle("stripe-"+v+"-background-size").value;C=b.pstyle("stripe-"+v+"-background-color").value;var F=b.pstyle("stripe-"+v+"-background-opacity").value*c,I=D/100;1<I+t&&(I=1-t);!(0===D||1<=t||1<t+I)&&(a.beginPath(),a.rect(h,
d+m*t,l,m*I),a.closePath(),this.colorFillStyle(a,C[0],C[1],C[2],F),a.fill(),t+=I)}a.restore()};var io={getPixelRatio:function(){var a=this.data.contexts[0];return null!=this.forcedPixelRatio?this.forcedPixelRatio:(this.cy.window().devicePixelRatio||1)/(a.backingStorePixelRatio||a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1)},paintCache:function(a){for(var b=this.paintCaches=this.paintCaches||[],c=!0,
d,f=0;f<b.length;f++)if(d=b[f],d.context===a){c=!1;break}return c&&(d={context:a},b.push(d)),d},createGradientStyleFor:function(a,b,c,d,f){var h=this.usePaths(),l=c.pstyle(b+"-gradient-stop-colors").value;b=c.pstyle(b+"-gradient-stop-positions").pfValue;if("radial-gradient"===d)if(c.isEdge()){d=c.sourceEndpoint();var m=c.targetEndpoint();c=c.midpoint();d=gf(d,c);m=gf(m,c);m=a.createRadialGradient(c.x,c.y,0,c.x,c.y,Math.max(d,m))}else m=h?{x:0,y:0}:c.position(),d=c.paddedWidth(),c=c.paddedHeight(),
m=a.createRadialGradient(m.x,m.y,0,m.x,m.y,Math.max(d,c));else if(c.isEdge())m=c.sourceEndpoint(),c=c.targetEndpoint(),m=a.createLinearGradient(m.x,m.y,c.x,c.y);else{d=h?{x:0,y:0}:c.position();var t=c.paddedWidth();h=c.paddedHeight();t/=2;h/=2;switch(c.pstyle("background-gradient-direction").value){case "to-bottom":m=a.createLinearGradient(d.x,d.y-h,d.x,d.y+h);break;case "to-top":m=a.createLinearGradient(d.x,d.y+h,d.x,d.y-h);break;case "to-left":m=a.createLinearGradient(d.x+t,d.y,d.x-t,d.y);break;
case "to-right":m=a.createLinearGradient(d.x-t,d.y,d.x+t,d.y);break;case "to-bottom-right":case "to-right-bottom":m=a.createLinearGradient(d.x-t,d.y-h,d.x+t,d.y+h);break;case "to-top-right":case "to-right-top":m=a.createLinearGradient(d.x-t,d.y+h,d.x+t,d.y-h);break;case "to-bottom-left":case "to-left-bottom":m=a.createLinearGradient(d.x+t,d.y-h,d.x-t,d.y+h);break;case "to-top-left":case "to-left-top":m=a.createLinearGradient(d.x+t,d.y+h,d.x-t,d.y-h)}}if(!m)return null;a=b.length===l.length;c=l.length;
for(d=0;d<c;d++)m.addColorStop(a?b[d]:d/(c-1),"rgba("+l[d][0]+","+l[d][1]+","+l[d][2]+","+f+")");return m},gradientFillStyle:function(a,b,c,d){b=this.createGradientStyleFor(a,"background",b,c,d);if(!b)return null;a.fillStyle=b},colorFillStyle:function(a,b,c,d,f){a.fillStyle="rgba("+b+","+c+","+d+","+f+")"},eleFillStyle:function(a,b,c){var d=b.pstyle("background-fill").value;"linear-gradient"===d||"radial-gradient"===d?this.gradientFillStyle(a,b,d,c):(b=b.pstyle("background-color").value,this.colorFillStyle(a,
b[0],b[1],b[2],c))},gradientStrokeStyle:function(a,b,c,d){b=this.createGradientStyleFor(a,"line",b,c,d);if(!b)return null;a.strokeStyle=b},colorStrokeStyle:function(a,b,c,d,f){a.strokeStyle="rgba("+b+","+c+","+d+","+f+")"},eleStrokeStyle:function(a,b,c){var d=b.pstyle("line-fill").value;"linear-gradient"===d||"radial-gradient"===d?this.gradientStrokeStyle(a,b,d,c):(b=b.pstyle("line-color").value,this.colorStrokeStyle(a,b[0],b[1],b[2],c))},matchCanvasSize:function(a){var b=this.data,c=this.findContainerClientCoords(),
d=c[2];c=c[3];var f=this.getPixelRatio(),h=this.motionBlurPxRatio;a!==this.data.bufferCanvases[this.MOTIONBLUR_BUFFER_NODE]&&a!==this.data.bufferCanvases[this.MOTIONBLUR_BUFFER_DRAG]||(f=h);a=d*f;h=c*f;if(a!==this.canvasWidth||h!==this.canvasHeight){this.fontCaches=null;var l=b.canvasContainer;l.style.width=d+"px";l.style.height=c+"px";for(l=0;l<this.CANVAS_LAYERS;l++){var m=b.canvases[l];m.width=a;m.height=h;m.style.width=d+"px";m.style.height=c+"px"}for(l=0;l<this.BUFFER_COUNT;l++)m=b.bufferCanvases[l],
m.width=a,m.height=h,m.style.width=d+"px",m.style.height=c+"px";this.textureMult=1;1>=f&&(m=b.bufferCanvases[this.TEXTURE_BUFFER],this.textureMult=2,m.width=a*this.textureMult,m.height=h*this.textureMult);this.canvasWidth=a;this.canvasHeight=h;this.pixelRatio=f}},renderTo:function(a,b,c,d){this.render({forcedContext:a,forcedZoom:b,forcedPan:c,drawAllLayers:!0,forcedPxRatio:d})},clearCanvas:function(){var a=this.data;a.contexts[this.NODE].clearRect(0,0,this.canvasWidth,this.canvasHeight);a.contexts[this.DRAG].clearRect(0,
0,this.canvasWidth,this.canvasHeight)},render:function(a){function b(Yb,ub,Kb,Zb,dc){var ac=Yb.globalCompositeOperation;Yb.globalCompositeOperation="destination-out";d.colorFillStyle(Yb,255,255,255,d.motionBlurTransparency);Yb.fillRect(ub,Kb,Zb,dc);Yb.globalCompositeOperation=ac}function c(Yb,ub){var Kb,Zb,dc,ac;d.clearingMotionBlur||Yb!==D.bufferContexts[d.MOTIONBLUR_BUFFER_NODE]&&Yb!==D.bufferContexts[d.MOTIONBLUR_BUFFER_DRAG]?(Kb=Qb,Zb=Ua,dc=d.canvasWidth,ac=d.canvasHeight):(Kb={x:ab.x*P,y:ab.y*
P},Zb=Ba*P,dc=d.canvasWidth*P,ac=d.canvasHeight*P);Yb.setTransform(1,0,0,1,0,0);"motionBlur"===ub?b(Yb,0,0,dc,ac):!h&&(void 0===ub||ub)&&Yb.clearRect(0,0,dc,ac);l||(Yb.translate(Kb.x,Kb.y),Yb.scale(Zb,Zb));v&&Yb.translate(v.x,v.y);t&&Yb.scale(t,t)}var d=this;a=a||Ji;var f=d.cy,h=a.forcedContext,l=a.drawAllLayers,m=a.drawOnlyNodeLayer,t=a.forcedZoom,v=a.forcedPan,C=void 0===a.forcedPxRatio?this.getPixelRatio():a.forcedPxRatio,D=d.data,F=D.canvasNeedsRedraw,I=d.textureOnViewport&&!h&&(d.pinching||d.hoverData.dragging||
d.swipePanning||d.data.wheelZooming),K=void 0!==a.motionBlur?a.motionBlur:d.motionBlur,P=d.motionBlurPxRatio,ba=f.hasCompoundNodes(),X=d.hoverData.draggingEles,Y=!(!d.hoverData.selecting&&!d.touchData.selecting),ta=K=K&&!h&&d.motionBlurEnabled&&!Y;h||(d.prevPxRatio!==C&&(d.invalidateContainerClientCoordsCache(),d.matchCanvasSize(d.container),d.redrawHint("eles",!0),d.redrawHint("drag",!0)),d.prevPxRatio=C);!h&&d.motionBlurTimeout&&clearTimeout(d.motionBlurTimeout);K&&(null==d.mbFrames&&(d.mbFrames=
0),d.mbFrames++,3>d.mbFrames&&(ta=!1),d.mbFrames>d.minMbLowQualFrames&&(d.motionBlurPxRatio=d.mbPxRBlurry));d.clearingMotionBlur&&(d.motionBlurPxRatio=1);d.textureDrawLastFrame&&!I&&(F[d.NODE]=!0,F[d.SELECT_BOX]=!0);var ja=f.style(),Ba=f.zoom(),Ua=void 0!==t?t:Ba,ab=f.pan(),Qb={x:ab.x,y:ab.y};Y={zoom:Ba,pan:{x:ab.x,y:ab.y}};var Mb=d.prevViewport;void 0===Mb||Y.zoom!==Mb.zoom||Y.pan.x!==Mb.pan.x||Y.pan.y!==Mb.pan.y||X&&!ba||(d.motionBlurPxRatio=1);v&&(Qb=v);Ua*=C;Qb.x*=C;Qb.y*=C;ba=d.getCachedZSortedEles();
if(I||(d.textureDrawLastFrame=!1),I){(d.textureDrawLastFrame=!0,d.textureCache)||(d.textureCache={},d.textureCache.bb=f.mutableElements().boundingBox(),d.textureCache.texture=d.data.bufferCanvases[d.TEXTURE_BUFFER],Y=d.data.bufferContexts[d.TEXTURE_BUFFER],Y.setTransform(1,0,0,1,0,0),Y.clearRect(0,0,d.canvasWidth*d.textureMult,d.canvasHeight*d.textureMult),d.render({forcedContext:Y,drawOnlyNodeLayer:!0,forcedPxRatio:C*d.textureMult}),Y=d.textureCache.viewport={zoom:f.zoom(),pan:f.pan(),width:d.canvasWidth,
height:d.canvasHeight},Y.mpan={x:(0-Y.pan.x)/Y.zoom,y:(0-Y.pan.y)/Y.zoom});F[d.DRAG]=!1;F[d.NODE]=!1;X=D.contexts[d.NODE];Mb=d.textureCache.texture;Y=d.textureCache.viewport;X.setTransform(1,0,0,1,0,0);K?b(X,0,0,Y.width,Y.height):X.clearRect(0,0,Y.width,Y.height);var Ub=ja.core("outside-texture-bg-color").value;ja=ja.core("outside-texture-bg-opacity").value;d.colorFillStyle(X,Ub[0],Ub[1],Ub[2],ja);X.fillRect(0,0,Y.width,Y.height);Ba=f.zoom();c(X,!1);X.clearRect(Y.mpan.x,Y.mpan.y,Y.width/Y.zoom/C,
Y.height/Y.zoom/C);X.drawImage(Mb,Y.mpan.x,Y.mpan.y,Y.width/Y.zoom/C,Y.height/Y.zoom/C)}else d.textureOnViewport&&!h&&(d.textureCache=null);Mb=f.extent();ja=d.pinching||d.hoverData.dragging||d.swipePanning||d.data.wheelZooming||d.hoverData.draggingEles||d.cy.animated();Ub=d.hideEdgesOnViewport&&ja;ja=[];if(ja[d.NODE]=!F[d.NODE]&&K&&!d.clearedForMotionBlur[d.NODE]||d.clearingMotionBlur,ja[d.NODE]&&(d.clearedForMotionBlur[d.NODE]=!0),ja[d.DRAG]=!F[d.DRAG]&&K&&!d.clearedForMotionBlur[d.DRAG]||d.clearingMotionBlur,
ja[d.DRAG]&&(d.clearedForMotionBlur[d.DRAG]=!0),F[d.NODE]||l||m||ja[d.NODE]){var Wb=K&&!ja[d.NODE]&&1!==P;X=h||(Wb?d.data.bufferContexts[d.MOTIONBLUR_BUFFER_NODE]:D.contexts[d.NODE]);c(X,K&&!Wb?"motionBlur":void 0);Ub?d.drawCachedNodes(X,ba.nondrag,C,Mb):d.drawLayeredElements(X,ba.nondrag,C,Mb);d.debug&&d.drawDebugPoints(X,ba.nondrag);l||K||(F[d.NODE]=!1)}!m&&(F[d.DRAG]||l||ja[d.DRAG])&&(Wb=K&&!ja[d.DRAG]&&1!==P,X=h||(Wb?d.data.bufferContexts[d.MOTIONBLUR_BUFFER_DRAG]:D.contexts[d.DRAG]),c(X,K&&!Wb?
"motionBlur":void 0),Ub?d.drawCachedNodes(X,ba.drag,C,Mb):d.drawCachedElements(X,ba.drag,C,Mb),d.debug&&d.drawDebugPoints(X,ba.drag),l||K||(F[d.DRAG]=!1));if(this.drawSelectionRectangle(a,c),K&&1!==P)a=D.contexts[d.NODE],m=d.data.bufferCanvases[d.MOTIONBLUR_BUFFER_NODE],C=D.contexts[d.DRAG],ba=d.data.bufferCanvases[d.MOTIONBLUR_BUFFER_DRAG],X=function(Yb,ub,Kb){Yb.setTransform(1,0,0,1,0,0);Kb||!ta?Yb.clearRect(0,0,d.canvasWidth,d.canvasHeight):b(Yb,0,0,d.canvasWidth,d.canvasHeight);Kb=P;Yb.drawImage(ub,
0,0,d.canvasWidth*Kb,d.canvasHeight*Kb,0,0,d.canvasWidth,d.canvasHeight)},(F[d.NODE]||ja[d.NODE])&&(X(a,m,ja[d.NODE]),F[d.NODE]=!1),(F[d.DRAG]||ja[d.DRAG])&&(X(C,ba,ja[d.DRAG]),F[d.DRAG]=!1);d.prevViewport=Y;d.clearingMotionBlur&&(d.clearingMotionBlur=!1,d.motionBlurCleared=!0,d.motionBlur=!0);K&&(d.motionBlurTimeout=setTimeout(function(){d.motionBlurTimeout=null;d.clearedForMotionBlur[d.NODE]=!1;d.clearedForMotionBlur[d.DRAG]=!1;d.motionBlur=!1;d.clearingMotionBlur=!I;d.mbFrames=0;F[d.NODE]=!0;F[d.DRAG]=
!0;d.redraw()},100));h||f.emit("render")}},mi;io.drawSelectionRectangle=function(a,b){var c=this.data,d=this.cy.style(),f=a.drawOnlyNodeLayer,h=a.drawAllLayers,l=c.canvasNeedsRedraw;a=a.forcedContext;if(this.showFps||!f&&l[this.SELECT_BOX]&&!h){f=a||c.contexts[this.SELECT_BOX];if(b(f),1==this.selection[4]&&(this.hoverData.selecting||this.touchData.selecting))b=this.cy.zoom(),b=d.core("selection-box-border-width").value/b,f.lineWidth=b,f.fillStyle="rgba("+d.core("selection-box-color").value[0]+","+
d.core("selection-box-color").value[1]+","+d.core("selection-box-color").value[2]+","+d.core("selection-box-opacity").value+")",f.fillRect(this.selection[0],this.selection[1],this.selection[2]-this.selection[0],this.selection[3]-this.selection[1]),0<b&&(f.strokeStyle="rgba("+d.core("selection-box-border-color").value[0]+","+d.core("selection-box-border-color").value[1]+","+d.core("selection-box-border-color").value[2]+","+d.core("selection-box-opacity").value+")",f.strokeRect(this.selection[0],this.selection[1],
this.selection[2]-this.selection[0],this.selection[3]-this.selection[1]));c.bgActivePosistion&&!this.hoverData.selecting&&(b=this.cy.zoom(),c=c.bgActivePosistion,f.fillStyle="rgba("+d.core("active-bg-color").value[0]+","+d.core("active-bg-color").value[1]+","+d.core("active-bg-color").value[2]+","+d.core("active-bg-opacity").value+")",f.beginPath(),f.arc(c.x,c.y,d.core("active-bg-size").pfValue/b,0,2*Math.PI),f.fill());c=this.lastRedrawTime;this.showFps&&c&&(c=Math.round(c),d=Math.round(1E3/c),c=
"1 frame = "+c+" ms = "+d+" fps",(f.setTransform(1,0,0,1,0,0),f.fillStyle="rgba(255, 0, 0, 0.75)",f.strokeStyle="rgba(255, 0, 0, 0.75)",f.font="30px Arial",mi)||(mi=f.measureText(c).actualBoundingBoxAscent),f.fillText(c,0,mi),f.strokeRect(0,mi+10,250,20),f.fillRect(0,mi+10,250*Math.min(d/60,1),20));h||(l[this.SELECT_BOX]=!1)}};var fn="u">typeof Float32Array?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var a=0,b=arguments.length;b--;)a+=arguments[b]*arguments[b];return Math.sqrt(a)});
var Rq=function(){function a(b,c,d,f){u(this,a);this.debugID=Math.floor(1E4*Math.random());this.r=b;this.texSize=c;this.texRows=d;this.texHeight=Math.floor(c/d);this.enableWrapping=!0;this.locked=!1;this.texture=null;this.needsBuffer=!0;this.freePointer={x:0,row:0};this.keyToLocation=new Map;this.canvas=f(b,c,c);this.scratch=f(b,c,this.texHeight,"scratch")}return w(a,[{key:"lock",value:function(){this.locked=!0}},{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",
value:function(b){var c=b.w;b=b.h;var d=this.texSize,f=this.texHeight/b,h=c*f,l=b*f;return h>d&&(f=d/c,h=c*f,l=b*f),{scale:f,texW:h,texH:l}}},{key:"draw",value:function(b,c,d){var f=this;if(this.locked)throw Error("can't draw, atlas is locked");var h=this.texSize,l=this.texRows,m=this.texHeight,t=this.getScale(c),v=t.scale,C=t.texW,D=t.texH,F=function(P,ba){if(d&&ba){ba=ba.context;var X=P.x;P=m*P.row;ba.save();ba.translate(X,P);ba.scale(v,v);d(ba,c);ba.restore()}},I=[null,null];t=function(){F(f.freePointer,
f.canvas);I[0]={x:f.freePointer.x,y:f.freePointer.row*m,w:C,h:D};I[1]={x:f.freePointer.x+C,y:f.freePointer.row*m,w:0,h:D};f.freePointer.x+=C;f.freePointer.x==h&&(f.freePointer.x=0,f.freePointer.row++)};var K=function(){var P=f.scratch,ba=f.canvas;P.clear();F({x:0,row:0},P);var X=h-f.freePointer.x,Y=C-X,ta=f.freePointer.x,ja=f.freePointer.row*m;ba.context.drawImage(P,0,0,X,m,ta,ja,X,m);I[0]={x:ta,y:ja,w:X,h:D};ta=(f.freePointer.row+1)*m;ba&&ba.context.drawImage(P,X,0,Y,m,0,ta,Y,m);I[1]={x:0,y:ta,w:Y,
h:D};f.freePointer.x=Y;f.freePointer.row++};if(this.freePointer.x+C<=h)t();else{if(this.freePointer.row>=l-1)return!1;this.freePointer.x===h?(f.freePointer.x=0,f.freePointer.row++,t()):this.enableWrapping?K():(f.freePointer.x=0,f.freePointer.row++,t())}return this.keyToLocation.set(b,I),this.needsBuffer=!0,I}},{key:"getOffsets",value:function(b){return this.keyToLocation.get(b)}},{key:"isEmpty",value:function(){return 0===this.freePointer.x&&0===this.freePointer.row}},{key:"canFit",value:function(b){if(this.locked)return!1;
var c=this.texSize,d=this.texRows;b=this.getScale(b).texW;return this.freePointer.x+b>c?this.freePointer.row<d-1:!0}},{key:"bufferIfNeeded",value:function(b){this.texture||(this.texture=od(b,this.debugID));this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1,this.locked&&(this.canvas=null,this.scratch=null))}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null);this.scratch=this.canvas=null;this.locked=!0}}])}(),Sq=function(){function a(b,
c,d,f){u(this,a);this.r=b;this.texSize=c;this.texRows=d;this.createTextureCanvas=f;this.atlases=[];this.styleKeyToAtlas=new Map;this.markedKeys=new Set}return w(a,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function(){return new Rq(this.r,this.texSize,this.texRows,this.createTextureCanvas)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var b=this.texSize,c=this.createTextureCanvas;this.scratch=c(this.r,b,Math.floor(b/this.texRows),
"scratch")}return this.scratch}},{key:"draw",value:function(b,c,d){var f=this.styleKeyToAtlas.get(b);return f||(f=this.atlases[this.atlases.length-1],(!f||!f.canFit(c))&&(f&&f.lock(),f=this._createAtlas(),this.atlases.push(f)),f.draw(b,c,d),this.styleKeyToAtlas.set(b,f)),f}},{key:"getAtlas",value:function(b){return this.styleKeyToAtlas.get(b)}},{key:"hasAtlas",value:function(b){return this.styleKeyToAtlas.has(b)}},{key:"markKeyForGC",value:function(b){this.markedKeys.add(b)}},{key:"gc",value:function(){var b=
this,c=this.markedKeys;if(0===c.size)console.log("nothing to garbage collect");else{var d=[],f=new Map,h=null,l=y(this.atlases),m;try{var t=function(){var v=m.value,C=v.getKeys(),D=sg(c,C);if(0===D.size)return d.push(v),C.forEach(function(X){return f.set(X,v)}),1;h||(h=b._createAtlas(),d.push(h));C=y(C);var F;try{for(C.s();!(F=C.n()).done;){var I=F.value;if(!D.has(I)){var K=v.getOffsets(I),P=z(K,2),ba=P[0];h.canFit({w:ba.w+P[1].w,h:ba.h})||(h.lock(),h=b._createAtlas(),d.push(h));v.canvas&&(b._copyTextureToNewAtlas(I,
v,h),f.set(I,h))}}}catch(X){C.e(X)}finally{C.f()}v.dispose()};for(l.s();!(m=l.n()).done;)t()}catch(v){l.e(v)}finally{l.f()}this.atlases=d;this.styleKeyToAtlas=f;this.markedKeys=new Set}}},{key:"_copyTextureToNewAtlas",value:function(b,c,d){var f=c.getOffsets(b);f=z(f,2);var h=f[0];f=f[1];if(0===f.w)d.draw(b,h,function(v){v.drawImage(c.canvas,h.x,h.y,h.w,h.h,0,0,h.w,h.h)});else{var l=this._getScratchCanvas();l.clear();l.context.drawImage(c.canvas,h.x,h.y,h.w,h.h,0,0,h.w,h.h);l.context.drawImage(c.canvas,
f.x,f.y,f.w,f.h,h.w,0,f.w,f.h);var m=h.w+f.w,t=h.h;d.draw(b,{w:m,h:t},function(v){v.drawImage(l,0,0,m,t,0,0,m,t)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:(new Set(this.styleKeyToAtlas.values())).size}}}])}(),Tq=function(){function a(b,c){u(this,a);this.r=b;this.globalOptions=c;this.atlasSize=c.webglTexSize;this.maxAtlasesPerBatch=c.webglTexPerBatch;this.renderTypes=new Map;this.collections=new Map;this.typeAndIdToKey=new Map}return w(a,[{key:"getAtlasSize",
value:function(){return this.atlasSize}},{key:"addAtlasCollection",value:function(b,c){var d=this.globalOptions,f=d.webglTexSize;c=c.texRows;d=this._cacheScratchCanvas(d.createTextureCanvas);f=new Sq(this.r,f,c,d);this.collections.set(b,f)}},{key:"addRenderType",value:function(b,c){var d=c.collection;if(!this.collections.has(d))throw Error("invalid atlas collection name '".concat(d,"'"));d=this.collections.get(d);c=Bc({type:b,atlasCollection:d},c);this.renderTypes.set(b,c)}},{key:"getRenderTypeOpts",
value:function(b){return this.renderTypes.get(b)}},{key:"getAtlasCollection",value:function(b){return this.collections.get(b)}},{key:"_cacheScratchCanvas",value:function(b){var c=-1,d=-1,f=null;return function(h,l,m,t){return t?((!f||l!=c||m!=d)&&(c=l,d=m,f=b(h,l,m)),f):b(h,l,m)}}},{key:"_key",value:function(b,c){return"".concat(b,"-").concat(c)}},{key:"invalidate",value:function(b){var c=this,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},f=d.forceRedraw,h=void 0===f?!1:f;f=d.filterEle;
f=void 0===f?function(){return!0}:f;d=d.filterType;var l=void 0===d?function(){return!0}:d,m=!1,t=!1;d=y(b);var v;try{for(d.s();!(v=d.n()).done;){var C=v.value;if(f(C)){var D=y(this.renderTypes.values()),F;try{var I=function(){var K=F.value,P=K.type;if(l(P)){var ba=c.collections.get(K.collection),X=K.getKey(C);X=Array.isArray(X)?X:[X];h?(X.forEach(function(Y){return ba.markKeyForGC(Y)}),t=!0):(K=K.getID?K.getID(C):C.id(),P=c._key(P,K),K=c.typeAndIdToKey.get(P),void 0!==K&&!Hf(X,K)&&(m=!0,c.typeAndIdToKey.delete(P),
K.forEach(function(Y){return ba.markKeyForGC(Y)})))}};for(D.s();!(F=D.n()).done;)I()}catch(K){D.e(K)}finally{D.f()}}}}catch(K){d.e(K)}finally{d.f()}return t&&(this.gc(),m=!1),m}},{key:"gc",value:function(){var b=y(this.collections.values()),c;try{for(b.s();!(c=b.n()).done;)c.value.gc()}catch(d){b.e(d)}finally{b.f()}}},{key:"getOrCreateAtlas",value:function(b,c,d,f){var h=this.renderTypes.get(c),l=!1,m=this.collections.get(h.collection).draw(f,d,function(v){h.drawClipped?(v.save(),v.beginPath(),v.rect(0,
0,d.w,d.h),v.clip(),h.drawElement(v,b,d,!0,!0),v.restore()):h.drawElement(v,b,d,!0,!0);l=!0});if(l){var t=h.getID?h.getID(b):b.id();c=this._key(c,t);this.typeAndIdToKey.has(c)?this.typeAndIdToKey.get(c).push(f):this.typeAndIdToKey.set(c,[f])}return m}},{key:"getAtlasInfo",value:function(b,c){var d=this,f=this.renderTypes.get(c),h=f.getKey(b);return(Array.isArray(h)?h:[h]).map(function(l){var m=f.getBoundingBox(b,l),t=d.getOrCreateAtlas(b,c,m,l);l=t.getOffsets(l);l=z(l,2);var v=l[0];return{atlas:t,
tex:v,tex1:v,tex2:l[1],bb:m}})}},{key:"getDebugInfo",value:function(){var b=[],c=y(this.collections),d;try{for(c.s();!(d=c.n()).done;){var f=z(d.value,2),h=f[0],l=f[1].getCounts();b.push({type:h,keyCount:l.keyCount,atlasCount:l.atlasCount})}}catch(m){c.e(m)}finally{c.f()}return b}}])}(),Uq=function(){function a(b){u(this,a);this.globalOptions=b;this.atlasSize=b.webglTexSize;this.maxAtlasesPerBatch=b.webglTexPerBatch;this.batchAtlases=[]}return w(a,[{key:"getMaxAtlasesPerBatch",value:function(){return this.maxAtlasesPerBatch}},
{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlasesPerBatch},function(b,c){return c})}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function(b){return this.batchAtlases.length===this.maxAtlasesPerBatch?this.batchAtlases.includes(b):
!0}},{key:"getAtlasIndexForBatch",value:function(b){var c=this.batchAtlases.indexOf(b);if(0>c){if(this.batchAtlases.length===this.maxAtlasesPerBatch)throw Error("cannot add more atlases to batch");this.batchAtlases.push(b);c=this.batchAtlases.length-1}return c}}])}(),ei={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},Vq=function(){function a(b,c,d){u(this,a);this.r=b;this.gl=c;this.maxInstances=d.webglBatchSize;this.atlasSize=d.webglTexSize;this.bgColor=d.bgColor;this.debug=
d.webglDebug;this.batchDebugInfo=[];d.enableWrapping=!0;d.createTextureCanvas=Pd;this.atlasManager=new Tq(b,d);this.batchManager=new Uq(d);this.simpleShapeOptions=new Map;this.program=this._createShaderProgram(ei.SCREEN);this.pickingProgram=this._createShaderProgram(ei.PICKING);this.vao=this._createVAO()}return w(a,[{key:"addAtlasCollection",value:function(b,c){this.atlasManager.addAtlasCollection(b,c)}},{key:"addTextureAtlasRenderType",value:function(b,c){this.atlasManager.addRenderType(b,c)}},{key:"addSimpleShapeRenderType",
value:function(b,c){this.simpleShapeOptions.set(b,c)}},{key:"invalidate",value:function(b){var c=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).type,d=this.atlasManager;return c?d.invalidate(b,{filterType:function(f){return f===c},forceRedraw:!0}):d.invalidate(b)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"_createShaderProgram",value:function(b){var c=this.gl,d="#version 300 es\n      precision highp float;\n\n      uniform mat3 uPanZoomMatrix;\n      uniform int  uAtlasSize;\n      \n      // instanced\n      in vec2 aPosition; // a vertex from the unit square\n      \n      in mat3 aTransform; // used to transform verticies, eg into a bounding box\n      in int aVertType; // the type of thing we are rendering\n\n      // the z-index that is output when using picking mode\n      in vec4 aIndex;\n      \n      // For textures\n      in int aAtlasId; // which shader unit/atlas to use\n      in vec4 aTex; // x/y/w/h of texture in atlas\n\n      // for edges\n      in vec4 aPointAPointB;\n      in vec4 aPointCPointD;\n      in vec2 aLineWidth; // also used for node border width\n\n      // simple shapes\n      in vec4 aCornerRadius; // for round-rectangle [top-right, bottom-right, top-left, bottom-left]\n      in vec4 aColor; // also used for edges\n      in vec4 aBorderColor; // aLineWidth is used for border width\n\n      // output values passed to the fragment shader\n      out vec2 vTexCoord;\n      out vec4 vColor;\n      out vec2 vPosition;\n      // flat values are not interpolated\n      flat out int vAtlasId; \n      flat out int vVertType;\n      flat out vec2 vTopRight;\n      flat out vec2 vBotLeft;\n      flat out vec4 vCornerRadius;\n      flat out vec4 vBorderColor;\n      flat out vec2 vBorderWidth;\n      flat out vec4 vIndex;\n      \n      void main(void) {\n        int vid = gl_VertexID;\n        vec2 position = aPosition; // TODO make this a vec3, simplifies some code below\n\n        if(aVertType == ".concat(0,
") {\n          float texX = aTex.x; // texture coordinates\n          float texY = aTex.y;\n          float texW = aTex.z;\n          float texH = aTex.w;\n\n          if(vid == 1 || vid == 2 || vid == 4) {\n            texX += texW;\n          }\n          if(vid == 2 || vid == 4 || vid == 5) {\n            texY += texH;\n          }\n\n          float d = float(uAtlasSize);\n          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1\n\n          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);\n        }\n        else if(aVertType == ").concat(4,
" || aVertType == ").concat(7," \n             || aVertType == ").concat(5," || aVertType == ").concat(6,") { // simple shapes\n\n          // the bounding box is needed by the fragment shader\n          vBotLeft  = (aTransform * vec3(0, 0, 1)).xy; // flat\n          vTopRight = (aTransform * vec3(1, 1, 1)).xy; // flat\n          vPosition = (aTransform * vec3(position, 1)).xy; // will be interpolated\n\n          // calculations are done in the fragment shader, just pass these along\n          vColor = aColor;\n          vCornerRadius = aCornerRadius;\n          vBorderColor = aBorderColor;\n          vBorderWidth = aLineWidth;\n\n          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);\n        }\n        else if(aVertType == ").concat(1,
") {\n          vec2 source = aPointAPointB.xy;\n          vec2 target = aPointAPointB.zw;\n\n          // adjust the geometry so that the line is centered on the edge\n          position.y = position.y - 0.5;\n\n          // stretch the unit square into a long skinny rectangle\n          vec2 xBasis = target - source;\n          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));\n          vec2 point = source + xBasis * position.x + yBasis * aLineWidth[0] * position.y;\n\n          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);\n          vColor = aColor;\n        } \n        else if(aVertType == ").concat(2,
") {\n          vec2 pointA = aPointAPointB.xy;\n          vec2 pointB = aPointAPointB.zw;\n          vec2 pointC = aPointCPointD.xy;\n          vec2 pointD = aPointCPointD.zw;\n\n          // adjust the geometry so that the line is centered on the edge\n          position.y = position.y - 0.5;\n\n          vec2 p0, p1, p2, pos;\n          if(position.x == 0.0) { // The left side of the unit square\n            p0 = pointA;\n            p1 = pointB;\n            p2 = pointC;\n            pos = position;\n          } else { // The right side of the unit square, use same approach but flip the geometry upside down\n            p0 = pointD;\n            p1 = pointC;\n            p2 = pointB;\n            pos = vec2(0.0, -position.y);\n          }\n\n          vec2 p01 = p1 - p0;\n          vec2 p12 = p2 - p1;\n          vec2 p21 = p1 - p2;\n\n          // Find the normal vector.\n          vec2 tangent = normalize(normalize(p12) + normalize(p01));\n          vec2 normal = vec2(-tangent.y, tangent.x);\n\n          // Find the vector perpendicular to p0 -> p1.\n          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));\n\n          // Determine the bend direction.\n          float sigma = sign(dot(p01 + p21, normal));\n          float width = aLineWidth[0];\n\n          if(sign(pos.y) == -sigma) {\n            // This is an intersecting vertex. Adjust the position so that there's no overlap.\n            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);\n            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);\n          } else {\n            // This is a non-intersecting vertex. Treat it like a mitre join.\n            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);\n            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);\n          }\n\n          vColor = aColor;\n        } \n        else if(aVertType == ").concat(3,
" && vid < 3) {\n          // massage the first triangle into an edge arrow\n          if(vid == 0)\n            position = vec2(-0.15, -0.3);\n          if(vid == 1)\n            position = vec2(  0.0,  0.0);\n          if(vid == 2)\n            position = vec2( 0.15, -0.3);\n\n          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);\n          vColor = aColor;\n        }\n        else {\n          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space\n        }\n\n        vAtlasId = aAtlasId;\n        vVertType = aVertType;\n        vIndex = aIndex;\n      }\n    "),
f=this.batchManager.getIndexArray();b="#version 300 es\n      precision highp float;\n\n      // declare texture unit for each texture atlas in the batch\n      ".concat(f.map(function(h){return"uniform sampler2D uTexture".concat(h,";")}).join("\n\t"),"\n\n      uniform vec4 uBGColor;\n      uniform float uZoom;\n\n      in vec2 vTexCoord;\n      in vec4 vColor;\n      in vec2 vPosition; // model coordinates\n\n      flat in int vAtlasId;\n      flat in vec4 vIndex;\n      flat in int vVertType;\n      flat in vec2 vTopRight;\n      flat in vec2 vBotLeft;\n      flat in vec4 vCornerRadius;\n      flat in vec4 vBorderColor;\n      flat in vec2 vBorderWidth;\n\n      out vec4 outColor;\n\n      ").concat("\n  float circleSD(vec2 p, float r) {\n    return distance(vec2(0), p) - r; // signed distance\n  }\n",
"\n      ").concat("\n  float rectangleSD(vec2 p, vec2 b) {\n    vec2 d = abs(p)-b;\n    return distance(vec2(0),max(d,0.0)) + min(max(d.x,d.y),0.0);\n  }\n","\n      ").concat("\n  float roundRectangleSD(vec2 p, vec2 b, vec4 cr) {\n    cr.xy = (p.x > 0.0) ? cr.xy : cr.zw;\n    cr.x  = (p.y > 0.0) ? cr.x  : cr.y;\n    vec2 q = abs(p) - b + cr.x;\n    return min(max(q.x, q.y), 0.0) + distance(vec2(0), max(q, 0.0)) - cr.x;\n  }\n","\n      ").concat("\n  float ellipseSD(vec2 p, vec2 ab) {\n    p = abs( p ); // symmetry\n\n    // find root with Newton solver\n    vec2 q = ab*(p-ab);\n    float w = (q.x<q.y)? 1.570796327 : 0.0;\n    for( int i=0; i<5; i++ ) {\n      vec2 cs = vec2(cos(w),sin(w));\n      vec2 u = ab*vec2( cs.x,cs.y);\n      vec2 v = ab*vec2(-cs.y,cs.x);\n      w = w + dot(p-u,v)/(dot(p-u,u)+dot(v,v));\n    }\n    \n    // compute final point and distance\n    float d = length(p-ab*vec2(cos(w),sin(w)));\n    \n    // return signed distance\n    return (dot(p/ab,p/ab)>1.0) ? d : -d;\n  }\n",
"\n\n      vec4 blend(vec4 top, vec4 bot) { // blend colors with premultiplied alpha\n        return vec4( \n          top.rgb + (bot.rgb * (1.0 - top.a)),\n          top.a   + (bot.a   * (1.0 - top.a)) \n        );\n      }\n\n      vec4 distInterp(vec4 cA, vec4 cB, float d) { // interpolate color using Signed Distance\n        // scale to the zoom level so that borders don't look blurry when zoomed in\n        // note 1.5 is an aribitrary value chosen because it looks good\n        return mix(cA, cB, 1.0 - smoothstep(0.0, 1.5 / uZoom, abs(d))); \n      }\n\n      void main(void) {\n        if(vVertType == ").concat(0,
") {\n          // look up the texel from the texture unit\n          ").concat(f.map(function(h){return"if(vAtlasId == ".concat(h,") outColor = texture(uTexture").concat(h,", vTexCoord);")}).join("\n\telse "),"\n        } \n        else if(vVertType == ").concat(3,") {\n          // mimics how canvas renderer uses context.globalCompositeOperation = 'destination-out';\n          outColor = blend(vColor, uBGColor);\n          outColor.a = 1.0; // make opaque, masks out line under arrow\n        }\n        else if(vVertType == ").concat(4,
" && vBorderWidth == vec2(0.0)) { // simple rectangle with no border\n          outColor = vColor; // unit square is already transformed to the rectangle, nothing else needs to be done\n        }\n        else if(vVertType == ").concat(4," || vVertType == ").concat(7," \n          || vVertType == ").concat(5," || vVertType == ").concat(6,") { // use SDF\n\n          float outerBorder = vBorderWidth[0];\n          float innerBorder = vBorderWidth[1];\n          float borderPadding = outerBorder * 2.0;\n          float w = vTopRight.x - vBotLeft.x - borderPadding;\n          float h = vTopRight.y - vBotLeft.y - borderPadding;\n          vec2 b = vec2(w/2.0, h/2.0); // half width, half height\n          vec2 p = vPosition - vec2(vTopRight.x - b[0] - outerBorder, vTopRight.y - b[1] - outerBorder); // translate to center\n\n          float d; // signed distance\n          if(vVertType == ").concat(4,
") {\n            d = rectangleSD(p, b);\n          } else if(vVertType == ").concat(7," && w == h) {\n            d = circleSD(p, b.x); // faster than ellipse\n          } else if(vVertType == ").concat(7,") {\n            d = ellipseSD(p, b);\n          } else {\n            d = roundRectangleSD(p, b, vCornerRadius.wzyx);\n          }\n\n          // use the distance to interpolate a color to smooth the edges of the shape, doesn't need multisampling\n          // we must smooth colors inwards, because we can't change pixels outside the shape's bounding box\n          if(d > 0.0) {\n            if(d > outerBorder) {\n              discard;\n            } else {\n              outColor = distInterp(vBorderColor, vec4(0), d - outerBorder);\n            }\n          } else {\n            if(d > innerBorder) {\n              vec4 outerColor = outerBorder == 0.0 ? vec4(0) : vBorderColor;\n              vec4 innerBorderColor = blend(vBorderColor, vColor);\n              outColor = distInterp(innerBorderColor, outerColor, d);\n            } \n            else {\n              vec4 outerColor;\n              if(innerBorder == 0.0 && outerBorder == 0.0) {\n                outerColor = vec4(0);\n              } else if(innerBorder == 0.0) {\n                outerColor = vBorderColor;\n              } else {\n                outerColor = blend(vBorderColor, vColor);\n              }\n              outColor = distInterp(vColor, outerColor, d - innerBorder);\n            }\n          }\n        }\n        else {\n          outColor = vColor;\n        }\n\n        ").concat(b.picking?
"if(outColor.a == 0.0) discard;\n             else outColor = vIndex;":"","\n      }\n    ");d=xd(c,d,b);d.aPosition=c.getAttribLocation(d,"aPosition");d.aIndex=c.getAttribLocation(d,"aIndex");d.aVertType=c.getAttribLocation(d,"aVertType");d.aTransform=c.getAttribLocation(d,"aTransform");d.aAtlasId=c.getAttribLocation(d,"aAtlasId");d.aTex=c.getAttribLocation(d,"aTex");d.aPointAPointB=c.getAttribLocation(d,"aPointAPointB");d.aPointCPointD=c.getAttribLocation(d,"aPointCPointD");d.aLineWidth=c.getAttribLocation(d,
"aLineWidth");d.aColor=c.getAttribLocation(d,"aColor");d.aCornerRadius=c.getAttribLocation(d,"aCornerRadius");d.aBorderColor=c.getAttribLocation(d,"aBorderColor");d.uPanZoomMatrix=c.getUniformLocation(d,"uPanZoomMatrix");d.uAtlasSize=c.getUniformLocation(d,"uAtlasSize");d.uBGColor=c.getUniformLocation(d,"uBGColor");d.uZoom=c.getUniformLocation(d,"uZoom");d.uTextures=[];for(b=0;b<this.batchManager.getMaxAtlasesPerBatch();b++)d.uTextures.push(c.getUniformLocation(d,"uTexture".concat(b)));return d}},
{key:"_createVAO",value:function(){var b=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=b.length/2;var c=this.maxInstances,d=this.gl,f=this.program,h=d.createVertexArray();d.bindVertexArray(h);var l=f.aPosition,m=Nf(d,"vec2"),t=z(m,2);m=t[0];t=t[1];b=Ld(d,t,b);var v=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,v);d.bufferData(d.ARRAY_BUFFER,b,d.STATIC_DRAW);t===d.FLOAT?d.vertexAttribPointer(l,m,t,!1,0,0):t===d.INT&&d.vertexAttribIPointer(l,m,t,0,0);d.enableVertexAttribArray(l);d.bindBuffer(d.ARRAY_BUFFER,
null);return this.transformBuffer=rg(d,c,f.aTransform),this.indexBuffer=Zd(d,c,"vec4",f.aIndex),this.vertTypeBuffer=Zd(d,c,"int",f.aVertType),this.atlasIdBuffer=Zd(d,c,"int",f.aAtlasId),this.texBuffer=Zd(d,c,"vec4",f.aTex),this.pointAPointBBuffer=Zd(d,c,"vec4",f.aPointAPointB),this.pointCPointDBuffer=Zd(d,c,"vec4",f.aPointCPointD),this.lineWidthBuffer=Zd(d,c,"vec2",f.aLineWidth),this.colorBuffer=Zd(d,c,"vec4",f.aColor),this.cornerRadiusBuffer=Zd(d,c,"vec4",f.aCornerRadius),this.borderColorBuffer=
Zd(d,c,"vec4",f.aBorderColor),d.bindVertexArray(null),h}},{key:"buffers",get:function(){var b=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(c){return c.endsWith("Buffer")}).map(function(c){return b[c]})),this._buffers}},{key:"startFrame",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:ei.SCREEN;this.panZoomMatrix=b;this.renderTarget=c;this.batchDebugInfo=[];this.simpleCount=this.wrappedCount=0;this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=
0;this.batchManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"_isVisible",value:function(b,c){return b.visible()?c&&c.isVisible?c.isVisible(b):!0:!1}},{key:"drawTexture",value:function(b,c,d){var f=this.atlasManager,h=this.batchManager,l=f.getRenderTypeOpts(d);if(this._isVisible(b,l)){if(this.renderTarget.picking&&l.getTexPickingMode){var m=l.getTexPickingMode(b);if(1===m)return;if(2==m){this.drawPickingRectangle(b,c,d);return}}d=f.getAtlasInfo(b,d);d=y(d);var t;try{for(d.s();!(t=
d.n()).done;){var v=t.value,C=v.atlas,D=v.tex1,F=v.tex2;h.canAddToCurrentBatch(C)||this.endBatch();var I=h.getAtlasIndexForBatch(C);f=0;for(m=[[D,!0],[F,!1]];f<m.length;f++){var K=z(m[f],2),P=K[0],ba=K[1];if(0!=P.w){var X=this.instanceCount;this.vertTypeBuffer.getView(X)[0]=0;var Y=this.indexBuffer.getView(X);Ae(c,Y);this.atlasIdBuffer.getView(X)[0]=I;var ta=this.texBuffer.getView(X);ta[0]=P.x;ta[1]=P.y;ta[2]=P.w;ta[3]=P.h;var ja=this.transformBuffer.getMatrixView(X);this.setTransformMatrix(b,ja,
l,v,ba);this.instanceCount++;ba||this.wrappedCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}}}}catch(Ba){d.e(Ba)}finally{d.f()}}}},{key:"setTransformMatrix",value:function(b,c,d,f){var h=4<arguments.length&&void 0!==arguments[4]?arguments[4]:!0,l=0;if(d.shapeProps&&d.shapeProps.padding&&(l=b.pstyle(d.shapeProps.padding).pfValue),f){var m=f.bb,t=f.tex1;t=t.w/(t.w+f.tex2.w);h||(t=1-t);l=this._getAdjustedBB(m,l,h,t);this._applyTransformMatrix(c,l,d,b)}else h=d.getBoundingBox(b),l=this._getAdjustedBB(h,
l,!0,1),this._applyTransformMatrix(c,l,d,b)}},{key:"_applyTransformMatrix",value:function(b,c,d,f){Qf(b);var h=d.getRotation?d.getRotation(f):0;if(0!==h){var l=d.getRotationPoint(f);Re(b,b,[l.x,l.y]);df(b,b,h);f=d.getRotationOffset(f);d=f.x+(c.xOffset||0);f=f.y+(c.yOffset||0)}else d=c.x1,f=c.y1;Re(b,b,[d,f]);ef(b,b,[c.w,c.h])}},{key:"_getAdjustedBB",value:function(b,c,d,f){var h=b.x1,l=b.y1,m=b.w,t=b.h;b=b.yOffset;c&&(h-=c,l-=c,m+=2*c,t+=2*c);c=0;var v=m*f;return d&&1>f?m=v:!d&&1>f&&(c=m-v,h+=c,m=
v),{x1:h,y1:l,w:m,h:t,xOffset:c,yOffset:b}}},{key:"drawPickingRectangle",value:function(b,c,d){d=this.atlasManager.getRenderTypeOpts(d);var f=this.instanceCount;this.vertTypeBuffer.getView(f)[0]=4;var h=this.indexBuffer.getView(f);Ae(c,h);c=this.colorBuffer.getView(f);rd([0,0,0],1,c);c=this.transformBuffer.getMatrixView(f);this.setTransformMatrix(b,c,d);this.simpleCount++;this.instanceCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawNode",value:function(b,c,d){var f=this.simpleShapeOptions.get(d);
if(this._isVisible(b,f)){var h=f.shapeProps,l=this._getVertTypeForShape(b,h.shape);if(void 0===l||f.isSimple&&!f.isSimple(b))this.drawTexture(b,c,d);else{d=this.instanceCount;if(this.vertTypeBuffer.getView(d)[0]=l,5===l||6===l){var m=f.getBoundingBox(b);m=this._getCornerRadius(b,h.radius,m);var t=this.cornerRadiusBuffer.getView(d);t[0]=m;t[1]=m;t[2]=m;t[3]=m;6===l&&(t[0]=0,t[2]=0)}l=this.indexBuffer.getView(d);Ae(c,l);c=b.pstyle(h.color).value;l=b.pstyle(h.opacity).value;m=this.colorBuffer.getView(d);
rd(c,l,m);c=this.lineWidthBuffer.getView(d);if(c[0]=0,c[1]=0,h.border)h=b.pstyle("border-width").value,0<h&&(l=b.pstyle("border-color").value,m=b.pstyle("border-opacity").value,t=this.borderColorBuffer.getView(d),rd(l,m,t),l=b.pstyle("border-position").value,"inside"===l?(c[0]=0,c[1]=-h):"outside"===l?(c[0]=h,c[1]=0):(h/=2,c[0]=h,c[1]=-h));d=this.transformBuffer.getMatrixView(d);this.setTransformMatrix(b,d,f);this.simpleCount++;this.instanceCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}}}},
{key:"_getVertTypeForShape",value:function(b,c){switch(b.pstyle(c).value){case "rectangle":return 4;case "ellipse":return 7;case "roundrectangle":case "round-rectangle":return 5;case "bottom-round-rectangle":return 6}}},{key:"_getCornerRadius",value:function(b,c,d){var f=d.w;d=d.h;if("auto"===b.pstyle(c).value)return Ue(f,d);b=b.pstyle(c).pfValue;return Math.min(b,d/2,f/2)}},{key:"drawEdgeArrow",value:function(b,c,d){if(b.visible()){var f=b._private.rscratch,h,l,m;if(("source"===d?(h=f.arrowStartX,
l=f.arrowStartY,m=f.srcArrowAngle):(h=f.arrowEndX,l=f.arrowEndY,m=f.tgtArrowAngle),!(isNaN(h)||null==h||isNaN(l)||null==l||isNaN(m)||null==m))&&"none"!==b.pstyle(d+"-arrow-shape").value){d=b.pstyle(d+"-arrow-color").value;f=b.pstyle("opacity").value;var t=b.pstyle("line-opacity").value;f*=t;t=b.pstyle("width").pfValue;b=b.pstyle("arrow-scale").value;t=this.r.getArrowWidth(t,b);b=this.instanceCount;var v=this.transformBuffer.getMatrixView(b);Qf(v);Re(v,v,[h,l]);ef(v,v,[t,t]);df(v,v,m);this.vertTypeBuffer.getView(b)[0]=
3;h=this.indexBuffer.getView(b);Ae(c,h);c=this.colorBuffer.getView(b);rd(d,f,c);this.instanceCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}}}},{key:"drawEdgeLine",value:function(b,c){if(b.visible()){var d=this._getEdgePoints(b);if(d){var f=b.pstyle("opacity").value,h=b.pstyle("line-opacity").value,l=b.pstyle("width").pfValue;b=b.pstyle("line-color").value;f*=h;if(d.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),4==d.length){h=this.instanceCount;this.vertTypeBuffer.getView(h)[0]=
1;var m=this.indexBuffer.getView(h);Ae(c,m);c=this.colorBuffer.getView(h);rd(b,f,c);this.lineWidthBuffer.getView(h)[0]=l;l=this.pointAPointBBuffer.getView(h);l[0]=d[0];l[1]=d[1];l[2]=d[2];l[3]=d[3];this.instanceCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}else for(h=0;h<d.length-2;h+=2){m=this.instanceCount;this.vertTypeBuffer.getView(m)[0]=2;var t=this.indexBuffer.getView(m);Ae(c,t);t=this.colorBuffer.getView(m);rd(b,f,t);this.lineWidthBuffer.getView(m)[0]=l;var v=d[h-2],C=d[h-
1],D=d[h],F=d[h+1];t=d[h+2];var I=d[h+3],K=d[h+4],P=d[h+5];0==h&&(v=2*D-t+.001,C=2*F-I+.001);h==d.length-4&&(K=2*t-D+.001,P=2*I-F+.001);var ba=this.pointAPointBBuffer.getView(m);ba[0]=v;ba[1]=C;ba[2]=D;ba[3]=F;m=this.pointCPointDBuffer.getView(m);m[0]=t;m[1]=I;m[2]=K;m[3]=P;this.instanceCount++;this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"_getEdgePoints",value:function(b){var c=b._private.rscratch;if(!c.badLine&&null!=c.allpts&&!isNaN(c.allpts[0])){c=c.allpts;if(4==c.length)return c;
b=this._getNumSegments(b);return this._getCurveSegmentPoints(c,b)}}},{key:"_getNumSegments",value:function(b){return Math.min(15,this.maxInstances)}},{key:"_getCurveSegmentPoints",value:function(b,c){if(4==b.length)return b;for(var d=Array(2*(c+1)),f=0;f<=c;f++)0==f?(d[0]=b[0],d[1]=b[1]):f==c?(d[2*f]=b[b.length-2],d[2*f+1]=b[b.length-1]):this._setCurvePoint(b,f/c,d,2*f);return d}},{key:"_setCurvePoint",value:function(b,c,d,f){if(2>=b.length)d[f]=b[0],d[f+1]=b[1];else{for(var h=Array(b.length-2),l=
0;l<h.length;l+=2){var m=(1-c)*b[l+1]+c*b[l+3];h[l]=(1-c)*b[l]+c*b[l+2];h[l+1]=m}return this._setCurvePoint(h,c,d,f)}}},{key:"endBatch",value:function(){var b=this.gl,c=this.vao,d=this.vertexCount,f=this.instanceCount;if(0!==f){var h=this.renderTarget.picking?this.pickingProgram:this.program;b.useProgram(h);b.bindVertexArray(c);c=y(this.buffers);var l;try{for(c.s();!(l=c.n()).done;)l.value.bufferSubData(f)}catch(C){c.e(C)}finally{c.f()}l=this.batchManager.getAtlases();for(c=0;c<l.length;c++)l[c].bufferIfNeeded(b);
for(c=0;c<l.length;c++)b.activeTexture(b.TEXTURE0+c),b.bindTexture(b.TEXTURE_2D,l[c].texture),b.uniform1i(h.uTextures[c],c);c=b.uniform1f;var m=h.uZoom;var t=this.r;var v=t.pixelRatio;t=t.cy.zoom()*v;c.call(b,m,t);b.uniformMatrix3fv(h.uPanZoomMatrix,!1,this.panZoomMatrix);b.uniform1i(h.uAtlasSize,this.batchManager.getAtlasSize());c=rd(this.bgColor,1);b.uniform4fv(h.uBGColor,c);b.drawArraysInstanced(b.TRIANGLES,0,d,f);b.bindVertexArray(null);b.bindTexture(b.TEXTURE_2D,null);this.debug&&this.batchDebugInfo.push({count:f,
atlasCount:l.length});this.startBatch()}}},{key:"getDebugInfo",value:function(){var b=this.atlasManager.getDebugInfo(),c=b.reduce(function(h,l){return h+l.atlasCount},0),d=this.batchDebugInfo,f=d.reduce(function(h,l){return h+l.count},0);return{atlasInfo:b,totalAtlases:c,wrappedCount:this.wrappedCount,simpleCount:this.simpleCount,batchCount:d.length,batchInfo:d,totalInstances:f}}}])}(),rl=function(a,b){return function(c){var d=a(c);c=Ed(c._private.rscratch,"labelWrapCachedLines",b)||[];return 1<c.length?
c.map(function(f,h){return"".concat(d,"_").concat(h)}):d}},sl=function(a,b){return function(c,d){var f=a(c);if("string"==typeof d){var h=d.indexOf("_");if(0<h)return d=Number(d.substring(h+1)),c=Ed(c._private.rscratch,"labelWrapCachedLines",b)||[],c=f.h/c.length,d*=c,{x1:f.x1,w:f.w,y1:f.y1+d,h:c,yOffset:d}}return f}},jo={drawPolygonPath:function(a,b,c,d,f,h){d/=2;f/=2;a.beginPath&&a.beginPath();a.moveTo(b+d*h[0],c+f*h[1]);for(var l=1;l<h.length/2;l++)a.lineTo(b+d*h[2*l],c+f*h[2*l+1]);a.closePath()},
drawRoundPolygonPath:function(a,b,c,d,f,h,l){l.forEach(function(m){return L(a,m)});a.closePath()},drawRoundRectanglePath:function(a,b,c,d,f,h){var l=d/2,m=f/2;d="auto"===h?Ue(d,f):Math.min(h,m,l);a.beginPath&&a.beginPath();a.moveTo(b,c-m);a.arcTo(b+l,c-m,b+l,c,d);a.arcTo(b+l,c+m,b,c+m,d);a.arcTo(b-l,c+m,b-l,c,d);a.arcTo(b-l,c-m,b,c-m,d);a.lineTo(b,c-m);a.closePath()},drawBottomRoundRectanglePath:function(a,b,c,d,f,h){var l=d/2,m=f/2;d="auto"===h?Ue(d,f):h;a.beginPath&&a.beginPath();a.moveTo(b,c-m);
a.lineTo(b+l,c-m);a.lineTo(b+l,c);a.arcTo(b+l,c+m,b,c+m,d);a.arcTo(b-l,c+m,b-l,c,d);a.lineTo(b-l,c-m);a.lineTo(b,c-m);a.closePath()},drawCutRectanglePath:function(a,b,c,d,f,h,l){d/=2;f/=2;l="auto"===l?8:l;a.beginPath&&a.beginPath();a.moveTo(b-d+l,c-f);a.lineTo(b+d-l,c-f);a.lineTo(b+d,c-f+l);a.lineTo(b+d,c+f-l);a.lineTo(b+d-l,c+f);a.lineTo(b-d+l,c+f);a.lineTo(b-d,c+f-l);a.lineTo(b-d,c-f+l);a.closePath()},drawBarrelPath:function(a,b,c,d,f){var h=d/2,l=f/2,m=b-h;b+=h;h=c-l;c+=l;l=xh(d,f);d=l.widthOffset;
f=l.heightOffset;l=l.ctrlPtOffsetPct*d;a.beginPath&&a.beginPath();a.moveTo(m,h+f);a.lineTo(m,c-f);a.quadraticCurveTo(m+l,c,m+d,c);a.lineTo(b-d,c);a.quadraticCurveTo(b-l,c,b,c-f);a.lineTo(b,h+f);a.quadraticCurveTo(b-l,h,b-d,h);a.lineTo(m+d,h);a.quadraticCurveTo(m+l,h,m,h+f);a.closePath()}},ko=Math.sin(0),lo=Math.cos(0),tl={},ul={},mo=Math.PI/40;for(Pg=0*Math.PI;Pg<2*Math.PI;Pg+=mo)tl[Pg]=Math.sin(Pg),ul[Pg]=Math.cos(Pg);var Pg;jo.drawEllipsePath=function(a,b,c,d,f){if(a.beginPath&&a.beginPath(),a.ellipse)a.ellipse(b,
c,d/2,f/2,0,0,2*Math.PI);else{d/=2;for(var h=f/2,l=0*Math.PI;l<2*Math.PI;l+=mo){f=b-d*tl[l]*ko+d*ul[l]*lo;var m=c+h*ul[l]*ko+h*tl[l]*lo;0===l?a.moveTo(f,m):a.lineTo(f,m)}}a.closePath()};var Rc=Gb.prototype;Rc.CANVAS_LAYERS=3;Rc.SELECT_BOX=0;Rc.DRAG=1;Rc.NODE=2;Rc.WEBGL=3;Rc.CANVAS_TYPES=["2d","2d","2d","webgl2"];Rc.BUFFER_COUNT=3;Rc.TEXTURE_BUFFER=0;Rc.MOTIONBLUR_BUFFER_NODE=1;Rc.MOTIONBLUR_BUFFER_DRAG=2;Rc.redrawHint=function(a,b){switch(a){case "eles":this.data.canvasNeedsRedraw[Rc.NODE]=b;break;
case "drag":this.data.canvasNeedsRedraw[Rc.DRAG]=b;break;case "select":this.data.canvasNeedsRedraw[Rc.SELECT_BOX]=b;break;case "gc":this.data.gc=!0}};var Wq="u">typeof Path2D;Rc.path2dEnabled=function(a){if(void 0===a)return this.pathsEnabled;this.pathsEnabled=!!a};Rc.usePaths=function(){return Wq&&this.pathsEnabled};Rc.setImgSmoothing=function(a,b){null!=a.imageSmoothingEnabled?a.imageSmoothingEnabled=b:(a.webkitImageSmoothingEnabled=b,a.mozImageSmoothingEnabled=b,a.msImageSmoothingEnabled=b)};Rc.getImgSmoothing=
function(a){return null!=a.imageSmoothingEnabled?a.imageSmoothingEnabled:a.webkitImageSmoothingEnabled||a.mozImageSmoothingEnabled||a.msImageSmoothingEnabled};Rc.makeOffscreenCanvas=function(a,b){if("undefined"!==("u"<typeof OffscreenCanvas?"undefined":T(OffscreenCanvas)))var c=new OffscreenCanvas(a,b);else c=this.cy.window().document.createElement("canvas"),c.width=a,c.height=b;return c};[fo,Gh,eg,{safeDrawImage:function(a,b,c,d,f,h,l,m,t,v){if(!(0>=f||0>=h||0>=t||0>=v))try{a.drawImage(b,c,d,f,h,
l,m,t,v)}catch(C){fd(C)}},drawInscribedImage:function(a,b,c,d,f){var h=c.position(),l=h.x;h=h.y;var m=c.cy().style(),t=m.getIndexedStyle.bind(m),v=t(c,"background-fit","value",d);m=t(c,"background-repeat","value",d);var C=c.width(),D=c.height(),F=2*c.padding();C+="inner"===t(c,"background-width-relative-to","value",d)?0:F;D+="inner"===t(c,"background-height-relative-to","value",d)?0:F;F=c._private.rscratch;var I="node"===t(c,"background-clip","value",d),K=t(c,"background-image-opacity","value",d)*
f,P=t(c,"background-image-smoothing","value",d);f=c.pstyle("corner-radius").value;"auto"!==f&&(f=c.pstyle("corner-radius").pfValue);var ba=b.width||b.cachedW,X=b.height||b.cachedH;null!=ba&&null!=X||(document.body.appendChild(b),ba=b.cachedW=b.width||b.offsetWidth,X=b.cachedH=b.height||b.offsetHeight,document.body.removeChild(b));var Y=ba,ta=X;if("auto"!==t(c,"background-width","value",d)&&("%"===t(c,"background-width","units",d)?Y=t(c,"background-width","pfValue",d)*C:Y=t(c,"background-width","pfValue",
d)),"auto"!==t(c,"background-height","value",d)&&("%"===t(c,"background-height","units",d)?ta=t(c,"background-height","pfValue",d)*D:ta=t(c,"background-height","pfValue",d)),0!==Y&&0!==ta){"contain"===v?(v=Math.min(C/Y,D/ta),Y*=v,ta*=v):"cover"===v&&(v=Math.max(C/Y,D/ta),Y*=v,ta*=v);v=l-C/2;var ja=t(c,"background-position-x","units",d),Ba=t(c,"background-position-x","pfValue",d);"%"===ja?v+=(C-Y)*Ba:v+=Ba;ja=t(c,"background-offset-x","units",d);Ba=t(c,"background-offset-x","pfValue",d);"%"===ja?v+=
(C-Y)*Ba:v+=Ba;ja=h-D/2;Ba=t(c,"background-position-y","units",d);var Ua=t(c,"background-position-y","pfValue",d);"%"===Ba?ja+=(D-ta)*Ua:ja+=Ua;Ba=t(c,"background-offset-y","units",d);d=t(c,"background-offset-y","pfValue",d);"%"===Ba?ja+=(D-ta)*d:ja+=d;F.pathCache&&(v-=l,ja-=h,l=0,h=0);d=a.globalAlpha;a.globalAlpha=K;t=this.getImgSmoothing(a);K=!1;("no"===P&&t?(this.setImgSmoothing(a,!1),K=!0):"yes"===P&&!t&&(this.setImgSmoothing(a,!0),K=!0),"no-repeat"===m)?(I&&(a.save(),F.pathCache?a.clip(F.pathCache):
(this.nodeShapes[this.getNodeShape(c)].draw(a,l,h,C,D,f,F),a.clip())),this.safeDrawImage(a,b,0,0,ba,X,v,ja,Y,ta),I&&a.restore()):(b=a.createPattern(b,m),a.fillStyle=b,this.nodeShapes[this.getNodeShape(c)].draw(a,l,h,C,D,f,F),a.translate(v,ja),a.fill(),a.translate(-v,-ja));a.globalAlpha=d;K&&this.setImgSmoothing(a,t)}}},{eleTextBiggerThanMin:function(a,b){if(!b){b=a.cy().zoom();var c=this.getPixelRatio();b=Math.ceil(Th(b*c));b=Math.pow(2,b)}b*=a.pstyle("font-size").pfValue;a=a.pstyle("min-zoomed-font-size").pfValue;
return!(b<a)},drawElementText:function(a,b,c,d,f){var h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:!0;if(null==d){if(h&&!this.eleTextBiggerThanMin(b))return}else if(!1===d)return;if(b.isNode()){var l=b.pstyle("label");if(!l||!l.value)return;l=this.getLabelJustification(b);a.textAlign=l}else{l=b.element()._private.rscratch.badLine;var m=b.pstyle("label"),t=b.pstyle("source-label"),v=b.pstyle("target-label");if(l||!(m&&m.value||t&&t.value||v&&v.value))return;a.textAlign="center"}a.textBaseline=
"bottom";l=!c;var C;c&&(C=c,a.translate(-C.x1,-C.y1));null==f?(this.drawText(a,b,null,l,h),b.isEdge()&&(this.drawText(a,b,"source",l,h),this.drawText(a,b,"target",l,h))):this.drawText(a,b,f,l,h);c&&a.translate(C.x1,C.y1)},getFontCache:function(a){var b;this.fontCaches=this.fontCaches||[];for(var c=0;c<this.fontCaches.length;c++)if(b=this.fontCaches[c],b.context===a)return b;return b={context:a},this.fontCaches.push(b),b},setupTextStyle:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?
arguments[2]:!0,d=b.pstyle("font-style").strValue,f=b.pstyle("font-size").pfValue+"px",h=b.pstyle("font-family").strValue,l=b.pstyle("font-weight").strValue;c=c?b.effectiveOpacity()*b.pstyle("text-opacity").value:1;var m=b.pstyle("text-outline-opacity").value*c,t=b.pstyle("color").value,v=b.pstyle("text-outline-color").value;a.font=d+" "+l+" "+f+" "+h;a.lineJoin="round";this.colorFillStyle(a,t[0],t[1],t[2],c);this.colorStrokeStyle(a,v[0],v[1],v[2],m)},getTextAngle:function(a,b){var c=a._private.rscratch,
d=a.pstyle((b?b+"-":"")+"text-rotation");if("autorotate"===d.strValue){b=Ed(c,"labelAngle",b);var f=a.isEdge()?b:0}else"none"===d.strValue?f=0:f=d.pfValue;return f},drawText:function(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!0,f=4<arguments.length&&void 0!==arguments[4]?arguments[4]:!0,h=b._private.rscratch,l=f?b.effectiveOpacity():1;if(!f||0!==l&&0!==b.pstyle("text-opacity").value){"main"===c&&(c=null);var m=Ed(h,"labelX",c),t=Ed(h,"labelY",c),v,C,D=this.getLabelText(b,
c);if(null!=D&&""!==D&&!isNaN(m)&&!isNaN(t)){this.setupTextStyle(a,b,f);var F=c?c+"-":"";f=Ed(h,"labelWidth",c);var I=Ed(h,"labelHeight",c),K=b.pstyle(F+"text-margin-x").pfValue,P=b.pstyle(F+"text-margin-y").pfValue,ba=b.isEdge();F=b.pstyle("text-halign").value;var X=b.pstyle("text-valign").value;ba&&(F="center",X="center");m+=K;t+=P;var Y;switch(d?Y=this.getTextAngle(b,c):Y=0,0!==Y&&(v=m,C=t,a.translate(v,C),a.rotate(Y),m=0,t=0),X){case "center":t+=I/2;break;case "bottom":t+=I}var ta=b.pstyle("text-background-opacity").value,
ja=b.pstyle("text-border-opacity").value,Ba=b.pstyle("text-border-width").pfValue,Ua=b.pstyle("text-background-padding").pfValue;d=0===b.pstyle("text-background-shape").strValue.indexOf("round");if(0<ta||0<Ba&&0<ja){K=m-Ua;switch(F){case "left":K-=f;break;case "center":K-=f/2}P=t-I-Ua;ba=f+2*Ua;I+=2*Ua;if(0<ta){Ua=a.fillStyle;var ab=b.pstyle("text-background-color").value;a.fillStyle="rgba("+ab[0]+","+ab[1]+","+ab[2]+","+ta*l+")";d?vc(a,K,P,ba,I,2):a.fillRect(K,P,ba,I);a.fillStyle=Ua}if(0<Ba&&0<ja){ta=
a.strokeStyle;Ua=a.lineWidth;ab=b.pstyle("text-border-color").value;var Qb=b.pstyle("text-border-style").value;if(a.strokeStyle="rgba("+ab[0]+","+ab[1]+","+ab[2]+","+ja*l+")",a.lineWidth=Ba,a.setLineDash)switch(Qb){case "dotted":a.setLineDash([1,1]);break;case "dashed":a.setLineDash([4,2]);break;case "double":a.lineWidth=Ba/4;a.setLineDash([]);break;case "solid":a.setLineDash([])}if(d?vc(a,K,P,ba,I,2,"stroke"):a.strokeRect(K,P,ba,I),"double"===Qb)l=Ba/2,d?vc(a,K+l,P+l,ba-2*l,I-2*l,2,"stroke"):a.strokeRect(K+
l,P+l,ba-2*l,I-2*l);a.setLineDash&&a.setLineDash([]);a.lineWidth=Ua;a.strokeStyle=ta}}l=2*b.pstyle("text-outline-width").pfValue;if(0<l&&(a.lineWidth=l),"wrap"===b.pstyle("text-wrap").value){D=Ed(h,"labelWrapCachedLines",c);h=Ed(h,"labelLineHeight",c);d=f/2;K=this.getLabelJustification(b);switch("auto"===K||("left"===F?"left"===K?m+=-f:"center"===K&&(m+=-d):"center"===F?"left"===K?m+=-d:"right"===K&&(m+=d):"right"===F&&("center"===K?m+=d:"right"===K&&(m+=f))),X){case "top":t-=(D.length-1)*h;break;
case "center":case "bottom":t-=(D.length-1)*h}for(f=0;f<D.length;f++)0<l&&a.strokeText(D[f],m,t),a.fillText(D[f],m,t),t+=h}else 0<l&&a.strokeText(D,m,t),a.fillText(D,m,t);0!==Y&&(a.rotate(-Y),a.translate(-v,-C))}}}},Og,io,{initWebgl:function(a,b){var c=this,d=c.data.contexts[c.WEBGL];a.bgColor=mc(c);a.webglTexSize=Math.min(a.webglTexSize,d.getParameter(d.MAX_TEXTURE_SIZE));a.webglTexRows=Math.min(a.webglTexRows,54);a.webglTexRowsNodes=Math.min(a.webglTexRowsNodes,54);a.webglBatchSize=Math.min(a.webglBatchSize,
16384);a.webglTexPerBatch=Math.min(a.webglTexPerBatch,d.getParameter(d.MAX_TEXTURE_IMAGE_UNITS));c.webglDebug=a.webglDebug;c.webglDebugShowAtlases=a.webglDebugShowAtlases;c.pickingFrameBuffer=Pf(d);c.pickingFrameBuffer.needsDraw=!0;c.drawing=new Vq(c,d,a);d=function(v){return function(C){return c.getTextAngle(C,v)}};var f=function(v){return function(C){return(C=C.pstyle(v))&&C.value}},h=function(v){return function(C){return 0<C.pstyle("".concat(v,"-opacity")).value}},l=function(v){return"yes"===v.pstyle("text-events").strValue?
2:1},m=function(v){var C=v.position(),D=C.x;C=C.y;var F=v.outerWidth();v=v.outerHeight();return{w:F,h:v,x1:D-F/2,y1:C-v/2}};c.drawing.addAtlasCollection("node",{texRows:a.webglTexRowsNodes});c.drawing.addAtlasCollection("label",{texRows:a.webglTexRows});c.drawing.addTextureAtlasRenderType("node-body",{collection:"node",getKey:b.getStyleKey,getBoundingBox:b.getElementBox,drawElement:b.drawElement});c.drawing.addSimpleShapeRenderType("node-body",{getBoundingBox:m,isSimple:Ud,shapeProps:{shape:"shape",
color:"background-color",opacity:"background-opacity",radius:"corner-radius",border:!0}});c.drawing.addSimpleShapeRenderType("node-overlay",{getBoundingBox:m,isVisible:h("overlay"),shapeProps:{shape:"overlay-shape",color:"overlay-color",opacity:"overlay-opacity",padding:"overlay-padding",radius:"overlay-corner-radius"}});c.drawing.addSimpleShapeRenderType("node-underlay",{getBoundingBox:m,isVisible:h("underlay"),shapeProps:{shape:"underlay-shape",color:"underlay-color",opacity:"underlay-opacity",
padding:"underlay-padding",radius:"underlay-corner-radius"}});c.drawing.addTextureAtlasRenderType("label",{collection:"label",getTexPickingMode:l,getKey:rl(b.getLabelKey,null),getBoundingBox:sl(b.getLabelBox,null),drawClipped:!0,drawElement:b.drawLabel,getRotation:d(null),getRotationPoint:b.getLabelRotationPoint,getRotationOffset:b.getLabelRotationOffset,isVisible:f("label")});c.drawing.addTextureAtlasRenderType("edge-source-label",{collection:"label",getTexPickingMode:l,getKey:rl(b.getSourceLabelKey,
"source"),getBoundingBox:sl(b.getSourceLabelBox,"source"),drawClipped:!0,drawElement:b.drawSourceLabel,getRotation:d("source"),getRotationPoint:b.getSourceLabelRotationPoint,getRotationOffset:b.getSourceLabelRotationOffset,isVisible:f("source-label")});c.drawing.addTextureAtlasRenderType("edge-target-label",{collection:"label",getTexPickingMode:l,getKey:rl(b.getTargetLabelKey,"target"),getBoundingBox:sl(b.getTargetLabelBox,"target"),drawClipped:!0,drawElement:b.drawTargetLabel,getRotation:d("target"),
getRotationPoint:b.getTargetLabelRotationPoint,getRotationOffset:b.getTargetLabelRotationOffset,isVisible:f("target-label")});var t=ne(function(){console.log("garbage collect flag set");c.data.gc=!0},1E4);c.onUpdateEleCalcs(function(v,C){v=!1;C&&0<C.length&&(v|=c.drawing.invalidate(C));v&&t()});xe(c)}},jo,{createBuffer:function(a,b){var c=document.createElement("canvas");return c.width=a,c.height=b,[c,c.getContext("2d")]},bufferCanvasImage:function(a){var b=this.cy,c=b.mutableElements().boundingBox(),
d=this.findContainerClientCoords(),f=a.full?Math.ceil(c.w):d[2];d=a.full?Math.ceil(c.h):d[3];var h=cc(a.maxWidth)||cc(a.maxHeight),l=this.getPixelRatio(),m=1;if(void 0!==a.scale)f*=a.scale,d*=a.scale,m=a.scale;else if(h){var t=1/0,v=1/0;cc(a.maxWidth)&&(t=m*a.maxWidth/f);cc(a.maxHeight)&&(v=m*a.maxHeight/d);m=Math.min(t,v);f*=m;d*=m}h||(f*=l,d*=l,m*=l);h=document.createElement("canvas");h.width=f;h.height=d;h.style.width=f+"px";h.style.height=d+"px";l=h.getContext("2d");0<f&&0<d&&(l.clearRect(0,0,
f,d),l.globalCompositeOperation="source-over",t=this.getCachedZSortedEles(),a.full?(l.translate(-c.x1*m,-c.y1*m),l.scale(m,m),this.drawElements(l,t),l.scale(1/m,1/m),l.translate(c.x1*m,c.y1*m)):(v=b.pan(),c=v.x*m,v=v.y*m,m*=b.zoom(),l.translate(c,v),l.scale(m,m),this.drawElements(l,t),l.scale(1/m,1/m),l.translate(-c,-v)),a.bg&&(l.globalCompositeOperation="destination-over",l.fillStyle=a.bg,l.rect(0,0,f,d),l.fill()));return h},png:function(a){return rb(a,this.bufferCanvasImage(a),"image/png")},jpg:function(a){return rb(a,
this.bufferCanvasImage(a),"image/jpeg")}},{nodeShapeImpl:function(a,b,c,d,f,h,l,m){switch(a){case "ellipse":return this.drawEllipsePath(b,c,d,f,h);case "polygon":return this.drawPolygonPath(b,c,d,f,h,l);case "round-polygon":return this.drawRoundPolygonPath(b,c,d,f,h,l,m);case "roundrectangle":case "round-rectangle":return this.drawRoundRectanglePath(b,c,d,f,h,m);case "cutrectangle":case "cut-rectangle":return this.drawCutRectanglePath(b,c,d,f,h,l,m);case "bottomroundrectangle":case "bottom-round-rectangle":return this.drawBottomRoundRectanglePath(b,
c,d,f,h,m);case "barrel":return this.drawBarrelPath(b,c,d,f,h)}}}].forEach(function(a){Bc(Rc,a)});var Xq=[{type:"layout",extensions:Gq},{type:"renderer",extensions:[{name:"null",impl:ze},{name:"base",impl:ao},{name:"canvas",impl:Gb}]}],hn={},jn={},vl=function(){if(2===arguments.length)return Lc.apply(null,arguments);if(3===arguments.length)return gc.apply(null,arguments);if(4===arguments.length)return Dd.apply(null,arguments);if(5===arguments.length)return Oc.apply(null,arguments);vd("Invalid extension access syntax")};
gi.prototype.extension=vl;Xq.forEach(function(a){a.extensions.forEach(function(b){gc(a.type,b.name,b.impl)})});var jj=function(){if(!(this instanceof jj))return new jj;this.length=0},Qg=jj.prototype;Qg.instanceString=function(){return"stylesheet"};Qg.selector=function(a){return this[this.length++]={selector:a,properties:[]},this};Qg.css=function(a,b){var c=this.length-1;if(rc(a))this[c].properties.push({name:a,value:b});else if(Zc(a)){b=Object.keys(a);for(var d=0;d<b.length;d++){var f=b[d],h=a[f];
null!=h&&(f=Wd.properties[f]||Wd.properties[tg(f)],null!=f&&this[c].properties.push({name:f.name,value:h}))}}return this};Qg.style=Qg.css;Qg.generateStyle=function(a){a=new Wd(a);return this.appendToStyle(a)};Qg.appendToStyle=function(a){for(var b=0;b<this.length;b++){var c=this[b],d=c.properties;a.selector(c.selector);for(c=0;c<d.length;c++){var f=d[c];a.css(f.name,f.value)}}return a};var Rg=function(a){if(void 0===a&&(a={}),Zc(a))return new gi(a);if(rc(a))return vl.apply(vl,arguments)};Rg.use=function(a){var b=
Array.prototype.slice.call(arguments,1);return b.unshift(Rg),a.apply(null,b),this};Rg.warnings=function(a){return ai(a)};Rg.version="3.32.0";Rg.stylesheet=Rg.Stylesheet=jj;p.exports=Rg}),Zq=va((n,p)=>{p.exports=function(){this.__data__=[];this.size=0}}),Hh=va((n,p)=>{p.exports=function(q,u){return q===u||q!==q&&u!==u}}),kj=va((n,p)=>{var q=Hh();p.exports=function(u,w){for(var y=u.length;y--;)if(q(u[y][0],w))return y;return-1}}),$q=va((n,p)=>{var q=kj(),u=Array.prototype.splice;p.exports=function(w){var y=
this.__data__;w=q(y,w);return 0>w?!1:(w==y.length-1?y.pop():u.call(y,w,1),--this.size,!0)}}),ar=va((n,p)=>{var q=kj();p.exports=function(u){var w=this.__data__;u=q(w,u);return 0>u?void 0:w[u][1]}}),br=va((n,p)=>{var q=kj();p.exports=function(u){return-1<q(this.__data__,u)}}),cr=va((n,p)=>{var q=kj();p.exports=function(u,w){var y=this.__data__,B=q(y,u);return 0>B?(++this.size,y.push([u,w])):y[B][1]=w,this}}),lj=va((n,p)=>{function q(z){var E=-1,H=null==z?0:z.length;for(this.clear();++E<H;){var T=z[E];
this.set(T[0],T[1])}}n=Zq();var u=$q(),w=ar(),y=br(),B=cr();q.prototype.clear=n;q.prototype.delete=u;q.prototype.get=w;q.prototype.has=y;q.prototype.set=B;p.exports=q}),dr=va((n,p)=>{var q=lj();p.exports=function(){this.__data__=new q;this.size=0}}),er=va((n,p)=>{p.exports=function(q){var u=this.__data__;q=u.delete(q);return this.size=u.size,q}}),fr=va((n,p)=>{p.exports=function(q){return this.__data__.get(q)}}),gr=va((n,p)=>{p.exports=function(q){return this.__data__.has(q)}}),no=va((n,p)=>{p.exports=
"object"==typeof global&&global&&global.Object===Object&&global}),Xe=va((n,p)=>{n=no();var q="object"==typeof self&&self&&self.Object===Object&&self;n=n||q||Function("return this")();p.exports=n}),Ih=va((n,p)=>{n=Xe().Symbol;p.exports=n}),hr=va((n,p)=>{n=Ih();var q=Object.prototype,u=q.hasOwnProperty,w=q.toString,y=n?n.toStringTag:void 0;p.exports=function(B){var z=u.call(B,y),E=B[y];try{B[y]=void 0;var H=!0}catch{}var T=w.call(B);return H&&(z?B[y]=E:delete B[y]),T}}),ir=va((n,p)=>{var q=Object.prototype.toString;
p.exports=function(u){return q.call(u)}}),Sg=va((n,p)=>{n=Ih();var q=hr(),u=ir(),w=n?n.toStringTag:void 0;p.exports=function(y){return null==y?void 0===y?"[object Undefined]":"[object Null]":w&&w in Object(y)?q(y):u(y)}}),Le=va((n,p)=>{p.exports=function(q){var u=typeof q;return null!=q&&("object"==u||"function"==u)}}),ni=va((n,p)=>{var q=Sg(),u=Le();p.exports=function(w){if(!u(w))return!1;w=q(w);return"[object Function]"==w||"[object GeneratorFunction]"==w||"[object AsyncFunction]"==w||"[object Proxy]"==
w}}),jr=va((n,p)=>{n=Xe()["__core-js_shared__"];p.exports=n}),kr=va((n,p)=>{var q=jr(),u=function(){var w=/[^.]+$/.exec(q&&q.keys&&q.keys.IE_PROTO||"");return w?"Symbol(src)_1."+w:""}();p.exports=function(w){return!!u&&u in w}}),oo=va((n,p)=>{var q=Function.prototype.toString;p.exports=function(u){if(null!=u){try{return q.call(u)}catch{}return u+""}return""}}),lr=va((n,p)=>{var q=ni(),u=kr(),w=Le(),y=oo(),B=/^\[object .+?Constructor\]$/,z=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,
"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");p.exports=function(E){return!w(E)||u(E)?!1:(q(E)?z:B).test(y(E))}}),mr=va((n,p)=>{p.exports=function(q,u){return q?.[u]}}),Tg=va((n,p)=>{var q=lr(),u=mr();p.exports=function(w,y){w=u(w,y);return q(w)?w:void 0}}),wl=va((n,p)=>{n=Tg();var q=Xe();n=n(q,"Map");p.exports=n}),mj=va((n,p)=>{n=Tg()(Object,"create");p.exports=n}),nr=va((n,p)=>{var q=mj();p.exports=function(){this.__data__=q?q(null):{};this.size=0}}),or=
va((n,p)=>{p.exports=function(q){q=this.has(q)&&delete this.__data__[q];return this.size-=q?1:0,q}}),pr=va((n,p)=>{var q=mj(),u=Object.prototype.hasOwnProperty;p.exports=function(w){var y=this.__data__;return q?(w=y[w],"__lodash_hash_undefined__"===w?void 0:w):u.call(y,w)?y[w]:void 0}}),qr=va((n,p)=>{var q=mj(),u=Object.prototype.hasOwnProperty;p.exports=function(w){var y=this.__data__;return q?void 0!==y[w]:u.call(y,w)}}),rr=va((n,p)=>{var q=mj();p.exports=function(u,w){var y=this.__data__;return this.size+=
this.has(u)?0:1,y[u]=q&&void 0===w?"__lodash_hash_undefined__":w,this}}),sr=va((n,p)=>{function q(z){var E=-1,H=null==z?0:z.length;for(this.clear();++E<H;){var T=z[E];this.set(T[0],T[1])}}n=nr();var u=or(),w=pr(),y=qr(),B=rr();q.prototype.clear=n;q.prototype.delete=u;q.prototype.get=w;q.prototype.has=y;q.prototype.set=B;p.exports=q}),tr=va((n,p)=>{var q=sr(),u=lj(),w=wl();p.exports=function(){this.size=0;this.__data__={hash:new q,map:new (w||u),string:new q}}}),ur=va((n,p)=>{p.exports=function(q){var u=
typeof q;return"string"==u||"number"==u||"symbol"==u||"boolean"==u?"__proto__"!==q:null===q}}),nj=va((n,p)=>{var q=ur();p.exports=function(u,w){u=u.__data__;return q(w)?u["string"==typeof w?"string":"hash"]:u.map}}),vr=va((n,p)=>{var q=nj();p.exports=function(u){u=q(this,u).delete(u);return this.size-=u?1:0,u}}),wr=va((n,p)=>{var q=nj();p.exports=function(u){return q(this,u).get(u)}}),xr=va((n,p)=>{var q=nj();p.exports=function(u){return q(this,u).has(u)}}),yr=va((n,p)=>{var q=nj();p.exports=function(u,
w){var y=q(this,u),B=y.size;return y.set(u,w),this.size+=y.size==B?0:1,this}}),xl=va((n,p)=>{function q(z){var E=-1,H=null==z?0:z.length;for(this.clear();++E<H;){var T=z[E];this.set(T[0],T[1])}}n=tr();var u=vr(),w=wr(),y=xr(),B=yr();q.prototype.clear=n;q.prototype.delete=u;q.prototype.get=w;q.prototype.has=y;q.prototype.set=B;p.exports=q}),zr=va((n,p)=>{var q=lj(),u=wl(),w=xl();p.exports=function(y,B){var z=this.__data__;if(z instanceof q){var E=z.__data__;if(!u||199>E.length)return E.push([y,B]),
this.size=++z.size,this;z=this.__data__=new w(E)}return z.set(y,B),this.size=z.size,this}}),oj=va((n,p)=>{function q(E){this.size=(this.__data__=new u(E)).size}var u=lj();n=dr();var w=er(),y=fr(),B=gr(),z=zr();q.prototype.clear=n;q.prototype.delete=w;q.prototype.get=y;q.prototype.has=B;q.prototype.set=z;p.exports=q}),yl=va((n,p)=>{p.exports=function(q,u){for(var w=-1,y=null==q?0:q.length;++w<y&&!1!==u(q[w],w,q););return q}}),po=va((n,p)=>{n=Tg();a:{try{var q=n(Object,"defineProperty");var u=(q({},
"",{}),q);break a}catch{}u=void 0}p.exports=u}),pj=va((n,p)=>{var q=po();p.exports=function(u,w,y){"__proto__"==w&&q?q(u,w,{configurable:!0,enumerable:!0,value:y,writable:!0}):u[w]=y}}),qj=va((n,p)=>{var q=pj(),u=Hh(),w=Object.prototype.hasOwnProperty;p.exports=function(y,B,z){var E=y[B];w.call(y,B)&&u(E,z)&&(void 0!==z||B in y)||q(y,B,z)}}),oi=va((n,p)=>{var q=qj(),u=pj();p.exports=function(w,y,B,z){var E=!B;B||={};for(var H=-1,T=y.length;++H<T;){var ca=y[H],ha=z?z(B[ca],w[ca],ca,B,w):void 0;void 0===
ha&&(ha=w[ca]);E?u(B,ca,ha):q(B,ca,ha)}return B}}),Ar=va((n,p)=>{p.exports=function(q,u){for(var w=-1,y=Array(q);++w<q;)y[w]=u(w);return y}}),nf=va((n,p)=>{p.exports=function(q){return null!=q&&"object"==typeof q}}),Br=va((n,p)=>{var q=Sg(),u=nf();p.exports=function(w){return u(w)&&"[object Arguments]"==q(w)}}),pi=va((n,p)=>{n=Br();var q=nf(),u=Object.prototype,w=u.hasOwnProperty,y=u.propertyIsEnumerable;n=n(function(){return arguments}())?n:function(B){return q(B)&&w.call(B,"callee")&&!y.call(B,
"callee")};p.exports=n}),Nd=va((n,p)=>{p.exports=Array.isArray}),Cr=va((n,p)=>{p.exports=function(){return!1}}),Jh=va((n,p)=>{var q=Xe(),u=Cr(),w=(n="object"==typeof n&&n&&!n.nodeType&&n)&&"object"==typeof p&&p&&!p.nodeType&&p;q=w&&w.exports===n?q.Buffer:void 0;p.exports=(q?q.isBuffer:void 0)||u}),rj=va((n,p)=>{var q=/^(?:0|[1-9]\d*)$/;p.exports=function(u,w){var y=typeof u;return w=w??9007199254740991,!!w&&("number"==y||"symbol"!=y&&q.test(u))&&-1<u&&0==u%1&&u<w}}),zl=va((n,p)=>{p.exports=function(q){return"number"==
typeof q&&-1<q&&0==q%1&&9007199254740991>=q}}),Dr=va((n,p)=>{var q=Sg(),u=zl(),w=nf(),y={};y["[object Float32Array]"]=y["[object Float64Array]"]=y["[object Int8Array]"]=y["[object Int16Array]"]=y["[object Int32Array]"]=y["[object Uint8Array]"]=y["[object Uint8ClampedArray]"]=y["[object Uint16Array]"]=y["[object Uint32Array]"]=!0;y["[object Arguments]"]=y["[object Array]"]=y["[object ArrayBuffer]"]=y["[object Boolean]"]=y["[object DataView]"]=y["[object Date]"]=y["[object Error]"]=y["[object Function]"]=
y["[object Map]"]=y["[object Number]"]=y["[object Object]"]=y["[object RegExp]"]=y["[object Set]"]=y["[object String]"]=y["[object WeakMap]"]=!1;p.exports=function(B){return w(B)&&u(B.length)&&!!y[q(B)]}}),sj=va((n,p)=>{p.exports=function(q){return function(u){return q(u)}}}),Al=va((n,p)=>{var q=no(),u="object"==typeof n&&n&&!n.nodeType&&n;q=(n=u&&"object"==typeof p&&p&&!p.nodeType&&p)&&n.exports===u&&q.process;a:{try{var w=n&&n.require&&n.require("util").types||q&&q.binding&&q.binding("util");break a}catch{}w=
void 0}p.exports=w}),qi=va((n,p)=>{n=Dr();var q=sj(),u=Al();n=(u=u&&u.isTypedArray)?q(u):n;p.exports=n}),qo=va((n,p)=>{var q=Ar(),u=pi(),w=Nd(),y=Jh(),B=rj(),z=qi(),E=Object.prototype.hasOwnProperty;p.exports=function(H,T){var ca=w(H),ha=!ca&&u(H),Da=!ca&&!ha&&y(H),Fa=!ca&&!ha&&!Da&&z(H);ha=(ca=ca||ha||Da||Fa)?q(H.length,String):[];var ua=ha.length,Va;for(Va in H)!T&&!E.call(H,Va)||ca&&("length"==Va||Da&&("offset"==Va||"parent"==Va)||Fa&&("buffer"==Va||"byteLength"==Va||"byteOffset"==Va)||B(Va,ua))||
ha.push(Va);return ha}}),tj=va((n,p)=>{var q=Object.prototype;p.exports=function(u){var w=u&&u.constructor;return u===("function"==typeof w&&w.prototype||q)}}),ro=va((n,p)=>{p.exports=function(q,u){return function(w){return q(u(w))}}}),Er=va((n,p)=>{n=ro()(Object.keys,Object);p.exports=n}),Bl=va((n,p)=>{var q=tj(),u=Er(),w=Object.prototype.hasOwnProperty;p.exports=function(y){if(!q(y))return u(y);var B=[],z;for(z in Object(y))w.call(y,z)&&"constructor"!=z&&B.push(z);return B}}),Ff=va((n,p)=>{var q=
ni(),u=zl();p.exports=function(w){return null!=w&&u(w.length)&&!q(w)}}),fg=va((n,p)=>{var q=qo(),u=Bl(),w=Ff();p.exports=function(y){return w(y)?q(y):u(y)}}),Fr=va((n,p)=>{var q=oi(),u=fg();p.exports=function(w,y){return w&&q(y,u(y),w)}}),Gr=va((n,p)=>{p.exports=function(q){var u=[];if(null!=q)for(var w in Object(q))u.push(w);return u}}),Hr=va((n,p)=>{var q=Le(),u=tj(),w=Gr(),y=Object.prototype.hasOwnProperty;p.exports=function(B){if(!q(B))return w(B);var z=u(B),E=[],H;for(H in B)"constructor"==H&&
(z||!y.call(B,H))||E.push(H);return E}}),Ug=va((n,p)=>{var q=qo(),u=Hr(),w=Ff();p.exports=function(y){return w(y)?q(y,!0):u(y)}}),Ir=va((n,p)=>{var q=oi(),u=Ug();p.exports=function(w,y){return w&&q(y,u(y),w)}}),so=va((n,p)=>{var q=Xe(),u=(n="object"==typeof n&&n&&!n.nodeType&&n)&&"object"==typeof p&&p&&!p.nodeType&&p,w=(q=u&&u.exports===n?q.Buffer:void 0)?q.allocUnsafe:void 0;p.exports=function(y,B){if(B)return y.slice();B=y.length;B=w?w(B):new y.constructor(B);return y.copy(B),B}}),to=va((n,p)=>
{p.exports=function(q,u){var w=-1,y=q.length;for(u||=Array(y);++w<y;)u[w]=q[w];return u}}),uo=va((n,p)=>{p.exports=function(q,u){for(var w=-1,y=null==q?0:q.length,B=0,z=[];++w<y;){var E=q[w];u(E,w,q)&&(z[B++]=E)}return z}}),vo=va((n,p)=>{p.exports=function(){return[]}}),Cl=va((n,p)=>{var q=uo();n=vo();var u=Object.prototype.propertyIsEnumerable,w=Object.getOwnPropertySymbols;p.exports=w?function(y){return null==y?[]:(y=Object(y),q(w(y),function(B){return u.call(y,B)}))}:n}),Jr=va((n,p)=>{var q=oi(),
u=Cl();p.exports=function(w,y){return q(w,u(w),y)}}),Dl=va((n,p)=>{p.exports=function(q,u){for(var w=-1,y=u.length,B=q.length;++w<y;)q[B+w]=u[w];return q}}),uj=va((n,p)=>{n=ro()(Object.getPrototypeOf,Object);p.exports=n}),wo=va((n,p)=>{var q=Dl(),u=uj(),w=Cl();n=vo();p.exports=Object.getOwnPropertySymbols?function(y){for(var B=[];y;)q(B,w(y)),y=u(y);return B}:n}),Kr=va((n,p)=>{var q=oi(),u=wo();p.exports=function(w,y){return q(w,u(w),y)}}),xo=va((n,p)=>{var q=Dl(),u=Nd();p.exports=function(w,y,B){y=
y(w);return u(w)?y:q(y,B(w))}}),yo=va((n,p)=>{var q=xo(),u=Cl(),w=fg();p.exports=function(y){return q(y,w,u)}}),Lr=va((n,p)=>{var q=xo(),u=wo(),w=Ug();p.exports=function(y){return q(y,w,u)}}),Mr=va((n,p)=>{n=Tg();var q=Xe();n=n(q,"DataView");p.exports=n}),Nr=va((n,p)=>{n=Tg();var q=Xe();n=n(q,"Promise");p.exports=n}),zo=va((n,p)=>{n=Tg();var q=Xe();n=n(q,"Set");p.exports=n}),Or=va((n,p)=>{n=Tg();var q=Xe();n=n(q,"WeakMap");p.exports=n}),Kh=va((n,p)=>{n=Mr();var q=wl(),u=Nr(),w=zo(),y=Or(),B=Sg(),
z=oo(),E=z(n),H=z(q),T=z(u),ca=z(w),ha=z(y),Da=B;(n&&"[object DataView]"!=Da(new n(new ArrayBuffer(1)))||q&&"[object Map]"!=Da(new q)||u&&"[object Promise]"!=Da(u.resolve())||w&&"[object Set]"!=Da(new w)||y&&"[object WeakMap]"!=Da(new y))&&(Da=function(Fa){var ua=B(Fa);if(Fa=(Fa="[object Object]"==ua?Fa.constructor:void 0)?z(Fa):"")switch(Fa){case E:return"[object DataView]";case H:return"[object Map]";case T:return"[object Promise]";case ca:return"[object Set]";case ha:return"[object WeakMap]"}return ua});
p.exports=Da}),Pr=va((n,p)=>{var q=Object.prototype.hasOwnProperty;p.exports=function(u){var w=u.length,y=new u.constructor(w);return w&&"string"==typeof u[0]&&q.call(u,"index")&&(y.index=u.index,y.input=u.input),y}}),Ao=va((n,p)=>{n=Xe().Uint8Array;p.exports=n}),El=va((n,p)=>{var q=Ao();p.exports=function(u){var w=new u.constructor(u.byteLength);return(new q(w)).set(new q(u)),w}}),Qr=va((n,p)=>{var q=El();p.exports=function(u,w){w=w?q(u.buffer):u.buffer;return new u.constructor(w,u.byteOffset,u.byteLength)}}),
Rr=va((n,p)=>{var q=/\w*$/;p.exports=function(u){var w=new u.constructor(u.source,q.exec(u));return w.lastIndex=u.lastIndex,w}}),Sr=va((n,p)=>{var q=(n=(n=Ih())?n.prototype:void 0)?n.valueOf:void 0;p.exports=function(u){return q?Object(q.call(u)):{}}}),Bo=va((n,p)=>{var q=El();p.exports=function(u,w){w=w?q(u.buffer):u.buffer;return new u.constructor(w,u.byteOffset,u.length)}}),Tr=va((n,p)=>{var q=El(),u=Qr(),w=Rr(),y=Sr(),B=Bo();p.exports=function(z,E,H){var T=z.constructor;switch(E){case "[object ArrayBuffer]":return q(z);
case "[object Boolean]":case "[object Date]":return new T(+z);case "[object DataView]":return u(z,H);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return B(z,H);case "[object Map]":return new T;case "[object Number]":case "[object String]":return new T(z);case "[object RegExp]":return w(z);case "[object Set]":return new T;
case "[object Symbol]":return y(z)}}}),Co=va((n,p)=>{var q=Le(),u=Object.create;n=function(){function w(){}return function(y){if(!q(y))return{};if(u)return u(y);w.prototype=y;y=new w;return w.prototype=void 0,y}}();p.exports=n}),Do=va((n,p)=>{var q=Co(),u=uj(),w=tj();p.exports=function(y){return"function"!=typeof y.constructor||w(y)?{}:q(u(y))}}),Ur=va((n,p)=>{var q=Kh(),u=nf();p.exports=function(w){return u(w)&&"[object Map]"==q(w)}}),Vr=va((n,p)=>{n=Ur();var q=sj(),u=Al();n=(u=u&&u.isMap)?q(u):
n;p.exports=n}),Wr=va((n,p)=>{var q=Kh(),u=nf();p.exports=function(w){return u(w)&&"[object Set]"==q(w)}}),Xr=va((n,p)=>{n=Wr();var q=sj(),u=Al();n=(u=u&&u.isSet)?q(u):n;p.exports=n}),Eo=va((n,p)=>{function q(qb,Lb,Xb,$b,pc,yb){var Bb,Db=Lb&1,Cb=Lb&2,sb=Lb&4;if(Xb&&(Bb=pc?Xb(qb,$b,pc,yb):Xb(qb)),void 0!==Bb)return Bb;if(!kb(qb))return qb;if($b=sa(qb)){if(Bb=ua(qb),!Db)return H(qb,Bb)}else{var Sb=Fa(qb),lc="[object Function]"==Sb||"[object GeneratorFunction]"==Sb;if(Na(qb))return E(qb,Db);if("[object Object]"==
Sb||"[object Arguments]"==Sb||lc&&!pc){if(Bb=Cb||lc?{}:Ha(qb),!Db)return Cb?ca(qb,z(Bb,qb)):T(qb,B(Bb,qb))}else{if(!gb[Sb])return pc?qb:{};Bb=Va(qb,Sb,Db)}}yb||=new u;if(pc=yb.get(qb))return pc;yb.set(qb,Bb);pb(qb)?qb.forEach(function(oc){Bb.add(q(oc,Lb,Xb,oc,qb,yb))}):Qa(qb)&&qb.forEach(function(oc,bb){Bb.set(bb,q(oc,Lb,Xb,bb,qb,yb))});Cb=sb?Cb?Da:ha:Cb?zb:ib;var qc=$b?void 0:Cb(qb);return w(qc||qb,function(oc,bb){qc&&(bb=oc,oc=qb[bb]);y(Bb,bb,q(oc,Lb,Xb,bb,qb,yb))}),Bb}var u=oj(),w=yl(),y=qj(),
B=Fr(),z=Ir(),E=so(),H=to(),T=Jr(),ca=Kr(),ha=yo(),Da=Lr(),Fa=Kh(),ua=Pr(),Va=Tr(),Ha=Do(),sa=Nd(),Na=Jh(),Qa=Vr(),kb=Le(),pb=Xr(),ib=fg(),zb=Ug(),gb={};gb["[object Arguments]"]=gb["[object Array]"]=gb["[object ArrayBuffer]"]=gb["[object DataView]"]=gb["[object Boolean]"]=gb["[object Date]"]=gb["[object Float32Array]"]=gb["[object Float64Array]"]=gb["[object Int8Array]"]=gb["[object Int16Array]"]=gb["[object Int32Array]"]=gb["[object Map]"]=gb["[object Number]"]=gb["[object Object]"]=gb["[object RegExp]"]=
gb["[object Set]"]=gb["[object String]"]=gb["[object Symbol]"]=gb["[object Uint8Array]"]=gb["[object Uint8ClampedArray]"]=gb["[object Uint16Array]"]=gb["[object Uint32Array]"]=!0;gb["[object Error]"]=gb["[object Function]"]=gb["[object WeakMap]"]=!1;p.exports=q}),Yr=va((n,p)=>{var q=Eo();p.exports=function(u){return q(u,4)}}),Fl=va((n,p)=>{p.exports=function(q){return function(){return q}}}),Zr=va((n,p)=>{p.exports=function(q){return function(u,w,y){var B=-1,z=Object(u);y=y(u);for(var E=y.length;E--;){var H=
y[q?E:++B];if(!1===w(z[H],H,z))break}return u}}}),Gl=va((n,p)=>{n=Zr()();p.exports=n}),Hl=va((n,p)=>{var q=Gl(),u=fg();p.exports=function(w,y){return w&&q(w,y,u)}}),$r=va((n,p)=>{var q=Ff();p.exports=function(u,w){return function(y,B){if(null==y)return y;if(!q(y))return u(y,B);for(var z=y.length,E=w?z:-1,H=Object(y);(w?E--:++E<z)&&!1!==B(H[E],E,H););return y}}}),vj=va((n,p)=>{n=Hl();n=$r()(n);p.exports=n}),Vg=va((n,p)=>{p.exports=function(q){return q}}),Fo=va((n,p)=>{var q=Vg();p.exports=function(u){return"function"==
typeof u?u:q}}),Go=va((n,p)=>{var q=yl(),u=vj(),w=Fo(),y=Nd();p.exports=function(B,z){return(y(B)?q:u)(B,w(z))}}),Ho=va((n,p)=>{p.exports=Go()}),as=va((n,p)=>{var q=vj();p.exports=function(u,w){var y=[];return q(u,function(B,z,E){w(B,z,E)&&y.push(B)}),y}}),bs=va((n,p)=>{p.exports=function(q){return this.__data__.set(q,"__lodash_hash_undefined__"),this}}),cs=va((n,p)=>{p.exports=function(q){return this.__data__.has(q)}}),Io=va((n,p)=>{function q(y){var B=-1,z=null==y?0:y.length;for(this.__data__=new u;++B<
z;)this.add(y[B])}var u=xl();n=bs();var w=cs();q.prototype.add=q.prototype.push=n;q.prototype.has=w;p.exports=q}),ds=va((n,p)=>{p.exports=function(q,u){for(var w=-1,y=null==q?0:q.length;++w<y;)if(u(q[w],w,q))return!0;return!1}}),Jo=va((n,p)=>{p.exports=function(q,u){return q.has(u)}}),Ko=va((n,p)=>{var q=Io(),u=ds(),w=Jo();p.exports=function(y,B,z,E,H,T){var ca=z&1,ha=y.length,Da=B.length;if(ha!=Da&&!(ca&&Da>ha))return!1;Da=T.get(y);var Fa=T.get(B);if(Da&&Fa)return Da==B&&Fa==y;Da=-1;Fa=!0;var ua=
z&2?new q:void 0;T.set(y,B);for(T.set(B,y);++Da<ha;){var Va=y[Da],Ha=B[Da];if(E)var sa=ca?E(Ha,Va,Da,B,y,T):E(Va,Ha,Da,y,B,T);if(void 0!==sa){if(sa)continue;Fa=!1;break}if(ua){if(!u(B,function(Na,Qa){if(!w(ua,Qa)&&(Va===Na||H(Va,Na,z,E,T)))return ua.push(Qa)})){Fa=!1;break}}else if(Va!==Ha&&!H(Va,Ha,z,E,T)){Fa=!1;break}}return T.delete(y),T.delete(B),Fa}}),es=va((n,p)=>{p.exports=function(q){var u=-1,w=Array(q.size);return q.forEach(function(y,B){w[++u]=[B,y]}),w}}),Il=va((n,p)=>{p.exports=function(q){var u=
-1,w=Array(q.size);return q.forEach(function(y){w[++u]=y}),w}}),fs=va((n,p)=>{n=Ih();var q=Ao(),u=Hh(),w=Ko(),y=es(),B=Il(),z=(n=n?n.prototype:void 0)?n.valueOf:void 0;p.exports=function(E,H,T,ca,ha,Da,Fa){switch(T){case "[object DataView]":if(E.byteLength!=H.byteLength||E.byteOffset!=H.byteOffset)break;E=E.buffer;H=H.buffer;case "[object ArrayBuffer]":return!(E.byteLength!=H.byteLength||!Da(new q(E),new q(H)));case "[object Boolean]":case "[object Date]":case "[object Number]":return u(+E,+H);case "[object Error]":return E.name==
H.name&&E.message==H.message;case "[object RegExp]":case "[object String]":return E==H+"";case "[object Map]":var ua=y;case "[object Set]":if(ua||=B,E.size!=H.size&&!(ca&1))break;if(T=Fa.get(E))return T==H;ca|=2;Fa.set(E,H);H=w(ua(E),ua(H),ca,ha,Da,Fa);return Fa.delete(E),H;case "[object Symbol]":if(z)return z.call(E)==z.call(H)}return!1}}),gs=va((n,p)=>{var q=yo(),u=Object.prototype.hasOwnProperty;p.exports=function(w,y,B,z,E,H){var T=B&1,ca=q(w),ha=ca.length,Da=q(y).length;if(ha!=Da&&!T)return!1;
for(Da=ha;Da--;){var Fa=ca[Da];if(!(T?Fa in y:u.call(y,Fa)))return!1}var ua=H.get(w);Fa=H.get(y);if(ua&&Fa)return ua==y&&Fa==w;ua=!0;H.set(w,y);H.set(y,w);for(var Va=T;++Da<ha;){Fa=ca[Da];var Ha=w[Fa],sa=y[Fa];if(z)var Na=T?z(sa,Ha,Fa,y,w,H):z(Ha,sa,Fa,w,y,H);if(void 0===Na?Ha!==sa&&!E(Ha,sa,B,z,H):!Na){ua=!1;break}Va||="constructor"==Fa}ua&&!Va&&(B=w.constructor,z=y.constructor,B!=z&&"constructor"in w&&"constructor"in y&&!("function"==typeof B&&B instanceof B&&"function"==typeof z&&z instanceof z)&&
(ua=!1));return H.delete(w),H.delete(y),ua}}),hs=va((n,p)=>{var q=oj(),u=Ko(),w=fs(),y=gs(),B=Kh(),z=Nd(),E=Jh(),H=qi(),T=Object.prototype.hasOwnProperty;p.exports=function(ca,ha,Da,Fa,ua,Va){var Ha=z(ca),sa=z(ha),Na=Ha?"[object Array]":B(ca),Qa=sa?"[object Array]":B(ha);Na="[object Arguments]"==Na?"[object Object]":Na;Qa="[object Arguments]"==Qa?"[object Object]":Qa;var kb="[object Object]"==Na;sa="[object Object]"==Qa;if((Qa=Na==Qa)&&E(ca)){if(!E(ha))return!1;Ha=!0;kb=!1}return Qa&&!kb?(Va||=new q,
Ha||H(ca)?u(ca,ha,Da,Fa,ua,Va):w(ca,ha,Na,Da,Fa,ua,Va)):Da&1||(Ha=kb&&T.call(ca,"__wrapped__"),Na=sa&&T.call(ha,"__wrapped__"),!Ha&&!Na)?Qa?(Va||=new q,y(ca,ha,Da,Fa,ua,Va)):!1:(ca=Ha?ca.value():ca,ha=Na?ha.value():ha,Va||=new q,ua(ca,ha,Da,Fa,Va))}}),Lo=va((n,p)=>{function q(y,B,z,E,H){return y===B?!0:null==y||null==B||!w(y)&&!w(B)?y!==y&&B!==B:u(y,B,z,E,q,H)}var u=hs(),w=nf();p.exports=q}),is=va((n,p)=>{var q=oj(),u=Lo();p.exports=function(w,y,B,z){var E=B.length,H=E,T=!z;if(null==w)return!H;for(w=
Object(w);E--;){var ca=B[E];if(T&&ca[2]?ca[1]!==w[ca[0]]:!(ca[0]in w))return!1}for(;++E<H;){ca=B[E];var ha=ca[0],Da=w[ha],Fa=ca[1];if(T&&ca[2]){if(void 0===Da&&!(ha in w))return!1}else{ca=new q;if(z)var ua=z(Da,Fa,ha,w,y,ca);if(void 0===ua?!u(Fa,Da,3,z,ca):!ua)return!1}}return!0}}),Mo=va((n,p)=>{var q=Le();p.exports=function(u){return u===u&&!q(u)}}),js=va((n,p)=>{var q=Mo(),u=fg();p.exports=function(w){for(var y=u(w),B=y.length;B--;){var z=y[B],E=w[z];y[B]=[z,E,q(E)]}return y}}),No=va((n,p)=>{p.exports=
function(q,u){return function(w){return null==w?!1:w[q]===u&&(void 0!==u||q in Object(w))}}}),ks=va((n,p)=>{var q=is(),u=js(),w=No();p.exports=function(y){var B=u(y);return 1==B.length&&B[0][2]?w(B[0][0],B[0][1]):function(z){return z===y||q(z,y,B)}}}),Lh=va((n,p)=>{var q=Sg(),u=nf();p.exports=function(w){return"symbol"==typeof w||u(w)&&"[object Symbol]"==q(w)}}),Jl=va((n,p)=>{var q=Nd(),u=Lh(),w=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,y=/^\w*$/;p.exports=function(B,z){if(q(B))return!1;
var E=typeof B;return"number"==E||"symbol"==E||"boolean"==E||null==B||u(B)?!0:y.test(B)||!w.test(B)||null!=z&&B in Object(z)}}),ls=va((n,p)=>{function q(w,y){if("function"!=typeof w||null!=y&&"function"!=typeof y)throw new TypeError("Expected a function");var B=function(){var z=arguments,E=y?y.apply(this,z):z[0],H=B.cache;if(H.has(E))return H.get(E);z=w.apply(this,z);return B.cache=H.set(E,z)||H,z};return B.cache=new (q.Cache||u),B}var u=xl();q.Cache=u;p.exports=q}),ms=va((n,p)=>{var q=ls();p.exports=
function(u){u=q(u,function(y){return 500===w.size&&w.clear(),y});var w=u.cache;return u}}),ns=va((n,p)=>{var q=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,u=/\\(\\)?/g;n=ms()(function(w){var y=[];return 46===w.charCodeAt(0)&&y.push(""),w.replace(q,function(B,z,E,H){y.push(E?H.replace(u,"$1"):z||B)}),y});p.exports=n}),wj=va((n,p)=>{p.exports=function(q,u){for(var w=-1,y=null==q?0:q.length,B=Array(y);++w<y;)B[w]=u(q[w],w,q);return B}}),os=va((n,
p)=>{function q(E){if("string"==typeof E)return E;if(w(E))return u(E,q)+"";if(y(E))return z?z.call(E):"";var H=E+"";return"0"==H&&1/E==-B?"-0":H}n=Ih();var u=wj(),w=Nd(),y=Lh(),B=1/0,z=(n=n?n.prototype:void 0)?n.toString:void 0;p.exports=q}),Oo=va((n,p)=>{var q=os();p.exports=function(u){return null==u?"":q(u)}}),xj=va((n,p)=>{var q=Nd(),u=Jl(),w=ns(),y=Oo();p.exports=function(B,z){return q(B)?B:u(B,z)?[B]:w(y(B))}}),ri=va((n,p)=>{var q=Lh(),u=1/0;p.exports=function(w){if("string"==typeof w||q(w))return w;
var y=w+"";return"0"==y&&1/w==-u?"-0":y}}),yj=va((n,p)=>{var q=xj(),u=ri();p.exports=function(w,y){y=q(y,w);for(var B=0,z=y.length;null!=w&&B<z;)w=w[u(y[B++])];return B&&B==z?w:void 0}}),ps=va((n,p)=>{var q=yj();p.exports=function(u,w,y){u=null==u?void 0:q(u,w);return void 0===u?y:u}}),qs=va((n,p)=>{p.exports=function(q,u){return null!=q&&u in Object(q)}}),Po=va((n,p)=>{var q=xj(),u=pi(),w=Nd(),y=rj(),B=zl(),z=ri();p.exports=function(E,H,T){H=q(H,E);for(var ca=-1,ha=H.length,Da=!1;++ca<ha;){var Fa=
z(H[ca]);if(!(Da=null!=E&&T(E,Fa)))break;E=E[Fa]}return Da||++ca!=ha?Da:(ha=null==E?0:E.length,!!ha&&B(ha)&&y(Fa,ha)&&(w(E)||u(E)))}}),Qo=va((n,p)=>{var q=qs(),u=Po();p.exports=function(w,y){return null!=w&&u(w,y,q)}}),rs=va((n,p)=>{var q=Lo(),u=ps(),w=Qo(),y=Jl(),B=Mo(),z=No(),E=ri();p.exports=function(H,T){return y(H)&&B(T)?z(E(H),T):function(ca){var ha=u(ca,H);return void 0===ha&&ha===T?w(ca,H):q(T,ha,3)}}}),Ro=va((n,p)=>{p.exports=function(q){return function(u){return u?.[q]}}}),ss=va((n,p)=>
{var q=yj();p.exports=function(u){return function(w){return q(w,u)}}}),ts=va((n,p)=>{var q=Ro(),u=ss(),w=Jl(),y=ri();p.exports=function(B){return w(B)?q(y(B)):u(B)}}),Gf=va((n,p)=>{var q=ks(),u=rs(),w=Vg(),y=Nd(),B=ts();p.exports=function(z){return"function"==typeof z?z:null==z?w:"object"==typeof z?y(z)?u(z[0],z[1]):q(z):B(z)}}),So=va((n,p)=>{var q=uo(),u=as(),w=Gf(),y=Nd();p.exports=function(B,z){return(y(B)?q:u)(B,w(z,3))}}),us=va((n,p)=>{var q=Object.prototype.hasOwnProperty;p.exports=function(u,
w){return null!=u&&q.call(u,w)}}),To=va((n,p)=>{var q=us(),u=Po();p.exports=function(w,y){return null!=w&&u(w,y,q)}}),vs=va((n,p)=>{var q=Bl(),u=Kh(),w=pi(),y=Nd(),B=Ff(),z=Jh(),E=tj(),H=qi(),T=Object.prototype.hasOwnProperty;p.exports=function(ca){if(null==ca)return!0;if(B(ca)&&(y(ca)||"string"==typeof ca||"function"==typeof ca.splice||z(ca)||H(ca)||w(ca)))return!ca.length;var ha=u(ca);if("[object Map]"==ha||"[object Set]"==ha)return!ca.size;if(E(ca))return!q(ca).length;for(var Da in ca)if(T.call(ca,
Da))return!1;return!0}}),Uo=va((n,p)=>{p.exports=function(q){return void 0===q}}),Vo=va((n,p)=>{var q=vj(),u=Ff();p.exports=function(w,y){var B=-1,z=u(w)?Array(w.length):[];return q(w,function(E,H,T){z[++B]=y(E,H,T)}),z}}),Wo=va((n,p)=>{var q=wj(),u=Gf(),w=Vo(),y=Nd();p.exports=function(B,z){return(y(B)?q:w)(B,u(z,3))}}),ws=va((n,p)=>{p.exports=function(q,u,w,y){var B=-1,z=null==q?0:q.length;for(y&&z&&(w=q[++B]);++B<z;)w=u(w,q[B],B,q);return w}}),xs=va((n,p)=>{p.exports=function(q,u,w,y,B){return B(q,
function(z,E,H){w=y?(y=!1,z):u(w,z,E,H)}),w}}),Xo=va((n,p)=>{var q=ws(),u=vj(),w=Gf(),y=xs(),B=Nd();p.exports=function(z,E,H){var T=B(z)?q:y,ca=3>arguments.length;return T(z,w(E,4),H,ca,u)}}),ys=va((n,p)=>{var q=Sg(),u=Nd(),w=nf();p.exports=function(y){return"string"==typeof y||!u(y)&&w(y)&&"[object String]"==q(y)}}),zs=va((n,p)=>{n=Ro()("length");p.exports=n}),As=va((n,p)=>{var q=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");p.exports=function(u){return q.test(u)}}),
Bs=va((n,p)=>{var q=RegExp("\\ud83c[\\udffb-\\udfff](?=\\ud83c[\\udffb-\\udfff])|(?:[^\\ud800-\\udfff][\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]?|[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\ud800-\\udfff])[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?(?:\\u200d(?:[^\\ud800-\\udfff]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?)*",
"g");p.exports=function(u){for(var w=q.lastIndex=0;q.test(u);)++w;return w}}),Cs=va((n,p)=>{var q=zs(),u=As(),w=Bs();p.exports=function(y){return u(y)?w(y):q(y)}}),Ds=va((n,p)=>{var q=Bl(),u=Kh(),w=Ff(),y=ys(),B=Cs();p.exports=function(z){if(null==z)return 0;if(w(z))return y(z)?B(z):z.length;var E=u(z);return"[object Map]"==E||"[object Set]"==E?z.size:q(z).length}}),Es=va((n,p)=>{var q=yl(),u=Co(),w=Hl(),y=Gf(),B=uj(),z=Nd(),E=Jh(),H=ni(),T=Le(),ca=qi();p.exports=function(ha,Da,Fa){var ua=z(ha),Va=
ua||E(ha)||ca(ha);if(Da=y(Da,4),null==Fa){var Ha=ha&&ha.constructor;Va?Fa=ua?new Ha:[]:T(ha)?Fa=H(Ha)?u(B(ha)):{}:Fa={}}return(Va?q:w)(ha,function(sa,Na,Qa){return Da(Fa,sa,Na,Qa)}),Fa}}),Fs=va((n,p)=>{n=Ih();var q=pi(),u=Nd(),w=n?n.isConcatSpreadable:void 0;p.exports=function(y){return u(y)||q(y)||!!(w&&y&&y[w])}}),Kl=va((n,p)=>{function q(y,B,z,E,H){var T=-1,ca=y.length;z||=w;for(H||=[];++T<ca;){var ha=y[T];0<B&&z(ha)?1<B?q(ha,B-1,z,E,H):u(H,ha):E||(H[H.length]=ha)}return H}var u=Dl(),w=Fs();p.exports=
q}),Gs=va((n,p)=>{p.exports=function(q,u,w){switch(w.length){case 0:return q.call(u);case 1:return q.call(u,w[0]);case 2:return q.call(u,w[0],w[1]);case 3:return q.call(u,w[0],w[1],w[2])}return q.apply(u,w)}}),Yo=va((n,p)=>{var q=Gs(),u=Math.max;p.exports=function(w,y,B){return y=u(void 0===y?w.length-1:y,0),function(){for(var z=arguments,E=-1,H=u(z.length-y,0),T=Array(H);++E<H;)T[E]=z[y+E];E=-1;for(H=Array(y+1);++E<y;)H[E]=z[E];return H[y]=B(T),q(w,this,H)}}}),Hs=va((n,p)=>{var q=Fl(),u=po();n=Vg();
p.exports=u?function(w,y){return u(w,"toString",{configurable:!0,enumerable:!1,value:q(y),writable:!0})}:n}),Is=va((n,p)=>{var q=Date.now;p.exports=function(u){var w=0,y=0;return function(){var B=q(),z=16-(B-y);if(y=B,0<z){if(800<=++w)return arguments[0]}else w=0;return u.apply(void 0,arguments)}}}),Zo=va((n,p)=>{n=Hs();n=Is()(n);p.exports=n}),zj=va((n,p)=>{var q=Vg(),u=Yo(),w=Zo();p.exports=function(y,B){return w(u(y,B,q),y+"")}}),$o=va((n,p)=>{p.exports=function(q,u,w,y){var B=q.length;for(w+=y?
1:-1;y?w--:++w<B;)if(u(q[w],w,q))return w;return-1}}),Js=va((n,p)=>{p.exports=function(q){return q!==q}}),Ks=va((n,p)=>{p.exports=function(q,u,w){--w;for(var y=q.length;++w<y;)if(q[w]===u)return w;return-1}}),Ls=va((n,p)=>{var q=$o(),u=Js(),w=Ks();p.exports=function(y,B,z){return B===B?w(y,B,z):q(y,u,z)}}),Ms=va((n,p)=>{var q=Ls();p.exports=function(u,w){return!(null==u||!u.length)&&-1<q(u,w,0)}}),Ns=va((n,p)=>{p.exports=function(q,u,w){for(var y=-1,B=null==q?0:q.length;++y<B;)if(w(u,q[y]))return!0;
return!1}}),Os=va((n,p)=>{p.exports=function(){}}),Ps=va((n,p)=>{var q=zo();n=Os();var u=Il(),w=1/0;n=q&&1/u(new q([,-0]))[1]==w?function(y){return new q(y)}:n;p.exports=n}),Qs=va((n,p)=>{var q=Io(),u=Ms(),w=Ns(),y=Jo(),B=Ps(),z=Il();p.exports=function(E,H,T){var ca=-1,ha=u,Da=E.length,Fa=!0,ua=[],Va=ua;if(T)Fa=!1,ha=w;else if(200<=Da){if(ha=H?null:B(E))return z(ha);Fa=!1;ha=y;Va=new q}else Va=H?[]:ua;a:for(;++ca<Da;){var Ha=E[ca],sa=H?H(Ha):Ha;if(Ha=T||0!==Ha?Ha:0,Fa&&sa===sa){for(var Na=Va.length;Na--;)if(Va[Na]===
sa)continue a;H&&Va.push(sa);ua.push(Ha)}else ha(Va,sa,T)||(Va!==ua&&Va.push(sa),ua.push(Ha))}return ua}}),ap=va((n,p)=>{var q=Ff(),u=nf();p.exports=function(w){return u(w)&&q(w)}}),Rs=va((n,p)=>{var q=Kl();n=zj();var u=Qs(),w=ap();n=n(function(y){return u(q(y,1,w,!0))});p.exports=n}),Ss=va((n,p)=>{var q=wj();p.exports=function(u,w){return q(w,function(y){return u[y]})}}),bp=va((n,p)=>{var q=Ss(),u=fg();p.exports=function(w){return null==w?[]:q(w,u(w))}}),Me=va((n,p)=>{if("function"==typeof Kj)try{var q=
{clone:Yr(),constant:Fl(),each:Ho(),filter:So(),has:To(),isArray:Nd(),isEmpty:vs(),isFunction:ni(),isUndefined:Uo(),keys:fg(),map:Wo(),reduce:Xo(),size:Ds(),transform:Es(),union:Rs(),values:bp()}}catch{}q||=window._;p.exports=q}),Ll=va((n,p)=>{function q(z){this._isDirected=y.has(z,"directed")?z.directed:!0;this._isMultigraph=y.has(z,"multigraph")?z.multigraph:!1;this._isCompound=y.has(z,"compound")?z.compound:!1;this._label=void 0;this._defaultNodeLabelFn=y.constant(void 0);this._defaultEdgeLabelFn=
y.constant(void 0);this._nodes={};this._isCompound&&(this._parent={},this._children={},this._children[B]={});this._in={};this._preds={};this._out={};this._sucs={};this._edgeObjs={};this._edgeLabels={}}function u(z,E,H,T){E=""+E;H=""+H;!z&&E>H&&(z=E,E=H,H=z);return E+"\u0001"+H+"\u0001"+(y.isUndefined(T)?"\x00":T)}function w(z,E){return u(z,E.v,E.w,E.name)}var y=Me();p.exports=q;var B="\x00";q.prototype._nodeCount=0;q.prototype._edgeCount=0;q.prototype.isDirected=function(){return this._isDirected};
q.prototype.isMultigraph=function(){return this._isMultigraph};q.prototype.isCompound=function(){return this._isCompound};q.prototype.setGraph=function(z){return this._label=z,this};q.prototype.graph=function(){return this._label};q.prototype.setDefaultNodeLabel=function(z){return y.isFunction(z)||(z=y.constant(z)),this._defaultNodeLabelFn=z,this};q.prototype.nodeCount=function(){return this._nodeCount};q.prototype.nodes=function(){return y.keys(this._nodes)};q.prototype.sources=function(){var z=
this;return y.filter(this.nodes(),function(E){return y.isEmpty(z._in[E])})};q.prototype.sinks=function(){var z=this;return y.filter(this.nodes(),function(E){return y.isEmpty(z._out[E])})};q.prototype.setNodes=function(z,E){var H=arguments,T=this;return y.each(z,function(ca){1<H.length?T.setNode(ca,E):T.setNode(ca)}),this};q.prototype.setNode=function(z,E){return y.has(this._nodes,z)?(1<arguments.length&&(this._nodes[z]=E),this):(this._nodes[z]=1<arguments.length?E:this._defaultNodeLabelFn(z),this._isCompound&&
(this._parent[z]=B,this._children[z]={},this._children[B][z]=!0),this._in[z]={},this._preds[z]={},this._out[z]={},this._sucs[z]={},++this._nodeCount,this)};q.prototype.node=function(z){return this._nodes[z]};q.prototype.hasNode=function(z){return y.has(this._nodes,z)};q.prototype.removeNode=function(z){var E=this;if(y.has(this._nodes,z)){var H=function(T){E.removeEdge(E._edgeObjs[T])};delete this._nodes[z];this._isCompound&&(this._removeFromParentsChildList(z),delete this._parent[z],y.each(this.children(z),
function(T){E.setParent(T)}),delete this._children[z]);y.each(y.keys(this._in[z]),H);delete this._in[z];delete this._preds[z];y.each(y.keys(this._out[z]),H);delete this._out[z];delete this._sucs[z];--this._nodeCount}return this};q.prototype.setParent=function(z,E){if(!this._isCompound)throw Error("Cannot set parent in a non-compound graph");if(y.isUndefined(E))E=B;else{for(var H=E+="";!y.isUndefined(H);H=this.parent(H))if(H===z)throw Error("Setting "+E+" as parent of "+z+" would create a cycle");
this.setNode(E)}return this.setNode(z),this._removeFromParentsChildList(z),this._parent[z]=E,this._children[E][z]=!0,this};q.prototype._removeFromParentsChildList=function(z){delete this._children[this._parent[z]][z]};q.prototype.parent=function(z){if(this._isCompound&&(z=this._parent[z],z!==B))return z};q.prototype.children=function(z){if(y.isUndefined(z)&&(z=B),this._isCompound){if(z=this._children[z])return y.keys(z)}else{if(z===B)return this.nodes();if(this.hasNode(z))return[]}};q.prototype.predecessors=
function(z){if(z=this._preds[z])return y.keys(z)};q.prototype.successors=function(z){if(z=this._sucs[z])return y.keys(z)};q.prototype.neighbors=function(z){var E=this.predecessors(z);if(E)return y.union(E,this.successors(z))};q.prototype.isLeaf=function(z){var E;return this.isDirected()?E=this.successors(z):E=this.neighbors(z),0===E.length};q.prototype.filterNodes=function(z){function E(ha){var Da=T.parent(ha);return void 0===Da||H.hasNode(Da)?(ca[ha]=Da,Da):Da in ca?ca[Da]:E(Da)}var H=new this.constructor({directed:this._isDirected,
multigraph:this._isMultigraph,compound:this._isCompound});H.setGraph(this.graph());var T=this;y.each(this._nodes,function(ha,Da){z(Da)&&H.setNode(Da,ha)});y.each(this._edgeObjs,function(ha){H.hasNode(ha.v)&&H.hasNode(ha.w)&&H.setEdge(ha,T.edge(ha))});var ca={};return this._isCompound&&y.each(H.nodes(),function(ha){H.setParent(ha,E(ha))}),H};q.prototype.setDefaultEdgeLabel=function(z){return y.isFunction(z)||(z=y.constant(z)),this._defaultEdgeLabelFn=z,this};q.prototype.edgeCount=function(){return this._edgeCount};
q.prototype.edges=function(){return y.values(this._edgeObjs)};q.prototype.setPath=function(z,E){var H=this,T=arguments;return y.reduce(z,function(ca,ha){return 1<T.length?H.setEdge(ca,ha,E):H.setEdge(ca,ha),ha}),this};q.prototype.setEdge=function(){var z,E,H,T,ca=!1,ha=arguments[0];"object"==typeof ha&&null!==ha&&"v"in ha?(z=ha.v,E=ha.w,H=ha.name,2===arguments.length&&(T=arguments[1],ca=!0)):(z=ha,E=arguments[1],H=arguments[3],2<arguments.length&&(T=arguments[2],ca=!0));z=""+z;E=""+E;y.isUndefined(H)||
(H=""+H);ha=u(this._isDirected,z,E,H);if(y.has(this._edgeLabels,ha))return ca&&(this._edgeLabels[ha]=T),this;if(!y.isUndefined(H)&&!this._isMultigraph)throw Error("Cannot set a named edge when isMultigraph = false");this.setNode(z);this.setNode(E);this._edgeLabels[ha]=ca?T:this._defaultEdgeLabelFn(z,E,H);z=""+z;E=""+E;!this._isDirected&&z>E&&(T=z,z=E,E=T);E={v:z,w:E};H=(H&&(E.name=H),E);z=H.v;E=H.w;Object.freeze(H);this._edgeObjs[ha]=H;T=this._preds[E];ca=z;T[ca]?T[ca]++:T[ca]=1;T=this._sucs[z];ca=
E;T[ca]?T[ca]++:T[ca]=1;return this._in[E][ha]=H,this._out[z][ha]=H,this._edgeCount++,this};q.prototype.edge=function(z,E,H){var T=1===arguments.length?w(this._isDirected,arguments[0]):u(this._isDirected,z,E,H);return this._edgeLabels[T]};q.prototype.hasEdge=function(z,E,H){var T=1===arguments.length?w(this._isDirected,arguments[0]):u(this._isDirected,z,E,H);return y.has(this._edgeLabels,T)};q.prototype.removeEdge=function(z,E,H){var T=1===arguments.length?w(this._isDirected,arguments[0]):u(this._isDirected,
z,E,H),ca=this._edgeObjs[T];if(ca){z=ca.v;E=ca.w;delete this._edgeLabels[T];delete this._edgeObjs[T];ca=this._preds[E];var ha=z;--ca[ha]||delete ca[ha];ca=this._sucs[z];ha=E;--ca[ha]||delete ca[ha];delete this._in[E][T];delete this._out[z][T];this._edgeCount--}return this};q.prototype.inEdges=function(z,E){if(z=this._in[z])return z=y.values(z),E?y.filter(z,function(H){return H.v===E}):z};q.prototype.outEdges=function(z,E){if(z=this._out[z])return z=y.values(z),E?y.filter(z,function(H){return H.w===
E}):z};q.prototype.nodeEdges=function(z,E){var H=this.inEdges(z,E);if(H)return H.concat(this.outEdges(z,E))}}),Ts=va((n,p)=>{p.exports="2.1.8"}),Us=va((n,p)=>{p.exports={Graph:Ll(),version:Ts()}}),Vs=va((n,p)=>{function q(B){return w.map(B.nodes(),function(z){var E=B.node(z),H=B.parent(z);z={v:z};return w.isUndefined(E)||(z.value=E),w.isUndefined(H)||(z.parent=H),z})}function u(B){return w.map(B.edges(),function(z){var E=B.edge(z),H={v:z.v,w:z.w};return w.isUndefined(z.name)||(H.name=z.name),w.isUndefined(E)||
(H.value=E),H})}var w=Me(),y=Ll();p.exports={write:function(B){var z={options:{directed:B.isDirected(),multigraph:B.isMultigraph(),compound:B.isCompound()},nodes:q(B),edges:u(B)};return w.isUndefined(B.graph())||(z.value=w.clone(B.graph())),z},read:function(B){var z=(new y(B.options)).setGraph(B.value);return w.each(B.nodes,function(E){z.setNode(E.v,E.value);E.parent&&z.setParent(E.v,E.parent)}),w.each(B.edges,function(E){z.setEdge({v:E.v,w:E.w,name:E.name},E.value)}),z}}}),Ws=va((n,p)=>{var q=Me();
p.exports=function(u){function w(E){q.has(y,E)||(y[E]=!0,z.push(E),q.each(u.successors(E),w),q.each(u.predecessors(E),w))}var y={},B=[],z;return q.each(u.nodes(),function(E){z=[];w(E);z.length&&B.push(z)}),B}}),cp=va((n,p)=>{function q(){this._arr=[];this._keyIndices={}}var u=Me();p.exports=q;q.prototype.size=function(){return this._arr.length};q.prototype.keys=function(){return this._arr.map(function(w){return w.key})};q.prototype.has=function(w){return u.has(this._keyIndices,w)};q.prototype.priority=
function(w){w=this._keyIndices[w];if(void 0!==w)return this._arr[w].priority};q.prototype.min=function(){if(0===this.size())throw Error("Queue underflow");return this._arr[0].key};q.prototype.add=function(w,y){var B=this._keyIndices;if(w=String(w),!u.has(B,w)){var z=this._arr,E=z.length;return B[w]=E,z.push({key:w,priority:y}),this._decrease(E),!0}return!1};q.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var w=this._arr.pop();return delete this._keyIndices[w.key],this._heapify(0),
w.key};q.prototype.decrease=function(w,y){var B=this._keyIndices[w];if(y>this._arr[B].priority)throw Error("New priority is greater than current priority. Key: "+w+" Old: "+this._arr[B].priority+" New: "+y);this._arr[B].priority=y;this._decrease(B)};q.prototype._heapify=function(w){var y=this._arr,B=2*w,z=B+1,E=w;B<y.length&&(E=y[B].priority<y[E].priority?B:E,z<y.length&&(E=y[z].priority<y[E].priority?z:E),E!==w&&(this._swap(w,E),this._heapify(E)))};q.prototype._decrease=function(w){for(var y=this._arr,
B=y[w].priority,z;0!==w&&(z=w>>1,!(y[z].priority<B));)this._swap(w,z),w=z};q.prototype._swap=function(w,y){var B=this._arr,z=this._keyIndices,E=B[w],H=B[y];B[w]=H;B[y]=E;z[H.key]=w;z[E.key]=y}}),dp=va((n,p)=>{function q(y,B,z,E){var H={},T=new u,ca,ha,Da=function(Fa){var ua=Fa.v!==ca?Fa.v:Fa.w,Va=H[ua],Ha=z(Fa),sa=ha.distance+Ha;if(0>Ha)throw Error("dijkstra does not allow negative edge weights. Bad edge: "+Fa+" Weight: "+Ha);sa<Va.distance&&(Va.distance=sa,Va.predecessor=ca,T.decrease(ua,sa))};for(y.nodes().forEach(function(Fa){var ua=
Fa===B?0:Number.POSITIVE_INFINITY;H[Fa]={distance:ua};T.add(Fa,ua)});0<T.size()&&(ca=T.removeMin(),ha=H[ca],ha.distance!==Number.POSITIVE_INFINITY);)E(ca).forEach(Da);return H}n=Me();var u=cp();p.exports=function(y,B,z,E){return q(y,String(B),z||w,E||function(H){return y.outEdges(H)})};var w=n.constant(1)}),Xs=va((n,p)=>{var q=dp(),u=Me();p.exports=function(w,y,B){return u.transform(w.nodes(),function(z,E){z[E]=q(w,E,y,B)},{})}}),ep=va((n,p)=>{var q=Me();p.exports=function(u){function w(H){var T=
z[H]={onStack:!0,lowlink:y,index:y++};if(B.push(H),u.successors(H).forEach(function(Da){q.has(z,Da)?z[Da].onStack&&(T.lowlink=Math.min(T.lowlink,z[Da].index)):(w(Da),T.lowlink=Math.min(T.lowlink,z[Da].lowlink))}),T.lowlink===T.index){var ca=[];do{var ha=B.pop();z[ha].onStack=!1;ca.push(ha)}while(H!==ha);E.push(ca)}}var y=0,B=[],z={},E=[];return u.nodes().forEach(function(H){q.has(z,H)||w(H)}),E}}),Ys=va((n,p)=>{var q=Me(),u=ep();p.exports=function(w){return q.filter(u(w),function(y){return 1<y.length||
1===y.length&&w.hasEdge(y[0],y[0])})}}),Zs=va((n,p)=>{function q(w,y,B){var z={},E=w.nodes();return E.forEach(function(H){z[H]={};z[H][H]={distance:0};E.forEach(function(T){H!==T&&(z[H][T]={distance:Number.POSITIVE_INFINITY})});B(H).forEach(function(T){var ca=T.v===H?T.w:T.v;T=y(T);z[H][ca]={distance:T,predecessor:H}})}),E.forEach(function(H){var T=z[H];E.forEach(function(ca){var ha=z[ca];E.forEach(function(Da){var Fa=T[Da];Da=ha[Da];var ua=ha[H].distance+Fa.distance;ua<Da.distance&&(Da.distance=
ua,Da.predecessor=Fa.predecessor)})})}),z}n=Me();p.exports=function(w,y,B){return q(w,y||u,B||function(z){return w.outEdges(z)})};var u=n.constant(1)}),fp=va((n,p)=>{function q(y){function B(T){if(w.has(E,T))throw new u;w.has(z,T)||(E[T]=!0,z[T]=!0,w.each(y.predecessors(T),B),delete E[T],H.push(T))}var z={},E={},H=[];if(w.each(y.sinks(),B),w.size(z)!==y.nodeCount())throw new u;return H}function u(){}var w=Me();p.exports=q;q.CycleException=u;u.prototype=Error()}),$s=va((n,p)=>{var q=fp();p.exports=
function(u){try{q(u)}catch(w){if(w instanceof q.CycleException)return!1;throw w;}return!0}}),gp=va((n,p)=>{function q(w,y,B,z,E,H){u.has(z,y)||(z[y]=!0,B||H.push(y),u.each(E(y),function(T){q(w,T,B,z,E,H)}),B&&H.push(y))}var u=Me();p.exports=function(w,y,B){u.isArray(y)||(y=[y]);var z=(w.isDirected()?w.successors:w.neighbors).bind(w),E=[],H={};return u.each(y,function(T){if(!w.hasNode(T))throw Error("Graph does not have node: "+T);q(w,T,"post"===B,H,z,E)}),E}}),at=va((n,p)=>{var q=gp();p.exports=function(u,
w){return q(u,w,"post")}}),bt=va((n,p)=>{var q=gp();p.exports=function(u,w){return q(u,w,"pre")}}),ct=va((n,p)=>{var q=Me(),u=Ll(),w=cp();p.exports=function(y,B){function z(Da){var Fa=Da.v===ca?Da.w:Da.v,ua=T.priority(Fa);void 0!==ua&&(Da=B(Da),Da<ua&&(H[Fa]=ca,T.decrease(Fa,Da)))}var E=new u,H={},T=new w,ca;if(0===y.nodeCount())return E;q.each(y.nodes(),function(Da){T.add(Da,Number.POSITIVE_INFINITY);E.setNode(Da)});T.decrease(y.nodes()[0],0);for(var ha=!1;0<T.size();){if(ca=T.removeMin(),q.has(H,
ca))E.setEdge(ca,H[ca]);else{if(ha)throw Error("Input graph is not connected: "+y);ha=!0}y.nodeEdges(ca).forEach(z)}return E}}),dt=va((n,p)=>{p.exports={components:Ws(),dijkstra:dp(),dijkstraAll:Xs(),findCycles:Ys(),floydWarshall:Zs(),isAcyclic:$s(),postorder:at(),preorder:bt(),prim:ct(),tarjan:ep(),topsort:fp()}}),et=va((n,p)=>{n=Us();p.exports={Graph:n.Graph,json:Vs(),alg:dt(),version:n.version}}),Ye=va((n,p)=>{if("function"==typeof Kj)try{var q=et()}catch{}q||=window.graphlib;p.exports=q}),ft=
va((n,p)=>{var q=Eo();p.exports=function(u){return q(u,5)}}),Aj=va((n,p)=>{var q=Hh(),u=Ff(),w=rj(),y=Le();p.exports=function(B,z,E){if(!y(E))return!1;var H=typeof z;return("number"==H?u(E)&&w(z,E.length):"string"==H&&z in E)?q(E[z],B):!1}}),gt=va((n,p)=>{n=zj();var q=Hh(),u=Aj(),w=Ug(),y=Object.prototype,B=y.hasOwnProperty;n=n(function(z,E){z=Object(z);var H=-1,T=E.length,ca=2<T?E[2]:void 0;for(ca&&u(E[0],E[1],ca)&&(T=1);++H<T;){ca=E[H];for(var ha=w(ca),Da=-1,Fa=ha.length;++Da<Fa;){var ua=ha[Da],
Va=z[ua];(void 0===Va||q(Va,y[ua])&&!B.call(z,ua))&&(z[ua]=ca[ua])}}return z});p.exports=n}),ht=va((n,p)=>{var q=Gf(),u=Ff(),w=fg();p.exports=function(y){return function(B,z,E){var H=Object(B);if(!u(B)){var T=q(z,3);B=w(B);z=function(ca){return T(H[ca],ca,H)}}z=y(B,z,E);return-1<z?H[T?B[z]:z]:void 0}}}),it=va((n,p)=>{var q=/\s/;p.exports=function(u){for(var w=u.length;w--&&q.test(u.charAt(w)););return w}}),jt=va((n,p)=>{var q=it(),u=/^\s+/;p.exports=function(w){return w&&w.slice(0,q(w)+1).replace(u,
"")}}),kt=va((n,p)=>{var q=jt(),u=Le(),w=Lh(),y=/^[-+]0x[0-9a-f]+$/i,B=/^0b[01]+$/i,z=/^0o[0-7]+$/i,E=parseInt;p.exports=function(H){if("number"==typeof H)return H;if(w(H))return NaN;u(H)&&(H="function"==typeof H.valueOf?H.valueOf():H,H=u(H)?H+"":H);if("string"!=typeof H)return 0===H?H:+H;H=q(H);var T=B.test(H);return T||z.test(H)?E(H.slice(2),T?2:8):y.test(H)?NaN:+H}}),hp=va((n,p)=>{var q=kt(),u=1/0;p.exports=function(w){return w?(w=q(w),w===u||w===-u)?1.7976931348623157E308*(0>w?-1:1):w===w?w:0:
0===w?w:0}}),lt=va((n,p)=>{var q=hp();p.exports=function(u){u=q(u);var w=u%1;return u===u?w?u-w:u:0}}),mt=va((n,p)=>{var q=$o(),u=Gf(),w=lt(),y=Math.max;p.exports=function(B,z,E){var H=null==B?0:B.length;if(!H)return-1;E=null==E?0:w(E);return 0>E&&(E=y(H+E,0)),q(B,u(z,3),E)}}),nt=va((n,p)=>{n=ht();var q=mt();n=n(q);p.exports=n}),ip=va((n,p)=>{var q=Kl();p.exports=function(u){return(null==u?0:u.length)?q(u,1):[]}}),ot=va((n,p)=>{var q=Gl(),u=Fo(),w=Ug();p.exports=function(y,B){return null==y?y:q(y,
u(B),w)}}),pt=va((n,p)=>{p.exports=function(q){var u=null==q?0:q.length;return u?q[u-1]:void 0}}),qt=va((n,p)=>{var q=pj(),u=Hl(),w=Gf();p.exports=function(y,B){var z={};return B=w(B,3),u(y,function(E,H,T){q(z,H,B(E,H,T))}),z}}),Ml=va((n,p)=>{var q=Lh();p.exports=function(u,w,y){for(var B=-1,z=u.length;++B<z;){var E=u[B],H=w(E);if(null!=H&&(void 0===T?H===H&&!q(H):y(H,T)))var T=H,ca=E}return ca}}),rt=va((n,p)=>{p.exports=function(q,u){return q>u}}),st=va((n,p)=>{var q=Ml(),u=rt(),w=Vg();p.exports=
function(y){return y&&y.length?q(y,w,u):void 0}}),jp=va((n,p)=>{var q=pj(),u=Hh();p.exports=function(w,y,B){(void 0===B||u(w[y],B))&&(void 0!==B||y in w)||q(w,y,B)}}),tt=va((n,p)=>{var q=Sg(),u=uj(),w=nf(),y=Function.prototype.toString,B=Object.prototype.hasOwnProperty,z=y.call(Object);p.exports=function(E){if(!w(E)||"[object Object]"!=q(E))return!1;E=u(E);if(null===E)return!0;E=B.call(E,"constructor")&&E.constructor;return"function"==typeof E&&E instanceof E&&y.call(E)==z}}),kp=va((n,p)=>{p.exports=
function(q,u){if(("constructor"!==u||"function"!=typeof q[u])&&"__proto__"!=u)return q[u]}}),ut=va((n,p)=>{var q=oi(),u=Ug();p.exports=function(w){return q(w,u(w))}}),vt=va((n,p)=>{var q=jp(),u=so(),w=Bo(),y=to(),B=Do(),z=pi(),E=Nd(),H=ap(),T=Jh(),ca=ni(),ha=Le(),Da=tt(),Fa=qi(),ua=kp(),Va=ut();p.exports=function(Ha,sa,Na,Qa,kb,pb,ib){var zb=ua(Ha,Na),gb=ua(sa,Na),qb=ib.get(gb);if(qb)q(Ha,Na,qb);else{sa=pb?pb(zb,gb,Na+"",Ha,sa,ib):void 0;if(qb=void 0===sa){var Lb=E(gb),Xb=!Lb&&T(gb),$b=!Lb&&!Xb&&
Fa(gb);sa=gb;Lb||Xb||$b?E(zb)?sa=zb:H(zb)?sa=y(zb):Xb?(qb=!1,sa=u(gb,!0)):$b?(qb=!1,sa=w(gb,!0)):sa=[]:Da(gb)||z(gb)?(sa=zb,z(zb)?sa=Va(zb):(!ha(zb)||ca(zb))&&(sa=B(gb))):qb=!1}qb&&(ib.set(gb,sa),kb(sa,gb,Qa,pb,ib),ib.delete(gb));q(Ha,Na,sa)}}}),wt=va((n,p)=>{function q(T,ca,ha,Da,Fa){T!==ca&&y(ca,function(ua,Va){if(Fa||=new u,z(ua))B(T,ca,Va,ha,q,Da,Fa);else{var Ha=Da?Da(H(T,Va),ua,Va+"",T,ca,Fa):void 0;void 0===Ha&&(Ha=ua);w(T,Va,Ha)}},E)}var u=oj(),w=jp(),y=Gl(),B=vt(),z=Le(),E=Ug(),H=kp();p.exports=
q}),xt=va((n,p)=>{var q=zj(),u=Aj();p.exports=function(w){return q(function(y,B){var z=-1,E=B.length,H=1<E?B[E-1]:void 0,T=2<E?B[2]:void 0;H=3<w.length&&"function"==typeof H?(E--,H):void 0;T&&u(B[0],B[1],T)&&(H=3>E?void 0:H,E=1);for(y=Object(y);++z<E;)(T=B[z])&&w(y,T,z,H);return y})}}),yt=va((n,p)=>{var q=wt();n=xt()(function(u,w,y){q(u,w,y)});p.exports=n}),lp=va((n,p)=>{p.exports=function(q,u){return q<u}}),zt=va((n,p)=>{var q=Ml(),u=lp(),w=Vg();p.exports=function(y){return y&&y.length?q(y,w,u):
void 0}}),At=va((n,p)=>{var q=Ml(),u=Gf(),w=lp();p.exports=function(y,B){return y&&y.length?q(y,u(B,2),w):void 0}}),Bt=va((n,p)=>{var q=Xe();p.exports=function(){return q.Date.now()}}),Ct=va((n,p)=>{var q=qj(),u=xj(),w=rj(),y=Le(),B=ri();p.exports=function(z,E,H,T){if(!y(z))return z;E=u(E,z);for(var ca=-1,ha=E.length,Da=ha-1,Fa=z;null!=Fa&&++ca<ha;){var ua=B(E[ca]),Va=H;if("__proto__"===ua||"constructor"===ua||"prototype"===ua)break;if(ca!=Da){var Ha=Fa[ua];Va=T?T(Ha,ua,Fa):void 0;void 0===Va&&(Va=
y(Ha)?Ha:w(E[ca+1])?[]:{})}q(Fa,ua,Va);Fa=Fa[ua]}return z}}),Dt=va((n,p)=>{var q=yj(),u=Ct(),w=xj();p.exports=function(y,B,z){for(var E=-1,H=B.length,T={};++E<H;){var ca=B[E],ha=q(y,ca);z(ha,ca)&&u(T,w(ca,y),ha)}return T}}),Et=va((n,p)=>{var q=Dt(),u=Qo();p.exports=function(w,y){return q(w,y,function(B,z){return u(w,z)})}}),Ft=va((n,p)=>{var q=ip(),u=Yo(),w=Zo();p.exports=function(y){return w(u(y,void 0,q),y+"")}}),Gt=va((n,p)=>{var q=Et();n=Ft()(function(u,w){return null==u?{}:q(u,w)});p.exports=
n}),Ht=va((n,p)=>{var q=Math.ceil,u=Math.max;p.exports=function(w,y,B,z){var E=-1;y=u(q((y-w)/(B||1)),0);for(var H=Array(y);y--;)H[z?y:++E]=w,w+=B;return H}}),It=va((n,p)=>{var q=Ht(),u=Aj(),w=hp();p.exports=function(y){return function(B,z,E){return E&&"number"!=typeof E&&u(B,z,E)&&(z=E=void 0),B=w(B),void 0===z?(z=B,B=0):z=w(z),E=void 0===E?B<z?1:-1:w(E),q(B,z,E,y)}}}),Jt=va((n,p)=>{n=It()();p.exports=n}),Kt=va((n,p)=>{p.exports=function(q,u){var w=q.length;for(q.sort(u);w--;)q[w]=q[w].value;return q}}),
Lt=va((n,p)=>{var q=Lh();p.exports=function(u,w){if(u!==w){var y=void 0!==u,B=null===u,z=u===u,E=q(u),H=void 0!==w,T=null===w,ca=w===w,ha=q(w);if(!T&&!ha&&!E&&u>w||E&&H&&ca&&!T&&!ha||B&&H&&ca||!y&&ca||!z)return 1;if(!B&&!E&&!ha&&u<w||ha&&y&&z&&!B&&!E||T&&y&&z||!H&&z||!ca)return-1}return 0}}),Mt=va((n,p)=>{var q=Lt();p.exports=function(u,w,y){for(var B=-1,z=u.criteria,E=w.criteria,H=z.length,T=y.length;++B<H;){var ca=q(z[B],E[B]);if(ca)return B>=T?ca:ca*("desc"==y[B]?-1:1)}return u.index-w.index}}),
Nt=va((n,p)=>{var q=wj(),u=yj(),w=Gf(),y=Vo(),B=Kt(),z=sj(),E=Mt(),H=Vg(),T=Nd();p.exports=function(ca,ha,Da){ha.length?ha=q(ha,function(ua){return T(ua)?function(Va){return u(Va,1===ua.length?ua[0]:ua)}:ua}):ha=[H];var Fa=-1;ha=q(ha,z(w));ca=y(ca,function(ua,Va,Ha){return{criteria:q(ha,function(sa){return sa(ua)}),index:++Fa,value:ua}});return B(ca,function(ua,Va){return E(ua,Va,Da)})}}),Ot=va((n,p)=>{var q=Kl(),u=Nt();n=zj();var w=Aj();n=n(function(y,B){if(null==y)return[];var z=B.length;return 1<
z&&w(y,B[0],B[1])?B=[]:2<z&&w(B[0],B[1],B[2])&&(B=[B[0]]),u(y,q(B,1),[])});p.exports=n}),Pt=va((n,p)=>{var q=Oo(),u=0;p.exports=function(w){var y=++u;return q(w)+y}}),Qt=va((n,p)=>{p.exports=function(q,u,w){for(var y=-1,B=q.length,z=u.length,E={};++y<B;)w(E,q[y],y<z?u[y]:void 0);return E}}),Rt=va((n,p)=>{var q=qj(),u=Qt();p.exports=function(w,y){return u(w||[],y||[],q)}}),Gd=va((n,p)=>{if("function"==typeof Kj)try{var q={cloneDeep:ft(),constant:Fl(),defaults:gt(),each:Ho(),filter:So(),find:nt(),flatten:ip(),
forEach:Go(),forIn:ot(),has:To(),isUndefined:Uo(),last:pt(),map:Wo(),mapValues:qt(),max:st(),merge:yt(),min:zt(),minBy:At(),now:Bt(),pick:Gt(),range:Jt(),reduce:Xo(),sortBy:Ot(),uniqueId:Pt(),values:bp(),zipObject:Rt()}}catch{}q||=window._;p.exports=q}),St=va((n,p)=>{function q(){var y={};this._sentinel=y._next=y._prev=y}function u(y){y._prev._next=y._next;y._next._prev=y._prev;delete y._next;delete y._prev}function w(y,B){if("_next"!==y&&"_prev"!==y)return B}p.exports=q;q.prototype.dequeue=function(){var y=
this._sentinel,B=y._prev;if(B!==y)return u(B),B};q.prototype.enqueue=function(y){var B=this._sentinel;y._prev&&y._next&&u(y);y._next=B._next;B._next._prev=y;B._next=y;y._prev=B};q.prototype.toString=function(){for(var y=[],B=this._sentinel,z=B._prev;z!==B;)y.push(JSON.stringify(z,w)),z=z._prev;return"["+y.join(", ")+"]"}}),Tt=va((n,p)=>{function q(T,ca,ha){for(var Da=[],Fa=ca[ca.length-1],ua=ca[0],Va;T.nodeCount();){for(;Va=ua.dequeue();)u(T,ca,ha,Va);for(;Va=Fa.dequeue();)u(T,ca,ha,Va);if(T.nodeCount())for(var Ha=
ca.length-2;0<Ha;--Ha)if(Va=ca[Ha].dequeue(),Va){Da=Da.concat(u(T,ca,ha,Va,!0));break}}return Da}function u(T,ca,ha,Da,Fa){var ua=Fa?[]:void 0;return B.forEach(T.inEdges(Da.v),function(Va){var Ha=T.edge(Va),sa=T.node(Va.v);Fa&&ua.push({v:Va.v,w:Va.w});sa.out-=Ha;y(ca,ha,sa)}),B.forEach(T.outEdges(Da.v),function(Va){var Ha=T.edge(Va);Va=T.node(Va.w);Va.in-=Ha;y(ca,ha,Va)}),T.removeNode(Da.v),ua}function w(T,ca){var ha=new z,Da=0,Fa=0;B.forEach(T.nodes(),function(Ha){ha.setNode(Ha,{v:Ha,in:0,out:0})});
B.forEach(T.edges(),function(Ha){var sa=ha.edge(Ha.v,Ha.w)||0,Na=ca(Ha);ha.setEdge(Ha.v,Ha.w,sa+Na);Fa=Math.max(Fa,ha.node(Ha.v).out+=Na);Da=Math.max(Da,ha.node(Ha.w).in+=Na)});var ua=B.range(Fa+Da+3).map(function(){return new E}),Va=Da+1;return B.forEach(ha.nodes(),function(Ha){y(ua,Va,ha.node(Ha))}),{graph:ha,buckets:ua,zeroIdx:Va}}function y(T,ca,ha){ha.out?ha.in?T[ha.out-ha.in+ca].enqueue(ha):T[T.length-1].enqueue(ha):T[0].enqueue(ha)}var B=Gd(),z=Ye().Graph,E=St();p.exports=function(T,ca){if(1>=
T.nodeCount())return[];ca=w(T,ca||H);ca=q(ca.graph,ca.buckets,ca.zeroIdx);return B.flatten(B.map(ca,function(ha){return T.outEdges(ha.v,ha.w)}),!0)};var H=B.constant(1)}),Ut=va((n,p)=>{function q(y){function B(T){u.has(H,T)||(H[T]=!0,E[T]=!0,u.forEach(y.outEdges(T),function(ca){u.has(E,ca.w)?z.push(ca):B(ca.w)}),delete E[T])}var z=[],E={},H={};return u.forEach(y.nodes(),B),z}var u=Gd(),w=Tt();p.exports={run:function(y){function B(E){return function(H){return E.edge(H).weight}}var z="greedy"===y.graph().acyclicer?
w(y,B(y)):q(y);u.forEach(z,function(E){var H=y.edge(E);y.removeEdge(E);H.forwardName=E.name;H.reversed=!0;y.setEdge(E.w,E.v,H,u.uniqueId("rev"))})},undo:function(y){u.forEach(y.edges(),function(B){var z=y.edge(B);if(z.reversed){y.removeEdge(B);var E=z.forwardName;delete z.reversed;delete z.forwardName;y.setEdge(B.w,B.v,z,E)}})}}}),ve=va((n,p)=>{function q(B,z,E,H){do var T=w.uniqueId(H);while(B.hasNode(T));return E.dummy=z,B.setNode(T,E),T}function u(B){return w.max(w.map(B.nodes(),function(z){z=
B.node(z).rank;if(!w.isUndefined(z))return z}))}var w=Gd(),y=Ye().Graph;p.exports={addDummyNode:q,simplify:function(B){var z=(new y).setGraph(B.graph());return w.forEach(B.nodes(),function(E){z.setNode(E,B.node(E))}),w.forEach(B.edges(),function(E){var H=z.edge(E.v,E.w)||{weight:0,minlen:1},T=B.edge(E);z.setEdge(E.v,E.w,{weight:H.weight+T.weight,minlen:Math.max(H.minlen,T.minlen)})}),z},asNonCompoundGraph:function(B){var z=(new y({multigraph:B.isMultigraph()})).setGraph(B.graph());return w.forEach(B.nodes(),
function(E){B.children(E).length||z.setNode(E,B.node(E))}),w.forEach(B.edges(),function(E){z.setEdge(E,B.edge(E))}),z},successorWeights:function(B){var z=w.map(B.nodes(),function(E){var H={};return w.forEach(B.outEdges(E),function(T){H[T.w]=(H[T.w]||0)+B.edge(T).weight}),H});return w.zipObject(B.nodes(),z)},predecessorWeights:function(B){var z=w.map(B.nodes(),function(E){var H={};return w.forEach(B.inEdges(E),function(T){H[T.v]=(H[T.v]||0)+B.edge(T).weight}),H});return w.zipObject(B.nodes(),z)},intersectRect:function(B,
z){var E=B.x,H=B.y,T=z.x-E;z=z.y-H;var ca=B.width/2;B=B.height/2;if(!T&&!z)throw Error("Not possible to find intersection inside of the rectangle");var ha,Da;return Math.abs(z)*ca>Math.abs(T)*B?(0>z&&(B=-B),ha=B*T/z,Da=B):(0>T&&(ca=-ca),ha=ca,Da=ca*z/T),{x:E+ha,y:H+Da}},buildLayerMatrix:function(B){var z=w.map(w.range(u(B)+1),function(){return[]});return w.forEach(B.nodes(),function(E){var H=B.node(E),T=H.rank;w.isUndefined(T)||(z[T][H.order]=E)}),z},normalizeRanks:function(B){var z=w.min(w.map(B.nodes(),
function(E){return B.node(E).rank}));w.forEach(B.nodes(),function(E){E=B.node(E);w.has(E,"rank")&&(E.rank-=z)})},removeEmptyRanks:function(B){var z=w.min(w.map(B.nodes(),function(ca){return B.node(ca).rank})),E=[];w.forEach(B.nodes(),function(ca){var ha=B.node(ca).rank-z;E[ha]||(E[ha]=[]);E[ha].push(ca)});var H=0,T=B.graph().nodeRankFactor;w.forEach(E,function(ca,ha){w.isUndefined(ca)&&0!==ha%T?--H:H&&w.forEach(ca,function(Da){B.node(Da).rank+=H})})},addBorderNode:function(B,z,E,H){var T={width:0,
height:0};return 4<=arguments.length&&(T.rank=E,T.order=H),q(B,"border",T,z)},maxRank:u,partition:function(B,z){var E={lhs:[],rhs:[]};return w.forEach(B,function(H){z(H)?E.lhs.push(H):E.rhs.push(H)}),E},time:function(B,z){var E=w.now();try{return z()}finally{console.log(B+" time: "+(w.now()-E)+"ms")}},notime:function(B,z){return z()}}}),Vt=va((n,p)=>{var q=Gd(),u=ve();p.exports={run:function(w){w.graph().dummyChains=[];q.forEach(w.edges(),function(y){var B=y.v,z=w.node(B).rank,E=y.w,H=w.node(E).rank,
T=y.name,ca=w.edge(y),ha=ca.labelRank;if(H!==z+1){w.removeEdge(y);var Da=0;for(++z;z<H;++Da,++z){ca.points=[];var Fa={width:0,height:0,edgeLabel:ca,edgeObj:y,rank:z};var ua=u.addDummyNode(w,"edge",Fa,"_d");z===ha&&(Fa.width=ca.width,Fa.height=ca.height,Fa.dummy="edge-label",Fa.labelpos=ca.labelpos);w.setEdge(B,ua,{weight:ca.weight},T);0===Da&&w.graph().dummyChains.push(ua);B=ua}w.setEdge(B,E,{weight:ca.weight},T)}})},undo:function(w){q.forEach(w.graph().dummyChains,function(y){var B=w.node(y),z=B.edgeLabel;
for(w.setEdge(B.edgeObj,z);B.dummy;){var E=w.successors(y)[0];w.removeNode(y);z.points.push({x:B.x,y:B.y});"edge-label"===B.dummy&&(z.x=B.x,z.y=B.y,z.width=B.width,z.height=B.height);y=E;B=w.node(y)}})}}}),Bj=va((n,p)=>{var q=Gd();p.exports={longestPath:function(u){function w(B){var z=u.node(B);if(q.has(y,B))return z.rank;y[B]=!0;B=q.min(q.map(u.outEdges(B),function(E){return w(E.w)-u.edge(E).minlen}));return(B===Number.POSITIVE_INFINITY||void 0===B||null===B)&&(B=0),z.rank=B}var y={};q.forEach(u.sources(),
w)},slack:function(u,w){return u.node(w.w).rank-u.node(w.v).rank-u.edge(w).minlen}}}),mp=va((n,p)=>{function q(E,H){function T(ca){y.forEach(H.nodeEdges(ca),function(ha){var Da=ha.v;Da=ca===Da?ha.w:Da;E.hasNode(Da)||z(H,ha)||(E.setNode(Da,{}),E.setEdge(ca,Da,{}),T(Da))})}return y.forEach(E.nodes(),T),E.nodeCount()}function u(E,H){return y.minBy(H.edges(),function(T){if(E.hasNode(T.v)!==E.hasNode(T.w))return z(H,T)})}function w(E,H,T){y.forEach(E.nodes(),function(ca){H.node(ca).rank+=T})}var y=Gd(),
B=Ye().Graph,z=Bj().slack;p.exports=function(E){var H=new B({directed:!1}),T=E.nodes()[0],ca=E.nodeCount();for(H.setNode(T,{});q(H,E)<ca;)T=u(H,E),T=H.hasNode(T.v)?z(E,T):-z(E,T),w(H,E,T);return H}}),Wt=va((n,p)=>{function q(sa){sa=Ha(sa);Fa(sa);var Na=ha(sa);y(Na);u(Na,sa);for(var Qa,kb;Qa=z(Na);)kb=E(Na,sa,Qa),H(Na,sa,Qa,kb)}function u(sa,Na){var Qa=Va(sa,sa.nodes());Qa=Qa.slice(0,Qa.length-1);ca.forEach(Qa,function(kb){var pb=sa.node(kb).parent;sa.edge(kb,pb).cutvalue=w(sa,Na,kb)})}function w(sa,
Na,Qa){var kb=sa.node(Qa).parent,pb=!0,ib=Na.edge(Qa,kb),zb=0;return ib||(pb=!1,ib=Na.edge(kb,Qa)),zb=ib.weight,ca.forEach(Na.nodeEdges(Qa),function(gb){var qb=gb.v===Qa,Lb=qb?gb.w:gb.v;Lb!==kb&&(qb=qb===pb,gb=Na.edge(gb).weight,zb+=qb?gb:-gb,sa.hasEdge(Qa,Lb))&&(Lb=sa.edge(Qa,Lb).cutvalue,zb+=qb?-Lb:Lb)}),zb}function y(sa,Na){2>arguments.length&&(Na=sa.nodes()[0]);B(sa,{},1,Na)}function B(sa,Na,Qa,kb,pb){var ib=Qa,zb=sa.node(kb);return Na[kb]=!0,ca.forEach(sa.neighbors(kb),function(gb){ca.has(Na,
gb)||(Qa=B(sa,Na,Qa,gb,kb))}),zb.low=ib,zb.lim=Qa++,pb?zb.parent=pb:delete zb.parent,Qa}function z(sa){return ca.find(sa.edges(),function(Na){return 0>sa.edge(Na).cutvalue})}function E(sa,Na,Qa){var kb=Qa.v,pb=Qa.w;Na.hasEdge(kb,pb)||(kb=Qa.w,pb=Qa.v);Qa=sa.node(kb);pb=sa.node(pb);var ib=Qa,zb=!1;Qa.lim>pb.lim&&(ib=pb,zb=!0);pb=ca.filter(Na.edges(),function(gb){var qb=zb,Lb=sa.node(gb.v);if(qb=qb===(ib.low<=Lb.lim&&Lb.lim<=ib.lim))qb=zb,gb=sa.node(gb.w),qb=qb!==(ib.low<=gb.lim&&gb.lim<=ib.lim);return qb});
return ca.minBy(pb,function(gb){return Da(Na,gb)})}function H(sa,Na,Qa,kb){sa.removeEdge(Qa.v,Qa.w);sa.setEdge(kb.v,kb.w,{});y(sa);u(sa,Na);T(sa,Na)}function T(sa,Na){var Qa=ca.find(sa.nodes(),function(kb){return!Na.node(kb).parent});Qa=ua(sa,Qa);Qa=Qa.slice(1);ca.forEach(Qa,function(kb){var pb=sa.node(kb).parent,ib=Na.edge(kb,pb),zb=!1;ib||(ib=Na.edge(pb,kb),zb=!0);Na.node(kb).rank=Na.node(pb).rank+(zb?ib.minlen:-ib.minlen)})}var ca=Gd(),ha=mp(),Da=Bj().slack,Fa=Bj().longestPath,ua=Ye().alg.preorder,
Va=Ye().alg.postorder,Ha=ve().simplify;p.exports=q;q.initLowLimValues=y;q.initCutValues=u;q.calcCutValue=w;q.leaveEdge=z;q.enterEdge=E;q.exchangeEdges=H}),Xt=va((n,p)=>{var q=Bj().longestPath,u=mp(),w=Wt();p.exports=function(B){switch(B.graph().ranker){case "network-simplex":w(B);break;case "tight-tree":q(B);u(B);break;case "longest-path":y(B);break;default:w(B)}};var y=q}),Yt=va((n,p)=>{function q(w){function y(E){var H=z;u.forEach(w.children(E),y);B[E]={low:H,lim:z++}}var B={},z=0;return u.forEach(w.children(),
y),B}var u=Gd();p.exports=function(w){var y=q(w);u.forEach(w.graph().dummyChains,function(B){var z=w.node(B),E=z.edgeObj,H=E.v;var T=E.w;z=[];var ca=[],ha=Math.min(y[H].low,y[T].low),Da=Math.max(y[H].lim,y[T].lim);do H=w.parent(H),z.push(H);while(H&&(y[H].low>ha||Da>y[H].lim));ha=H;for(H=T;(H=w.parent(H))!==ha;)ca.push(H);T=z.concat(ca.reverse());ca=0;Da=T[ca];for(H=!0;B!==E.w;){if(z=w.node(B),H){for(;(Da=T[ca])!==ha&&w.node(Da).maxRank<z.rank;)ca++;Da===ha&&(H=!1)}if(!H){for(;ca<T.length-1&&w.node(T[ca+
1]).minRank<=z.rank;)ca++;Da=T[ca]}w.setParent(B,Da);B=w.successors(B)[0]}})}}),Zt=va((n,p)=>{function q(z,E,H,T,ca,ha,Da){var Fa=z.children(Da);if(Fa.length){var ua=B.addBorderNode(z,"_bt"),Va=B.addBorderNode(z,"_bb"),Ha=z.node(Da);z.setParent(ua,Da);Ha.borderTop=ua;z.setParent(Va,Da);Ha.borderBottom=Va;y.forEach(Fa,function(sa){q(z,E,H,T,ca,ha,sa);var Na=z.node(sa),Qa=Na.borderTop?Na.borderTop:sa;sa=Na.borderBottom?Na.borderBottom:sa;Na=Na.borderTop?T:2*T;var kb=Qa!==sa?1:ca-ha[Da]+1;z.setEdge(ua,
Qa,{weight:Na,minlen:kb,nestingEdge:!0});z.setEdge(sa,Va,{weight:Na,minlen:kb,nestingEdge:!0})});z.parent(Da)||z.setEdge(E,ua,{weight:0,minlen:ca+ha[Da]})}else Da!==E&&z.setEdge(E,Da,{weight:0,minlen:H})}function u(z){function E(T,ca){var ha=z.children(T);ha&&ha.length&&y.forEach(ha,function(Da){E(Da,ca+1)});H[T]=ca}var H={};return y.forEach(z.children(),function(T){E(T,1)}),H}function w(z){return y.reduce(z.edges(),function(E,H){return E+z.edge(H).weight},0)}var y=Gd(),B=ve();p.exports={run:function(z){var E=
B.addDummyNode(z,"root",{},"_root"),H=u(z),T=y.max(y.values(H))-1,ca=2*T+1;z.graph().nestingRoot=E;y.forEach(z.edges(),function(Da){z.edge(Da).minlen*=ca});var ha=w(z)+1;y.forEach(z.children(),function(Da){q(z,E,ca,ha,T,H,Da)});z.graph().nodeRankFactor=ca},cleanup:function(z){var E=z.graph();z.removeNode(E.nestingRoot);delete E.nestingRoot;y.forEach(z.edges(),function(H){z.edge(H).nestingEdge&&z.removeEdge(H)})}}}),$t=va((n,p)=>{function q(y,B,z,E,H,T){var ca=H[B][T-1];z=w.addDummyNode(y,"border",
{width:0,height:0,rank:T,borderType:B},z);H[B][T]=z;y.setParent(z,E);ca&&y.setEdge(ca,z,{weight:1})}var u=Gd(),w=ve();p.exports=function(y){function B(z){var E=y.children(z),H=y.node(z);if(E.length&&u.forEach(E,B),u.has(H,"minRank")){H.borderLeft=[];H.borderRight=[];E=H.minRank;for(var T=H.maxRank+1;E<T;++E)q(y,"borderLeft","_bl",z,H,E),q(y,"borderRight","_br",z,H,E)}}u.forEach(y.children(),B)}}),au=va((n,p)=>{function q(H){E.forEach(H.nodes(),function(T){u(H.node(T))});E.forEach(H.edges(),function(T){u(H.edge(T))})}
function u(H){var T=H.width;H.width=H.height;H.height=T}function w(H){E.forEach(H.nodes(),function(T){y(H.node(T))});E.forEach(H.edges(),function(T){T=H.edge(T);E.forEach(T.points,y);E.has(T,"y")&&y(T)})}function y(H){H.y=-H.y}function B(H){E.forEach(H.nodes(),function(T){z(H.node(T))});E.forEach(H.edges(),function(T){T=H.edge(T);E.forEach(T.points,z);E.has(T,"x")&&z(T)})}function z(H){var T=H.x;H.x=H.y;H.y=T}var E=Gd();p.exports={adjust:function(H){var T=H.graph().rankdir.toLowerCase();"lr"!==T&&
"rl"!==T||q(H)},undo:function(H){var T=H.graph().rankdir.toLowerCase();"bt"!==T&&"rl"!==T||w(H);"lr"!==T&&"rl"!==T||(B(H),q(H))}}}),bu=va((n,p)=>{var q=Gd();p.exports=function(u){function w(H){if(!q.has(y,H)){y[H]=!0;var T=u.node(H);E[T.rank].push(H);q.forEach(u.successors(H),w)}}var y={},B=q.filter(u.nodes(),function(H){return!u.children(H).length}),z=q.max(q.map(B,function(H){return u.node(H).rank})),E=q.map(q.range(z+1),function(){return[]});B=q.sortBy(B,function(H){return u.node(H).rank});return q.forEach(B,
w),E}}),cu=va((n,p)=>{function q(w,y,B){var z=u.zipObject(B,u.map(B,function(ca,ha){return ha}));y=u.flatten(u.map(y,function(ca){return u.sortBy(u.map(w.outEdges(ca),function(ha){return{pos:z[ha.w],weight:w.edge(ha).weight}}),"pos")}),!0);for(var E=1;E<B.length;)E<<=1;B=2*E-1;--E;var H=u.map(Array(B),function(){return 0}),T=0;return u.forEach(y.forEach(function(ca){var ha=ca.pos+E;H[ha]+=ca.weight;for(var Da=0;0<ha;)ha%2&&(Da+=H[ha+1]),ha=ha-1>>1,H[ha]+=ca.weight;T+=ca.weight*Da})),T}var u=Gd();
p.exports=function(w,y){for(var B=0,z=1;z<y.length;++z)B+=q(w,y[z-1],y[z]);return B}}),du=va((n,p)=>{var q=Gd();p.exports=function(u,w){return q.map(w,function(y){var B=u.inEdges(y);return B.length?(B=q.reduce(B,function(z,E){var H=u.edge(E);E=u.node(E.v);return{sum:z.sum+H.weight*E.order,weight:z.weight+H.weight}},{sum:0,weight:0}),{v:y,barycenter:B.sum/B.weight,weight:B.weight}):{v:y}})}}),eu=va((n,p)=>{function q(w){function y(H){return function(T){if(!T.merged&&(u.isUndefined(T.barycenter)||u.isUndefined(H.barycenter)||
T.barycenter>=H.barycenter)){var ca=0,ha=0;H.weight&&(ca+=H.barycenter*H.weight,ha+=H.weight);T.weight&&(ca+=T.barycenter*T.weight,ha+=T.weight);H.vs=T.vs.concat(H.vs);H.barycenter=ca/ha;H.weight=ha;H.i=Math.min(T.i,H.i);T.merged=!0}}}function B(H){return function(T){T.in.push(H);0===--T.indegree&&w.push(T)}}for(var z=[];w.length;){var E=w.pop();z.push(E);u.forEach(E.in.reverse(),y(E));u.forEach(E.out,B(E))}return u.map(u.filter(z,function(H){return!H.merged}),function(H){return u.pick(H,["vs","i",
"barycenter","weight"])})}var u=Gd();p.exports=function(w,y){var B={};u.forEach(w,function(z,E){E=B[z.v]={indegree:0,in:[],out:[],vs:[z.v],i:E};u.isUndefined(z.barycenter)||(E.barycenter=z.barycenter,E.weight=z.weight)});u.forEach(y.edges(),function(z){var E=B[z.v],H=B[z.w];u.isUndefined(E)||u.isUndefined(H)||(H.indegree++,E.out.push(B[z.w]))});w=u.filter(B,function(z){return!z.indegree});return q(w)}}),fu=va((n,p)=>{function q(B,z,E){for(var H;z.length&&(H=w.last(z)).i<=E;)z.pop(),B.push(H.vs),E++;
return E}function u(B){return function(z,E){return z.barycenter<E.barycenter?-1:z.barycenter>E.barycenter?1:B?E.i-z.i:z.i-E.i}}var w=Gd(),y=ve();p.exports=function(B,z){B=y.partition(B,function(Fa){return w.has(Fa,"barycenter")});var E=B.lhs,H=w.sortBy(B.rhs,function(Fa){return-Fa.i}),T=[],ca=0,ha=0,Da=0;E.sort(u(!!z));Da=q(T,H,Da);w.forEach(E,function(Fa){Da+=Fa.vs.length;T.push(Fa.vs);ca+=Fa.barycenter*Fa.weight;ha+=Fa.weight;Da=q(T,H,Da)});z={vs:w.flatten(T,!0)};return ha&&(z.barycenter=ca/ha,
z.weight=ha),z}}),gu=va((n,p)=>{function q(E,H,T,ca){var ha=E.children(H),Da=(H=E.node(H))?H.borderLeft:void 0,Fa=H?H.borderRight:void 0,ua={};Da&&(ha=w.filter(ha,function(Ha){return Ha!==Da&&Ha!==Fa}));ha=y(E,ha);w.forEach(ha,function(Ha){if(E.children(Ha.v).length){var sa=q(E,Ha.v,T,ca);ua[Ha.v]=sa;w.has(sa,"barycenter")&&(w.isUndefined(Ha.barycenter)?(Ha.barycenter=sa.barycenter,Ha.weight=sa.weight):(Ha.barycenter=(Ha.barycenter*Ha.weight+sa.barycenter*sa.weight)/(Ha.weight+sa.weight),Ha.weight+=
sa.weight))}});ha=B(ha,T);u(ha,ua);ha=z(ha,ca);if(Da&&(ha.vs=w.flatten([Da,ha.vs,Fa],!0),E.predecessors(Da).length)){H=E.node(E.predecessors(Da)[0]);var Va=E.node(E.predecessors(Fa)[0]);w.has(ha,"barycenter")||(ha.barycenter=0,ha.weight=0);ha.barycenter=(ha.barycenter*ha.weight+H.order+Va.order)/(ha.weight+2);ha.weight+=2}return ha}function u(E,H){w.forEach(E,function(T){T.vs=w.flatten(T.vs.map(function(ca){return H[ca]?H[ca].vs:ca}),!0)})}var w=Gd(),y=du(),B=eu(),z=fu();p.exports=q}),hu=va((n,p)=>
{function q(y){for(var B;y.hasNode(B=u.uniqueId("_root")););return B}var u=Gd(),w=Ye().Graph;p.exports=function(y,B,z){var E=q(y),H=(new w({compound:!0})).setGraph({root:E}).setDefaultNodeLabel(function(T){return y.node(T)});return u.forEach(y.nodes(),function(T){var ca=y.node(T),ha=y.parent(T);(ca.rank===B||ca.minRank<=B&&B<=ca.maxRank)&&(H.setNode(T),H.setParent(T,ha||E),u.forEach(y[z](T),function(Da){var Fa=Da.v===T?Da.w:Da.v,ua=H.edge(Fa,T);ua=u.isUndefined(ua)?0:ua.weight;H.setEdge(Fa,T,{weight:y.edge(Da).weight+
ua})}),u.has(ca,"minRank")&&H.setNode(T,{borderLeft:ca.borderLeft[B],borderRight:ca.borderRight[B]}))}),H}}),iu=va((n,p)=>{var q=Gd();p.exports=function(u,w,y){var B={},z;q.forEach(y,function(E){E=u.parent(E);for(var H,T;E;){if(H=u.parent(E),H?(T=B[H],B[H]=E):(T=z,z=E),T&&T!==E){w.setEdge(T,E);break}E=H}})}}),ju=va((n,p)=>{function q(Da,Fa,ua){return y.map(Fa,function(Va){return H(Da,Va,ua)})}function u(Da,Fa){var ua=new ca;y.forEach(Da,function(Va){var Ha=Va.graph().root;Ha=E(Va,Ha,ua,Fa);y.forEach(Ha.vs,
function(sa,Na){Va.node(sa).order=Na});T(Va,ua,Ha.vs)})}function w(Da,Fa){y.forEach(Fa,function(ua){y.forEach(ua,function(Va,Ha){Da.node(Va).order=Ha})})}var y=Gd(),B=bu(),z=cu(),E=gu(),H=hu(),T=iu(),ca=Ye().Graph,ha=ve();p.exports=function(Da){var Fa=ha.maxRank(Da),ua=q(Da,y.range(1,Fa+1),"inEdges");Fa=q(Da,y.range(Fa-1,-1,-1),"outEdges");var Va=B(Da);w(Da,Va);for(var Ha=Number.POSITIVE_INFINITY,sa,Na=0,Qa=0;4>Qa;++Na,++Qa){u(Na%2?ua:Fa,2<=Na%4);Va=ha.buildLayerMatrix(Da);var kb=z(Da,Va);kb<Ha&&
(Qa=0,sa=y.cloneDeep(Va),Ha=kb)}w(Da,sa)}}),ku=va((n,p)=>{function q(Ha,sa){var Na={};return Fa.reduce(sa,function(Qa,kb){var pb=0,ib=0,zb=Qa.length,gb=Fa.last(kb);return Fa.forEach(kb,function(qb,Lb){var Xb=w(Ha,qb),$b=Xb?Ha.node(Xb).order:zb;(Xb||qb===gb)&&(Fa.forEach(kb.slice(ib,Lb+1),function(pc){Fa.forEach(Ha.predecessors(pc),function(yb){var Bb=Ha.node(yb),Db=Bb.order;!(Db<pb||$b<Db)||Bb.dummy&&Ha.node(pc).dummy||y(Na,yb,pc)})}),ib=Lb+1,pb=$b)}),kb}),Na}function u(Ha,sa){function Na(kb,pb,ib,
zb,gb){var qb;Fa.forEach(Fa.range(pb,ib),function(Lb){qb=kb[Lb];Ha.node(qb).dummy&&Fa.forEach(Ha.predecessors(qb),function(Xb){var $b=Ha.node(Xb);$b.dummy&&($b.order<zb||$b.order>gb)&&y(Qa,Xb,qb)})})}var Qa={};return Fa.reduce(sa,function(kb,pb){var ib=-1,zb,gb=0;return Fa.forEach(pb,function(qb,Lb){"border"===Ha.node(qb).dummy&&(qb=Ha.predecessors(qb),qb.length&&(zb=Ha.node(qb[0]).order,Na(pb,gb,Lb,ib,zb),gb=Lb,ib=zb));Na(pb,gb,pb.length,zb,kb.length)}),pb}),Qa}function w(Ha,sa){if(Ha.node(sa).dummy)return Fa.find(Ha.predecessors(sa),
function(Na){return Ha.node(Na).dummy})}function y(Ha,sa,Na){if(sa>Na){var Qa=sa;sa=Na;Na=Qa}(Qa=Ha[sa])||(Ha[sa]=Qa={});Qa[Na]=!0}function B(Ha,sa,Na){if(sa>Na){var Qa=sa;sa=Na;Na=Qa}return Fa.has(Ha[sa],Na)}function z(Ha,sa,Na,Qa){var kb={},pb={},ib={};return Fa.forEach(sa,function(zb){Fa.forEach(zb,function(gb,qb){kb[gb]=gb;pb[gb]=gb;ib[gb]=qb})}),Fa.forEach(sa,function(zb){var gb=-1;Fa.forEach(zb,function(qb){var Lb=Qa(qb);if(Lb.length){Lb=Fa.sortBy(Lb,function(yb){return ib[yb]});var Xb=(Lb.length-
1)/2,$b=Math.floor(Xb);for(Xb=Math.ceil(Xb);$b<=Xb;++$b){var pc=Lb[$b];pb[qb]===qb&&gb<ib[pc]&&!B(Na,qb,pc)&&(pb[pc]=qb,pb[qb]=kb[qb]=kb[pc],gb=ib[pc])}}})}),{root:kb,align:pb}}function E(Ha,sa,Na,Qa,kb){function pb(qb,Lb){for(var Xb=zb.nodes(),$b=Xb.pop(),pc={};$b;)pc[$b]?qb($b):(pc[$b]=!0,Xb.push($b),Xb=Xb.concat(Lb($b))),$b=Xb.pop()}var ib={},zb=H(Ha,sa,Na,kb),gb=kb?"borderLeft":"borderRight";return pb(function(qb){ib[qb]=zb.inEdges(qb).reduce(function(Lb,Xb){return Math.max(Lb,ib[Xb.v]+zb.edge(Xb))},
0)},zb.predecessors.bind(zb)),pb(function(qb){var Lb=zb.outEdges(qb).reduce(function($b,pc){return Math.min($b,ib[pc.w]-zb.edge(pc))},Number.POSITIVE_INFINITY),Xb=Ha.node(qb);Lb!==Number.POSITIVE_INFINITY&&Xb.borderType!==gb&&(ib[qb]=Math.max(ib[qb],Lb))},zb.successors.bind(zb)),Fa.forEach(Qa,function(qb){ib[qb]=ib[Na[qb]]}),ib}function H(Ha,sa,Na,Qa){var kb=new ua,pb=Ha.graph(),ib=Da(pb.nodesep,pb.edgesep,Qa);return Fa.forEach(sa,function(zb){var gb;Fa.forEach(zb,function(qb){var Lb=Na[qb];if(kb.setNode(Lb),
gb){var Xb=Na[gb],$b=kb.edge(Xb,Lb);kb.setEdge(Xb,Lb,Math.max(ib(Ha,qb,gb),$b||0))}gb=qb})}),kb}function T(Ha,sa){return Fa.minBy(Fa.values(sa),function(Na){var Qa=Number.NEGATIVE_INFINITY,kb=Number.POSITIVE_INFINITY;return Fa.forIn(Na,function(pb,ib){ib=Ha.node(ib).width/2;Qa=Math.max(pb+ib,Qa);kb=Math.min(pb-ib,kb)}),Qa-kb})}function ca(Ha,sa){var Na=Fa.values(sa),Qa=Fa.min(Na),kb=Fa.max(Na);Fa.forEach(["u","d"],function(pb){Fa.forEach(["l","r"],function(ib){var zb=pb+ib,gb=Ha[zb],qb;if(gb!==sa){var Lb=
Fa.values(gb);(qb="l"===ib?Qa-Fa.min(Lb):kb-Fa.max(Lb))&&(Ha[zb]=Fa.mapValues(gb,function(Xb){return Xb+qb}))}})})}function ha(Ha,sa){return Fa.mapValues(Ha.ul,function(Na,Qa){if(sa)return Ha[sa.toLowerCase()][Qa];Na=Fa.sortBy(Fa.map(Ha,Qa));return(Na[1]+Na[2])/2})}function Da(Ha,sa,Na){return function(Qa,kb,pb){kb=Qa.node(kb);Qa=Qa.node(pb);pb=0;if(pb+=kb.width/2,Fa.has(kb,"labelpos"))switch(kb.labelpos.toLowerCase()){case "l":var ib=-kb.width/2;break;case "r":ib=kb.width/2}if(ib&&(pb+=Na?ib:-ib),
ib=0,pb+=(kb.dummy?sa:Ha)/2,pb+=(Qa.dummy?sa:Ha)/2,pb+=Qa.width/2,Fa.has(Qa,"labelpos"))switch(Qa.labelpos.toLowerCase()){case "l":ib=Qa.width/2;break;case "r":ib=-Qa.width/2}return ib&&(pb+=Na?ib:-ib),pb}}var Fa=Gd(),ua=Ye().Graph,Va=ve();p.exports={positionX:function(Ha){var sa=Va.buildLayerMatrix(Ha),Na=Fa.merge(q(Ha,sa),u(Ha,sa)),Qa={},kb;Fa.forEach(["u","d"],function(ib){kb="u"===ib?sa:Fa.values(sa).reverse();Fa.forEach(["l","r"],function(zb){"r"===zb&&(kb=Fa.map(kb,function(qb){return Fa.values(qb).reverse()}));
var gb=("u"===ib?Ha.predecessors:Ha.successors).bind(Ha);gb=z(Ha,kb,Na,gb);gb=E(Ha,kb,gb.root,gb.align,"r"===zb);"r"===zb&&(gb=Fa.mapValues(gb,function(qb){return-qb}));Qa[ib+zb]=gb})});var pb=T(Ha,Qa);return ca(Qa,pb),ha(Qa,Ha.graph().align)},findType1Conflicts:q,findType2Conflicts:u,addConflict:y,hasConflict:B,verticalAlignment:z,horizontalCompaction:E,alignCoordinates:ca,findSmallestWidthAlignment:T,balance:ha}}),lu=va((n,p)=>{function q(B){var z=w.buildLayerMatrix(B),E=B.graph().ranksep,H=0;u.forEach(z,
function(T){var ca=u.max(u.map(T,function(ha){return B.node(ha).height}));u.forEach(T,function(ha){B.node(ha).y=H+ca/2});H+=ca+E})}var u=Gd(),w=ve(),y=ku().positionX;p.exports=function(B){B=w.asNonCompoundGraph(B);q(B);u.forEach(y(B),function(z,E){B.node(E).x=z})}}),mu=va((n,p)=>{function q(bb,db){db("    makeSpaceForEdgeLabels",function(){y(bb)});db("    removeSelfEdges",function(){Fa(bb)});db("    acyclic",function(){Na.run(bb)});db("    nestingGraph.run",function(){gb.run(bb)});db("    rank",function(){kb(pc.asNonCompoundGraph(bb))});
db("    injectEdgeLabelProxies",function(){B(bb)});db("    removeEmptyRanks",function(){zb(bb)});db("    nestingGraph.cleanup",function(){gb.cleanup(bb)});db("    normalizeRanks",function(){pb(bb)});db("    assignRankMinMax",function(){z(bb)});db("    removeEdgeLabelProxies",function(){E(bb)});db("    normalize.run",function(){Qa.run(bb)});db("    parentDummyChains",function(){ib(bb)});db("    addBorderSegments",function(){qb(bb)});db("    order",function(){Xb(bb)});db("    insertSelfEdges",function(){ua(bb)});
db("    adjustCoordinateSystem",function(){Lb.adjust(bb)});db("    position",function(){$b(bb)});db("    positionSelfEdges",function(){Va(bb)});db("    removeBorderNodes",function(){Da(bb)});db("    normalize.undo",function(){Qa.undo(bb)});db("    fixupEdgeLabelCoords",function(){ca(bb)});db("    undoCoordinateSystem",function(){Lb.undo(bb)});db("    translateGraph",function(){H(bb)});db("    assignNodeIntersects",function(){T(bb)});db("    reversePoints",function(){ha(bb)});db("    acyclic.undo",
function(){Na.undo(bb)})}function u(bb,db){sa.forEach(bb.nodes(),function(oa){var ya=bb.node(oa),N=db.node(oa);ya&&(ya.x=N.x,ya.y=N.y,db.children(oa).length&&(ya.width=N.width,ya.height=N.height))});sa.forEach(bb.edges(),function(oa){var ya=bb.edge(oa);oa=db.edge(oa);ya.points=oa.points;sa.has(oa,"x")&&(ya.x=oa.x,ya.y=oa.y)});bb.graph().width=db.graph().width;bb.graph().height=db.graph().height}function w(bb){var db=new yb({multigraph:!0,compound:!0}),oa=Ha(bb.graph());return db.setGraph(sa.merge({},
Db,sa.mapValues(sa.pick(oa,Bb),Number),sa.pick(oa,Cb))),sa.forEach(bb.nodes(),function(ya){var N=Ha(bb.node(ya));db.setNode(ya,sa.defaults(sa.mapValues(sa.pick(N,sb),Number),Sb));db.setParent(ya,bb.parent(ya))}),sa.forEach(bb.edges(),function(ya){var N=Ha(bb.edge(ya));db.setEdge(ya,sa.merge({},qc,sa.mapValues(sa.pick(N,lc),Number),sa.pick(N,oc)))}),db}function y(bb){var db=bb.graph();db.ranksep/=2;sa.forEach(bb.edges(),function(oa){oa=bb.edge(oa);oa.minlen*=2;"c"!==oa.labelpos.toLowerCase()&&("TB"===
db.rankdir||"BT"===db.rankdir?oa.width+=oa.labeloffset:oa.height+=oa.labeloffset)})}function B(bb){sa.forEach(bb.edges(),function(db){var oa=bb.edge(db);oa.width&&oa.height&&(oa=bb.node(db.v),db={rank:(bb.node(db.w).rank-oa.rank)/2+oa.rank,e:db},pc.addDummyNode(bb,"edge-proxy",db,"_ep"))})}function z(bb){var db=0;sa.forEach(bb.nodes(),function(oa){oa=bb.node(oa);oa.borderTop&&(oa.minRank=bb.node(oa.borderTop).rank,oa.maxRank=bb.node(oa.borderBottom).rank,db=sa.max(db,oa.maxRank))});bb.graph().maxRank=
db}function E(bb){sa.forEach(bb.nodes(),function(db){var oa=bb.node(db);"edge-proxy"===oa.dummy&&(bb.edge(oa.e).labelRank=oa.rank,bb.removeNode(db))})}function H(bb){function db(Sa){var Za=Sa.x,tb=Sa.y,Pb=Sa.width;Sa=Sa.height;oa=Math.min(oa,Za-Pb/2);ya=Math.max(ya,Za+Pb/2);N=Math.min(N,tb-Sa/2);M=Math.max(M,tb+Sa/2)}var oa=Number.POSITIVE_INFINITY,ya=0,N=Number.POSITIVE_INFINITY,M=0,Z=bb.graph(),pa=Z.marginx||0,Ja=Z.marginy||0;sa.forEach(bb.nodes(),function(Sa){db(bb.node(Sa))});sa.forEach(bb.edges(),
function(Sa){Sa=bb.edge(Sa);sa.has(Sa,"x")&&db(Sa)});oa-=pa;N-=Ja;sa.forEach(bb.nodes(),function(Sa){Sa=bb.node(Sa);Sa.x-=oa;Sa.y-=N});sa.forEach(bb.edges(),function(Sa){Sa=bb.edge(Sa);sa.forEach(Sa.points,function(Za){Za.x-=oa;Za.y-=N});sa.has(Sa,"x")&&(Sa.x-=oa);sa.has(Sa,"y")&&(Sa.y-=N)});Z.width=ya-oa+pa;Z.height=M-N+Ja}function T(bb){sa.forEach(bb.edges(),function(db){var oa=bb.edge(db),ya=bb.node(db.v);db=bb.node(db.w);var N,M;oa.points?(N=oa.points[0],M=oa.points[oa.points.length-1]):(oa.points=
[],N=db,M=ya);oa.points.unshift(pc.intersectRect(ya,N));oa.points.push(pc.intersectRect(db,M))})}function ca(bb){sa.forEach(bb.edges(),function(db){db=bb.edge(db);if(sa.has(db,"x"))switch(("l"===db.labelpos||"r"===db.labelpos)&&(db.width-=db.labeloffset),db.labelpos){case "l":db.x-=db.width/2+db.labeloffset;break;case "r":db.x+=db.width/2+db.labeloffset}})}function ha(bb){sa.forEach(bb.edges(),function(db){db=bb.edge(db);db.reversed&&db.points.reverse()})}function Da(bb){sa.forEach(bb.nodes(),function(db){if(bb.children(db).length){db=
bb.node(db);var oa=bb.node(db.borderTop),ya=bb.node(db.borderBottom),N=bb.node(sa.last(db.borderLeft)),M=bb.node(sa.last(db.borderRight));db.width=Math.abs(M.x-N.x);db.height=Math.abs(ya.y-oa.y);db.x=N.x+db.width/2;db.y=oa.y+db.height/2}});sa.forEach(bb.nodes(),function(db){"border"===bb.node(db).dummy&&bb.removeNode(db)})}function Fa(bb){sa.forEach(bb.edges(),function(db){if(db.v===db.w){var oa=bb.node(db.v);oa.selfEdges||(oa.selfEdges=[]);oa.selfEdges.push({e:db,label:bb.edge(db)});bb.removeEdge(db)}})}
function ua(bb){var db=pc.buildLayerMatrix(bb);sa.forEach(db,function(oa){var ya=0;sa.forEach(oa,function(N,M){var Z=bb.node(N);Z.order=M+ya;sa.forEach(Z.selfEdges,function(pa){pc.addDummyNode(bb,"selfedge",{width:pa.label.width,height:pa.label.height,rank:Z.rank,order:M+ ++ya,e:pa.e,label:pa.label},"_se")});delete Z.selfEdges})})}function Va(bb){sa.forEach(bb.nodes(),function(db){var oa=bb.node(db);if("selfedge"===oa.dummy){var ya=bb.node(oa.e.v),N=ya.x+ya.width/2,M=ya.y,Z=oa.x-N;ya=ya.height/2;
bb.setEdge(oa.e,oa.label);bb.removeNode(db);oa.label.points=[{x:N+2*Z/3,y:M-ya},{x:N+5*Z/6,y:M-ya},{x:N+Z,y:M},{x:N+5*Z/6,y:M+ya},{x:N+2*Z/3,y:M+ya}];oa.label.x=oa.x;oa.label.y=oa.y}})}function Ha(bb){var db={};return sa.forEach(bb,function(oa,ya){db[ya.toLowerCase()]=oa}),db}var sa=Gd(),Na=Ut(),Qa=Vt(),kb=Xt(),pb=ve().normalizeRanks,ib=Yt(),zb=ve().removeEmptyRanks,gb=Zt(),qb=$t(),Lb=au(),Xb=ju(),$b=lu(),pc=ve(),yb=Ye().Graph;p.exports=function(bb,db){var oa=db&&db.debugTiming?pc.time:pc.notime;
oa("layout",function(){var ya=oa("  buildLayoutGraph",function(){return w(bb)});oa("  runLayout",function(){q(ya,oa)});oa("  updateInputGraph",function(){u(bb,ya)})})};var Bb=["nodesep","edgesep","ranksep","marginx","marginy"],Db={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Cb=["acyclicer","ranker","rankdir","align"],sb=["width","height"],Sb={width:0,height:0},lc=["minlen","weight","width","height","labeloffset"],qc={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},oc=["labelpos"]}),
nu=va((n,p)=>{var q=Gd(),u=ve(),w=Ye().Graph;p.exports={debugOrdering:function(y){var B=u.buildLayerMatrix(y),z=(new w({compound:!0,multigraph:!0})).setGraph({});return q.forEach(y.nodes(),function(E){z.setNode(E,{label:E});z.setParent(E,"layer"+y.node(E).rank)}),q.forEach(y.edges(),function(E){z.setEdge(E.v,E.w,{},E.name)}),q.forEach(B,function(E,H){z.setNode("layer"+H,{rank:"same"});q.reduce(E,function(T,ca){return z.setEdge(T,ca,{style:"invis"}),ca})}),z}}}),ou=va((n,p)=>{p.exports="0.8.5"}),np=
va((n,p)=>{p.exports={graphlib:Ye(),layout:mu(),debug:nu(),util:{time:ve().time,notime:ve().notime},version:ou()}}),pu=va((n,p)=>{(function(q,u){"object"==typeof n&&"object"==typeof p?p.exports=u(np()):"function"==typeof define&&define.amd?define(["dagre"],u):"object"==typeof n?n.cytoscapeDagre=u(np()):q.cytoscapeDagre=u(q.dagre)})(n,function(q){return function(u){function w(B){if(y[B])return y[B].exports;var z=y[B]={i:B,l:!1,exports:{}};return u[B].call(z.exports,z,z.exports,w),z.l=!0,z.exports}
var y={};return w.m=u,w.c=y,w.d=function(B,z,E){w.o(B,z)||Object.defineProperty(B,z,{enumerable:!0,get:E})},w.r=function(B){"u">typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(B,Symbol.toStringTag,{value:"Module"});Object.defineProperty(B,"__esModule",{value:!0})},w.t=function(B,z){if(z&1&&(B=w(B)),z&8||z&4&&"object"==typeof B&&B&&B.__esModule)return B;var E=Object.create(null);if(w.r(E),Object.defineProperty(E,"default",{enumerable:!0,value:B}),z&2&&"string"!=typeof B)for(var H in B)w.d(E,
H,function(T){return B[T]}.bind(null,H));return E},w.n=function(B){var z=B&&B.__esModule?function(){return B.default}:function(){return B};return w.d(z,"a",z),z},w.o=function(B,z){return Object.prototype.hasOwnProperty.call(B,z)},w.p="",w(w.s=0)}([function(u,w,y){var B=y(1);w=function(z){z&&z("layout","dagre",B)};"u">typeof cytoscape&&w(cytoscape);u.exports=w},function(u,w,y){function B(ca){"@babel/helpers - typeof";return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?B=function(ha){return typeof ha}:
B=function(ha){return ha&&"function"==typeof Symbol&&ha.constructor===Symbol&&ha!==Symbol.prototype?"symbol":typeof ha},B(ca)}function z(ca){this.options=H({},E,ca)}var E=y(2),H=y(3),T=y(4);z.prototype.run=function(){var ca=this.options,ha=ca.cy,Da=ca.eles,Fa=function(ib,zb){return"function"==typeof zb?zb.apply(ib,[ib]):zb},ua=ca.boundingBox||{x1:0,y1:0,w:ha.width(),h:ha.height()};void 0===ua.x2&&(ua.x2=ua.x1+ua.w);void 0===ua.w&&(ua.w=ua.x2-ua.x1);void 0===ua.y2&&(ua.y2=ua.y1+ua.h);void 0===ua.h&&
(ua.h=ua.y2-ua.y1);var Va=new T.graphlib.Graph({multigraph:!0,compound:!0}),Ha={},sa=function(ib,zb){null!=zb&&(Ha[ib]=zb)};sa("nodesep",ca.nodeSep);sa("edgesep",ca.edgeSep);sa("ranksep",ca.rankSep);sa("rankdir",ca.rankDir);sa("align",ca.align);sa("ranker",ca.ranker);sa("acyclicer",ca.acyclicer);Va.setGraph(Ha);Va.setDefaultEdgeLabel(function(){return{}});Va.setDefaultNodeLabel(function(){return{}});sa=Da.nodes();"function"==typeof ca.sort&&(sa=sa.sort(ca.sort));for(var Na=0;Na<sa.length;Na++){var Qa=
sa[Na],kb=Qa.layoutDimensions(ca);Va.setNode(Qa.id(),{width:kb.w,height:kb.h,name:Qa.id()})}for(Na=0;Na<sa.length;Na++)Qa=sa[Na],Qa.isChild()&&Va.setParent(Qa.id(),Qa.parent().id());Da=Da.edges().stdFilter(function(ib){return!ib.source().isParent()&&!ib.target().isParent()});"function"==typeof ca.sort&&(Da=Da.sort(ca.sort));for(Na=0;Na<Da.length;Na++)Qa=Da[Na],Va.setEdge(Qa.source().id(),Qa.target().id(),{minlen:Fa(Qa,ca.minLen),weight:Fa(Qa,ca.edgeWeight),name:Qa.id()},Qa.id());T.layout(Va);Fa=Va.nodes();
for(Da=0;Da<Fa.length;Da++)Na=Fa[Da],Qa=Va.node(Na),ha.getElementById(Na).scratch().dagre=Qa;var pb;ca.boundingBox?(pb={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0},sa.forEach(function(ib){ib=ib.scratch().dagre;pb.x1=Math.min(pb.x1,ib.x);pb.x2=Math.max(pb.x2,ib.x);pb.y1=Math.min(pb.y1,ib.y);pb.y2=Math.max(pb.y2,ib.y)}),pb.w=pb.x2-pb.x1,pb.h=pb.y2-pb.y1):pb=ua;return sa.layoutPositions(this,ca,function(ib){ib="object"===B(ib)?ib:this;ib=ib.scratch().dagre;ib={x:ib.x,y:ib.y};ib=ca.boundingBox?{x:ua.x1+(0===pb.w?
0:(ib.x-pb.x1)/pb.w)*ua.w,y:ua.y1+(0===pb.h?0:(ib.y-pb.y1)/pb.h)*ua.h}:ib;return ib}),this};u.exports=z},function(u,w){u.exports={nodeSep:void 0,edgeSep:void 0,rankSep:void 0,rankDir:void 0,align:void 0,acyclicer:void 0,ranker:void 0,minLen:function(y){return 1},edgeWeight:function(y){return 1},fit:!0,padding:30,spacingFactor:void 0,nodeDimensionsIncludeLabels:!1,animate:!1,animateFilter:function(y,B){return!0},animationDuration:500,animationEasing:void 0,boundingBox:void 0,transform:function(y,B){return B},
ready:function(){},sort:void 0,stop:function(){}}},function(u,w){u.exports=null!=Object.assign?Object.assign.bind(Object):function(y){for(var B=arguments.length,z=Array(1<B?B-1:0),E=1;E<B;E++)z[E-1]=arguments[E];return z.forEach(function(H){Object.keys(H).forEach(function(T){return y[T]=H[T]})}),y}},function(u,w){u.exports=q}])})}),op,Cj,Cd,si,pp,of,qp,ti,Nl,fe,Ee,Wl,gg,Ol,pf,rp,Dj,Vl,Ej,Ij,sp,tp,qu=Lj(()=>{op=0;Cj=class{constructor(n,p){this.from=n;this.to=p}};Cd=class{constructor(n={}){this.id=
op++;this.perNode=!!n.perNode;this.deserialize=n.deserialize||(()=>{throw Error("This node type doesn't define a deserialize function");})}add(n){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof n&&(n=of.match(n)),p=>{p=n(p);return void 0===p?null:[this,p]}}};Cd.closedBy=new Cd({deserialize:n=>n.split(" ")});Cd.openedBy=new Cd({deserialize:n=>n.split(" ")});Cd.group=new Cd({deserialize:n=>n.split(" ")});Cd.isolate=new Cd({deserialize:n=>{if(n&&
"rtl"!=n&&"ltr"!=n&&"auto"!=n)throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});Cd.contextHash=new Cd({perNode:!0});Cd.lookAhead=new Cd({perNode:!0});Cd.mounted=new Cd({perNode:!0});si=class{constructor(n,p,q){this.tree=n;this.overlay=p;this.parser=q}static get(n){return n&&n.props&&n.props[Cd.mounted.id]}};pp=Object.create(null);of=class n{constructor(p,q,u,w=0){this.name=p;this.props=q;this.id=u;this.flags=w}static define(p){let q=p.props&&p.props.length?Object.create(null):
pp,u=new n(p.name||"",q,p.id,(p.top?1:0)|(p.skipped?2:0)|(p.error?4:0)|(null==p.name?8:0));if(p.props)for(let w of p.props)if(Array.isArray(w)||(w=w(u)),w){if(w[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");q[w[0].id]=w[1]}return u}prop(p){return this.props[p.id]}get isTop(){return 0<(this.flags&1)}get isSkipped(){return 0<(this.flags&2)}get isError(){return 0<(this.flags&4)}get isAnonymous(){return 0<(this.flags&8)}is(p){if("string"==typeof p){if(this.name==p)return!0;
let q=this.prop(Cd.group);return q?-1<q.indexOf(p):!1}return this.id==p}static match(p){let q=Object.create(null);for(let u in p)for(let w of u.split(" "))q[w]=p[u];return u=>{for(let w=u.prop(Cd.group),y=-1;y<(w?w.length:0);y++){let B=q[0>y?u.name:w[y]];if(B)return B}}}};of.none=new of("",Object.create(null),0,8);qp=class n{constructor(p){this.types=p;for(let q=0;q<p.length;q++)if(p[q].id!=q)throw new RangeError("Node type ids should correspond to array positions when creating a node set");}extend(...p){let q=
[];for(let u of this.types){let w=null;for(let y of p){let B=y(u);B&&(w||=Object.assign({},u.props),w[B[0].id]=B[1])}q.push(w?new of(u.name,w,u.id,u.flags):u)}return new n(q)}};ti=new WeakMap;Nl=new WeakMap;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers";n[n.IncludeAnonymous=2]="IncludeAnonymous";n[n.IgnoreMounts=4]="IgnoreMounts";n[n.IgnoreOverlays=8]="IgnoreOverlays"})(fe||={});Ee=class n{constructor(p,q,u,w,y){if(this.type=p,this.children=q,this.positions=u,this.length=w,this.props=null,y&&
y.length){this.props=Object.create(null);for(let [B,z]of y)this.props["number"==typeof B?B:B.id]=z}}toString(){var p=si.get(this);if(p&&!p.overlay)return p.tree.toString();p="";for(let q of this.children){let u=q.toString();u&&(p&&(p+=","),p+=u)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(p.length?"("+p+")":""):p}cursor(p=0){return new Ej(this.topNode,p)}cursorAt(p,q=0,u){u=ti.get(this)||this.topNode;u=new Ej(u);return u.moveTo(p,
q),ti.set(this,u._tree),u}get topNode(){return new pf(this,0,0,null)}resolve(p,q=0){p=Mh(ti.get(this)||this.topNode,p,q,!1);return ti.set(this,p),p}resolveInner(p,q=0){p=Mh(Nl.get(this)||this.topNode,p,q,!0);return Nl.set(this,p),p}resolveStack(p,q=0){let u=this.resolveInner(p,q),w=null;for(var y=u instanceof pf?u:u.context.parent;y;y=y.parent)if(0>y.index)y=y.parent,(w||=[u]).push(y.resolve(p,q));else{var B=si.get(y.tree);B&&B.overlay&&B.overlay[0].from<=p&&B.overlay[B.overlay.length-1].to>=p&&(B=
new pf(B.tree,B.overlay[0].from+y.from,-1,y),(w||=[u]).push(Mh(B,p,q,!1)))}return w?Ul(w):u}iterate(p){let {enter:q,leave:u,from:w=0,to:y=this.length}=p;var B=p.mode||0;p=0<(B&fe.IncludeAnonymous);for(B=this.cursor(B|fe.IncludeAnonymous);;){let z=!1;if(B.from<=y&&B.to>=w&&(!p&&B.type.isAnonymous||!1!==q(B))){if(B.firstChild())continue;z=!0}for(;z&&u&&(p||!B.type.isAnonymous)&&u(B),!B.nextSibling();){if(!B.parent())return;z=!0}}}prop(p){return p.perNode?this.props?this.props[p.id]:void 0:this.type.prop(p)}get propValues(){let p=
[];if(this.props)for(let q in this.props)p.push([+q,this.props[q]]);return p}balance(p={}){return 8>=this.children.length?this:Hj(of.none,this.children,this.positions,0,this.children.length,0,this.length,(q,u,w)=>new n(this.type,q,u,w,this.propValues),p.makeTree||((q,u,w)=>new n(of.none,q,u,w)))}static build(p){return Gp(p)}};Ee.empty=new Ee(of.none,[],[],0);Wl=class n{constructor(p,q){this.buffer=p;this.index=q}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-
2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new n(this.buffer,this.index)}};gg=class n{constructor(p,q,u){this.buffer=p;this.length=q;this.set=u}get type(){return of.none}toString(){let p=[];for(let q=0;q<this.buffer.length;)p.push(this.childString(q)),q=this.buffer[q+3];return p.join(",")}childString(p){let q=this.buffer[p+3];var u=this.set.types[this.buffer[p]];let w=u.name;if(/\W/.test(w)&&!u.isError&&(w=JSON.stringify(w)),p+=4,
q==p)return w;for(u=[];p<q;)u.push(this.childString(p)),p=this.buffer[p+3];return w+"("+u.join(",")+")"}findChild(p,q,u,w,y){let {buffer:B}=this,z=-1;for(;p!=q&&!(Sl(y,w,B[p+1],B[p+2])&&(z=p,0<u));p=B[p+3]);return z}slice(p,q,u){let w=this.buffer,y=new Uint16Array(q-p),B=0;for(let z=p,E=0;z<q;){y[E++]=w[z++];y[E++]=w[z++]-u;let H=y[E++]=w[z++]-u;y[E++]=w[z++]-p;B=Math.max(B,H)}return new n(y,B,this.set)}};Ol=class{cursor(n=0){return new Ej(this,n)}getChild(n,p=null,q=null){n=Tl(this,n,p,q);return n.length?
n[0]:null}getChildren(n,p=null,q=null){return Tl(this,n,p,q)}resolve(n,p=0){return Mh(this,n,p,!1)}resolveInner(n,p=0){return Mh(this,n,p,!0)}matchContext(n){return Fj(this.parent,n)}enterUnfinishedNodesBefore(n){n=this.childBefore(n);let p=this;for(;n;){let q=n.lastChild;if(!q||q.to!=n.to)break;q.type.isError&&q.from==q.to?(p=n,n=q.prevSibling):n=q}return p}get node(){return this}get next(){return this.parent}};pf=class n extends Ol{constructor(p,q,u,w){super();this._tree=p;this.from=q;this.index=
u;this._parent=w}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(p,q,u,w,y=0){for(let B=this;;){for(let {children:z,positions:E}=B._tree,H=0<q?z.length:-1;p!=H;p+=q){let T=z[p],ca=E[p]+B.from;if(Sl(w,u,ca,ca+T.length))if(T instanceof gg){if(y&fe.ExcludeBuffers)continue;let ha=T.findChild(0,T.buffer.length,q,u-ca,w);if(-1<ha)return new Dj(new rp(B,T,p,ca),null,ha)}else if(y&fe.IncludeAnonymous||!T.type.isAnonymous||Gj(T)){let ha;
if(!(y&fe.IgnoreMounts)&&(ha=si.get(T))&&!ha.overlay)return new n(ha.tree,ca,p,B);p=new n(T,ca,p,B);return y&fe.IncludeAnonymous||!p.type.isAnonymous?p:p.nextChild(0>q?T.children.length-1:0,q,u,w)}}if(y&fe.IncludeAnonymous||!B.type.isAnonymous||(0<=B.index?p=B.index+q:p=0>q?-1:B._parent._tree.children.length,B=B._parent,!B))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(p){return this.nextChild(0,1,
p,2)}childBefore(p){return this.nextChild(this._tree.children.length-1,-1,p,-2)}enter(p,q,u=0){let w;if(!(u&fe.IgnoreOverlays)&&(w=si.get(this._tree))&&w.overlay){let y=p-this.from;for(let {from:B,to:z}of w.overlay)if((0<q?B<=y:B<y)&&(0>q?z>=y:z>y))return new n(w.tree,w.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,p,q,u)}nextSignificantParent(){let p=this;for(;p.type.isAnonymous&&p._parent;)p=p._parent;return p}get parent(){return this._parent?this._parent.nextSignificantParent():
null}get nextSibling(){return this._parent&&0<=this.index?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&0<=this.index?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};rp=class{constructor(n,p,q,u){this.parent=n;this.buffer=p;this.index=q;this.start=u}};Dj=class n extends Ol{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+
1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(p,q,u){super();this.context=p;this._parent=q;this.index=u;this.type=p.buffer.set.types[p.buffer.buffer[u]]}child(p,q,u){let {buffer:w}=this.context;p=w.findChild(this.index+4,w.buffer[this.index+3],p,q-this.context.start,u);return 0>p?null:new n(this.context,this,p)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(p){return this.child(1,p,2)}childBefore(p){return this.child(-1,
p,-2)}enter(p,q,u=0){if(u&fe.ExcludeBuffers)return null;({buffer:u}=this.context);p=u.findChild(this.index+4,u.buffer[this.index+3],0<q?1:-1,p-this.context.start,q);return 0>p?null:new n(this.context,this,p)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(p){return this._parent?null:this.context.parent.nextChild(this.context.index+p,p,0,4)}get nextSibling(){let {buffer:p}=this.context,q=p.buffer[this.index+3];return q<(this._parent?p.buffer[this._parent.index+
3]:p.buffer.length)?new n(this.context,this._parent,q):this.externalSibling(1)}get prevSibling(){let {buffer:p}=this.context,q=this._parent?this._parent.index+4:0;return this.index==q?this.externalSibling(-1):new n(this.context,this._parent,p.findChild(q,this.index,-1,0,4))}get tree(){return null}toTree(){let p=[],q=[],{buffer:u}=this.context,w=this.index+4,y=u.buffer[this.index+3];y>w&&(p.push(u.slice(w,y,u.buffer[this.index+1])),q.push(0));return new Ee(this.type,p,q,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};
Vl=class{constructor(n,p){this.heads=n;this.node=p}get next(){return Ul(this.heads)}};Ej=class{get name(){return this.type.name}constructor(n,p=0){if(this.mode=p,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,n instanceof pf)this.yieldNode(n);else{this._tree=n.context.parent;this.buffer=n.context;for(p=n._parent;p;p=p._parent)this.stack.unshift(p.index);this.bufferNode=n;this.yieldBuf(n.index)}}yieldNode(n){return n?(this._tree=n,this.type=n.type,this.from=n.from,this.to=n.to,!0):
!1}yieldBuf(n,p){this.index=n;let {start:q,buffer:u}=this.buffer;return this.type=p||u.set.types[u.buffer[n]],this.from=q+u.buffer[n+1],this.to=q+u.buffer[n+2],!0}yield(n){return n?n instanceof pf?(this.buffer=null,this.yieldNode(n)):(this.buffer=n.context,this.yieldBuf(n.index,n.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(n,p,q){if(!this.buffer)return this.yield(this._tree.nextChild(0>n?this._tree._tree.children.length-1:0,n,
p,q,this.mode));let {buffer:u}=this.buffer;n=u.findChild(this.index+4,u.buffer[this.index+3],n,p-this.buffer.start,q);return 0>n?!1:(this.stack.push(this.index),this.yieldBuf(n))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(n){return this.enterChild(1,n,2)}childBefore(n){return this.enterChild(-1,n,-2)}enter(n,p,q=this.mode){return this.buffer?q&fe.ExcludeBuffers?!1:this.enterChild(1,n,p):this.yield(this._tree.enter(n,p,q))}parent(){if(!this.buffer)return this.yieldNode(this.mode&
fe.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let n=this.mode&fe.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(n)}sibling(n){if(!this.buffer)return this._tree._parent?this.yield(0>this._tree.index?null:this._tree._parent.nextChild(this._tree.index+n,n,0,4,this.mode)):!1;let {buffer:p}=this.buffer,q=this.stack.length-1;if(0>n){var u=0>q?0:this.stack[q]+4;if(this.index!=
u)return this.yieldBuf(p.findChild(u,this.index,-1,0,4))}else if(u=p.buffer[this.index+3],u<(0>q?p.buffer.length:p.buffer[this.stack[q]+3]))return this.yieldBuf(u);return 0>q?this.yield(this.buffer.parent.nextChild(this.buffer.index+n,n,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(n){var p,q;({buffer:q}=this);if(q){if(0<n){if(this.index<q.buffer.buffer.length)return!1}else for(p=0;p<this.index;p++)if(q.buffer.buffer[p+3]<this.index)return!1;
({index:p,parent:q}=q)}else({index:p,_parent:q}=this._tree);for(;q;{index:p,_parent:q}=q)if(-1<p)for(let u=p+n,w=0>n?-1:q._tree.children.length;u!=w;u+=n)if(p=q._tree.children[u],this.mode&fe.IncludeAnonymous||p instanceof gg||!p.type.isAnonymous||Gj(p))return!1;return!0}move(n,p){if(p&&this.enterChild(n,0,4))return!0;for(;;){if(this.sibling(n))return!0;if(this.atLastNode(n)||!this.parent())return!1}}next(n=!0){return this.move(1,n)}prev(n=!0){return this.move(-1,n)}moveTo(n,p=0){for(;(this.from==
this.to||(1>p?this.from>=n:this.from>n)||(-1<p?this.to<=n:this.to<n))&&this.parent(););for(;this.enterChild(1,n,p););return this}get node(){if(!this.buffer)return this._tree;var n=this.bufferNode;let p=null,q=0;if(n&&n.context==this.buffer)a:for(let u=this.index,w=this.stack.length;0<=w;){for(let y=n;y;y=y._parent)if(y.index==u){if(u==this.index)return y;p=y;q=w+1;break a}u=this.stack[--w]}for(n=q;n<this.stack.length;n++)p=new Dj(this.buffer,p,this.stack[n]);return this.bufferNode=new Dj(this.buffer,
p,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(n,p){for(let q=0;;){let u=!1;if(this.type.isAnonymous||!1!==n(this)){if(this.firstChild()){q++;continue}this.type.isAnonymous||(u=!0)}for(;;){if(u&&p&&p(this),!q)return;if(this.nextSibling())break;this.parent();q--;u=!0}}}matchContext(n){if(!this.buffer)return Fj(this.node.parent,n);let {buffer:p}=this.buffer,{types:q}=p.set;for(let u=n.length-1,w=this.stack.length-1;0<=u;w--){if(0>w)return Fj(this._tree,n,u);let y=q[p.buffer[this.stack[w]]];
if(!y.isAnonymous){if(n[u]&&n[u]!=y.name)return!1;u--}}return!0}};Ij=new WeakMap;sp=class{startParse(n,p,q){return"string"==typeof n&&(n=new tp(n)),q=q?q.length?q.map(u=>new Cj(u.from,u.to)):[new Cj(0,0)]:[new Cj(0,n.length)],this.createParse(n,p||[],q)}parse(n,p,q){for(n=this.startParse(n,p,q);;)if(p=n.advance())return p}};tp=class{constructor(n){this.string=n}get length(){return this.string.length}chunk(n){return this.string.slice(n)}get lineChunks(){return!1}read(n,p){return this.string.slice(n,
p)}};new Cd({perNode:!0})}),up,Pl,vp,wp,ui,Ql,xp,Wg,we,Rl,yp,zp,Ap,Bp,Cp,ru=Lj(()=>{qu();up=class n{constructor(p,q,u,w,y,B,z,E,H,T=0,ca){this.p=p;this.stack=q;this.state=u;this.reducePos=w;this.pos=y;this.score=B;this.buffer=z;this.bufferBase=E;this.curContext=H;this.lookAhead=T;this.parent=ca}toString(){return`[${this.stack.filter((p,q)=>0==q%3).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(p,q,u=0){let w=p.parser.context;return new n(p,[],q,u,u,0,[],0,w?new Pl(w,
w.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(p,q){this.stack.push(this.state,q,this.bufferBase+this.buffer.length);this.state=p}reduce(p){var q,u=p>>19;let w=p&65535,{parser:y}=this.p;var B=this.reducePos<this.pos-25;B&&this.setLookAhead(this.pos);var z=y.dynamicPrecedence(w);if(z&&(this.score+=z),0==u)this.pushState(y.getGoto(this.state,w,!0),this.reducePos),w<y.minRepeatTerm&&this.storeNode(w,this.reducePos,this.reducePos,B?8:4,!0),this.reduceContext(w,
this.reducePos);else{B=(u=this.stack.length-3*(u-1)-(p&262144?6:0))?this.stack[u-2]:this.p.ranges[0].from;z=this.reducePos-B;2E3<=z&&(null===(q=this.p.parser.nodeSet.types[w])||void 0===q||!q.isAnonymous)&&(B==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=z):this.p.lastBigReductionSize<z&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=B,this.p.lastBigReductionSize=z));q=this.bufferBase+this.buffer.length-(u?this.stack[u-1]:0);if(w<y.minRepeatTerm||
p&131072)z=y.stateFlag(this.state,1)?this.pos:this.reducePos,this.storeNode(w,B,z,q+4,!0);for(this.state=p&262144?this.stack[u]:y.getGoto(this.stack[u-3],w,!0);this.stack.length>u;)this.stack.pop();this.reduceContext(w,B)}}storeNode(p,q,u,w=4,y=!1){if(0==p&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){var B=this,z=this.buffer.length;if(0==z&&B.parent&&(z=B.bufferBase-B.parent.bufferBase,B=B.parent),0<z&&0==B.buffer[z-4]&&-1<B.buffer[z-1]){if(q==u)return;
if(B.buffer[z-2]>=q){B.buffer[z-2]=u;return}}}if(y&&this.pos!=u){y=this.buffer.length;if(0<y&&0!=this.buffer[y-4]){B=!1;for(z=y;0<z&&this.buffer[z-2]>u;z-=4)if(0<=this.buffer[z-1]){B=!0;break}if(B)for(;0<y&&this.buffer[y-2]>u;)this.buffer[y]=this.buffer[y-4],this.buffer[y+1]=this.buffer[y-3],this.buffer[y+2]=this.buffer[y-2],this.buffer[y+3]=this.buffer[y-1],y-=4,4<w&&(w-=4)}this.buffer[y]=p;this.buffer[y+1]=q;this.buffer[y+2]=u;this.buffer[y+3]=w}else this.buffer.push(p,q,u,w)}shift(p,q,u,w){if(p&
131072)this.pushState(p&65535,this.pos);else if(0==(p&262144)){let {parser:y}=this.p;(w>this.pos||q<=y.maxNode)&&(this.pos=w,y.stateFlag(p,1)||(this.reducePos=w));this.pushState(p,u);this.shiftContext(q,u);q<=y.maxNode&&this.buffer.push(q,u,w,4)}else this.pos=w,this.shiftContext(q,u),q<=this.p.parser.maxNode&&this.buffer.push(q,u,w,4)}apply(p,q,u,w){p&65536?this.reduce(p):this.shift(p,q,u,w)}useNode(p,q){let u=this.p.reused.length-1;(0>u||this.p.reused[u]!=p)&&(this.p.reused.push(p),u++);let w=this.pos;
this.reducePos=this.pos=w+p.length;this.pushState(q,w);this.buffer.push(u,w,this.reducePos,-1);this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,p,this,this.p.stream.reset(this.pos-p.length)))}split(){let p=this;for(var q=p.buffer.length;0<q&&p.buffer[q-2]>p.reducePos;)q-=4;let u=p.buffer.slice(q);for(q=p.bufferBase+q;p&&q==p.bufferBase;)p=p.parent;return new n(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,u,q,this.curContext,this.lookAhead,
p)}recoverByDelete(p,q){let u=p<=this.p.parser.maxNode;u&&this.storeNode(p,this.pos,q,4);this.storeNode(0,this.pos,q,u?8:4);this.pos=this.reducePos=q;this.score-=190}canShift(p){for(let q=new vp(this);;){let u=this.p.parser.stateSlot(q.state,4)||this.p.parser.hasAction(q.state,p);if(0==u)return!1;if(0==(u&65536))return!0;q.reduce(u)}}recoverByInsert(p){if(300<=this.stack.length)return[];let q=this.p.parser.nextStates(this.state);if(8<q.length||120<=this.stack.length){var u=[];for(let w=0,y;w<q.length;w+=
2)(y=q[w+1])!=this.state&&this.p.parser.hasAction(y,p)&&u.push(q[w],y);if(120>this.stack.length)for(p=0;8>u.length&&p<q.length;p+=2){let w=q[p+1];u.some((y,B)=>B&1&&y==w)||u.push(q[p],w)}q=u}u=[];for(p=0;p<q.length&&4>u.length;p+=2){let w=q[p+1];if(w==this.state)continue;let y=this.split();y.pushState(w,this.pos);y.storeNode(0,y.pos,y.pos,4,!0);y.shiftContext(q[p],this.pos);y.reducePos=this.pos;y.score-=200;u.push(y)}return u}forceReduce(){var {parser:p}=this.p;let q=p.stateSlot(this.state,5);if(0==
(q&65536))return!1;if(!p.validAction(this.state,q)){let u=this.stack.length-3*(q>>19);if(0>u||0>p.getGoto(this.stack[u],q&65535,!1)){p=this.findForcedReduction();if(null==p)return!1;q=p}this.storeNode(0,this.pos,this.pos,4,!0);this.score-=100}return this.reducePos=this.pos,this.reduce(q),!0}findForcedReduction(){let {parser:p}=this.p,q=[],u=(w,y)=>{if(!q.includes(w))return q.push(w),p.allActions(w,B=>{if(!(B&393216))if(B&65536){var z=(B>>19)-y;if(1<z){B&=65535;let E=this.stack.length-3*z;if(0<=E&&
0<=p.getGoto(this.stack[E],B,!1))return z<<19|65536|B}}else if(z=u(B,y+1),null!=z)return z})};return u(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let {parser:p}=this.p;return 65535==p.data[p.stateSlot(this.state,1)]&&!p.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0);this.state=this.stack[0];this.stack.length=0}sameState(p){if(this.state!=
p.state||this.stack.length!=p.stack.length)return!1;for(let q=0;q<this.stack.length;q+=3)if(this.stack[q]!=p.stack[q])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(p){return this.p.parser.dialect.flags[p]}shiftContext(p,q){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,p,this,this.p.stream.reset(q)))}reduceContext(p,q){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,p,this,this.p.stream.reset(q)))}emitContext(){let p=
this.buffer.length-1;(0>p||-3!=this.buffer[p])&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let p=this.buffer.length-1;(0>p||-4!=this.buffer[p])&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(p){p!=this.curContext.context&&(p=new Pl(this.curContext.tracker,p),p.hash!=this.curContext.hash&&this.emitContext(),this.curContext=p)}setLookAhead(p){p>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=p)}close(){this.curContext&&this.curContext.tracker.strict&&
this.emitContext();0<this.lookAhead&&this.emitLookAhead()}};Pl=class{constructor(n,p){this.tracker=n;this.context=p;this.hash=n.strict?n.hash(p):0}};vp=class{constructor(n){this.start=n;this.state=n.state;this.stack=n.stack;this.base=this.stack.length}reduce(n){let p=n&65535;n>>=19;0==n?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(n-1);this.state=this.start.p.parser.getGoto(this.stack[this.base-3],p,!0)}};wp=class n{constructor(p,
q,u){this.stack=p;this.pos=q;this.index=u;this.buffer=p.buffer;0==this.index&&this.maybeNext()}static create(p,q=p.bufferBase+p.buffer.length){return new n(p,q,q-p.bufferBase)}maybeNext(){let p=this.stack.parent;null!=p&&(this.index=this.stack.bufferBase-p.bufferBase,this.stack=p,this.buffer=p.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4;this.pos-=
4;0==this.index&&this.maybeNext()}fork(){return new n(this.stack,this.pos,this.index)}};ui=class{constructor(){this.extended=this.end=this.value=this.start=-1;this.context=this.mask=this.lookAhead=0}};Ql=new ui;xp=class{constructor(n,p){this.input=n;this.ranges=p;this.chunk="";this.chunkOff=0;this.chunk2="";this.chunk2Pos=0;this.next=-1;this.token=Ql;this.rangeIndex=0;this.pos=this.chunkPos=p[0].from;this.range=p[0];this.end=p[p.length-1].to;this.readNext()}resolveOffset(n,p){let q=this.range,u=this.rangeIndex;
for(n=this.pos+n;n<q.from;){if(!u)return null;var w=this.ranges[--u];n-=q.from-w.to;q=w}for(;0>p?n>q.to:n>=q.to;){if(u==this.ranges.length-1)return null;w=this.ranges[++u];n+=w.from-q.to;q=w}return n}clipPos(n){if(n>=this.range.from&&n<this.range.to)return n;for(let p of this.ranges)if(p.to>n)return Math.max(n,p.from);return this.end}peek(n){var p=this.chunkOff+n;let q;if(0<=p&&p<this.chunk.length)q=this.pos+n,n=this.chunk.charCodeAt(p);else{n=this.resolveOffset(n,1);if(null==n)return-1;if(q=n,q>=
this.chunk2Pos&&q<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(q-this.chunk2Pos);else{n=this.rangeIndex;for(p=this.range;p.to<=q;)p=this.ranges[++n];this.chunk2=this.input.chunk(this.chunk2Pos=q);q+this.chunk2.length>p.to&&(this.chunk2=this.chunk2.slice(0,p.to-q));n=this.chunk2.charCodeAt(0)}}return q>=this.token.lookAhead&&(this.token.lookAhead=q+1),n}acceptToken(n,p=0){p=p?this.resolveOffset(p,-1):this.pos;if(null==p||p<this.token.start)throw new RangeError("Token end out of bounds");
this.token.value=n;this.token.end=p}acceptTokenTo(n,p){this.token.value=n;this.token.end=p}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let {chunk:n,chunkPos:p}=this;this.chunk=this.chunk2;this.chunkPos=this.chunk2Pos;this.chunk2=n;this.chunk2Pos=p;this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk;this.chunk2Pos=this.chunkPos;let n=this.input.chunk(this.pos);this.chunk=this.pos+n.length>this.range.to?n.slice(0,this.range.to-this.pos):n;this.chunkPos=
this.pos;this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(n=1){for(this.chunkOff+=n;this.pos+n>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();n-=this.range.to-this.pos;this.range=this.ranges[++this.rangeIndex];this.pos=this.range.from}return this.pos+=n,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=
this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(n,p){if(p?(this.token=p,p.start=n,p.lookAhead=n+1,p.value=p.extended=-1):this.token=Ql,this.pos!=n){if(this.pos=n,n==this.end)return this.setDone(),this;for(;n<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;n>=this.range.to;)this.range=this.ranges[++this.rangeIndex];n>=this.chunkPos&&n<this.chunkPos+this.chunk.length?this.chunkOff=n-this.chunkPos:(this.chunk="",this.chunkOff=
0);this.readNext()}return this}read(n,p){if(n>=this.chunkPos&&p<=this.chunkPos+this.chunk.length)return this.chunk.slice(n-this.chunkPos,p-this.chunkPos);if(n>=this.chunk2Pos&&p<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(n-this.chunk2Pos,p-this.chunk2Pos);if(n>=this.range.from&&p<=this.range.to)return this.input.read(n,p);let q="";for(let u of this.ranges){if(u.from>=p)break;u.to>n&&(q+=this.input.read(Math.max(u.from,n),Math.min(u.to,p)))}return q}};Wg=class{constructor(n,p){this.data=
n;this.id=p}token(n,p){var {parser:q}=p.p,u=this.data,w=q.data;q=q.tokenPrecTable;var y=0;let B=1<<this.id;({dialect:p}=p.p.parser);a:for(;0!=(B&u[y]);){let ha=u[y+1];for(var z=y+3;z<ha;z+=2)if(0<(u[z+1]&B)){var E=u[z],H;if((H=p.allows(E))&&!(H=-1==n.token.value||n.token.value==E)){H=E;var T=w,ca=q;let Da=Xl(T,ca,n.token.value);H=0>Da||Xl(T,ca,H)<Da}if(H){n.acceptToken(E);break}}z=n.next;E=0;y=u[y+2];if(0>n.next&&y>E&&65535==u[ha+3*y-3]){y=u[ha+3*y-1];continue a}for(;E<y;)if(H=E+y>>1,T=ha+H+(H<<1),
ca=u[T+1]||65536,z<u[T])y=H;else if(z>=ca)E=H+1;else{y=u[T+2];n.advance();continue a}break}}};Wg.prototype.contextual=Wg.prototype.fallback=Wg.prototype.extend=!1;Wg.prototype.fallback=Wg.prototype.extend=!1;we="u">typeof process&&process.env&&/\bparse\b/.test(process.env.LOG);Rl=null;yp=class{constructor(n,p){this.fragments=n;this.nodeSet=p;this.i=0;this.fragment=null;this.safeTo=this.safeFrom=-1;this.trees=[];this.start=[];this.index=[];this.nextFragment()}nextFragment(){let n=this.fragment=this.i==
this.fragments.length?null:this.fragments[this.i++];if(n){this.safeFrom=n.openStart?Yl(n.tree,n.from+n.offset,1)-n.offset:n.from;for(this.safeTo=n.openEnd?Yl(n.tree,n.to+n.offset,-1)-n.offset:n.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(n.tree);this.start.push(-n.offset);this.index.push(0);this.nextStart=this.safeFrom}else this.nextStart=1E9}nodeAt(n){if(n<this.nextStart)return null;for(;this.fragment&&this.safeTo<=n;)this.nextFragment();if(!this.fragment)return null;
for(;;){let u=this.trees.length-1;if(0>u)return this.nextFragment(),null;var p=this.trees[u],q=this.index[u];if(q==p.children.length){this.trees.pop();this.start.pop();this.index.pop();continue}let w=p.children[q];p=this.start[u]+p.positions[q];if(p>n)return this.nextStart=p,null;if(w instanceof Ee){if(p==n){if(p<this.safeFrom)return null;q=p+w.length;if(q<=this.safeTo){let y=w.prop(Cd.lookAhead);if(!y||q+y<this.fragment.to)return w}}this.index[u]++;p+w.length>=Math.max(this.safeFrom,n)&&(this.trees.push(w),
this.start.push(p),this.index.push(0))}else this.index[u]++,this.nextStart=p+w.length}}};zp=class{constructor(n,p){this.stream=p;this.tokens=[];this.mainToken=null;this.actions=[];this.tokens=n.tokenizers.map(q=>new ui)}getActions(n){let p=0,q=null;var {parser:u}=n.p;let {tokenizers:w}=u;u=u.stateSlot(n.state,3);let y=n.curContext?n.curContext.hash:0,B=0;for(let z=0;z<w.length;z++){if(0==(1<<z&u))continue;let E=w[z],H=this.tokens[z];if((!q||E.fallback)&&((E.contextual||H.start!=n.pos||H.mask!=u||
H.context!=y)&&(this.updateCachedToken(H,E,n),H.mask=u,H.context=y),H.lookAhead>H.end+25&&(B=Math.max(H.lookAhead,B)),0!=H.value)){let T=p;if(-1<H.extended&&(p=this.addActions(n,H.extended,H.end,p)),p=this.addActions(n,H.value,H.end,p),!E.extend&&(q=H,p>T))break}}for(;this.actions.length>p;)this.actions.pop();return B&&n.setLookAhead(B),!q&&n.pos==this.stream.end&&(q=new ui,q.value=n.p.parser.eofTerm,q.start=q.end=n.pos,this.addActions(n,q.value,q.end,p)),this.mainToken=q,this.actions}getMainToken(n){if(this.mainToken)return this.mainToken;
let p=new ui,{pos:q,p:u}=n;return p.start=q,p.end=Math.min(q+1,u.stream.end),p.value=q==u.stream.end?u.parser.eofTerm:0,p}updateCachedToken(n,p,q){var u=this.stream.clipPos(q.pos);if(p.token(this.stream.reset(u,n),q),-1<n.value)for({parser:p}=q.p,u=0;u<p.specialized.length;u++){if(p.specialized[u]==n.value){let w=p.specializers[u](this.stream.read(n.start,n.end),q);if(0<=w&&q.p.parser.dialect.allows(w>>1)){0==(w&1)?n.value=w>>1:n.extended=w>>1;break}}}else n.value=0,n.end=this.stream.clipPos(u+1)}putAction(n,
p,q,u){for(let w=0;w<u;w+=3)if(this.actions[w]==n)return u;return this.actions[u++]=n,this.actions[u++]=p,this.actions[u++]=q,u}addActions(n,p,q,u){let {state:w}=n;({parser:n}=n.p);let {data:y}=n;for(let B=0;2>B;B++)for(let z=n.stateSlot(w,B?2:1);;z+=3){if(65535==y[z])if(1==y[z+1])z=qf(y,z+2);else{0==u&&2==y[z+1]&&(u=this.putAction(qf(y,z+2),p,q,u));break}y[z]==p&&(u=this.putAction(qf(y,z+1),p,q,u))}return u}};Ap=class{constructor(n,p,q,u){this.parser=n;this.input=p;this.ranges=u;this.recovering=
0;this.nextStackID=9812;this.minStackPos=0;this.reused=[];this.stoppedAt=null;this.lastBigReductionStart=-1;this.bigReductionCount=this.lastBigReductionSize=0;this.stream=new xp(p,u);this.tokens=new zp(n,this.stream);this.topTerm=n.top[1];({from:p}=u[0]);this.stacks=[up.start(this,n.top[0],p)];this.fragments=q.length&&this.stream.end-p>4*n.bufferLength?new yp(q,n.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){var n=this.stacks;let p=this.minStackPos,q=this.stacks=[];var u,w;if(300<
this.bigReductionCount&&1==n.length){for(var [y]=n;y.forceReduce()&&y.stack.length&&y.stack[y.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(y=0;y<n.length;y++)for(var B=n[y];;){if(this.tokens.mainToken=null,B.pos>p)q.push(B);else{if(this.advanceStack(B,q,n))continue;u||(u=[],w=[]);u.push(B);B=this.tokens.getMainToken(B);w.push(B.value,B.end)}break}if(!q.length){if(n=u&&Hp(u))return we&&console.log("Finish with "+this.stackID(n)),this.stackToTree(n);
if(this.parser.strict)throw we&&u&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+p);this.recovering||(this.recovering=5)}if(this.recovering&&u&&(u=null!=this.stoppedAt&&u[0].pos>this.stoppedAt?u[0]:this.runRecovery(u,w,q)))return we&&console.log("Force-finish "+this.stackID(u)),this.stackToTree(u.forceAll());if(this.recovering){u=1==this.recovering?1:3*this.recovering;if(q.length>u)for(q.sort((z,E)=>
E.score-z.score);q.length>u;)q.pop();q.some(z=>z.reducePos>p)&&this.recovering--}else if(1<q.length){a:for(u=0;u<q.length-1;u++)for(w=q[u],n=u+1;n<q.length;n++)if(y=q[n],w.sameState(y)||500<w.buffer.length&&500<y.buffer.length)if(0<(w.score-y.score||w.buffer.length-y.buffer.length))q.splice(n--,1);else{q.splice(u--,1);continue a}12<q.length&&q.splice(12,q.length-12)}this.minStackPos=q[0].pos;for(u=1;u<q.length;u++)q[u].pos<this.minStackPos&&(this.minStackPos=q[u].pos);return null}stopAt(n){if(null!=
this.stoppedAt&&this.stoppedAt<n)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=n}advanceStack(n,p,q){let u=n.pos,{parser:w}=this,y=we?this.stackID(n)+" -> ":"";if(null!=this.stoppedAt&&u>this.stoppedAt)return n.forceReduce()?n:null;if(this.fragments){var B=n.curContext&&n.curContext.tracker.strict,z=B?n.curContext.hash:0;for(var E=this.fragments.nodeAt(u);E;){var H=this.parser.nodeSet.types[E.type.id]==E.type?w.getGoto(n.state,E.type.id):-1;if(-1<H&&E.length&&(!B||(E.prop(Cd.contextHash)||
0)==z))return n.useNode(E,H),we&&console.log(y+this.stackID(n)+` (via reuse of ${w.getName(E.type.id)})`),!0;if(!(E instanceof Ee)||0==E.children.length||0<E.positions[0])break;H=E.children[0];if(H instanceof Ee&&0==E.positions[0])E=H;else break}}B=w.stateSlot(n.state,4);if(0<B)return n.reduce(B),we&&console.log(y+this.stackID(n)+` (via always-reduce ${w.getName(B&65535)})`),!0;if(8400<=n.stack.length)for(;6E3<n.stack.length&&n.forceReduce(););B=this.tokens.getActions(n);for(z=0;z<B.length;){E=B[z++];
H=B[z++];let T=B[z++],ca=z==B.length||!q,ha=ca?n:n.split(),Da=this.tokens.mainToken;if(ha.apply(E,H,Da?Da.start:ha.pos,T),we&&console.log(y+this.stackID(ha)+` (via ${0==(E&65536)?"shift":`reduce of ${w.getName(E&65535)}`} for ${w.getName(H)} @ ${u}${ha==n?"":", split"})`),ca)return!0;ha.pos>u?p.push(ha):q.push(ha)}return!1}advanceFully(n,p){let q=n.pos;for(;;){if(!this.advanceStack(n,null,null))return!1;if(n.pos>q)return Zl(n,p),!0}}runRecovery(n,p,q){let u=null,w=!1;for(let y=0;y<n.length;y++){let B=
n[y],z=p[y<<1],E=p[(y<<1)+1],H=we?this.stackID(B)+" -> ":"";if(B.deadEnd&&(w||(w=!0,B.restart(),we&&console.log(H+this.stackID(B)+" (restarted)"),this.advanceFully(B,q))))continue;let T=B.split(),ca=H;for(let ha=0;T.forceReduce()&&10>ha&&(we&&console.log(ca+this.stackID(T)+" (via force-reduce)"),!this.advanceFully(T,q));ha++)we&&(ca=this.stackID(T)+" -> ");for(let ha of B.recoverByInsert(z))we&&console.log(H+this.stackID(ha)+" (via recover-insert)"),this.advanceFully(ha,q);this.stream.end>B.pos?(E==
B.pos&&(E++,z=0),B.recoverByDelete(z,E),we&&console.log(H+this.stackID(B)+` (via recover-delete ${this.parser.getName(z)})`),Zl(B,q)):(!u||u.score<B.score)&&(u=B)}return u}stackToTree(n){return n.close(),Ee.build({buffer:wp.create(n),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:n.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(n){let p=(Rl||=new WeakMap).get(n);return p||Rl.set(n,
p=String.fromCodePoint(this.nextStackID++)),p+n}};Bp=class{constructor(n,p,q){this.source=n;this.flags=p;this.disabled=q}allows(n){return!this.disabled||0==this.disabled[n]}};Cp=class n extends sp{constructor(p){function q(H,T,ca){B[H].push([T,T.deserialize(String(ca))])}if(super(),this.wrappers=[],14!=p.version)throw new RangeError(`Parser version (${p.version}) doesn't match runtime version (14)`);var u=p.nodeNames.split(" ");this.minRepeatTerm=u.length;for(var w=0;w<p.repeatNodeCount;w++)u.push("");
let y=Object.keys(p.topRules).map(H=>p.topRules[H][1]),B=[];for(w=0;w<u.length;w++)B.push([]);if(p.nodeProps)for(let H of p.nodeProps){w=H[0];"string"==typeof w&&(w=Cd[w]);for(let T=1;T<H.length;){var z=H[T++];if(0<=z)q(z,w,H[T++]);else{let ca=H[T+-z];for(z=-z;0<z;z--)q(H[T++],w,ca);T++}}}this.nodeSet=new qp(u.map((H,T)=>of.define({name:T>=this.minRepeatTerm?void 0:H,id:T,props:B[T],top:-1<y.indexOf(T),error:0==T,skipped:p.skippedNodes&&-1<p.skippedNodes.indexOf(T)})));p.propSources&&(this.nodeSet=
this.nodeSet.extend(...p.propSources));this.strict=!1;this.bufferLength=1024;let E=wi(p.tokenData);this.context=p.context;this.specializerSpecs=p.specialized||[];this.specialized=new Uint16Array(this.specializerSpecs.length);for(u=0;u<this.specializerSpecs.length;u++)this.specialized[u]=this.specializerSpecs[u].term;this.specializers=this.specializerSpecs.map($l);this.states=wi(p.states,Uint32Array);this.data=wi(p.stateData);this.goto=wi(p.goto);this.maxTerm=p.maxTerm;this.tokenizers=p.tokenizers.map(H=>
"number"==typeof H?new Wg(E,H):H);this.topRules=p.topRules;this.dialects=p.dialects||{};this.dynamicPrecedences=p.dynamicPrecedences||null;this.tokenPrecTable=p.tokenPrec;this.termNames=p.termNames||null;this.maxNode=this.nodeSet.types.length-1;this.dialect=this.parseDialect();this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(p,q,u){let w=new Ap(this,p,q,u);for(let y of this.wrappers)w=y(w,p,q,u);return w}getGoto(p,q,u=!1){let w=this.goto;if(q>=w[0])return-1;for(q=w[q+1];;){var y=
w[q++];let B=y&1,z=w[q++];if(B&&u)return z;for(y=q+(y>>1);q<y;q++)if(w[q]==p)return z;if(B)return-1}}hasAction(p,q){let u=this.data;for(let w=0;2>w;w++)for(let y=this.stateSlot(p,w?2:1),B;;y+=3){if(65535==(B=u[y]))if(1==u[y+1])B=u[y=qf(u,y+2)];else{if(2==u[y+1])return qf(u,y+2);break}if(B==q||0==B)return qf(u,y+1)}return 0}stateSlot(p,q){return this.states[6*p+q]}stateFlag(p,q){return 0<(this.stateSlot(p,0)&q)}validAction(p,q){return!!this.allActions(p,u=>u==q?!0:null)}allActions(p,q){var u=this.stateSlot(p,
4);u=u?q(u):void 0;for(p=this.stateSlot(p,1);null==u;p+=3){if(65535==this.data[p])if(1==this.data[p+1])p=qf(this.data,p+2);else break;u=q(qf(this.data,p+1))}return u}nextStates(p){let q=[];for(p=this.stateSlot(p,1);;p+=3){if(65535==this.data[p])if(1==this.data[p+1])p=qf(this.data,p+2);else break;if(0==(this.data[p+2]&1)){let u=this.data[p+1];q.some((w,y)=>y&1&&w==u)||q.push(this.data[p],u)}}return q}configure(p){let q=Object.assign(Object.create(n.prototype),this);if(p.props&&(q.nodeSet=this.nodeSet.extend(...p.props)),
p.top){let u=this.topRules[p.top];if(!u)throw new RangeError(`Invalid top rule name ${p.top}`);q.top=u}return p.tokenizers&&(q.tokenizers=this.tokenizers.map(u=>{let w=p.tokenizers.find(y=>y.from==u);return w?w.to:u})),p.specializers&&(q.specializers=this.specializers.slice(),q.specializerSpecs=this.specializerSpecs.map((u,w)=>{var y=p.specializers.find(B=>B.from==u.external);if(!y)return u;y=Object.assign(Object.assign({},u),{external:y.to});return q.specializers[w]=$l(y),y})),p.contextTracker&&
(q.context=p.contextTracker),p.dialect&&(q.dialect=this.parseDialect(p.dialect)),null!=p.strict&&(q.strict=p.strict),p.wrap&&(q.wrappers=q.wrappers.concat(p.wrap)),null!=p.bufferLength&&(q.bufferLength=p.bufferLength),q}hasWrappers(){return 0<this.wrappers.length}getName(p){return this.termNames?this.termNames[p]:String(p<=this.maxNode&&this.nodeSet.types[p].name||p)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(p){let q=this.dynamicPrecedences;
return null==q?0:q[p]||0}parseDialect(p){let q=Object.keys(this.dialects),u=q.map(()=>!1);if(p)for(var w of p.split(" ")){var y=q.indexOf(w);0<=y&&(u[y]=!0)}w=null;for(y=0;y<q.length;y++)if(!u[y])for(let B=this.dialects[q[y]],z;65535!=(z=this.data[B++]);)(w||=new Uint8Array(this.maxTerm+1))[z]=1;return new Bp(p,u,w)}static deserialize(p){return new n(p)}}}),Dp={};((n,p)=>{for(var q in p)Jj(n,q,{get:p[q],enumerable:!0})})(Dp,{parser:()=>Ep});var Fp,Ep,su=Lj(()=>{ru();Fp={__proto__:null,BEGIN:28,END:30,
PARBEGIN:32,PAREND:34};Ep=Cp.deserialize({version:14,states:"!dQYQPOOOOQO'#C^'#C^OOQO'#C`'#C`OOQO'#Ca'#CaOOQO'#Cb'#CbOkQPO'#CcOOQO'#Ci'#CiOOQO'#Cd'#CdQYQPOOOOQO,58},58}OOQO-E6b-E6b",stateData:"p~OZOS[OS~ORTO^PO_QO`ROaSO~ObXO~O",goto:"m^PP_P____cPPPPiTUOWQWORYWTVOW",nodeNames:"\u26a0 Program Begin Label End ParBegin ParEnd Call",maxTerm:18,skippedNodes:[0],repeatNodeCount:1,tokenData:"#w~R^X^}pq}!P!Q!r!]!^#a!c!}#f#T#o#f#y#z}$f$g}#BY#BZ}$IS$I_}$I|$JO}$JT$JU}$KV$KW}&FU&FV}~!SYZ~X^}pq}#y#z}$f$g}#BY#BZ}$IS$I_}$I|$JO}$JT$JU}$KV$KW}&FU&FV}~!uP!P!Q!x~!}S[~OY!xZ;'S!x;'S;=`#Z<%lO!x~#^P;=`<%l!x~#fOb~~#kSR~!Q![#f!c!}#f#R#S#f#T#o#f",
tokenizers:[0],topRules:{Program:[0,1]},specialized:[{term:3,get:n=>Fp[n]||-1}],tokenPrec:0})}),tu=va(n=>{Object.defineProperty(n,"__esModule",{value:!0});n.example="BEGIN\n  A;\n  PARBEGIN\n    BEGIN\n      B;\n      C;\n    END\n    BEGIN\n      D;\n      E;\n    END\n  PAREND;\n  F;\nEND\n"}),uu=va(n=>{Object.defineProperty(n,"__esModule",{value:!0});n.interpret=void 0;n.interpret=p=>{let q=[],u=(w,y=[])=>{if(!w)return[];switch(w.type){case "call":q.push({data:{id:w.id,label:w.label}});for(let z of y)q.push({data:{source:z.id,
target:w.id}});return[w];case "seq":y=[...y];if(Array.isArray(w.child))for(var B of w.child)y=u(B,y);return y;case "par":B=[];if(Array.isArray(w.child))for(let z of w.child)w=u(z,y),B=[...B,...w];return B;default:return y}};return u(p),q}}),vu=va(n=>{Object.defineProperty(n,"__esModule",{value:!0});n.parse=void 0;n.parse=(p,q)=>{let u=[],w=[];q=q.cursor();do switch(q.name){case "Begin":u.push("begin");w.push("[");break;case "End":"begin"!==u.pop()&&console.log("error");w.push("]");break;case "ParBegin":u.push("parbegin");
w.push("(");break;case "ParEnd":"parbegin"!==u.pop()&&console.log("error");w.push(")");break;case "Call":q.firstChild(),w.push(p.substr(q.from,q.to-q.from))}while(q.next());return w}}),wu=va(n=>{Object.defineProperty(n,"__esModule",{value:!0});n.stackify=void 0;n.stackify=p=>{let q=[],u=[];for(let w of p)if("["===w)q.push({type:"seq",child:u}),u=[];else if("("===w)q.push({type:"par",child:u}),u=[];else if("]"===w||")"===w){p=q.pop();let y={type:p.type,child:u};u=p.child;u.push(y)}else u.push({type:"call",
id:crypto.randomUUID(),label:w});return u[0]}});va(n=>{var p=n&&n.__importDefault||function(ha){return ha&&ha.__esModule?ha:{default:ha}};Object.defineProperty(n,"__esModule",{value:!0});n=Gg();var q=Up(),u=p(Yq()),w=p(pu()),y=(su(),Mp(Dp));p=tu();var B=uu(),z=vu(),E=wu();u.default.use(w.default);w=document.getElementById("editor");var H=document.getElementById("treeContainer"),T=ha=>{let Da=y.parser.parse(ha);ha=(0,z.parse)(ha,Da);ha=(0,E.stackify)(ha);ha=(0,B.interpret)(ha);(0,u.default)({container:H,
elements:ha,layout:{name:"dagre"},style:[{selector:"node",style:{label:"data(label)","background-color":"white","border-width":1}},{selector:"edge",style:{"curve-style":"straight","target-arrow-shape":"triangle","target-arrow-color":"black","line-color":"black",width:1}},{selector:"label",style:{"text-halign":"center","text-valign":"center"}}]})},ca=n.EditorView.updateListener.of(ha=>{ha.docChanged&&(ha=ha.state.doc.toString(),document.location.hash=encodeURI(ha),T(ha))});p=decodeURI(document.location.hash.substring(1))||
p.example;new n.EditorView({extensions:[q.basicSetup,ca],parent:w,doc:p});T(p)})()})();
