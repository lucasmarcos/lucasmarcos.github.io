"use strict";(()=>{var Wn=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var O=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Xb=O(md=>{"use strict";var vd=[],Gb=[];(()=>{let t="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,r=0;e<t.length;e++)(e%2?Gb:vd).push(r=r+t[e])})();function Kb(t){if(t<768)return!1;for(let e=0,r=vd.length;;){let n=e+r>>1;if(t<vd[n])r=n;else if(t>=Gb[n])e=n+1;else return!0;if(e==r)return!1}}function Hb(t){return t>=127462&&t<=127487}var Ub=8205;function mq(t,e,r=!0,n=!0){return(r?jb:yq)(t,e,n)}function jb(t,e,r){if(e==t.length)return e;e&&Yb(t.charCodeAt(e))&&Zb(t.charCodeAt(e-1))&&e--;let n=gd(t,e);for(e+=Wb(n);e<t.length;){let a=gd(t,e);if(n==Ub||a==Ub||r&&Kb(a))e+=Wb(a),n=a;else if(Hb(a)){let s=0,o=e-2;for(;o>=0&&Hb(gd(t,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function yq(t,e,r){for(;e>0;){let n=jb(t,e-2,r);if(n<e)return n;e--}return 0}function gd(t,e){let r=t.charCodeAt(e);if(!Zb(r)||e+1==t.length)return r;let n=t.charCodeAt(e+1);return Yb(n)?(r-55296<<10)+(n-56320)+65536:r}function Yb(t){return t>=56320&&t<57344}function Zb(t){return t>=55296&&t<56320}function Wb(t){return t<65536?1:2}md.findClusterBreak=mq;md.isExtendingChar=Kb});var gi=O(Re=>{"use strict";var bq=Xb(),It=class t{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,r,n){[e,r]=ts(this,e,r);let a=[];return this.decompose(0,e,a,2),n.length&&n.decompose(0,n.length,a,3),this.decompose(r,this.length,a,1),Qa.from(a,this.length-(r-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,r=this.length){[e,r]=ts(this,e,r);let n=[];return this.decompose(e,r,n,0),Qa.from(n,r-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let r=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),a=new na(this),s=new na(e);for(let o=r,l=r;;){if(a.next(o),s.next(o),o=0,a.lineBreak!=s.lineBreak||a.done!=s.done||a.value!=s.value)return!1;if(l+=a.value.length,a.done||l>=n)return!0}}iter(e=1){return new na(this,e)}iterRange(e,r=this.length){return new qu(this,e,r)}iterLines(e,r){let n;if(e==null)n=this.iter();else{r==null&&(r=this.lines+1);let a=this.line(e).from;n=this.iterRange(a,Math.max(a,r==this.lines+1?this.length:r<=1?0:this.line(r-1).to))}return new Vu(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?t.empty:e.length<=32?new Lr(e):Qa.from(Lr.split(e,[]))}},Lr=class t extends It{constructor(e,r=wq(e)){super(),this.text=e,this.length=r}get lines(){return this.text.length}get children(){return null}lineInner(e,r,n,a){for(let s=0;;s++){let o=this.text[s],l=a+o.length;if((r?n:l)>=e)return new zu(a,l,n,o);a=l+1,n++}}decompose(e,r,n,a){let s=e<=0&&r>=this.length?this:new t($b(this.text,e,r),Math.min(r,this.length)-Math.max(0,e));if(a&1){let o=n.pop(),l=Fu(s.text,o.text.slice(),0,s.length);if(l.length<=32)n.push(new t(l,o.length+s.length));else{let u=l.length>>1;n.push(new t(l.slice(0,u)),new t(l.slice(u)))}}else n.push(s)}replace(e,r,n){if(!(n instanceof t))return super.replace(e,r,n);[e,r]=ts(this,e,r);let a=Fu(this.text,Fu(n.text,$b(this.text,0,e)),r),s=this.length+n.length-(r-e);return a.length<=32?new t(a,s):Qa.from(t.split(a,[]),s)}sliceString(e,r=this.length,n=`
`){[e,r]=ts(this,e,r);let a="";for(let s=0,o=0;s<=r&&o<this.text.length;o++){let l=this.text[o],u=s+l.length;s>e&&o&&(a+=n),e<u&&r>s&&(a+=l.slice(Math.max(0,e-s),r-s)),s=u+1}return a}flatten(e){for(let r of this.text)e.push(r)}scanIdentical(){return 0}static split(e,r){let n=[],a=-1;for(let s of e)n.push(s),a+=s.length+1,n.length==32&&(r.push(new t(n,a)),n=[],a=-1);return a>-1&&r.push(new t(n,a)),r}},Qa=class t extends It{constructor(e,r){super(),this.children=e,this.length=r,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,r,n,a){for(let s=0;;s++){let o=this.children[s],l=a+o.length,u=n+o.lines-1;if((r?u:l)>=e)return o.lineInner(e,r,n,a);a=l+1,n=u+1}}decompose(e,r,n,a){for(let s=0,o=0;o<=r&&s<this.children.length;s++){let l=this.children[s],u=o+l.length;if(e<=u&&r>=o){let c=a&((o<=e?1:0)|(u>=r?2:0));o>=e&&u<=r&&!c?n.push(l):l.decompose(e-o,r-o,n,c)}o=u+1}}replace(e,r,n){if([e,r]=ts(this,e,r),n.lines<this.lines)for(let a=0,s=0;a<this.children.length;a++){let o=this.children[a],l=s+o.length;if(e>=s&&r<=l){let u=o.replace(e-s,r-s,n),c=this.lines-o.lines+u.lines;if(u.lines<c>>4&&u.lines>c>>6){let f=this.children.slice();return f[a]=u,new t(f,this.length-(r-e)+n.length)}return super.replace(s,l,u)}s=l+1}return super.replace(e,r,n)}sliceString(e,r=this.length,n=`
`){[e,r]=ts(this,e,r);let a="";for(let s=0,o=0;s<this.children.length&&o<=r;s++){let l=this.children[s],u=o+l.length;o>e&&s&&(a+=n),e<u&&r>o&&(a+=l.sliceString(e-o,r-o,n)),o=u+1}return a}flatten(e){for(let r of this.children)r.flatten(e)}scanIdentical(e,r){if(!(e instanceof t))return 0;let n=0,[a,s,o,l]=r>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;a+=r,s+=r){if(a==o||s==l)return n;let u=this.children[a],c=e.children[s];if(u!=c)return n+u.scanIdentical(c,r);n+=u.length+1}}static from(e,r=e.reduce((n,a)=>n+a.length+1,-1)){let n=0;for(let p of e)n+=p.lines;if(n<32){let p=[];for(let g of e)g.flatten(p);return new Lr(p,r)}let a=Math.max(32,n>>5),s=a<<1,o=a>>1,l=[],u=0,c=-1,f=[];function h(p){let g;if(p.lines>s&&p instanceof t)for(let m of p.children)h(m);else p.lines>o&&(u>o||!u)?(d(),l.push(p)):p instanceof Lr&&u&&(g=f[f.length-1])instanceof Lr&&p.lines+g.lines<=32?(u+=p.lines,c+=p.length+1,f[f.length-1]=new Lr(g.text.concat(p.text),g.length+1+p.length)):(u+p.lines>a&&d(),u+=p.lines,c+=p.length+1,f.push(p))}function d(){u!=0&&(l.push(f.length==1?f[0]:t.from(f,c)),c=-1,u=f.length=0)}for(let p of e)h(p);return d(),l.length==1?l[0]:new t(l,r)}};It.empty=new Lr([""],0);function wq(t){let e=-1;for(let r of t)e+=r.length+1;return e}function Fu(t,e,r=0,n=1e9){for(let a=0,s=0,o=!0;s<t.length&&a<=n;s++){let l=t[s],u=a+l.length;u>=r&&(u>n&&(l=l.slice(0,n-a)),a<r&&(l=l.slice(r-a)),o?(e[e.length-1]+=l,o=!1):e.push(l)),a=u+1}return e}function $b(t,e,r){return Fu(t,[""],e,r)}var na=class{constructor(e,r=1){this.dir=r,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[r>0?1:(e instanceof Lr?e.text.length:e.children.length)<<1]}nextInner(e,r){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,a=this.nodes[n],s=this.offsets[n],o=s>>1,l=a instanceof Lr?a.text.length:a.children.length;if(o==(r>0?l:0)){if(n==0)return this.done=!0,this.value="",this;r>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(r>0?0:1)){if(this.offsets[n]+=r,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(a instanceof Lr){let u=a.text[o+(r<0?-1:0)];if(this.offsets[n]+=r,u.length>Math.max(0,e))return this.value=e==0?u:r>0?u.slice(e):u.slice(0,u.length-e),this;e-=u.length}else{let u=a.children[o+(r<0?-1:0)];e>u.length?(e-=u.length,this.offsets[n]+=r):(r<0&&this.offsets[n]--,this.nodes.push(u),this.offsets.push(r>0?1:(u instanceof Lr?u.text.length:u.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}},qu=class{constructor(e,r,n){this.value="",this.done=!1,this.cursor=new na(e,r>n?-1:1),this.pos=r>n?e.length:0,this.from=Math.min(r,n),this.to=Math.max(r,n)}nextInner(e,r){if(r<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,r<0?this.pos-this.to:this.from-this.pos);let n=r<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:a}=this.cursor.next(e);return this.pos+=(a.length+e)*r,this.value=a.length<=n?a:r<0?a.slice(a.length-n):a.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}},Vu=class{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:r,lineBreak:n,value:a}=this.inner.next(e);return r&&this.afterBreak?(this.value="",this.afterBreak=!1):r?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=a,this.afterBreak=!1),this}get lineBreak(){return!1}};typeof Symbol<"u"&&(It.prototype[Symbol.iterator]=function(){return this.iter()},na.prototype[Symbol.iterator]=qu.prototype[Symbol.iterator]=Vu.prototype[Symbol.iterator]=function(){return this});var zu=class{constructor(e,r,n,a){this.from=e,this.to=r,this.number=n,this.text=a}get length(){return this.to-this.from}};function ts(t,e,r){return e=Math.max(0,Math.min(t.length,e)),[e,Math.max(e,Math.min(t.length,r))]}function mo(t,e,r=!0,n=!0){return bq.findClusterBreak(t,e,r,n)}function _q(t){return t>=56320&&t<57344}function xq(t){return t>=55296&&t<56320}function Eq(t,e){let r=t.charCodeAt(e);if(!xq(r)||e+1==t.length)return r;let n=t.charCodeAt(e+1);return _q(n)?(r-55296<<10)+(n-56320)+65536:r}function Sq(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10)+55296,(t&1023)+56320))}function Cq(t){return t<65536?1:2}var bd=/\r\n?|\n/;Re.MapMode=void 0;(function(t){t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter"})(Re.MapMode||(Re.MapMode={}));var di=class t{constructor(e){this.sections=e}get length(){let e=0;for(let r=0;r<this.sections.length;r+=2)e+=this.sections[r];return e}get newLength(){let e=0;for(let r=0;r<this.sections.length;r+=2){let n=this.sections[r+1];e+=n<0?this.sections[r]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let r=0,n=0,a=0;r<this.sections.length;){let s=this.sections[r++],o=this.sections[r++];o<0?(e(n,a,s),a+=s):a+=o,n+=s}}iterChangedRanges(e,r=!1){wd(this,e,r)}get invertedDesc(){let e=[];for(let r=0;r<this.sections.length;){let n=this.sections[r++],a=this.sections[r++];a<0?e.push(n,a):e.push(a,n)}return new t(e)}composeDesc(e){return this.empty?e:e.empty?this:rw(this,e)}mapDesc(e,r=!1){return e.empty?this:_d(this,e,r)}mapPos(e,r=-1,n=Re.MapMode.Simple){let a=0,s=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],u=this.sections[o++],c=a+l;if(u<0){if(c>e)return s+(e-a);s+=l}else{if(n!=Re.MapMode.Simple&&c>=e&&(n==Re.MapMode.TrackDel&&a<e&&c>e||n==Re.MapMode.TrackBefore&&a<e||n==Re.MapMode.TrackAfter&&c>e))return null;if(c>e||c==e&&r<0&&!l)return e==a||r<0?s:s+u;s+=u}a=c}if(e>a)throw new RangeError(`Position ${e} is out of range for changeset of length ${a}`);return s}touchesRange(e,r=e){for(let n=0,a=0;n<this.sections.length&&a<=r;){let s=this.sections[n++],o=this.sections[n++],l=a+s;if(o>=0&&a<=r&&l>=e)return a<e&&l>r?"cover":!0;a=l}return!1}toString(){let e="";for(let r=0;r<this.sections.length;){let n=this.sections[r++],a=this.sections[r++];e+=(e?" ":"")+n+(a>=0?":"+a:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(r=>typeof r!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new t(e)}static create(e){return new t(e)}},on=class t extends di{constructor(e,r){super(e),this.inserted=r}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return wd(this,(r,n,a,s,o)=>e=e.replace(a,a+(n-r),o),!1),e}mapDesc(e,r=!1){return _d(this,e,r,!0)}invert(e){let r=this.sections.slice(),n=[];for(let a=0,s=0;a<r.length;a+=2){let o=r[a],l=r[a+1];if(l>=0){r[a]=l,r[a+1]=o;let u=a>>1;for(;n.length<u;)n.push(It.empty);n.push(o?e.slice(s,s+o):It.empty)}s+=o}return new t(r,n)}compose(e){return this.empty?e:e.empty?this:rw(this,e,!0)}map(e,r=!1){return e.empty?this:_d(this,e,r,!0)}iterChanges(e,r=!1){wd(this,e,r)}get desc(){return di.create(this.sections)}filter(e){let r=[],n=[],a=[],s=new ia(this);e:for(let o=0,l=0;;){let u=o==e.length?1e9:e[o++];for(;l<u||l==u&&s.len==0;){if(s.done)break e;let f=Math.min(s.len,u-l);lr(a,f,-1);let h=s.ins==-1?-1:s.off==0?s.ins:0;lr(r,f,h),h>0&&hi(n,r,s.text),s.forward(f),l+=f}let c=e[o++];for(;l<c;){if(s.done)break e;let f=Math.min(s.len,c-l);lr(r,f,-1),lr(a,f,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(f),l+=f}}return{changes:new t(r,n),filtered:di.create(a)}}toJSON(){let e=[];for(let r=0;r<this.sections.length;r+=2){let n=this.sections[r],a=this.sections[r+1];a<0?e.push(n):a==0?e.push([n]):e.push([n].concat(this.inserted[r>>1].toJSON()))}return e}static of(e,r,n){let a=[],s=[],o=0,l=null;function u(f=!1){if(!f&&!a.length)return;o<r&&lr(a,r-o,-1);let h=new t(a,s);l=l?l.compose(h.map(l)):h,a=[],s=[],o=0}function c(f){if(Array.isArray(f))for(let h of f)c(h);else if(f instanceof t){if(f.length!=r)throw new RangeError(`Mismatched change set length (got ${f.length}, expected ${r})`);u(),l=l?l.compose(f.map(l)):f}else{let{from:h,to:d=h,insert:p}=f;if(h>d||h<0||d>r)throw new RangeError(`Invalid change range ${h} to ${d} (in doc of length ${r})`);let g=p?typeof p=="string"?It.of(p.split(n||bd)):p:It.empty,m=g.length;if(h==d&&m==0)return;h<o&&u(),h>o&&lr(a,h-o,-1),lr(a,d-h,m),hi(s,a,g),o=d}}return c(e),u(!l),l}static empty(e){return new t(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let r=[],n=[];for(let a=0;a<e.length;a++){let s=e[a];if(typeof s=="number")r.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)r.push(s[0],0);else{for(;n.length<a;)n.push(It.empty);n[a]=It.of(s.slice(1)),r.push(s[0],n[a].length)}}}return new t(r,n)}static createSet(e,r){return new t(e,r)}};function lr(t,e,r,n=!1){if(e==0&&r<=0)return;let a=t.length-2;a>=0&&r<=0&&r==t[a+1]?t[a]+=e:a>=0&&e==0&&t[a]==0?t[a+1]+=r:n?(t[a]+=e,t[a+1]+=r):t.push(e,r)}function hi(t,e,r){if(r.length==0)return;let n=e.length-2>>1;if(n<t.length)t[t.length-1]=t[t.length-1].append(r);else{for(;t.length<n;)t.push(It.empty);t.push(r)}}function wd(t,e,r){let n=t.inserted;for(let a=0,s=0,o=0;o<t.sections.length;){let l=t.sections[o++],u=t.sections[o++];if(u<0)a+=l,s+=l;else{let c=a,f=s,h=It.empty;for(;c+=l,f+=u,u&&n&&(h=h.append(n[o-2>>1])),!(r||o==t.sections.length||t.sections[o+1]<0);)l=t.sections[o++],u=t.sections[o++];e(a,c,s,f,h),a=c,s=f}}}function _d(t,e,r,n=!1){let a=[],s=n?[]:null,o=new ia(t),l=new ia(e);for(let u=-1;;){if(o.done&&l.len||l.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&l.ins==-1){let c=Math.min(o.len,l.len);lr(a,c,-1),o.forward(c),l.forward(c)}else if(l.ins>=0&&(o.ins<0||u==o.i||o.off==0&&(l.len<o.len||l.len==o.len&&!r))){let c=l.len;for(lr(a,l.ins,-1);c;){let f=Math.min(o.len,c);o.ins>=0&&u<o.i&&o.len<=f&&(lr(a,0,o.ins),s&&hi(s,a,o.text),u=o.i),o.forward(f),c-=f}l.next()}else if(o.ins>=0){let c=0,f=o.len;for(;f;)if(l.ins==-1){let h=Math.min(f,l.len);c+=h,f-=h,l.forward(h)}else if(l.ins==0&&l.len<f)f-=l.len,l.next();else break;lr(a,c,u<o.i?o.ins:0),s&&u<o.i&&hi(s,a,o.text),u=o.i,o.forward(o.len-f)}else{if(o.done&&l.done)return s?on.createSet(a,s):di.create(a);throw new Error("Mismatched change set lengths")}}}function rw(t,e,r=!1){let n=[],a=r?[]:null,s=new ia(t),o=new ia(e);for(let l=!1;;){if(s.done&&o.done)return a?on.createSet(n,a):di.create(n);if(s.ins==0)lr(n,s.len,0,l),s.next();else if(o.len==0&&!o.done)lr(n,0,o.ins,l),a&&hi(a,n,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let u=Math.min(s.len2,o.len),c=n.length;if(s.ins==-1){let f=o.ins==-1?-1:o.off?0:o.ins;lr(n,u,f,l),a&&f&&hi(a,n,o.text)}else o.ins==-1?(lr(n,s.off?0:s.len,u,l),a&&hi(a,n,s.textBit(u))):(lr(n,s.off?0:s.len,o.off?0:o.ins,l),a&&!o.off&&hi(a,n,o.text));l=(s.ins>u||o.ins>=0&&o.len>u)&&(l||n.length>c),s.forward2(u),o.forward(u)}}}}var ia=class{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,r=this.i-2>>1;return r>=e.length?It.empty:e[r]}textBit(e){let{inserted:r}=this.set,n=this.i-2>>1;return n>=r.length&&!e?It.empty:r[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}},ra=class t{constructor(e,r,n){this.from=e,this.to=r,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,r=-1){let n,a;return this.empty?n=a=e.mapPos(this.from,r):(n=e.mapPos(this.from,1),a=e.mapPos(this.to,-1)),n==this.from&&a==this.to?this:new t(n,a,this.flags)}extend(e,r=e){if(e<=this.anchor&&r>=this.anchor)return mr.range(e,r);let n=Math.abs(e-this.anchor)>Math.abs(r-this.anchor)?e:r;return mr.range(this.anchor,n)}eq(e,r=!1){return this.anchor==e.anchor&&this.head==e.head&&(!r||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return mr.range(e.anchor,e.head)}static create(e,r,n){return new t(e,r,n)}},mr=class t{constructor(e,r){this.ranges=e,this.mainIndex=r}map(e,r=-1){return e.empty?this:t.create(this.ranges.map(n=>n.map(e,r)),this.mainIndex)}eq(e,r=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],r))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new t([this.main],0)}addRange(e,r=!0){return t.create([e].concat(this.ranges),r?0:this.mainIndex+1)}replaceRange(e,r=this.mainIndex){let n=this.ranges.slice();return n[r]=e,t.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new t(e.ranges.map(r=>ra.fromJSON(r)),e.main)}static single(e,r=e){return new t([t.range(e,r)],0)}static create(e,r=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,a=0;a<e.length;a++){let s=e[a];if(s.empty?s.from<=n:s.from<n)return t.normalized(e.slice(),r);n=s.to}return new t(e,r)}static cursor(e,r=0,n,a){return ra.create(e,e,(r==0?0:r<0?8:16)|(n==null?7:Math.min(6,n))|(a??16777215)<<6)}static range(e,r,n,a){let s=(n??16777215)<<6|(a==null?7:Math.min(6,a));return r<e?ra.create(r,e,48|s):ra.create(e,r,(r>e?8:0)|s)}static normalized(e,r=0){let n=e[r];e.sort((a,s)=>a.from-s.from),r=e.indexOf(n);for(let a=1;a<e.length;a++){let s=e[a],o=e[a-1];if(s.empty?s.from<=o.to:s.from<o.to){let l=o.from,u=Math.max(s.to,o.to);a<=r&&r--,e.splice(--a,2,s.anchor>s.head?t.range(u,l):t.range(l,u))}}return new t(e,r)}};function nw(t,e){for(let r of t.ranges)if(r.to>e)throw new RangeError("Selection points outside of document")}var Md=0,Cr=class t{constructor(e,r,n,a,s){this.combine=e,this.compareInput=r,this.compare=n,this.isStatic=a,this.id=Md++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new t(e.combine||(r=>r),e.compareInput||((r,n)=>r===n),e.compare||(e.combine?(r,n)=>r===n:Pd),!!e.static,e.enables)}of(e){return new Ja([],this,0,e)}compute(e,r){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ja(e,this,1,r)}computeN(e,r){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ja(e,this,2,r)}from(e,r){return r||(r=n=>n),this.compute([e],n=>r(n.field(e)))}};function Pd(t,e){return t==e||t.length==e.length&&t.every((r,n)=>r===e[n])}var Ja=class{constructor(e,r,n,a){this.dependencies=e,this.facet=r,this.type=n,this.value=a,this.id=Md++}dynamicSlot(e){var r;let n=this.value,a=this.facet.compareInput,s=this.id,o=e[s]>>1,l=this.type==2,u=!1,c=!1,f=[];for(let h of this.dependencies)h=="doc"?u=!0:h=="selection"?c=!0:(((r=e[h.id])!==null&&r!==void 0?r:1)&1)==0&&f.push(e[h.id]);return{create(h){return h.values[o]=n(h),1},update(h,d){if(u&&d.docChanged||c&&(d.docChanged||d.selection)||xd(h,f)){let p=n(h);if(l?!Qb(p,h.values[o],a):!a(p,h.values[o]))return h.values[o]=p,1}return 0},reconfigure:(h,d)=>{let p,g=d.config.address[s];if(g!=null){let m=Wu(d,g);if(this.dependencies.every(v=>v instanceof Cr?d.facet(v)===h.facet(v):v instanceof aa?d.field(v,!1)==h.field(v,!1):!0)||(l?Qb(p=n(h),m,a):a(p=n(h),m)))return h.values[o]=m,0}else p=n(h);return h.values[o]=p,1}}}};function Qb(t,e,r){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!r(t[n],e[n]))return!1;return!0}function xd(t,e){let r=!1;for(let n of e)vo(t,n)&1&&(r=!0);return r}function Tq(t,e,r){let n=r.map(u=>t[u.id]),a=r.map(u=>u.type),s=n.filter(u=>!(u&1)),o=t[e.id]>>1;function l(u){let c=[];for(let f=0;f<n.length;f++){let h=Wu(u,n[f]);if(a[f]==2)for(let d of h)c.push(d);else c.push(h)}return e.combine(c)}return{create(u){for(let c of n)vo(u,c);return u.values[o]=l(u),1},update(u,c){if(!xd(u,s))return 0;let f=l(u);return e.compare(f,u.values[o])?0:(u.values[o]=f,1)},reconfigure(u,c){let f=xd(u,n),h=c.config.facets[e.id],d=c.facet(e);if(h&&!f&&Pd(r,h))return u.values[o]=d,0;let p=l(u);return e.compare(p,d)?(u.values[o]=d,0):(u.values[o]=p,1)}}}var Bu=Cr.define({static:!0}),aa=class t{constructor(e,r,n,a,s){this.id=e,this.createF=r,this.updateF=n,this.compareF=a,this.spec=s,this.provides=void 0}static define(e){let r=new t(Md++,e.create,e.update,e.compare||((n,a)=>n===a),e);return e.provide&&(r.provides=e.provide(r)),r}create(e){let r=e.facet(Bu).find(n=>n.field==this);return(r?.create||this.createF)(e)}slot(e){let r=e[this.id]>>1;return{create:n=>(n.values[r]=this.create(n),1),update:(n,a)=>{let s=n.values[r],o=this.updateF(s,a);return this.compareF(s,o)?0:(n.values[r]=o,1)},reconfigure:(n,a)=>{let s=n.facet(Bu),o=a.facet(Bu),l;return(l=s.find(u=>u.field==this))&&l!=o.find(u=>u.field==this)?(n.values[r]=l.create(n),1):a.config.address[this.id]!=null?(n.values[r]=a.field(this),0):(n.values[r]=this.create(n),1)}}}init(e){return[this,Bu.of({field:this,create:e})]}get extension(){return this}},ea={lowest:4,low:3,default:2,high:1,highest:0};function go(t){return e=>new Hu(e,t)}var kq={highest:go(ea.highest),high:go(ea.high),default:go(ea.default),low:go(ea.low),lowest:go(ea.lowest)},Hu=class{constructor(e,r){this.inner=e,this.prec=r}},yo=class t{of(e){return new bo(this,e)}reconfigure(e){return t.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}},bo=class{constructor(e,r){this.compartment=e,this.inner=r}},Uu=class t{constructor(e,r,n,a,s,o){for(this.base=e,this.compartments=r,this.dynamicSlots=n,this.address=a,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let r=this.address[e.id];return r==null?e.default:this.staticValues[r>>1]}static resolve(e,r,n){let a=[],s=Object.create(null),o=new Map;for(let d of Aq(e,r,o))d instanceof aa?a.push(d):(s[d.facet.id]||(s[d.facet.id]=[])).push(d);let l=Object.create(null),u=[],c=[];for(let d of a)l[d.id]=c.length<<1,c.push(p=>d.slot(p));let f=n?.config.facets;for(let d in s){let p=s[d],g=p[0].facet,m=f&&f[d]||[];if(p.every(v=>v.type==0))if(l[g.id]=u.length<<1|1,Pd(m,p))u.push(n.facet(g));else{let v=g.combine(p.map(y=>y.value));u.push(n&&g.compare(v,n.facet(g))?n.facet(g):v)}else{for(let v of p)v.type==0?(l[v.id]=u.length<<1|1,u.push(v.value)):(l[v.id]=c.length<<1,c.push(y=>v.dynamicSlot(y)));l[g.id]=c.length<<1,c.push(v=>Tq(v,g,p))}}let h=c.map(d=>d(l));return new t(e,o,h,l,u,s)}};function Aq(t,e,r){let n=[[],[],[],[],[]],a=new Map;function s(o,l){let u=a.get(o);if(u!=null){if(u<=l)return;let c=n[u].indexOf(o);c>-1&&n[u].splice(c,1),o instanceof bo&&r.delete(o.compartment)}if(a.set(o,l),Array.isArray(o))for(let c of o)s(c,l);else if(o instanceof bo){if(r.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(o.compartment)||o.inner;r.set(o.compartment,c),s(c,l)}else if(o instanceof Hu)s(o.inner,o.prec);else if(o instanceof aa)n[l].push(o),o.provides&&s(o.provides,l);else if(o instanceof Ja)n[l].push(o),o.facet.extensions&&s(o.facet.extensions,ea.default);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(c,l)}}return s(t,ea.default),n.reduce((o,l)=>o.concat(l))}function vo(t,e){if(e&1)return 2;let r=e>>1,n=t.status[r];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;t.status[r]=4;let a=t.computeSlot(t,t.config.dynamicSlots[r]);return t.status[r]=2|a}function Wu(t,e){return e&1?t.config.staticValues[e>>1]:t.values[e>>1]}var iw=Cr.define(),Ed=Cr.define({combine:t=>t.some(e=>e),static:!0}),aw=Cr.define({combine:t=>t.length?t[0]:void 0,static:!0}),sw=Cr.define(),ow=Cr.define(),lw=Cr.define(),uw=Cr.define({combine:t=>t.length?t[0]:!1}),pi=class{constructor(e,r){this.type=e,this.value=r}static define(){return new Gu}},Gu=class{of(e){return new pi(this,e)}},Ku=class{constructor(e){this.map=e}of(e){return new ur(this,e)}},ur=class t{constructor(e,r){this.type=e,this.value=r}map(e){let r=this.type.map(this.value,e);return r===void 0?void 0:r==this.value?this:new t(this.type,r)}is(e){return this.type==e}static define(e={}){return new Ku(e.map||(r=>r))}static mapEffects(e,r){if(!e.length)return e;let n=[];for(let a of e){let s=a.map(r);s&&n.push(s)}return n}};ur.reconfigure=ur.define();ur.appendConfig=ur.define();var Nr=class t{constructor(e,r,n,a,s,o){this.startState=e,this.changes=r,this.selection=n,this.effects=a,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,n&&nw(n,r.newLength),s.some(l=>l.type==t.time)||(this.annotations=s.concat(t.time.of(Date.now())))}static create(e,r,n,a,s,o){return new t(e,r,n,a,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let r of this.annotations)if(r.type==e)return r.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let r=this.annotation(t.userEvent);return!!(r&&(r==e||r.length>e.length&&r.slice(0,e.length)==e&&r[e.length]=="."))}};Nr.time=pi.define();Nr.userEvent=pi.define();Nr.addToHistory=pi.define();Nr.remote=pi.define();function Mq(t,e){let r=[];for(let n=0,a=0;;){let s,o;if(n<t.length&&(a==e.length||e[a]>=t[n]))s=t[n++],o=t[n++];else if(a<e.length)s=e[a++],o=e[a++];else return r;!r.length||r[r.length-1]<s?r.push(s,o):r[r.length-1]<o&&(r[r.length-1]=o)}}function cw(t,e,r){var n;let a,s,o;return r?(a=e.changes,s=on.empty(e.changes.length),o=t.changes.compose(e.changes)):(a=e.changes.map(t.changes),s=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(a)),{changes:o,selection:e.selection?e.selection.map(s):(n=t.selection)===null||n===void 0?void 0:n.map(a),effects:ur.mapEffects(t.effects,a).concat(ur.mapEffects(e.effects,s)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function Sd(t,e,r){let n=e.selection,a=es(e.annotations);return e.userEvent&&(a=a.concat(Nr.userEvent.of(e.userEvent))),{changes:e.changes instanceof on?e.changes:on.of(e.changes||[],r,t.facet(aw)),selection:n&&(n instanceof mr?n:mr.single(n.anchor,n.head)),effects:es(e.effects),annotations:a,scrollIntoView:!!e.scrollIntoView}}function fw(t,e,r){let n=Sd(t,e.length?e[0]:{},t.doc.length);e.length&&e[0].filter===!1&&(r=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(r=!1);let o=!!e[s].sequential;n=cw(n,Sd(t,e[s],o?n.changes.newLength:t.doc.length),o)}let a=Nr.create(t,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return Rq(r?Pq(a):a)}function Pq(t){let e=t.startState,r=!0;for(let a of e.facet(sw)){let s=a(t);if(s===!1){r=!1;break}Array.isArray(s)&&(r=r===!0?s:Mq(r,s))}if(r!==!0){let a,s;if(r===!1)s=t.changes.invertedDesc,a=on.empty(e.doc.length);else{let o=t.changes.filter(r);a=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}t=Nr.create(e,a,t.selection&&t.selection.map(s),ur.mapEffects(t.effects,s),t.annotations,t.scrollIntoView)}let n=e.facet(ow);for(let a=n.length-1;a>=0;a--){let s=n[a](t);s instanceof Nr?t=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Nr?t=s[0]:t=fw(e,es(s),!1)}return t}function Rq(t){let e=t.startState,r=e.facet(lw),n=t;for(let a=r.length-1;a>=0;a--){let s=r[a](t);s&&Object.keys(s).length&&(n=cw(n,Sd(e,s,t.changes.newLength),!0))}return n==t?t:Nr.create(e,t.changes,t.selection,n.effects,n.annotations,n.scrollIntoView)}var Dq=[];function es(t){return t==null?Dq:Array.isArray(t)?t:[t]}Re.CharCategory=void 0;(function(t){t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other"})(Re.CharCategory||(Re.CharCategory={}));var Oq=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Cd;try{Cd=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Iq(t){if(Cd)return Cd.test(t);for(let e=0;e<t.length;e++){let r=t[e];if(/\w/.test(r)||r>"\x80"&&(r.toUpperCase()!=r.toLowerCase()||Oq.test(r)))return!0}return!1}function Bq(t){return e=>{if(!/\S/.test(e))return Re.CharCategory.Space;if(Iq(e))return Re.CharCategory.Word;for(let r=0;r<t.length;r++)if(e.indexOf(t[r])>-1)return Re.CharCategory.Word;return Re.CharCategory.Other}}var Kr=class t{constructor(e,r,n,a,s,o){this.config=e,this.doc=r,this.selection=n,this.values=a,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)vo(this,l<<1);this.computeSlot=null}field(e,r=!0){let n=this.config.address[e.id];if(n==null){if(r)throw new RangeError("Field is not present in this state");return}return vo(this,n),Wu(this,n)}update(...e){return fw(this,e,!0)}applyTransaction(e){let r=this.config,{base:n,compartments:a}=r;for(let l of e.effects)l.is(yo.reconfigure)?(r&&(a=new Map,r.compartments.forEach((u,c)=>a.set(c,u)),r=null),a.set(l.value.compartment,l.value.extension)):l.is(ur.reconfigure)?(r=null,n=l.value):l.is(ur.appendConfig)&&(r=null,n=es(n).concat(l.value));let s;r?s=e.startState.values.slice():(r=Uu.resolve(n,a,this),s=new t(r,this.doc,this.selection,r.dynamicSlots.map(()=>null),(u,c)=>c.reconfigure(u,this),null).values);let o=e.startState.facet(Ed)?e.newSelection:e.newSelection.asSingle();new t(r,e.newDoc,o,s,(l,u)=>u.update(l,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:e},range:mr.cursor(r.from+e.length)}))}changeByRange(e){let r=this.selection,n=e(r.ranges[0]),a=this.changes(n.changes),s=[n.range],o=es(n.effects);for(let l=1;l<r.ranges.length;l++){let u=e(r.ranges[l]),c=this.changes(u.changes),f=c.map(a);for(let d=0;d<l;d++)s[d]=s[d].map(f);let h=a.mapDesc(c,!0);s.push(u.range.map(h)),a=a.compose(f),o=ur.mapEffects(o,f).concat(ur.mapEffects(es(u.effects),h))}return{changes:a,selection:mr.create(s,r.mainIndex),effects:o}}changes(e=[]){return e instanceof on?e:on.of(e,this.doc.length,this.facet(t.lineSeparator))}toText(e){return It.of(e.split(this.facet(t.lineSeparator)||bd))}sliceDoc(e=0,r=this.doc.length){return this.doc.sliceString(e,r,this.lineBreak)}facet(e){let r=this.config.address[e.id];return r==null?e.default:(vo(this,r),Wu(this,r))}toJSON(e){let r={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let a=e[n];a instanceof aa&&this.config.address[a.id]!=null&&(r[n]=a.spec.toJSON(this.field(e[n]),this))}return r}static fromJSON(e,r={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let a=[];if(n){for(let s in n)if(Object.prototype.hasOwnProperty.call(e,s)){let o=n[s],l=e[s];a.push(o.init(u=>o.spec.fromJSON(l,u)))}}return t.create({doc:e.doc,selection:mr.fromJSON(e.selection),extensions:r.extensions?a.concat([r.extensions]):a})}static create(e={}){let r=Uu.resolve(e.extensions||[],new Map),n=e.doc instanceof It?e.doc:It.of((e.doc||"").split(r.staticFacet(t.lineSeparator)||bd)),a=e.selection?e.selection instanceof mr?e.selection:mr.single(e.selection.anchor,e.selection.head):mr.single(0);return nw(a,n.length),r.staticFacet(Ed)||(a=a.asSingle()),new t(r,n,a,r.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(t.tabSize)}get lineBreak(){return this.facet(t.lineSeparator)||`
`}get readOnly(){return this.facet(uw)}phrase(e,...r){for(let n of this.facet(t.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return r.length&&(e=e.replace(/\$(\$|\d*)/g,(n,a)=>{if(a=="$")return"$";let s=+(a||1);return!s||s>r.length?n:r[s-1]})),e}languageDataAt(e,r,n=-1){let a=[];for(let s of this.facet(iw))for(let o of s(this,r,n))Object.prototype.hasOwnProperty.call(o,e)&&a.push(o[e]);return a}charCategorizer(e){return Bq(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:r,from:n,length:a}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-n,l=e-n;for(;o>0;){let u=mo(r,o,!1);if(s(r.slice(u,o))!=Re.CharCategory.Word)break;o=u}for(;l<a;){let u=mo(r,l);if(s(r.slice(l,u))!=Re.CharCategory.Word)break;l=u}return o==l?null:mr.range(o+n,l+n)}};Kr.allowMultipleSelections=Ed;Kr.tabSize=Cr.define({combine:t=>t.length?t[0]:4});Kr.lineSeparator=aw;Kr.readOnly=uw;Kr.phrases=Cr.define({compare(t,e){let r=Object.keys(t),n=Object.keys(e);return r.length==n.length&&r.every(a=>t[a]==e[a])}});Kr.languageData=iw;Kr.changeFilter=sw;Kr.transactionFilter=ow;Kr.transactionExtender=lw;yo.reconfigure=ur.define();function Lq(t,e,r={}){let n={};for(let a of t)for(let s of Object.keys(a)){let o=a[s],l=n[s];if(l===void 0)n[s]=o;else if(!(l===o||o===void 0))if(Object.hasOwnProperty.call(r,s))n[s]=r[s](l,o);else throw new Error("Config merge conflict for field "+s)}for(let a in e)n[a]===void 0&&(n[a]=e[a]);return n}var sa=class{eq(e){return this==e}range(e,r=e){return rs.create(e,r,this)}};sa.prototype.startSide=sa.prototype.endSide=0;sa.prototype.point=!1;sa.prototype.mapMode=Re.MapMode.TrackDel;var rs=class t{constructor(e,r,n){this.from=e,this.to=r,this.value=n}static create(e,r,n){return new t(e,r,n)}};function Td(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}var kd=class t{constructor(e,r,n,a){this.from=e,this.to=r,this.value=n,this.maxPoint=a}get length(){return this.to[this.to.length-1]}findIndex(e,r,n,a=0){let s=n?this.to:this.from;for(let o=a,l=s.length;;){if(o==l)return o;let u=o+l>>1,c=s[u]-e||(n?this.value[u].endSide:this.value[u].startSide)-r;if(u==o)return c>=0?o:l;c>=0?l=u:o=u+1}}between(e,r,n,a){for(let s=this.findIndex(r,-1e9,!0),o=this.findIndex(n,1e9,!1,s);s<o;s++)if(a(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,r){let n=[],a=[],s=[],o=-1,l=-1;for(let u=0;u<this.value.length;u++){let c=this.value[u],f=this.from[u]+e,h=this.to[u]+e,d,p;if(f==h){let g=r.mapPos(f,c.startSide,c.mapMode);if(g==null||(d=p=g,c.startSide!=c.endSide&&(p=r.mapPos(f,c.endSide),p<d)))continue}else if(d=r.mapPos(f,c.startSide),p=r.mapPos(h,c.endSide),d>p||d==p&&c.startSide>0&&c.endSide<=0)continue;(p-d||c.endSide-c.startSide)<0||(o<0&&(o=d),c.point&&(l=Math.max(l,p-d)),n.push(c),a.push(d-o),s.push(p-o))}return{mapped:n.length?new t(a,s,n,l):null,pos:o}}},Gn=class t{constructor(e,r,n,a){this.chunkPos=e,this.chunk=r,this.nextLayer=n,this.maxPoint=a}static create(e,r,n,a){return new t(e,r,n,a)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let r of this.chunk)e+=r.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:r=[],sort:n=!1,filterFrom:a=0,filterTo:s=this.length}=e,o=e.filter;if(r.length==0&&!o)return this;if(n&&(r=r.slice().sort(Td)),this.isEmpty)return r.length?t.of(r):this;let l=new ju(this,null,-1).goto(0),u=0,c=[],f=new wo;for(;l.value||u<r.length;)if(u<r.length&&(l.from-r[u].from||l.startSide-r[u].value.startSide)>=0){let h=r[u++];f.addInner(h.from,h.to,h.value)||c.push(h)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(u==r.length||this.chunkEnd(l.chunkIndex)<r[u].from)&&(!o||a>this.chunkEnd(l.chunkIndex)||s<this.chunkPos[l.chunkIndex])&&f.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||a>l.to||s<l.from||o(l.from,l.to,l.value))&&(f.addInner(l.from,l.to,l.value)||c.push(rs.create(l.from,l.to,l.value))),l.next());return f.finishInner(this.nextLayer.isEmpty&&!c.length?t.empty:this.nextLayer.update({add:c,filter:o,filterFrom:a,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let r=[],n=[],a=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],u=this.chunk[o],c=e.touchesRange(l,l+u.length);if(c===!1)a=Math.max(a,u.maxPoint),r.push(u),n.push(e.mapPos(l));else if(c===!0){let{mapped:f,pos:h}=u.map(l,e);f&&(a=Math.max(a,f.maxPoint),r.push(f),n.push(h))}}let s=this.nextLayer.map(e);return r.length==0?s:new t(n,r,s||t.empty,a)}between(e,r,n){if(!this.isEmpty){for(let a=0;a<this.chunk.length;a++){let s=this.chunkPos[a],o=this.chunk[a];if(r>=s&&e<=s+o.length&&o.between(s,e-s,r-s,n)===!1)return}this.nextLayer.between(e,r,n)}}iter(e=0){return _o.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,r=0){return _o.from(e).goto(r)}static compare(e,r,n,a,s=-1){let o=e.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),l=r.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),u=Jb(o,l,n),c=new ta(o,u,s),f=new ta(l,u,s);n.iterGaps((h,d,p)=>ew(c,h,f,d,p,a)),n.empty&&n.length==0&&ew(c,0,f,0,0,a)}static eq(e,r,n=0,a){a==null&&(a=999999999);let s=e.filter(f=>!f.isEmpty&&r.indexOf(f)<0),o=r.filter(f=>!f.isEmpty&&e.indexOf(f)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let l=Jb(s,o),u=new ta(s,l,0).goto(n),c=new ta(o,l,0).goto(n);for(;;){if(u.to!=c.to||!Ad(u.active,c.active)||u.point&&(!c.point||!u.point.eq(c.point)))return!1;if(u.to>a)return!0;u.next(),c.next()}}static spans(e,r,n,a,s=-1){let o=new ta(e,null,s).goto(r),l=r,u=o.openStart;for(;;){let c=Math.min(o.to,n);if(o.point){let f=o.activeForPoint(o.to),h=o.pointFrom<r?f.length+1:o.point.startSide<0?f.length:Math.min(f.length,u);a.point(l,c,o.point,f,h,o.pointRank),u=Math.min(o.openEnd(c),f.length)}else c>l&&(a.span(l,c,o.active,u),u=o.openEnd(c));if(o.to>n)return u+(o.point&&o.to>n?1:0);l=o.to,o.next()}}static of(e,r=!1){let n=new wo;for(let a of e instanceof rs?[e]:r?Nq(e):e)n.add(a.from,a.to,a.value);return n.finish()}static join(e){if(!e.length)return t.empty;let r=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let a=e[n];a!=t.empty;a=a.nextLayer)r=new t(a.chunkPos,a.chunk,r,Math.max(a.maxPoint,r.maxPoint));return r}};Gn.empty=new Gn([],[],null,-1);function Nq(t){if(t.length>1)for(let e=t[0],r=1;r<t.length;r++){let n=t[r];if(Td(e,n)>0)return t.slice().sort(Td);e=n}return t}Gn.empty.nextLayer=Gn.empty;var wo=class t{finishChunk(e){this.chunks.push(new kd(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,r,n){this.addInner(e,r,n)||(this.nextLayer||(this.nextLayer=new t)).add(e,r,n)}addInner(e,r,n){let a=e-this.lastTo||n.startSide-this.last.endSide;if(a<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return a<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(r-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=r,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,r-e)),!0)}addChunk(e,r){if((e-this.lastTo||r.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,r.maxPoint),this.chunks.push(r),this.chunkPos.push(e);let n=r.value.length-1;return this.last=r.value[n],this.lastFrom=r.from[n]+e,this.lastTo=r.to[n]+e,!0}finish(){return this.finishInner(Gn.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let r=Gn.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,r}};function Jb(t,e,r){let n=new Map;for(let s of t)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&n.set(s.chunk[o],s.chunkPos[o]);let a=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let l=n.get(s.chunk[o]);l!=null&&(r?r.mapPos(l):l)==s.chunkPos[o]&&!r?.touchesRange(l,l+s.chunk[o].length)&&a.add(s.chunk[o])}return a}var ju=class{constructor(e,r,n,a=0){this.layer=e,this.skip=r,this.minPoint=n,this.rank=a}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,r=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,r,!1),this}gotoInner(e,r,n){for(;this.chunkIndex<this.layer.chunk.length;){let a=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(a)||this.layer.chunkEnd(this.chunkIndex)<e||a.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let a=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],r,!0);(!n||this.rangeIndex<a)&&this.setRangeIndex(a)}this.next()}forward(e,r){(this.to-e||this.endSide-r)<0&&this.gotoInner(e,r,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],r=this.layer.chunk[this.chunkIndex],n=e+r.from[this.rangeIndex];if(this.from=n,this.to=e+r.to[this.rangeIndex],this.value=r.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}},_o=class t{constructor(e){this.heap=e}static from(e,r=null,n=-1){let a=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=n&&a.push(new ju(o,r,n,s));return a.length==1?a[0]:new t(a)}get startSide(){return this.value?this.value.startSide:0}goto(e,r=-1e9){for(let n of this.heap)n.goto(e,r);for(let n=this.heap.length>>1;n>=0;n--)yd(this.heap,n);return this.next(),this}forward(e,r){for(let n of this.heap)n.forward(e,r);for(let n=this.heap.length>>1;n>=0;n--)yd(this.heap,n);(this.to-e||this.value.endSide-r)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),yd(this.heap,0)}}};function yd(t,e){for(let r=t[e];;){let n=(e<<1)+1;if(n>=t.length)break;let a=t[n];if(n+1<t.length&&a.compare(t[n+1])>=0&&(a=t[n+1],n++),r.compare(a)<0)break;t[n]=r,t[e]=a,e=n}}var ta=class{constructor(e,r,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=_o.from(e,r,n)}goto(e,r=-1e9){return this.cursor.goto(e,r),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=r,this.openStart=-1,this.next(),this}forward(e,r){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-r)<0;)this.removeActive(this.minActive);this.cursor.forward(e,r)}removeActive(e){Lu(this.active,e),Lu(this.activeTo,e),Lu(this.activeRank,e),this.minActive=tw(this.active,this.activeTo)}addActive(e){let r=0,{value:n,to:a,rank:s}=this.cursor;for(;r<this.activeRank.length&&(s-this.activeRank[r]||a-this.activeTo[r])>0;)r++;Nu(this.active,r,n),Nu(this.activeTo,r,a),Nu(this.activeRank,r,s),e&&Nu(e,r,this.cursor.from),this.minActive=tw(this.active,this.activeTo)}next(){let e=this.to,r=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let a=this.minActive;if(a>-1&&(this.activeTo[a]-this.cursor.from||this.active[a].endSide-this.cursor.startSide)<0){if(this.activeTo[a]>e){this.to=this.activeTo[a],this.endSide=this.active[a].endSide;break}this.removeActive(a),n&&Lu(n,a)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(n),this.cursor.next();else if(r&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let a=n.length-1;a>=0&&n[a]<e;a--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let r=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&r.push(this.active[n]);return r.reverse()}openEnd(e){let r=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)r++;return r}};function ew(t,e,r,n,a,s){t.goto(e),r.goto(n);let o=n+a,l=n,u=n-e;for(;;){let c=t.to+u-r.to,f=c||t.endSide-r.endSide,h=f<0?t.to+u:r.to,d=Math.min(h,o);if(t.point||r.point?t.point&&r.point&&(t.point==r.point||t.point.eq(r.point))&&Ad(t.activeForPoint(t.to),r.activeForPoint(r.to))||s.comparePoint(l,d,t.point,r.point):d>l&&!Ad(t.active,r.active)&&s.compareRange(l,d,t.active,r.active),h>o)break;(c||t.openEnd!=r.openEnd)&&s.boundChange&&s.boundChange(h),l=h,f<=0&&t.next(),f>=0&&r.next()}}function Ad(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!=e[r]&&!t[r].eq(e[r]))return!1;return!0}function Lu(t,e){for(let r=e,n=t.length-1;r<n;r++)t[r]=t[r+1];t.pop()}function Nu(t,e,r){for(let n=t.length-1;n>=e;n--)t[n+1]=t[n];t[e]=r}function tw(t,e){let r=-1,n=1e9;for(let a=0;a<e.length;a++)(e[a]-n||t[a].endSide-t[r].endSide)<0&&(r=a,n=e[a]);return r}function Fq(t,e,r=t.length){let n=0;for(let a=0;a<r&&a<t.length;)t.charCodeAt(a)==9?(n+=e-n%e,a++):(n++,a=mo(t,a));return n}function qq(t,e,r,n){for(let a=0,s=0;;){if(s>=e)return a;if(a==t.length)break;s+=t.charCodeAt(a)==9?r-s%r:1,a=mo(t,a)}return n===!0?-1:t.length}Re.Annotation=pi;Re.AnnotationType=Gu;Re.ChangeDesc=di;Re.ChangeSet=on;Re.Compartment=yo;Re.EditorSelection=mr;Re.EditorState=Kr;Re.Facet=Cr;Re.Line=zu;Re.Prec=kq;Re.Range=rs;Re.RangeSet=Gn;Re.RangeSetBuilder=wo;Re.RangeValue=sa;Re.SelectionRange=ra;Re.StateEffect=ur;Re.StateEffectType=Ku;Re.StateField=aa;Re.Text=It;Re.Transaction=Nr;Re.codePointAt=Eq;Re.codePointSize=Cq;Re.combineConfig=Lq;Re.countColumn=Fq;Re.findClusterBreak=mo;Re.findColumn=qq;Re.fromCodePoint=Sq});var Bd=O(gw=>{var Rd="\u037C",hw=typeof Symbol>"u"?"__"+Rd:Symbol.for(Rd),Dd=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),dw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{},Od=gw.StyleModule=function(e,r){this.rules=[];var n=r||{},a=n.finish;function s(u){return/^@/.test(u)?[u]:u.split(/,\s*/)}function o(u,c,f,h){var d=[],p=/^@(\w+)\b/.exec(u[0]),g=p&&p[1]=="keyframes";if(p&&c==null)return f.push(u[0]+";");for(var m in c){var v=c[m];if(/&/.test(m))o(m.split(/,\s*/).map(function(y){return u.map(function(b){return y.replace(/&/,b)})}).reduce(function(y,b){return y.concat(b)}),v,f);else if(v&&typeof v=="object"){if(!p)throw new RangeError("The value of a property ("+m+") should be a primitive value.");o(s(m),v,d,g)}else v!=null&&d.push(m.replace(/_.*/,"").replace(/[A-Z]/g,function(y){return"-"+y.toLowerCase()})+": "+v+";")}(d.length||g)&&f.push((a&&!p&&!h?u.map(a):u).join(", ")+" {"+d.join(" ")+"}")}for(var l in e)o(s(l),e[l],this.rules)};Od.prototype.getRules=function(){return this.rules.join(`
`)};Od.newName=function(){var e=dw[hw]||1;return dw[hw]=e+1,Rd+e.toString(36)};Od.mount=function(e,r,n){var a=e[Dd],s=n&&n.nonce;a?s&&a.setNonce(s):a=new Id(e,s),a.mount(Array.isArray(r)?r:[r],e)};var pw=new Map,Id=function(e,r){var n=e.ownerDocument||e,a=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&a.CSSStyleSheet){var s=pw.get(n);if(s)return e[Dd]=s;this.sheet=new a.CSSStyleSheet,pw.set(n,this)}else this.styleTag=n.createElement("style"),r&&this.styleTag.setAttribute("nonce",r);this.modules=[],e[Dd]=this};Id.prototype.mount=function(e,r){for(var n=this.sheet,a=0,s=0,o=0;o<e.length;o++){var l=e[o],u=this.modules.indexOf(l);if(u<s&&u>-1&&(this.modules.splice(u,1),s--,u=-1),u==-1){if(this.modules.splice(s++,0,l),n)for(var c=0;c<l.rules.length;c++)n.insertRule(l.rules[c],a++)}else{for(;s<u;)a+=this.modules[s++].rules.length;a+=l.rules.length,s++}}if(n)r.adoptedStyleSheets.indexOf(this.sheet)<0&&(r.adoptedStyleSheets=[this.sheet].concat(r.adoptedStyleSheets));else{for(var f="",h=0;h<this.modules.length;h++)f+=this.modules[h].getRules()+`
`;this.styleTag.textContent=f;var d=r.head||r;this.styleTag.parentNode!=d&&d.insertBefore(this.styleTag,d.firstChild)}};Id.prototype.setNonce=function(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}});var vw=O(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});var vi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},xo={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Vq=typeof navigator<"u"&&/Mac/.test(navigator.platform),zq=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(Bt=0;Bt<10;Bt++)vi[48+Bt]=vi[96+Bt]=String(Bt);var Bt;for(Bt=1;Bt<=24;Bt++)vi[Bt+111]="F"+Bt;var Bt;for(Bt=65;Bt<=90;Bt++)vi[Bt]=String.fromCharCode(Bt+32),xo[Bt]=String.fromCharCode(Bt);var Bt;for(Yu in vi)xo.hasOwnProperty(Yu)||(xo[Yu]=vi[Yu]);var Yu;function Hq(t){var e=Vq&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||zq&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",r=!e&&t.key||(t.shiftKey?xo:vi)[t.keyCode]||t.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}Eo.base=vi;Eo.keyName=Hq;Eo.shift=xo});var xi=O(oe=>{"use strict";var W=gi(),ls=Bd(),Ld=vw();function Fo(t){let e;return t.nodeType==11?e=t.getSelection?t:t.ownerDocument:e=t,e.getSelection()}function Ud(t,e){return e?t==e||t.contains(e.nodeType!=1?e.parentNode:e):!1}function ic(t,e){if(!e.anchorNode)return!1;try{return Ud(t,e.anchorNode)}catch{return!1}}function us(t){return t.nodeType==3?ua(t,0,t.nodeValue.length).getClientRects():t.nodeType==1?t.getClientRects():[]}function Po(t,e,r,n){return r?mw(t,e,r,n,-1)||mw(t,e,r,n,1):!1}function la(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e}function fc(t){return t.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function mw(t,e,r,n,a){for(;;){if(t==r&&e==n)return!0;if(e==(a<0?0:xn(t))){if(t.nodeName=="DIV")return!1;let s=t.parentNode;if(!s||s.nodeType!=1)return!1;e=la(t)+(a<0?0:1),t=s}else if(t.nodeType==1){if(t=t.childNodes[e+(a<0?-1:0)],t.nodeType==1&&t.contentEditable=="false")return!1;e=a<0?xn(t):0}else return!1}}function xn(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function jo(t,e){let r=e?t.left:t.right;return{left:r,right:r,top:t.top,bottom:t.bottom}}function Uq(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function i_(t,e){let r=e.width/t.offsetWidth,n=e.height/t.offsetHeight;return(r>.995&&r<1.005||!isFinite(r)||Math.abs(e.width-t.offsetWidth)<1)&&(r=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-t.offsetHeight)<1)&&(n=1),{scaleX:r,scaleY:n}}function Wq(t,e,r,n,a,s,o,l){let u=t.ownerDocument,c=u.defaultView||window;for(let f=t,h=!1;f&&!h;)if(f.nodeType==1){let d,p=f==u.body,g=1,m=1;if(p)d=Uq(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(f).position)&&(h=!0),f.scrollHeight<=f.clientHeight&&f.scrollWidth<=f.clientWidth){f=f.assignedSlot||f.parentNode;continue}let b=f.getBoundingClientRect();({scaleX:g,scaleY:m}=i_(f,b)),d={left:b.left,right:b.left+f.clientWidth*g,top:b.top,bottom:b.top+f.clientHeight*m}}let v=0,y=0;if(a=="nearest")e.top<d.top?(y=e.top-(d.top+o),r>0&&e.bottom>d.bottom+y&&(y=e.bottom-d.bottom+o)):e.bottom>d.bottom&&(y=e.bottom-d.bottom+o,r<0&&e.top-y<d.top&&(y=e.top-(d.top+o)));else{let b=e.bottom-e.top,w=d.bottom-d.top;y=(a=="center"&&b<=w?e.top+b/2-w/2:a=="start"||a=="center"&&r<0?e.top-o:e.bottom-w+o)-d.top}if(n=="nearest"?e.left<d.left?(v=e.left-(d.left+s),r>0&&e.right>d.right+v&&(v=e.right-d.right+s)):e.right>d.right&&(v=e.right-d.right+s,r<0&&e.left<d.left+v&&(v=e.left-(d.left+s))):v=(n=="center"?e.left+(e.right-e.left)/2-(d.right-d.left)/2:n=="start"==l?e.left-s:e.right-(d.right-d.left)+s)-d.left,v||y)if(p)c.scrollBy(v,y);else{let b=0,w=0;if(y){let _=f.scrollTop;f.scrollTop+=y/m,w=(f.scrollTop-_)*m}if(v){let _=f.scrollLeft;f.scrollLeft+=v/g,b=(f.scrollLeft-_)*g}e={left:e.left-b,top:e.top-w,right:e.right-b,bottom:e.bottom-w},b&&Math.abs(b-v)<1&&(n="nearest"),w&&Math.abs(w-y)<1&&(a="nearest")}if(p)break;(e.top<d.top||e.bottom>d.bottom||e.left<d.left||e.right>d.right)&&(e={left:Math.max(e.left,d.left),right:Math.min(e.right,d.right),top:Math.max(e.top,d.top),bottom:Math.min(e.bottom,d.bottom)}),f=f.assignedSlot||f.parentNode}else if(f.nodeType==11)f=f.host;else break}function Gq(t){let e=t.ownerDocument,r,n;for(let a=t.parentNode;a&&!(a==e.body||r&&n);)if(a.nodeType==1)!n&&a.scrollHeight>a.clientHeight&&(n=a),!r&&a.scrollWidth>a.clientWidth&&(r=a),a=a.assignedSlot||a.parentNode;else if(a.nodeType==11)a=a.host;else break;return{x:r,y:n}}var Wd=class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:r,focusNode:n}=e;this.set(r,Math.min(e.anchorOffset,r?xn(r):0),n,Math.min(e.focusOffset,n?xn(n):0))}set(e,r,n,a){this.anchorNode=e,this.anchorOffset=r,this.focusNode=n,this.focusOffset=a}},ns=null;function a_(t){if(t.setActive)return t.setActive();if(ns)return t.focus(ns);let e=[];for(let r=t;r&&(e.push(r,r.scrollTop,r.scrollLeft),r!=r.ownerDocument);r=r.parentNode);if(t.focus(ns==null?{get preventScroll(){return ns={preventScroll:!0},!0}}:void 0),!ns){ns=!1;for(let r=0;r<e.length;){let n=e[r++],a=e[r++],s=e[r++];n.scrollTop!=a&&(n.scrollTop=a),n.scrollLeft!=s&&(n.scrollLeft=s)}}}var yw;function ua(t,e,r=e){let n=yw||(yw=document.createRange());return n.setEnd(t,r),n.setStart(t,e),n}function os(t,e,r,n){let a={key:e,code:e,keyCode:r,which:r,cancelable:!0};n&&({altKey:a.altKey,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,metaKey:a.metaKey}=n);let s=new KeyboardEvent("keydown",a);s.synthetic=!0,t.dispatchEvent(s);let o=new KeyboardEvent("keyup",a);return o.synthetic=!0,t.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function Kq(t){for(;t;){if(t&&(t.nodeType==9||t.nodeType==11&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}function s_(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function jq(t,e){let r=e.focusNode,n=e.focusOffset;if(!r||e.anchorNode!=r||e.anchorOffset!=n)return!1;for(n=Math.min(n,xn(r));;)if(n){if(r.nodeType!=1)return!1;let a=r.childNodes[n-1];a.contentEditable=="false"?n--:(r=a,n=xn(r))}else{if(r==t)return!0;n=la(r),r=r.parentNode}}function o_(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function l_(t,e){for(let r=t,n=e;;){if(r.nodeType==3&&n>0)return{node:r,offset:n};if(r.nodeType==1&&n>0){if(r.contentEditable=="false")return null;r=r.childNodes[n-1],n=xn(r)}else if(r.parentNode&&!fc(r))n=la(r),r=r.parentNode;else return null}}function u_(t,e){for(let r=t,n=e;;){if(r.nodeType==3&&n<r.nodeValue.length)return{node:r,offset:n};if(r.nodeType==1&&n<r.childNodes.length){if(r.contentEditable=="false")return null;r=r.childNodes[n],n=0}else if(r.parentNode&&!fc(r))n=la(r)+1,r=r.parentNode;else return null}}var yr=class t{constructor(e,r,n=!0){this.node=e,this.offset=r,this.precise=n}static before(e,r){return new t(e.parentNode,la(e),r)}static after(e,r){return new t(e.parentNode,la(e)+1,r)}},Rp=[],gt=class t{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let r=this.posAtStart;for(let n of this.children){if(n==e)return r;r+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,r){if(this.flags&2){let n=this.dom,a=null,s;for(let o of this.children){if(o.flags&7){if(!o.dom&&(s=a?a.nextSibling:n.firstChild)){let l=t.get(s);(!l||!l.parent&&l.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,r),o.flags&=-8}if(s=a?a.nextSibling:n.firstChild,r&&!r.written&&r.node==n&&s!=o.dom&&(r.written=!0),o.dom.parentNode==n)for(;s&&s!=o.dom;)s=bw(s);else n.insertBefore(o.dom,s);a=o.dom}for(s=a?a.nextSibling:n.firstChild,s&&r&&r.node==n&&(r.written=!0);s;)s=bw(s)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(e,r),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,r){let n;if(e==this.dom)n=this.dom.childNodes[r];else{let a=xn(e)==0?0:r==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;a==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?a=-1:a=1),e=s}a<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!t.get(n);)n=n.nextSibling;if(!n)return this.length;for(let a=0,s=0;;a++){let o=this.children[a];if(o.dom==n)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,r,n=0){let a=-1,s=-1,o=-1,l=-1;for(let u=0,c=n,f=n;u<this.children.length;u++){let h=this.children[u],d=c+h.length;if(c<e&&d>r)return h.domBoundsAround(e,r,c);if(d>=e&&a==-1&&(a=u,s=c),c>r&&h.dom.parentNode==this.dom){o=u,l=f;break}f=d,c=d+h.breakAfter}return{from:s,to:l<0?n+this.length:l,startDOM:(a?this.children[a-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let r=this.parent;r;r=r.parent){if(e&&(r.flags|=2),r.flags&1)return;r.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let r=e.parent;if(!r)return e;e=r}}replaceChildren(e,r,n=Rp){this.markDirty();for(let a=e;a<r;a++){let s=this.children[a];s.parent==this&&n.indexOf(s)<0&&s.destroy()}n.length<250?this.children.splice(e,r-e,...n):this.children=[].concat(this.children.slice(0,e),n,this.children.slice(r));for(let a=0;a<n.length;a++)n[a].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new hc(this.children,e,this.children.length)}childPos(e,r=1){return this.childCursor().findPos(e,r)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,r,n,a,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}};gt.prototype.breakAfter=0;function bw(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}var hc=class{constructor(e,r,n){this.children=e,this.pos=r,this.i=n,this.off=0}findPos(e,r=1){for(;;){if(e>this.pos||e==this.pos&&(r>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}};function c_(t,e,r,n,a,s,o,l,u){let{children:c}=t,f=c.length?c[e]:null,h=s.length?s[s.length-1]:null,d=h?h.breakAfter:o;if(!(e==n&&f&&!o&&!d&&s.length<2&&f.merge(r,a,s.length?h:null,r==0,l,u))){if(n<c.length){let p=c[n];p&&(a<p.length||p.breakAfter&&h?.breakAfter)?(e==n&&(p=p.split(a),a=0),!d&&h&&p.merge(0,a,h,!0,0,u)?s[s.length-1]=p:((a||p.children.length&&!p.children[0].length)&&p.merge(0,a,null,!1,0,u),s.push(p))):p?.breakAfter&&(h?h.breakAfter=1:o=1),n++}for(f&&(f.breakAfter=o,r>0&&(!o&&s.length&&f.merge(r,f.length,s[0],!1,l,0)?f.breakAfter=s.shift().breakAfter:(r<f.length||f.children.length&&f.children[f.children.length-1].length==0)&&f.merge(r,f.length,null,!1,l,0),e++));e<n&&s.length;)if(c[n-1].become(s[s.length-1]))n--,s.pop(),u=s.length?0:l;else if(c[e].become(s[0]))e++,s.shift(),l=s.length?0:u;else break;!s.length&&e&&n<c.length&&!c[e-1].breakAfter&&c[n].merge(0,0,c[e-1],!1,l,u)&&e--,(e<n||s.length)&&t.replaceChildren(e,n,s)}}function f_(t,e,r,n,a,s){let o=t.childCursor(),{i:l,off:u}=o.findPos(r,1),{i:c,off:f}=o.findPos(e,-1),h=e-r;for(let d of n)h+=d.length;t.length+=h,c_(t,c,f,l,u,n,0,a,s)}var Tr=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Gd=typeof document<"u"?document:{documentElement:{style:{}}},Kd=/Edge\/(\d+)/.exec(Tr.userAgent),h_=/MSIE \d/.test(Tr.userAgent),jd=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Tr.userAgent),Tc=!!(h_||jd||Kd),ww=!Tc&&/gecko\/(\d+)/i.test(Tr.userAgent),Nd=!Tc&&/Chrome\/(\d+)/.exec(Tr.userAgent),_w="webkitFontSmoothing"in Gd.documentElement.style,d_=!Tc&&/Apple Computer/.test(Tr.vendor),xw=d_&&(/Mobile\/\w+/.test(Tr.userAgent)||Tr.maxTouchPoints>2),he={mac:xw||/Mac/.test(Tr.platform),windows:/Win/.test(Tr.platform),linux:/Linux|X11/.test(Tr.platform),ie:Tc,ie_version:h_?Gd.documentMode||6:jd?+jd[1]:Kd?+Kd[1]:0,gecko:ww,gecko_version:ww?+(/Firefox\/(\d+)/.exec(Tr.userAgent)||[0,0])[1]:0,chrome:!!Nd,chrome_version:Nd?+Nd[1]:0,ios:xw,android:/Android\b/.test(Tr.userAgent),webkit:_w,safari:d_,webkit_version:_w?+(/\bAppleWebKit\/(\d+)/.exec(Tr.userAgent)||[0,0])[1]:0,tabSize:Gd.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"},Yq=256,En=class t extends gt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,r){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(r&&r.node==this.dom&&(r.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,r,n){return this.flags&8||n&&(!(n instanceof t)||this.length-(r-e)+n.length>Yq||n.flags&8)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(r),this.markDirty(),!0)}split(e){let r=new t(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),r.flags|=this.flags&8,r}localPosFromDOM(e,r){return e==this.dom?r:r?this.text.length:0}domAtPos(e){return new yr(this.dom,e)}domBoundsAround(e,r,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,r){return Zq(this.dom,e,r)}},bi=class t extends gt{constructor(e,r=[],n=0){super(),this.mark=e,this.children=r,this.length=n;for(let a of r)a.setParent(this)}setAttrs(e){if(s_(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let r in this.mark.attrs)e.setAttribute(r,this.mark.attrs[r]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,r){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,r)}merge(e,r,n,a,s,o){return n&&(!(n instanceof t&&n.mark.eq(this.mark))||e&&s<=0||r<this.length&&o<=0)?!1:(f_(this,e,r,n?n.children.slice():[],s-1,o-1),this.markDirty(),!0)}split(e){let r=[],n=0,a=-1,s=0;for(let l of this.children){let u=n+l.length;u>e&&r.push(n<e?l.split(e-n):l),a<0&&n>=e&&(a=s),n=u,s++}let o=this.length-e;return this.length=e,a>-1&&(this.children.length=a,this.markDirty()),new t(this.mark,r,o)}domAtPos(e){return p_(this,e)}coordsAt(e,r){return v_(this,e,r)}};function Zq(t,e,r){let n=t.nodeValue.length;e>n&&(e=n);let a=e,s=e,o=0;e==0&&r<0||e==n&&r>=0?he.chrome||he.gecko||(e?(a--,o=1):s<n&&(s++,o=-1)):r<0?a--:s<n&&s++;let l=ua(t,a,s).getClientRects();if(!l.length)return null;let u=l[(o?o<0:r>=0)?0:l.length-1];return he.safari&&!o&&u.width==0&&(u=Array.prototype.find.call(l,c=>c.width)||u),o?jo(u,o<0):u||null}var qo=class t extends gt{static create(e,r,n){return new t(e,r,n)}constructor(e,r,n){super(),this.widget=e,this.length=r,this.side=n,this.prevWidget=null}split(e){let r=t.create(this.widget,this.length-e,this.side);return this.length-=e,r}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,r,n,a,s,o){return n&&(!(n instanceof t)||!this.widget.compare(n.widget)||e>0&&s<=0||r<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-r),!0)}become(e){return e instanceof t&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return W.Text.empty;let e=this;for(;e.parent;)e=e.parent;let{view:r}=e,n=r&&r.state.doc,a=this.posAtStart;return n?n.slice(a,a+this.length):W.Text.empty}domAtPos(e){return(this.length?e==0:this.side>0)?yr.before(this.dom):yr.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,r){let n=this.widget.coordsAt(this.dom,e,r);if(n)return n;let a=this.dom.getClientRects(),s=null;if(!a.length)return null;let o=this.side?this.side<0:e>0;for(let l=o?a.length-1:0;s=a[l],!(e>0?l==0:l==a.length-1||s.top<s.bottom);l+=o?-1:1);return jo(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}},Vo=class t extends gt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof t&&e.side==this.side}split(){return new t(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?yr.before(this.dom):yr.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return W.Text.empty}get isHidden(){return!0}};En.prototype.children=qo.prototype.children=Vo.prototype.children=Rp;function p_(t,e){let r=t.dom,{children:n}=t,a=0;for(let s=0;a<n.length;a++){let o=n[a],l=s+o.length;if(!(l==s&&o.getSide()<=0)){if(e>s&&e<l&&o.dom.parentNode==r)return o.domAtPos(e-s);if(e<=s)break;s=l}}for(let s=a;s>0;s--){let o=n[s-1];if(o.dom.parentNode==r)return o.domAtPos(o.length)}for(let s=a;s<n.length;s++){let o=n[s];if(o.dom.parentNode==r)return o.domAtPos(0)}return new yr(r,0)}function g_(t,e,r){let n,{children:a}=t;r>0&&e instanceof bi&&a.length&&(n=a[a.length-1])instanceof bi&&n.mark.eq(e.mark)?g_(n,e.children[0],r-1):(a.push(e),e.setParent(t)),t.length+=e.length}function v_(t,e,r){let n=null,a=-1,s=null,o=-1;function l(c,f){for(let h=0,d=0;h<c.children.length&&d<=f;h++){let p=c.children[h],g=d+p.length;g>=f&&(p.children.length?l(p,f-d):(!s||s.isHidden&&(r>0||$q(s,p)))&&(g>f||d==g&&p.getSide()>0)?(s=p,o=f-d):(d<f||d==g&&p.getSide()<0&&!p.isHidden)&&(n=p,a=f-d)),d=g}}l(t,e);let u=(r<0?n:s)||n||s;return u?u.coordsAt(Math.max(0,u==n?a:o),r):Xq(t)}function Xq(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let r=us(e);return r[r.length-1]||null}function $q(t,e){let r=t.coordsAt(0,1),n=e.coordsAt(0,1);return r&&n&&n.top<r.bottom}function Yd(t,e){for(let r in t)r=="class"&&e.class?e.class+=" "+t.class:r=="style"&&e.style?e.style+=";"+t.style:e[r]=t[r];return e}var Ew=Object.create(null);function dc(t,e,r){if(t==e)return!0;t||(t=Ew),e||(e=Ew);let n=Object.keys(t),a=Object.keys(e);if(n.length-(r&&n.indexOf(r)>-1?1:0)!=a.length-(r&&a.indexOf(r)>-1?1:0))return!1;for(let s of n)if(s!=r&&(a.indexOf(s)==-1||t[s]!==e[s]))return!1;return!0}function Zd(t,e,r){let n=!1;if(e)for(let a in e)r&&a in r||(n=!0,a=="style"?t.style.cssText="":t.removeAttribute(a));if(r)for(let a in r)e&&e[a]==r[a]||(n=!0,a=="style"?t.style.cssText=r[a]:t.setAttribute(a,r[a]));return n}function Qq(t){let e=Object.create(null);for(let r=0;r<t.attributes.length;r++){let n=t.attributes[r];e[n.name]=n.value}return e}var jn=class{eq(e){return!1}updateDOM(e,r){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,r,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}};oe.BlockType=void 0;(function(t){t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange"})(oe.BlockType||(oe.BlockType={}));var ut=class extends W.RangeValue{constructor(e,r,n,a){super(),this.startSide=e,this.endSide=r,this.widget=n,this.spec=a}get heightRelevant(){return!1}static mark(e){return new zo(e)}static widget(e){let r=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return r+=n&&!e.inlineOrder?r>0?3e8:-4e8:r>0?1e8:-1e8,new wi(e,r,r,n,e.widget||null,!1)}static replace(e){let r=!!e.block,n,a;if(e.isBlockGap)n=-5e8,a=4e8;else{let{start:s,end:o}=m_(e,r);n=(s?r?-3e8:-1:5e8)-1,a=(o?r?2e8:1:-6e8)+1}return new wi(e,n,a,r,e.widget||null,!0)}static line(e){return new Ho(e)}static set(e,r=!1){return W.RangeSet.of(e,r)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}};ut.none=W.RangeSet.empty;var zo=class t extends ut{constructor(e){let{start:r,end:n}=m_(e);super(r?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var r,n;return this==e||e instanceof t&&this.tagName==e.tagName&&(this.class||((r=this.attrs)===null||r===void 0?void 0:r.class))==(e.class||((n=e.attrs)===null||n===void 0?void 0:n.class))&&dc(this.attrs,e.attrs,"class")}range(e,r=e){if(e>=r)throw new RangeError("Mark decorations may not be empty");return super.range(e,r)}};zo.prototype.point=!1;var Ho=class t extends ut{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof t&&this.spec.class==e.spec.class&&dc(this.spec.attributes,e.spec.attributes)}range(e,r=e){if(r!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,r)}};Ho.prototype.mapMode=W.MapMode.TrackBefore;Ho.prototype.point=!0;var wi=class t extends ut{constructor(e,r,n,a,s,o){super(r,n,s,e),this.block=a,this.isReplace=o,this.mapMode=a?r<=0?W.MapMode.TrackBefore:W.MapMode.TrackAfter:W.MapMode.TrackDel}get type(){return this.startSide!=this.endSide?oe.BlockType.WidgetRange:this.startSide<=0?oe.BlockType.WidgetBefore:oe.BlockType.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof t&&Jq(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,r=e){if(this.isReplace&&(e>r||e==r&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&r!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,r)}};wi.prototype.point=!0;function m_(t,e=!1){let{inclusiveStart:r,inclusiveEnd:n}=t;return r==null&&(r=t.inclusive),n==null&&(n=t.inclusive),{start:r??e,end:n??e}}function Jq(t,e){return t==e||!!(t&&e&&t.compare(e))}function ac(t,e,r,n=0){let a=r.length-1;a>=0&&r[a]+n>=t?r[a]=Math.max(r[a],e):r.push(t,e)}var Jt=class t extends gt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,r,n,a,s,o){if(n){if(!(n instanceof t))return!1;this.dom||n.transferDOM(this)}return a&&this.setDeco(n?n.attrs:null),f_(this,e,r,n?n.children.slice():[],s,o),!0}split(e){let r=new t;if(r.breakAfter=this.breakAfter,this.length==0)return r;let{i:n,off:a}=this.childPos(e);a&&(r.append(this.children[n].split(a),0),this.children[n].merge(a,this.children[n].length,null,!1,0,0),n++);for(let s=n;s<this.children.length;s++)r.append(this.children[s],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,r}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){dc(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,r){g_(this,e,r)}addLineDeco(e){let r=e.spec.attributes,n=e.spec.class;r&&(this.attrs=Yd(r,this.attrs||{})),n&&(this.attrs=Yd({class:n},this.attrs||{}))}domAtPos(e){return p_(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,r){var n;this.dom?this.flags&4&&(s_(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Zd(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,r);let a=this.dom.lastChild;for(;a&&gt.get(a)instanceof bi;)a=a.lastChild;if(!a||!this.length||a.nodeName!="BR"&&((n=gt.get(a))===null||n===void 0?void 0:n.isEditable)==!1&&(!he.ios||!this.children.some(s=>s instanceof En))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,r;for(let n of this.children){if(!(n instanceof En)||/[^ -~]/.test(n.text))return null;let a=us(n.dom);if(a.length!=1)return null;e+=a[0].width,r=a[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:r}:null}coordsAt(e,r){let n=v_(this,e,r);if(!this.children.length&&n&&this.parent){let{heightOracle:a}=this.parent.view.viewState,s=n.bottom-n.top;if(Math.abs(s-a.lineHeight)<2&&a.textHeight<s){let o=(s-a.textHeight)/2;return{top:n.top+o,bottom:n.bottom-o,left:n.left,right:n.left}}}return n}become(e){return e instanceof t&&this.children.length==0&&e.children.length==0&&dc(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,r){for(let n=0,a=0;n<e.children.length;n++){let s=e.children[n],o=a+s.length;if(o>=r){if(s instanceof t)return s;if(o>r)break}a=o+s.breakAfter}return null}},oa=class t extends gt{constructor(e,r,n){super(),this.widget=e,this.length=r,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,r,n,a,s,o){return n&&(!(n instanceof t)||!this.widget.compare(n.widget)||e>0&&s<=0||r<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-r),!0)}domAtPos(e){return e==0?yr.before(this.dom):yr.after(this.dom,e==this.length)}split(e){let r=this.length-e;this.length=e;let n=new t(this.widget,r,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return Rp}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):W.Text.empty}domBoundsAround(){return null}become(e){return e instanceof t&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,r){let n=this.widget.coordsAt(this.dom,e,r);return n||(this.widget instanceof Uo?null:jo(this.dom.getBoundingClientRect(),this.length?e==0:r<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:r,endSide:n}=this.deco;return r==n?!1:e<0?r<0:n>0}},Uo=class extends jn{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}},Ro=class t{constructor(e,r,n,a){this.doc=e,this.pos=r,this.end=n,this.disallowBlockEffectsFor=a,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=r}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof oa&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Jt),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Zu(new Vo(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof oa)&&this.getLine()}buildText(e,r,n){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let a=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(r.slice(r.length-n)),this.getLine().append(Zu(new En(this.text.slice(this.textOff,this.textOff+a)),r),n),this.atCursorPos=!0,this.textOff+=a,e-=a,n=0}}span(e,r,n,a){this.buildText(r-e,n,a),this.pos=r,this.openStart<0&&(this.openStart=a)}point(e,r,n,a,s,o){if(this.disallowBlockEffectsFor[o]&&n instanceof wi){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(r>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=r-e;if(n instanceof wi)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new oa(n.widget||_i.block,l,n));else{let u=qo.create(n.widget||_i.inline,l,l?0:n.startSide),c=this.atCursorPos&&!u.isEditable&&s<=a.length&&(e<r||n.startSide>0),f=!u.isEditable&&(e<r||s>a.length||n.startSide<=0),h=this.getLine();this.pendingBuffer==2&&!c&&!u.isEditable&&(this.pendingBuffer=0),this.flushBuffer(a),c&&(h.append(Zu(new Vo(1),a),s),s=a.length+Math.max(0,s-a.length)),h.append(Zu(u,a),s),this.atCursorPos=f,this.pendingBuffer=f?e<r||s>a.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=a.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=r),this.openStart<0&&(this.openStart=s)}static build(e,r,n,a,s){let o=new t(e,r,n,s);return o.openEnd=W.RangeSet.spans(a,r,n,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}};function Zu(t,e){for(let r of e)t=new bi(r,[t],t.length);return t}var _i=class extends jn{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}};_i.inline=new _i("span");_i.block=new _i("div");oe.Direction=void 0;(function(t){t[t.LTR=0]="LTR",t[t.RTL=1]="RTL"})(oe.Direction||(oe.Direction={}));var ca=oe.Direction.LTR,Dp=oe.Direction.RTL;function y_(t){let e=[];for(let r=0;r<t.length;r++)e.push(1<<+t[r]);return e}var eV=y_("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),tV=y_("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Xd=Object.create(null),_n=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),r=t.charCodeAt(1);Xd[e]=r,Xd[r]=-e}function b_(t){return t<=247?eV[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?tV[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}var rV=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/,un=class{get dir(){return this.level%2?Dp:ca}constructor(e,r,n){this.from=e,this.to=r,this.level=n}side(e,r){return this.dir==r==e?this.to:this.from}forward(e,r){return e==(this.dir==r)}static find(e,r,n,a){let s=-1;for(let o=0;o<e.length;o++){let l=e[o];if(l.from<=r&&l.to>=r){if(l.level==n)return o;(s<0||(a!=0?a<0?l.from<r:l.to>r:e[s].level>l.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}};function w_(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++){let n=t[r],a=e[r];if(n.from!=a.from||n.to!=a.to||n.direction!=a.direction||!w_(n.inner,a.inner))return!1}return!0}var ht=[];function nV(t,e,r,n,a){for(let s=0;s<=n.length;s++){let o=s?n[s-1].to:e,l=s<n.length?n[s].from:r,u=s?256:a;for(let c=o,f=u,h=u;c<l;c++){let d=b_(t.charCodeAt(c));d==512?d=f:d==8&&h==4&&(d=16),ht[c]=d==4?2:d,d&7&&(h=d),f=d}for(let c=o,f=u,h=u;c<l;c++){let d=ht[c];if(d==128)c<l-1&&f==ht[c+1]&&f&24?d=ht[c]=f:ht[c]=256;else if(d==64){let p=c+1;for(;p<l&&ht[p]==64;)p++;let g=c&&f==8||p<r&&ht[p]==8?h==1?1:8:256;for(let m=c;m<p;m++)ht[m]=g;c=p-1}else d==8&&h==1&&(ht[c]=1);f=d,d&7&&(h=d)}}}function iV(t,e,r,n,a){let s=a==1?2:1;for(let o=0,l=0,u=0;o<=n.length;o++){let c=o?n[o-1].to:e,f=o<n.length?n[o].from:r;for(let h=c,d,p,g;h<f;h++)if(p=Xd[d=t.charCodeAt(h)])if(p<0){for(let m=l-3;m>=0;m-=3)if(_n[m+1]==-p){let v=_n[m+2],y=v&2?a:v&4?v&1?s:a:0;y&&(ht[h]=ht[_n[m]]=y),l=m;break}}else{if(_n.length==189)break;_n[l++]=h,_n[l++]=d,_n[l++]=u}else if((g=ht[h])==2||g==1){let m=g==a;u=m?0:1;for(let v=l-3;v>=0;v-=3){let y=_n[v+2];if(y&2)break;if(m)_n[v+2]|=2;else{if(y&4)break;_n[v+2]|=4}}}}}function aV(t,e,r,n){for(let a=0,s=n;a<=r.length;a++){let o=a?r[a-1].to:t,l=a<r.length?r[a].from:e;for(let u=o;u<l;){let c=ht[u];if(c==256){let f=u+1;for(;;)if(f==l){if(a==r.length)break;f=r[a++].to,l=a<r.length?r[a].from:e}else if(ht[f]==256)f++;else break;let h=s==1,d=(f<e?ht[f]:n)==1,p=h==d?h?1:2:n;for(let g=f,m=a,v=m?r[m-1].to:t;g>u;)g==v&&(g=r[--m].from,v=m?r[m-1].to:t),ht[--g]=p;u=f}else s=c,u++}}}function $d(t,e,r,n,a,s,o){let l=n%2?2:1;if(n%2==a%2)for(let u=e,c=0;u<r;){let f=!0,h=!1;if(c==s.length||u<s[c].from){let m=ht[u];m!=l&&(f=!1,h=m==16)}let d=!f&&l==1?[]:null,p=f?n:n+1,g=u;e:for(;;)if(c<s.length&&g==s[c].from){if(h)break e;let m=s[c];if(!f)for(let v=m.to,y=c+1;;){if(v==r)break e;if(y<s.length&&s[y].from==v)v=s[y++].to;else{if(ht[v]==l)break e;break}}if(c++,d)d.push(m);else{m.from>u&&o.push(new un(u,m.from,p));let v=m.direction==ca!=!(p%2);Qd(t,v?n+1:n,a,m.inner,m.from,m.to,o),u=m.to}g=m.to}else{if(g==r||(f?ht[g]!=l:ht[g]==l))break;g++}d?$d(t,u,g,n+1,a,d,o):u<g&&o.push(new un(u,g,p)),u=g}else for(let u=r,c=s.length;u>e;){let f=!0,h=!1;if(!c||u>s[c-1].to){let m=ht[u-1];m!=l&&(f=!1,h=m==16)}let d=!f&&l==1?[]:null,p=f?n:n+1,g=u;e:for(;;)if(c&&g==s[c-1].to){if(h)break e;let m=s[--c];if(!f)for(let v=m.from,y=c;;){if(v==e)break e;if(y&&s[y-1].to==v)v=s[--y].from;else{if(ht[v-1]==l)break e;break}}if(d)d.push(m);else{m.to<u&&o.push(new un(m.to,u,p));let v=m.direction==ca!=!(p%2);Qd(t,v?n+1:n,a,m.inner,m.from,m.to,o),u=m.from}g=m.from}else{if(g==e||(f?ht[g-1]!=l:ht[g-1]==l))break;g--}d?$d(t,g,u,n+1,a,d,o):g<u&&o.push(new un(g,u,p)),u=g}}function Qd(t,e,r,n,a,s,o){let l=e%2?2:1;nV(t,a,s,n,l),iV(t,a,s,n,l),aV(a,s,n,l),$d(t,a,s,e,r,n,o)}function __(t,e,r){if(!t)return[new un(0,0,e==Dp?1:0)];if(e==ca&&!r.length&&!rV.test(t))return x_(t.length);if(r.length)for(;t.length>ht.length;)ht[ht.length]=256;let n=[],a=e==ca?0:1;return Qd(t,a,a,r,0,t.length,n),n}function x_(t){return[new un(0,t,0)]}var E_="";function S_(t,e,r,n,a){var s;let o=n.head-t.from,l=un.find(e,o,(s=n.bidiLevel)!==null&&s!==void 0?s:-1,n.assoc),u=e[l],c=u.side(a,r);if(o==c){let d=l+=a?1:-1;if(d<0||d>=e.length)return null;u=e[l=d],o=u.side(!a,r),c=u.side(a,r)}let f=W.findClusterBreak(t.text,o,u.forward(a,r));(f<u.from||f>u.to)&&(f=c),E_=t.text.slice(Math.min(o,f),Math.max(o,f));let h=l==(a?e.length-1:0)?null:e[l+(a?1:-1)];return h&&f==c&&h.level+(a?0:1)<u.level?W.EditorSelection.cursor(h.side(!a,r)+t.from,h.forward(a,r)?1:-1,h.level):W.EditorSelection.cursor(f+t.from,u.forward(a,r)?-1:1,u.level)}function sV(t,e,r){for(let n=e;n<r;n++){let a=b_(t.charCodeAt(n));if(a==1)return ca;if(a==2||a==4)return Dp}return ca}var C_=W.Facet.define(),T_=W.Facet.define(),k_=W.Facet.define(),A_=W.Facet.define(),Jd=W.Facet.define(),M_=W.Facet.define(),P_=W.Facet.define(),Op=W.Facet.define(),Ip=W.Facet.define(),R_=W.Facet.define({combine:t=>t.some(e=>e)}),D_=W.Facet.define({combine:t=>t.some(e=>e)}),O_=W.Facet.define(),Do=class t{constructor(e,r="nearest",n="nearest",a=5,s=5,o=!1){this.range=e,this.y=r,this.x=n,this.yMargin=a,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new t(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new t(W.EditorSelection.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}},Xu=W.StateEffect.define({map:(t,e)=>t.map(e)}),I_=W.StateEffect.define();function cn(t,e,r){let n=t.facet(A_);n.length?n[0](e):window.onerror?window.onerror(String(e),r,void 0,void 0,e):r?console.error(r+":",e):console.error(e)}var Kn=W.Facet.define({combine:t=>t.length?t[0]:!0}),oV=0,Co=W.Facet.define(),er=class t{constructor(e,r,n,a,s){this.id=e,this.create=r,this.domEventHandlers=n,this.domEventObservers=a,this.extension=s(this)}static define(e,r){let{eventHandlers:n,eventObservers:a,provide:s,decorations:o}=r||{};return new t(oV++,e,n,a,l=>{let u=[Co.of(l)];return o&&u.push(Wo.of(c=>{let f=c.plugin(l);return f?o(f):ut.none})),s&&u.push(s(l)),u})}static fromClass(e,r){return t.define(n=>new e(n),r)}},Oo=class{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let r=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(r)}catch(n){if(cn(r.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(r){cn(e.state,r,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var r;if(!((r=this.value)===null||r===void 0)&&r.destroy)try{this.value.destroy()}catch(n){cn(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}},B_=W.Facet.define(),kc=W.Facet.define(),Wo=W.Facet.define(),L_=W.Facet.define(),Bp=W.Facet.define(),N_=W.Facet.define();function Sw(t,e){let r=t.state.facet(N_);if(!r.length)return r;let n=r.map(s=>s instanceof Function?s(t):s),a=[];return W.RangeSet.spans(n,e.from,e.to,{point(){},span(s,o,l,u){let c=s-e.from,f=o-e.from,h=a;for(let d=l.length-1;d>=0;d--,u--){let p=l[d].spec.bidiIsolate,g;if(p==null&&(p=sV(e.text,c,f)),u>0&&h.length&&(g=h[h.length-1]).to==c&&g.direction==p)g.to=f,h=g.inner;else{let m={from:c,to:f,direction:p,inner:[]};h.push(m),h=m.inner}}}}),a}var F_=W.Facet.define();function Lp(t){let e=0,r=0,n=0,a=0;for(let s of t.state.facet(F_)){let o=s(t);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(r=Math.max(r,o.right)),o.top!=null&&(n=Math.max(n,o.top)),o.bottom!=null&&(a=Math.max(a,o.bottom)))}return{left:e,right:r,top:n,bottom:a}}var To=W.Facet.define(),fn=class t{constructor(e,r,n,a){this.fromA=e,this.toA=r,this.fromB=n,this.toB=a}join(e){return new t(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let r=e.length,n=this;for(;r>0;r--){let a=e[r-1];if(!(a.fromA>n.toA)){if(a.toA<n.fromA)break;n=n.join(a),e.splice(r-1,1)}}return e.splice(r,0,n),e}static extendWithRanges(e,r){if(r.length==0)return e;let n=[];for(let a=0,s=0,o=0,l=0;;a++){let u=a==e.length?null:e[a],c=o-l,f=u?u.fromB:1e9;for(;s<r.length&&r[s]<f;){let h=r[s],d=r[s+1],p=Math.max(l,h),g=Math.min(f,d);if(p<=g&&new t(p+c,g+c,p,g).addToSet(n),d>f)break;s+=2}if(!u)return n;new t(u.fromA,u.toA,u.fromB,u.toB).addToSet(n),o=u.toA,l=u.toB}}},Go=class t{constructor(e,r,n){this.view=e,this.state=r,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=W.ChangeSet.empty(this.startState.doc.length);for(let s of n)this.changes=this.changes.compose(s.changes);let a=[];this.changes.iterChangedRanges((s,o,l,u)=>a.push(new fn(s,o,l,u))),this.changedRanges=a}static create(e,r,n){return new t(e,r,n)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}},pc=class extends gt{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=ut.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Jt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new fn(0,0,0,e.state.doc.length)],0,null)}update(e){var r;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:c,toA:f})=>f<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let a=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((r=this.domChanged)===null||r===void 0)&&r.newSel?a=this.domChanged.newSel.head:!pV(e.changes,this.hasComposition)&&!e.selectionSet&&(a=e.state.selection.main.head));let s=a>-1?uV(this.view,e.changes,a):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:f}=this.hasComposition;n=new fn(c,f,e.changes.mapPos(c,-1),e.changes.mapPos(f,1)).addToSet(n.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(he.ie||he.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,l=this.updateDeco(),u=hV(o,l,e.changes);return n=fn.extendWithRanges(n,u),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,r,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,r,n);let{observer:a}=this.view;a.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=he.chrome||he.ios?{node:a.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||a.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof oa&&o.widget instanceof Uo&&s.push(o.dom);a.updateGaps(s)}updateChildren(e,r,n){let a=n?n.range.addToSet(e.slice()):e,s=this.childCursor(r);for(let o=a.length-1;;o--){let l=o>=0?a[o]:null;if(!l)break;let{fromA:u,toA:c,fromB:f,toB:h}=l,d,p,g,m;if(n&&n.range.fromB<h&&n.range.toB>f){let _=Ro.build(this.view.state.doc,f,n.range.fromB,this.decorations,this.dynamicDecorationMap),x=Ro.build(this.view.state.doc,n.range.toB,h,this.decorations,this.dynamicDecorationMap);p=_.breakAtStart,g=_.openStart,m=x.openEnd;let S=this.compositionView(n);x.breakAtStart?S.breakAfter=1:x.content.length&&S.merge(S.length,S.length,x.content[0],!1,x.openStart,0)&&(S.breakAfter=x.content[0].breakAfter,x.content.shift()),_.content.length&&S.merge(0,0,_.content[_.content.length-1],!0,0,_.openEnd)&&_.content.pop(),d=_.content.concat(S).concat(x.content)}else({content:d,breakAtStart:p,openStart:g,openEnd:m}=Ro.build(this.view.state.doc,f,h,this.decorations,this.dynamicDecorationMap));let{i:v,off:y}=s.findPos(c,1),{i:b,off:w}=s.findPos(u,-1);c_(this,b,w,v,y,d,p,g,m)}n&&this.fixCompositionDOM(n)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let r of e.transactions)for(let n of r.effects)n.is(I_)&&(this.editContextFormatting=n.value)}compositionView(e){let r=new En(e.text.nodeValue);r.flags|=8;for(let{deco:a}of e.marks)r=new bi(a,[r],r.length);let n=new Jt;return n.append(r,0),n}fixCompositionDOM(e){let r=(s,o)=>{o.flags|=8|(o.children.some(u=>u.flags&7)?1:0),this.markedForComposition.add(o);let l=gt.get(s);l&&l!=o&&(l.dom=null),o.setDOM(s)},n=this.childPos(e.range.fromB,1),a=this.children[n.i];r(e.line,a);for(let s=e.marks.length-1;s>=-1;s--)n=a.childPos(n.off,1),a=a.children[n.i],r(s>=0?e.marks[s].node:e.text,a)}updateSelection(e=!1,r=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,a=n==this.dom,s=!a&&!(this.view.state.facet(Kn)||this.dom.tabIndex>-1)&&ic(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(a||r||s))return;let o=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,u=this.moveToLine(this.domAtPos(l.anchor)),c=l.empty?u:this.moveToLine(this.domAtPos(l.head));if(he.gecko&&l.empty&&!this.hasComposition&&lV(u)){let h=document.createTextNode("");this.view.observer.ignore(()=>u.node.insertBefore(h,u.node.childNodes[u.offset]||null)),u=c=new yr(h,0),o=!0}let f=this.view.observer.selectionRange;(o||!f.focusNode||(!Po(u.node,u.offset,f.anchorNode,f.anchorOffset)||!Po(c.node,c.offset,f.focusNode,f.focusOffset))&&!this.suppressWidgetCursorChange(f,l))&&(this.view.observer.ignore(()=>{he.android&&he.chrome&&this.dom.contains(f.focusNode)&&dV(f.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let h=Fo(this.view.root);if(h)if(l.empty){if(he.gecko){let d=cV(u.node,u.offset);if(d&&d!=3){let p=(d==1?l_:u_)(u.node,u.offset);p&&(u=new yr(p.node,p.offset))}}h.collapse(u.node,u.offset),l.bidiLevel!=null&&h.caretBidiLevel!==void 0&&(h.caretBidiLevel=l.bidiLevel)}else if(h.extend){h.collapse(u.node,u.offset);try{h.extend(c.node,c.offset)}catch{}}else{let d=document.createRange();l.anchor>l.head&&([u,c]=[c,u]),d.setEnd(c.node,c.offset),d.setStart(u.node,u.offset),h.removeAllRanges(),h.addRange(d)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(u,c)),this.impreciseAnchor=u.precise?null:new yr(f.anchorNode,f.anchorOffset),this.impreciseHead=c.precise?null:new yr(f.focusNode,f.focusOffset)}suppressWidgetCursorChange(e,r){return this.hasComposition&&r.empty&&Po(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==r.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,r=e.state.selection.main,n=Fo(e.root),{anchorNode:a,anchorOffset:s}=e.observer.selectionRange;if(!n||!r.empty||!r.assoc||!n.modify)return;let o=Jt.find(this,r.head);if(!o)return;let l=o.posAtStart;if(r.head==l||r.head==l+o.length)return;let u=this.coordsAt(r.head,-1),c=this.coordsAt(r.head,1);if(!u||!c||u.bottom>c.top)return;let f=this.domAtPos(r.head+r.assoc);n.collapse(f.node,f.offset),n.modify("move",r.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=r.from&&n.collapse(a,s)}moveToLine(e){let r=this.dom,n;if(e.node!=r)return e;for(let a=e.offset;!n&&a<r.childNodes.length;a++){let s=gt.get(r.childNodes[a]);s instanceof Jt&&(n=s.domAtPos(0))}for(let a=e.offset-1;!n&&a>=0;a--){let s=gt.get(r.childNodes[a]);s instanceof Jt&&(n=s.domAtPos(s.length))}return n?new yr(n.node,n.offset,!0):e}nearest(e){for(let r=e;r;){let n=gt.get(r);if(n&&n.rootView==this)return n;r=r.parentNode}return null}posFromDOM(e,r){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,r)+n.posAtStart}domAtPos(e){let{i:r,off:n}=this.childCursor().findPos(e,-1);for(;r<this.children.length-1;){let a=this.children[r];if(n<a.length||a instanceof Jt)break;r++,n=0}return this.children[r].domAtPos(n)}coordsAt(e,r){let n=null,a=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let l=this.children[o],u=s-l.breakAfter,c=u-l.length;if(u<e)break;if(c<=e&&(c<e||l.covers(-1))&&(u>e||l.covers(1))&&(!n||l instanceof Jt&&!(n instanceof Jt&&r>=0)))n=l,a=c;else if(n&&c==e&&u==e&&l instanceof oa&&Math.abs(r)<2){if(l.deco.startSide<0)break;o&&(n=null)}s=c}return n?n.coordsAt(e-a,r):null}coordsForChar(e){let{i:r,off:n}=this.childPos(e,1),a=this.children[r];if(!(a instanceof Jt))return null;for(;a.children.length;){let{i:l,off:u}=a.childPos(n,1);for(;;l++){if(l==a.children.length)return null;if((a=a.children[l]).length)break}n=u}if(!(a instanceof En))return null;let s=W.findClusterBreak(a.text,n);if(s==n)return null;let o=ua(a.dom,n,s).getClientRects();for(let l=0;l<o.length;l++){let u=o[l];if(l==o.length-1||u.top<u.bottom&&u.left<u.right)return u}return null}measureVisibleLineHeights(e){let r=[],{from:n,to:a}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,u=this.view.textDirection==oe.Direction.LTR;for(let c=0,f=0;f<this.children.length;f++){let h=this.children[f],d=c+h.length;if(d>a)break;if(c>=n){let p=h.dom.getBoundingClientRect();if(r.push(p.height),o){let g=h.dom.lastChild,m=g?us(g):[];if(m.length){let v=m[m.length-1],y=u?v.right-p.left:p.right-v.left;y>l&&(l=y,this.minWidth=s,this.minWidthFrom=c,this.minWidthTo=d)}}}c=d+h.breakAfter}return r}textDirectionAt(e){let{i:r}=this.childPos(e,1);return getComputedStyle(this.children[r].dom).direction=="rtl"?oe.Direction.RTL:oe.Direction.LTR}measureTextSize(){for(let s of this.children)if(s instanceof Jt){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),r,n,a;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=us(e.firstChild)[0];r=e.getBoundingClientRect().height,n=s?s.width/27:7,a=s?s.height:r,e.remove()}),{lineHeight:r,charWidth:n,textHeight:a}}childCursor(e=this.length){let r=this.children.length;return r&&(e-=this.children[--r].length),new hc(this.children,e,r)}computeBlockGapDeco(){let e=[],r=this.view.viewState;for(let n=0,a=0;;a++){let s=a==r.viewports.length?null:r.viewports[a],o=s?s.from-1:this.length;if(o>n){let l=(r.lineBlockAt(o).bottom-r.lineBlockAt(n).top)/this.view.scaleY;e.push(ut.replace({widget:new Uo(l),block:!0,inclusive:!0,isBlockGap:!0}).range(n,o))}if(!s)break;n=s.to+1}return ut.set(e)}updateDeco(){let e=1,r=this.view.state.facet(Wo).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),n=!1,a=this.view.state.facet(L_).map((s,o)=>{let l=typeof s=="function";return l&&(n=!0),l?s(this.view):s});for(a.length&&(this.dynamicDecorationMap[e++]=n,r.push(W.RangeSet.join(a))),this.decorations=[this.editContextFormatting,...r,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(O_))try{if(c(this.view,e.range,e))return!0}catch(f){cn(this.view.state,f,"scroll handler")}let{range:r}=e,n=this.coordsAt(r.head,r.empty?r.assoc:r.head>r.anchor?-1:1),a;if(!n)return;!r.empty&&(a=this.coordsAt(r.anchor,r.anchor>r.head?-1:1))&&(n={left:Math.min(n.left,a.left),top:Math.min(n.top,a.top),right:Math.max(n.right,a.right),bottom:Math.max(n.bottom,a.bottom)});let s=Lp(this.view),o={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:l,offsetHeight:u}=this.view.scrollDOM;Wq(this.view.scrollDOM,o,r.head<r.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,l),-l),Math.max(Math.min(e.yMargin,u),-u),this.view.textDirection==oe.Direction.LTR)}};function lV(t){return t.node.nodeType==1&&t.node.firstChild&&(t.offset==0||t.node.childNodes[t.offset-1].contentEditable=="false")&&(t.offset==t.node.childNodes.length||t.node.childNodes[t.offset].contentEditable=="false")}function q_(t,e){let r=t.observer.selectionRange;if(!r.focusNode)return null;let n=l_(r.focusNode,r.focusOffset),a=u_(r.focusNode,r.focusOffset),s=n||a;if(a&&n&&a.node!=n.node){let l=gt.get(a.node);if(!l||l instanceof En&&l.text!=a.node.nodeValue)s=a;else if(t.docView.lastCompositionAfterCursor){let u=gt.get(n.node);!u||u instanceof En&&u.text!=n.node.nodeValue||(s=a)}}if(t.docView.lastCompositionAfterCursor=s!=n,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function uV(t,e,r){let n=q_(t,r);if(!n)return null;let{node:a,from:s,to:o}=n,l=a.nodeValue;if(/[\n\r]/.test(l)||t.state.doc.sliceString(n.from,n.to)!=l)return null;let u=e.invertedDesc,c=new fn(u.mapPos(s),u.mapPos(o),s,o),f=[];for(let h=a.parentNode;;h=h.parentNode){let d=gt.get(h);if(d instanceof bi)f.push({node:h,deco:d.mark});else{if(d instanceof Jt||h.nodeName=="DIV"&&h.parentNode==t.contentDOM)return{range:c,text:a,marks:f,line:h};if(h!=t.contentDOM)f.push({node:h,deco:new zo({inclusive:!0,attributes:Qq(h),tagName:h.tagName.toLowerCase()})});else return null}}}function cV(t,e){return t.nodeType!=1?0:(e&&t.childNodes[e-1].contentEditable=="false"?1:0)|(e<t.childNodes.length&&t.childNodes[e].contentEditable=="false"?2:0)}var fV=class{constructor(){this.changes=[]}compareRange(e,r){ac(e,r,this.changes)}comparePoint(e,r){ac(e,r,this.changes)}boundChange(e){ac(e,e,this.changes)}};function hV(t,e,r){let n=new fV;return W.RangeSet.compare(t,e,r,n),n.changes}function dV(t,e){for(let r=t;r&&r!=e;r=r.assignedSlot||r.parentNode)if(r.nodeType==1&&r.contentEditable=="false")return!0;return!1}function pV(t,e){let r=!1;return e&&t.iterChangedRanges((n,a)=>{n<e.to&&a>e.from&&(r=!0)}),r}function gV(t,e,r=1){let n=t.charCategorizer(e),a=t.doc.lineAt(e),s=e-a.from;if(a.length==0)return W.EditorSelection.cursor(e);s==0?r=1:s==a.length&&(r=-1);let o=s,l=s;r<0?o=W.findClusterBreak(a.text,s,!1):l=W.findClusterBreak(a.text,s);let u=n(a.text.slice(o,l));for(;o>0;){let c=W.findClusterBreak(a.text,o,!1);if(n(a.text.slice(c,o))!=u)break;o=c}for(;l<a.length;){let c=W.findClusterBreak(a.text,l);if(n(a.text.slice(l,c))!=u)break;l=c}return W.EditorSelection.range(o+a.from,l+a.from)}function vV(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function mV(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function Fd(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function Cw(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function Tw(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function ep(t,e,r){let n,a,s,o,l=!1,u,c,f,h;for(let g=t.firstChild;g;g=g.nextSibling){let m=us(g);for(let v=0;v<m.length;v++){let y=m[v];a&&Fd(a,y)&&(y=Cw(Tw(y,a.bottom),a.top));let b=vV(e,y),w=mV(r,y);if(b==0&&w==0)return g.nodeType==3?kw(g,e,r):ep(g,e,r);if(!n||o>w||o==w&&s>b){n=g,a=y,s=b,o=w;let _=w?r<y.top?-1:1:b?e<y.left?-1:1:0;l=!_||(_>0?v<m.length-1:v>0)}b==0?r>y.bottom&&(!f||f.bottom<y.bottom)?(u=g,f=y):r<y.top&&(!h||h.top>y.top)&&(c=g,h=y):f&&Fd(f,y)?f=Tw(f,y.bottom):h&&Fd(h,y)&&(h=Cw(h,y.top))}}if(f&&f.bottom>=r?(n=u,a=f):h&&h.top<=r&&(n=c,a=h),!n)return{node:t,offset:0};let d=Math.max(a.left,Math.min(a.right,e));if(n.nodeType==3)return kw(n,d,r);if(l&&n.contentEditable!="false")return ep(n,d,r);let p=Array.prototype.indexOf.call(t.childNodes,n)+(e>=(a.left+a.right)/2?1:0);return{node:t,offset:p}}function kw(t,e,r){let n=t.nodeValue.length,a=-1,s=1e9,o=0;for(let l=0;l<n;l++){let u=ua(t,l,l+1).getClientRects();for(let c=0;c<u.length;c++){let f=u[c];if(f.top==f.bottom)continue;o||(o=e-f.left);let h=(f.top>r?f.top-r:r-f.bottom)-1;if(f.left-1<=e&&f.right+1>=e&&h<s){let d=e>=(f.left+f.right)/2,p=d;if((he.chrome||he.gecko)&&ua(t,l).getBoundingClientRect().left==f.right&&(p=!d),h<=0)return{node:t,offset:l+(p?1:0)};a=l+(p?1:0),s=h}}}return{node:t,offset:a>-1?a:o>0?t.nodeValue.length:0}}function V_(t,e,r,n=-1){var a,s;let o=t.contentDOM.getBoundingClientRect(),l=o.top+t.viewState.paddingTop,u,{docHeight:c}=t.viewState,{x:f,y:h}=e,d=h-l;if(d<0)return 0;if(d>c)return t.state.doc.length;for(let _=t.viewState.heightOracle.textHeight/2,x=!1;u=t.elementAtHeight(d),u.type!=oe.BlockType.Text;)for(;d=n>0?u.bottom+_:u.top-_,!(d>=0&&d<=c);){if(x)return r?null:0;x=!0,n=-n}h=l+d;let p=u.from;if(p<t.viewport.from)return t.viewport.from==0?0:r?null:Aw(t,o,u,f,h);if(p>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:r?null:Aw(t,o,u,f,h);let g=t.dom.ownerDocument,m=t.root.elementFromPoint?t.root:g,v=m.elementFromPoint(f,h);v&&!t.contentDOM.contains(v)&&(v=null),v||(f=Math.max(o.left+1,Math.min(o.right-1,f)),v=m.elementFromPoint(f,h),v&&!t.contentDOM.contains(v)&&(v=null));let y,b=-1;if(v&&((a=t.docView.nearest(v))===null||a===void 0?void 0:a.isEditable)!=!1){if(g.caretPositionFromPoint){let _=g.caretPositionFromPoint(f,h);_&&({offsetNode:y,offset:b}=_)}else if(g.caretRangeFromPoint){let _=g.caretRangeFromPoint(f,h);_&&({startContainer:y,startOffset:b}=_,(!t.contentDOM.contains(y)||he.safari&&yV(y,b,f)||he.chrome&&bV(y,b,f))&&(y=void 0))}y&&(b=Math.min(xn(y),b))}if(!y||!t.docView.dom.contains(y)){let _=Jt.find(t.docView,p);if(!_)return d>u.top+u.height/2?u.to:u.from;({node:y,offset:b}=ep(_.dom,f,h))}let w=t.docView.nearest(y);if(!w)return null;if(w.isWidget&&((s=w.dom)===null||s===void 0?void 0:s.nodeType)==1){let _=w.dom.getBoundingClientRect();return e.y<_.top||e.y<=_.bottom&&e.x<=(_.left+_.right)/2?w.posAtStart:w.posAtEnd}else return w.localPosFromDOM(y,b)+w.posAtStart}function Aw(t,e,r,n,a){let s=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&r.height>t.defaultLineHeight*1.5){let l=t.viewState.heightOracle.textHeight,u=Math.floor((a-r.top-(t.defaultLineHeight-l)*.5)/l);s+=u*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(r.from,r.to);return r.from+W.findColumn(o,s,t.state.tabSize)}function yV(t,e,r){let n;if(t.nodeType!=3||e!=(n=t.nodeValue.length))return!1;for(let a=t.nextSibling;a;a=a.nextSibling)if(a.nodeType!=1||a.nodeName!="BR")return!1;return ua(t,n-1,n).getBoundingClientRect().left>r}function bV(t,e,r){if(e!=0)return!1;for(let a=t;;){let s=a.parentNode;if(!s||s.nodeType!=1||s.firstChild!=a)return!1;if(s.classList.contains("cm-line"))break;a=s}let n=t.nodeType==1?t.getBoundingClientRect():ua(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect();return r-n.left>5}function tp(t,e,r){let n=t.lineBlockAt(e);if(Array.isArray(n.type)){let a;for(let s of n.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;(!a||s.type==oe.BlockType.Text&&(a.type!=s.type||(r<0?s.from<e:s.to>e)))&&(a=s)}}return a||n}return n}function wV(t,e,r,n){let a=tp(t,e.head,e.assoc||-1),s=!n||a.type!=oe.BlockType.Text||!(t.lineWrapping||a.widgetLineBreaks)?null:t.coordsAtPos(e.assoc<0&&e.head>a.from?e.head-1:e.head);if(s){let o=t.dom.getBoundingClientRect(),l=t.textDirectionAt(a.from),u=t.posAtCoords({x:r==(l==oe.Direction.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(u!=null)return W.EditorSelection.cursor(u,r?-1:1)}return W.EditorSelection.cursor(r?a.to:a.from,r?-1:1)}function Mw(t,e,r,n){let a=t.state.doc.lineAt(e.head),s=t.bidiSpans(a),o=t.textDirectionAt(a.from);for(let l=e,u=null;;){let c=S_(a,s,o,l,r),f=E_;if(!c){if(a.number==(r?t.state.doc.lines:1))return l;f=`
`,a=t.state.doc.line(a.number+(r?1:-1)),s=t.bidiSpans(a),c=t.visualLineSide(a,!r)}if(u){if(!u(f))return l}else{if(!n)return c;u=n(f)}l=c}}function _V(t,e,r){let n=t.state.charCategorizer(e),a=n(r);return s=>{let o=n(s);return a==W.CharCategory.Space&&(a=o),a==o}}function xV(t,e,r,n){let a=e.head,s=r?1:-1;if(a==(r?t.state.doc.length:0))return W.EditorSelection.cursor(a,e.assoc);let o=e.goalColumn,l,u=t.contentDOM.getBoundingClientRect(),c=t.coordsAtPos(a,e.assoc||-1),f=t.documentTop;if(c)o==null&&(o=c.left-u.left),l=s<0?c.top:c.bottom;else{let p=t.viewState.lineBlockAt(a);o==null&&(o=Math.min(u.right-u.left,t.defaultCharacterWidth*(a-p.from))),l=(s<0?p.top:p.bottom)+f}let h=u.left+o,d=n??t.viewState.heightOracle.textHeight>>1;for(let p=0;;p+=10){let g=l+(d+p)*s,m=V_(t,{x:h,y:g},!1,s);if(g<u.top||g>u.bottom||(s<0?m<a:m>a)){let v=t.docView.coordsForChar(m),y=!v||g<v.top?-1:1;return W.EditorSelection.cursor(m,y,void 0,o)}}}function sc(t,e,r){for(;;){let n=0;for(let a of t)a.between(e-1,e+1,(s,o,l)=>{if(e>s&&e<o){let u=n||r||(e-s<o-e?-1:1);e=u<0?s:o,n=u}});if(!n)return e}}function qd(t,e,r){let n=sc(t.state.facet(Bp).map(a=>a(t)),r.from,e.head>r.from?-1:1);return n==r.from?r:W.EditorSelection.cursor(n,n<r.from?1:-1)}var ko="\uFFFF",rp=class{constructor(e,r){this.points=e,this.text="",this.lineSeparator=r.facet(W.EditorState.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=ko}readRange(e,r){if(!e)return this;let n=e.parentNode;for(let a=e;;){this.findPointBefore(n,a);let s=this.text.length;this.readNode(a);let o=a.nextSibling;if(o==r)break;let l=gt.get(a),u=gt.get(o);(l&&u?l.breakAfter:(l?l.breakAfter:fc(a))||fc(o)&&(a.nodeName!="BR"||a.cmIgnore)&&this.text.length>s)&&this.lineBreak(),a=o}return this.findPointBefore(n,r),this}readTextNode(e){let r=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,r.length));for(let n=0,a=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,l;if(this.lineSeparator?(s=r.indexOf(this.lineSeparator,n),o=this.lineSeparator.length):(l=a.exec(r))&&(s=l.index,o=l[0].length),this.append(r.slice(n,s<0?r.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let u of this.points)u.node==e&&u.pos>this.text.length&&(u.pos-=o-1);n=s+o}}readNode(e){if(e.cmIgnore)return;let r=gt.get(e),n=r&&r.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let a=n.iter();!a.next().done;)a.lineBreak?this.lineBreak():this.append(a.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,r){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==r&&(n.pos=this.text.length)}findPointInside(e,r){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(EV(e,n.node,n.offset)?r:0))}};function EV(t,e,r){for(;;){if(!e||r<xn(e))return!1;if(e==t)return!0;r=la(e)+1,e=e.parentNode}}var gc=class{constructor(e,r){this.node=e,this.offset=r,this.pos=-1}},np=class{constructor(e,r,n,a){this.typeOver=a,this.bounds=null,this.text="",this.domChanged=r>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&r>-1)this.newSel=null;else if(r>-1&&(this.bounds=e.docView.domBoundsAround(r,n,0))){let l=s||o?[]:TV(e),u=new rp(l,e.state);u.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=u.text,this.newSel=kV(l,this.bounds.from)}else{let l=e.observer.selectionRange,u=s&&s.node==l.focusNode&&s.offset==l.focusOffset||!Ud(e.contentDOM,l.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(l.focusNode,l.focusOffset),c=o&&o.node==l.anchorNode&&o.offset==l.anchorOffset||!Ud(e.contentDOM,l.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(l.anchorNode,l.anchorOffset),f=e.viewport;if((he.ios||he.chrome)&&e.state.selection.main.empty&&u!=c&&(f.from>0||f.to<e.state.doc.length)){let h=Math.min(u,c),d=Math.max(u,c),p=f.from-h,g=f.to-d;(p==0||p==1||h==0)&&(g==0||g==-1||d==e.state.doc.length)&&(u=0,c=e.state.doc.length)}this.newSel=W.EditorSelection.single(c,u)}}};function z_(t,e){let r,{newSel:n}=e,a=t.state.selection.main,s=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:l}=e.bounds,u=a.from,c=null;(s===8||he.android&&e.text.length<l-o)&&(u=a.to,c="end");let f=CV(t.state.doc.sliceString(o,l,ko),e.text,u-o,c);f&&(he.chrome&&s==13&&f.toB==f.from+2&&e.text.slice(f.from,f.toB)==ko+ko&&f.toB--,r={from:o+f.from,to:o+f.toA,insert:W.Text.of(e.text.slice(f.from,f.toB).split(ko))})}else n&&(!t.hasFocus&&t.state.facet(Kn)||n.main.eq(a))&&(n=null);if(!r&&!n)return!1;if(!r&&e.typeOver&&!a.empty&&n&&n.main.empty?r={from:a.from,to:a.to,insert:t.state.doc.slice(a.from,a.to)}:(he.mac||he.android)&&r&&r.from==r.to&&r.from==a.head-1&&/^\. ?$/.test(r.insert.toString())&&t.contentDOM.getAttribute("autocorrect")=="off"?(n&&r.insert.length==2&&(n=W.EditorSelection.single(n.main.anchor-1,n.main.head-1)),r={from:r.from,to:r.to,insert:W.Text.of([r.insert.toString().replace("."," ")])}):r&&r.from>=a.from&&r.to<=a.to&&(r.from!=a.from||r.to!=a.to)&&a.to-a.from-(r.to-r.from)<=4?r={from:a.from,to:a.to,insert:t.state.doc.slice(a.from,r.from).append(r.insert).append(t.state.doc.slice(r.to,a.to))}:he.chrome&&r&&r.from==r.to&&r.from==a.head&&r.insert.toString()==`
 `&&t.lineWrapping&&(n&&(n=W.EditorSelection.single(n.main.anchor-1,n.main.head-1)),r={from:a.from,to:a.to,insert:W.Text.of([" "])}),r)return Np(t,r,n,s);if(n&&!n.main.eq(a)){let o=!1,l="select";return t.inputState.lastSelectionTime>Date.now()-50&&(t.inputState.lastSelectionOrigin=="select"&&(o=!0),l=t.inputState.lastSelectionOrigin),t.dispatch({selection:n,scrollIntoView:o,userEvent:l}),!0}else return!1}function Np(t,e,r,n=-1){if(he.ios&&t.inputState.flushIOSKey(e))return!0;let a=t.state.selection.main;if(he.android&&(e.to==a.to&&(e.from==a.from||e.from==a.from-1&&t.state.sliceDoc(e.from,a.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&os(t.contentDOM,"Enter",13)||(e.from==a.from-1&&e.to==a.to&&e.insert.length==0||n==8&&e.insert.length<e.to-e.from&&e.to>a.head)&&os(t.contentDOM,"Backspace",8)||e.from==a.from&&e.to==a.to+1&&e.insert.length==0&&os(t.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let o,l=()=>o||(o=SV(t,e,r));return t.state.facet(M_).some(u=>u(t,e.from,e.to,s,l))||t.dispatch(l()),!0}function SV(t,e,r){let n,a=t.state,s=a.selection.main;if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!r||r.main.empty&&r.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let l=s.from<e.from?a.sliceDoc(s.from,e.from):"",u=s.to>e.to?a.sliceDoc(e.to,s.to):"";n=a.replaceSelection(t.state.toText(l+e.insert.sliceString(0,void 0,t.state.lineBreak)+u))}else{let l=a.changes(e),u=r&&r.main.to<=l.newLength?r.main:void 0;if(a.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let c=t.state.sliceDoc(e.from,e.to),f,h=r&&q_(t,r.main.head);if(h){let g=e.insert.length-(e.to-e.from);f={from:h.from,to:h.to-g}}else f=t.state.doc.lineAt(s.head);let d=s.to-e.to,p=s.to-s.from;n=a.changeByRange(g=>{if(g.from==s.from&&g.to==s.to)return{changes:l,range:u||g.map(l)};let m=g.to-d,v=m-c.length;if(g.to-g.from!=p||t.state.sliceDoc(v,m)!=c||g.to>=f.from&&g.from<=f.to)return{range:g};let y=a.changes({from:v,to:m,insert:e.insert}),b=g.to-s.to;return{changes:y,range:u?W.EditorSelection.range(Math.max(0,u.anchor+b),Math.max(0,u.head+b)):g.map(y)}})}else n={changes:l,selection:u&&a.selection.replaceRange(u)}}let o="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,o+=".compose",t.inputState.compositionFirstChange&&(o+=".start",t.inputState.compositionFirstChange=!1)),a.update(n,{userEvent:o,scrollIntoView:!0})}function CV(t,e,r,n){let a=Math.min(t.length,e.length),s=0;for(;s<a&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==a&&t.length==e.length)return null;let o=t.length,l=e.length;for(;o>0&&l>0&&t.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if(n=="end"){let u=Math.max(0,s-Math.min(o,l));r-=o+u-s}if(o<s&&t.length<e.length){let u=r<=s&&r>=o?s-r:0;s-=u,l=s+(l-o),o=s}else if(l<s){let u=r<=s&&r>=l?s-r:0;s-=u,o=s+(o-l),l=s}return{from:s,toA:o,toB:l}}function TV(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:r,anchorOffset:n,focusNode:a,focusOffset:s}=t.observer.selectionRange;return r&&(e.push(new gc(r,n)),(a!=r||s!=n)&&e.push(new gc(a,s))),e}function kV(t,e){if(t.length==0)return null;let r=t[0].pos,n=t.length==2?t[1].pos:r;return r>-1&&n>-1?W.EditorSelection.single(r+e,n+e):null}var ip=class{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,he.safari&&e.contentDOM.addEventListener("input",()=>null),he.gecko&&HV(e.contentDOM.ownerDocument)}handleEvent(e){!IV(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,r){let n=this.handlers[e];if(n){for(let a of n.observers)a(this.view,r);for(let a of n.handlers){if(r.defaultPrevented)break;if(a(this.view,r)){r.preventDefault();break}}}}ensureHandlers(e){let r=AV(e),n=this.handlers,a=this.view.contentDOM;for(let s in r)if(s!="scroll"){let o=!r[s].handlers.length,l=n[s];l&&o!=!l.handlers.length&&(a.removeEventListener(s,this.handleEvent),l=null),l||a.addEventListener(s,this.handleEvent,{passive:o})}for(let s in n)s!="scroll"&&!r[s]&&a.removeEventListener(s,this.handleEvent);this.handlers=r}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&U_.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),he.android&&he.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let r;return he.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((r=H_.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||MV.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=r||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let r=this.pendingIOSKey;return!r||r.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,os(this.view.contentDOM,r.key,r.keyCode,r instanceof KeyboardEvent?r:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:he.safari&&!he.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}};function Pw(t,e){return(r,n)=>{try{return e.call(t,n,r)}catch(a){cn(r.state,a)}}}function AV(t){let e=Object.create(null);function r(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of t){let a=n.spec;if(a&&a.domEventHandlers)for(let s in a.domEventHandlers){let o=a.domEventHandlers[s];o&&r(s).handlers.push(Pw(n.value,o))}if(a&&a.domEventObservers)for(let s in a.domEventObservers){let o=a.domEventObservers[s];o&&r(s).observers.push(Pw(n.value,o))}}for(let n in hn)r(n).handlers.push(hn[n]);for(let n in Yr)r(n).observers.push(Yr[n]);return e}var H_=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],MV="dthko",U_=[16,17,18,20,91,92,224,225],$u=6;function Qu(t){return Math.max(0,t)*.7+8}function PV(t,e){return Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))}var ap=class{constructor(e,r,n,a){this.view=e,this.startEvent=r,this.style=n,this.mustSelect=a,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=r,this.scrollParents=Gq(e.contentDOM),this.atoms=e.state.facet(Bp).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=r.shiftKey,this.multiple=e.state.facet(W.EditorState.allowMultipleSelections)&&RV(e,r),this.dragging=OV(e,r)&&K_(r)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&PV(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let r=0,n=0,a=0,s=0,o=this.view.win.innerWidth,l=this.view.win.innerHeight;this.scrollParents.x&&({left:a,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:l}=this.scrollParents.y.getBoundingClientRect());let u=Lp(this.view);e.clientX-u.left<=a+$u?r=-Qu(a-e.clientX):e.clientX+u.right>=o-$u&&(r=Qu(e.clientX-o)),e.clientY-u.top<=s+$u?n=-Qu(s-e.clientY):e.clientY+u.bottom>=l-$u&&(n=Qu(e.clientY-l)),this.setScrollSpeed(r,n)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,r){this.scrollSpeed={x:e,y:r},e||r?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:r}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),r&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=r,r=0),(e||r)&&this.view.win.scrollBy(e,r),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let r=null;for(let n=0;n<e.ranges.length;n++){let a=e.ranges[n],s=null;if(a.empty){let o=sc(this.atoms,a.from,0);o!=a.from&&(s=W.EditorSelection.cursor(o,-1))}else{let o=sc(this.atoms,a.from,-1),l=sc(this.atoms,a.to,1);(o!=a.from||l!=a.to)&&(s=W.EditorSelection.range(a.from==a.anchor?o:l,a.from==a.head?o:l))}s&&(r||(r=e.ranges.slice()),r[n]=s)}return r?W.EditorSelection.create(r,e.mainIndex):e}select(e){let{view:r}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(r.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(r=>r.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}};function RV(t,e){let r=t.state.facet(C_);return r.length?r[0](e):he.mac?e.metaKey:e.ctrlKey}function DV(t,e){let r=t.state.facet(T_);return r.length?r[0](e):he.mac?!e.altKey:!e.ctrlKey}function OV(t,e){let{main:r}=t.state.selection;if(r.empty)return!1;let n=Fo(t.root);if(!n||n.rangeCount==0)return!0;let a=n.getRangeAt(0).getClientRects();for(let s=0;s<a.length;s++){let o=a[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function IV(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r=e.target,n;r!=t.contentDOM;r=r.parentNode)if(!r||r.nodeType==11||(n=gt.get(r))&&n.ignoreEvent(e))return!1;return!0}var hn=Object.create(null),Yr=Object.create(null),W_=he.ie&&he.ie_version<15||he.ios&&he.webkit_version<604;function BV(t){let e=t.dom.parentNode;if(!e)return;let r=e.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{t.focus(),r.remove(),G_(t,r.value)},50)}function Ac(t,e,r){for(let n of t.facet(e))r=n(r,t);return r}function G_(t,e){e=Ac(t.state,Op,e);let{state:r}=t,n,a=1,s=r.toText(e),o=s.lines==r.selection.ranges.length;if(sp!=null&&r.selection.ranges.every(u=>u.empty)&&sp==s.toString()){let u=-1;n=r.changeByRange(c=>{let f=r.doc.lineAt(c.from);if(f.from==u)return{range:c};u=f.from;let h=r.toText((o?s.line(a++).text:e)+r.lineBreak);return{changes:{from:f.from,insert:h},range:W.EditorSelection.cursor(c.from+h.length)}})}else o?n=r.changeByRange(u=>{let c=s.line(a++);return{changes:{from:u.from,to:u.to,insert:c.text},range:W.EditorSelection.cursor(u.from+c.length)}}):n=r.replaceSelection(s);t.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}Yr.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft};hn.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),e.keyCode==27&&t.inputState.tabFocusMode!=0&&(t.inputState.tabFocusMode=Date.now()+2e3),!1);Yr.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")};Yr.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")};hn.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let r=null;for(let n of t.state.facet(k_))if(r=n(t,e),r)break;if(!r&&e.button==0&&(r=FV(t,e)),r){let n=!t.hasFocus;t.inputState.startMouseSelection(new ap(t,e,r,n)),n&&t.observer.ignore(()=>{a_(t.contentDOM);let s=t.root.activeElement;s&&!s.contains(t.contentDOM)&&s.blur()});let a=t.inputState.mouseSelection;if(a)return a.start(e),a.dragging===!1}return!1};function Rw(t,e,r,n){if(n==1)return W.EditorSelection.cursor(e,r);if(n==2)return gV(t.state,e,r);{let a=Jt.find(t.docView,e),s=t.state.doc.lineAt(a?a.posAtEnd:e),o=a?a.posAtStart:s.from,l=a?a.posAtEnd:s.to;return l<t.state.doc.length&&l==s.to&&l++,W.EditorSelection.range(o,l)}}var Dw=(t,e,r)=>e>=r.top&&e<=r.bottom&&t>=r.left&&t<=r.right;function LV(t,e,r,n){let a=Jt.find(t.docView,e);if(!a)return 1;let s=e-a.posAtStart;if(s==0)return 1;if(s==a.length)return-1;let o=a.coordsAt(s,-1);if(o&&Dw(r,n,o))return-1;let l=a.coordsAt(s,1);return l&&Dw(r,n,l)?1:o&&o.bottom>=n?-1:1}function Ow(t,e){let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:r,bias:LV(t,r,e.clientX,e.clientY)}}var NV=he.ie&&he.ie_version<=11,Iw=null,Bw=0,Lw=0;function K_(t){if(!NV)return t.detail;let e=Iw,r=Lw;return Iw=t,Lw=Date.now(),Bw=!e||r>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(Bw+1)%3:1}function FV(t,e){let r=Ow(t,e),n=K_(e),a=t.state.selection;return{update(s){s.docChanged&&(r.pos=s.changes.mapPos(r.pos),a=a.map(s.changes))},get(s,o,l){let u=Ow(t,s),c,f=Rw(t,u.pos,u.bias,n);if(r.pos!=u.pos&&!o){let h=Rw(t,r.pos,r.bias,n),d=Math.min(h.from,f.from),p=Math.max(h.to,f.to);f=d<f.from?W.EditorSelection.range(d,p):W.EditorSelection.range(p,d)}return o?a.replaceRange(a.main.extend(f.from,f.to)):l&&n==1&&a.ranges.length>1&&(c=qV(a,u.pos))?c:l?a.addRange(f):W.EditorSelection.create([f])}}}function qV(t,e){for(let r=0;r<t.ranges.length;r++){let{from:n,to:a}=t.ranges[r];if(n<=e&&a>=e)return W.EditorSelection.create(t.ranges.slice(0,r).concat(t.ranges.slice(r+1)),t.mainIndex==r?0:t.mainIndex-(t.mainIndex>r?1:0))}return null}hn.dragstart=(t,e)=>{let{selection:{main:r}}=t.state;if(e.target.draggable){let a=t.docView.nearest(e.target);if(a&&a.isWidget){let s=a.posAtStart,o=s+a.length;(s>=r.to||o<=r.from)&&(r=W.EditorSelection.range(s,o))}}let{inputState:n}=t;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=r,e.dataTransfer&&(e.dataTransfer.setData("Text",Ac(t.state,Ip,t.state.sliceDoc(r.from,r.to))),e.dataTransfer.effectAllowed="copyMove"),!1};hn.dragend=t=>(t.inputState.draggedContent=null,!1);function Nw(t,e,r,n){if(r=Ac(t.state,Op,r),!r)return;let a=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=t.inputState,o=n&&s&&DV(t,e)?{from:s.from,to:s.to}:null,l={from:a,insert:r},u=t.state.changes(o?[o,l]:l);t.focus(),t.dispatch({changes:u,selection:{anchor:u.mapPos(a,-1),head:u.mapPos(a,1)},userEvent:o?"move.drop":"input.drop"}),t.inputState.draggedContent=null}hn.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let r=e.dataTransfer.files;if(r&&r.length){let n=Array(r.length),a=0,s=()=>{++a==r.length&&Nw(t,e,n.filter(o=>o!=null).join(t.state.lineBreak),!1)};for(let o=0;o<r.length;o++){let l=new FileReader;l.onerror=s,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(n[o]=l.result),s()},l.readAsText(r[o])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return Nw(t,e,n,!0),!0}return!1};hn.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let r=W_?null:e.clipboardData;return r?(G_(t,r.getData("text/plain")||r.getData("text/uri-list")),!0):(BV(t),!1)};function VV(t,e){let r=t.dom.parentNode;if(!r)return;let n=r.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),t.focus()},50)}function zV(t){let e=[],r=[],n=!1;for(let a of t.selection.ranges)a.empty||(e.push(t.sliceDoc(a.from,a.to)),r.push(a));if(!e.length){let a=-1;for(let{from:s}of t.selection.ranges){let o=t.doc.lineAt(s);o.number>a&&(e.push(o.text),r.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),a=o.number}n=!0}return{text:Ac(t,Ip,e.join(t.lineBreak)),ranges:r,linewise:n}}var sp=null;hn.copy=hn.cut=(t,e)=>{let{text:r,ranges:n,linewise:a}=zV(t.state);if(!r&&!a)return!1;sp=a?r:null,e.type=="cut"&&!t.state.readOnly&&t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let s=W_?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",r),!0):(VV(t,r),!1)};var j_=W.Annotation.define();function Y_(t,e){let r=[];for(let n of t.facet(P_)){let a=n(t,e);a&&r.push(a)}return r.length?t.update({effects:r,annotations:j_.of(!0)}):null}function Z_(t){setTimeout(()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let r=Y_(t.state,e);r?t.dispatch(r):t.update([])}},10)}Yr.focus=t=>{t.inputState.lastFocusTime=Date.now(),!t.scrollDOM.scrollTop&&(t.inputState.lastScrollTop||t.inputState.lastScrollLeft)&&(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),Z_(t)};Yr.blur=t=>{t.observer.clearSelectionRange(),Z_(t)};Yr.compositionstart=Yr.compositionupdate=t=>{t.observer.editContext||(t.inputState.compositionFirstChange==null&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))};Yr.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,he.chrome&&he.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(()=>t.observer.flush()):setTimeout(()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])},50))};Yr.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()};hn.beforeinput=(t,e)=>{var r,n;if(e.inputType=="insertReplacementText"&&t.observer.editContext){let s=(r=e.dataTransfer)===null||r===void 0?void 0:r.getData("text/plain"),o=e.getTargetRanges();if(s&&o.length){let l=o[0],u=t.posAtDOM(l.startContainer,l.startOffset),c=t.posAtDOM(l.endContainer,l.endOffset);return Np(t,{from:u,to:c,insert:t.state.toText(s)},null),!0}}let a;if(he.chrome&&he.android&&(a=H_.find(s=>s.inputType==e.inputType))&&(t.observer.delayAndroidKey(a.key,a.keyCode),a.key=="Backspace"||a.key=="Delete")){let s=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())},100)}return he.ios&&e.inputType=="deleteContentForward"&&t.observer.flushSoon(),he.safari&&e.inputType=="insertText"&&t.inputState.composing>=0&&setTimeout(()=>Yr.compositionend(t,e),20),!1};var Fw=new Set;function HV(t){Fw.has(t)||(Fw.add(t),t.addEventListener("copy",()=>{}),t.addEventListener("cut",()=>{}))}var qw=["pre-wrap","normal","pre-line","break-spaces"],fa=!1;function op(){fa=!1}var vc=class{constructor(e){this.lineWrapping=e,this.doc=W.Text.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,r){let n=this.doc.lineAt(r).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((r-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return qw.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let r=!1;for(let n=0;n<e.length;n++){let a=e[n];a<0?n++:this.heightSamples[Math.floor(a*10)]||(r=!0,this.heightSamples[Math.floor(a*10)]=!0)}return r}refresh(e,r,n,a,s,o){let l=qw.indexOf(e)>-1,u=Math.round(r)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=r,this.charWidth=n,this.textHeight=a,this.lineLength=s,u){this.heightSamples={};for(let c=0;c<o.length;c++){let f=o[c];f<0?c++:this.heightSamples[Math.floor(f*10)]=!0}}return u}},mc=class{constructor(e,r){this.from=e,this.heights=r,this.index=0}get more(){return this.index<this.heights.length}},ln=class t{constructor(e,r,n,a,s){this.from=e,this.length=r,this.top=n,this.height=a,this._content=s}get type(){return typeof this._content=="number"?oe.BlockType.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof wi?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let r=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new t(this.from,this.length+e.length,this.top,this.height+e.height,r)}},pt;(function(t){t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight"})(pt||(pt={}));var oc=.001,kr=class t{constructor(e,r,n=2){this.length=e,this.height=r,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>oc&&(fa=!0),this.height=e)}replace(e,r,n){return t.of(n)}decomposeLeft(e,r){r.push(this)}decomposeRight(e,r){r.push(this)}applyChanges(e,r,n,a){let s=this,o=n.doc;for(let l=a.length-1;l>=0;l--){let{fromA:u,toA:c,fromB:f,toB:h}=a[l],d=s.lineAt(u,pt.ByPosNoHeight,n.setDoc(r),0,0),p=d.to>=c?d:s.lineAt(c,pt.ByPosNoHeight,n,0,0);for(h+=p.to-c,c=p.to;l>0&&d.from<=a[l-1].toA;)u=a[l-1].fromA,f=a[l-1].fromB,l--,u<d.from&&(d=s.lineAt(u,pt.ByPosNoHeight,n,0,0));f+=d.from-u,u=d.from;let g=up.build(n.setDoc(o),e,f,h);s=yc(s,s.replace(u,c,g))}return s.updateHeight(n,0)}static empty(){return new jr(0,0)}static of(e){if(e.length==1)return e[0];let r=0,n=e.length,a=0,s=0;for(;;)if(r==n)if(a>s*2){let l=e[r-1];l.break?e.splice(--r,1,l.left,null,l.right):e.splice(--r,1,l.left,l.right),n+=1+l.break,a-=l.size}else if(s>a*2){let l=e[n];l.break?e.splice(n,1,l.left,null,l.right):e.splice(n,1,l.left,l.right),n+=2+l.break,s-=l.size}else break;else if(a<s){let l=e[r++];l&&(a+=l.size)}else{let l=e[--n];l&&(s+=l.size)}let o=0;return e[r-1]==null?(o=1,r--):e[r]==null&&(o=1,n++),new lp(t.of(e.slice(0,r)),o,t.of(e.slice(n)))}};function yc(t,e){return t==e?t:(t.constructor!=e.constructor&&(fa=!0),e)}kr.prototype.size=1;var bc=class extends kr{constructor(e,r,n){super(e,r),this.deco=n}blockAt(e,r,n,a){return new ln(a,this.length,n,this.height,this.deco||0)}lineAt(e,r,n,a,s){return this.blockAt(0,n,a,s)}forEachLine(e,r,n,a,s,o){e<=s+this.length&&r>=s&&o(this.blockAt(0,n,a,s))}updateHeight(e,r=0,n=!1,a){return a&&a.from<=r&&a.more&&this.setHeight(a.heights[a.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}},jr=class t extends bc{constructor(e,r){super(e,r,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,r,n,a){return new ln(a,this.length,n,this.height,this.breaks)}replace(e,r,n){let a=n[0];return n.length==1&&(a instanceof t||a instanceof yi&&a.flags&4)&&Math.abs(this.length-a.length)<10?(a instanceof yi?a=new t(a.length,this.height):a.height=this.height,this.outdated||(a.outdated=!1),a):kr.of(n)}updateHeight(e,r=0,n=!1,a){return a&&a.from<=r&&a.more?this.setHeight(a.heights[a.index++]):(n||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}},yi=class t extends kr{constructor(e){super(e,0)}heightMetrics(e,r){let n=e.doc.lineAt(r).number,a=e.doc.lineAt(r+this.length).number,s=a-n+1,o,l=0;if(e.lineWrapping){let u=Math.min(this.height,e.lineHeight*s);o=u/s,this.length>s+1&&(l=(this.height-u)/(this.length-s-1))}else o=this.height/s;return{firstLine:n,lastLine:a,perLine:o,perChar:l}}blockAt(e,r,n,a){let{firstLine:s,lastLine:o,perLine:l,perChar:u}=this.heightMetrics(r,a);if(r.lineWrapping){let c=a+(e<r.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),f=r.doc.lineAt(c),h=l+f.length*u,d=Math.max(n,e-h/2);return new ln(f.from,f.length,d,h,0)}else{let c=Math.max(0,Math.min(o-s,Math.floor((e-n)/l))),{from:f,length:h}=r.doc.line(s+c);return new ln(f,h,n+l*c,l,0)}}lineAt(e,r,n,a,s){if(r==pt.ByHeight)return this.blockAt(e,n,a,s);if(r==pt.ByPosNoHeight){let{from:p,to:g}=n.doc.lineAt(e);return new ln(p,g-p,0,0,0)}let{firstLine:o,perLine:l,perChar:u}=this.heightMetrics(n,s),c=n.doc.lineAt(e),f=l+c.length*u,h=c.number-o,d=a+l*h+u*(c.from-s-h);return new ln(c.from,c.length,Math.max(a,Math.min(d,a+this.height-f)),f,0)}forEachLine(e,r,n,a,s,o){e=Math.max(e,s),r=Math.min(r,s+this.length);let{firstLine:l,perLine:u,perChar:c}=this.heightMetrics(n,s);for(let f=e,h=a;f<=r;){let d=n.doc.lineAt(f);if(f==e){let g=d.number-l;h+=u*g+c*(e-s-g)}let p=u+c*d.length;o(new ln(d.from,d.length,h,p,0)),h+=p,f=d.to+1}}replace(e,r,n){let a=this.length-r;if(a>0){let s=n[n.length-1];s instanceof t?n[n.length-1]=new t(s.length+a):n.push(null,new t(a-1))}if(e>0){let s=n[0];s instanceof t?n[0]=new t(e+s.length):n.unshift(new t(e-1),null)}return kr.of(n)}decomposeLeft(e,r){r.push(new t(e-1),null)}decomposeRight(e,r){r.push(null,new t(this.length-e-1))}updateHeight(e,r=0,n=!1,a){let s=r+this.length;if(a&&a.from<=r+this.length&&a.more){let o=[],l=Math.max(r,a.from),u=-1;for(a.from>r&&o.push(new t(a.from-r-1).updateHeight(e,r));l<=s&&a.more;){let f=e.doc.lineAt(l).length;o.length&&o.push(null);let h=a.heights[a.index++];u==-1?u=h:Math.abs(h-u)>=oc&&(u=-2);let d=new jr(f,h);d.outdated=!1,o.push(d),l+=f+1}l<=s&&o.push(null,new t(s-l).updateHeight(e,l));let c=kr.of(o);return(u<0||Math.abs(c.height-this.height)>=oc||Math.abs(u-this.heightMetrics(e,r).perLine)>=oc)&&(fa=!0),yc(this,c)}else(n||this.outdated)&&(this.setHeight(e.heightForGap(r,r+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}},lp=class extends kr{constructor(e,r,n){super(e.length+r+n.length,e.height+n.height,r|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,r,n,a){let s=n+this.left.height;return e<s?this.left.blockAt(e,r,n,a):this.right.blockAt(e,r,s,a+this.left.length+this.break)}lineAt(e,r,n,a,s){let o=a+this.left.height,l=s+this.left.length+this.break,u=r==pt.ByHeight?e<o:e<l,c=u?this.left.lineAt(e,r,n,a,s):this.right.lineAt(e,r,n,o,l);if(this.break||(u?c.to<l:c.from>l))return c;let f=r==pt.ByPosNoHeight?pt.ByPosNoHeight:pt.ByPos;return u?c.join(this.right.lineAt(l,f,n,o,l)):this.left.lineAt(l,f,n,a,s).join(c)}forEachLine(e,r,n,a,s,o){let l=a+this.left.height,u=s+this.left.length+this.break;if(this.break)e<u&&this.left.forEachLine(e,r,n,a,s,o),r>=u&&this.right.forEachLine(e,r,n,l,u,o);else{let c=this.lineAt(u,pt.ByPos,n,a,s);e<c.from&&this.left.forEachLine(e,c.from-1,n,a,s,o),c.to>=e&&c.from<=r&&o(c),r>c.to&&this.right.forEachLine(c.to+1,r,n,l,u,o)}}replace(e,r,n){let a=this.left.length+this.break;if(r<a)return this.balanced(this.left.replace(e,r,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-a,r-a,n));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let l of n)s.push(l);if(e>0&&Vw(s,o-1),r<this.length){let l=s.length;this.decomposeRight(r,s),Vw(s,l)}return kr.of(s)}decomposeLeft(e,r){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,r);r.push(this.left),this.break&&(n++,e>=n&&r.push(null)),e>n&&this.right.decomposeLeft(e-n,r)}decomposeRight(e,r){let n=this.left.length,a=n+this.break;if(e>=a)return this.right.decomposeRight(e-a,r);e<n&&this.left.decomposeRight(e,r),this.break&&e<a&&r.push(null),r.push(this.right)}balanced(e,r){return e.size>2*r.size||r.size>2*e.size?kr.of(this.break?[e,null,r]:[e,r]):(this.left=yc(this.left,e),this.right=yc(this.right,r),this.setHeight(e.height+r.height),this.outdated=e.outdated||r.outdated,this.size=e.size+r.size,this.length=e.length+this.break+r.length,this)}updateHeight(e,r=0,n=!1,a){let{left:s,right:o}=this,l=r+s.length+this.break,u=null;return a&&a.from<=r+s.length&&a.more?u=s=s.updateHeight(e,r,n,a):s.updateHeight(e,r,n),a&&a.from<=l+o.length&&a.more?u=o=o.updateHeight(e,l,n,a):o.updateHeight(e,l,n),u?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}};function Vw(t,e){let r,n;t[e]==null&&(r=t[e-1])instanceof yi&&(n=t[e+1])instanceof yi&&t.splice(e-1,3,new yi(r.length+1+n.length))}var UV=5,up=class t{constructor(e,r){this.pos=e,this.oracle=r,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,r){if(this.lineStart>-1){let n=Math.min(r,this.lineEnd),a=this.nodes[this.nodes.length-1];a instanceof jr?a.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new jr(n-this.pos,-1)),this.writtenTo=n,r>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=r}point(e,r,n){if(e<r||n.heightRelevant){let a=n.widget?n.widget.estimatedHeight:0,s=n.widget?n.widget.lineBreaks:0;a<0&&(a=this.oracle.lineHeight);let o=r-e;n.block?this.addBlock(new bc(o,a,n)):(o||s||a>=UV)&&this.addLineDeco(a,s,o)}else r>e&&this.span(e,r);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:r}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=r,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new jr(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,r){let n=new yi(r-e);return this.oracle.doc.lineAt(e).to==r&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof jr)return e;let r=new jr(0,-1);return this.nodes.push(r),r}addBlock(e){this.enterLine();let r=e.deco;r&&r.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,r&&r.endSide>0&&(this.covering=e)}addLineDeco(e,r,n){let a=this.ensureLine();a.length+=n,a.collapsed+=n,a.widgetHeight=Math.max(a.widgetHeight,e),a.breaks+=r,this.writtenTo=this.pos=this.pos+n}finish(e){let r=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(r instanceof jr)&&!this.isCovered?this.nodes.push(new jr(0,-1)):(this.writtenTo<this.pos||r==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let a of this.nodes)a instanceof jr&&a.updateHeight(this.oracle,n),n+=a?a.length:1;return this.nodes}static build(e,r,n,a){let s=new t(n,e);return W.RangeSet.spans(r,n,a,s,0),s.finish(n)}};function WV(t,e,r){let n=new cp;return W.RangeSet.compare(t,e,r,n,0),n.changes}var cp=class{constructor(){this.changes=[]}compareRange(){}comparePoint(e,r,n,a){(e<r||n&&n.heightRelevant||a&&a.heightRelevant)&&ac(e,r,this.changes,5)}};function GV(t,e){let r=t.getBoundingClientRect(),n=t.ownerDocument,a=n.defaultView||window,s=Math.max(0,r.left),o=Math.min(a.innerWidth,r.right),l=Math.max(0,r.top),u=Math.min(a.innerHeight,r.bottom);for(let c=t.parentNode;c&&c!=n.body;)if(c.nodeType==1){let f=c,h=window.getComputedStyle(f);if((f.scrollHeight>f.clientHeight||f.scrollWidth>f.clientWidth)&&h.overflow!="visible"){let d=f.getBoundingClientRect();s=Math.max(s,d.left),o=Math.min(o,d.right),l=Math.max(l,d.top),u=Math.min(c==t.parentNode?a.innerHeight:u,d.bottom)}c=h.position=="absolute"||h.position=="fixed"?f.offsetParent:f.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:s-r.left,right:Math.max(s,o)-r.left,top:l-(r.top+e),bottom:Math.max(l,u)-(r.top+e)}}function KV(t){let e=t.getBoundingClientRect(),r=t.ownerDocument.defaultView||window;return e.left<r.innerWidth&&e.right>0&&e.top<r.innerHeight&&e.bottom>0}function jV(t,e){let r=t.getBoundingClientRect();return{left:0,right:r.right-r.left,top:e,bottom:r.bottom-(r.top+e)}}var Io=class{constructor(e,r,n,a){this.from=e,this.to=r,this.size=n,this.displaySize=a}static same(e,r){if(e.length!=r.length)return!1;for(let n=0;n<e.length;n++){let a=e[n],s=r[n];if(a.from!=s.from||a.to!=s.to||a.size!=s.size)return!1}return!0}draw(e,r){return ut.replace({widget:new fp(this.displaySize*(r?e.scaleY:e.scaleX),r)}).range(this.from,this.to)}},fp=class extends jn{constructor(e,r){super(),this.size=e,this.vertical=r}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}},wc=class{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=zw,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=oe.Direction.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let r=e.facet(kc).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new vc(r),this.stateDeco=e.facet(Wo).filter(n=>typeof n!="function"),this.heightMap=kr.empty().applyChanges(this.stateDeco,W.Text.empty,this.heightOracle.setDoc(e.doc),[new fn(0,0,0,e.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ut.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:r}=this.state.selection;for(let n=0;n<=1;n++){let a=n?r.head:r.anchor;if(!e.some(({from:s,to:o})=>a>=s&&a<=o)){let{from:s,to:o}=this.lineBlockAt(a);e.push(new is(s,o))}}return this.viewports=e.sort((n,a)=>n.from-a.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?zw:new hp(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Ao(e,this.scaler))})}update(e,r=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(Wo).filter(f=>typeof f!="function");let a=e.changedRanges,s=fn.extendWithRanges(a,WV(n,this.stateDeco,e?e.changes:W.ChangeSet.empty(this.state.doc.length))),o=this.heightMap.height,l=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);op(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||fa)&&(e.flags|=2),l?(this.scrollAnchorPos=e.changes.mapPos(l.from,-1),this.scrollAnchorHeight=l.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let u=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(r&&(r.range.head<u.from||r.range.head>u.to)||!this.viewportIsAppropriate(u))&&(u=this.getViewport(0,r));let c=u.from!=this.viewport.from||u.to!=this.viewport.to;this.viewport=u,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),r&&(this.scrollTarget=r),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(D_)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let r=e.contentDOM,n=window.getComputedStyle(r),a=this.heightOracle,s=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?oe.Direction.RTL:oe.Direction.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),l=r.getBoundingClientRect(),u=o||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let c=0,f=0;if(l.width&&l.height){let{scaleX:_,scaleY:x}=i_(r,l);(_>.005&&Math.abs(this.scaleX-_)>.005||x>.005&&Math.abs(this.scaleY-x)>.005)&&(this.scaleX=_,this.scaleY=x,c|=16,o=u=!0)}let h=(parseInt(n.paddingTop)||0)*this.scaleY,d=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=h||this.paddingBottom!=d)&&(this.paddingTop=h,this.paddingBottom=d,c|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(a.lineWrapping&&(u=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=16);let p=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=p&&(this.scrollAnchorHeight=-1,this.scrollTop=p),this.scrolledToBottom=o_(e.scrollDOM);let g=(this.printing?jV:GV)(r,this.paddingTop),m=g.top-this.pixelViewport.top,v=g.bottom-this.pixelViewport.bottom;this.pixelViewport=g;let y=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(y!=this.inView&&(this.inView=y,y&&(u=!0)),!this.inView&&!this.scrollTarget&&!KV(e.dom))return 0;let b=l.width;if((this.contentDOMWidth!=b||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=e.scrollDOM.clientHeight,c|=16),u){let _=e.docView.measureVisibleLineHeights(this.viewport);if(a.mustRefreshForHeights(_)&&(o=!0),o||a.lineWrapping&&Math.abs(b-this.contentDOMWidth)>a.charWidth){let{lineHeight:x,charWidth:S,textHeight:E}=e.docView.measureTextSize();o=x>0&&a.refresh(s,x,S,E,b/S,_),o&&(e.docView.minWidth=0,c|=16)}m>0&&v>0?f=Math.max(m,v):m<0&&v<0&&(f=Math.min(m,v)),op();for(let x of this.viewports){let S=x.from==this.viewport.from?_:e.docView.measureVisibleLineHeights(x);this.heightMap=(o?kr.empty().applyChanges(this.stateDeco,W.Text.empty,this.heightOracle,[new fn(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(a,0,o,new mc(x.from,S))}fa&&(c|=2)}let w=!this.viewportIsAppropriate(this.viewport,f)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return w&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(f,this.scrollTarget),c|=this.updateForViewport()),(c&2||w)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,r){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),a=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:l}=this,u=new is(a.lineAt(o-n*1e3,pt.ByHeight,s,0,0).from,a.lineAt(l+(1-n)*1e3,pt.ByHeight,s,0,0).to);if(r){let{head:c}=r.range;if(c<u.from||c>u.to){let f=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=a.lineAt(c,pt.ByPos,s,0,0),d;r.y=="center"?d=(h.top+h.bottom)/2-f/2:r.y=="start"||r.y=="nearest"&&c<u.from?d=h.top:d=h.bottom-f,u=new is(a.lineAt(d-1e3/2,pt.ByHeight,s,0,0).from,a.lineAt(d+f+1e3/2,pt.ByHeight,s,0,0).to)}}return u}mapViewport(e,r){let n=r.mapPos(e.from,-1),a=r.mapPos(e.to,1);return new is(this.heightMap.lineAt(n,pt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(a,pt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:r},n=0){if(!this.inView)return!0;let{top:a}=this.heightMap.lineAt(e,pt.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(r,pt.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:l}=this;return(e==0||a<=o-Math.max(10,Math.min(-n,250)))&&(r==this.state.doc.length||s>=l+Math.max(10,Math.min(n,250)))&&a>o-2*1e3&&s<l+2*1e3}mapLineGaps(e,r){if(!e.length||r.empty)return e;let n=[];for(let a of e)r.touchesRange(a.from,a.to)||n.push(new Io(r.mapPos(a.from),r.mapPos(a.to),a.size,a.displaySize));return n}ensureLineGaps(e,r){let n=this.heightOracle.lineWrapping,a=n?1e4:2e3,s=a>>1,o=a<<1;if(this.defaultTextDirection!=oe.Direction.LTR&&!n)return[];let l=[],u=(f,h,d,p)=>{if(h-f<s)return;let g=this.state.selection.main,m=[g.from];g.empty||m.push(g.to);for(let y of m)if(y>f&&y<h){u(f,y-10,d,p),u(y+10,h,d,p);return}let v=ZV(e,y=>y.from>=d.from&&y.to<=d.to&&Math.abs(y.from-f)<s&&Math.abs(y.to-h)<s&&!m.some(b=>y.from<b&&y.to>b));if(!v){if(h<d.to&&r&&n&&r.visibleRanges.some(w=>w.from<=h&&w.to>=h)){let w=r.moveToLineBoundary(W.EditorSelection.cursor(h),!1,!0).head;w>f&&(h=w)}let y=this.gapSize(d,f,h,p),b=n||y<2e6?y:2e6;v=new Io(f,h,y,b)}l.push(v)},c=f=>{if(f.length<o||f.type!=oe.BlockType.Text)return;let h=YV(f.from,f.to,this.stateDeco);if(h.total<o)return;let d=this.scrollTarget?this.scrollTarget.range.head:null,p,g;if(n){let m=a/this.heightOracle.lineLength*this.heightOracle.lineHeight,v,y;if(d!=null){let b=ec(h,d),w=((this.visibleBottom-this.visibleTop)/2+m)/f.height;v=b-w,y=b+w}else v=(this.visibleTop-f.top-m)/f.height,y=(this.visibleBottom-f.top+m)/f.height;p=Ju(h,v),g=Ju(h,y)}else{let m=h.total*this.heightOracle.charWidth,v=a*this.heightOracle.charWidth,y=0;if(m>2e6)for(let S of e)S.from>=f.from&&S.from<f.to&&S.size!=S.displaySize&&S.from*this.heightOracle.charWidth+y<this.pixelViewport.left&&(y=S.size-S.displaySize);let b=this.pixelViewport.left+y,w=this.pixelViewport.right+y,_,x;if(d!=null){let S=ec(h,d),E=((w-b)/2+v)/m;_=S-E,x=S+E}else _=(b-v)/m,x=(w+v)/m;p=Ju(h,_),g=Ju(h,x)}p>f.from&&u(f.from,p,f,h),g<f.to&&u(g,f.to,f,h)};for(let f of this.viewportLines)Array.isArray(f.type)?f.type.forEach(c):c(f);return l}gapSize(e,r,n,a){let s=ec(a,n)-ec(a,r);return this.heightOracle.lineWrapping?e.height*s:a.total*this.heightOracle.charWidth*s}updateLineGaps(e){Io.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=ut.set(e.map(r=>r.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let r=this.stateDeco;this.lineGaps.length&&(r=r.concat(this.lineGapDeco));let n=[];W.RangeSet.spans(r,this.viewport.from,this.viewport.to,{span(s,o){n.push({from:s,to:o})},point(){}},20);let a=0;if(n.length!=this.visibleRanges.length)a=12;else for(let s=0;s<n.length&&!(a&8);s++){let o=this.visibleRanges[s],l=n[s];(o.from!=l.from||o.to!=l.to)&&(a|=4,e&&e.mapPos(o.from,-1)==l.from&&e.mapPos(o.to,1)==l.to||(a|=8))}return this.visibleRanges=n,a}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(r=>r.from<=e&&r.to>=e)||Ao(this.heightMap.lineAt(e,pt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(r=>r.top<=e&&r.bottom>=e)||Ao(this.heightMap.lineAt(this.scaler.fromDOM(e),pt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let r=this.lineBlockAtHeight(e+8);return r.from>=this.viewport.from||this.viewportLines[0].top-e>200?r:this.viewportLines[0]}elementAtHeight(e){return Ao(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}},is=class{constructor(e,r){this.from=e,this.to=r}};function YV(t,e,r){let n=[],a=t,s=0;return W.RangeSet.spans(r,t,e,{span(){},point(o,l){o>a&&(n.push({from:a,to:o}),s+=o-a),a=l}},20),a<e&&(n.push({from:a,to:e}),s+=e-a),{total:s,ranges:n}}function Ju({total:t,ranges:e},r){if(r<=0)return e[0].from;if(r>=1)return e[e.length-1].to;let n=Math.floor(t*r);for(let a=0;;a++){let{from:s,to:o}=e[a],l=o-s;if(n<=l)return s+n;n-=l}}function ec(t,e){let r=0;for(let{from:n,to:a}of t.ranges){if(e<=a){r+=e-n;break}r+=a-n}return r/t.total}function ZV(t,e){for(let r of t)if(e(r))return r}var zw={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}},hp=class t{constructor(e,r,n){let a=0,s=0,o=0;this.viewports=n.map(({from:l,to:u})=>{let c=r.lineAt(l,pt.ByPos,e,0,0).top,f=r.lineAt(u,pt.ByPos,e,0,0).bottom;return a+=f-c,{from:l,to:u,top:c,bottom:f,domTop:0,domBottom:0}}),this.scale=(7e6-a)/(r.height-a);for(let l of this.viewports)l.domTop=o+(l.top-s)*this.scale,o=l.domBottom=l.domTop+(l.bottom-l.top),s=l.bottom}toDOM(e){for(let r=0,n=0,a=0;;r++){let s=r<this.viewports.length?this.viewports[r]:null;if(!s||e<s.top)return a+(e-n)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);n=s.bottom,a=s.domBottom}}fromDOM(e){for(let r=0,n=0,a=0;;r++){let s=r<this.viewports.length?this.viewports[r]:null;if(!s||e<s.domTop)return n+(e-a)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);n=s.bottom,a=s.domBottom}}eq(e){return e instanceof t?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((r,n)=>r.from==e.viewports[n].from&&r.to==e.viewports[n].to):!1}};function Ao(t,e){if(e.scale==1)return t;let r=e.toDOM(t.top),n=e.toDOM(t.bottom);return new ln(t.from,t.length,r,n-r,Array.isArray(t._content)?t._content.map(a=>Ao(a,e)):t._content)}var tc=W.Facet.define({combine:t=>t.join(" ")}),dp=W.Facet.define({combine:t=>t.indexOf(!0)>-1}),pp=ls.StyleModule.newName(),X_=ls.StyleModule.newName(),$_=ls.StyleModule.newName(),Q_={"&light":"."+X_,"&dark":"."+$_};function gp(t,e,r){return new ls.StyleModule(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,a=>{if(a=="&")return t;if(!r||!r[a])throw new RangeError(`Unsupported selector: ${a}`);return r[a]}):t+" "+n}})}var XV=gp("."+pp,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Q_),$V={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Vd=he.ie&&he.ie_version<=11,vp=class{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new Wd,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(r=>{for(let n of r)this.queue.push(n);(he.ie&&he.ie_version<=11||he.ios&&e.composing)&&r.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(he.chrome&&he.chrome_version<126)&&(this.editContext=new mp(e),e.state.facet(Kn)&&(e.contentDOM.editContext=this.editContext.editContext)),Vd&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var r;((r=this.view.docView)===null||r===void 0?void 0:r.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(r=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),r.length>0&&r[r.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(r=>{r.length>0&&r[r.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((r,n)=>r!=e[n]))){this.gapIntersection.disconnect();for(let r of e)this.gapIntersection.observe(r);this.gaps=e}}onSelectionChange(e){let r=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,a=this.selectionRange;if(n.state.facet(Kn)?n.root.activeElement!=this.dom:!ic(this.dom,a))return;let s=a.anchorNode&&n.docView.nearest(a.anchorNode);if(s&&s.ignoreEvent(e)){r||(this.selectionChanged=!1);return}(he.ie&&he.ie_version<=11||he.android&&he.chrome)&&!n.state.selection.main.empty&&a.focusNode&&Po(a.focusNode,a.focusOffset,a.anchorNode,a.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,r=Fo(e.root);if(!r)return!1;let n=he.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&QV(this.view,r)||r;if(!n||this.selectionRange.eq(n))return!1;let a=ic(this.dom,n);return a&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&jq(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),a&&(this.selectionChanged=!0),!0)}setSelectionRange(e,r){this.selectionRange.set(e.node,e.offset,r.node,r.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,r=null;for(let n=this.dom;n;)if(n.nodeType==1)!r&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:r||(r=this.scrollTargets.slice(0,e)),r&&r.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!r&&(r=this.scrollTargets.slice(0,e)),r){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=r)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,$V),Vd&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Vd&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,r){var n;if(!this.delayedAndroidKey){let a=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&os(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(a)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:r,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let r=-1,n=-1,a=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(a=!0),r==-1?{from:r,to:n}=o:(r=Math.min(o.from,r),n=Math.max(o.to,n)))}return{from:r,to:n,typeOver:a}}readChange(){let{from:e,to:r,typeOver:n}=this.processRecords(),a=this.selectionChanged&&ic(this.dom,this.selectionRange);if(e<0&&!a)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new np(this.view,e,r,n);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let r=this.readChange();if(!r)return this.view.requestMeasure(),!1;let n=this.view.state,a=z_(this.view,r);return this.view.state==n&&(r.domChanged||r.newSel&&!r.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),a}readMutation(e){let r=this.view.docView.nearest(e.target);if(!r||r.ignoreMutation(e))return null;if(r.markDirty(e.type=="attributes"),e.type=="attributes"&&(r.flags|=4),e.type=="childList"){let n=Hw(r,e.previousSibling||e.target.previousSibling,-1),a=Hw(r,e.nextSibling||e.target.nextSibling,1);return{from:n?r.posAfter(n):r.posAtStart,to:a?r.posBefore(a):r.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(Kn)!=e.state.facet(Kn)&&(e.view.contentDOM.editContext=e.state.facet(Kn)?this.editContext.editContext:null))}destroy(){var e,r,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(r=this.gapIntersection)===null||r===void 0||r.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let a of this.scrollTargets)a.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}};function Hw(t,e,r){for(;e;){let n=gt.get(e);if(n&&n.parent==t)return n;let a=e.parentNode;e=a!=t.dom?a:r>0?e.nextSibling:e.previousSibling}return null}function Uw(t,e){let r=e.startContainer,n=e.startOffset,a=e.endContainer,s=e.endOffset,o=t.docView.domAtPos(t.state.selection.main.anchor);return Po(o.node,o.offset,a,s)&&([r,n,a,s]=[a,s,r,n]),{anchorNode:r,anchorOffset:n,focusNode:a,focusOffset:s}}function QV(t,e){if(e.getComposedRanges){let a=e.getComposedRanges(t.root)[0];if(a)return Uw(t,a)}let r=null;function n(a){a.preventDefault(),a.stopImmediatePropagation(),r=a.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),r?Uw(t,r):null}var mp=class{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let r=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=n=>{let a=e.state.selection.main,{anchor:s,head:o}=a,l=this.toEditorPos(n.updateRangeStart),u=this.toEditorPos(n.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:n.updateRangeStart,editorBase:l,drifted:!1});let c={from:l,to:u,insert:W.Text.of(n.text.split(`
`))};if(c.from==this.from&&s<this.from?c.from=s:c.to==this.to&&s>this.to&&(c.to=s),c.from==c.to&&!c.insert.length){let f=W.EditorSelection.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd));f.main.eq(a)||e.dispatch({selection:f,userEvent:"select"});return}if((he.mac||he.android)&&c.from==o-1&&/^\. ?$/.test(n.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(c={from:l,to:u,insert:W.Text.of([n.text.replace("."," ")])}),this.pendingContextChange=c,!e.state.readOnly){let f=this.to-this.from+(c.to-c.from+c.insert.length);Np(e,c,W.EditorSelection.single(this.toEditorPos(n.selectionStart,f),this.toEditorPos(n.selectionEnd,f)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=n=>{let a=[],s=null;for(let o=this.toEditorPos(n.rangeStart),l=this.toEditorPos(n.rangeEnd);o<l;o++){let u=e.coordsForChar(o);s=u&&new DOMRect(u.left,u.top,u.right-u.left,u.bottom-u.top)||s||new DOMRect,a.push(s)}r.updateCharacterBounds(n.rangeStart,a)},this.handlers.textformatupdate=n=>{let a=[];for(let s of n.getTextFormats()){let o=s.underlineStyle,l=s.underlineThickness;if(o!="None"&&l!="None"){let u=this.toEditorPos(s.rangeStart),c=this.toEditorPos(s.rangeEnd);if(u<c){let f=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${l=="Thin"?1:2}px`;a.push(ut.mark({attributes:{style:f}}).range(u,c))}}}e.dispatch({effects:I_.of(ut.set(a))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:n}=this.composing;this.composing=null,n&&this.reset(e.state)}};for(let n in this.handlers)r.addEventListener(n,this.handlers[n]);this.measureReq={read:n=>{this.editContext.updateControlBounds(n.contentDOM.getBoundingClientRect());let a=Fo(n.root);a&&a.rangeCount&&this.editContext.updateSelectionBounds(a.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let r=0,n=!1,a=this.pendingContextChange;return e.changes.iterChanges((s,o,l,u,c)=>{if(n)return;let f=c.length-(o-s);if(a&&o>=a.to)if(a.from==s&&a.to==o&&a.insert.eq(c)){a=this.pendingContextChange=null,r+=f,this.to+=f;return}else a=null,this.revertPending(e.state);if(s+=r,o+=r,o<=this.from)this.from+=f,this.to+=f;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+c.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),c.toString()),this.to+=f}r+=f}),a&&!n&&this.revertPending(e.state),!n}update(e){let r=this.pendingContextChange,n=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(n.from,n.to)&&e.transactions.some(a=>!a.isUserEvent("input.type")&&a.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||r)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:r}=e.selection.main;this.from=Math.max(0,r-1e4),this.to=Math.min(e.doc.length,r+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let r=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(r.from),this.toContextPos(r.from+r.insert.length),e.doc.sliceString(r.from,r.to))}setSelection(e){let{main:r}=e.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,r.anchor))),a=this.toContextPos(r.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=a)&&this.editContext.updateSelection(n,a)}rangeIsValid(e){let{head:r}=e.selection.main;return!(this.from>0&&r-this.from<500||this.to<e.doc.length&&this.to-r<500||this.to-this.from>1e4*3)}toEditorPos(e,r=this.to-this.from){e=Math.min(e,r);let n=this.composing;return n&&n.drifted?n.editorBase+(e-n.contextBase):e+this.from}toContextPos(e){let r=this.composing;return r&&r.drifted?r.contextBase+(e-r.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}},Ze=class t{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var r;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(a=>a.forEach(s=>n(s,this)))||(a=>this.update(a)),this.dispatch=this.dispatch.bind(this),this._root=e.root||Kq(e.parent)||document,this.viewState=new wc(e.state||W.EditorState.create(e)),e.scrollTo&&e.scrollTo.is(Xu)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Co).map(a=>new Oo(a));for(let a of this.plugins)a.update(this);this.observer=new vp(this),this.inputState=new ip(this),this.inputState.ensureHandlers(this.plugins),this.docView=new pc(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((r=document.fonts)===null||r===void 0)&&r.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let r=e.length==1&&e[0]instanceof W.Transaction?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(r,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let r=!1,n=!1,a,s=this.state;for(let d of e){if(d.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=d.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,l=0,u=null;e.some(d=>d.annotation(j_))?(this.inputState.notifiedFocused=o,l=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,u=Y_(s,o),u||(l=1));let c=this.observer.delayedAndroidKey,f=null;if(c?(this.observer.clearDelayedAndroidKey(),f=this.observer.readChange(),(f&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(f=null)):this.observer.clear(),s.facet(W.EditorState.phrases)!=this.state.facet(W.EditorState.phrases))return this.setState(s);a=Go.create(this,s,e),a.flags|=l;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let d of e){if(h&&(h=h.map(d.changes)),d.scrollIntoView){let{main:p}=d.state.selection;h=new Do(p.empty?p:W.EditorSelection.cursor(p.head,p.head>p.anchor?-1:1))}for(let p of d.effects)p.is(Xu)&&(h=p.value.clip(this.state))}this.viewState.update(a,h),this.bidiCache=_c.update(this.bidiCache,a.changes),a.empty||(this.updatePlugins(a),this.inputState.update(a)),r=this.docView.update(a),this.state.facet(To)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(r,e.some(d=>d.isUserEvent("select.pointer")))}finally{this.updateState=0}if(a.startState.facet(tc)!=a.state.facet(tc)&&(this.viewState.mustMeasureContent=!0),(r||n||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),r&&this.docViewUpdate(),!a.empty)for(let d of this.state.facet(Jd))try{d(a)}catch(p){cn(this.state,p,"update listener")}(u||f)&&Promise.resolve().then(()=>{u&&this.state==u.startState&&this.dispatch(u),f&&!z_(this,f)&&c.force&&os(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let r=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new wc(e),this.plugins=e.facet(Co).map(n=>new Oo(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new pc(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}r&&this.focus(),this.requestMeasure()}updatePlugins(e){let r=e.startState.facet(Co),n=e.state.facet(Co);if(r!=n){let a=[];for(let s of n){let o=r.indexOf(s);if(o<0)a.push(new Oo(s));else{let l=this.plugins[o];l.mustUpdate=e,a.push(l)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=a,this.pluginMap.clear()}else for(let a of this.plugins)a.mustUpdate=e;for(let a=0;a<this.plugins.length;a++)this.plugins[a].update(this);r!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let r=e.value;if(r&&r.docViewUpdate)try{r.docViewUpdate(this)}catch(n){cn(this.state,n,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let r=null,n=this.scrollDOM,a=n.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(a-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(o<0)if(o_(n))s=-1,o=this.viewState.heightMap.height;else{let p=this.viewState.scrollAnchorAt(a);s=p.from,o=p.top}this.updateState=1;let u=this.viewState.measure(this);if(!u&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];u&4||([this.measureRequests,c]=[c,this.measureRequests]);let f=c.map(p=>{try{return p.read(this)}catch(g){return cn(this.state,g),Ww}}),h=Go.create(this,this.state,[]),d=!1;h.flags|=u,r?r.flags|=u:r=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),d=this.docView.update(h),d&&this.docViewUpdate());for(let p=0;p<c.length;p++)if(f[p]!=Ww)try{let g=c[p];g.write&&g.write(f[p],this)}catch(g){cn(this.state,g)}if(d&&this.docView.updateSelection(!0),!h.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let g=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(g>1||g<-1){a=a+g,n.scrollTop=a/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(r&&!r.empty)for(let l of this.state.facet(Jd))l(r)}get themeClasses(){return pp+" "+(this.state.facet(dp)?$_:X_)+" "+this.state.facet(tc)}updateAttrs(){let e=Gw(this,B_,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),r={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Kn)?"true":"false",class:"cm-content",style:`${he.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(r["aria-readonly"]="true"),Gw(this,kc,r);let n=this.observer.ignore(()=>{let a=Zd(this.contentDOM,this.contentAttrs,r),s=Zd(this.dom,this.editorAttrs,e);return a||s});return this.editorAttrs=e,this.contentAttrs=r,n}showAnnouncements(e){let r=!0;for(let n of e)for(let a of n.effects)if(a.is(t.announce)){r&&(this.announceDOM.textContent=""),r=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=a.value}}mountStyles(){this.styleModules=this.state.facet(To);let e=this.state.facet(t.cspNonce);ls.StyleModule.mount(this.root,this.styleModules.concat(XV).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let r=0;r<this.measureRequests.length;r++)if(this.measureRequests[r].key===e.key){this.measureRequests[r]=e;return}}this.measureRequests.push(e)}}plugin(e){let r=this.pluginMap.get(e);return(r===void 0||r&&r.spec!=e)&&this.pluginMap.set(e,r=this.plugins.find(n=>n.spec==e)||null),r&&r.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,r,n){return qd(this,e,Mw(this,e,r,n))}moveByGroup(e,r){return qd(this,e,Mw(this,e,r,n=>_V(this,e.head,n)))}visualLineSide(e,r){let n=this.bidiSpans(e),a=this.textDirectionAt(e.from),s=n[r?n.length-1:0];return W.EditorSelection.cursor(s.side(r,a)+e.from,s.forward(!r,a)?1:-1)}moveToLineBoundary(e,r,n=!0){return wV(this,e,r,n)}moveVertically(e,r,n){return qd(this,e,xV(this,e,r,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,r=0){return this.docView.posFromDOM(e,r)}posAtCoords(e,r=!0){return this.readMeasured(),V_(this,e,r)}coordsAtPos(e,r=1){this.readMeasured();let n=this.docView.coordsAt(e,r);if(!n||n.left==n.right)return n;let a=this.state.doc.lineAt(e),s=this.bidiSpans(a),o=s[un.find(s,e-a.from,-1,r)];return jo(n,o.dir==oe.Direction.LTR==r>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(R_)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>JV)return x_(e.length);let r=this.textDirectionAt(e.from),n;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==r&&(s.fresh||w_(s.isolates,n=Sw(this,e))))return s.order;n||(n=Sw(this,e));let a=__(e.text,r,n);return this.bidiCache.push(new _c(e.from,e.to,r,n,!0,a)),a}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||he.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{a_(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,r={}){return Xu.of(new Do(typeof e=="number"?W.EditorSelection.cursor(e):e,r.y,r.x,r.yMargin,r.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:r}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return Xu.of(new Do(W.EditorSelection.cursor(n.from),"start","start",n.top-e,r,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return er.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return er.define(()=>({}),{eventObservers:e})}static theme(e,r){let n=ls.StyleModule.newName(),a=[tc.of(n),To.of(gp(`.${n}`,e))];return r&&r.dark&&a.push(dp.of(!0)),a}static baseTheme(e){return W.Prec.lowest(To.of(gp("."+pp,e,Q_)))}static findFromDOM(e){var r;let n=e.querySelector(".cm-content"),a=n&&gt.get(n)||gt.get(e);return((r=a?.rootView)===null||r===void 0?void 0:r.view)||null}};Ze.styleModule=To;Ze.inputHandler=M_;Ze.clipboardInputFilter=Op;Ze.clipboardOutputFilter=Ip;Ze.scrollHandler=O_;Ze.focusChangeEffect=P_;Ze.perLineTextDirection=R_;Ze.exceptionSink=A_;Ze.updateListener=Jd;Ze.editable=Kn;Ze.mouseSelectionStyle=k_;Ze.dragMovesSelection=T_;Ze.clickAddsSelectionRange=C_;Ze.decorations=Wo;Ze.outerDecorations=L_;Ze.atomicRanges=Bp;Ze.bidiIsolatedRanges=N_;Ze.scrollMargins=F_;Ze.darkTheme=dp;Ze.cspNonce=W.Facet.define({combine:t=>t.length?t[0]:""});Ze.contentAttributes=kc;Ze.editorAttributes=B_;Ze.lineWrapping=Ze.contentAttributes.of({class:"cm-lineWrapping"});Ze.announce=W.StateEffect.define();var JV=4096,Ww={},_c=class t{constructor(e,r,n,a,s,o){this.from=e,this.to=r,this.dir=n,this.isolates=a,this.fresh=s,this.order=o}static update(e,r){if(r.empty&&!e.some(s=>s.fresh))return e;let n=[],a=e.length?e[e.length-1].dir:oe.Direction.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==a&&!r.touchesRange(o.from,o.to)&&n.push(new t(r.mapPos(o.from,1),r.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return n}};function Gw(t,e,r){for(let n=t.state.facet(e),a=n.length-1;a>=0;a--){let s=n[a],o=typeof s=="function"?s(t):s;o&&Yd(o,r)}return r}var ez=he.mac?"mac":he.windows?"win":he.linux?"linux":"key";function tz(t,e){let r=t.split(/-(?!$)/),n=r[r.length-1];n=="Space"&&(n=" ");let a,s,o,l;for(let u=0;u<r.length-1;++u){let c=r[u];if(/^(cmd|meta|m)$/i.test(c))l=!0;else if(/^a(lt)?$/i.test(c))a=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))e=="mac"?l=!0:s=!0;else throw new Error("Unrecognized modifier name: "+c)}return a&&(n="Alt-"+n),s&&(n="Ctrl-"+n),l&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function rc(t,e,r){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),r!==!1&&e.shiftKey&&(t="Shift-"+t),t}var rz=W.Prec.default(Ze.domEventHandlers({keydown(t,e){return tx(ex(e.state),t,e,"editor")}})),J_=W.Facet.define({enables:rz}),Kw=new WeakMap;function ex(t){let e=t.facet(J_),r=Kw.get(e);return r||Kw.set(e,r=az(e.reduce((n,a)=>n.concat(a),[]))),r}function nz(t,e,r){return tx(ex(t.state),e,t,r)}var mi=null,iz=4e3;function az(t,e=ez){let r=Object.create(null),n=Object.create(null),a=(o,l)=>{let u=n[o];if(u==null)n[o]=l;else if(u!=l)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,l,u,c,f)=>{var h,d;let p=r[o]||(r[o]=Object.create(null)),g=l.split(/ (?!$)/).map(y=>tz(y,e));for(let y=1;y<g.length;y++){let b=g.slice(0,y).join(" ");a(b,!0),p[b]||(p[b]={preventDefault:!0,stopPropagation:!1,run:[w=>{let _=mi={view:w,prefix:b,scope:o};return setTimeout(()=>{mi==_&&(mi=null)},iz),!0}]})}let m=g.join(" ");a(m,!1);let v=p[m]||(p[m]={preventDefault:!1,stopPropagation:!1,run:((d=(h=p._any)===null||h===void 0?void 0:h.run)===null||d===void 0?void 0:d.slice())||[]});u&&v.run.push(u),c&&(v.preventDefault=!0),f&&(v.stopPropagation=!0)};for(let o of t){let l=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let c of l){let f=r[c]||(r[c]=Object.create(null));f._any||(f._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:h}=o;for(let d in f)f[d].run.push(p=>h(p,yp))}let u=o[e]||o.key;if(u)for(let c of l)s(c,u,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(c,"Shift-"+u,o.shift,o.preventDefault,o.stopPropagation)}return r}var yp=null;function tx(t,e,r,n){yp=e;let a=Ld.keyName(e),s=W.codePointAt(a,0),o=W.codePointSize(s)==a.length&&a!=" ",l="",u=!1,c=!1,f=!1;mi&&mi.view==r&&mi.scope==n&&(l=mi.prefix+" ",U_.indexOf(e.keyCode)<0&&(c=!0,mi=null));let h=new Set,d=v=>{if(v){for(let y of v.run)if(!h.has(y)&&(h.add(y),y(r)))return v.stopPropagation&&(f=!0),!0;v.preventDefault&&(v.stopPropagation&&(f=!0),c=!0)}return!1},p=t[n],g,m;return p&&(d(p[l+rc(a,e,!o)])?u=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(he.windows&&e.ctrlKey&&e.altKey)&&(g=Ld.base[e.keyCode])&&g!=a?(d(p[l+rc(g,e,!0)])||e.shiftKey&&(m=Ld.shift[e.keyCode])!=a&&m!=g&&d(p[l+rc(m,e,!1)]))&&(u=!0):o&&e.shiftKey&&d(p[l+rc(a,e,!0)])&&(u=!0),!u&&d(p._any)&&(u=!0)),c&&(u=!0),u&&f&&e.stopPropagation(),yp=null,u}var cs=class t{constructor(e,r,n,a,s){this.className=e,this.left=r,this.top=n,this.width=a,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,r){return r.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,r,n){if(n.empty){let a=e.coordsAtPos(n.head,n.assoc||1);if(!a)return[];let s=rx(e);return[new t(r,a.left-s.left,a.top-s.top,null,a.bottom-a.top)]}else return sz(e,r,n)}};function rx(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==oe.Direction.LTR?e.left:e.right-t.scrollDOM.clientWidth*t.scaleX)-t.scrollDOM.scrollLeft*t.scaleX,top:e.top-t.scrollDOM.scrollTop*t.scaleY}}function jw(t,e,r,n){let a=t.coordsAtPos(e,r*2);if(!a)return n;let s=t.dom.getBoundingClientRect(),o=(a.top+a.bottom)/2,l=t.posAtCoords({x:s.left+1,y:o}),u=t.posAtCoords({x:s.right-1,y:o});return l==null||u==null?n:{from:Math.max(n.from,Math.min(l,u)),to:Math.min(n.to,Math.max(l,u))}}function sz(t,e,r){if(r.to<=t.viewport.from||r.from>=t.viewport.to)return[];let n=Math.max(r.from,t.viewport.from),a=Math.min(r.to,t.viewport.to),s=t.textDirection==oe.Direction.LTR,o=t.contentDOM,l=o.getBoundingClientRect(),u=rx(t),c=o.querySelector(".cm-line"),f=c&&window.getComputedStyle(c),h=l.left+(f?parseInt(f.paddingLeft)+Math.min(0,parseInt(f.textIndent)):0),d=l.right-(f?parseInt(f.paddingRight):0),p=tp(t,n,1),g=tp(t,a,-1),m=p.type==oe.BlockType.Text?p:null,v=g.type==oe.BlockType.Text?g:null;if(m&&(t.lineWrapping||p.widgetLineBreaks)&&(m=jw(t,n,1,m)),v&&(t.lineWrapping||g.widgetLineBreaks)&&(v=jw(t,a,-1,v)),m&&v&&m.from==v.from&&m.to==v.to)return b(w(r.from,r.to,m));{let x=m?w(r.from,null,m):_(p,!1),S=v?w(null,r.to,v):_(g,!0),E=[];return(m||p).to<(v||g).from-(m&&v?1:0)||p.widgetLineBreaks>1&&x.bottom+t.defaultLineHeight/2<S.top?E.push(y(h,x.bottom,d,S.top)):x.bottom<S.top&&t.elementAtHeight((x.bottom+S.top)/2).type==oe.BlockType.Text&&(x.bottom=S.top=(x.bottom+S.top)/2),b(x).concat(E).concat(b(S))}function y(x,S,E,A){return new cs(e,x-u.left,S-u.top,E-x,A-S)}function b({top:x,bottom:S,horizontal:E}){let A=[];for(let T=0;T<E.length;T+=2)A.push(y(E[T],x,E[T+1],S));return A}function w(x,S,E){let A=1e9,T=-1e9,D=[];function k(I,B,L,N,F){let q=t.coordsAtPos(I,I==E.to?-2:2),H=t.coordsAtPos(L,L==E.from?2:-2);!q||!H||(A=Math.min(q.top,H.top,A),T=Math.max(q.bottom,H.bottom,T),F==oe.Direction.LTR?D.push(s&&B?h:q.left,s&&N?d:H.right):D.push(!s&&N?h:H.left,!s&&B?d:q.right))}let M=x??E.from,P=S??E.to;for(let I of t.visibleRanges)if(I.to>M&&I.from<P)for(let B=Math.max(I.from,M),L=Math.min(I.to,P);;){let N=t.state.doc.lineAt(B);for(let F of t.bidiSpans(N)){let q=F.from+N.from,H=F.to+N.from;if(q>=L)break;H>B&&k(Math.max(q,B),x==null&&q<=M,Math.min(H,L),S==null&&H>=P,F.dir)}if(B=N.to+1,B>=L)break}return D.length==0&&k(M,x==null,P,S==null,t.textDirection),{top:A,bottom:T,horizontal:D}}function _(x,S){let E=l.top+(S?x.top:x.bottom);return{top:E,bottom:E,horizontal:[]}}}function oz(t,e){return t.constructor==e.constructor&&t.eq(e)}var bp=class{constructor(e,r){this.view=e,this.layer=r,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),r.above&&this.dom.classList.add("cm-layer-above"),r.class&&this.dom.classList.add(r.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),r.mount&&r.mount(this.dom,e)}update(e){e.startState.facet(lc)!=e.state.facet(lc)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let r=0,n=e.facet(lc);for(;r<n.length&&n[r]!=this.layer;)r++;this.dom.style.zIndex=String((this.layer.above?150:-1)-r)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:r}=this.view;(e!=this.scaleX||r!=this.scaleY)&&(this.scaleX=e,this.scaleY=r,this.dom.style.transform=`scale(${1/e}, ${1/r})`)}draw(e){if(e.length!=this.drawn.length||e.some((r,n)=>!oz(r,this.drawn[n]))){let r=this.dom.firstChild,n=0;for(let a of e)a.update&&r&&a.constructor&&this.drawn[n].constructor&&a.update(r,this.drawn[n])?(r=r.nextSibling,n++):this.dom.insertBefore(a.draw(),r);for(;r;){let a=r.nextSibling;r.remove(),r=a}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}},lc=W.Facet.define();function Fp(t){return[er.define(e=>new bp(e,t)),lc.of(t)]}var hs=W.Facet.define({combine(t){return W.combineConfig(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,r)=>Math.min(e,r),drawRangeCursor:(e,r)=>e||r})}});function lz(t={}){return[hs.of(t),cz,fz,hz,D_.of(!0)]}function uz(t){return t.facet(hs)}function nx(t){return t.startState.facet(hs)!=t.state.facet(hs)}var cz=Fp({above:!0,markers(t){let{state:e}=t,r=e.facet(hs),n=[];for(let a of e.selection.ranges){let s=a==e.selection.main;if(a.empty||r.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=a.empty?a:W.EditorSelection.cursor(a.head,a.head>a.anchor?-1:1);for(let u of cs.forRange(t,o,l))n.push(u)}}return n},update(t,e){t.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let r=nx(t);return r&&Yw(t.state,e),t.docChanged||t.selectionSet||r},mount(t,e){Yw(e.state,t)},class:"cm-cursorLayer"});function Yw(t,e){e.style.animationDuration=t.facet(hs).cursorBlinkRate+"ms"}var fz=Fp({above:!1,markers(t){return t.state.selection.ranges.map(e=>e.empty?[]:cs.forRange(t,"cm-selectionBackground",e)).reduce((e,r)=>e.concat(r))},update(t,e){return t.docChanged||t.selectionSet||t.viewportChanged||nx(t)},class:"cm-selectionLayer"}),hz=W.Prec.highest(Ze.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),ix=W.StateEffect.define({map(t,e){return t==null?null:e.mapPos(t)}}),Mo=W.StateField.define({create(){return null},update(t,e){return t!=null&&(t=e.changes.mapPos(t)),e.effects.reduce((r,n)=>n.is(ix)?n.value:r,t)}}),dz=er.fromClass(class{constructor(t){this.view=t,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(t){var e;let r=t.state.field(Mo);r==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(t.startState.field(Mo)!=r||t.docChanged||t.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:t}=this,e=t.state.field(Mo),r=e!=null&&t.coordsAtPos(e);if(!r)return null;let n=t.scrollDOM.getBoundingClientRect();return{left:r.left-n.left+t.scrollDOM.scrollLeft*t.scaleX,top:r.top-n.top+t.scrollDOM.scrollTop*t.scaleY,height:r.bottom-r.top}}drawCursor(t){if(this.cursor){let{scaleX:e,scaleY:r}=this.view;t?(this.cursor.style.left=t.left/e+"px",this.cursor.style.top=t.top/r+"px",this.cursor.style.height=t.height/r+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(t){this.view.state.field(Mo)!=t&&this.view.dispatch({effects:ix.of(t)})}},{eventObservers:{dragover(t){this.setDropPos(this.view.posAtCoords({x:t.clientX,y:t.clientY}))},dragleave(t){(t.target==this.view.contentDOM||!this.view.contentDOM.contains(t.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function pz(){return[Mo,dz]}function Zw(t,e,r,n,a){e.lastIndex=0;for(let s=t.iterRange(r,n),o=r,l;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;l=e.exec(s.value);)a(o+l.index,l)}function gz(t,e){let r=t.visibleRanges;if(r.length==1&&r[0].from==t.viewport.from&&r[0].to==t.viewport.to)return r;let n=[];for(let{from:a,to:s}of r)a=Math.max(t.state.doc.lineAt(a).from,a-e),s=Math.min(t.state.doc.lineAt(s).to,s+e),n.length&&n[n.length-1].to>=a?n[n.length-1].to=s:n.push({from:a,to:s});return n}var ds=class{constructor(e){let{regexp:r,decoration:n,decorate:a,boundary:s,maxLength:o=1e3}=e;if(!r.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=r,a)this.addMatch=(l,u,c,f)=>a(f,c,c+l[0].length,l,u);else if(typeof n=="function")this.addMatch=(l,u,c,f)=>{let h=n(l,u,c);h&&f(c,c+l[0].length,h)};else if(n)this.addMatch=(l,u,c,f)=>f(c,c+l[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let r=new W.RangeSetBuilder,n=r.add.bind(r);for(let{from:a,to:s}of gz(e,this.maxLength))Zw(e.state.doc,this.regexp,a,s,(o,l)=>this.addMatch(l,e,o,n));return r.finish()}updateDeco(e,r){let n=1e9,a=-1;return e.docChanged&&e.changes.iterChanges((s,o,l,u)=>{u>=e.view.viewport.from&&l<=e.view.viewport.to&&(n=Math.min(l,n),a=Math.max(u,a))}),e.viewportMoved||a-n>1e3?this.createDeco(e.view):a>-1?this.updateRange(e.view,r.map(e.changes),n,a):r}updateRange(e,r,n,a){for(let s of e.visibleRanges){let o=Math.max(s.from,n),l=Math.min(s.to,a);if(l>o){let u=e.state.doc.lineAt(o),c=u.to<l?e.state.doc.lineAt(l):u,f=Math.max(s.from,u.from),h=Math.min(s.to,c.to);if(this.boundary){for(;o>u.from;o--)if(this.boundary.test(u.text[o-1-u.from])){f=o;break}for(;l<c.to;l++)if(this.boundary.test(c.text[l-c.from])){h=l;break}}let d=[],p,g=(m,v,y)=>d.push(y.range(m,v));if(u==c)for(this.regexp.lastIndex=f-u.from;(p=this.regexp.exec(u.text))&&p.index<h-u.from;)this.addMatch(p,e,p.index+u.from,g);else Zw(e.state.doc,this.regexp,f,h,(m,v)=>this.addMatch(v,e,m,g));r=r.update({filterFrom:f,filterTo:h,filter:(m,v)=>m<f||v>h,add:d})}}return r}},wp=/x/.unicode!=null?"gu":"g",vz=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,wp),mz={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},zd=null;function yz(){var t;if(zd==null&&typeof document<"u"&&document.body){let e=document.body.style;zd=((t=e.tabSize)!==null&&t!==void 0?t:e.MozTabSize)!=null}return zd||!1}var uc=W.Facet.define({combine(t){let e=W.combineConfig(t,{render:null,specialChars:vz,addSpecialChars:null});return(e.replaceTabs=!yz())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,wp)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,wp)),e}});function bz(t={}){return[uc.of(t),wz()]}var Xw=null;function wz(){return Xw||(Xw=er.fromClass(class{constructor(t){this.view=t,this.decorations=ut.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(uc)),this.decorations=this.decorator.createDeco(t)}makeDecorator(t){return new ds({regexp:t.specialChars,decoration:(e,r,n)=>{let{doc:a}=r.state,s=W.codePointAt(e[0],0);if(s==9){let o=a.lineAt(n),l=r.state.tabSize,u=W.countColumn(o.text,l,n-o.from);return ut.replace({widget:new xp((l-u%l)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=ut.replace({widget:new _p(t,s)}))},boundary:t.replaceTabs?void 0:/[^]/})}update(t){let e=t.state.facet(uc);t.startState.facet(uc)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(t.view)):this.decorations=this.decorator.updateDeco(t,this.decorations)}},{decorations:t=>t.decorations}))}var _z="\u2022";function xz(t){return t>=32?_z:t==10?"\u2424":String.fromCharCode(9216+t)}var _p=class extends jn{constructor(e,r){super(),this.options=e,this.code=r}eq(e){return e.code==this.code}toDOM(e){let r=xz(this.code),n=e.state.phrase("Control character")+" "+(mz[this.code]||"0x"+this.code.toString(16)),a=this.options.render&&this.options.render(this.code,n,r);if(a)return a;let s=document.createElement("span");return s.textContent=r,s.title=n,s.setAttribute("aria-label",n),s.className="cm-specialChar",s}ignoreEvent(){return!1}},xp=class extends jn{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}},$w=er.fromClass(class{constructor(){this.height=1e3,this.attrs={style:"padding-bottom: 1000px"}}update(t){let{view:e}=t,r=e.viewState.editorHeight-e.defaultLineHeight-e.documentPadding.top-.5;r>=0&&r!=this.height&&(this.height=r,this.attrs={style:`padding-bottom: ${r}px`})}});function Ez(){return[$w,kc.of(t=>{var e;return((e=t.plugin($w))===null||e===void 0?void 0:e.attrs)||null})]}function Sz(){return Tz}var Cz=ut.line({class:"cm-activeLine"}),Tz=er.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,r=[];for(let n of t.state.selection.ranges){let a=t.lineBlockAt(n.head);a.from>e&&(r.push(Cz.range(a.from)),e=a.from)}return ut.set(r)}},{decorations:t=>t.decorations}),Ep=class extends jn{constructor(e){super(),this.content=e}toDOM(e){let r=document.createElement("span");return r.className="cm-placeholder",r.style.pointerEvents="none",r.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(e):this.content.cloneNode(!0)),typeof this.content=="string"?r.setAttribute("aria-label","placeholder "+this.content):r.setAttribute("aria-hidden","true"),r}coordsAt(e){let r=e.firstChild?us(e.firstChild):[];if(!r.length)return null;let n=window.getComputedStyle(e.parentNode),a=jo(r[0],n.direction!="rtl"),s=parseInt(n.lineHeight);return a.bottom-a.top>s*1.5?{left:a.left,right:a.right,top:a.top,bottom:a.top+s}:a}ignoreEvent(){return!1}};function kz(t){return er.fromClass(class{constructor(e){this.view=e,this.placeholder=t?ut.set([ut.widget({widget:new Ep(t),side:1}).range(0)]):ut.none}get decorations(){return this.view.state.doc.length?ut.none:this.placeholder}},{decorations:e=>e.decorations})}var Sp=2e3;function Az(t,e,r){let n=Math.min(e.line,r.line),a=Math.max(e.line,r.line),s=[];if(e.off>Sp||r.off>Sp||e.col<0||r.col<0){let o=Math.min(e.off,r.off),l=Math.max(e.off,r.off);for(let u=n;u<=a;u++){let c=t.doc.line(u);c.length<=l&&s.push(W.EditorSelection.range(c.from+o,c.to+l))}}else{let o=Math.min(e.col,r.col),l=Math.max(e.col,r.col);for(let u=n;u<=a;u++){let c=t.doc.line(u),f=W.findColumn(c.text,o,t.tabSize,!0);if(f<0)s.push(W.EditorSelection.cursor(c.to));else{let h=W.findColumn(c.text,l,t.tabSize);s.push(W.EditorSelection.range(c.from+f,c.from+h))}}}return s}function Mz(t,e){let r=t.coordsAtPos(t.viewport.from);return r?Math.round(Math.abs((r.left-e)/t.defaultCharacterWidth)):-1}function Qw(t,e){let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1),n=t.state.doc.lineAt(r),a=r-n.from,s=a>Sp?-1:a==n.length?Mz(t,e.clientX):W.countColumn(n.text,t.state.tabSize,r-n.from);return{line:n.number,col:s,off:a}}function Pz(t,e){let r=Qw(t,e),n=t.state.selection;return r?{update(a){if(a.docChanged){let s=a.changes.mapPos(a.startState.doc.line(r.line).from),o=a.state.doc.lineAt(s);r={line:o.number,col:r.col,off:Math.min(r.off,o.length)},n=n.map(a.changes)}},get(a,s,o){let l=Qw(t,a);if(!l)return n;let u=Az(t.state,r,l);return u.length?o?W.EditorSelection.create(u.concat(n.ranges)):W.EditorSelection.create(u):n}}:null}function Rz(t){let e=t?.eventFilter||(r=>r.altKey&&r.button==0);return Ze.mouseSelectionStyle.of((r,n)=>e(n)?Pz(r,n):null)}var Dz={Alt:[18,t=>!!t.altKey],Control:[17,t=>!!t.ctrlKey],Shift:[16,t=>!!t.shiftKey],Meta:[91,t=>!!t.metaKey]},Oz={style:"cursor: crosshair"};function Iz(t={}){let[e,r]=Dz[t.key||"Alt"],n=er.fromClass(class{constructor(a){this.view=a,this.isDown=!1}set(a){this.isDown!=a&&(this.isDown=a,this.view.update([]))}},{eventObservers:{keydown(a){this.set(a.keyCode==e||r(a))},keyup(a){(a.keyCode==e||!r(a))&&this.set(!1)},mousemove(a){this.set(r(a))}}});return[n,Ze.contentAttributes.of(a=>{var s;return!((s=a.plugin(n))===null||s===void 0)&&s.isDown?Oz:null})]}var So="-10000px",xc=class{constructor(e,r,n,a){this.facet=r,this.createTooltipView=n,this.removeTooltipView=a,this.input=e.state.facet(r),this.tooltips=this.input.filter(o=>o);let s=null;this.tooltipViews=this.tooltips.map(o=>s=n(o,s))}update(e,r){var n;let a=e.state.facet(this.facet),s=a.filter(u=>u);if(a===this.input){for(let u of this.tooltipViews)u.update&&u.update(e);return!1}let o=[],l=r?[]:null;for(let u=0;u<s.length;u++){let c=s[u],f=-1;if(c){for(let h=0;h<this.tooltips.length;h++){let d=this.tooltips[h];d&&d.create==c.create&&(f=h)}if(f<0)o[u]=this.createTooltipView(c,u?o[u-1]:null),l&&(l[u]=!!c.above);else{let h=o[u]=this.tooltipViews[f];l&&(l[u]=r[f]),h.update&&h.update(e)}}}for(let u of this.tooltipViews)o.indexOf(u)<0&&(this.removeTooltipView(u),(n=u.destroy)===null||n===void 0||n.call(u));return r&&(l.forEach((u,c)=>r[c]=u),r.length=l.length),this.input=a,this.tooltips=s,this.tooltipViews=o,!0}};function Bz(t={}){return cc.of(t)}function Lz(t){let e=t.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}var cc=W.Facet.define({combine:t=>{var e,r,n;return{position:he.ios?"absolute":((e=t.find(a=>a.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((r=t.find(a=>a.parent))===null||r===void 0?void 0:r.parent)||null,tooltipSpace:((n=t.find(a=>a.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||Lz}}}),Jw=new WeakMap,Mc=er.fromClass(class{constructor(t){this.view=t,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(cc);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new xc(t,qp,(r,n)=>this.createTooltip(r,n),r=>{this.resizeObserver&&this.resizeObserver.unobserve(r.dom),r.dom.remove()}),this.above=this.manager.tooltips.map(r=>!!r.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(r=>{Date.now()>this.lastTransaction-50&&r.length>0&&r[r.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t,this.above);e&&this.observeIntersection();let r=e||t.geometryChanged,n=t.state.facet(cc);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let a of this.manager.tooltipViews)a.dom.style.position=this.position;r=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let a of this.manager.tooltipViews)this.container.appendChild(a.dom);r=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);r&&this.maybeMeasure()}createTooltip(t,e){let r=t.create(this.view),n=e?e.dom:null;if(r.dom.classList.add("cm-tooltip"),t.arrow&&!r.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let a=document.createElement("div");a.className="cm-tooltip-arrow",r.dom.appendChild(a)}return r.dom.style.position=this.position,r.dom.style.top=So,r.dom.style.left="0px",this.container.insertBefore(r.dom,n),r.mount&&r.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(r.dom),r}destroy(){var t,e,r;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(t=n.destroy)===null||t===void 0||t.call(n);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(r=this.intersectionObserver)===null||r===void 0||r.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=1,e=1,r=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(he.gecko)r=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==So&&s.style.left=="0px"){let o=s.getBoundingClientRect();r=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(r||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(t=s.width/this.parent.offsetWidth,e=s.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:e}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),a=Lp(this.view);return{visible:{left:n.left+a.left,top:n.top+a.top,right:n.right-a.right,bottom:n.bottom-a.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((s,o)=>{let l=this.manager.tooltipViews[o];return l.getCoords?l.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(cc).tooltipSpace(this.view),scaleX:t,scaleY:e,makeAbsolute:r}}writeMeasure(t){var e;if(t.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let l of this.manager.tooltipViews)l.dom.style.position="absolute"}let{visible:r,space:n,scaleX:a,scaleY:s}=t,o=[];for(let l=0;l<this.manager.tooltips.length;l++){let u=this.manager.tooltips[l],c=this.manager.tooltipViews[l],{dom:f}=c,h=t.pos[l],d=t.size[l];if(!h||u.clip!==!1&&(h.bottom<=Math.max(r.top,n.top)||h.top>=Math.min(r.bottom,n.bottom)||h.right<Math.max(r.left,n.left)-.1||h.left>Math.min(r.right,n.right)+.1)){f.style.top=So;continue}let p=u.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,g=p?7:0,m=d.right-d.left,v=(e=Jw.get(c))!==null&&e!==void 0?e:d.bottom-d.top,y=c.offset||Fz,b=this.view.textDirection==oe.Direction.LTR,w=d.width>n.right-n.left?b?n.left:n.right-d.width:b?Math.max(n.left,Math.min(h.left-(p?14:0)+y.x,n.right-m)):Math.min(Math.max(n.left,h.left-m+(p?14:0)-y.x),n.right-m),_=this.above[l];!u.strictSide&&(_?h.top-v-g-y.y<n.top:h.bottom+v+g+y.y>n.bottom)&&_==n.bottom-h.bottom>h.top-n.top&&(_=this.above[l]=!_);let x=(_?h.top-n.top:n.bottom-h.bottom)-g;if(x<v&&c.resize!==!1){if(x<this.view.defaultLineHeight){f.style.top=So;continue}Jw.set(c,v),f.style.height=(v=x)/s+"px"}else f.style.height&&(f.style.height="");let S=_?h.top-v-g-y.y:h.bottom+g+y.y,E=w+m;if(c.overlap!==!0)for(let A of o)A.left<E&&A.right>w&&A.top<S+v&&A.bottom>S&&(S=_?A.top-v-2-g:A.bottom+g+2);if(this.position=="absolute"?(f.style.top=(S-t.parent.top)/s+"px",e_(f,(w-t.parent.left)/a)):(f.style.top=S/s+"px",e_(f,w/a)),p){let A=h.left+(b?y.x:-y.x)-(w+14-7);p.style.left=A/a+"px"}c.overlap!==!0&&o.push({left:w,top:S,right:E,bottom:S+v}),f.classList.toggle("cm-tooltip-above",_),f.classList.toggle("cm-tooltip-below",!_),c.positioned&&c.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=So}},{eventObservers:{scroll(){this.maybeMeasure()}}});function e_(t,e){let r=parseInt(t.style.left,10);(isNaN(r)||Math.abs(e-r)>1)&&(t.style.left=e+"px")}var Nz=Ze.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Fz={x:0,y:0},qp=W.Facet.define({enables:[Mc,Nz]}),Ko=W.Facet.define({combine:t=>t.reduce((e,r)=>e.concat(r),[])}),Ec=class t{static create(e){return new t(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new xc(e,Ko,(r,n)=>this.createHostedView(r,n),r=>r.dom.remove())}createHostedView(e,r){let n=e.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(n.dom,r?r.dom.nextSibling:this.dom.firstChild),this.mounted&&n.mount&&n.mount(this.view),n}mount(e){for(let r of this.manager.tooltipViews)r.mount&&r.mount(e);this.mounted=!0}positioned(e){for(let r of this.manager.tooltipViews)r.positioned&&r.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let r of this.manager.tooltipViews)(e=r.destroy)===null||e===void 0||e.call(r)}passProp(e){let r;for(let n of this.manager.tooltipViews){let a=n[e];if(a!==void 0){if(r===void 0)r=a;else if(r!==a)return}}return r}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}},qz=qp.compute([Ko],t=>{let e=t.facet(Ko);return e.length===0?null:{pos:Math.min(...e.map(r=>r.pos)),end:Math.max(...e.map(r=>{var n;return(n=r.end)!==null&&n!==void 0?n:r.pos})),create:Ec.create,above:e[0].above,arrow:e.some(r=>r.arrow)}}),Cp=class{constructor(e,r,n,a,s){this.view=e,this.source=r,this.field=n,this.setHover=a,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:r}=this,n=e.docView.nearest(r.target);if(!n)return;let a,s=1;if(n instanceof qo)a=n.posAtStart;else{if(a=e.posAtCoords(r),a==null)return;let l=e.coordsAtPos(a);if(!l||r.y<l.top||r.y>l.bottom||r.x<l.left-e.defaultCharacterWidth||r.x>l.right+e.defaultCharacterWidth)return;let u=e.bidiSpans(e.state.doc.lineAt(a)).find(f=>f.from<=a&&f.to>=a),c=u&&u.dir==oe.Direction.RTL?-1:1;s=r.x<l.left?-c:c}let o=this.source(e,a,s);if(o?.then){let l=this.pending={pos:a};o.then(u=>{this.pending==l&&(this.pending=null,u&&!(Array.isArray(u)&&!u.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(u)?u:[u])}))},u=>cn(e.state,u,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(Mc),r=e?e.manager.tooltips.findIndex(n=>n.create==Ec.create):-1;return r>-1?e.manager.tooltipViews[r]:null}mousemove(e){var r,n;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:a,tooltip:s}=this;if(a.length&&s&&!Vz(s.dom,e)||this.pending){let{pos:o}=a[0]||this.pending,l=(n=(r=a[0])===null||r===void 0?void 0:r.end)!==null&&n!==void 0?n:o;(o==l?this.view.posAtCoords(this.lastMove)!=o:!zz(this.view,o,l,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:r}=this;if(r.length){let{tooltip:n}=this;n&&n.dom.contains(e.relatedTarget)?this.watchTooltipLeave(n.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let r=n=>{e.removeEventListener("mouseleave",r),this.active.length&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",r)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}},nc=4;function Vz(t,e){let{left:r,right:n,top:a,bottom:s}=t.getBoundingClientRect(),o;if(o=t.querySelector(".cm-tooltip-arrow")){let l=o.getBoundingClientRect();a=Math.min(l.top,a),s=Math.max(l.bottom,s)}return e.clientX>=r-nc&&e.clientX<=n+nc&&e.clientY>=a-nc&&e.clientY<=s+nc}function zz(t,e,r,n,a,s){let o=t.scrollDOM.getBoundingClientRect(),l=t.documentTop+t.documentPadding.top+t.contentHeight;if(o.left>n||o.right<n||o.top>a||Math.min(o.bottom,l)<a)return!1;let u=t.posAtCoords({x:n,y:a},!1);return u>=e&&u<=r}function Hz(t,e={}){let r=W.StateEffect.define(),n=W.StateField.define({create(){return[]},update(a,s){if(a.length&&(e.hideOnChange&&(s.docChanged||s.selection)?a=[]:e.hideOn&&(a=a.filter(o=>!e.hideOn(s,o))),s.docChanged)){let o=[];for(let l of a){let u=s.changes.mapPos(l.pos,-1,W.MapMode.TrackDel);if(u!=null){let c=Object.assign(Object.create(null),l);c.pos=u,c.end!=null&&(c.end=s.changes.mapPos(c.end)),o.push(c)}}a=o}for(let o of s.effects)o.is(r)&&(a=o.value),o.is(ax)&&(a=[]);return a},provide:a=>Ko.from(a)});return{active:n,extension:[n,er.define(a=>new Cp(a,t,n,r,e.hoverTime||300)),qz]}}function Uz(t,e){let r=t.plugin(Mc);if(!r)return null;let n=r.manager.tooltips.indexOf(e);return n<0?null:r.manager.tooltipViews[n]}function Wz(t){return t.facet(Ko).some(e=>e)}var ax=W.StateEffect.define(),Gz=ax.of(null);function Kz(t){let e=t.plugin(Mc);e&&e.maybeMeasure()}var Tp=W.Facet.define({combine(t){let e,r;for(let n of t)e=e||n.topContainer,r=r||n.bottomContainer;return{topContainer:e,bottomContainer:r}}});function jz(t){return t?[Tp.of(t)]:[]}function Yz(t,e){let r=t.plugin(sx),n=r?r.specs.indexOf(e):-1;return n>-1?r.panels[n]:null}var sx=er.fromClass(class{constructor(t){this.input=t.state.facet(kp),this.specs=this.input.filter(r=>r),this.panels=this.specs.map(r=>r(t));let e=t.state.facet(Tp);this.top=new as(t,!0,e.topContainer),this.bottom=new as(t,!1,e.bottomContainer),this.top.sync(this.panels.filter(r=>r.top)),this.bottom.sync(this.panels.filter(r=>!r.top));for(let r of this.panels)r.dom.classList.add("cm-panel"),r.mount&&r.mount()}update(t){let e=t.state.facet(Tp);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new as(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new as(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let r=t.state.facet(kp);if(r!=this.input){let n=r.filter(u=>u),a=[],s=[],o=[],l=[];for(let u of n){let c=this.specs.indexOf(u),f;c<0?(f=u(t.view),l.push(f)):(f=this.panels[c],f.update&&f.update(t)),a.push(f),(f.top?s:o).push(f)}this.specs=n,this.panels=a,this.top.sync(s),this.bottom.sync(o);for(let u of l)u.dom.classList.add("cm-panel"),u.mount&&u.mount()}else for(let n of this.panels)n.update&&n.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>Ze.scrollMargins.of(e=>{let r=e.plugin(t);return r&&{top:r.top.scrollMargin(),bottom:r.bottom.scrollMargin()}})}),as=class{constructor(e,r,n){this.view=e,this.top=r,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let r of this.panels)r.destroy&&e.indexOf(r)<0&&r.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let r=this.container||this.view.dom;r.insertBefore(this.dom,this.top?r.firstChild:null)}let e=this.dom.firstChild;for(let r of this.panels)if(r.dom.parentNode==this.dom){for(;e!=r.dom;)e=t_(e);e=e.nextSibling}else this.dom.insertBefore(r.dom,e);for(;e;)e=t_(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}};function t_(t){let e=t.nextSibling;return t.remove(),e}var kp=W.Facet.define({enables:sx}),dn=class extends W.RangeValue{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}};dn.prototype.elementClass="";dn.prototype.toDOM=void 0;dn.prototype.mapMode=W.MapMode.TrackBefore;dn.prototype.startSide=dn.prototype.endSide=-1;dn.prototype.point=!0;var Bo=W.Facet.define(),ox=W.Facet.define(),Zz={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>W.RangeSet.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Lo=W.Facet.define();function Xz(t){return[Vp(),Lo.of(Object.assign(Object.assign({},Zz),t))]}var Ap=W.Facet.define({combine:t=>t.some(e=>e)});function Vp(t){let e=[$z];return t&&t.fixed===!1&&e.push(Ap.of(!0)),e}var $z=er.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(Lo).map(e=>new Sc(t,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!t.state.facet(Ap),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,r=t.view.viewport,n=Math.min(e.to,r.to)-Math.max(e.from,r.from);this.syncGutters(n<(r.to-r.from)*.8)}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(Ap)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let r=W.RangeSet.iter(this.view.state.facet(Bo),this.view.viewport.from),n=[],a=this.gutters.map(s=>new Pp(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(s.type)){let o=!0;for(let l of s.type)if(l.type==oe.BlockType.Text&&o){Mp(r,n,l.from);for(let u of a)u.line(this.view,l,n);o=!1}else if(l.widget)for(let u of a)u.widget(this.view,l)}else if(s.type==oe.BlockType.Text){Mp(r,n,s.from);for(let o of a)o.line(this.view,s,n)}else if(s.widget)for(let o of a)o.widget(this.view,s);for(let s of a)s.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(Lo),r=t.state.facet(Lo),n=t.docChanged||t.heightChanged||t.viewportChanged||!W.RangeSet.eq(t.startState.facet(Bo),t.state.facet(Bo),t.view.viewport.from,t.view.viewport.to);if(e==r)for(let a of this.gutters)a.update(t)&&(n=!0);else{n=!0;let a=[];for(let s of r){let o=e.indexOf(s);o<0?a.push(new Sc(this.view,s)):(this.gutters[o].update(t),a.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),a.indexOf(s)<0&&s.destroy();for(let s of a)this.dom.appendChild(s.dom);this.gutters=a}return n}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:t=>Ze.scrollMargins.of(e=>{let r=e.plugin(t);return!r||r.gutters.length==0||!r.fixed?null:e.textDirection==oe.Direction.LTR?{left:r.dom.offsetWidth*e.scaleX}:{right:r.dom.offsetWidth*e.scaleX}})});function r_(t){return Array.isArray(t)?t:[t]}function Mp(t,e,r){for(;t.value&&t.from<=r;)t.from==r&&e.push(t.value),t.next()}var Pp=class{constructor(e,r,n){this.gutter=e,this.height=n,this.i=0,this.cursor=W.RangeSet.iter(e.markers,r.from)}addElement(e,r,n){let{gutter:a}=this,s=(r.top-this.height)/e.scaleY,o=r.height/e.scaleY;if(this.i==a.elements.length){let l=new Cc(e,o,s,n);a.elements.push(l),a.dom.appendChild(l.dom)}else a.elements[this.i].update(e,o,s,n);this.height=r.bottom,this.i++}line(e,r,n){let a=[];Mp(this.cursor,a,r.from),n.length&&(a=a.concat(n));let s=this.gutter.config.lineMarker(e,r,a);s&&a.unshift(s);let o=this.gutter;a.length==0&&!o.config.renderEmptyElements||this.addElement(e,r,a)}widget(e,r){let n=this.gutter.config.widgetMarker(e,r.widget,r),a=n?[n]:null;for(let s of e.state.facet(ox)){let o=s(e,r.widget,r);o&&(a||(a=[])).push(o)}a&&this.addElement(e,r,a)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let r=e.elements.pop();e.dom.removeChild(r.dom),r.destroy()}}},Sc=class{constructor(e,r){this.view=e,this.config=r,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in r.domEventHandlers)this.dom.addEventListener(n,a=>{let s=a.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let u=s.getBoundingClientRect();o=(u.top+u.bottom)/2}else o=a.clientY;let l=e.lineBlockAtHeight(o-e.documentTop);r.domEventHandlers[n](e,l,a)&&a.preventDefault()});this.markers=r_(r.markers(e)),r.initialSpacer&&(this.spacer=new Cc(e,0,0,[r.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let r=this.markers;if(this.markers=r_(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let a=this.config.updateSpacer(this.spacer.markers[0],e);a!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[a])}let n=e.view.viewport;return!W.RangeSet.eq(this.markers,r,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}},Cc=class{constructor(e,r,n,a){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,r,n,a)}update(e,r,n,a){this.height!=r&&(this.height=r,this.dom.style.height=r+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),Qz(this.markers,a)||this.setMarkers(e,a)}setMarkers(e,r){let n="cm-gutterElement",a=this.dom.firstChild;for(let s=0,o=0;;){let l=o,u=s<r.length?r[s++]:null,c=!1;if(u){let f=u.elementClass;f&&(n+=" "+f);for(let h=o;h<this.markers.length;h++)if(this.markers[h].compare(u)){l=h,c=!0;break}}else l=this.markers.length;for(;o<l;){let f=this.markers[o++];if(f.toDOM){f.destroy(a);let h=a.nextSibling;a.remove(),a=h}}if(!u)break;u.toDOM&&(c?a=a.nextSibling:this.dom.insertBefore(u.toDOM(e),a)),c&&o++}this.dom.className=n,this.markers=r}destroy(){this.setMarkers(null,[])}};function Qz(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].compare(e[r]))return!1;return!0}var lx=W.Facet.define(),ux=W.Facet.define(),ss=W.Facet.define({combine(t){return W.combineConfig(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,r){let n=Object.assign({},e);for(let a in r){let s=n[a],o=r[a];n[a]=s?(l,u,c)=>s(l,u,c)||o(l,u,c):o}return n}})}}),No=class extends dn{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}};function Hd(t,e){return t.state.facet(ss).formatNumber(e,t.state)}var Jz=Lo.compute([ss],t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(lx)},lineMarker(e,r,n){return n.some(a=>a.toDOM)?null:new No(Hd(e,e.state.doc.lineAt(r.from).number))},widgetMarker:(e,r,n)=>{for(let a of e.state.facet(ux)){let s=a(e,r,n);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(ss)!=e.state.facet(ss),initialSpacer(e){return new No(Hd(e,n_(e.state.doc.lines)))},updateSpacer(e,r){let n=Hd(r.view,n_(r.view.state.doc.lines));return n==e.number?e:new No(n)},domEventHandlers:t.facet(ss).domEventHandlers}));function e3(t={}){return[ss.of(t),Vp(),Jz]}function n_(t){let e=9;for(;e<t;)e=e*10+9;return e}var t3=new class extends dn{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},r3=Bo.compute(["selection"],t=>{let e=[],r=-1;for(let n of t.selection.ranges){let a=t.doc.lineAt(n.head).from;a>r&&(r=a,e.push(t3.range(a)))}return W.RangeSet.of(e)});function n3(){return r3}function cx(t){return er.define(e=>({decorations:t.createDeco(e),update(r){this.decorations=t.updateDeco(r,this.decorations)}}),{decorations:e=>e.decorations})}var i3=ut.mark({class:"cm-highlightTab"}),a3=ut.mark({class:"cm-highlightSpace"}),s3=cx(new ds({regexp:/\t| /g,decoration:t=>t[0]=="	"?i3:a3,boundary:/\S/}));function o3(){return s3}var l3=cx(new ds({regexp:/\s+$/g,decoration:ut.mark({class:"cm-trailingSpace"}),boundary:/\S/}));function u3(){return l3}var c3={HeightMap:kr,HeightOracle:vc,MeasuredHeights:mc,QueryType:pt,ChangedRange:fn,computeOrder:__,moveVisually:S_,clearHeightChangeFlag:op,getHeightChangeFlag:()=>fa};oe.BidiSpan=un;oe.BlockInfo=ln;oe.Decoration=ut;oe.EditorView=Ze;oe.GutterMarker=dn;oe.MatchDecorator=ds;oe.RectangleMarker=cs;oe.ViewPlugin=er;oe.ViewUpdate=Go;oe.WidgetType=jn;oe.__test=c3;oe.closeHoverTooltips=Gz;oe.crosshairCursor=Iz;oe.drawSelection=lz;oe.dropCursor=pz;oe.getDrawSelectionConfig=uz;oe.getPanel=Yz;oe.getTooltip=Uz;oe.gutter=Xz;oe.gutterLineClass=Bo;oe.gutterWidgetClass=ox;oe.gutters=Vp;oe.hasHoverTooltips=Wz;oe.highlightActiveLine=Sz;oe.highlightActiveLineGutter=n3;oe.highlightSpecialChars=bz;oe.highlightTrailingWhitespace=u3;oe.highlightWhitespace=o3;oe.hoverTooltip=Hz;oe.keymap=J_;oe.layer=Fp;oe.lineNumberMarkers=lx;oe.lineNumberWidgetMarker=ux;oe.lineNumbers=e3;oe.logException=cn;oe.panels=jz;oe.placeholder=kz;oe.rectangularSelection=Rz;oe.repositionTooltips=Kz;oe.runScopeHandlers=nz;oe.scrollPastEnd=Ez;oe.showPanel=kp;oe.showTooltip=qp;oe.tooltips=Bz});var Bc=O(Ke=>{"use strict";var f3=0,Ar=class{constructor(e,r){this.from=e,this.to=r}},vt=class{constructor(e={}){this.id=f3++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Zr.match(e)),r=>{let n=e(r);return n===void 0?null:[this,n]}}};vt.closedBy=new vt({deserialize:t=>t.split(" ")});vt.openedBy=new vt({deserialize:t=>t.split(" ")});vt.group=new vt({deserialize:t=>t.split(" ")});vt.isolate=new vt({deserialize:t=>{if(t&&t!="rtl"&&t!="ltr"&&t!="auto")throw new RangeError("Invalid value for isolate: "+t);return t||"auto"}});vt.contextHash=new vt({perNode:!0});vt.lookAhead=new vt({perNode:!0});vt.mounted=new vt({perNode:!0});var Ei=class{constructor(e,r,n){this.tree=e,this.overlay=r,this.parser=n}static get(e){return e&&e.props&&e.props[vt.mounted.id]}},h3=Object.create(null),Zr=class t{constructor(e,r,n,a=0){this.name=e,this.props=r,this.id=n,this.flags=a}static define(e){let r=e.props&&e.props.length?Object.create(null):h3,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),a=new t(e.name||"",r,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(a)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");r[s[0].id]=s[1]}}return a}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let r=this.prop(vt.group);return r?r.indexOf(e)>-1:!1}return this.id==e}static match(e){let r=Object.create(null);for(let n in e)for(let a of n.split(" "))r[a]=e[n];return n=>{for(let a=n.prop(vt.group),s=-1;s<(a?a.length:0);s++){let o=r[s<0?n.name:a[s]];if(o)return o}}}};Zr.none=new Zr("",Object.create(null),0,8);var zp=class t{constructor(e){this.types=e;for(let r=0;r<e.length;r++)if(e[r].id!=r)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let r=[];for(let n of this.types){let a=null;for(let s of e){let o=s(n);o&&(a||(a=Object.assign({},n.props)),a[o[0].id]=o[1])}r.push(a?new Zr(n.name,a,n.id,n.flags):n)}return new t(r)}},Pc=new WeakMap,fx=new WeakMap;Ke.IterMode=void 0;(function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"})(Ke.IterMode||(Ke.IterMode={}));var Fr=class t{constructor(e,r,n,a,s){if(this.type=e,this.children=r,this.positions=n,this.length=a,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,l]of s)this.props[typeof o=="number"?o:o.id]=l}}toString(){let e=Ei.get(this);if(e&&!e.overlay)return e.tree.toString();let r="";for(let n of this.children){let a=n.toString();a&&(r&&(r+=","),r+=a)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(r.length?"("+r+")":""):r}cursor(e=0){return new da(this.topNode,e)}cursorAt(e,r=0,n=0){let a=Pc.get(this)||this.topNode,s=new da(a);return s.moveTo(e,r),Pc.set(this,s._tree),s}get topNode(){return new Mr(this,0,0,null)}resolve(e,r=0){let n=Yo(Pc.get(this)||this.topNode,e,r,!1);return Pc.set(this,n),n}resolveInner(e,r=0){let n=Yo(fx.get(this)||this.topNode,e,r,!0);return fx.set(this,n),n}resolveStack(e,r=0){return d3(this,e,r)}iterate(e){let{enter:r,leave:n,from:a=0,to:s=this.length}=e,o=e.mode||0,l=(o&Ke.IterMode.IncludeAnonymous)>0;for(let u=this.cursor(o|Ke.IterMode.IncludeAnonymous);;){let c=!1;if(u.from<=s&&u.to>=a&&(!l&&u.type.isAnonymous||r(u)!==!1)){if(u.firstChild())continue;c=!0}for(;c&&n&&(l||!u.type.isAnonymous)&&n(u),!u.nextSibling();){if(!u.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let r in this.props)e.push([+r,this.props[r]]);return e}balance(e={}){return this.children.length<=8?this:eg(Zr.none,this.children,this.positions,0,this.children.length,0,this.length,(r,n,a)=>new t(this.type,r,n,a,this.propValues),e.makeTree||((r,n,a)=>new t(Zr.none,r,n,a)))}static build(e){return p3(e)}};Fr.empty=new Fr(Zr.none,[],[],0);var Hp=class t{constructor(e,r){this.buffer=e,this.index=r}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new t(this.buffer,this.index)}},Yn=class t{constructor(e,r,n){this.buffer=e,this.length=r,this.set=n}get type(){return Zr.none}toString(){let e=[];for(let r=0;r<this.buffer.length;)e.push(this.childString(r)),r=this.buffer[r+3];return e.join(",")}childString(e){let r=this.buffer[e],n=this.buffer[e+3],a=this.set.types[r],s=a.name;if(/\W/.test(s)&&!a.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let o=[];for(;e<n;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,r,n,a,s){let{buffer:o}=this,l=-1;for(let u=e;u!=r&&!(yx(s,a,o[u+1],o[u+2])&&(l=u,n>0));u=o[u+3]);return l}slice(e,r,n){let a=this.buffer,s=new Uint16Array(r-e),o=0;for(let l=e,u=0;l<r;){s[u++]=a[l++],s[u++]=a[l++]-n;let c=s[u++]=a[l++]-n;s[u++]=a[l++]-e,o=Math.max(o,c)}return new t(s,o,this.set)}};function yx(t,e,r,n){switch(t){case-2:return r<e;case-1:return n>=e&&r<e;case 0:return r<e&&n>e;case 1:return r<=e&&n>e;case 2:return n>e;case 4:return!0}}function Yo(t,e,r,n){for(var a;t.from==t.to||(r<1?t.from>=e:t.from>e)||(r>-1?t.to<=e:t.to<e);){let o=!n&&t instanceof Mr&&t.index<0?null:t.parent;if(!o)return t;t=o}let s=n?0:Ke.IterMode.IgnoreOverlays;if(n)for(let o=t,l=o.parent;l;o=l,l=o.parent)o instanceof Mr&&o.index<0&&((a=l.enter(e,r,s))===null||a===void 0?void 0:a.from)!=o.from&&(t=l);for(;;){let o=t.enter(e,r,s);if(!o)return t;t=o}}var Dc=class{cursor(e=0){return new da(this,e)}getChild(e,r=null,n=null){let a=hx(this,e,r,n);return a.length?a[0]:null}getChildren(e,r=null,n=null){return hx(this,e,r,n)}resolve(e,r=0){return Yo(this,e,r,!1)}resolveInner(e,r=0){return Yo(this,e,r,!0)}matchContext(e){return Up(this.parent,e)}enterUnfinishedNodesBefore(e){let r=this.childBefore(e),n=this;for(;r;){let a=r.lastChild;if(!a||a.to!=r.to)break;a.type.isError&&a.from==a.to?(n=r,r=a.prevSibling):r=a}return n}get node(){return this}get next(){return this.parent}},Mr=class t extends Dc{constructor(e,r,n,a){super(),this._tree=e,this.from=r,this.index=n,this._parent=a}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,r,n,a,s=0){for(let o=this;;){for(let{children:l,positions:u}=o._tree,c=r>0?l.length:-1;e!=c;e+=r){let f=l[e],h=u[e]+o.from;if(yx(a,n,h,h+f.length)){if(f instanceof Yn){if(s&Ke.IterMode.ExcludeBuffers)continue;let d=f.findChild(0,f.buffer.length,r,n-h,a);if(d>-1)return new ha(new Wp(o,f,e,h),null,d)}else if(s&Ke.IterMode.IncludeAnonymous||!f.type.isAnonymous||Jp(f)){let d;if(!(s&Ke.IterMode.IgnoreMounts)&&(d=Ei.get(f))&&!d.overlay)return new t(d.tree,h,e,o);let p=new t(f,h,e,o);return s&Ke.IterMode.IncludeAnonymous||!p.type.isAnonymous?p:p.nextChild(r<0?f.children.length-1:0,r,n,a)}}}if(s&Ke.IterMode.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+r:e=r<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,r,n=0){let a;if(!(n&Ke.IterMode.IgnoreOverlays)&&(a=Ei.get(this._tree))&&a.overlay){let s=e-this.from;for(let{from:o,to:l}of a.overlay)if((r>0?o<=s:o<s)&&(r<0?l>=s:l>s))return new t(a.tree,a.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,r,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function hx(t,e,r,n){let a=t.cursor(),s=[];if(!a.firstChild())return s;if(r!=null){for(let o=!1;!o;)if(o=a.type.is(r),!a.nextSibling())return s}for(;;){if(n!=null&&a.type.is(n))return s;if(a.type.is(e)&&s.push(a.node),!a.nextSibling())return n==null?s:[]}}function Up(t,e,r=e.length-1){for(let n=t;r>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[r]&&e[r]!=n.name)return!1;r--}}return!0}var Wp=class{constructor(e,r,n,a){this.parent=e,this.buffer=r,this.index=n,this.start=a}},ha=class t extends Dc{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,r,n){super(),this.context=e,this._parent=r,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,r,n){let{buffer:a}=this.context,s=a.findChild(this.index+4,a.buffer[this.index+3],e,r-this.context.start,n);return s<0?null:new t(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,r,n=0){if(n&Ke.IterMode.ExcludeBuffers)return null;let{buffer:a}=this.context,s=a.findChild(this.index+4,a.buffer[this.index+3],r>0?1:-1,e-this.context.start,r);return s<0?null:new t(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,r=e.buffer[this.index+3];return r<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new t(this.context,this._parent,r):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,r=this._parent?this._parent.index+4:0;return this.index==r?this.externalSibling(-1):new t(this.context,this._parent,e.findChild(r,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],r=[],{buffer:n}=this.context,a=this.index+4,s=n.buffer[this.index+3];if(s>a){let o=n.buffer[this.index+1];e.push(n.slice(a,s,o)),r.push(0)}return new Fr(this.type,e,r,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function bx(t){if(!t.length)return null;let e=0,r=t[0];for(let s=1;s<t.length;s++){let o=t[s];(o.from>r.from||o.to<r.to)&&(r=o,e=s)}let n=r instanceof Mr&&r.index<0?null:r.parent,a=t.slice();return n?a[e]=n:a.splice(e,1),new Gp(a,r)}var Gp=class{constructor(e,r){this.heads=e,this.node=r}get next(){return bx(this.heads)}};function d3(t,e,r){let n=t.resolveInner(e,r),a=null;for(let s=n instanceof Mr?n:n.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(a||(a=[n])).push(o.resolve(e,r)),s=o}else{let o=Ei.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let l=new Mr(o.tree,o.overlay[0].from+s.from,-1,s);(a||(a=[n])).push(Yo(l,e,r,!1))}}return a?bx(a):n}var da=class{get name(){return this.type.name}constructor(e,r=0){if(this.mode=r,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Mr)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,r){this.index=e;let{start:n,buffer:a}=this.buffer;return this.type=r||a.set.types[a.buffer[e]],this.from=n+a.buffer[e+1],this.to=n+a.buffer[e+2],!0}yield(e){return e?e instanceof Mr?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,r,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,r,n,this.mode));let{buffer:a}=this.buffer,s=a.findChild(this.index+4,a.buffer[this.index+3],e,r-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,r,n=this.mode){return this.buffer?n&Ke.IterMode.ExcludeBuffers?!1:this.enterChild(1,e,r):this.yield(this._tree.enter(e,r,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Ke.IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Ke.IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:r}=this.buffer,n=this.stack.length-1;if(e<0){let a=n<0?0:this.stack[n]+4;if(this.index!=a)return this.yieldBuf(r.findChild(a,this.index,-1,0,4))}else{let a=r.buffer[this.index+3];if(a<(n<0?r.buffer.length:r.buffer[this.stack[n]+3]))return this.yieldBuf(a)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let r,n,{buffer:a}=this;if(a){if(e>0){if(this.index<a.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(a.buffer.buffer[s+3]<this.index)return!1;({index:r,parent:n}=a)}else({index:r,_parent:n}=this._tree);for(;n;{index:r,_parent:n}=n)if(r>-1)for(let s=r+e,o=e<0?-1:n._tree.children.length;s!=o;s+=e){let l=n._tree.children[s];if(this.mode&Ke.IterMode.IncludeAnonymous||l instanceof Yn||!l.type.isAnonymous||Jp(l))return!1}return!0}move(e,r){if(r&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,r=0){for(;(this.from==this.to||(r<1?this.from>=e:this.from>e)||(r>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,r););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,r=null,n=0;if(e&&e.context==this.buffer)e:for(let a=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==a){if(a==this.index)return o;r=o,n=s+1;break e}a=this.stack[--s]}for(let a=n;a<this.stack.length;a++)r=new ha(this.buffer,r,this.stack[a]);return this.bufferNode=new ha(this.buffer,r,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,r){for(let n=0;;){let a=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(a=!0)}for(;;){if(a&&r&&r(this),a=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,a=!0}}}matchContext(e){if(!this.buffer)return Up(this.node.parent,e);let{buffer:r}=this.buffer,{types:n}=r.set;for(let a=e.length-1,s=this.stack.length-1;a>=0;s--){if(s<0)return Up(this._tree,e,a);let o=n[r.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[a]&&e[a]!=o.name)return!1;a--}}return!0}};function Jp(t){return t.children.some(e=>e instanceof Yn||!e.type.isAnonymous||Jp(e))}function p3(t){var e;let{buffer:r,nodeSet:n,maxBufferLength:a=1024,reused:s=[],minRepeatType:o=n.types.length}=t,l=Array.isArray(r)?new Hp(r,r.length):r,u=n.types,c=0,f=0;function h(x,S,E,A,T,D){let{id:k,start:M,end:P,size:I}=l,B=f,L=c;for(;I<0;)if(l.next(),I==-1){let V=s[k];E.push(V),A.push(M-x);return}else if(I==-3){c=k;return}else if(I==-4){f=k;return}else throw new RangeError(`Unrecognized record size: ${I}`);let N=u[k],F,q,H=M-x;if(P-M<=a&&(q=v(l.pos-S,T))){let V=new Uint16Array(q.size-q.skip),z=l.pos-q.size,Y=V.length;for(;l.pos>z;)Y=y(q.start,V,Y);F=new Yn(V,P-q.start,n),H=q.start-x}else{let V=l.pos-I;l.next();let z=[],Y=[],Q=k>=o?k:-1,J=0,ee=P;for(;l.pos>V;)Q>=0&&l.id==Q&&l.size>=0?(l.end<=ee-a&&(g(z,Y,M,J,l.end,ee,Q,B,L),J=z.length,ee=l.end),l.next()):D>2500?d(M,V,z,Y):h(M,V,z,Y,Q,D+1);if(Q>=0&&J>0&&J<z.length&&g(z,Y,M,J,M,ee,Q,B,L),z.reverse(),Y.reverse(),Q>-1&&J>0){let ae=p(N,L);F=eg(N,z,Y,0,z.length,0,P-M,ae,ae)}else F=m(N,z,Y,P-M,B-P,L)}E.push(F),A.push(H)}function d(x,S,E,A){let T=[],D=0,k=-1;for(;l.pos>S;){let{id:M,start:P,end:I,size:B}=l;if(B>4)l.next();else{if(k>-1&&P<k)break;k<0&&(k=I-a),T.push(M,P,I),D++,l.next()}}if(D){let M=new Uint16Array(D*4),P=T[T.length-2];for(let I=T.length-3,B=0;I>=0;I-=3)M[B++]=T[I],M[B++]=T[I+1]-P,M[B++]=T[I+2]-P,M[B++]=B;E.push(new Yn(M,T[2]-P,n)),A.push(P-x)}}function p(x,S){return(E,A,T)=>{let D=0,k=E.length-1,M,P;if(k>=0&&(M=E[k])instanceof Fr){if(!k&&M.type==x&&M.length==T)return M;(P=M.prop(vt.lookAhead))&&(D=A[k]+M.length+P)}return m(x,E,A,T,D,S)}}function g(x,S,E,A,T,D,k,M,P){let I=[],B=[];for(;x.length>A;)I.push(x.pop()),B.push(S.pop()+E-T);x.push(m(n.types[k],I,B,D-T,M-D,P)),S.push(T-E)}function m(x,S,E,A,T,D,k){if(D){let M=[vt.contextHash,D];k=k?[M].concat(k):[M]}if(T>25){let M=[vt.lookAhead,T];k=k?[M].concat(k):[M]}return new Fr(x,S,E,A,k)}function v(x,S){let E=l.fork(),A=0,T=0,D=0,k=E.end-a,M={size:0,start:0,skip:0};e:for(let P=E.pos-x;E.pos>P;){let I=E.size;if(E.id==S&&I>=0){M.size=A,M.start=T,M.skip=D,D+=4,A+=4,E.next();continue}let B=E.pos-I;if(I<0||B<P||E.start<k)break;let L=E.id>=o?4:0,N=E.start;for(E.next();E.pos>B;){if(E.size<0)if(E.size==-3)L+=4;else break e;else E.id>=o&&(L+=4);E.next()}T=N,A+=I,D+=L}return(S<0||A==x)&&(M.size=A,M.start=T,M.skip=D),M.size>4?M:void 0}function y(x,S,E){let{id:A,start:T,end:D,size:k}=l;if(l.next(),k>=0&&A<o){let M=E;if(k>4){let P=l.pos-(k-4);for(;l.pos>P;)E=y(x,S,E)}S[--E]=M,S[--E]=D-x,S[--E]=T-x,S[--E]=A}else k==-3?c=A:k==-4&&(f=A);return E}let b=[],w=[];for(;l.pos>0;)h(t.start||0,t.bufferStart||0,b,w,-1,0);let _=(e=t.length)!==null&&e!==void 0?e:b.length?w[0]+b[0].length:0;return new Fr(u[t.topID],b.reverse(),w.reverse(),_)}var dx=new WeakMap;function Rc(t,e){if(!t.isAnonymous||e instanceof Yn||e.type!=t)return 1;let r=dx.get(e);if(r==null){r=1;for(let n of e.children){if(n.type!=t||!(n instanceof Fr)){r=1;break}r+=Rc(t,n)}dx.set(e,r)}return r}function eg(t,e,r,n,a,s,o,l,u){let c=0;for(let g=n;g<a;g++)c+=Rc(t,e[g]);let f=Math.ceil(c*1.5/8),h=[],d=[];function p(g,m,v,y,b){for(let w=v;w<y;){let _=w,x=m[w],S=Rc(t,g[w]);for(w++;w<y;w++){let E=Rc(t,g[w]);if(S+E>=f)break;S+=E}if(w==_+1){if(S>f){let E=g[_];p(E.children,E.positions,0,E.children.length,m[_]+b);continue}h.push(g[_])}else{let E=m[w-1]+g[w-1].length-x;h.push(eg(t,g,m,_,w,x,E,null,u))}d.push(x+b-s)}}return p(e,r,n,a,0),(l||u)(h,d,o)}var Kp=class{constructor(){this.map=new WeakMap}setBuffer(e,r,n){let a=this.map.get(e);a||this.map.set(e,a=new Map),a.set(r,n)}getBuffer(e,r){let n=this.map.get(e);return n&&n.get(r)}set(e,r){e instanceof ha?this.setBuffer(e.context.buffer,e.index,r):e instanceof Mr&&this.map.set(e.tree,r)}get(e){return e instanceof ha?this.getBuffer(e.context.buffer,e.index):e instanceof Mr?this.map.get(e.tree):void 0}cursorSet(e,r){e.buffer?this.setBuffer(e.buffer.buffer,e.index,r):this.map.set(e.tree,r)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}},Zo=class t{constructor(e,r,n,a,s=!1,o=!1){this.from=e,this.to=r,this.tree=n,this.offset=a,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,r=[],n=!1){let a=[new t(0,e.length,e,0,!1,n)];for(let s of r)s.to>e.length&&a.push(s);return a}static applyChanges(e,r,n=128){if(!r.length)return e;let a=[],s=1,o=e.length?e[0]:null;for(let l=0,u=0,c=0;;l++){let f=l<r.length?r[l]:null,h=f?f.fromA:1e9;if(h-u>=n)for(;o&&o.from<h;){let d=o;if(u>=d.from||h<=d.to||c){let p=Math.max(d.from,u)-c,g=Math.min(d.to,h)-c;d=p>=g?null:new t(p,g,d.tree,d.offset+c,l>0,!!f)}if(d&&a.push(d),o.to>h)break;o=s<e.length?e[s++]:null}if(!f)break;u=f.toA,c=f.toA-f.toB}return a}},jp=class{startParse(e,r,n){return typeof e=="string"&&(e=new Yp(e)),n=n?n.length?n.map(a=>new Ar(a.from,a.to)):[new Ar(0,0)]:[new Ar(0,e.length)],this.createParse(e,r||[],n)}parse(e,r,n){let a=this.startParse(e,r,n);for(;;){let s=a.advance();if(s)return s}}},Yp=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,r){return this.string.slice(e,r)}};function g3(t){return(e,r,n,a)=>new $p(e,t,r,n,a)}var Oc=class{constructor(e,r,n,a,s){this.parser=e,this.parse=r,this.overlay=n,this.target=a,this.from=s}};function px(t){if(!t.length||t.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(t))}var Zp=class{constructor(e,r,n,a,s,o,l){this.parser=e,this.predicate=r,this.mounts=n,this.index=a,this.start=s,this.target=o,this.prev=l,this.depth=0,this.ranges=[]}},Xp=new vt({perNode:!0}),$p=class{constructor(e,r,n,a,s){this.nest=r,this.input=n,this.fragments=a,this.ranges=s,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let n=this.baseParse.advance();if(!n)return null;if(this.baseParse=null,this.baseTree=n,this.startInner(),this.stoppedAt!=null)for(let a of this.inner)a.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let n=this.baseTree;return this.stoppedAt!=null&&(n=new Fr(n.type,n.children,n.positions,n.length,n.propValues.concat([[Xp,this.stoppedAt]]))),n}let e=this.inner[this.innerDone],r=e.parse.advance();if(r){this.innerDone++;let n=Object.assign(Object.create(null),e.target.props);n[vt.mounted.id]=new Ei(r,e.overlay,e.parser),e.target.props=n}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let r=this.innerDone;r<this.inner.length;r++)this.inner[r].from<e&&(e=Math.min(e,this.inner[r].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let r=this.innerDone;r<this.inner.length;r++)this.inner[r].parse.stopAt(e)}startInner(){let e=new Qp(this.fragments),r=null,n=null,a=new da(new Mr(this.baseTree,this.ranges[0].from,0,null),Ke.IterMode.IncludeAnonymous|Ke.IterMode.IgnoreMounts);e:for(let s,o;;){let l=!0,u;if(this.stoppedAt!=null&&a.from>=this.stoppedAt)l=!1;else if(e.hasNode(a)){if(r){let c=r.mounts.find(f=>f.frag.from<=a.from&&f.frag.to>=a.to&&f.mount.overlay);if(c)for(let f of c.mount.overlay){let h=f.from+c.pos,d=f.to+c.pos;h>=a.from&&d<=a.to&&!r.ranges.some(p=>p.from<d&&p.to>h)&&r.ranges.push({from:h,to:d})}}l=!1}else if(n&&(o=v3(n.ranges,a.from,a.to)))l=o!=2;else if(!a.type.isAnonymous&&(s=this.nest(a,this.input))&&(a.from<a.to||!s.overlay)){a.tree||m3(a);let c=e.findMounts(a.from,s.parser);if(typeof s.overlay=="function")r=new Zp(s.parser,s.overlay,c,this.inner.length,a.from,a.tree,r);else{let f=vx(this.ranges,s.overlay||(a.from<a.to?[new Ar(a.from,a.to)]:[]));f.length&&px(f),(f.length||!s.overlay)&&this.inner.push(new Oc(s.parser,f.length?s.parser.startParse(this.input,mx(c,f),f):s.parser.startParse(""),s.overlay?s.overlay.map(h=>new Ar(h.from-a.from,h.to-a.from)):null,a.tree,f.length?f[0].from:a.from)),s.overlay?f.length&&(n={ranges:f,depth:0,prev:n}):l=!1}}else if(r&&(u=r.predicate(a))&&(u===!0&&(u=new Ar(a.from,a.to)),u.from<u.to)){let c=r.ranges.length-1;c>=0&&r.ranges[c].to==u.from?r.ranges[c]={from:r.ranges[c].from,to:u.to}:r.ranges.push(u)}if(l&&a.firstChild())r&&r.depth++,n&&n.depth++;else for(;!a.nextSibling();){if(!a.parent())break e;if(r&&!--r.depth){let c=vx(this.ranges,r.ranges);c.length&&(px(c),this.inner.splice(r.index,0,new Oc(r.parser,r.parser.startParse(this.input,mx(r.mounts,c),c),r.ranges.map(f=>new Ar(f.from-r.start,f.to-r.start)),r.target,c[0].from))),r=r.prev}n&&!--n.depth&&(n=n.prev)}}}};function v3(t,e,r){for(let n of t){if(n.from>=r)break;if(n.to>e)return n.from<=e&&n.to>=r?2:1}return 0}function gx(t,e,r,n,a,s){if(e<r){let o=t.buffer[e+1];n.push(t.slice(e,r,o)),a.push(o-s)}}function m3(t){let{node:e}=t,r=[],n=e.context.buffer;do r.push(t.index),t.parent();while(!t.tree);let a=t.tree,s=a.children.indexOf(n),o=a.children[s],l=o.buffer,u=[s];function c(f,h,d,p,g,m){let v=r[m],y=[],b=[];gx(o,f,v,y,b,p);let w=l[v+1],_=l[v+2];u.push(y.length);let x=m?c(v+4,l[v+3],o.set.types[l[v]],w,_-w,m-1):e.toTree();return y.push(x),b.push(w-p),gx(o,l[v+3],h,y,b,p),new Fr(d,y,b,g)}a.children[s]=c(0,l.length,Zr.none,0,o.length,r.length-1);for(let f of u){let h=t.tree.children[f],d=t.tree.positions[f];t.yield(new Mr(h,d+t.from,f,t._tree))}}var Ic=class{constructor(e,r){this.offset=r,this.done=!1,this.cursor=e.cursor(Ke.IterMode.IncludeAnonymous|Ke.IterMode.IgnoreMounts)}moveTo(e){let{cursor:r}=this,n=e-this.offset;for(;!this.done&&r.from<n;)r.to>=e&&r.enter(n,1,Ke.IterMode.IgnoreOverlays|Ke.IterMode.ExcludeBuffers)||r.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let r=this.cursor.tree;;){if(r==e.tree)return!0;if(r.children.length&&r.positions[0]==0&&r.children[0]instanceof Fr)r=r.children[0];else break}return!1}},Qp=class{constructor(e){var r;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let n=this.curFrag=e[0];this.curTo=(r=n.tree.prop(Xp))!==null&&r!==void 0?r:n.to,this.inner=new Ic(n.tree,-n.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let r=this.curFrag=this.fragments[this.fragI];this.curTo=(e=r.tree.prop(Xp))!==null&&e!==void 0?e:r.to,this.inner=new Ic(r.tree,-r.offset)}}findMounts(e,r){var n;let a=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let s=this.inner.cursor.node;s;s=s.parent){let o=(n=s.tree)===null||n===void 0?void 0:n.prop(vt.mounted);if(o&&o.parser==r)for(let l=this.fragI;l<this.fragments.length;l++){let u=this.fragments[l];if(u.from>=s.to)break;u.tree==this.curFrag.tree&&a.push({frag:u,pos:s.from-u.offset,mount:o})}}}return a}};function vx(t,e){let r=null,n=e;for(let a=1,s=0;a<t.length;a++){let o=t[a-1].to,l=t[a].from;for(;s<n.length;s++){let u=n[s];if(u.from>=l)break;u.to<=o||(r||(n=r=e.slice()),u.from<o?(r[s]=new Ar(u.from,o),u.to>l&&r.splice(s+1,0,new Ar(l,u.to))):u.to>l?r[s--]=new Ar(l,u.to):r.splice(s--,1))}}return n}function y3(t,e,r,n){let a=0,s=0,o=!1,l=!1,u=-1e9,c=[];for(;;){let f=a==t.length?1e9:o?t[a].to:t[a].from,h=s==e.length?1e9:l?e[s].to:e[s].from;if(o!=l){let d=Math.max(u,r),p=Math.min(f,h,n);d<p&&c.push(new Ar(d,p))}if(u=Math.min(f,h),u==1e9)break;f==u&&(o?(o=!1,a++):o=!0),h==u&&(l?(l=!1,s++):l=!0)}return c}function mx(t,e){let r=[];for(let{pos:n,mount:a,frag:s}of t){let o=n+(a.overlay?a.overlay[0].from:0),l=o+a.tree.length,u=Math.max(s.from,o),c=Math.min(s.to,l);if(a.overlay){let f=a.overlay.map(d=>new Ar(d.from+n,d.to+n)),h=y3(e,f,u,c);for(let d=0,p=u;;d++){let g=d==h.length,m=g?c:h[d].from;if(m>p&&r.push(new Zo(p,m,a.tree,-o,s.from>=p||s.openStart,s.to<=m||s.openEnd)),g)break;p=h[d].to}}else r.push(new Zo(u,c,a.tree,-o,s.from>=o||s.openStart,s.to<=l||s.openEnd))}return r}Ke.DefaultBufferLength=1024;Ke.MountedTree=Ei;Ke.NodeProp=vt;Ke.NodeSet=zp;Ke.NodeType=Zr;Ke.NodeWeakMap=Kp;Ke.Parser=jp;Ke.Tree=Fr;Ke.TreeBuffer=Yn;Ke.TreeCursor=da;Ke.TreeFragment=Zo;Ke.parseMixed=g3});var kx=O(kn=>{"use strict";Object.defineProperty(kn,"__esModule",{value:!0});var xx=Bc(),b3=0,Xr=class t{constructor(e,r,n,a){this.name=e,this.set=r,this.base=n,this.modified=a,this.id=b3++}toString(){let{name:e}=this;for(let r of this.modified)r.name&&(e=`${r.name}(${e})`);return e}static define(e,r){let n=typeof e=="string"?e:"?";if(e instanceof t&&(r=e),r?.base)throw new Error("Can not derive from a modified tag");let a=new t(n,[],null,[]);if(a.set.push(a),r)for(let s of r.set)a.set.push(s);return a}static defineModifier(e){let r=new qc(e);return n=>n.modified.indexOf(r)>-1?n:qc.get(n.base||n,n.modified.concat(r).sort((a,s)=>a.id-s.id))}},w3=0,qc=class t{constructor(e){this.name=e,this.instances=[],this.id=w3++}static get(e,r){if(!r.length)return e;let n=r[0].instances.find(l=>l.base==e&&_3(r,l.modified));if(n)return n;let a=[],s=new Xr(e.name,a,e,r);for(let l of r)l.instances.push(s);let o=x3(r);for(let l of e.set)if(!l.modified.length)for(let u of o)a.push(t.get(l,u));return s}};function _3(t,e){return t.length==e.length&&t.every((r,n)=>r==e[n])}function x3(t){let e=[[]];for(let r=0;r<t.length;r++)for(let n=0,a=e.length;n<a;n++)e.push(e[n].concat(t[r]));return e.sort((r,n)=>n.length-r.length)}function E3(t){let e=Object.create(null);for(let r in t){let n=t[r];Array.isArray(n)||(n=[n]);for(let a of r.split(" "))if(a){let s=[],o=2,l=a;for(let h=0;;){if(l=="..."&&h>0&&h+3==a.length){o=1;break}let d=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!d)throw new RangeError("Invalid path: "+a);if(s.push(d[0]=="*"?"":d[0][0]=='"'?JSON.parse(d[0]):d[0]),h+=d[0].length,h==a.length)break;let p=a[h++];if(h==a.length&&p=="!"){o=0;break}if(p!="/")throw new RangeError("Invalid path: "+a);l=a.slice(h)}let u=s.length-1,c=s[u];if(!c)throw new RangeError("Invalid path: "+a);let f=new ps(n,o,u>0?s.slice(0,u):null);e[c]=f.sort(e[c])}}return Ex.add(e)}var Ex=new xx.NodeProp,ps=class{constructor(e,r,n,a){this.tags=e,this.mode=r,this.context=n,this.next=a}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}};ps.empty=new ps([],2,null);function Sx(t,e){let r=Object.create(null);for(let s of t)if(!Array.isArray(s.tag))r[s.tag.id]=s.class;else for(let o of s.tag)r[o.id]=s.class;let{scope:n,all:a=null}=e||{};return{style:s=>{let o=a;for(let l of s)for(let u of l.set){let c=r[u.id];if(c){o=o?o+" "+c:c;break}}return o},scope:n}}function S3(t,e){let r=null;for(let n of t){let a=n.style(e);a&&(r=r?r+" "+a:a)}return r}function Cx(t,e,r,n=0,a=t.length){let s=new rg(n,Array.isArray(e)?e:[e],r);s.highlightRange(t.cursor(),n,a,"",s.highlighters),s.flush(a)}function C3(t,e,r,n,a,s=0,o=t.length){let l=s;function u(c,f){if(!(c<=l)){for(let h=t.slice(l,c),d=0;;){let p=h.indexOf(`
`,d),g=p<0?h.length:p;if(g>d&&n(h.slice(d,g),f),p<0)break;a(),d=p+1}l=c}}Cx(e,r,(c,f,h)=>{u(c,""),u(f,h)},s,o),u(o,"")}var rg=class{constructor(e,r,n){this.at=e,this.highlighters=r,this.span=n,this.class=""}startSpan(e,r){r!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=r)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,r,n,a,s){let{type:o,from:l,to:u}=e;if(l>=n||u<=r)return;o.isTop&&(s=this.highlighters.filter(p=>!p.scope||p.scope(o)));let c=a,f=Tx(e)||ps.empty,h=S3(s,f.tags);if(h&&(c&&(c+=" "),c+=h,f.mode==1&&(a+=(a?" ":"")+h)),this.startSpan(Math.max(r,l),c),f.opaque)return;let d=e.tree&&e.tree.prop(xx.NodeProp.mounted);if(d&&d.overlay){let p=e.node.enter(d.overlay[0].from+l,1),g=this.highlighters.filter(v=>!v.scope||v.scope(d.tree.type)),m=e.firstChild();for(let v=0,y=l;;v++){let b=v<d.overlay.length?d.overlay[v]:null,w=b?b.from+l:u,_=Math.max(r,y),x=Math.min(n,w);if(_<x&&m)for(;e.from<x&&(this.highlightRange(e,_,x,a,s),this.startSpan(Math.min(x,e.to),c),!(e.to>=w||!e.nextSibling())););if(!b||w>n)break;y=b.to+l,y>r&&(this.highlightRange(p.cursor(),Math.max(r,b.from+l),Math.min(n,y),"",g),this.startSpan(Math.min(n,y),c))}m&&e.parent()}else if(e.firstChild()){d&&(a="");do if(!(e.to<=r)){if(e.from>=n)break;this.highlightRange(e,r,n,a,s),this.startSpan(Math.min(n,e.to),c)}while(e.nextSibling());e.parent()}}};function Tx(t){let e=t.type.prop(Ex);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}var ce=Xr.define,Lc=ce(),Si=ce(),wx=ce(Si),_x=ce(Si),Ci=ce(),Nc=ce(Ci),tg=ce(Ci),Tn=ce(),pa=ce(Tn),Sn=ce(),Cn=ce(),ng=ce(),Xo=ce(ng),Fc=ce(),Ve={comment:Lc,lineComment:ce(Lc),blockComment:ce(Lc),docComment:ce(Lc),name:Si,variableName:ce(Si),typeName:wx,tagName:ce(wx),propertyName:_x,attributeName:ce(_x),className:ce(Si),labelName:ce(Si),namespace:ce(Si),macroName:ce(Si),literal:Ci,string:Nc,docString:ce(Nc),character:ce(Nc),attributeValue:ce(Nc),number:tg,integer:ce(tg),float:ce(tg),bool:ce(Ci),regexp:ce(Ci),escape:ce(Ci),color:ce(Ci),url:ce(Ci),keyword:Sn,self:ce(Sn),null:ce(Sn),atom:ce(Sn),unit:ce(Sn),modifier:ce(Sn),operatorKeyword:ce(Sn),controlKeyword:ce(Sn),definitionKeyword:ce(Sn),moduleKeyword:ce(Sn),operator:Cn,derefOperator:ce(Cn),arithmeticOperator:ce(Cn),logicOperator:ce(Cn),bitwiseOperator:ce(Cn),compareOperator:ce(Cn),updateOperator:ce(Cn),definitionOperator:ce(Cn),typeOperator:ce(Cn),controlOperator:ce(Cn),punctuation:ng,separator:ce(ng),bracket:Xo,angleBracket:ce(Xo),squareBracket:ce(Xo),paren:ce(Xo),brace:ce(Xo),content:Tn,heading:pa,heading1:ce(pa),heading2:ce(pa),heading3:ce(pa),heading4:ce(pa),heading5:ce(pa),heading6:ce(pa),contentSeparator:ce(Tn),list:ce(Tn),quote:ce(Tn),emphasis:ce(Tn),strong:ce(Tn),link:ce(Tn),monospace:ce(Tn),strikethrough:ce(Tn),inserted:ce(),deleted:ce(),changed:ce(),invalid:ce(),meta:Fc,documentMeta:ce(Fc),annotation:ce(Fc),processingInstruction:ce(Fc),definition:Xr.defineModifier("definition"),constant:Xr.defineModifier("constant"),function:Xr.defineModifier("function"),standard:Xr.defineModifier("standard"),local:Xr.defineModifier("local"),special:Xr.defineModifier("special")};for(let t in Ve){let e=Ve[t];e instanceof Xr&&(e.name=t)}var T3=Sx([{tag:Ve.link,class:"tok-link"},{tag:Ve.heading,class:"tok-heading"},{tag:Ve.emphasis,class:"tok-emphasis"},{tag:Ve.strong,class:"tok-strong"},{tag:Ve.keyword,class:"tok-keyword"},{tag:Ve.atom,class:"tok-atom"},{tag:Ve.bool,class:"tok-bool"},{tag:Ve.url,class:"tok-url"},{tag:Ve.labelName,class:"tok-labelName"},{tag:Ve.inserted,class:"tok-inserted"},{tag:Ve.deleted,class:"tok-deleted"},{tag:Ve.literal,class:"tok-literal"},{tag:Ve.string,class:"tok-string"},{tag:Ve.number,class:"tok-number"},{tag:[Ve.regexp,Ve.escape,Ve.special(Ve.string)],class:"tok-string2"},{tag:Ve.variableName,class:"tok-variableName"},{tag:Ve.local(Ve.variableName),class:"tok-variableName tok-local"},{tag:Ve.definition(Ve.variableName),class:"tok-variableName tok-definition"},{tag:Ve.special(Ve.variableName),class:"tok-variableName2"},{tag:Ve.definition(Ve.propertyName),class:"tok-propertyName tok-definition"},{tag:Ve.typeName,class:"tok-typeName"},{tag:Ve.namespace,class:"tok-namespace"},{tag:Ve.className,class:"tok-className"},{tag:Ve.macroName,class:"tok-macroName"},{tag:Ve.propertyName,class:"tok-propertyName"},{tag:Ve.operator,class:"tok-operator"},{tag:Ve.comment,class:"tok-comment"},{tag:Ve.meta,class:"tok-meta"},{tag:Ve.invalid,class:"tok-invalid"},{tag:Ve.punctuation,class:"tok-punctuation"}]);kn.Tag=Xr;kn.classHighlighter=T3;kn.getStyleTags=Tx;kn.highlightCode=C3;kn.highlightTree=Cx;kn.styleTags=E3;kn.tagHighlighter=Sx;kn.tags=Ve});var Gc=O(xe=>{"use strict";var je=Bc(),et=gi(),qe=xi(),Ue=kx(),Ax=Bd(),ig,Ti=new je.NodeProp;function yg(t){return et.Facet.define({combine:t?e=>e.concat(t):void 0})}var Nx=new je.NodeProp,tr=class{constructor(e,r,n=[],a=""){this.data=e,this.name=a,et.EditorState.prototype.hasOwnProperty("tree")||Object.defineProperty(et.EditorState.prototype,"tree",{get(){return Pr(this)}}),this.parser=r,this.extension=[Zn.of(this),et.EditorState.languageData.of((s,o,l)=>{let u=Mx(s,o,l),c=u.type.prop(Ti);if(!c)return[];let f=s.facet(c),h=u.type.prop(Nx);if(h){let d=u.resolve(o-u.from,l);for(let p of h)if(p.test(d,s)){let g=s.facet(p.facet);return p.type=="replace"?g:g.concat(f)}}return f})].concat(n)}isActiveAt(e,r,n=-1){return Mx(e,r,n).type.prop(Ti)==this.data}findRegions(e){let r=e.facet(Zn);if(r?.data==this.data)return[{from:0,to:e.doc.length}];if(!r||!r.allowsNesting)return[];let n=[],a=(s,o)=>{if(s.prop(Ti)==this.data){n.push({from:o,to:o+s.length});return}let l=s.prop(je.NodeProp.mounted);if(l){if(l.tree.prop(Ti)==this.data){if(l.overlay)for(let u of l.overlay)n.push({from:u.from+o,to:u.to+o});else n.push({from:o,to:o+s.length});return}else if(l.overlay){let u=n.length;if(a(l.tree,l.overlay[0].from+o),n.length>u)return}}for(let u=0;u<s.children.length;u++){let c=s.children[u];c instanceof je.Tree&&a(c,s.positions[u]+o)}};return a(Pr(e),0),n}get allowsNesting(){return!0}};tr.setState=et.StateEffect.define();function Mx(t,e,r){let n=t.facet(Zn),a=Pr(t).topNode;if(!n||n.allowsNesting)for(let s=a;s;s=s.enter(e,r,je.IterMode.ExcludeBuffers))s.type.isTop&&(a=s);return a}var og=class t extends tr{constructor(e,r,n){super(e,r,[],n),this.parser=r}static define(e){let r=yg(e.languageData);return new t(r,e.parser.configure({props:[Ti.add(n=>n.isTop?r:void 0)]}),e.name)}configure(e,r){return new t(this.data,this.parser.configure(e),r||this.name)}get allowsNesting(){return this.parser.hasWrappers()}};function Pr(t){let e=t.field(tr.state,!1);return e?e.tree:je.Tree.empty}function Fx(t,e,r=50){var n;let a=(n=t.field(tr.state,!1))===null||n===void 0?void 0:n.context;if(!a)return null;let s=a.viewport;a.updateViewport({from:0,to:e});let o=a.isDone(e)||a.work(r,e)?a.tree:null;return a.updateViewport(s),o}function k3(t,e=t.doc.length){var r;return((r=t.field(tr.state,!1))===null||r===void 0?void 0:r.context.isDone(e))||!1}function A3(t,e=t.viewport.to,r=100){let n=Fx(t.state,e,r);return n!=Pr(t.state)&&t.dispatch({}),!!n}function M3(t){var e;return((e=t.plugin(Vx))===null||e===void 0?void 0:e.isWorking())||!1}var zc=class{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,r){let n=this.cursorPos-this.string.length;return e<n||r>=this.cursorPos?this.doc.sliceString(e,r):this.string.slice(e-n,r-n)}},$o=null,gs=class t{constructor(e,r,n=[],a,s,o,l,u){this.parser=e,this.state=r,this.fragments=n,this.tree=a,this.treeLen=s,this.viewport=o,this.skipped=l,this.scheduleOn=u,this.parse=null,this.tempSkipped=[]}static create(e,r,n){return new t(e,r,[],je.Tree.empty,0,n,[],null)}startParse(){return this.parser.startParse(new zc(this.state.doc),this.fragments)}work(e,r){return r!=null&&r>=this.state.doc.length&&(r=void 0),this.tree!=je.Tree.empty&&this.isDone(r??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let a=Date.now()+e;e=()=>Date.now()>a}for(this.parse||(this.parse=this.startParse()),r!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>r)&&r<this.state.doc.length&&this.parse.stopAt(r);;){let a=this.parse.advance();if(a)if(this.fragments=this.withoutTempSkipped(je.TreeFragment.addTree(a,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=a,this.parse=null,this.treeLen<(r??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,r;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(r=this.parse.advance()););}),this.treeLen=e,this.tree=r,this.fragments=this.withoutTempSkipped(je.TreeFragment.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let r=$o;$o=this;try{return e()}finally{$o=r}}withoutTempSkipped(e){for(let r;r=this.tempSkipped.pop();)e=Px(e,r.from,r.to);return e}changes(e,r){let{fragments:n,tree:a,treeLen:s,viewport:o,skipped:l}=this;if(this.takeTree(),!e.empty){let u=[];if(e.iterChangedRanges((c,f,h,d)=>u.push({fromA:c,toA:f,fromB:h,toB:d})),n=je.TreeFragment.applyChanges(n,u),a=je.Tree.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){l=[];for(let c of this.skipped){let f=e.mapPos(c.from,1),h=e.mapPos(c.to,-1);f<h&&l.push({from:f,to:h})}}}return new t(this.parser,r,n,a,s,o,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let r=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:a,to:s}=this.skipped[n];a<e.to&&s>e.from&&(this.fragments=Px(this.fragments,a,s),this.skipped.splice(n--,1))}return this.skipped.length>=r?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,r){this.skipped.push({from:e,to:r})}static getSkippingParser(e){return new class extends je.Parser{createParse(r,n,a){let s=a[0].from,o=a[a.length-1].to;return{parsedPos:s,advance(){let u=$o;if(u){for(let c of a)u.tempSkipped.push(c);e&&(u.scheduleOn=u.scheduleOn?Promise.all([u.scheduleOn,e]):e)}return this.parsedPos=o,new je.Tree(je.NodeType.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let r=this.fragments;return this.treeLen>=e&&r.length&&r[0].from==0&&r[0].to>=e}static get(){return $o}};function Px(t,e,r){return je.TreeFragment.applyChanges(t,[{fromA:e,toA:r,fromB:e,toB:r}])}var el=class t{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let r=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),r.viewport.to);return r.work(20,n)||r.takeTree(),new t(r)}static init(e){let r=Math.min(3e3,e.doc.length),n=gs.create(e.facet(Zn).parser,e,{from:0,to:r});return n.work(20,r)||n.takeTree(),new t(n)}};tr.state=et.StateField.define({create:el.init,update(t,e){for(let r of e.effects)if(r.is(tr.setState))return r.value;return e.startState.facet(Zn)!=e.state.facet(Zn)?el.init(e.state):t.apply(e)}});var qx=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(qx=t=>{let e=-1,r=setTimeout(()=>{e=requestIdleCallback(t,{timeout:400})},100);return()=>e<0?clearTimeout(r):cancelIdleCallback(e)});var ag=typeof navigator<"u"&&(!((ig=navigator.scheduling)===null||ig===void 0)&&ig.isInputPending)?()=>navigator.scheduling.isInputPending():null,Vx=qe.ViewPlugin.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let r=this.view.state.field(tr.state).context;(r.updateViewport(e.view.viewport)||this.view.viewport.to>r.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(r)}scheduleWork(){if(this.working)return;let{state:e}=this.view,r=e.field(tr.state);(r.tree!=r.context.tree||!r.context.isDone(e.doc.length))&&(this.working=qx(this.work))}work(e){this.working=null;let r=Date.now();if(this.chunkEnd<r&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=r+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:a}}=this.view,s=n.field(tr.state);if(s.tree==s.context.tree&&s.context.isDone(a+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!ag?Math.max(25,e.timeRemaining()-5):1e9),l=s.context.treeLen<a&&n.doc.length>a+1e3,u=s.context.work(()=>ag&&ag()||Date.now()>o,a+(l?0:1e5));this.chunkBudget-=Date.now()-r,(u||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:tr.setState.of(new el(s.context))})),this.chunkBudget>0&&!(u&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(r=>qe.logException(this.view.state,r)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Zn=et.Facet.define({combine(t){return t.length?t[0]:null},enables:t=>[tr.state,Vx,qe.EditorView.contentAttributes.compute([t],e=>{let r=e.facet(t);return r&&r.name?{"data-language":r.name}:{}})]}),lg=class{constructor(e,r=[]){this.language=e,this.support=r,this.extension=[e,r]}},ug=class t{constructor(e,r,n,a,s,o=void 0){this.name=e,this.alias=r,this.extensions=n,this.filename=a,this.loadFunc=s,this.support=o,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:r,support:n}=e;if(!r){if(!n)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");r=()=>Promise.resolve(n)}return new t(e.name,(e.alias||[]).concat(e.name).map(a=>a.toLowerCase()),e.extensions||[],e.filename,r,n)}static matchFilename(e,r){for(let a of e)if(a.filename&&a.filename.test(r))return a;let n=/\.([^.]+)$/.exec(r);if(n){for(let a of e)if(a.extensions.indexOf(n[1])>-1)return a}return null}static matchLanguageName(e,r,n=!0){r=r.toLowerCase();for(let a of e)if(a.alias.some(s=>s==r))return a;if(n)for(let a of e)for(let s of a.alias){let o=r.indexOf(s);if(o>-1&&(s.length>2||!/\w/.test(r[o-1])&&!/\w/.test(r[o+s.length])))return a}return null}},zx=et.Facet.define(),bg=et.Facet.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(r=>r!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function tl(t){let e=t.facet(bg);return e.charCodeAt(0)==9?t.tabSize*e.length:e.length}function wg(t,e){let r="",n=t.tabSize,a=t.facet(bg)[0];if(a=="	"){for(;e>=n;)r+="	",e-=n;a=" "}for(let s=0;s<e;s++)r+=a;return r}function _g(t,e){t instanceof et.EditorState&&(t=new vs(t));for(let n of t.state.facet(zx)){let a=n(t,e);if(a!==void 0)return a}let r=Pr(t.state);return r.length>=e?R3(t,r,e):null}function P3(t,e,r){let n=Object.create(null),a=new vs(t,{overrideIndentation:o=>{var l;return(l=n[o])!==null&&l!==void 0?l:-1}}),s=[];for(let o=e;o<=r;){let l=t.doc.lineAt(o);o=l.to+1;let u=_g(a,l.from);if(u==null)continue;/\S/.test(l.text)||(u=0);let c=/^\s*/.exec(l.text)[0],f=wg(t,u);c!=f&&(n[l.from]=u,s.push({from:l.from,to:l.from+c.length,insert:f}))}return t.changes(s)}var vs=class{constructor(e,r={}){this.state=e,this.options=r,this.unit=tl(e)}lineAt(e,r=1){let n=this.state.doc.lineAt(e),{simulateBreak:a,simulateDoubleBreak:s}=this.options;return a!=null&&a>=n.from&&a<=n.to?s&&a==e?{text:"",from:e}:(r<0?a<e:a<=e)?{text:n.text.slice(a-n.from),from:a}:{text:n.text.slice(0,a-n.from),from:n.from}:n}textAfterPos(e,r=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:a}=this.lineAt(e,r);return n.slice(e-a,Math.min(n.length,e+100-a))}column(e,r=1){let{text:n,from:a}=this.lineAt(e,r),s=this.countColumn(n,e-a),o=this.options.overrideIndentation?this.options.overrideIndentation(a):-1;return o>-1&&(s+=o-this.countColumn(n,n.search(/\S|$/))),s}countColumn(e,r=e.length){return et.countColumn(e,this.state.tabSize,r)}lineIndent(e,r=1){let{text:n,from:a}=this.lineAt(e,r),s=this.options.overrideIndentation;if(s){let o=s(a);if(o>-1)return o}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}},xg=new je.NodeProp;function R3(t,e,r){let n=e.resolveStack(r),a=e.resolveInner(r,-1).resolve(r,0).enterUnfinishedNodesBefore(r);if(a!=n.node){let s=[];for(let o=a;o&&!(o.from==n.node.from&&o.type==n.node.type);o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)n={node:s[o],next:n}}return Hx(n,t,r)}function Hx(t,e,r){for(let n=t;n;n=n.next){let a=O3(n.node);if(a)return a(Hc.create(e,r,n))}return 0}function D3(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}function O3(t){let e=t.type.prop(xg);if(e)return e;let r=t.firstChild,n;if(r&&(n=r.type.prop(je.NodeProp.closedBy))){let a=t.lastChild,s=a&&n.indexOf(a.name)>-1;return o=>Ux(o,!0,1,void 0,s&&!D3(o)?a.from:void 0)}return t.parent==null?I3:null}function I3(){return 0}var Hc=class t extends vs{constructor(e,r,n){super(e.state,e.options),this.base=e,this.pos=r,this.context=n}get node(){return this.context.node}static create(e,r,n){return new t(e,r,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let r=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(r.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(B3(n,e))break;r=this.state.doc.lineAt(n.from)}return this.lineIndent(r.from)}continue(){return Hx(this.context.next,this.base,this.pos)}};function B3(t,e){for(let r=e;r;r=r.parent)if(t==r)return!0;return!1}function L3(t){let e=t.node,r=e.childAfter(e.from),n=e.lastChild;if(!r)return null;let a=t.options.simulateBreak,s=t.state.doc.lineAt(r.from),o=a==null||a<=s.from?s.to:Math.min(s.to,a);for(let l=r.to;;){let u=e.childAfter(l);if(!u||u==n)return null;if(!u.type.isSkipped){if(u.from>=o)return null;let c=/^ */.exec(s.text.slice(r.to-s.from))[0].length;return{from:r.from,to:r.to+c}}l=u.to}}function N3({closing:t,align:e=!0,units:r=1}){return n=>Ux(n,e,r,t)}function Ux(t,e,r,n,a){let s=t.textAfter,o=s.match(/^\s*/)[0].length,l=n&&s.slice(o,o+n.length)==n||a==t.pos+o,u=e?L3(t):null;return u?l?t.column(u.from):t.column(u.to):t.baseIndent+(l?0:t.unit*r)}var F3=t=>t.baseIndent;function q3({except:t,units:e=1}={}){return r=>{let n=t&&t.test(r.textAfter);return r.baseIndent+(n?0:e*r.unit)}}var V3=200;function z3(){return et.EditorState.transactionFilter.of(t=>{if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;let e=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head);if(!e.length)return t;let r=t.newDoc,{head:n}=t.newSelection.main,a=r.lineAt(n);if(n>a.from+V3)return t;let s=r.sliceString(a.from,n);if(!e.some(c=>c.test(s)))return t;let{state:o}=t,l=-1,u=[];for(let{head:c}of o.selection.ranges){let f=o.doc.lineAt(c);if(f.from==l)continue;l=f.from;let h=_g(o,f.from);if(h==null)continue;let d=/^\s*/.exec(f.text)[0],p=wg(o,h);d!=p&&u.push({from:f.from,to:f.from+d.length,insert:p})}return u.length?[t,{changes:u,sequential:!0}]:t})}var Wx=et.Facet.define(),Gx=new je.NodeProp;function H3(t){let e=t.firstChild,r=t.lastChild;return e&&e.to<r.from?{from:e.to,to:r.type.isError?t.to:r.from}:null}function U3(t,e,r){let n=Pr(t);if(n.length<r)return null;let a=n.resolveStack(r,1),s=null;for(let o=a;o;o=o.next){let l=o.node;if(l.to<=r||l.from>r)continue;if(s&&l.from<e)break;let u=l.type.prop(Gx);if(u&&(l.to<n.length-50||n.length==t.doc.length||!W3(l))){let c=u(l,t);c&&c.from<=r&&c.from>=e&&c.to>r&&(s=c)}}return s}function W3(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function ms(t,e,r){for(let n of t.facet(Wx)){let a=n(t,e,r);if(a)return a}return U3(t,e,r)}function Kx(t,e){let r=e.mapPos(t.from,1),n=e.mapPos(t.to,-1);return r>=n?void 0:{from:r,to:n}}var ys=et.StateEffect.define({map:Kx}),ga=et.StateEffect.define({map:Kx});function Eg(t){let e=[];for(let{head:r}of t.state.selection.ranges)e.some(n=>n.from<=r&&n.to>=r)||e.push(t.lineBlockAt(r));return e}var Xn=et.StateField.define({create(){return qe.Decoration.none},update(t,e){t=t.map(e.changes);for(let r of e.effects)if(r.is(ys)&&!K3(t,r.value.from,r.value.to)){let{preparePlaceholder:n}=e.state.facet(Cg),a=n?qe.Decoration.replace({widget:new cg(n(e.state,r.value))}):Rx;t=t.update({add:[a.range(r.value.from,r.value.to)]})}else r.is(ga)&&(t=t.update({filter:(n,a)=>r.value.from!=n||r.value.to!=a,filterFrom:r.value.from,filterTo:r.value.to}));if(e.selection){let r=!1,{head:n}=e.selection.main;t.between(n,n,(a,s)=>{a<n&&s>n&&(r=!0)}),r&&(t=t.update({filterFrom:n,filterTo:n,filter:(a,s)=>s<=n||a>=n}))}return t},provide:t=>qe.EditorView.decorations.from(t),toJSON(t,e){let r=[];return t.between(0,e.doc.length,(n,a)=>{r.push(n,a)}),r},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let r=0;r<t.length;){let n=t[r++],a=t[r++];if(typeof n!="number"||typeof a!="number")throw new RangeError("Invalid JSON for fold state");e.push(Rx.range(n,a))}return qe.Decoration.set(e,!0)}});function G3(t){return t.field(Xn,!1)||et.RangeSet.empty}function rl(t,e,r){var n;let a=null;return(n=t.field(Xn,!1))===null||n===void 0||n.between(e,r,(s,o)=>{(!a||a.from>s)&&(a={from:s,to:o})}),a}function K3(t,e,r){let n=!1;return t.between(e,e,(a,s)=>{a==e&&s==r&&(n=!0)}),n}function Sg(t,e){return t.field(Xn,!1)?e:e.concat(et.StateEffect.appendConfig.of(Tg()))}var jx=t=>{for(let e of Eg(t)){let r=ms(t.state,e.from,e.to);if(r)return t.dispatch({effects:Sg(t.state,[ys.of(r),Uc(t,r)])}),!0}return!1},Yx=t=>{if(!t.state.field(Xn,!1))return!1;let e=[];for(let r of Eg(t)){let n=rl(t.state,r.from,r.to);n&&e.push(ga.of(n),Uc(t,n,!1))}return e.length&&t.dispatch({effects:e}),e.length>0};function Uc(t,e,r=!0){let n=t.state.doc.lineAt(e.from).number,a=t.state.doc.lineAt(e.to).number;return qe.EditorView.announce.of(`${t.state.phrase(r?"Folded lines":"Unfolded lines")} ${n} ${t.state.phrase("to")} ${a}.`)}var Zx=t=>{let{state:e}=t,r=[];for(let n=0;n<e.doc.length;){let a=t.lineBlockAt(n),s=ms(e,a.from,a.to);s&&r.push(ys.of(s)),n=(s?t.lineBlockAt(s.to):a).to+1}return r.length&&t.dispatch({effects:Sg(t.state,r)}),!!r.length},Xx=t=>{let e=t.state.field(Xn,!1);if(!e||!e.size)return!1;let r=[];return e.between(0,t.state.doc.length,(n,a)=>{r.push(ga.of({from:n,to:a}))}),t.dispatch({effects:r}),!0};function j3(t,e){for(let r=e;;){let n=ms(t.state,r.from,r.to);if(n&&n.to>e.from)return n;if(!r.from)return null;r=t.lineBlockAt(r.from-1)}}var Y3=t=>{let e=[];for(let r of Eg(t)){let n=rl(t.state,r.from,r.to);if(n)e.push(ga.of(n),Uc(t,n,!1));else{let a=j3(t,r);a&&e.push(ys.of(a),Uc(t,a))}}return e.length>0&&t.dispatch({effects:Sg(t.state,e)}),!!e.length},Z3=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:jx},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Yx},{key:"Ctrl-Alt-[",run:Zx},{key:"Ctrl-Alt-]",run:Xx}],X3={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},Cg=et.Facet.define({combine(t){return et.combineConfig(t,X3)}});function Tg(t){let e=[Xn,J3];return t&&e.push(Cg.of(t)),e}function $x(t,e){let{state:r}=t,n=r.facet(Cg),a=o=>{let l=t.lineBlockAt(t.posAtDOM(o.target)),u=rl(t.state,l.from,l.to);u&&t.dispatch({effects:ga.of(u)}),o.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(t,a,e);let s=document.createElement("span");return s.textContent=n.placeholderText,s.setAttribute("aria-label",r.phrase("folded code")),s.title=r.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=a,s}var Rx=qe.Decoration.replace({widget:new class extends qe.WidgetType{toDOM(t){return $x(t,null)}}}),cg=class extends qe.WidgetType{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return $x(e,this.value)}},$3={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1},Jo=class extends qe.GutterMarker{constructor(e,r){super(),this.config=e,this.open=r}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let r=document.createElement("span");return r.textContent=this.open?this.config.openText:this.config.closedText,r.title=e.state.phrase(this.open?"Fold line":"Unfold line"),r}};function Q3(t={}){let e=Object.assign(Object.assign({},$3),t),r=new Jo(e,!0),n=new Jo(e,!1),a=qe.ViewPlugin.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(Zn)!=o.state.facet(Zn)||o.startState.field(Xn,!1)!=o.state.field(Xn,!1)||Pr(o.startState)!=Pr(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let l=new et.RangeSetBuilder;for(let u of o.viewportLineBlocks){let c=rl(o.state,u.from,u.to)?n:ms(o.state,u.from,u.to)?r:null;c&&l.add(u.from,u.from,c)}return l.finish()}}),{domEventHandlers:s}=e;return[a,qe.gutter({class:"cm-foldGutter",markers(o){var l;return((l=o.plugin(a))===null||l===void 0?void 0:l.markers)||et.RangeSet.empty},initialSpacer(){return new Jo(e,!1)},domEventHandlers:Object.assign(Object.assign({},s),{click:(o,l,u)=>{if(s.click&&s.click(o,l,u))return!0;let c=rl(o.state,l.from,l.to);if(c)return o.dispatch({effects:ga.of(c)}),!0;let f=ms(o.state,l.from,l.to);return f?(o.dispatch({effects:ys.of(f)}),!0):!1}})}),Tg()]}var J3=qe.EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}}),nl=class t{constructor(e,r){this.specs=e;let n;function a(l){let u=Ax.StyleModule.newName();return(n||(n=Object.create(null)))["."+u]=l,u}let s=typeof r.all=="string"?r.all:r.all?a(r.all):void 0,o=r.scope;this.scope=o instanceof tr?l=>l.prop(Ti)==o.data:o?l=>l==o:void 0,this.style=Ue.tagHighlighter(e.map(l=>({tag:l.tag,class:l.class||a(Object.assign({},l,{tag:null}))})),{all:s}).style,this.module=n?new Ax.StyleModule(n):null,this.themeType=r.themeType}static define(e,r){return new t(e,r||{})}},fg=et.Facet.define(),Qx=et.Facet.define({combine(t){return t.length?[t[0]]:null}});function Vc(t){let e=t.facet(fg);return e.length?e:t.facet(Qx)}function e5(t,e){let r=[r5],n;return t instanceof nl&&(t.module&&r.push(qe.EditorView.styleModule.of(t.module)),n=t.themeType),e?.fallback?r.push(Qx.of(t)):n?r.push(fg.computeN([qe.EditorView.darkTheme],a=>a.facet(qe.EditorView.darkTheme)==(n=="dark")?[t]:[])):r.push(fg.of(t)),r}function t5(t,e,r){let n=Vc(t),a=null;if(n){for(let s of n)if(!s.scope||r&&s.scope(r)){let o=s.style(e);o&&(a=a?a+" "+o:o)}}return a}var hg=class{constructor(e){this.markCache=Object.create(null),this.tree=Pr(e.state),this.decorations=this.buildDeco(e,Vc(e.state)),this.decoratedTo=e.viewport.to}update(e){let r=Pr(e.state),n=Vc(e.state),a=n!=Vc(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);r.length<s.to&&!a&&r.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(r!=this.tree||e.viewportChanged||a)&&(this.tree=r,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=s.to)}buildDeco(e,r){if(!r||!this.tree.length)return qe.Decoration.none;let n=new et.RangeSetBuilder;for(let{from:a,to:s}of e.visibleRanges)Ue.highlightTree(this.tree,r,(o,l,u)=>{n.add(o,l,this.markCache[u]||(this.markCache[u]=qe.Decoration.mark({class:u})))},a,s);return n.finish()}},r5=et.Prec.high(qe.ViewPlugin.fromClass(hg,{decorations:t=>t.decorations})),n5=nl.define([{tag:Ue.tags.meta,color:"#404740"},{tag:Ue.tags.link,textDecoration:"underline"},{tag:Ue.tags.heading,textDecoration:"underline",fontWeight:"bold"},{tag:Ue.tags.emphasis,fontStyle:"italic"},{tag:Ue.tags.strong,fontWeight:"bold"},{tag:Ue.tags.strikethrough,textDecoration:"line-through"},{tag:Ue.tags.keyword,color:"#708"},{tag:[Ue.tags.atom,Ue.tags.bool,Ue.tags.url,Ue.tags.contentSeparator,Ue.tags.labelName],color:"#219"},{tag:[Ue.tags.literal,Ue.tags.inserted],color:"#164"},{tag:[Ue.tags.string,Ue.tags.deleted],color:"#a11"},{tag:[Ue.tags.regexp,Ue.tags.escape,Ue.tags.special(Ue.tags.string)],color:"#e40"},{tag:Ue.tags.definition(Ue.tags.variableName),color:"#00f"},{tag:Ue.tags.local(Ue.tags.variableName),color:"#30a"},{tag:[Ue.tags.typeName,Ue.tags.namespace],color:"#085"},{tag:Ue.tags.className,color:"#167"},{tag:[Ue.tags.special(Ue.tags.variableName),Ue.tags.macroName],color:"#256"},{tag:Ue.tags.definition(Ue.tags.propertyName),color:"#00c"},{tag:Ue.tags.comment,color:"#940"},{tag:Ue.tags.invalid,color:"#f00"}]),i5=qe.EditorView.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Jx=1e4,e1="()[]{}",t1=et.Facet.define({combine(t){return et.combineConfig(t,{afterCursor:!0,brackets:e1,maxScanDistance:Jx,renderMatch:o5})}}),a5=qe.Decoration.mark({class:"cm-matchingBracket"}),s5=qe.Decoration.mark({class:"cm-nonmatchingBracket"});function o5(t){let e=[],r=t.matched?a5:s5;return e.push(r.range(t.start.from,t.start.to)),t.end&&e.push(r.range(t.end.from,t.end.to)),e}var l5=et.StateField.define({create(){return qe.Decoration.none},update(t,e){if(!e.docChanged&&!e.selection)return t;let r=[],n=e.state.facet(t1);for(let a of e.state.selection.ranges){if(!a.empty)continue;let s=Qo(e.state,a.head,-1,n)||a.head>0&&Qo(e.state,a.head-1,1,n)||n.afterCursor&&(Qo(e.state,a.head,1,n)||a.head<e.state.doc.length&&Qo(e.state,a.head+1,-1,n));s&&(r=r.concat(n.renderMatch(s,e.state)))}return qe.Decoration.set(r,!0)},provide:t=>qe.EditorView.decorations.from(t)}),u5=[l5,i5];function c5(t={}){return[t1.of(t),u5]}var r1=new je.NodeProp;function dg(t,e,r){let n=t.prop(e<0?je.NodeProp.openedBy:je.NodeProp.closedBy);if(n)return n;if(t.name.length==1){let a=r.indexOf(t.name);if(a>-1&&a%2==(e<0?1:0))return[r[a+e]]}return null}function pg(t){let e=t.type.prop(r1);return e?e(t.node):t}function Qo(t,e,r,n={}){let a=n.maxScanDistance||Jx,s=n.brackets||e1,o=Pr(t),l=o.resolveInner(e,r);for(let u=l;u;u=u.parent){let c=dg(u.type,r,s);if(c&&u.from<u.to){let f=pg(u);if(f&&(r>0?e>=f.from&&e<f.to:e>f.from&&e<=f.to))return f5(t,e,r,u,f,c,s)}}return h5(t,e,r,o,l.type,a,s)}function f5(t,e,r,n,a,s,o){let l=n.parent,u={from:a.from,to:a.to},c=0,f=l?.cursor();if(f&&(r<0?f.childBefore(n.from):f.childAfter(n.to)))do if(r<0?f.to<=n.from:f.from>=n.to){if(c==0&&s.indexOf(f.type.name)>-1&&f.from<f.to){let h=pg(f);return{start:u,end:h?{from:h.from,to:h.to}:void 0,matched:!0}}else if(dg(f.type,r,o))c++;else if(dg(f.type,-r,o)){if(c==0){let h=pg(f);return{start:u,end:h&&h.from<h.to?{from:h.from,to:h.to}:void 0,matched:!1}}c--}}while(r<0?f.prevSibling():f.nextSibling());return{start:u,matched:!1}}function h5(t,e,r,n,a,s,o){let l=r<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),u=o.indexOf(l);if(u<0||u%2==0!=r>0)return null;let c={from:r<0?e-1:e,to:r>0?e+1:e},f=t.doc.iterRange(e,r>0?t.doc.length:0),h=0;for(let d=0;!f.next().done&&d<=s;){let p=f.value;r<0&&(d+=p.length);let g=e+d*r;for(let m=r>0?0:p.length-1,v=r>0?p.length:-1;m!=v;m+=r){let y=o.indexOf(p[m]);if(!(y<0||n.resolveInner(g+m,1).type!=a))if(y%2==0==r>0)h++;else{if(h==1)return{start:c,end:{from:g+m,to:g+m+1},matched:y>>1==u>>1};h--}}r>0&&(d+=p.length)}return f.done?{start:c,matched:!1}:null}function Dx(t,e,r,n=0,a=0){e==null&&(e=t.search(/[^\s\u00a0]/),e==-1&&(e=t.length));let s=a;for(let o=n;o<e;o++)t.charCodeAt(o)==9?s+=r-s%r:s++;return s}var il=class{constructor(e,r,n,a){this.string=e,this.tabSize=r,this.indentUnit=n,this.overrideIndent=a,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let r=this.string.charAt(this.pos),n;if(typeof e=="string"?n=r==e:n=r&&(e instanceof RegExp?e.test(r):e(r)),n)return++this.pos,r}eatWhile(e){let r=this.pos;for(;this.eat(e););return this.pos>r}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let r=this.string.indexOf(e,this.pos);if(r>-1)return this.pos=r,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Dx(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:Dx(this.string,null,this.tabSize)}match(e,r,n){if(typeof e=="string"){let a=o=>n?o.toLowerCase():o,s=this.string.substr(this.pos,e.length);return a(s)==a(e)?(r!==!1&&(this.pos+=e.length),!0):null}else{let a=this.string.slice(this.pos).match(e);return a&&a.index>0?null:(a&&r!==!1&&(this.pos+=a[0].length),a)}}current(){return this.string.slice(this.start,this.pos)}};function d5(t){return{name:t.name||"",token:t.token,blankLine:t.blankLine||(()=>{}),startState:t.startState||(()=>!0),copyState:t.copyState||p5,indent:t.indent||(()=>null),languageData:t.languageData||{},tokenTable:t.tokenTable||Ag,mergeTokens:t.mergeTokens!==!1}}function p5(t){if(typeof t!="object")return t;let e={};for(let r in t){let n=t[r];e[r]=n instanceof Array?n.slice():n}return e}var Ox=new WeakMap,gg=class t extends tr{constructor(e){let r=yg(e.languageData),n=d5(e),a,s=new class extends je.Parser{createParse(o,l,u){return new vg(a,o,l,u)}};super(r,s,[],e.name),this.topNode=y5(r,this),a=this,this.streamParser=n,this.stateAfter=new je.NodeProp({perNode:!0}),this.tokenTable=e.tokenTable?new Wc(n.tokenTable):m5}static define(e){return new t(e)}getIndent(e){let r,{overrideIndentation:n}=e.options;n&&(r=Ox.get(e.state),r!=null&&r<e.pos-1e4&&(r=void 0));let a=kg(this,e.node.tree,e.node.from,e.node.from,r??e.pos),s,o;if(a?(o=a.state,s=a.pos+1):(o=this.streamParser.startState(e.unit),s=e.node.from),e.pos-s>1e4)return null;for(;s<e.pos;){let u=e.state.doc.lineAt(s),c=Math.min(e.pos,u.to);if(u.length){let f=n?n(u.from):-1,h=new il(u.text,e.state.tabSize,e.unit,f<0?void 0:f);for(;h.pos<c-u.from;)i1(this.streamParser.token,h,o)}else this.streamParser.blankLine(o,e.unit);if(c==e.pos)break;s=u.to+1}let l=e.lineAt(e.pos);return n&&r==null&&Ox.set(e.state,l.from),this.streamParser.indent(o,/^\s*(.*)/.exec(l.text)[1],e)}get allowsNesting(){return!1}};function kg(t,e,r,n,a){let s=r>=n&&r+e.length<=a&&e.prop(t.stateAfter);if(s)return{state:t.streamParser.copyState(s),pos:r+e.length};for(let o=e.children.length-1;o>=0;o--){let l=e.children[o],u=r+e.positions[o],c=l instanceof je.Tree&&u<a&&kg(t,l,u,n,a);if(c)return c}return null}function n1(t,e,r,n,a){if(a&&r<=0&&n>=e.length)return e;!a&&r==0&&e.type==t.topNode&&(a=!0);for(let s=e.children.length-1;s>=0;s--){let o=e.positions[s],l=e.children[s],u;if(o<n&&l instanceof je.Tree){if(!(u=n1(t,l,r-o,n-o,a)))break;return a?new je.Tree(e.type,e.children.slice(0,s).concat(u),e.positions.slice(0,s+1),o+u.length):u}}return null}function g5(t,e,r,n,a){for(let s of e){let o=s.from+(s.openStart?25:0),l=s.to-(s.openEnd?25:0),u=o<=r&&l>r&&kg(t,s.tree,0-s.offset,r,l),c;if(u&&u.pos<=n&&(c=n1(t,s.tree,r+s.offset,u.pos+s.offset,!1)))return{state:u.state,tree:c}}return{state:t.streamParser.startState(a?tl(a):4),tree:je.Tree.empty}}var vg=class{constructor(e,r,n,a){this.lang=e,this.input=r,this.fragments=n,this.ranges=a,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=a[a.length-1].to;let s=gs.get(),o=a[0].from,{state:l,tree:u}=g5(e,n,o,this.to,s?.state);this.state=l,this.parsedPos=this.chunkStart=o+u.length;for(let c=0;c<u.children.length;c++)this.chunks.push(u.children[c]),this.chunkPos.push(u.positions[c]);s&&this.parsedPos<s.viewport.from-1e5&&a.some(c=>c.from<=s.viewport.from&&c.to>=s.viewport.from)&&(this.state=this.lang.streamParser.startState(tl(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=gs.get(),r=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),n=Math.min(r,this.chunkStart+2048);for(e&&(n=Math.min(n,e.viewport.to));this.parsedPos<n;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=r?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,r),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let r=this.input.chunk(e);if(this.input.lineChunks)r==`
`&&(r="");else{let n=r.indexOf(`
`);n>-1&&(r=r.slice(0,n))}return e+r.length<=this.to?r:r.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,r=this.lineAfter(e),n=e+r.length;for(let a=this.rangeIndex;;){let s=this.ranges[a].to;if(s>=n||(r=r.slice(0,s-(n-r.length)),a++,a==this.ranges.length))break;let o=this.ranges[a].from,l=this.lineAfter(o);r+=l,n=o+l.length}return{line:r,end:n}}skipGapsTo(e,r,n){for(;;){let a=this.ranges[this.rangeIndex].to,s=e+r;if(n>0?a>s:a>=s)break;let o=this.ranges[++this.rangeIndex].from;r+=o-a}return r}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,r,n,a){let s=4;if(this.ranges.length>1){a=this.skipGapsTo(r,a,1),r+=a;let l=this.chunk.length;a=this.skipGapsTo(n,a,-1),n+=a,s+=this.chunk.length-l}let o=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&s==4&&o>=0&&this.chunk[o]==e&&this.chunk[o+2]==r?this.chunk[o+2]=n:this.chunk.push(e,r,n,s),a}parseLine(e){let{line:r,end:n}=this.nextLine(),a=0,{streamParser:s}=this.lang,o=new il(r,e?e.state.tabSize:4,e?tl(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let l=i1(s.token,o,this.state);if(l&&(a=this.emitToken(this.lang.tokenTable.resolve(l),this.parsedPos+o.start,this.parsedPos+o.pos,a)),o.start>1e4)break}this.parsedPos=n,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=je.Tree.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:v5,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new je.Tree(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new je.Tree(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}};function i1(t,e,r){e.start=e.pos;for(let n=0;n<10;n++){let a=t(e,r);if(e.pos>e.start)return a}throw new Error("Stream parser failed to advance stream.")}var Ag=Object.create(null),al=[je.NodeType.none],v5=new je.NodeSet(al),Ix=[],Bx=Object.create(null),a1=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])a1[t]=s1(Ag,e);var Wc=class{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),a1)}resolve(e){return e?this.table[e]||(this.table[e]=s1(this.extra,e)):0}},m5=new Wc(Ag);function sg(t,e){Ix.indexOf(t)>-1||(Ix.push(t),console.warn(e))}function s1(t,e){let r=[];for(let l of e.split(" ")){let u=[];for(let c of l.split(".")){let f=t[c]||Ue.tags[c];f?typeof f=="function"?u.length?u=u.map(f):sg(c,`Modifier ${c} used at start of tag`):u.length?sg(c,`Tag ${c} used as modifier`):u=Array.isArray(f)?f:[f]:sg(c,`Unknown highlighting tag ${c}`)}for(let c of u)r.push(c)}if(!r.length)return 0;let n=e.replace(/ /g,"_"),a=n+" "+r.map(l=>l.id),s=Bx[a];if(s)return s.id;let o=Bx[a]=je.NodeType.define({id:al.length,name:n,props:[Ue.styleTags({[n]:r})]});return al.push(o),o.id}function y5(t,e){let r=je.NodeType.define({id:al.length,name:"Document",props:[Ti.add(()=>t),xg.add(()=>n=>e.getIndent(n))],top:!0});return al.push(r),r}function o1(t){return t.length<=4096&&/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/.test(t)}function l1(t){for(let e=t.iter();!e.next().done;)if(o1(e.value))return!0;return!1}function b5(t){let e=!1;return t.iterChanges((r,n,a,s,o)=>{!e&&l1(o)&&(e=!0)}),e}var mg=et.Facet.define({combine:t=>t.some(e=>e)});function w5(t={}){let e=[_5];return t.alwaysIsolate&&e.push(mg.of(!0)),e}var _5=qe.ViewPlugin.fromClass(class{constructor(t){this.always=t.state.facet(mg)||t.textDirection!=qe.Direction.LTR||t.state.facet(qe.EditorView.perLineTextDirection),this.hasRTL=!this.always&&l1(t.state.doc),this.tree=Pr(t.state),this.decorations=this.always||this.hasRTL?Lx(t,this.tree,this.always):qe.Decoration.none}update(t){let e=t.state.facet(mg)||t.view.textDirection!=qe.Direction.LTR||t.state.facet(qe.EditorView.perLineTextDirection);if(!e&&!this.hasRTL&&b5(t.changes)&&(this.hasRTL=!0),!e&&!this.hasRTL)return;let r=Pr(t.state);(e!=this.always||r!=this.tree||t.docChanged||t.viewportChanged)&&(this.tree=r,this.always=e,this.decorations=Lx(t.view,r,e))}},{provide:t=>{function e(r){var n,a;return(a=(n=r.plugin(t))===null||n===void 0?void 0:n.decorations)!==null&&a!==void 0?a:qe.Decoration.none}return[qe.EditorView.outerDecorations.of(e),et.Prec.lowest(qe.EditorView.bidiIsolatedRanges.of(e))]}});function Lx(t,e,r){let n=new et.RangeSetBuilder,a=t.visibleRanges;r||(a=x5(a,t.state.doc));for(let{from:s,to:o}of a)e.iterate({enter:l=>{let u=l.type.prop(je.NodeProp.isolate);u&&n.add(l.from,l.to,E5[u])},from:s,to:o});return n.finish()}function x5(t,e){let r=e.iter(),n=0,a=[],s=null;for(let{from:o,to:l}of t)if(!(s&&s.to>o&&(o=s.to,o>=l)))for(n+r.value.length<o&&(r.next(o-(n+r.value.length)),n=o);;){let u=n,c=n+r.value.length;if(!r.lineBreak&&o1(r.value)&&(s&&s.to>u-10?s.to=Math.min(l,c):a.push(s={from:u,to:Math.min(l,c)})),c>=l)break;n=c,r.next()}return a}var E5={rtl:qe.Decoration.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"rtl"},bidiIsolate:qe.Direction.RTL}),ltr:qe.Decoration.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"ltr"},bidiIsolate:qe.Direction.LTR}),auto:qe.Decoration.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"auto"},bidiIsolate:null})};xe.DocInput=zc;xe.HighlightStyle=nl;xe.IndentContext=vs;xe.LRLanguage=og;xe.Language=tr;xe.LanguageDescription=ug;xe.LanguageSupport=lg;xe.ParseContext=gs;xe.StreamLanguage=gg;xe.StringStream=il;xe.TreeIndentContext=Hc;xe.bidiIsolates=w5;xe.bracketMatching=c5;xe.bracketMatchingHandle=r1;xe.codeFolding=Tg;xe.continuedIndent=q3;xe.defaultHighlightStyle=n5;xe.defineLanguageFacet=yg;xe.delimitedIndent=N3;xe.ensureSyntaxTree=Fx;xe.flatIndent=F3;xe.foldAll=Zx;xe.foldCode=jx;xe.foldEffect=ys;xe.foldGutter=Q3;xe.foldInside=H3;xe.foldKeymap=Z3;xe.foldNodeProp=Gx;xe.foldService=Wx;xe.foldState=Xn;xe.foldable=ms;xe.foldedRanges=G3;xe.forceParsing=A3;xe.getIndentUnit=tl;xe.getIndentation=_g;xe.highlightingFor=t5;xe.indentNodeProp=xg;xe.indentOnInput=z3;xe.indentRange=P3;xe.indentService=zx;xe.indentString=wg;xe.indentUnit=bg;xe.language=Zn;xe.languageDataProp=Ti;xe.matchBrackets=Qo;xe.sublanguageProp=Nx;xe.syntaxHighlighting=e5;xe.syntaxParserRunning=M3;xe.syntaxTree=Pr;xe.syntaxTreeAvailable=k3;xe.toggleFold=Y3;xe.unfoldAll=Xx;xe.unfoldCode=Yx;xe.unfoldEffect=ga});var SE=O(ie=>{"use strict";var ve=gi(),ma=xi(),Mt=Gc(),Pg=Bc(),c1=t=>{let{state:e}=t,r=e.doc.lineAt(e.selection.main.from),n=Vg(t.state,r.from);return n.line?f1(t):n.block?d1(t):!1};function ya(t,e){return({state:r,dispatch:n})=>{if(r.readOnly)return!1;let a=t(e,r);return a?(n(r.update(a)),!0):!1}}var f1=ya(zg,0),S5=ya(zg,1),C5=ya(zg,2),h1=ya($c,0),T5=ya($c,1),k5=ya($c,2),d1=ya((t,e)=>$c(t,e,M5(e)),0);function Vg(t,e){let r=t.languageDataAt("commentTokens",e,1);return r.length?r[0]:{}}var sl=50;function A5(t,{open:e,close:r},n,a){let s=t.sliceDoc(n-sl,n),o=t.sliceDoc(a,a+sl),l=/\s*$/.exec(s)[0].length,u=/^\s*/.exec(o)[0].length,c=s.length-l;if(s.slice(c-e.length,c)==e&&o.slice(u,u+r.length)==r)return{open:{pos:n-l,margin:l&&1},close:{pos:a+u,margin:u&&1}};let f,h;a-n<=2*sl?f=h=t.sliceDoc(n,a):(f=t.sliceDoc(n,n+sl),h=t.sliceDoc(a-sl,a));let d=/^\s*/.exec(f)[0].length,p=/\s*$/.exec(h)[0].length,g=h.length-p-r.length;return f.slice(d,d+e.length)==e&&h.slice(g,g+r.length)==r?{open:{pos:n+d+e.length,margin:/\s/.test(f.charAt(d+e.length))?1:0},close:{pos:a-p-r.length,margin:/\s/.test(h.charAt(g-1))?1:0}}:null}function M5(t){let e=[];for(let r of t.selection.ranges){let n=t.doc.lineAt(r.from),a=r.to<=n.to?n:t.doc.lineAt(r.to);a.from>n.from&&a.from==r.to&&(a=r.to==n.to+1?n:t.doc.lineAt(r.to-1));let s=e.length-1;s>=0&&e[s].to>n.from?e[s].to=a.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:a.to})}return e}function $c(t,e,r=e.selection.ranges){let n=r.map(s=>Vg(e,s.from).block);if(!n.every(s=>s))return null;let a=r.map((s,o)=>A5(e,n[o],s.from,s.to));if(t!=2&&!a.every(s=>s))return{changes:e.changes(r.map((s,o)=>a[o]?[]:[{from:s.from,insert:n[o].open+" "},{from:s.to,insert:" "+n[o].close}]))};if(t!=1&&a.some(s=>s)){let s=[];for(let o=0,l;o<a.length;o++)if(l=a[o]){let u=n[o],{open:c,close:f}=l;s.push({from:c.pos-u.open.length,to:c.pos+c.margin},{from:f.pos-f.margin,to:f.pos+u.close.length})}return{changes:s}}return null}function zg(t,e,r=e.selection.ranges){let n=[],a=-1;for(let{from:s,to:o}of r){let l=n.length,u=1e9,c=Vg(e,s).line;if(c){for(let f=s;f<=o;){let h=e.doc.lineAt(f);if(h.from>a&&(s==o||o>h.from)){a=h.from;let d=/^\s*/.exec(h.text)[0].length,p=d==h.length,g=h.text.slice(d,d+c.length)==c?d:-1;d<h.text.length&&d<u&&(u=d),n.push({line:h,comment:g,token:c,indent:d,empty:p,single:!1})}f=h.to+1}if(u<1e9)for(let f=l;f<n.length;f++)n[f].indent<n[f].line.text.length&&(n[f].indent=u);n.length==l+1&&(n[l].single=!0)}}if(t!=2&&n.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:l,token:u,indent:c,empty:f,single:h}of n)(h||!f)&&s.push({from:l.from+c,insert:u+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(t!=1&&n.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:l,token:u}of n)if(l>=0){let c=o.from+l,f=c+u.length;o.text[f-o.from]==" "&&f++,s.push({from:c,to:f})}return{changes:s}}return null}var Rg=ve.Annotation.define(),p1=ve.Annotation.define(),g1=ve.Facet.define(),v1=ve.Facet.define({combine(t){return ve.combineConfig(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,r)=>r},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,r)=>(n,a)=>e(n,a)||r(n,a)})}}),Qc=ve.StateField.define({create(){return va.empty},update(t,e){let r=e.state.facet(v1),n=e.annotation(Rg);if(n){let u=pn.fromTransaction(e,n.selection),c=n.side,f=c==0?t.undone:t.done;return u?f=Yc(f,f.length,r.minDepth,u):f=_1(f,e.startState.selection),new va(c==0?n.rest:f,c==0?f:n.rest)}let a=e.annotation(p1);if((a=="full"||a=="before")&&(t=t.isolate()),e.annotation(ve.Transaction.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let s=pn.fromTransaction(e),o=e.annotation(ve.Transaction.time),l=e.annotation(ve.Transaction.userEvent);return s?t=t.addChanges(s,o,l,r,e):e.selection&&(t=t.addSelection(e.startState.selection,o,l,r.newGroupDelay)),(a=="full"||a=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new va(t.done.map(pn.fromJSON),t.undone.map(pn.fromJSON))}});function P5(t={}){return[Qc,v1.of(t),ma.EditorView.domEventHandlers({beforeinput(e,r){let n=e.inputType=="historyUndo"?Hg:e.inputType=="historyRedo"?jc:null;return n?(e.preventDefault(),n(r)):!1}})]}var R5=Qc;function Jc(t,e){return function({state:r,dispatch:n}){if(!e&&r.readOnly)return!1;let a=r.field(Qc,!1);if(!a)return!1;let s=a.pop(t,r,e);return s?(n(s),!0):!1}}var Hg=Jc(0,!1),jc=Jc(1,!1),m1=Jc(0,!0),y1=Jc(1,!0);function b1(t){return function(e){let r=e.field(Qc,!1);if(!r)return 0;let n=t==0?r.done:r.undone;return n.length-(n.length&&!n[0].changes?1:0)}}var D5=b1(0),O5=b1(1),pn=class t{constructor(e,r,n,a,s){this.changes=e,this.effects=r,this.mapped=n,this.startSelection=a,this.selectionsAfter=s}setSelAfter(e){return new t(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,r,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(r=this.mapped)===null||r===void 0?void 0:r.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(a=>a.toJSON())}}static fromJSON(e){return new t(e.changes&&ve.ChangeSet.fromJSON(e.changes),[],e.mapped&&ve.ChangeDesc.fromJSON(e.mapped),e.startSelection&&ve.EditorSelection.fromJSON(e.startSelection),e.selectionsAfter.map(ve.EditorSelection.fromJSON))}static fromTransaction(e,r){let n=$r;for(let a of e.startState.facet(g1)){let s=a(e);s.length&&(n=n.concat(s))}return!n.length&&e.changes.empty?null:new t(e.changes.invert(e.startState.doc),n,void 0,r||e.startState.selection,$r)}static selection(e){return new t(void 0,$r,void 0,void 0,e)}};function Yc(t,e,r,n){let a=e+1>r+20?e-r-1:0,s=t.slice(a,e);return s.push(n),s}function I5(t,e){let r=[],n=!1;return t.iterChangedRanges((a,s)=>r.push(a,s)),e.iterChangedRanges((a,s,o,l)=>{for(let u=0;u<r.length;){let c=r[u++],f=r[u++];l>=c&&o<=f&&(n=!0)}}),n}function B5(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((r,n)=>r.empty!=e.ranges[n].empty).length===0}function w1(t,e){return t.length?e.length?t.concat(e):t:e}var $r=[],L5=200;function _1(t,e){if(t.length){let r=t[t.length-1],n=r.selectionsAfter.slice(Math.max(0,r.selectionsAfter.length-L5));return n.length&&n[n.length-1].eq(e)?t:(n.push(e),Yc(t,t.length-1,1e9,r.setSelAfter(n)))}else return[pn.selection([e])]}function N5(t){let e=t[t.length-1],r=t.slice();return r[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),r}function Mg(t,e){if(!t.length)return t;let r=t.length,n=$r;for(;r;){let a=F5(t[r-1],e,n);if(a.changes&&!a.changes.empty||a.effects.length){let s=t.slice(0,r);return s[r-1]=a,s}else e=a.mapped,r--,n=a.selectionsAfter}return n.length?[pn.selection(n)]:$r}function F5(t,e,r){let n=w1(t.selectionsAfter.length?t.selectionsAfter.map(l=>l.map(e)):$r,r);if(!t.changes)return pn.selection(n);let a=t.changes.map(e),s=e.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(s):s;return new pn(a,ve.StateEffect.mapEffects(t.effects,e),o,t.startSelection.map(s),n)}var q5=/^(input\.type|delete)($|\.)/,va=class t{constructor(e,r,n=0,a=void 0){this.done=e,this.undone=r,this.prevTime=n,this.prevUserEvent=a}isolate(){return this.prevTime?new t(this.done,this.undone):this}addChanges(e,r,n,a,s){let o=this.done,l=o[o.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!n||q5.test(n))&&(!l.selectionsAfter.length&&r-this.prevTime<a.newGroupDelay&&a.joinToEvent(s,I5(l.changes,e.changes))||n=="input.type.compose")?o=Yc(o,o.length-1,a.minDepth,new pn(e.changes.compose(l.changes),w1(ve.StateEffect.mapEffects(e.effects,l.changes),l.effects),l.mapped,l.startSelection,$r)):o=Yc(o,o.length,a.minDepth,e),new t(o,$r,r,n)}addSelection(e,r,n,a){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:$r;return s.length>0&&r-this.prevTime<a&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&B5(s[s.length-1],e)?this:new t(_1(this.done,e),this.undone,r,n)}addMapping(e){return new t(Mg(this.done,e),Mg(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,r,n){let a=e==0?this.done:this.undone;if(a.length==0)return null;let s=a[a.length-1],o=s.selectionsAfter[0]||r.selection;if(n&&s.selectionsAfter.length)return r.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:Rg.of({side:e,rest:N5(a),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let l=a.length==1?$r:a.slice(0,a.length-1);return s.mapped&&(l=Mg(l,s.mapped)),r.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:Rg.of({side:e,rest:l,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}};va.empty=new va($r,$r);var V5=[{key:"Mod-z",run:Hg,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:jc,preventDefault:!0},{linux:"Ctrl-Shift-z",run:jc,preventDefault:!0},{key:"Mod-u",run:m1,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:y1,preventDefault:!0}];function bs(t,e){return ve.EditorSelection.create(t.ranges.map(e),t.mainIndex)}function An(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Rr({state:t,dispatch:e},r){let n=bs(t.selection,r);return n.eq(t.selection,!0)?!1:(e(An(t,n)),!0)}function ba(t,e){return ve.EditorSelection.cursor(e?t.to:t.from)}function ef(t,e){return Rr(t,r=>r.empty?t.moveByChar(r,e):ba(r,e))}function cr(t){return t.textDirectionAt(t.state.selection.main.head)==ma.Direction.LTR}var Ug=t=>ef(t,!cr(t)),Wg=t=>ef(t,cr(t)),z5=t=>ef(t,!0),H5=t=>ef(t,!1);function Gg(t,e,r){let n=e.head,a=t.doc.lineAt(n);return n==(r?a.to:a.from)?n=r?Math.min(t.doc.length,a.to+1):Math.max(0,a.from-1):n=a.from+ve.findClusterBreak(a.text,n-a.from,r),ve.EditorSelection.cursor(n,r?-1:1)}function x1(t,e){return Rr(t,r=>r.empty?Gg(t.state,r,e):ba(r,e))}var U5=t=>x1(t,!0),W5=t=>x1(t,!1);function tf(t,e){return Rr(t,r=>r.empty?t.moveByGroup(r,e):ba(r,e))}var E1=t=>tf(t,!cr(t)),S1=t=>tf(t,cr(t)),G5=t=>tf(t,!0),K5=t=>tf(t,!1);function C1(t,e,r){let n=t.state.charCategorizer(e),a=n(r),s=a!=ve.CharCategory.Space;return o=>{let l=n(o);return l!=ve.CharCategory.Space?s&&l==a:(s=!1,!0)}}var j5=t=>Rr(t,e=>e.empty?t.moveByChar(e,!0,r=>C1(t,e.head,r)):ba(e,!0)),u1=typeof Intl<"u"&&Intl.Segmenter?new Intl.Segmenter(void 0,{granularity:"word"}):null;function T1(t,e,r){let n=t.state.charCategorizer(e.from),a=ve.CharCategory.Space,s=e.from,o=0,l=!1,u=!1,c=!1,f=d=>{if(l)return!1;s+=r?d.length:-d.length;let p=n(d),g;if(p==ve.CharCategory.Word&&d.charCodeAt(0)<128&&/[\W_]/.test(d)&&(p=-1),a==ve.CharCategory.Space&&(a=p),a!=p)return!1;if(a==ve.CharCategory.Word)if(d.toLowerCase()==d){if(!r&&u)return!1;c=!0}else if(c){if(r)return!1;l=!0}else{if(u&&r&&n(g=t.state.sliceDoc(s,s+1))==ve.CharCategory.Word&&g.toLowerCase()==g)return!1;u=!0}return o++,!0},h=t.moveByChar(e,r,d=>(f(d),f));if(u1&&a==ve.CharCategory.Word&&h.from==e.from+o*(r?1:-1)){let d=Math.min(e.head,h.head),p=Math.max(e.head,h.head),g=t.state.sliceDoc(d,p);if(g.length>1&&/[\u4E00-\uffff]/.test(g)){let m=Array.from(u1.segment(g));if(m.length>1)return r?ve.EditorSelection.cursor(e.head+m[1].index,-1):ve.EditorSelection.cursor(h.head+m[m.length-1].index,1)}}return h}function k1(t,e){return Rr(t,r=>r.empty?T1(t,r,e):ba(r,e))}var Y5=t=>k1(t,!0),Z5=t=>k1(t,!1);function X5(t,e,r){if(e.type.prop(r))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function rf(t,e,r){let n=Mt.syntaxTree(t).resolveInner(e.head),a=r?Pg.NodeProp.closedBy:Pg.NodeProp.openedBy;for(let u=e.head;;){let c=r?n.childAfter(u):n.childBefore(u);if(!c)break;X5(t,c,a)?n=c:u=r?c.to:c.from}let s=n.type.prop(a),o,l;return s&&(o=r?Mt.matchBrackets(t,n.from,1):Mt.matchBrackets(t,n.to,-1))&&o.matched?l=r?o.end.to:o.end.from:l=r?n.to:n.from,ve.EditorSelection.cursor(l,r?-1:1)}var A1=t=>Rr(t,e=>rf(t.state,e,!cr(t))),M1=t=>Rr(t,e=>rf(t.state,e,cr(t)));function P1(t,e){return Rr(t,r=>{if(!r.empty)return ba(r,e);let n=t.moveVertically(r,e);return n.head!=r.head?n:t.moveToLineBoundary(r,e)})}var Kg=t=>P1(t,!1),jg=t=>P1(t,!0);function R1(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,r=0,n=0,a;if(e){for(let s of t.state.facet(ma.EditorView.scrollMargins)){let o=s(t);o?.top&&(r=Math.max(o?.top,r)),o?.bottom&&(n=Math.max(o?.bottom,n))}a=t.scrollDOM.clientHeight-r-n}else a=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:r,marginBottom:n,selfScroll:e,height:Math.max(t.defaultLineHeight,a-5)}}function D1(t,e){let r=R1(t),{state:n}=t,a=bs(n.selection,o=>o.empty?t.moveVertically(o,e,r.height):ba(o,e));if(a.eq(n.selection))return!1;let s;if(r.selfScroll){let o=t.coordsAtPos(n.selection.main.head),l=t.scrollDOM.getBoundingClientRect(),u=l.top+r.marginTop,c=l.bottom-r.marginBottom;o&&o.top>u&&o.bottom<c&&(s=ma.EditorView.scrollIntoView(a.main.head,{y:"start",yMargin:o.top-u}))}return t.dispatch(An(n,a),{effects:s}),!0}var Dg=t=>D1(t,!1),Zc=t=>D1(t,!0);function ki(t,e,r){let n=t.lineBlockAt(e.head),a=t.moveToLineBoundary(e,r);if(a.head==e.head&&a.head!=(r?n.to:n.from)&&(a=t.moveToLineBoundary(e,r,!1)),!r&&a.head==n.from&&n.length){let s=/^\s*/.exec(t.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;s&&e.head!=n.from+s&&(a=ve.EditorSelection.cursor(n.from+s))}return a}var O1=t=>Rr(t,e=>ki(t,e,!0)),I1=t=>Rr(t,e=>ki(t,e,!1)),B1=t=>Rr(t,e=>ki(t,e,!cr(t))),L1=t=>Rr(t,e=>ki(t,e,cr(t))),N1=t=>Rr(t,e=>ve.EditorSelection.cursor(t.lineBlockAt(e.head).from,1)),F1=t=>Rr(t,e=>ve.EditorSelection.cursor(t.lineBlockAt(e.head).to,-1));function q1(t,e,r){let n=!1,a=bs(t.selection,s=>{let o=Mt.matchBrackets(t,s.head,-1)||Mt.matchBrackets(t,s.head,1)||s.head>0&&Mt.matchBrackets(t,s.head-1,1)||s.head<t.doc.length&&Mt.matchBrackets(t,s.head+1,-1);if(!o||!o.end)return s;n=!0;let l=o.start.from==s.head?o.end.to:o.end.from;return r?ve.EditorSelection.range(s.anchor,l):ve.EditorSelection.cursor(l)});return n?(e(An(t,a)),!0):!1}var V1=({state:t,dispatch:e})=>q1(t,e,!1),$5=({state:t,dispatch:e})=>q1(t,e,!0);function fr(t,e){let r=bs(t.state.selection,n=>{let a=e(n);return ve.EditorSelection.range(n.anchor,a.head,a.goalColumn,a.bidiLevel||void 0)});return r.eq(t.state.selection)?!1:(t.dispatch(An(t.state,r)),!0)}function nf(t,e){return fr(t,r=>t.moveByChar(r,e))}var Yg=t=>nf(t,!cr(t)),Zg=t=>nf(t,cr(t)),Q5=t=>nf(t,!0),J5=t=>nf(t,!1),eH=t=>fr(t,e=>Gg(t.state,e,!0)),tH=t=>fr(t,e=>Gg(t.state,e,!1));function af(t,e){return fr(t,r=>t.moveByGroup(r,e))}var z1=t=>af(t,!cr(t)),H1=t=>af(t,cr(t)),rH=t=>af(t,!0),nH=t=>af(t,!1),iH=t=>fr(t,e=>t.moveByChar(e,!0,r=>C1(t,e.head,r)));function U1(t,e){return fr(t,r=>T1(t,r,e))}var aH=t=>U1(t,!0),sH=t=>U1(t,!1),W1=t=>fr(t,e=>rf(t.state,e,!cr(t))),G1=t=>fr(t,e=>rf(t.state,e,cr(t)));function K1(t,e){return fr(t,r=>t.moveVertically(r,e))}var Xg=t=>K1(t,!1),$g=t=>K1(t,!0);function j1(t,e){return fr(t,r=>t.moveVertically(r,e,R1(t).height))}var Og=t=>j1(t,!1),Ig=t=>j1(t,!0),Y1=t=>fr(t,e=>ki(t,e,!0)),Z1=t=>fr(t,e=>ki(t,e,!1)),X1=t=>fr(t,e=>ki(t,e,!cr(t))),$1=t=>fr(t,e=>ki(t,e,cr(t))),Q1=t=>fr(t,e=>ve.EditorSelection.cursor(t.lineBlockAt(e.head).from)),J1=t=>fr(t,e=>ve.EditorSelection.cursor(t.lineBlockAt(e.head).to)),Bg=({state:t,dispatch:e})=>(e(An(t,{anchor:0})),!0),Lg=({state:t,dispatch:e})=>(e(An(t,{anchor:t.doc.length})),!0),Ng=({state:t,dispatch:e})=>(e(An(t,{anchor:t.selection.main.anchor,head:0})),!0),Fg=({state:t,dispatch:e})=>(e(An(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),eE=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),tE=({state:t,dispatch:e})=>{let r=sf(t).map(({from:n,to:a})=>ve.EditorSelection.range(n,Math.min(a+1,t.doc.length)));return e(t.update({selection:ve.EditorSelection.create(r),userEvent:"select"})),!0},rE=({state:t,dispatch:e})=>{let r=bs(t.selection,n=>{let a=Mt.syntaxTree(t),s=a.resolveStack(n.from,1);if(n.empty){let o=a.resolveStack(n.from,-1);o.node.from>=s.node.from&&o.node.to<=s.node.to&&(s=o)}for(let o=s;o;o=o.next){let{node:l}=o;if((l.from<n.from&&l.to>=n.to||l.to>n.to&&l.from<=n.from)&&o.next)return ve.EditorSelection.range(l.to,l.from)}return n});return r.eq(t.selection)?!1:(e(An(t,r)),!0)},nE=({state:t,dispatch:e})=>{let r=t.selection,n=null;return r.ranges.length>1?n=ve.EditorSelection.create([r.main]):r.main.empty||(n=ve.EditorSelection.create([ve.EditorSelection.cursor(r.main.head)])),n?(e(An(t,n)),!0):!1};function ws(t,e){if(t.state.readOnly)return!1;let r="delete.selection",{state:n}=t,a=n.changeByRange(s=>{let{from:o,to:l}=s;if(o==l){let u=e(s);u<o?(r="delete.backward",u=Kc(t,u,!1)):u>o&&(r="delete.forward",u=Kc(t,u,!0)),o=Math.min(o,u),l=Math.max(l,u)}else o=Kc(t,o,!1),l=Kc(t,l,!0);return o==l?{range:s}:{changes:{from:o,to:l},range:ve.EditorSelection.cursor(o,o<s.head?-1:1)}});return a.changes.empty?!1:(t.dispatch(n.update(a,{scrollIntoView:!0,userEvent:r,effects:r=="delete.selection"?ma.EditorView.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function Kc(t,e,r){if(t instanceof ma.EditorView)for(let n of t.state.facet(ma.EditorView.atomicRanges).map(a=>a(t)))n.between(e,e,(a,s)=>{a<e&&s>e&&(e=r?s:a)});return e}var Qg=(t,e,r)=>ws(t,n=>{let a=n.from,{state:s}=t,o=s.doc.lineAt(a),l,u;if(r&&!e&&a>o.from&&a<o.from+200&&!/[^ \t]/.test(l=o.text.slice(0,a-o.from))){if(l[l.length-1]=="	")return a-1;let c=ve.countColumn(l,s.tabSize),f=c%Mt.getIndentUnit(s)||Mt.getIndentUnit(s);for(let h=0;h<f&&l[l.length-1-h]==" ";h++)a--;u=a}else u=ve.findClusterBreak(o.text,a-o.from,e,e)+o.from,u==a&&o.number!=(e?s.doc.lines:1)?u+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(u-o.from,a-o.from))&&(u=ve.findClusterBreak(o.text,u-o.from,!1,!1)+o.from);return u}),Xc=t=>Qg(t,!1,!0),oH=t=>Qg(t,!1,!1),Jg=t=>Qg(t,!0,!1),iE=(t,e)=>ws(t,r=>{let n=r.head,{state:a}=t,s=a.doc.lineAt(n),o=a.charCategorizer(n);for(let l=null;;){if(n==(e?s.to:s.from)){n==r.head&&s.number!=(e?a.doc.lines:1)&&(n+=e?1:-1);break}let u=ve.findClusterBreak(s.text,n-s.from,e)+s.from,c=s.text.slice(Math.min(n,u)-s.from,Math.max(n,u)-s.from),f=o(c);if(l!=null&&f!=l)break;(c!=" "||n!=r.head)&&(l=f),n=u}return n}),ev=t=>iE(t,!1),aE=t=>iE(t,!0),sE=t=>ws(t,e=>{let r=t.lineBlockAt(e.head).to;return e.head<r?r:Math.min(t.state.doc.length,e.head+1)}),lH=t=>ws(t,e=>{let r=t.lineBlockAt(e.head).from;return e.head>r?r:Math.max(0,e.head-1)}),oE=t=>ws(t,e=>{let r=t.moveToLineBoundary(e,!1).head;return e.head>r?r:Math.max(0,e.head-1)}),lE=t=>ws(t,e=>{let r=t.moveToLineBoundary(e,!0).head;return e.head<r?r:Math.min(t.state.doc.length,e.head+1)}),uH=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=[];for(let n=0,a="",s=t.doc.iter();;){if(s.next(),s.lineBreak||s.done){let o=a.search(/\s+$/);if(o>-1&&r.push({from:n-(a.length-o),to:n}),s.done)break;a=""}else a=s.value;n+=s.value.length}return r.length?(e(t.update({changes:r,userEvent:"delete"})),!0):!1},uE=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:ve.Text.of(["",""])},range:ve.EditorSelection.cursor(n.from)}));return e(t.update(r,{scrollIntoView:!0,userEvent:"input"})),!0},cE=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange(n=>{if(!n.empty||n.from==0||n.from==t.doc.length)return{range:n};let a=n.from,s=t.doc.lineAt(a),o=a==s.from?a-1:ve.findClusterBreak(s.text,a-s.from,!1)+s.from,l=a==s.to?a+1:ve.findClusterBreak(s.text,a-s.from,!0)+s.from;return{changes:{from:o,to:l,insert:t.doc.slice(a,l).append(t.doc.slice(o,a))},range:ve.EditorSelection.cursor(l)}});return r.changes.empty?!1:(e(t.update(r,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function sf(t){let e=[],r=-1;for(let n of t.selection.ranges){let a=t.doc.lineAt(n.from),s=t.doc.lineAt(n.to);if(!n.empty&&n.to==s.from&&(s=t.doc.lineAt(n.to-1)),r>=a.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(n)}else e.push({from:a.from,to:s.to,ranges:[n]});r=s.number+1}return e}function fE(t,e,r){if(t.readOnly)return!1;let n=[],a=[];for(let s of sf(t)){if(r?s.to==t.doc.length:s.from==0)continue;let o=t.doc.lineAt(r?s.to+1:s.from-1),l=o.length+1;if(r){n.push({from:s.to,to:o.to},{from:s.from,insert:o.text+t.lineBreak});for(let u of s.ranges)a.push(ve.EditorSelection.range(Math.min(t.doc.length,u.anchor+l),Math.min(t.doc.length,u.head+l)))}else{n.push({from:o.from,to:s.from},{from:s.to,insert:t.lineBreak+o.text});for(let u of s.ranges)a.push(ve.EditorSelection.range(u.anchor-l,u.head-l))}}return n.length?(e(t.update({changes:n,scrollIntoView:!0,selection:ve.EditorSelection.create(a,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}var hE=({state:t,dispatch:e})=>fE(t,e,!1),dE=({state:t,dispatch:e})=>fE(t,e,!0);function pE(t,e,r){if(t.readOnly)return!1;let n=[];for(let a of sf(t))r?n.push({from:a.from,insert:t.doc.slice(a.from,a.to)+t.lineBreak}):n.push({from:a.to,insert:t.lineBreak+t.doc.slice(a.from,a.to)});return e(t.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}var gE=({state:t,dispatch:e})=>pE(t,e,!1),vE=({state:t,dispatch:e})=>pE(t,e,!0),mE=t=>{if(t.state.readOnly)return!1;let{state:e}=t,r=e.changes(sf(e).map(({from:a,to:s})=>(a>0?a--:s<e.doc.length&&s++,{from:a,to:s}))),n=bs(e.selection,a=>{let s;if(t.lineWrapping){let o=t.lineBlockAt(a.head),l=t.coordsAtPos(a.head,a.assoc||1);l&&(s=o.bottom+t.documentTop-l.bottom+t.defaultLineHeight/2)}return t.moveVertically(a,!0,s)}).map(r);return t.dispatch({changes:r,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0},cH=({state:t,dispatch:e})=>(e(t.update(t.replaceSelection(t.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0),fH=({state:t,dispatch:e})=>(e(t.update(t.changeByRange(r=>{let n=/^\s*/.exec(t.doc.lineAt(r.from).text)[0];return{changes:{from:r.from,to:r.to,insert:t.lineBreak+n},range:ve.EditorSelection.cursor(r.from+n.length+1)}}),{scrollIntoView:!0,userEvent:"input"})),!0);function hH(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let r=Mt.syntaxTree(t).resolveInner(e),n=r.childBefore(e),a=r.childAfter(e),s;return n&&a&&n.to<=e&&a.from>=e&&(s=n.type.prop(Pg.NodeProp.closedBy))&&s.indexOf(a.name)>-1&&t.doc.lineAt(n.to).from==t.doc.lineAt(a.from).from&&!/\S/.test(t.sliceDoc(n.to,a.from))?{from:n.to,to:a.from}:null}var qg=bE(!1),yE=bE(!0);function bE(t){return({state:e,dispatch:r})=>{if(e.readOnly)return!1;let n=e.changeByRange(a=>{let{from:s,to:o}=a,l=e.doc.lineAt(s),u=!t&&s==o&&hH(e,s);t&&(s=o=(o<=l.to?l:e.doc.lineAt(o)).to);let c=new Mt.IndentContext(e,{simulateBreak:s,simulateDoubleBreak:!!u}),f=Mt.getIndentation(c,s);for(f==null&&(f=ve.countColumn(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<l.to&&/\s/.test(l.text[o-l.from]);)o++;u?{from:s,to:o}=u:s>l.from&&s<l.from+100&&!/\S/.test(l.text.slice(0,s))&&(s=l.from);let h=["",Mt.indentString(e,f)];return u&&h.push(Mt.indentString(e,c.lineIndent(l.from,-1))),{changes:{from:s,to:o,insert:ve.Text.of(h)},range:ve.EditorSelection.cursor(s+1+h[1].length)}});return r(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function tv(t,e){let r=-1;return t.changeByRange(n=>{let a=[];for(let o=n.from;o<=n.to;){let l=t.doc.lineAt(o);l.number>r&&(n.empty||n.to>l.from)&&(e(l,a,n),r=l.number),o=l.to+1}let s=t.changes(a);return{changes:a,range:ve.EditorSelection.range(s.mapPos(n.anchor,1),s.mapPos(n.head,1))}})}var wE=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=Object.create(null),n=new Mt.IndentContext(t,{overrideIndentation:s=>{let o=r[s];return o??-1}}),a=tv(t,(s,o,l)=>{let u=Mt.getIndentation(n,s.from);if(u==null)return;/\S/.test(s.text)||(u=0);let c=/^\s*/.exec(s.text)[0],f=Mt.indentString(t,u);(c!=f||l.from<s.from+c.length)&&(r[s.from]=u,o.push({from:s.from,to:s.from+c.length,insert:f}))});return a.changes.empty||e(t.update(a,{userEvent:"indent"})),!0},of=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(tv(t,(r,n)=>{n.push({from:r.from,insert:t.facet(Mt.indentUnit)})}),{userEvent:"input.indent"})),!0),rv=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(tv(t,(r,n)=>{let a=/^\s*/.exec(r.text)[0];if(!a)return;let s=ve.countColumn(a,t.tabSize),o=0,l=Mt.indentString(t,Math.max(0,s-Mt.getIndentUnit(t)));for(;o<a.length&&o<l.length&&a.charCodeAt(o)==l.charCodeAt(o);)o++;n.push({from:r.from+o,to:r.from+a.length,insert:l.slice(o)})}),{userEvent:"delete.dedent"})),!0),_E=t=>(t.setTabFocusMode(),!0),dH=t=>(t.setTabFocusMode(2e3),!0),pH=({state:t,dispatch:e})=>t.selection.ranges.some(r=>!r.empty)?of({state:t,dispatch:e}):(e(t.update(t.replaceSelection("	"),{scrollIntoView:!0,userEvent:"input"})),!0),xE=[{key:"Ctrl-b",run:Ug,shift:Yg,preventDefault:!0},{key:"Ctrl-f",run:Wg,shift:Zg},{key:"Ctrl-p",run:Kg,shift:Xg},{key:"Ctrl-n",run:jg,shift:$g},{key:"Ctrl-a",run:N1,shift:Q1},{key:"Ctrl-e",run:F1,shift:J1},{key:"Ctrl-d",run:Jg},{key:"Ctrl-h",run:Xc},{key:"Ctrl-k",run:sE},{key:"Ctrl-Alt-h",run:ev},{key:"Ctrl-o",run:uE},{key:"Ctrl-t",run:cE},{key:"Ctrl-v",run:Zc}],EE=[{key:"ArrowLeft",run:Ug,shift:Yg,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:E1,shift:z1,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:B1,shift:X1,preventDefault:!0},{key:"ArrowRight",run:Wg,shift:Zg,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:S1,shift:H1,preventDefault:!0},{mac:"Cmd-ArrowRight",run:L1,shift:$1,preventDefault:!0},{key:"ArrowUp",run:Kg,shift:Xg,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Bg,shift:Ng},{mac:"Ctrl-ArrowUp",run:Dg,shift:Og},{key:"ArrowDown",run:jg,shift:$g,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Lg,shift:Fg},{mac:"Ctrl-ArrowDown",run:Zc,shift:Ig},{key:"PageUp",run:Dg,shift:Og},{key:"PageDown",run:Zc,shift:Ig},{key:"Home",run:I1,shift:Z1,preventDefault:!0},{key:"Mod-Home",run:Bg,shift:Ng},{key:"End",run:O1,shift:Y1,preventDefault:!0},{key:"Mod-End",run:Lg,shift:Fg},{key:"Enter",run:qg,shift:qg},{key:"Mod-a",run:eE},{key:"Backspace",run:Xc,shift:Xc},{key:"Delete",run:Jg},{key:"Mod-Backspace",mac:"Alt-Backspace",run:ev},{key:"Mod-Delete",mac:"Alt-Delete",run:aE},{mac:"Mod-Backspace",run:oE},{mac:"Mod-Delete",run:lE}].concat(xE.map(t=>({mac:t.key,run:t.run,shift:t.shift}))),gH=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:A1,shift:W1},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:M1,shift:G1},{key:"Alt-ArrowUp",run:hE},{key:"Shift-Alt-ArrowUp",run:gE},{key:"Alt-ArrowDown",run:dE},{key:"Shift-Alt-ArrowDown",run:vE},{key:"Escape",run:nE},{key:"Mod-Enter",run:yE},{key:"Alt-l",mac:"Ctrl-l",run:tE},{key:"Mod-i",run:rE,preventDefault:!0},{key:"Mod-[",run:rv},{key:"Mod-]",run:of},{key:"Mod-Alt-\\",run:wE},{key:"Shift-Mod-k",run:mE},{key:"Shift-Mod-\\",run:V1},{key:"Mod-/",run:c1},{key:"Alt-A",run:h1},{key:"Ctrl-m",mac:"Shift-Alt-m",run:_E}].concat(EE),vH={key:"Tab",run:of,shift:rv};ie.blockComment=T5;ie.blockUncomment=k5;ie.copyLineDown=vE;ie.copyLineUp=gE;ie.cursorCharBackward=H5;ie.cursorCharBackwardLogical=W5;ie.cursorCharForward=z5;ie.cursorCharForwardLogical=U5;ie.cursorCharLeft=Ug;ie.cursorCharRight=Wg;ie.cursorDocEnd=Lg;ie.cursorDocStart=Bg;ie.cursorGroupBackward=K5;ie.cursorGroupForward=G5;ie.cursorGroupForwardWin=j5;ie.cursorGroupLeft=E1;ie.cursorGroupRight=S1;ie.cursorLineBoundaryBackward=I1;ie.cursorLineBoundaryForward=O1;ie.cursorLineBoundaryLeft=B1;ie.cursorLineBoundaryRight=L1;ie.cursorLineDown=jg;ie.cursorLineEnd=F1;ie.cursorLineStart=N1;ie.cursorLineUp=Kg;ie.cursorMatchingBracket=V1;ie.cursorPageDown=Zc;ie.cursorPageUp=Dg;ie.cursorSubwordBackward=Z5;ie.cursorSubwordForward=Y5;ie.cursorSyntaxLeft=A1;ie.cursorSyntaxRight=M1;ie.defaultKeymap=gH;ie.deleteCharBackward=Xc;ie.deleteCharBackwardStrict=oH;ie.deleteCharForward=Jg;ie.deleteGroupBackward=ev;ie.deleteGroupForward=aE;ie.deleteLine=mE;ie.deleteLineBoundaryBackward=oE;ie.deleteLineBoundaryForward=lE;ie.deleteToLineEnd=sE;ie.deleteToLineStart=lH;ie.deleteTrailingWhitespace=uH;ie.emacsStyleKeymap=xE;ie.history=P5;ie.historyField=R5;ie.historyKeymap=V5;ie.indentLess=rv;ie.indentMore=of;ie.indentSelection=wE;ie.indentWithTab=vH;ie.insertBlankLine=yE;ie.insertNewline=cH;ie.insertNewlineAndIndent=qg;ie.insertNewlineKeepIndent=fH;ie.insertTab=pH;ie.invertedEffects=g1;ie.isolateHistory=p1;ie.lineComment=S5;ie.lineUncomment=C5;ie.moveLineDown=dE;ie.moveLineUp=hE;ie.redo=jc;ie.redoDepth=O5;ie.redoSelection=y1;ie.selectAll=eE;ie.selectCharBackward=J5;ie.selectCharBackwardLogical=tH;ie.selectCharForward=Q5;ie.selectCharForwardLogical=eH;ie.selectCharLeft=Yg;ie.selectCharRight=Zg;ie.selectDocEnd=Fg;ie.selectDocStart=Ng;ie.selectGroupBackward=nH;ie.selectGroupForward=rH;ie.selectGroupForwardWin=iH;ie.selectGroupLeft=z1;ie.selectGroupRight=H1;ie.selectLine=tE;ie.selectLineBoundaryBackward=Z1;ie.selectLineBoundaryForward=Y1;ie.selectLineBoundaryLeft=X1;ie.selectLineBoundaryRight=$1;ie.selectLineDown=$g;ie.selectLineEnd=J1;ie.selectLineStart=Q1;ie.selectLineUp=Xg;ie.selectMatchingBracket=$5;ie.selectPageDown=Ig;ie.selectPageUp=Og;ie.selectParentSyntax=rE;ie.selectSubwordBackward=sH;ie.selectSubwordForward=aH;ie.selectSyntaxLeft=W1;ie.selectSyntaxRight=G1;ie.simplifySelection=nE;ie.splitLine=uE;ie.standardKeymap=EE;ie.temporarilySetTabFocusMode=dH;ie.toggleBlockComment=h1;ie.toggleBlockCommentByLine=d1;ie.toggleComment=c1;ie.toggleLineComment=f1;ie.toggleTabFocusMode=_E;ie.transposeChars=cE;ie.undo=Hg;ie.undoDepth=D5;ie.undoSelection=m1});var nv=O((Cfe,TE)=>{"use strict";function mH(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,r=arguments[1];if(r&&typeof r=="object"&&r.nodeType==null&&!Array.isArray(r)){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var a=r[n];typeof a=="string"?t.setAttribute(n,a):a!=null&&(t[n]=a)}e++}for(;e<arguments.length;e++)CE(t,arguments[e]);return t}function CE(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var r=0;r<e.length;r++)CE(t,e[r]);else throw new RangeError("Unsupported child node: "+e)}TE.exports=mH});var qE=O(Lt=>{"use strict";var rt=xi(),Ne=gi(),rr=nv(),kE=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t,$n=class{constructor(e,r,n=0,a=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,a),this.bufferStart=n,this.normalize=s?l=>s(kE(l)):kE,this.query=this.normalize(r)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Ne.codePointAt(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let r=Ne.fromCodePoint(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=Ne.codePointSize(e);let a=this.normalize(r);if(a.length)for(let s=0,o=n;;s++){let l=a.charCodeAt(s),u=this.match(l,o,this.bufferPos+this.bufferStart);if(s==a.length-1){if(u)return this.value=u,this;break}o==n&&s<r.length&&r.charCodeAt(s)==l&&o++}}}match(e,r,n){let a=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],l=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?a={from:this.matches[s+1],to:n}:(this.matches[s]++,l=!0)),l||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?a={from:r,to:n}:this.matches.push(1,r)),a&&this.test&&!this.test(a.from,a.to,this.buffer,this.bufferStart)&&(a=null),a}};typeof Symbol<"u"&&($n.prototype[Symbol.iterator]=function(){return this});var PE={from:-1,to:-1,match:/.*/.exec("")},fv="gm"+(/x/.unicode==null?"":"u"),ul=class{constructor(e,r,n,a=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=PE,/\\[sWDnr]|\n|\r|\[\^/.test(r))return new ff(e,r,n,a,s);this.re=new RegExp(r,fv+(n?.ignoreCase?"i":"")),this.test=n?.test,this.iter=e.iter();let o=e.lineAt(a);this.curLineStart=o.from,this.matchPos=hf(e,a),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let r=this.matchPos<=this.to&&this.re.exec(this.curLine);if(r){let n=this.curLineStart+r.index,a=n+r[0].length;if(this.matchPos=hf(this.text,a+(n==a?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<a||n>this.value.to)&&(!this.test||this.test(n,a,r)))return this.value={from:n,to:a,match:r},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}},iv=new WeakMap,cf=class t{constructor(e,r){this.from=e,this.text=r}get to(){return this.from+this.text.length}static get(e,r,n){let a=iv.get(e);if(!a||a.from>=n||a.to<=r){let l=new t(r,e.sliceString(r,n));return iv.set(e,l),l}if(a.from==r&&a.to==n)return a;let{text:s,from:o}=a;return o>r&&(s=e.sliceString(r,o)+s,o=r),a.to<n&&(s+=e.sliceString(a.to,n)),iv.set(e,new t(o,s)),new t(r,s.slice(r-o,n-o))}},ff=class{constructor(e,r,n,a,s){this.text=e,this.to=s,this.done=!1,this.value=PE,this.matchPos=hf(e,a),this.re=new RegExp(r,fv+(n?.ignoreCase?"i":"")),this.test=n?.test,this.flat=cf.get(e,a,this.chunkEnd(a+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,r=this.re.exec(this.flat.text);if(r&&!r[0]&&r.index==e&&(this.re.lastIndex=e+1,r=this.re.exec(this.flat.text)),r){let n=this.flat.from+r.index,a=n+r[0].length;if((this.flat.to>=this.to||r.index+r[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,a,r)))return this.value={from:n,to:a,match:r},this.matchPos=hf(this.text,a+(n==a?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=cf.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}};typeof Symbol<"u"&&(ul.prototype[Symbol.iterator]=ff.prototype[Symbol.iterator]=function(){return this});function yH(t){try{return new RegExp(t,fv),!0}catch{return!1}}function hf(t,e){if(e>=t.length)return e;let r=t.lineAt(e),n;for(;e<r.to&&(n=r.text.charCodeAt(e-r.from))>=56320&&n<57344;)e++;return e}function av(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),r=rr("input",{class:"cm-textfield",name:"line",value:e}),n=rr("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),t.dispatch({effects:ol.of(!1)}),t.focus()):s.keyCode==13&&(s.preventDefault(),a())},onsubmit:s=>{s.preventDefault(),a()}},rr("label",t.state.phrase("Go to line"),": ",r)," ",rr("button",{class:"cm-button",type:"submit"},t.state.phrase("go")),rr("button",{name:"close",onclick:()=>{t.dispatch({effects:ol.of(!1)}),t.focus()},"aria-label":t.state.phrase("close"),type:"button"},["\xD7"]));function a(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(r.value);if(!s)return;let{state:o}=t,l=o.doc.lineAt(o.selection.main.head),[,u,c,f,h]=s,d=f?+f.slice(1):0,p=c?+c:l.number;if(c&&h){let v=p/100;u&&(v=v*(u=="-"?-1:1)+l.number/o.doc.lines),p=Math.round(o.doc.lines*v)}else c&&u&&(p=p*(u=="-"?-1:1)+l.number);let g=o.doc.line(Math.max(1,Math.min(o.doc.lines,p))),m=Ne.EditorSelection.cursor(g.from+Math.max(0,Math.min(d,g.length)));t.dispatch({effects:[ol.of(!1),rt.EditorView.scrollIntoView(m.from,{y:"center"})],selection:m}),t.focus()}return{dom:n}}var ol=Ne.StateEffect.define(),AE=Ne.StateField.define({create(){return!0},update(t,e){for(let r of e.effects)r.is(ol)&&(t=r.value);return t},provide:t=>rt.showPanel.from(t,e=>e?av:null)}),RE=t=>{let e=rt.getPanel(t,av);if(!e){let r=[ol.of(!0)];t.state.field(AE,!1)==null&&r.push(Ne.StateEffect.appendConfig.of([AE,bH])),t.dispatch({effects:r}),e=rt.getPanel(t,av)}return e&&e.dom.querySelector("input").select(),!0},bH=rt.EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),wH={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},DE=Ne.Facet.define({combine(t){return Ne.combineConfig(t,wH,{highlightWordAroundCursor:(e,r)=>e||r,minSelectionLength:Math.min,maxMatches:Math.min})}});function _H(t){let e=[TH,CH];return t&&e.push(DE.of(t)),e}var xH=rt.Decoration.mark({class:"cm-selectionMatch"}),EH=rt.Decoration.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function ME(t,e,r,n){return(r==0||t(e.sliceDoc(r-1,r))!=Ne.CharCategory.Word)&&(n==e.doc.length||t(e.sliceDoc(n,n+1))!=Ne.CharCategory.Word)}function SH(t,e,r,n){return t(e.sliceDoc(r,r+1))==Ne.CharCategory.Word&&t(e.sliceDoc(n-1,n))==Ne.CharCategory.Word}var CH=rt.ViewPlugin.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(DE),{state:r}=t,n=r.selection;if(n.ranges.length>1)return rt.Decoration.none;let a=n.main,s,o=null;if(a.empty){if(!e.highlightWordAroundCursor)return rt.Decoration.none;let u=r.wordAt(a.head);if(!u)return rt.Decoration.none;o=r.charCategorizer(a.head),s=r.sliceDoc(u.from,u.to)}else{let u=a.to-a.from;if(u<e.minSelectionLength||u>200)return rt.Decoration.none;if(e.wholeWords){if(s=r.sliceDoc(a.from,a.to),o=r.charCategorizer(a.head),!(ME(o,r,a.from,a.to)&&SH(o,r,a.from,a.to)))return rt.Decoration.none}else if(s=r.sliceDoc(a.from,a.to),!s)return rt.Decoration.none}let l=[];for(let u of t.visibleRanges){let c=new $n(r.doc,s,u.from,u.to);for(;!c.next().done;){let{from:f,to:h}=c.value;if((!o||ME(o,r,f,h))&&(a.empty&&f<=a.from&&h>=a.to?l.push(EH.range(f,h)):(f>=a.to||h<=a.from)&&l.push(xH.range(f,h)),l.length>e.maxMatches))return rt.Decoration.none}}return rt.Decoration.set(l)}},{decorations:t=>t.decorations}),TH=rt.EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),kH=({state:t,dispatch:e})=>{let{selection:r}=t,n=Ne.EditorSelection.create(r.ranges.map(a=>t.wordAt(a.head)||Ne.EditorSelection.cursor(a.head)),r.mainIndex);return n.eq(r)?!1:(e(t.update({selection:n})),!0)};function AH(t,e){let{main:r,ranges:n}=t.selection,a=t.wordAt(r.head),s=a&&a.from==r.from&&a.to==r.to;for(let o=!1,l=new $n(t.doc,e,n[n.length-1].to);;)if(l.next(),l.done){if(o)return null;l=new $n(t.doc,e,0,Math.max(0,n[n.length-1].from-1)),o=!0}else{if(o&&n.some(u=>u.from==l.value.from))continue;if(s){let u=t.wordAt(l.value.from);if(!u||u.from!=l.value.from||u.to!=l.value.to)continue}return l.value}}var OE=({state:t,dispatch:e})=>{let{ranges:r}=t.selection;if(r.some(s=>s.from===s.to))return kH({state:t,dispatch:e});let n=t.sliceDoc(r[0].from,r[0].to);if(t.selection.ranges.some(s=>t.sliceDoc(s.from,s.to)!=n))return!1;let a=AH(t,n);return a?(e(t.update({selection:t.selection.addRange(Ne.EditorSelection.range(a.from,a.to),!1),effects:rt.EditorView.scrollIntoView(a.to)})),!0):!1},wa=Ne.Facet.define({combine(t){return Ne.combineConfig(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new uv(e),scrollToMatch:e=>rt.EditorView.scrollIntoView(e)})}});function MH(t){return t?[wa.of(t),cv]:cv}var cl=class{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||yH(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(r,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new ov(this):new sv(this)}getCursor(e,r=0,n){let a=e.doc?e:Ne.EditorState.create({doc:e});return n==null&&(n=a.doc.length),this.regexp?xs(this,a,r,n):_s(this,a,r,n)}},df=class{constructor(e){this.spec=e}};function _s(t,e,r,n){return new $n(e.doc,t.unquoted,r,n,t.caseSensitive?void 0:a=>a.toLowerCase(),t.wholeWord?PH(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function PH(t,e){return(r,n,a,s)=>((s>r||s+a.length<n)&&(s=Math.max(0,r-2),a=t.sliceString(s,Math.min(t.length,n+2))),(e(pf(a,r-s))!=Ne.CharCategory.Word||e(gf(a,r-s))!=Ne.CharCategory.Word)&&(e(gf(a,n-s))!=Ne.CharCategory.Word||e(pf(a,n-s))!=Ne.CharCategory.Word))}var sv=class extends df{constructor(e){super(e)}nextMatch(e,r,n){let a=_s(this.spec,e,n,e.doc.length).nextOverlapping();if(a.done){let s=Math.min(e.doc.length,r+this.spec.unquoted.length);a=_s(this.spec,e,0,s).nextOverlapping()}return a.done||a.value.from==r&&a.value.to==n?null:a.value}prevMatchInRange(e,r,n){for(let a=n;;){let s=Math.max(r,a-1e4-this.spec.unquoted.length),o=_s(this.spec,e,s,a),l=null;for(;!o.nextOverlapping().done;)l=o.value;if(l)return l;if(s==r)return null;a-=1e4}}prevMatch(e,r,n){let a=this.prevMatchInRange(e,0,r);return a||(a=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),a&&(a.from!=r||a.to!=n)?a:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,r){let n=_s(this.spec,e,0,e.doc.length),a=[];for(;!n.next().done;){if(a.length>=r)return null;a.push(n.value)}return a}highlight(e,r,n,a){let s=_s(this.spec,e,Math.max(0,r-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)a(s.value.from,s.value.to)}};function xs(t,e,r,n){return new ul(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?RH(e.charCategorizer(e.selection.main.head)):void 0},r,n)}function pf(t,e){return t.slice(Ne.findClusterBreak(t,e,!1),e)}function gf(t,e){return t.slice(e,Ne.findClusterBreak(t,e))}function RH(t){return(e,r,n)=>!n[0].length||(t(pf(n.input,n.index))!=Ne.CharCategory.Word||t(gf(n.input,n.index))!=Ne.CharCategory.Word)&&(t(gf(n.input,n.index+n[0].length))!=Ne.CharCategory.Word||t(pf(n.input,n.index+n[0].length))!=Ne.CharCategory.Word)}var ov=class extends df{nextMatch(e,r,n){let a=xs(this.spec,e,n,e.doc.length).next();return a.done&&(a=xs(this.spec,e,0,r).next()),a.done?null:a.value}prevMatchInRange(e,r,n){for(let a=1;;a++){let s=Math.max(r,n-a*1e4),o=xs(this.spec,e,s,n),l=null;for(;!o.next().done;)l=o.value;if(l&&(s==r||l.from>s+10))return l;if(s==r)return null}}prevMatch(e,r,n){return this.prevMatchInRange(e,0,r)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(r,n)=>{if(n=="&")return e.match[0];if(n=="$")return"$";for(let a=n.length;a>0;a--){let s=+n.slice(0,a);if(s>0&&s<e.match.length)return e.match[s]+n.slice(a)}return r})}matchAll(e,r){let n=xs(this.spec,e,0,e.doc.length),a=[];for(;!n.next().done;){if(a.length>=r)return null;a.push(n.value)}return a}highlight(e,r,n,a){let s=xs(this.spec,e,Math.max(0,r-250),Math.min(n+250,e.doc.length));for(;!s.next().done;)a(s.value.from,s.value.to)}},Es=Ne.StateEffect.define(),hv=Ne.StateEffect.define(),Mn=Ne.StateField.define({create(t){return new ll(vf(t).create(),null)},update(t,e){for(let r of e.effects)r.is(Es)?t=new ll(r.value.create(),t.panel):r.is(hv)&&(t=new ll(t.query,r.value?dv:null));return t},provide:t=>rt.showPanel.from(t,e=>e.panel)});function DH(t){let e=t.field(Mn,!1);return e?e.query.spec:vf(t)}function OH(t){var e;return((e=t.field(Mn,!1))===null||e===void 0?void 0:e.panel)!=null}var ll=class{constructor(e,r){this.query=e,this.panel=r}},IH=rt.Decoration.mark({class:"cm-searchMatch"}),BH=rt.Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"}),LH=rt.ViewPlugin.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(Mn))}update(t){let e=t.state.field(Mn);(e!=t.startState.field(Mn)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return rt.Decoration.none;let{view:r}=this,n=new Ne.RangeSetBuilder;for(let a=0,s=r.visibleRanges,o=s.length;a<o;a++){let{from:l,to:u}=s[a];for(;a<o-1&&u>s[a+1].from-2*250;)u=s[++a].to;t.highlight(r.state,l,u,(c,f)=>{let h=r.state.selection.ranges.some(d=>d.from==c&&d.to==f);n.add(c,f,h?BH:IH)})}return n.finish()}},{decorations:t=>t.decorations});function dl(t){return e=>{let r=e.state.field(Mn,!1);return r&&r.query.spec.valid?t(e,r):pv(e)}}var fl=dl((t,{query:e})=>{let{to:r}=t.state.selection.main,n=e.nextMatch(t.state,r,r);if(!n)return!1;let a=Ne.EditorSelection.single(n.from,n.to),s=t.state.facet(wa);return t.dispatch({selection:a,effects:[vv(t,n),s.scrollToMatch(a.main,t)],userEvent:"select.search"}),FE(t),!0}),hl=dl((t,{query:e})=>{let{state:r}=t,{from:n}=r.selection.main,a=e.prevMatch(r,n,n);if(!a)return!1;let s=Ne.EditorSelection.single(a.from,a.to),o=t.state.facet(wa);return t.dispatch({selection:s,effects:[vv(t,a),o.scrollToMatch(s.main,t)],userEvent:"select.search"}),FE(t),!0}),IE=dl((t,{query:e})=>{let r=e.matchAll(t.state,1e3);return!r||!r.length?!1:(t.dispatch({selection:Ne.EditorSelection.create(r.map(n=>Ne.EditorSelection.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),BE=({state:t,dispatch:e})=>{let r=t.selection;if(r.ranges.length>1||r.main.empty)return!1;let{from:n,to:a}=r.main,s=[],o=0;for(let l=new $n(t.doc,t.sliceDoc(n,a));!l.next().done;){if(s.length>1e3)return!1;l.value.from==n&&(o=s.length),s.push(Ne.EditorSelection.range(l.value.from,l.value.to))}return e(t.update({selection:Ne.EditorSelection.create(s,o),userEvent:"select.search.matches"})),!0},lv=dl((t,{query:e})=>{let{state:r}=t,{from:n,to:a}=r.selection.main;if(r.readOnly)return!1;let s=e.nextMatch(r,n,n);if(!s)return!1;let o=s,l=[],u,c,f=[];if(o.from==n&&o.to==a&&(c=r.toText(e.getReplacement(o)),l.push({from:o.from,to:o.to,insert:c}),o=e.nextMatch(r,o.from,o.to),f.push(rt.EditorView.announce.of(r.phrase("replaced match on line $",r.doc.lineAt(n).number)+"."))),o){let h=l.length==0||l[0].from>=s.to?0:s.to-s.from-c.length;u=Ne.EditorSelection.single(o.from-h,o.to-h),f.push(vv(t,o)),f.push(r.facet(wa).scrollToMatch(u.main,t))}return t.dispatch({changes:l,selection:u,effects:f,userEvent:"input.replace"}),!0}),LE=dl((t,{query:e})=>{if(t.state.readOnly)return!1;let r=e.matchAll(t.state,1e9).map(a=>{let{from:s,to:o}=a;return{from:s,to:o,insert:e.getReplacement(a)}});if(!r.length)return!1;let n=t.state.phrase("replaced $ matches",r.length)+".";return t.dispatch({changes:r,effects:rt.EditorView.announce.of(n),userEvent:"input.replace.all"}),!0});function dv(t){return t.state.facet(wa).createPanel(t)}function vf(t,e){var r,n,a,s,o;let l=t.selection.main,u=l.empty||l.to>l.from+100?"":t.sliceDoc(l.from,l.to);if(e&&!u)return e;let c=t.facet(wa);return new cl({search:((r=e?.literal)!==null&&r!==void 0?r:c.literal)?u:u.replace(/\n/g,"\\n"),caseSensitive:(n=e?.caseSensitive)!==null&&n!==void 0?n:c.caseSensitive,literal:(a=e?.literal)!==null&&a!==void 0?a:c.literal,regexp:(s=e?.regexp)!==null&&s!==void 0?s:c.regexp,wholeWord:(o=e?.wholeWord)!==null&&o!==void 0?o:c.wholeWord})}function NE(t){let e=rt.getPanel(t,dv);return e&&e.dom.querySelector("[main-field]")}function FE(t){let e=NE(t);e&&e==t.root.activeElement&&e.select()}var pv=t=>{let e=t.state.field(Mn,!1);if(e&&e.panel){let r=NE(t);if(r&&r!=t.root.activeElement){let n=vf(t.state,e.query.spec);n.valid&&t.dispatch({effects:Es.of(n)}),r.focus(),r.select()}}else t.dispatch({effects:[hv.of(!0),e?Es.of(vf(t.state,e.query.spec)):Ne.StateEffect.appendConfig.of(cv)]});return!0},gv=t=>{let e=t.state.field(Mn,!1);if(!e||!e.panel)return!1;let r=rt.getPanel(t,dv);return r&&r.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:hv.of(!1)}),!0},NH=[{key:"Mod-f",run:pv,scope:"editor search-panel"},{key:"F3",run:fl,shift:hl,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:fl,shift:hl,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:gv,scope:"editor search-panel"},{key:"Mod-Shift-l",run:BE},{key:"Mod-Alt-g",run:RE},{key:"Mod-d",run:OE,preventDefault:!0}],uv=class{constructor(e){this.view=e;let r=this.query=e.state.field(Mn).query.spec;this.commit=this.commit.bind(this),this.searchField=rr("input",{value:r.search,placeholder:qr(e,"Find"),"aria-label":qr(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=rr("input",{value:r.replace,placeholder:qr(e,"Replace"),"aria-label":qr(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=rr("input",{type:"checkbox",name:"case",form:"",checked:r.caseSensitive,onchange:this.commit}),this.reField=rr("input",{type:"checkbox",name:"re",form:"",checked:r.regexp,onchange:this.commit}),this.wordField=rr("input",{type:"checkbox",name:"word",form:"",checked:r.wholeWord,onchange:this.commit});function n(a,s,o){return rr("button",{class:"cm-button",name:a,onclick:s,type:"button"},o)}this.dom=rr("div",{onkeydown:a=>this.keydown(a),class:"cm-search"},[this.searchField,n("next",()=>fl(e),[qr(e,"next")]),n("prev",()=>hl(e),[qr(e,"previous")]),n("select",()=>IE(e),[qr(e,"all")]),rr("label",null,[this.caseField,qr(e,"match case")]),rr("label",null,[this.reField,qr(e,"regexp")]),rr("label",null,[this.wordField,qr(e,"by word")]),...e.state.readOnly?[]:[rr("br"),this.replaceField,n("replace",()=>lv(e),[qr(e,"replace")]),n("replaceAll",()=>LE(e),[qr(e,"replace all")])],rr("button",{name:"close",onclick:()=>gv(e),"aria-label":qr(e,"close"),type:"button"},["\xD7"])])}commit(){let e=new cl({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Es.of(e)}))}keydown(e){rt.runScopeHandlers(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?hl:fl)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),lv(this.view))}update(e){for(let r of e.transactions)for(let n of r.effects)n.is(Es)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(wa).top}};function qr(t,e){return t.state.phrase(e)}var lf=30,uf=/[\s\.,:;?!]/;function vv(t,{from:e,to:r}){let n=t.state.doc.lineAt(e),a=t.state.doc.lineAt(r).to,s=Math.max(n.from,e-lf),o=Math.min(a,r+lf),l=t.state.sliceDoc(s,o);if(s!=n.from){for(let u=0;u<lf;u++)if(!uf.test(l[u+1])&&uf.test(l[u])){l=l.slice(u);break}}if(o!=a){for(let u=l.length-1;u>l.length-lf;u--)if(!uf.test(l[u-1])&&uf.test(l[u])){l=l.slice(0,u);break}}return rt.EditorView.announce.of(`${t.state.phrase("current match")}. ${l} ${t.state.phrase("on line")} ${n.number}.`)}var FH=rt.EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),cv=[Mn,Ne.Prec.low(LH),FH];Lt.RegExpCursor=ul;Lt.SearchCursor=$n;Lt.SearchQuery=cl;Lt.closeSearchPanel=gv;Lt.findNext=fl;Lt.findPrevious=hl;Lt.getSearchQuery=DH;Lt.gotoLine=RE;Lt.highlightSelectionMatches=_H;Lt.openSearchPanel=pv;Lt.replaceAll=LE;Lt.replaceNext=lv;Lt.search=MH;Lt.searchKeymap=NH;Lt.searchPanelOpen=OH;Lt.selectMatches=IE;Lt.selectNextOccurrence=OE;Lt.selectSelectionMatches=BE;Lt.setSearchQuery=Es});var mS=O(nt=>{"use strict";var me=gi(),Pt=xi(),Cs=Gc(),gl=class{constructor(e,r,n,a){this.state=e,this.pos=r,this.explicit=n,this.view=a,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let r=Cs.syntaxTree(this.state).resolveInner(this.pos,-1);for(;r&&e.indexOf(r.name)<0;)r=r.parent;return r?{from:r.from,to:this.pos,text:this.state.sliceDoc(r.from,this.pos),type:r.type}:null}matchBefore(e){let r=this.state.doc.lineAt(this.pos),n=Math.max(r.from,this.pos-250),a=r.text.slice(n-r.from,this.pos-r.from),s=a.search(QE(e,!1));return s<0?null:{from:n+s,to:this.pos,text:a.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,r,n){e=="abort"&&this.abortListeners&&(this.abortListeners.push(r),n&&n.onDocChange&&(this.abortOnDocChange=!0))}};function VE(t){let e=Object.keys(t).join(""),r=/\w/.test(e);return r&&(e=e.replace(/\w/g,"")),`[${r?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function qH(t){let e=Object.create(null),r=Object.create(null);for(let{label:a}of t){e[a[0]]=!0;for(let s=1;s<a.length;s++)r[a[s]]=!0}let n=VE(e)+VE(r)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function $E(t){let e=t.map(a=>typeof a=="string"?{label:a}:a),[r,n]=e.every(a=>/^\w+$/.test(a.label))?[/\w*$/,/\w+$/]:qH(e);return a=>{let s=a.matchBefore(n);return s||a.explicit?{from:s?s.from:a.pos,options:e,validFor:r}:null}}function VH(t,e){return r=>{for(let n=Cs.syntaxTree(r.state).resolveInner(r.pos,-1);n;n=n.parent){if(t.indexOf(n.name)>-1)return e(r);if(n.type.isTop)break}return null}}function zH(t,e){return r=>{for(let n=Cs.syntaxTree(r.state).resolveInner(r.pos,-1);n;n=n.parent){if(t.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return e(r)}}var mf=class{constructor(e,r,n,a){this.completion=e,this.source=r,this.match=n,this.score=a}};function xa(t){return t.selection.main.from}function QE(t,e){var r;let{source:n}=t,a=e&&n[0]!="^",s=n[n.length-1]!="$";return!a&&!s?t:new RegExp(`${a?"^":""}(?:${n})${s?"$":""}`,(r=t.flags)!==null&&r!==void 0?r:t.ignoreCase?"i":"")}var wf=me.Annotation.define();function JE(t,e,r,n){let{main:a}=t.selection,s=r-a.from,o=n-a.from;return Object.assign(Object.assign({},t.changeByRange(l=>{if(l!=a&&r!=n&&t.sliceDoc(l.from+s,l.from+o)!=t.sliceDoc(r,n))return{range:l};let u=t.toText(e);return{changes:{from:l.from+s,to:n==a.from?l.to:l.from+o,insert:u},range:me.EditorSelection.cursor(l.from+s+u.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}var zE=new WeakMap;function HH(t){if(!Array.isArray(t))return t;let e=zE.get(t);return e||zE.set(t,e=$E(t)),e}var yf=me.StateEffect.define(),vl=me.StateEffect.define(),bv=class{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let r=0;r<e.length;){let n=me.codePointAt(e,r),a=me.codePointSize(n);this.chars.push(n);let s=e.slice(r,r+a),o=s.toUpperCase();this.folded.push(me.codePointAt(o==s?s.toLowerCase():o,0)),r+=a}this.astral=e.length!=this.chars.length}ret(e,r){return this.score=e,this.matched=r,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:r,folded:n,any:a,precise:s,byWord:o}=this;if(r.length==1){let b=me.codePointAt(e,0),w=me.codePointSize(b),_=w==e.length?0:-100;if(b!=r[0])if(b==n[0])_+=-200;else return null;return this.ret(_,[0,w])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let u=r.length,c=0;if(l<0){for(let b=0,w=Math.min(e.length,200);b<w&&c<u;){let _=me.codePointAt(e,b);(_==r[c]||_==n[c])&&(a[c++]=b),b+=me.codePointSize(_)}if(c<u)return null}let f=0,h=0,d=!1,p=0,g=-1,m=-1,v=/[a-z]/.test(e),y=!0;for(let b=0,w=Math.min(e.length,200),_=0;b<w&&h<u;){let x=me.codePointAt(e,b);l<0&&(f<u&&x==r[f]&&(s[f++]=b),p<u&&(x==r[p]||x==n[p]?(p==0&&(g=b),m=b+1,p++):p=0));let S,E=x<255?x>=48&&x<=57||x>=97&&x<=122?2:x>=65&&x<=90?1:0:(S=me.fromCodePoint(x))!=S.toLowerCase()?1:S!=S.toUpperCase()?2:0;(!b||E==1&&v||_==0&&E!=0)&&(r[h]==x||n[h]==x&&(d=!0)?o[h++]=b:o.length&&(y=!1)),_=E,b+=me.codePointSize(x)}return h==u&&o[0]==0&&y?this.result(-100+(d?-200:0),o,e):p==u&&g==0?this.ret(-200-e.length+(m==e.length?0:-100),[0,m]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):p==u?this.ret(-900-e.length,[g,m]):h==u?this.result(-100+(d?-200:0)+-700+(y?0:-1100),o,e):r.length==2?null:this.result((a[0]?-700:0)+-200+-1100,a,e)}result(e,r,n){let a=[],s=0;for(let o of r){let l=o+(this.astral?me.codePointSize(me.codePointAt(n,o)):1);s&&a[s-1]==o?a[s-1]=l:(a[s++]=o,a[s++]=l)}return this.ret(e-n.length,a)}},wv=class{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let r=e.slice(0,this.pattern.length),n=r==this.pattern?0:r.toLowerCase()==this.folded?-200:null;return n==null?null:(this.matched=[0,r.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}},jt=me.Facet.define({combine(t){return me.combineConfig(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:UH,filterStrict:!1,compareCompletions:(e,r)=>e.label.localeCompare(r.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,r)=>e&&r,closeOnBlur:(e,r)=>e&&r,icons:(e,r)=>e&&r,tooltipClass:(e,r)=>n=>HE(e(n),r(n)),optionClass:(e,r)=>n=>HE(e(n),r(n)),addToOptions:(e,r)=>e.concat(r),filterStrict:(e,r)=>e||r})}});function HE(t,e){return t?e?t+" "+e:t:e}function UH(t,e,r,n,a,s){let o=t.textDirection==Pt.Direction.RTL,l=o,u=!1,c="top",f,h,d=e.left-a.left,p=a.right-e.right,g=n.right-n.left,m=n.bottom-n.top;if(l&&d<Math.min(g,p)?l=!1:!l&&p<Math.min(g,d)&&(l=!0),g<=(l?d:p))f=Math.max(a.top,Math.min(r.top,a.bottom-m))-e.top,h=Math.min(400,l?d:p);else{u=!0,h=Math.min(400,(o?e.right:a.right-e.left)-30);let b=a.bottom-e.bottom;b>=m||b>e.top?f=r.bottom-e.top:(c="bottom",f=e.bottom-r.top)}let v=(e.bottom-e.top)/s.offsetHeight,y=(e.right-e.left)/s.offsetWidth;return{style:`${c}: ${f/v}px; max-width: ${h/y}px`,class:"cm-completionInfo-"+(u?o?"left-narrow":"right-narrow":l?"left":"right")}}function WH(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(r){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),r.type&&n.classList.add(...r.type.split(/\s+/g).map(a=>"cm-completionIcon-"+a)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(r,n,a,s){let o=document.createElement("span");o.className="cm-completionLabel";let l=r.displayLabel||r.label,u=0;for(let c=0;c<s.length;){let f=s[c++],h=s[c++];f>u&&o.appendChild(document.createTextNode(l.slice(u,f)));let d=o.appendChild(document.createElement("span"));d.appendChild(document.createTextNode(l.slice(f,h))),d.className="cm-completionMatchedText",u=h}return u<l.length&&o.appendChild(document.createTextNode(l.slice(u))),o},position:50},{render(r){if(!r.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=r.detail,n},position:80}),e.sort((r,n)=>r.position-n.position).map(r=>r.render)}function mv(t,e,r){if(t<=r)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let a=Math.floor(e/r);return{from:a*r,to:(a+1)*r}}let n=Math.floor((t-e)/r);return{from:t-(n+1)*r,to:t-n*r}}var _v=class{constructor(e,r,n){this.view=e,this.stateField=r,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:u=>this.placeInfo(u),key:this},this.space=null,this.currentClass="";let a=e.state.field(r),{options:s,selected:o}=a.open,l=e.state.facet(jt);this.optionContent=WH(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=mv(s.length,o,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",u=>{let{options:c}=e.state.field(r).open;for(let f=u.target,h;f&&f!=this.dom;f=f.parentNode)if(f.nodeName=="LI"&&(h=/-(\d+)$/.exec(f.id))&&+h[1]<c.length){this.applyCompletion(e,c[+h[1]]),u.preventDefault();return}}),this.dom.addEventListener("focusout",u=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(jt).closeOnBlur&&u.relatedTarget!=e.contentDOM&&e.dispatch({effects:vl.of(null)})}),this.showOptions(s,a.id)}mount(){this.updateSel()}showOptions(e,r){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,r,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var r;let n=e.state.field(this.stateField),a=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=a){let{options:s,selected:o,disabled:l}=n.open;(!a.open||a.open.options!=s)&&(this.range=mv(s.length,o,e.state.facet(jt).maxRenderedOptions),this.showOptions(s,n.id)),this.updateSel(),l!=((r=a.open)===null||r===void 0?void 0:r.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let r=this.tooltipClass(e);if(r!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of r.split(" "))n&&this.dom.classList.add(n);this.currentClass=r}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),r=e.open;if((r.selected>-1&&r.selected<this.range.from||r.selected>=this.range.to)&&(this.range=mv(r.options.length,r.selected,this.view.state.facet(jt).maxRenderedOptions),this.showOptions(r.options,e.id)),this.updateSelectedOption(r.selected)){this.destroyInfo();let{completion:n}=r.options[r.selected],{info:a}=n;if(!a)return;let s=typeof a=="string"?document.createTextNode(a):a(n);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,n)}).catch(o=>Pt.logException(this.view.state,o,"completion info")):this.addInfoPane(s,n)}}addInfoPane(e,r){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",e.nodeType!=null)n.appendChild(e),this.infoDestroy=null;else{let{dom:a,destroy:s}=e;n.appendChild(a),this.infoDestroy=s||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let r=null;for(let n=this.list.firstChild,a=this.range.from;n;n=n.nextSibling,a++)n.nodeName!="LI"||!n.id?a--:a==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),r=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return r&&KH(this.list,r),r}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let r=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),a=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.documentElement;s={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return a.top>Math.min(s.bottom,r.bottom)-10||a.bottom<Math.max(s.top,r.top)+10?null:this.view.state.facet(jt).positionInfo(this.view,r,a,n,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,r,n){let a=document.createElement("ul");a.id=r,a.setAttribute("role","listbox"),a.setAttribute("aria-expanded","true"),a.setAttribute("aria-label",this.view.state.phrase("Completions")),a.addEventListener("mousedown",o=>{o.target==a&&o.preventDefault()});let s=null;for(let o=n.from;o<n.to;o++){let{completion:l,match:u}=e[o],{section:c}=l;if(c){let d=typeof c=="string"?c:c.name;if(d!=s&&(o>n.from||n.from==0))if(s=d,typeof c!="string"&&c.header)a.appendChild(c.header(c));else{let p=a.appendChild(document.createElement("completion-section"));p.textContent=d}}let f=a.appendChild(document.createElement("li"));f.id=r+"-"+o,f.setAttribute("role","option");let h=this.optionClass(l);h&&(f.className=h);for(let d of this.optionContent){let p=d(l,this.view.state,this.view,u);p&&f.appendChild(p)}}return n.from&&a.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&a.classList.add("cm-completionListIncompleteBottom"),a}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}};function GH(t,e){return r=>new _v(r,t,e)}function KH(t,e){let r=t.getBoundingClientRect(),n=e.getBoundingClientRect(),a=r.height/t.offsetHeight;n.top<r.top?t.scrollTop-=(r.top-n.top)/a:n.bottom>r.bottom&&(t.scrollTop+=(n.bottom-r.bottom)/a)}function UE(t){return(t.boost||0)*100+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function jH(t,e){let r=[],n=null,a=c=>{r.push(c);let{section:f}=c.completion;if(f){n||(n=[]);let h=typeof f=="string"?f:f.name;n.some(d=>d.name==h)||n.push(typeof f=="string"?{name:h}:f)}},s=e.facet(jt);for(let c of t)if(c.hasResult()){let f=c.result.getMatch;if(c.result.filter===!1)for(let h of c.result.options)a(new mf(h,c.source,f?f(h):[],1e9-r.length));else{let h=e.sliceDoc(c.from,c.to),d,p=s.filterStrict?new wv(h):new bv(h);for(let g of c.result.options)if(d=p.match(g.label)){let m=g.displayLabel?f?f(g,d.matched):[]:d.matched;a(new mf(g,c.source,m,d.score+(g.boost||0)))}}}if(n){let c=Object.create(null),f=0,h=(d,p)=>{var g,m;return((g=d.rank)!==null&&g!==void 0?g:1e9)-((m=p.rank)!==null&&m!==void 0?m:1e9)||(d.name<p.name?-1:1)};for(let d of n.sort(h))f-=1e5,c[d.name]=f;for(let d of r){let{section:p}=d.completion;p&&(d.score+=c[typeof p=="string"?p:p.name])}}let o=[],l=null,u=s.compareCompletions;for(let c of r.sort((f,h)=>h.score-f.score||u(f.completion,h.completion))){let f=c.completion;!l||l.label!=f.label||l.detail!=f.detail||l.type!=null&&f.type!=null&&l.type!=f.type||l.apply!=f.apply||l.boost!=f.boost?o.push(c):UE(c.completion)>UE(l)&&(o[o.length-1]=c),l=c.completion}return o}var xv=class t{constructor(e,r,n,a,s,o){this.options=e,this.attrs=r,this.tooltip=n,this.timestamp=a,this.selected=s,this.disabled=o}setSelected(e,r){return e==this.selected||e>=this.options.length?this:new t(this.options,WE(r,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,r,n,a,s,o){if(a&&!o&&e.some(c=>c.isPending))return a.setDisabled();let l=jH(e,r);if(!l.length)return a&&e.some(c=>c.isPending)?a.setDisabled():null;let u=r.facet(jt).selectOnOpen?0:-1;if(a&&a.selected!=u&&a.selected!=-1){let c=a.options[a.selected].completion;for(let f=0;f<l.length;f++)if(l[f].completion==c){u=f;break}}return new t(l,WE(n,u),{pos:e.reduce((c,f)=>f.hasResult()?Math.min(c,f.from):c,1e8),create:JH,above:s.aboveCursor},a?a.timestamp:Date.now(),u,!1)}map(e){return new t(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new t(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}},Ev=class t{constructor(e,r,n){this.active=e,this.id=r,this.open=n}static start(){return new t($H,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:r}=e,n=r.facet(jt),s=(n.override||r.languageDataAt("autocomplete",xa(r)).map(HH)).map(u=>(this.active.find(f=>f.source==u)||new Qn(u,this.active.some(f=>f.state!=0)?1:0)).update(e,n));s.length==this.active.length&&s.every((u,c)=>u==this.active[c])&&(s=this.active);let o=this.open,l=e.effects.some(u=>u.is(Pv));o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(u=>u.hasResult()&&e.changes.touchesRange(u.from,u.to))||!YH(s,this.active)||l?o=xv.build(s,r,this.id,o,n,l):o&&o.disabled&&!s.some(u=>u.isPending)&&(o=null),!o&&s.every(u=>!u.isPending)&&s.some(u=>u.hasResult())&&(s=s.map(u=>u.hasResult()?new Qn(u.source,0):u));for(let u of e.effects)u.is(Rv)&&(o=o&&o.setSelected(u.value,this.id));return s==this.active&&o==this.open?this:new t(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?ZH:XH}};function YH(t,e){if(t==e)return!0;for(let r=0,n=0;;){for(;r<t.length&&!t[r].hasResult();)r++;for(;n<e.length&&!e[n].hasResult();)n++;let a=r==t.length,s=n==e.length;if(a||s)return a==s;if(t[r++].result!=e[n++].result)return!1}}var ZH={"aria-autocomplete":"list"},XH={};function WE(t,e){let r={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(r["aria-activedescendant"]=t+"-"+e),r}var $H=[];function eS(t,e){if(t.isUserEvent("input.complete")){let n=t.annotation(wf);if(n&&e.activateOnCompletion(n))return 12}let r=t.isUserEvent("input.type");return r&&e.activateOnTyping?5:r?1:t.isUserEvent("delete.backward")?2:t.selection?8:t.docChanged?16:0}var Qn=class t{constructor(e,r,n=!1){this.source=e,this.state=r,this.explicit=n}hasResult(){return!1}get isPending(){return this.state==1}update(e,r){let n=eS(e,r),a=this;(n&8||n&16&&this.touches(e))&&(a=new t(a.source,0)),n&4&&a.state==0&&(a=new t(this.source,1)),a=a.updateFor(e,n);for(let s of e.effects)if(s.is(yf))a=new t(a.source,1,s.value);else if(s.is(vl))a=new t(a.source,0);else if(s.is(Pv))for(let o of s.value)o.source==a.source&&(a=o);return a}updateFor(e,r){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(xa(e.state))}},bf=class t extends Qn{constructor(e,r,n,a,s,o){super(e,3,r),this.limit=n,this.result=a,this.from=s,this.to=o}hasResult(){return!0}updateFor(e,r){var n;if(!(r&3))return this.map(e.changes);let a=this.result;a.map&&!e.changes.empty&&(a=a.map(a,e.changes));let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),l=xa(e.state);if(l>o||!a||r&2&&(xa(e.startState)==this.from||l<this.limit))return new Qn(this.source,r&4?1:0);let u=e.changes.mapPos(this.limit);return QH(a.validFor,e.state,s,o)?new t(this.source,this.explicit,u,a,s,o):a.update&&(a=a.update(a,s,o,new gl(e.state,l,!1)))?new t(this.source,this.explicit,u,a,a.from,(n=a.to)!==null&&n!==void 0?n:xa(e.state)):new Qn(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new t(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new Qn(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}};function QH(t,e,r,n){if(!t)return!1;let a=e.sliceDoc(r,n);return typeof t=="function"?t(a,r,n,e):QE(t,!0).test(a)}var Pv=me.StateEffect.define({map(t,e){return t.map(r=>r.map(e))}}),Rv=me.StateEffect.define(),Kt=me.StateField.define({create(){return Ev.start()},update(t,e){return t.update(e)},provide:t=>[Pt.showTooltip.from(t,e=>e.tooltip),Pt.EditorView.contentAttributes.from(t,e=>e.attrs)]});function Dv(t,e){let r=e.completion.apply||e.completion.label,n=t.state.field(Kt).active.find(a=>a.source==e.source);return n instanceof bf?(typeof r=="string"?t.dispatch(Object.assign(Object.assign({},JE(t.state,r,n.from,n.to)),{annotations:wf.of(e.completion)})):r(t,e.completion,n.from,n.to),!0):!1}var JH=GH(Kt,Dv);function pl(t,e="option"){return r=>{let n=r.state.field(Kt,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<r.state.facet(jt).interactionDelay)return!1;let a=1,s;e=="page"&&(s=Pt.getTooltip(r,n.open.tooltip))&&(a=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=n.open.options,l=n.open.selected>-1?n.open.selected+a*(t?1:-1):t?0:o-1;return l<0?l=e=="page"?0:o-1:l>=o&&(l=e=="page"?o-1:0),r.dispatch({effects:Rv.of(l)}),!0}}var tS=t=>{let e=t.state.field(Kt,!1);return t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(jt).interactionDelay?!1:Dv(t,e.open.options[e.open.selected])},Sv=t=>t.state.field(Kt,!1)?(t.dispatch({effects:yf.of(!0)}),!0):!1,rS=t=>{let e=t.state.field(Kt,!1);return!e||!e.active.some(r=>r.state!=0)?!1:(t.dispatch({effects:vl.of(null)}),!0)},Cv=class{constructor(e,r){this.active=e,this.context=r,this.time=Date.now(),this.updates=[],this.done=void 0}},e4=50,t4=1e3,r4=Pt.ViewPlugin.fromClass(class{constructor(t){this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of t.state.field(Kt).active)e.isPending&&this.startQuery(e)}update(t){let e=t.state.field(Kt),r=t.state.facet(jt);if(!t.selectionSet&&!t.docChanged&&t.startState.field(Kt)==e)return;let n=t.transactions.some(s=>{let o=eS(s,r);return o&8||(s.selection||s.docChanged)&&!(o&3)});for(let s=0;s<this.running.length;s++){let o=this.running[s];if(n||o.context.abortOnDocChange&&t.docChanged||o.updates.length+t.transactions.length>e4&&Date.now()-o.time>t4){for(let l of o.context.abortListeners)try{l()}catch(u){Pt.logException(this.view.state,u)}o.context.abortListeners=null,this.running.splice(s--,1)}else o.updates.push(...t.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),t.transactions.some(s=>s.effects.some(o=>o.is(yf)))&&(this.pendingStart=!0);let a=this.pendingStart?50:r.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(s=>s.isPending&&!this.running.some(o=>o.active.source==s.source))?setTimeout(()=>this.startUpdate(),a):-1,this.composing!=0)for(let s of t.transactions)s.isUserEvent("input.type")?this.composing=2:this.composing==2&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:t}=this.view,e=t.field(Kt);for(let r of e.active)r.isPending&&!this.running.some(n=>n.active.source==r.source)&&this.startQuery(r);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(jt).updateSyncTime))}startQuery(t){let{state:e}=this.view,r=xa(e),n=new gl(e,r,t.explicit,this.view),a=new Cv(t,n);this.running.push(a),Promise.resolve(t.source(n)).then(s=>{a.context.aborted||(a.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:vl.of(null)}),Pt.logException(this.view.state,s)})}scheduleAccept(){this.running.every(t=>t.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(jt).updateSyncTime))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],r=this.view.state.facet(jt),n=this.view.state.field(Kt);for(let a=0;a<this.running.length;a++){let s=this.running[a];if(s.done===void 0)continue;if(this.running.splice(a--,1),s.done){let l=xa(s.updates.length?s.updates[0].startState:this.view.state),u=Math.min(l,s.done.from+(s.active.explicit?0:1)),c=new bf(s.active.source,s.active.explicit,u,s.done,s.done.from,(t=s.done.to)!==null&&t!==void 0?t:l);for(let f of s.updates)c=c.update(f,r);if(c.hasResult()){e.push(c);continue}}let o=n.active.find(l=>l.source==s.active.source);if(o&&o.isPending)if(s.done==null){let l=new Qn(s.active.source,0);for(let u of s.updates)l=l.update(u,r);l.isPending||e.push(l)}else this.startQuery(o)}(e.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:Pv.of(e)})}},{eventHandlers:{blur(t){let e=this.view.state.field(Kt,!1);if(e&&e.tooltip&&this.view.state.facet(jt).closeOnBlur){let r=e.open&&Pt.getTooltip(this.view,e.open.tooltip);(!r||!r.dom.contains(t.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:vl.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:yf.of(!1)}),20),this.composing=0}}}),n4=typeof navigator=="object"&&/Win/.test(navigator.platform),i4=me.Prec.highest(Pt.EditorView.domEventHandlers({keydown(t,e){let r=e.state.field(Kt,!1);if(!r||!r.open||r.open.disabled||r.open.selected<0||t.key.length>1||t.ctrlKey&&!(n4&&t.altKey)||t.metaKey)return!1;let n=r.open.options[r.open.selected],a=r.active.find(o=>o.source==n.source),s=n.completion.commitCharacters||a.result.commitCharacters;return s&&s.indexOf(t.key)>-1&&Dv(e,n),!1}})),nS=Pt.EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Tv=class{constructor(e,r,n,a){this.field=e,this.line=r,this.from=n,this.to=a}},kv=class t{constructor(e,r,n){this.field=e,this.from=r,this.to=n}map(e){let r=e.mapPos(this.from,-1,me.MapMode.TrackDel),n=e.mapPos(this.to,1,me.MapMode.TrackDel);return r==null||n==null?null:new t(this.field,r,n)}},Av=class t{constructor(e,r){this.lines=e,this.fieldPositions=r}instantiate(e,r){let n=[],a=[r],s=e.doc.lineAt(r),o=/^\s*/.exec(s.text)[0];for(let u of this.lines){if(n.length){let c=o,f=/^\t*/.exec(u)[0].length;for(let h=0;h<f;h++)c+=e.facet(Cs.indentUnit);a.push(r+c.length-f),u=c+u.slice(f)}n.push(u),r+=u.length+1}let l=this.fieldPositions.map(u=>new kv(u.field,a[u.line]+u.from,a[u.line]+u.to));return{text:n,ranges:l}}static parse(e){let r=[],n=[],a=[],s;for(let o of e.split(/\r\n?|\n/)){for(;s=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(o);){let l=s[1]?+s[1]:null,u=s[2]||s[3]||"",c=-1,f=u.replace(/\\[{}]/g,h=>h[1]);for(let h=0;h<r.length;h++)(l!=null?r[h].seq==l:f&&r[h].name==f)&&(c=h);if(c<0){let h=0;for(;h<r.length&&(l==null||r[h].seq!=null&&r[h].seq<l);)h++;r.splice(h,0,{seq:l,name:f}),c=h;for(let d of a)d.field>=c&&d.field++}a.push(new Tv(c,n.length,s.index,s.index+f.length)),o=o.slice(0,s.index)+u+o.slice(s.index+s[0].length)}o=o.replace(/\\([{}])/g,(l,u,c)=>{for(let f of a)f.line==n.length&&f.from>c&&(f.from--,f.to--);return u}),n.push(o)}return new t(n,a)}},a4=Pt.Decoration.widget({widget:new class extends Pt.WidgetType{toDOM(){let t=document.createElement("span");return t.className="cm-snippetFieldPosition",t}ignoreEvent(){return!1}}}),s4=Pt.Decoration.mark({class:"cm-snippetField"}),Ss=class t{constructor(e,r){this.ranges=e,this.active=r,this.deco=Pt.Decoration.set(e.map(n=>(n.from==n.to?a4:s4).range(n.from,n.to)))}map(e){let r=[];for(let n of this.ranges){let a=n.map(e);if(!a)return null;r.push(a)}return new t(r,this.active)}selectionInsideField(e){return e.ranges.every(r=>this.ranges.some(n=>n.field==this.active&&n.from<=r.from&&n.to>=r.to))}},yl=me.StateEffect.define({map(t,e){return t&&t.map(e)}}),o4=me.StateEffect.define(),Ea=me.StateField.define({create(){return null},update(t,e){for(let r of e.effects){if(r.is(yl))return r.value;if(r.is(o4)&&t)return new Ss(t.ranges,r.value)}return t&&e.docChanged&&(t=t.map(e.changes)),t&&e.selection&&!t.selectionInsideField(e.selection)&&(t=null),t},provide:t=>Pt.EditorView.decorations.from(t,e=>e?e.deco:Pt.Decoration.none)});function Ov(t,e){return me.EditorSelection.create(t.filter(r=>r.field==e).map(r=>me.EditorSelection.range(r.from,r.to)))}function iS(t){let e=Av.parse(t);return(r,n,a,s)=>{let{text:o,ranges:l}=e.instantiate(r.state,a),{main:u}=r.state.selection,c={changes:{from:a,to:s==u.from?u.to:s,insert:me.Text.of(o)},scrollIntoView:!0,annotations:n?[wf.of(n),me.Transaction.userEvent.of("input.complete")]:void 0};if(l.length&&(c.selection=Ov(l,0)),l.some(f=>f.field>0)){let f=new Ss(l,0),h=c.effects=[yl.of(f)];r.state.field(Ea,!1)===void 0&&h.push(me.StateEffect.appendConfig.of([Ea,f4,d4,nS]))}r.dispatch(r.state.update(c))}}function aS(t){return({state:e,dispatch:r})=>{let n=e.field(Ea,!1);if(!n||t<0&&n.active==0)return!1;let a=n.active+t,s=t>0&&!n.ranges.some(o=>o.field==a+t);return r(e.update({selection:Ov(n.ranges,a),effects:yl.of(s?null:new Ss(n.ranges,a)),scrollIntoView:!0})),!0}}var sS=({state:t,dispatch:e})=>t.field(Ea,!1)?(e(t.update({effects:yl.of(null)})),!0):!1,oS=aS(1),lS=aS(-1);function l4(t){let e=t.field(Ea,!1);return!!(e&&e.ranges.some(r=>r.field==e.active+1))}function u4(t){let e=t.field(Ea,!1);return!!(e&&e.active>0)}var c4=[{key:"Tab",run:oS,shift:lS},{key:"Escape",run:sS}],Mv=me.Facet.define({combine(t){return t.length?t[0]:c4}}),f4=me.Prec.highest(Pt.keymap.compute([Mv],t=>t.facet(Mv)));function h4(t,e){return Object.assign(Object.assign({},e),{apply:iS(t)})}var d4=Pt.EditorView.domEventHandlers({mousedown(t,e){let r=e.state.field(Ea,!1),n;if(!r||(n=e.posAtCoords({x:t.clientX,y:t.clientY}))==null)return!1;let a=r.ranges.find(s=>s.from<=n&&s.to>=n);return!a||a.field==r.active?!1:(e.dispatch({selection:Ov(r.ranges,a.field),effects:yl.of(r.ranges.some(s=>s.field>a.field)?new Ss(r.ranges,a.field):null),scrollIntoView:!0}),!0)}});function p4(t){let e=t.replace(/[\]\-\\]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${e}]+`,"ug")}catch{return new RegExp(`[w${e}]`,"g")}}function GE(t,e){return new RegExp(e(t.source),t.unicode?"u":"")}var KE=Object.create(null);function g4(t){return KE[t]||(KE[t]=new WeakMap)}function jE(t,e,r,n,a){for(let s=t.iterLines(),o=0;!s.next().done;){let{value:l}=s,u;for(e.lastIndex=0;u=e.exec(l);)if(!n[u[0]]&&o+u.index!=a&&(r.push({type:"text",label:u[0]}),n[u[0]]=!0,r.length>=2e3))return;o+=l.length+1}}function uS(t,e,r,n,a){let s=t.length>=1e3,o=s&&e.get(t);if(o)return o;let l=[],u=Object.create(null);if(t.children){let c=0;for(let f of t.children){if(f.length>=1e3)for(let h of uS(f,e,r,n-c,a-c))u[h.label]||(u[h.label]=!0,l.push(h));else jE(f,r,l,u,a-c);c+=f.length+1}}else jE(t,r,l,u,a);return s&&l.length<2e3&&e.set(t,l),l}var v4=t=>{let e=t.state.languageDataAt("wordChars",t.pos).join(""),r=p4(e),n=t.matchBefore(GE(r,o=>o+"$"));if(!n&&!t.explicit)return null;let a=n?n.from:t.pos,s=uS(t.state.doc,g4(e),r,5e4,a);return{from:a,options:s,validFor:GE(r,o=>"^"+o)}},ml={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},_a=me.StateEffect.define({map(t,e){let r=e.mapPos(t,-1,me.MapMode.TrackAfter);return r??void 0}}),Iv=new class extends me.RangeValue{};Iv.startSide=1;Iv.endSide=-1;var cS=me.StateField.define({create(){return me.RangeSet.empty},update(t,e){if(t=t.map(e.changes),e.selection){let r=e.state.doc.lineAt(e.selection.main.head);t=t.update({filter:n=>n>=r.from&&n<=r.to})}for(let r of e.effects)r.is(_a)&&(t=t.update({add:[Iv.range(r.value,r.value+1)]}));return t}});function m4(){return[b4,cS]}var yv="()[]{}<>\xAB\xBB\xBB\xAB\uFF3B\uFF3D\uFF5B\uFF5D";function fS(t){for(let e=0;e<yv.length;e+=2)if(yv.charCodeAt(e)==t)return yv.charAt(e+1);return me.fromCodePoint(t<128?t:t+1)}function hS(t,e){return t.languageDataAt("closeBrackets",e)[0]||ml}var y4=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),b4=Pt.EditorView.inputHandler.of((t,e,r,n)=>{if((y4?t.composing:t.compositionStarted)||t.state.readOnly)return!1;let a=t.state.selection.main;if(n.length>2||n.length==2&&me.codePointSize(me.codePointAt(n,0))==1||e!=a.from||r!=a.to)return!1;let s=pS(t.state,n);return s?(t.dispatch(s),!0):!1}),dS=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=hS(t,t.selection.main.head).brackets||ml.brackets,a=null,s=t.changeByRange(o=>{if(o.empty){let l=_4(t.doc,o.head);for(let u of n)if(u==l&&_f(t.doc,o.head)==fS(me.codePointAt(u,0)))return{changes:{from:o.head-u.length,to:o.head+u.length},range:me.EditorSelection.cursor(o.head-u.length)}}return{range:a=o}});return a||e(t.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!a},w4=[{key:"Backspace",run:dS}];function pS(t,e){let r=hS(t,t.selection.main.head),n=r.brackets||ml.brackets;for(let a of n){let s=fS(me.codePointAt(a,0));if(e==a)return s==a?S4(t,a,n.indexOf(a+a+a)>-1,r):x4(t,a,s,r.before||ml.before);if(e==s&&gS(t,t.selection.main.from))return E4(t,a,s)}return null}function gS(t,e){let r=!1;return t.field(cS).between(0,t.doc.length,n=>{n==e&&(r=!0)}),r}function _f(t,e){let r=t.sliceString(e,e+2);return r.slice(0,me.codePointSize(me.codePointAt(r,0)))}function _4(t,e){let r=t.sliceString(e-2,e);return me.codePointSize(me.codePointAt(r,0))==r.length?r:r.slice(1)}function x4(t,e,r,n){let a=null,s=t.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:r,from:o.to}],effects:_a.of(o.to+e.length),range:me.EditorSelection.range(o.anchor+e.length,o.head+e.length)};let l=_f(t.doc,o.head);return!l||/\s/.test(l)||n.indexOf(l)>-1?{changes:{insert:e+r,from:o.head},effects:_a.of(o.head+e.length),range:me.EditorSelection.cursor(o.head+e.length)}:{range:a=o}});return a?null:t.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function E4(t,e,r){let n=null,a=t.changeByRange(s=>s.empty&&_f(t.doc,s.head)==r?{changes:{from:s.head,to:s.head+r.length,insert:r},range:me.EditorSelection.cursor(s.head+r.length)}:n={range:s});return n?null:t.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function S4(t,e,r,n){let a=n.stringPrefixes||ml.stringPrefixes,s=null,o=t.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:_a.of(l.to+e.length),range:me.EditorSelection.range(l.anchor+e.length,l.head+e.length)};let u=l.head,c=_f(t.doc,u),f;if(c==e){if(YE(t,u))return{changes:{insert:e+e,from:u},effects:_a.of(u+e.length),range:me.EditorSelection.cursor(u+e.length)};if(gS(t,u)){let d=r&&t.sliceDoc(u,u+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:u,to:u+d.length,insert:d},range:me.EditorSelection.cursor(u+d.length)}}}else{if(r&&t.sliceDoc(u-2*e.length,u)==e+e&&(f=ZE(t,u-2*e.length,a))>-1&&YE(t,f))return{changes:{insert:e+e+e+e,from:u},effects:_a.of(u+e.length),range:me.EditorSelection.cursor(u+e.length)};if(t.charCategorizer(u)(c)!=me.CharCategory.Word&&ZE(t,u,a)>-1&&!C4(t,u,e,a))return{changes:{insert:e+e,from:u},effects:_a.of(u+e.length),range:me.EditorSelection.cursor(u+e.length)}}return{range:s=l}});return s?null:t.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function YE(t,e){let r=Cs.syntaxTree(t).resolveInner(e+1);return r.parent&&r.from==e}function C4(t,e,r,n){let a=Cs.syntaxTree(t).resolveInner(e,-1),s=n.reduce((o,l)=>Math.max(o,l.length),0);for(let o=0;o<5;o++){let l=t.sliceDoc(a.from,Math.min(a.to,a.from+r.length+s)),u=l.indexOf(r);if(!u||u>-1&&n.indexOf(l.slice(0,u))>-1){let f=a.firstChild;for(;f&&f.from==a.from&&f.to-f.from>r.length+u;){if(t.sliceDoc(f.to-r.length,f.to)==r)return!1;f=f.firstChild}return!0}let c=a.to==e&&a.parent;if(!c)break;a=c}return!1}function ZE(t,e,r){let n=t.charCategorizer(e);if(n(t.sliceDoc(e-1,e))!=me.CharCategory.Word)return e;for(let a of r){let s=e-a.length;if(t.sliceDoc(s,e)==a&&n(t.sliceDoc(s-1,s))!=me.CharCategory.Word)return s}return-1}function T4(t={}){return[i4,Kt,jt.of(t),r4,k4,nS]}var vS=[{key:"Ctrl-Space",run:Sv},{mac:"Alt-`",run:Sv},{key:"Escape",run:rS},{key:"ArrowDown",run:pl(!0)},{key:"ArrowUp",run:pl(!1)},{key:"PageDown",run:pl(!0,"page")},{key:"PageUp",run:pl(!1,"page")},{key:"Enter",run:tS}],k4=me.Prec.highest(Pt.keymap.computeN([jt],t=>t.facet(jt).defaultKeymap?[vS]:[]));function A4(t){let e=t.field(Kt,!1);return e&&e.active.some(r=>r.isPending)?"pending":e&&e.active.some(r=>r.state!=0)?"active":null}var XE=new WeakMap;function M4(t){var e;let r=(e=t.field(Kt,!1))===null||e===void 0?void 0:e.open;if(!r||r.disabled)return[];let n=XE.get(r.options);return n||XE.set(r.options,n=r.options.map(a=>a.completion)),n}function P4(t){var e;let r=(e=t.field(Kt,!1))===null||e===void 0?void 0:e.open;return r&&!r.disabled&&r.selected>=0?r.options[r.selected].completion:null}function R4(t){var e;let r=(e=t.field(Kt,!1))===null||e===void 0?void 0:e.open;return r&&!r.disabled&&r.selected>=0?r.selected:null}function D4(t){return Rv.of(t)}nt.CompletionContext=gl;nt.acceptCompletion=tS;nt.autocompletion=T4;nt.clearSnippet=sS;nt.closeBrackets=m4;nt.closeBracketsKeymap=w4;nt.closeCompletion=rS;nt.completeAnyWord=v4;nt.completeFromList=$E;nt.completionKeymap=vS;nt.completionStatus=A4;nt.currentCompletions=M4;nt.deleteBracketPair=dS;nt.hasNextSnippetField=l4;nt.hasPrevSnippetField=u4;nt.ifIn=VH;nt.ifNotIn=zH;nt.insertBracket=pS;nt.insertCompletionText=JE;nt.moveCompletionSelection=pl;nt.nextSnippetField=oS;nt.pickedCompletion=wf;nt.prevSnippetField=lS;nt.selectedCompletion=P4;nt.selectedCompletionIndex=R4;nt.setSelectedCompletion=D4;nt.snippet=iS;nt.snippetCompletion=h4;nt.snippetKeymap=Mv;nt.startCompletion=Sv});var RS=O(Vr=>{"use strict";var qt=xi(),dr=gi(),Pn=nv(),Sf=class{constructor(e,r,n){this.from=e,this.to=r,this.diagnostic=n}},Sa=class t{constructor(e,r,n){this.diagnostics=e,this.panel=r,this.selected=n}static init(e,r,n){let a=n.facet(Rn).markerFilter;a&&(e=a(e,n));let s=e.slice().sort((f,h)=>f.from-h.from||f.to-h.to),o=new dr.RangeSetBuilder,l=[],u=0;for(let f=0;;){let h=f==s.length?null:s[f];if(!h&&!l.length)break;let d,p;for(l.length?(d=u,p=l.reduce((m,v)=>Math.min(m,v.to),h&&h.from>d?h.from:1e8)):(d=h.from,p=h.to,l.push(h),f++);f<s.length;){let m=s[f];if(m.from==d&&(m.to>m.from||m.to==d))l.push(m),f++,p=Math.min(m.to,p);else{p=Math.min(m.from,p);break}}let g=AS(l);if(l.some(m=>m.from==m.to||m.from==m.to-1&&n.doc.lineAt(m.from).to==m.from))o.add(d,d,qt.Decoration.widget({widget:new Lv(g),diagnostics:l.slice()}));else{let m=l.reduce((v,y)=>y.markClass?v+" "+y.markClass:v,"");o.add(d,p,qt.Decoration.mark({class:"cm-lintRange cm-lintRange-"+g+m,diagnostics:l.slice(),inclusiveEnd:l.some(v=>v.to>p)}))}u=p;for(let m=0;m<l.length;m++)l[m].to<=u&&l.splice(m--,1)}let c=o.finish();return new t(c,r,Ts(c))}};function Ts(t,e=null,r=0){let n=null;return t.between(r,1e9,(a,s,{spec:o})=>{if(!(e&&o.diagnostics.indexOf(e)<0))if(!n)n=new Sf(a,s,e||o.diagnostics[0]);else{if(o.diagnostics.indexOf(n.diagnostic)<0)return!1;n=new Sf(n.from,s,n.diagnostic)}}),n}function yS(t,e){let r=e.pos,n=e.end||r,a=t.state.facet(Rn).hideOn(t,r,n);if(a!=null)return a;let s=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(o=>o.is(wl))||t.changes.touchesRange(s.from,Math.max(s.to,n)))}function bS(t,e){return t.field(hr,!1)?e:e.concat(dr.StateEffect.appendConfig.of(PS))}function wS(t,e){return{effects:bS(t,[wl.of(e)])}}var wl=dr.StateEffect.define(),Fv=dr.StateEffect.define(),_S=dr.StateEffect.define(),hr=dr.StateField.define({create(){return new Sa(qt.Decoration.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let r=t.diagnostics.map(e.changes),n=null,a=t.panel;if(t.selected){let s=e.changes.mapPos(t.selected.from,1);n=Ts(r,t.selected.diagnostic,s)||Ts(r,null,s)}!r.size&&a&&e.state.facet(Rn).autoPanel&&(a=null),t=new Sa(r,a,n)}for(let r of e.effects)if(r.is(wl)){let n=e.state.facet(Rn).autoPanel?r.value.length?bl.open:null:t.panel;t=Sa.init(r.value,n,e.state)}else r.is(Fv)?t=new Sa(t.diagnostics,r.value?bl.open:null,t.selected):r.is(_S)&&(t=new Sa(t.diagnostics,t.panel,r.value));return t},provide:t=>[qt.showPanel.from(t,e=>e.panel),qt.EditorView.decorations.from(t,e=>e.diagnostics)]});function O4(t){let e=t.field(hr,!1);return e?e.diagnostics.size:0}var I4=qt.Decoration.mark({class:"cm-lintRange cm-lintRange-active"});function B4(t,e,r){let{diagnostics:n}=t.state.field(hr),a,s=-1,o=-1;n.between(e-(r<0?1:0),e+(r>0?1:0),(u,c,{spec:f})=>{if(e>=u&&e<=c&&(u==c||(e>u||r>0)&&(e<c||r<0)))return a=f.diagnostics,s=u,o=c,!1});let l=t.state.facet(Rn).tooltipFilter;return a&&l&&(a=l(a,t.state)),a?{pos:s,end:o,above:t.state.doc.lineAt(s).to<o,create(){return{dom:xS(t,a)}}}:null}function xS(t,e){return Pn("ul",{class:"cm-tooltip-lint"},e.map(r=>kS(t,r,!1)))}var ES=t=>{let e=t.state.field(hr,!1);(!e||!e.panel)&&t.dispatch({effects:bS(t.state,[Fv.of(!0)])});let r=qt.getPanel(t,bl.open);return r&&r.dom.querySelector(".cm-panel-lint ul").focus(),!0},Bv=t=>{let e=t.state.field(hr,!1);return!e||!e.panel?!1:(t.dispatch({effects:Fv.of(!1)}),!0)},SS=t=>{let e=t.state.field(hr,!1);if(!e)return!1;let r=t.state.selection.main,n=e.diagnostics.iter(r.to+1);return!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==r.from&&n.to==r.to)?!1:(t.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},L4=t=>{let{state:e}=t,r=e.field(hr,!1);if(!r)return!1;let n=e.selection.main,a,s,o,l;return r.diagnostics.between(0,e.doc.length,(u,c)=>{c<n.to&&(a==null||a<u)&&(a=u,s=c),(o==null||u>o)&&(o=u,l=c)}),o==null||a==null&&o==n.from?!1:(t.dispatch({selection:{anchor:a??o,head:s??l},scrollIntoView:!0}),!0)},N4=[{key:"Mod-Shift-m",run:ES,preventDefault:!0},{key:"F8",run:SS}],CS=qt.ViewPlugin.fromClass(class{constructor(t){this.view=t,this.timeout=-1,this.set=!0;let{delay:e}=t.state.facet(Rn);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){clearTimeout(this.timeout);let t=Date.now();if(t<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-t);else{this.set=!1;let{state:e}=this.view,{sources:r}=e.facet(Rn);r.length&&F4(r.map(n=>Promise.resolve(n(this.view))),n=>{this.view.state.doc==e.doc&&this.view.dispatch(wS(this.view.state,n.reduce((a,s)=>a.concat(s))))},n=>{qt.logException(this.view.state,n)})}}update(t){let e=t.state.facet(Rn);(t.docChanged||e!=t.startState.facet(Rn)||e.needsRefresh&&e.needsRefresh(t))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}});function F4(t,e,r){let n=[],a=-1;for(let s of t)s.then(o=>{n.push(o),clearTimeout(a),n.length==t.length?e(n):a=setTimeout(()=>e(n),200)},r)}var Rn=dr.Facet.define({combine(t){return Object.assign({sources:t.map(e=>e.source).filter(e=>e!=null)},dr.combineConfig(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,r)=>e?r?n=>e(n)||r(n):e:r}))}});function q4(t,e={}){return[Rn.of({source:t,config:e}),CS,PS]}function V4(t){let e=t.plugin(CS);e&&e.force()}function TS(t){let e=[];if(t)e:for(let{name:r}of t){for(let n=0;n<r.length;n++){let a=r[n];if(/[a-zA-Z]/.test(a)&&!e.some(s=>s.toLowerCase()==a.toLowerCase())){e.push(a);continue e}}e.push("")}return e}function kS(t,e,r){var n;let a=r?TS(e.actions):[];return Pn("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Pn("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(n=e.actions)===null||n===void 0?void 0:n.map((s,o)=>{let l=!1,u=d=>{if(d.preventDefault(),l)return;l=!0;let p=Ts(t.state.field(hr).diagnostics,e);p&&s.apply(t,p.from,p.to)},{name:c}=s,f=a[o]?c.indexOf(a[o]):-1,h=f<0?c:[c.slice(0,f),Pn("u",c.slice(f,f+1)),c.slice(f+1)];return Pn("button",{type:"button",class:"cm-diagnosticAction",onclick:u,onmousedown:u,"aria-label":` Action: ${c}${f<0?"":` (access key "${a[o]})"`}.`},h)}),e.source&&Pn("div",{class:"cm-diagnosticSource"},e.source))}var Lv=class extends qt.WidgetType{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return Pn("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}},Cf=class{constructor(e,r){this.diagnostic=r,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=kS(e,r,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}},bl=class t{constructor(e){this.view=e,this.items=[];let r=a=>{if(a.keyCode==27)Bv(this.view),this.view.focus();else if(a.keyCode==38||a.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(a.keyCode==40||a.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(a.keyCode==36)this.moveSelection(0);else if(a.keyCode==35)this.moveSelection(this.items.length-1);else if(a.keyCode==13)this.view.focus();else if(a.keyCode>=65&&a.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=TS(s.actions);for(let l=0;l<o.length;l++)if(o[l].toUpperCase().charCodeAt(0)==a.keyCode){let u=Ts(this.view.state.field(hr).diagnostics,s);u&&s.actions[l].apply(e,u.from,u.to)}}else return;a.preventDefault()},n=a=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(a.target)&&this.moveSelection(s)};this.list=Pn("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:r,onclick:n}),this.dom=Pn("div",{class:"cm-panel-lint"},this.list,Pn("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Bv(this.view)},"\xD7")),this.update()}get selectedIndex(){let e=this.view.state.field(hr).selected;if(!e)return-1;for(let r=0;r<this.items.length;r++)if(this.items[r].diagnostic==e.diagnostic)return r;return-1}update(){let{diagnostics:e,selected:r}=this.view.state.field(hr),n=0,a=!1,s=null,o=new Set;for(e.between(0,this.view.state.doc.length,(l,u,{spec:c})=>{for(let f of c.diagnostics){if(o.has(f))continue;o.add(f);let h=-1,d;for(let p=n;p<this.items.length;p++)if(this.items[p].diagnostic==f){h=p;break}h<0?(d=new Cf(this.view,f),this.items.splice(n,0,d),a=!0):(d=this.items[h],h>n&&(this.items.splice(n,h-n),a=!0)),r&&d.diagnostic==r.diagnostic?d.dom.hasAttribute("aria-selected")||(d.dom.setAttribute("aria-selected","true"),s=d):d.dom.hasAttribute("aria-selected")&&d.dom.removeAttribute("aria-selected"),n++}});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)a=!0,this.items.pop();this.items.length==0&&(this.items.push(new Cf(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),a=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:l,panel:u})=>{let c=u.height/this.list.offsetHeight;l.top<u.top?this.list.scrollTop-=(u.top-l.top)/c:l.bottom>u.bottom&&(this.list.scrollTop+=(l.bottom-u.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),a&&this.sync()}sync(){let e=this.list.firstChild;function r(){let n=e;e=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)r();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)r()}moveSelection(e){if(this.selectedIndex<0)return;let r=this.view.state.field(hr),n=Ts(r.diagnostics,this.items[e].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:_S.of(n)})}static open(e){return new t(e)}};function Ef(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function xf(t){return Ef(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}var z4=qt.EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:xf("#d11")},".cm-lintRange-warning":{backgroundImage:xf("orange")},".cm-lintRange-info":{backgroundImage:xf("#999")},".cm-lintRange-hint":{backgroundImage:xf("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function H4(t){return t=="error"?4:t=="warning"?3:t=="info"?2:1}function AS(t){let e="hint",r=1;for(let n of t){let a=H4(n.severity);a>r&&(r=a,e=n.severity)}return e}var Tf=class extends qt.GutterMarker{constructor(e){super(),this.diagnostics=e,this.severity=AS(e)}toDOM(e){let r=document.createElement("div");r.className="cm-lint-marker cm-lint-marker-"+this.severity;let n=this.diagnostics,a=e.state.facet(kf).tooltipFilter;return a&&(n=a(n,e.state)),n.length&&(r.onmouseover=()=>W4(e,r,n)),r}};function U4(t,e){let r=n=>{let a=e.getBoundingClientRect();if(!(n.clientX>a.left-10&&n.clientX<a.right+10&&n.clientY>a.top-10&&n.clientY<a.bottom+10)){for(let s=n.target;s;s=s.parentNode)if(s.nodeType==1&&s.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",r),t.state.field(MS)&&t.dispatch({effects:qv.of(null)})}};window.addEventListener("mousemove",r)}function W4(t,e,r){function n(){let o=t.elementAtHeight(e.getBoundingClientRect().top+5-t.documentTop);t.coordsAtPos(o.from)&&t.dispatch({effects:qv.of({pos:o.from,above:!1,clip:!1,create(){return{dom:xS(t,r),getCoords:()=>e.getBoundingClientRect()}}})}),e.onmouseout=e.onmousemove=null,U4(t,e)}let{hoverTime:a}=t.state.facet(kf),s=setTimeout(n,a);e.onmouseout=()=>{clearTimeout(s),e.onmouseout=e.onmousemove=null},e.onmousemove=()=>{clearTimeout(s),s=setTimeout(n,a)}}function G4(t,e){let r=Object.create(null);for(let a of e){let s=t.lineAt(a.from);(r[s.from]||(r[s.from]=[])).push(a)}let n=[];for(let a in r)n.push(new Tf(r[a]).range(+a));return dr.RangeSet.of(n,!0)}var K4=qt.gutter({class:"cm-gutter-lint",markers:t=>t.state.field(Nv),widgetMarker:(t,e,r)=>{let n=[];return t.state.field(Nv).between(r.from,r.to,(a,s,o)=>{a>r.from&&a<r.to&&n.push(...o.diagnostics)}),n.length?new Tf(n):null}}),Nv=dr.StateField.define({create(){return dr.RangeSet.empty},update(t,e){t=t.map(e.changes);let r=e.state.facet(kf).markerFilter;for(let n of e.effects)if(n.is(wl)){let a=n.value;r&&(a=r(a||[],e.state)),t=G4(e.state.doc,a.slice(0))}return t}}),qv=dr.StateEffect.define(),MS=dr.StateField.define({create(){return null},update(t,e){return t&&e.docChanged&&(t=yS(e,t)?null:Object.assign(Object.assign({},t),{pos:e.changes.mapPos(t.pos)})),e.effects.reduce((r,n)=>n.is(qv)?n.value:r,t)},provide:t=>qt.showTooltip.from(t)}),j4=qt.EditorView.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:Ef('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:Ef('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:Ef('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),PS=[hr,qt.EditorView.decorations.compute([hr],t=>{let{selected:e,panel:r}=t.field(hr);return!e||!r||e.from==e.to?qt.Decoration.none:qt.Decoration.set([I4.range(e.from,e.to)])}),qt.hoverTooltip(B4,{hideOn:yS}),z4],kf=dr.Facet.define({combine(t){return dr.combineConfig(t,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function Y4(t={}){return[kf.of(t),Nv,K4,j4,MS]}function Z4(t,e){let r=t.field(hr,!1);if(r&&r.diagnostics.size){let n=[],a=[],s=-1;for(let o=dr.RangeSet.iter([r.diagnostics]);;o.next()){for(let l=0;l<n.length;l++)(!o.value||o.value.spec.diagnostics.indexOf(n[l])<0)&&(e(n[l],a[l],s),n.splice(l,1),a.splice(l--,1));if(!o.value)break;for(let l of o.value.spec.diagnostics)n.indexOf(l)<0&&(n.push(l),a.push(o.from));s=o.to}}}Vr.closeLintPanel=Bv;Vr.diagnosticCount=O4;Vr.forEachDiagnostic=Z4;Vr.forceLinting=V4;Vr.lintGutter=Y4;Vr.lintKeymap=N4;Vr.linter=q4;Vr.nextDiagnostic=SS;Vr.openLintPanel=ES;Vr.previousDiagnostic=L4;Vr.setDiagnostics=wS;Vr.setDiagnosticsEffect=wl});var OS=O(_l=>{"use strict";Object.defineProperty(_l,"__esModule",{value:!0});var zr=xi(),X4=gi(),Ai=Gc(),ks=SE(),DS=qE(),Af=mS(),$4=RS(),Q4=[zr.lineNumbers(),zr.highlightActiveLineGutter(),zr.highlightSpecialChars(),ks.history(),Ai.foldGutter(),zr.drawSelection(),zr.dropCursor(),X4.EditorState.allowMultipleSelections.of(!0),Ai.indentOnInput(),Ai.syntaxHighlighting(Ai.defaultHighlightStyle,{fallback:!0}),Ai.bracketMatching(),Af.closeBrackets(),Af.autocompletion(),zr.rectangularSelection(),zr.crosshairCursor(),zr.highlightActiveLine(),DS.highlightSelectionMatches(),zr.keymap.of([...Af.closeBracketsKeymap,...ks.defaultKeymap,...DS.searchKeymap,...ks.historyKeymap,...Ai.foldKeymap,...Af.completionKeymap,...$4.lintKeymap])],J4=[zr.highlightSpecialChars(),ks.history(),zr.drawSelection(),Ai.syntaxHighlighting(Ai.defaultHighlightStyle,{fallback:!0}),zr.keymap.of([...ks.defaultKeymap,...ks.historyKeymap])];Object.defineProperty(_l,"EditorView",{enumerable:!0,get:function(){return zr.EditorView}});_l.basicSetup=Q4;_l.minimalSetup=J4});var ZA=O((Lfe,YA)=>{"use strict";function gy(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function eU(t){if(Array.isArray(t))return t}function tU(t){if(Array.isArray(t))return gy(t)}function Vi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sk(n.key),n)}}function zi(t,e,r){return e&&rU(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ir(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=By(t))||e){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(u){throw u},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var u=r.next();return o=u.done,u},e:function(u){l=!0,s=u},f:function(){try{o||r.return==null||r.return()}finally{if(l)throw s}}}}function ak(t,e,r){return(e=sk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nU(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function iU(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,a,s,o,l=[],u=!0,c=!1;try{if(s=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=s.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(f){c=!0,a=f}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function aU(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sU(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zt(t,e){return eU(t)||iU(t,e)||By(t,e)||aU()}function Jf(t){return tU(t)||nU(t)||By(t)||sU()}function oU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function sk(t){var e=oU(t,"string");return typeof e=="symbol"?e:e+""}function Ut(t){"@babel/helpers - typeof";return Ut=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ut(t)}function By(t,e){if(t){if(typeof t=="string")return gy(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gy(t,e):void 0}}var Vt=typeof window>"u"?null:window,IS=Vt?Vt.navigator:null;Vt&&Vt.document;var lU=Ut(""),ok=Ut({}),uU=Ut(function(){}),cU=typeof HTMLElement>"u"?"undefined":Ut(HTMLElement),Gl=function(e){return e&&e.instanceString&&Ct(e.instanceString)?e.instanceString():null},_e=function(e){return e!=null&&Ut(e)==lU},Ct=function(e){return e!=null&&Ut(e)===uU},dt=function(e){return!Hr(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},Qe=function(e){return e!=null&&Ut(e)===ok&&!dt(e)&&e.constructor===Object},fU=function(e){return e!=null&&Ut(e)===ok},le=function(e){return e!=null&&Ut(e)===Ut(1)&&!isNaN(e)},hU=function(e){return le(e)&&Math.floor(e)===e},eh=function(e){if(cU!=="undefined")return e!=null&&e instanceof HTMLElement},Hr=function(e){return Kl(e)||lk(e)},Kl=function(e){return Gl(e)==="collection"&&e._private.single},lk=function(e){return Gl(e)==="collection"&&!e._private.single},Ly=function(e){return Gl(e)==="core"},uk=function(e){return Gl(e)==="stylesheet"},dU=function(e){return Gl(e)==="event"},Ii=function(e){return e==null?!0:!!(e===""||e.match(/^\s+$/))},pU=function(e){return typeof HTMLElement>"u"?!1:e instanceof HTMLElement},gU=function(e){return Qe(e)&&le(e.x1)&&le(e.x2)&&le(e.y1)&&le(e.y2)},vU=function(e){return fU(e)&&Ct(e.then)},mU=function(){return IS&&IS.userAgent.match(/msie|trident|edge/i)},Us=function(e,r){r||(r=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var s=[],o=0;o<arguments.length;o++)s.push(arguments[o]);return s.join("$")});var n=function(){var s=this,o=arguments,l,u=r.apply(s,o),c=n.cache;return(l=c[u])||(l=c[u]=e.apply(s,o)),l};return n.cache={},n},Ny=Us(function(t){return t.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}),dh=Us(function(t){return t.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}),ck=Us(function(t,e){return t+e[0].toUpperCase()+e.substring(1)},function(t,e){return t+"$"+e}),BS=function(e){return Ii(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},Ht="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",yU="rgb[a]?\\(("+Ht+"[%]?)\\s*,\\s*("+Ht+"[%]?)\\s*,\\s*("+Ht+"[%]?)(?:\\s*,\\s*("+Ht+"))?\\)",bU="rgb[a]?\\((?:"+Ht+"[%]?)\\s*,\\s*(?:"+Ht+"[%]?)\\s*,\\s*(?:"+Ht+"[%]?)(?:\\s*,\\s*(?:"+Ht+"))?\\)",wU="hsl[a]?\\(("+Ht+")\\s*,\\s*("+Ht+"[%])\\s*,\\s*("+Ht+"[%])(?:\\s*,\\s*("+Ht+"))?\\)",_U="hsl[a]?\\((?:"+Ht+")\\s*,\\s*(?:"+Ht+"[%])\\s*,\\s*(?:"+Ht+"[%])(?:\\s*,\\s*(?:"+Ht+"))?\\)",xU="\\#[0-9a-fA-F]{3}",EU="\\#[0-9a-fA-F]{6}",fk=function(e,r){return e<r?-1:e>r?1:0},SU=function(e,r){return-1*fk(e,r)},Ce=Object.assign!=null?Object.assign.bind(Object):function(t){for(var e=arguments,r=1;r<e.length;r++){var n=e[r];if(n!=null)for(var a=Object.keys(n),s=0;s<a.length;s++){var o=a[s];t[o]=n[o]}}return t},CU=function(e){if(!(!(e.length===4||e.length===7)||e[0]!=="#")){var r=e.length===4,n,a,s,o=16;return r?(n=parseInt(e[1]+e[1],o),a=parseInt(e[2]+e[2],o),s=parseInt(e[3]+e[3],o)):(n=parseInt(e[1]+e[2],o),a=parseInt(e[3]+e[4],o),s=parseInt(e[5]+e[6],o)),[n,a,s]}},TU=function(e){var r,n,a,s,o,l,u,c;function f(g,m,v){return v<0&&(v+=1),v>1&&(v-=1),v<1/6?g+(m-g)*6*v:v<1/2?m:v<2/3?g+(m-g)*(2/3-v)*6:g}var h=new RegExp("^"+wU+"$").exec(e);if(h){if(n=parseInt(h[1]),n<0?n=(360- -1*n%360)%360:n>360&&(n=n%360),n/=360,a=parseFloat(h[2]),a<0||a>100||(a=a/100,s=parseFloat(h[3]),s<0||s>100)||(s=s/100,o=h[4],o!==void 0&&(o=parseFloat(o),o<0||o>1)))return;if(a===0)l=u=c=Math.round(s*255);else{var d=s<.5?s*(1+a):s+a-s*a,p=2*s-d;l=Math.round(255*f(p,d,n+1/3)),u=Math.round(255*f(p,d,n)),c=Math.round(255*f(p,d,n-1/3))}r=[l,u,c,o]}return r},kU=function(e){var r,n=new RegExp("^"+yU+"$").exec(e);if(n){r=[];for(var a=[],s=1;s<=3;s++){var o=n[s];if(o[o.length-1]==="%"&&(a[s]=!0),o=parseFloat(o),a[s]&&(o=o/100*255),o<0||o>255)return;r.push(Math.floor(o))}var l=a[1]||a[2]||a[3],u=a[1]&&a[2]&&a[3];if(l&&!u)return;var c=n[4];if(c!==void 0){if(c=parseFloat(c),c<0||c>1)return;r.push(c)}}return r},AU=function(e){return MU[e.toLowerCase()]},hk=function(e){return(dt(e)?e:null)||AU(e)||CU(e)||kU(e)||TU(e)},MU={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},dk=function(e){for(var r=e.map,n=e.keys,a=n.length,s=0;s<a;s++){var o=n[s];if(Qe(o))throw Error("Tried to set map with object key");s<n.length-1?(r[o]==null&&(r[o]={}),r=r[o]):r[o]=e.value}},pk=function(e){for(var r=e.map,n=e.keys,a=n.length,s=0;s<a;s++){var o=n[s];if(Qe(o))throw Error("Tried to get map with object key");if(r=r[o],r==null)return r}return r},Mf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Vv,LS;function Yl(){if(LS)return Vv;LS=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return Vv=t,Vv}var zv,NS;function PU(){if(NS)return zv;NS=1;var t=typeof Mf=="object"&&Mf&&Mf.Object===Object&&Mf;return zv=t,zv}var Hv,FS;function ph(){if(FS)return Hv;FS=1;var t=PU(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return Hv=r,Hv}var Uv,qS;function RU(){if(qS)return Uv;qS=1;var t=ph(),e=function(){return t.Date.now()};return Uv=e,Uv}var Wv,VS;function DU(){if(VS)return Wv;VS=1;var t=/\s/;function e(r){for(var n=r.length;n--&&t.test(r.charAt(n)););return n}return Wv=e,Wv}var Gv,zS;function OU(){if(zS)return Gv;zS=1;var t=DU(),e=/^\s+/;function r(n){return n&&n.slice(0,t(n)+1).replace(e,"")}return Gv=r,Gv}var Kv,HS;function Fy(){if(HS)return Kv;HS=1;var t=ph(),e=t.Symbol;return Kv=e,Kv}var jv,US;function IU(){if(US)return jv;US=1;var t=Fy(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,a=t?t.toStringTag:void 0;function s(o){var l=r.call(o,a),u=o[a];try{o[a]=void 0;var c=!0}catch{}var f=n.call(o);return c&&(l?o[a]=u:delete o[a]),f}return jv=s,jv}var Yv,WS;function BU(){if(WS)return Yv;WS=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return Yv=r,Yv}var Zv,GS;function gk(){if(GS)return Zv;GS=1;var t=Fy(),e=IU(),r=BU(),n="[object Null]",a="[object Undefined]",s=t?t.toStringTag:void 0;function o(l){return l==null?l===void 0?a:n:s&&s in Object(l)?e(l):r(l)}return Zv=o,Zv}var Xv,KS;function LU(){if(KS)return Xv;KS=1;function t(e){return e!=null&&typeof e=="object"}return Xv=t,Xv}var $v,jS;function Zl(){if(jS)return $v;jS=1;var t=gk(),e=LU(),r="[object Symbol]";function n(a){return typeof a=="symbol"||e(a)&&t(a)==r}return $v=n,$v}var Qv,YS;function NU(){if(YS)return Qv;YS=1;var t=OU(),e=Yl(),r=Zl(),n=NaN,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt;function u(c){if(typeof c=="number")return c;if(r(c))return n;if(e(c)){var f=typeof c.valueOf=="function"?c.valueOf():c;c=e(f)?f+"":f}if(typeof c!="string")return c===0?c:+c;c=t(c);var h=s.test(c);return h||o.test(c)?l(c.slice(2),h?2:8):a.test(c)?n:+c}return Qv=u,Qv}var Jv,ZS;function FU(){if(ZS)return Jv;ZS=1;var t=Yl(),e=RU(),r=NU(),n="Expected a function",a=Math.max,s=Math.min;function o(l,u,c){var f,h,d,p,g,m,v=0,y=!1,b=!1,w=!0;if(typeof l!="function")throw new TypeError(n);u=r(u)||0,t(c)&&(y=!!c.leading,b="maxWait"in c,d=b?a(r(c.maxWait)||0,u):d,w="trailing"in c?!!c.trailing:w);function _(P){var I=f,B=h;return f=h=void 0,v=P,p=l.apply(B,I),p}function x(P){return v=P,g=setTimeout(A,u),y?_(P):p}function S(P){var I=P-m,B=P-v,L=u-I;return b?s(L,d-B):L}function E(P){var I=P-m,B=P-v;return m===void 0||I>=u||I<0||b&&B>=d}function A(){var P=e();if(E(P))return T(P);g=setTimeout(A,S(P))}function T(P){return g=void 0,w&&f?_(P):(f=h=void 0,p)}function D(){g!==void 0&&clearTimeout(g),v=0,f=m=h=g=void 0}function k(){return g===void 0?p:T(e())}function M(){var P=e(),I=E(P);if(f=arguments,h=this,m=P,I){if(g===void 0)return x(m);if(b)return clearTimeout(g),g=setTimeout(A,u),_(m)}return g===void 0&&(g=setTimeout(A,u)),p}return M.cancel=D,M.flush=k,M}return Jv=o,Jv}var qU=FU(),Xl=jl(qU),em=Vt?Vt.performance:null,vk=em&&em.now?function(){return em.now()}:function(){return Date.now()},VU=function(){if(Vt){if(Vt.requestAnimationFrame)return function(t){Vt.requestAnimationFrame(t)};if(Vt.mozRequestAnimationFrame)return function(t){Vt.mozRequestAnimationFrame(t)};if(Vt.webkitRequestAnimationFrame)return function(t){Vt.webkitRequestAnimationFrame(t)};if(Vt.msRequestAnimationFrame)return function(t){Vt.msRequestAnimationFrame(t)}}return function(t){t&&setTimeout(function(){t(vk())},1e3/60)}}(),th=function(e){return VU(e)},ri=vk,Ra=9261,mk=65599,Bs=5381,yk=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ra,n=r,a;a=e.next(),!a.done;)n=n*mk+a.value|0;return n},Bl=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ra;return r*mk+e|0},Ll=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bs;return(r<<5)+r+e|0},zU=function(e,r){return e*2097152+r},Mi=function(e){return e[0]*2097152+e[1]},Pf=function(e,r){return[Bl(e[0],r[0]),Ll(e[1],r[1])]},XS=function(e,r){var n={value:0,done:!1},a=0,s=e.length,o={next:function(){return a<s?n.value=e[a++]:n.done=!0,n}};return yk(o,r)},Ia=function(e,r){var n={value:0,done:!1},a=0,s=e.length,o={next:function(){return a<s?n.value=e.charCodeAt(a++):n.done=!0,n}};return yk(o,r)},bk=function(){return HU(arguments)},HU=function(e){for(var r,n=0;n<e.length;n++){var a=e[n];n===0?r=Ia(a):r=Ia(a,r)}return r},$S=!0,UU=console.warn!=null,WU=console.trace!=null,qy=Number.MAX_SAFE_INTEGER||9007199254740991,wk=function(){return!0},rh=function(){return!1},QS=function(){return 0},Vy=function(){},St=function(e){throw new Error(e)},_k=function(e){if(e!==void 0)$S=!!e;else return $S},st=function(e){_k()&&(UU?console.warn(e):(console.log(e),WU&&console.trace()))},GU=function(e){return Ce({},e)},Bn=function(e){return e==null?e:dt(e)?e.slice():Qe(e)?GU(e):e},KU=function(e){return e.slice()},xk=function(e,r){for(r=e="";e++<36;r+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return r},jU={},Ek=function(){return jU},ar=function(e){var r=Object.keys(e);return function(n){for(var a={},s=0;s<r.length;s++){var o=r[s],l=n?.[o];a[o]=l===void 0?e[o]:l}return a}},Bi=function(e,r,n){for(var a=e.length-1;a>=0;a--)e[a]===r&&e.splice(a,1)},zy=function(e){e.splice(0,e.length)},YU=function(e,r){for(var n=0;n<r.length;n++){var a=r[n];e.push(a)}},Dr=function(e,r,n){return n&&(r=ck(n,r)),e[r]},ei=function(e,r,n,a){n&&(r=ck(n,r)),e[r]=a},ZU=function(){function t(){Vi(this,t),this._obj={}}return zi(t,[{key:"set",value:function(r,n){return this._obj[r]=n,this}},{key:"delete",value:function(r){return this._obj[r]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(r){return this._obj[r]!==void 0}},{key:"get",value:function(r){return this._obj[r]}}])}(),ti=typeof Map<"u"?Map:ZU,XU="undefined",$U=function(){function t(e){if(Vi(this,t),this._obj=Object.create(null),this.size=0,e!=null){var r;e.instanceString!=null&&e.instanceString()===this.instanceString()?r=e.toArray():r=e;for(var n=0;n<r.length;n++)this.add(r[n])}}return zi(t,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(r){var n=this._obj;n[r]!==1&&(n[r]=1,this.size++)}},{key:"delete",value:function(r){var n=this._obj;n[r]===1&&(n[r]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(r){return this._obj[r]===1}},{key:"toArray",value:function(){var r=this;return Object.keys(this._obj).filter(function(n){return r.has(n)})}},{key:"forEach",value:function(r,n){return this.toArray().forEach(r,n)}}])}(),js=(typeof Set>"u"?"undefined":Ut(Set))!==XU?Set:$U,gh=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e===void 0||r===void 0||!Ly(e)){St("An element must have a core reference and parameters set");return}var a=r.group;if(a==null&&(r.data&&r.data.source!=null&&r.data.target!=null?a="edges":a="nodes"),a!=="nodes"&&a!=="edges"){St("An element must be of type `nodes` or `edges`; you specified `"+a+"`");return}this.length=1,this[0]=this;var s=this._private={cy:e,single:!0,data:r.data||{},position:r.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:a,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!r.selected,selectable:r.selectable===void 0?!0:!!r.selectable,locked:!!r.locked,grabbed:!1,grabbable:r.grabbable===void 0?!0:!!r.grabbable,pannable:r.pannable===void 0?a==="edges":!!r.pannable,active:!1,classes:new js,animation:{current:[],queue:[]},rscratch:{},scratch:r.scratch||{},edges:[],children:[],parent:r.parent&&r.parent.isNode()?r.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(s.position.x==null&&(s.position.x=0),s.position.y==null&&(s.position.y=0),r.renderedPosition){var o=r.renderedPosition,l=e.pan(),u=e.zoom();s.position={x:(o.x-l.x)/u,y:(o.y-l.y)/u}}var c=[];dt(r.classes)?c=r.classes:_e(r.classes)&&(c=r.classes.split(/\s+/));for(var f=0,h=c.length;f<h;f++){var d=c[f];!d||d===""||s.classes.add(d)}this.createEmitter(),(n===void 0||n)&&this.restore();var p=r.style||r.css;p&&(st("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(p))},JS=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(n,a,s){var o;Qe(n)&&!Hr(n)&&(o=n,n=o.roots||o.root,a=o.visit,s=o.directed),s=arguments.length===2&&!Ct(a)?a:s,a=Ct(a)?a:function(){};for(var l=this._private.cy,u=n=_e(n)?this.filter(n):n,c=[],f=[],h={},d={},p={},g=0,m,v=this.byGroup(),y=v.nodes,b=v.edges,w=0;w<u.length;w++){var _=u[w],x=_.id();_.isNode()&&(c.unshift(_),e.bfs&&(p[x]=!0,f.push(_)),d[x]=0)}for(var S=function(){var P=e.bfs?c.shift():c.pop(),I=P.id();if(e.dfs){if(p[I])return 0;p[I]=!0,f.push(P)}var B=d[I],L=h[I],N=L!=null?L.source():null,F=L!=null?L.target():null,q=L==null?void 0:P.same(N)?F[0]:N[0],H;if(H=a(P,L,q,g++,B),H===!0)return m=P,1;if(H===!1)return 1;for(var V=P.connectedEdges().filter(function(ee){return(!s||ee.source().same(P))&&b.has(ee)}),z=0;z<V.length;z++){var Y=V[z],Q=Y.connectedNodes().filter(function(ee){return!ee.same(P)&&y.has(ee)}),J=Q.id();Q.length!==0&&!p[J]&&(Q=Q[0],c.push(Q),e.bfs&&(p[J]=!0,f.push(Q)),h[J]=Y,d[J]=d[I]+1)}},E;c.length!==0&&(E=S(),!(E!==0&&E===1)););for(var A=l.collection(),T=0;T<f.length;T++){var D=f[T],k=h[D.id()];k!=null&&A.push(k),A.push(D)}return{path:l.collection(A),found:l.collection(m)}}},Nl={breadthFirstSearch:JS({bfs:!0}),depthFirstSearch:JS({dfs:!0})};Nl.bfs=Nl.breadthFirstSearch;Nl.dfs=Nl.depthFirstSearch;var Hf={exports:{}},QU=Hf.exports,eC;function JU(){return eC||(eC=1,function(t,e){(function(){var r,n,a,s,o,l,u,c,f,h,d,p,g,m,v;a=Math.floor,h=Math.min,n=function(y,b){return y<b?-1:y>b?1:0},f=function(y,b,w,_,x){var S;if(w==null&&(w=0),x==null&&(x=n),w<0)throw new Error("lo must be non-negative");for(_==null&&(_=y.length);w<_;)S=a((w+_)/2),x(b,y[S])<0?_=S:w=S+1;return[].splice.apply(y,[w,w-w].concat(b)),b},l=function(y,b,w){return w==null&&(w=n),y.push(b),m(y,0,y.length-1,w)},o=function(y,b){var w,_;return b==null&&(b=n),w=y.pop(),y.length?(_=y[0],y[0]=w,v(y,0,b)):_=w,_},c=function(y,b,w){var _;return w==null&&(w=n),_=y[0],y[0]=b,v(y,0,w),_},u=function(y,b,w){var _;return w==null&&(w=n),y.length&&w(y[0],b)<0&&(_=[y[0],b],b=_[0],y[0]=_[1],v(y,0,w)),b},s=function(y,b){var w,_,x,S,E,A;for(b==null&&(b=n),S=function(){A=[];for(var T=0,D=a(y.length/2);0<=D?T<D:T>D;0<=D?T++:T--)A.push(T);return A}.apply(this).reverse(),E=[],_=0,x=S.length;_<x;_++)w=S[_],E.push(v(y,w,b));return E},g=function(y,b,w){var _;if(w==null&&(w=n),_=y.indexOf(b),_!==-1)return m(y,0,_,w),v(y,_,w)},d=function(y,b,w){var _,x,S,E,A;if(w==null&&(w=n),x=y.slice(0,b),!x.length)return x;for(s(x,w),A=y.slice(b),S=0,E=A.length;S<E;S++)_=A[S],u(x,_,w);return x.sort(w).reverse()},p=function(y,b,w){var _,x,S,E,A,T,D,k,M;if(w==null&&(w=n),b*10<=y.length){if(S=y.slice(0,b).sort(w),!S.length)return S;for(x=S[S.length-1],D=y.slice(b),E=0,T=D.length;E<T;E++)_=D[E],w(_,x)<0&&(f(S,_,0,null,w),S.pop(),x=S[S.length-1]);return S}for(s(y,w),M=[],A=0,k=h(b,y.length);0<=k?A<k:A>k;0<=k?++A:--A)M.push(o(y,w));return M},m=function(y,b,w,_){var x,S,E;for(_==null&&(_=n),x=y[w];w>b;){if(E=w-1>>1,S=y[E],_(x,S)<0){y[w]=S,w=E;continue}break}return y[w]=x},v=function(y,b,w){var _,x,S,E,A;for(w==null&&(w=n),x=y.length,A=b,S=y[b],_=2*b+1;_<x;)E=_+1,E<x&&!(w(y[_],y[E])<0)&&(_=E),y[b]=y[_],b=_,_=2*b+1;return y[b]=S,m(y,A,b,w)},r=function(){y.push=l,y.pop=o,y.replace=c,y.pushpop=u,y.heapify=s,y.updateItem=g,y.nlargest=d,y.nsmallest=p;function y(b){this.cmp=b??n,this.nodes=[]}return y.prototype.push=function(b){return l(this.nodes,b,this.cmp)},y.prototype.pop=function(){return o(this.nodes,this.cmp)},y.prototype.peek=function(){return this.nodes[0]},y.prototype.contains=function(b){return this.nodes.indexOf(b)!==-1},y.prototype.replace=function(b){return c(this.nodes,b,this.cmp)},y.prototype.pushpop=function(b){return u(this.nodes,b,this.cmp)},y.prototype.heapify=function(){return s(this.nodes,this.cmp)},y.prototype.updateItem=function(b){return g(this.nodes,b,this.cmp)},y.prototype.clear=function(){return this.nodes=[]},y.prototype.empty=function(){return this.nodes.length===0},y.prototype.size=function(){return this.nodes.length},y.prototype.clone=function(){var b;return b=new y,b.nodes=this.nodes.slice(0),b},y.prototype.toArray=function(){return this.nodes.slice(0)},y.prototype.insert=y.prototype.push,y.prototype.top=y.prototype.peek,y.prototype.front=y.prototype.peek,y.prototype.has=y.prototype.contains,y.prototype.copy=y.prototype.clone,y}(),function(y,b){return t.exports=b()}(this,function(){return r})}).call(QU)}(Hf)),Hf.exports}var tm,tC;function eW(){return tC||(tC=1,tm=JU()),tm}var tW=eW(),$l=jl(tW),rW=ar({root:null,weight:function(e){return 1},directed:!1}),nW={dijkstra:function(e){if(!Qe(e)){var r=arguments;e={root:r[0],weight:r[1],directed:r[2]}}var n=rW(e),a=n.root,s=n.weight,o=n.directed,l=this,u=s,c=_e(a)?this.filter(a)[0]:a[0],f={},h={},d={},p=this.byGroup(),g=p.nodes,m=p.edges;m.unmergeBy(function(B){return B.isLoop()});for(var v=function(L){return f[L.id()]},y=function(L,N){f[L.id()]=N,b.updateItem(L)},b=new $l(function(B,L){return v(B)-v(L)}),w=0;w<g.length;w++){var _=g[w];f[_.id()]=_.same(c)?0:1/0,b.push(_)}for(var x=function(L,N){for(var F=(o?L.edgesTo(N):L.edgesWith(N)).intersect(m),q=1/0,H,V=0;V<F.length;V++){var z=F[V],Y=u(z);(Y<q||!H)&&(q=Y,H=z)}return{edge:H,dist:q}};b.size()>0;){var S=b.pop(),E=v(S),A=S.id();if(d[A]=E,E!==1/0)for(var T=S.neighborhood().intersect(g),D=0;D<T.length;D++){var k=T[D],M=k.id(),P=x(S,k),I=E+P.dist;I<v(k)&&(y(k,I),h[M]={node:S,edge:P.edge})}}return{distanceTo:function(L){var N=_e(L)?g.filter(L)[0]:L[0];return d[N.id()]},pathTo:function(L){var N=_e(L)?g.filter(L)[0]:L[0],F=[],q=N,H=q.id();if(N.length>0)for(F.unshift(N);h[H];){var V=h[H];F.unshift(V.edge),F.unshift(V.node),q=V.node,H=q.id()}return l.spawn(F)}}}},iW={kruskal:function(e){e=e||function(w){return 1};for(var r=this.byGroup(),n=r.nodes,a=r.edges,s=n.length,o=new Array(s),l=n,u=function(_){for(var x=0;x<o.length;x++){var S=o[x];if(S.has(_))return x}},c=0;c<s;c++)o[c]=this.spawn(n[c]);for(var f=a.sort(function(w,_){return e(w)-e(_)}),h=0;h<f.length;h++){var d=f[h],p=d.source()[0],g=d.target()[0],m=u(p),v=u(g),y=o[m],b=o[v];m!==v&&(l.merge(d),y.merge(b),o.splice(v,1))}return l}},aW=ar({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),sW={aStar:function(e){var r=this.cy(),n=aW(e),a=n.root,s=n.goal,o=n.heuristic,l=n.directed,u=n.weight;a=r.collection(a)[0],s=r.collection(s)[0];var c=a.id(),f=s.id(),h={},d={},p={},g=new $l(function(H,V){return d[H.id()]-d[V.id()]}),m=new js,v={},y={},b=function(V,z){g.push(V),m.add(z)},w,_,x=function(){w=g.pop(),_=w.id(),m.delete(_)},S=function(V){return m.has(V)};b(a,c),h[c]=0,d[c]=o(a);for(var E=0;g.size()>0;){if(x(),E++,_===f){for(var A=[],T=s,D=f,k=y[D];A.unshift(T),k!=null&&A.unshift(k),T=v[D],T!=null;)D=T.id(),k=y[D];return{found:!0,distance:h[_],path:this.spawn(A),steps:E}}p[_]=!0;for(var M=w._private.edges,P=0;P<M.length;P++){var I=M[P];if(this.hasElementWithId(I.id())&&!(l&&I.data("source")!==_)){var B=I.source(),L=I.target(),N=B.id()!==_?B:L,F=N.id();if(this.hasElementWithId(F)&&!p[F]){var q=h[_]+u(I);if(!S(F)){h[F]=q,d[F]=q+o(N),b(N,F),v[F]=w,y[F]=I;continue}q<h[F]&&(h[F]=q,d[F]=q+o(N),v[F]=w,y[F]=I)}}}}return{found:!1,distance:void 0,path:void 0,steps:E}}},oW=ar({weight:function(e){return 1},directed:!1}),lW={floydWarshall:function(e){for(var r=this.cy(),n=oW(e),a=n.weight,s=n.directed,o=a,l=this.byGroup(),u=l.nodes,c=l.edges,f=u.length,h=f*f,d=function(Y){return u.indexOf(Y)},p=function(Y){return u[Y]},g=new Array(h),m=0;m<h;m++){var v=m%f,y=(m-v)/f;y===v?g[m]=0:g[m]=1/0}for(var b=new Array(h),w=new Array(h),_=0;_<c.length;_++){var x=c[_],S=x.source()[0],E=x.target()[0];if(S!==E){var A=d(S),T=d(E),D=A*f+T,k=o(x);if(g[D]>k&&(g[D]=k,b[D]=T,w[D]=x),!s){var M=T*f+A;!s&&g[M]>k&&(g[M]=k,b[M]=A,w[M]=x)}}}for(var P=0;P<f;P++)for(var I=0;I<f;I++)for(var B=I*f+P,L=0;L<f;L++){var N=I*f+L,F=P*f+L;g[B]+g[F]<g[N]&&(g[N]=g[B]+g[F],b[N]=b[B])}var q=function(Y){return(_e(Y)?r.filter(Y):Y)[0]},H=function(Y){return d(q(Y))},V={distance:function(Y,Q){var J=H(Y),ee=H(Q);return g[J*f+ee]},path:function(Y,Q){var J=H(Y),ee=H(Q),ae=p(J);if(J===ee)return ae.collection();if(b[J*f+ee]==null)return r.collection();var ue=r.collection(),re=J,U;for(ue.merge(ae);J!==ee;)re=J,J=b[J*f+ee],U=w[re*f+J],ue.merge(U),ue.merge(p(J));return ue}};return V}},uW=ar({weight:function(e){return 1},directed:!1,root:null}),cW={bellmanFord:function(e){var r=this,n=uW(e),a=n.weight,s=n.directed,o=n.root,l=a,u=this,c=this.cy(),f=this.byGroup(),h=f.edges,d=f.nodes,p=d.length,g=new ti,m=!1,v=[];o=c.collection(o)[0],h.unmergeBy(function(ot){return ot.isLoop()});for(var y=h.length,b=function(pe){var ge=g.get(pe.id());return ge||(ge={},g.set(pe.id(),ge)),ge},w=function(pe){return(_e(pe)?c.$(pe):pe)[0]},_=function(pe){return b(w(pe)).dist},x=function(pe){for(var ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o,Ee=w(pe),Te=[],Se=Ee;;){if(Se==null)return r.spawn();var Ae=b(Se),De=Ae.edge,Ye=Ae.pred;if(Te.unshift(Se[0]),Se.same(ge)&&Te.length>0)break;De!=null&&Te.unshift(De),Se=Ye}return u.spawn(Te)},S=0;S<p;S++){var E=d[S],A=b(E);E.same(o)?A.dist=0:A.dist=1/0,A.pred=null,A.edge=null}for(var T=!1,D=function(pe,ge,Ee,Te,Se,Ae){var De=Te.dist+Ae;De<Se.dist&&!Ee.same(Te.edge)&&(Se.dist=De,Se.pred=pe,Se.edge=Ee,T=!0)},k=1;k<p;k++){T=!1;for(var M=0;M<y;M++){var P=h[M],I=P.source(),B=P.target(),L=l(P),N=b(I),F=b(B);D(I,B,P,N,F,L),s||D(B,I,P,F,N,L)}if(!T)break}if(T)for(var q=[],H=0;H<y;H++){var V=h[H],z=V.source(),Y=V.target(),Q=l(V),J=b(z).dist,ee=b(Y).dist;if(J+Q<ee||!s&&ee+Q<J)if(m||(st("Graph contains a negative weight cycle for Bellman-Ford"),m=!0),e.findNegativeWeightCycles!==!1){var ae=[];J+Q<ee&&ae.push(z),!s&&ee+Q<J&&ae.push(Y);for(var ue=ae.length,re=0;re<ue;re++){var U=ae[re],G=[U];G.push(b(U).edge);for(var j=b(U).pred;G.indexOf(j)===-1;)G.push(j),G.push(b(j).edge),j=b(j).pred;G=G.slice(G.indexOf(j));for(var se=G[0].id(),fe=0,Pe=2;Pe<G.length;Pe+=2)G[Pe].id()<se&&(se=G[Pe].id(),fe=Pe);G=G.slice(fe).concat(G.slice(0,fe)),G.push(G[0]);var wt=G.map(function(ot){return ot.id()}).join(",");q.indexOf(wt)===-1&&(v.push(u.spawn(G)),q.push(wt))}}else break}return{distanceTo:_,pathTo:x,hasNegativeWeightCycle:m,negativeWeightCycles:v}}},fW=Math.sqrt(2),hW=function(e,r,n){n.length===0&&St("Karger-Stein must be run on a connected (sub)graph");for(var a=n[e],s=a[1],o=a[2],l=r[s],u=r[o],c=n,f=c.length-1;f>=0;f--){var h=c[f],d=h[1],p=h[2];(r[d]===l&&r[p]===u||r[d]===u&&r[p]===l)&&c.splice(f,1)}for(var g=0;g<c.length;g++){var m=c[g];m[1]===u?(c[g]=m.slice(),c[g][1]=l):m[2]===u&&(c[g]=m.slice(),c[g][2]=l)}for(var v=0;v<r.length;v++)r[v]===u&&(r[v]=l);return c},rm=function(e,r,n,a){for(;n>a;){var s=Math.floor(Math.random()*r.length);r=hW(s,e,r),n--}return r},dW={kargerStein:function(){var e=this,r=this.byGroup(),n=r.nodes,a=r.edges;a.unmergeBy(function(F){return F.isLoop()});var s=n.length,o=a.length,l=Math.ceil(Math.pow(Math.log(s)/Math.LN2,2)),u=Math.floor(s/fW);if(s<2){St("At least 2 nodes are required for Karger-Stein algorithm");return}for(var c=[],f=0;f<o;f++){var h=a[f];c.push([f,n.indexOf(h.source()),n.indexOf(h.target())])}for(var d=1/0,p=[],g=new Array(s),m=new Array(s),v=new Array(s),y=function(q,H){for(var V=0;V<s;V++)H[V]=q[V]},b=0;b<=l;b++){for(var w=0;w<s;w++)m[w]=w;var _=rm(m,c.slice(),s,u),x=_.slice();y(m,v);var S=rm(m,_,u,2),E=rm(v,x,u,2);S.length<=E.length&&S.length<d?(d=S.length,p=S,y(m,g)):E.length<=S.length&&E.length<d&&(d=E.length,p=E,y(v,g))}for(var A=this.spawn(p.map(function(F){return a[F[0]]})),T=this.spawn(),D=this.spawn(),k=g[0],M=0;M<g.length;M++){var P=g[M],I=n[M];P===k?T.merge(I):D.merge(I)}var B=function(q){var H=e.spawn();return q.forEach(function(V){H.merge(V),V.connectedEdges().forEach(function(z){e.contains(z)&&!A.contains(z)&&H.merge(z)})}),H},L=[B(T),B(D)],N={cut:A,components:L,partition1:T,partition2:D};return N}},pW=function(e){return{x:e.x,y:e.y}},vh=function(e,r,n){return{x:e.x*r+n.x,y:e.y*r+n.y}},Sk=function(e,r,n){return{x:(e.x-n.x)/r,y:(e.y-n.y)/r}},Ls=function(e){return{x:e[0],y:e[1]}},gW=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=1/0,s=r;s<n;s++){var o=e[s];isFinite(o)&&(a=Math.min(o,a))}return a},vW=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=-1/0,s=r;s<n;s++){var o=e[s];isFinite(o)&&(a=Math.max(o,a))}return a},mW=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=0,s=0,o=r;o<n;o++){var l=e[o];isFinite(l)&&(a+=l,s++)}return a/s},yW=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;a?e=e.slice(r,n):(n<e.length&&e.splice(n,e.length-n),r>0&&e.splice(0,r));for(var l=0,u=e.length-1;u>=0;u--){var c=e[u];o?isFinite(c)||(e[u]=-1/0,l++):e.splice(u,1)}s&&e.sort(function(d,p){return d-p});var f=e.length,h=Math.floor(f/2);return f%2!==0?e[h+1+l]:(e[h-1+l]+e[h+l])/2},bW=function(e){return Math.PI*e/180},Rf=function(e,r){return Math.atan2(r,e)-Math.PI/2},Hy=Math.log2||function(t){return Math.log(t)/Math.log(2)},Uy=function(e){return e>0?1:e<0?-1:0},Ba=function(e,r){return Math.sqrt(Aa(e,r))},Aa=function(e,r){var n=r.x-e.x,a=r.y-e.y;return n*n+a*a},wW=function(e){for(var r=e.length,n=0,a=0;a<r;a++)n+=e[a];for(var s=0;s<r;s++)e[s]=e[s]/n;return e},Yt=function(e,r,n,a){return(1-a)*(1-a)*e+2*(1-a)*a*r+a*a*n},qs=function(e,r,n,a){return{x:Yt(e.x,r.x,n.x,a),y:Yt(e.y,r.y,n.y,a)}},_W=function(e,r,n,a){var s={x:r.x-e.x,y:r.y-e.y},o=Ba(e,r),l={x:s.x/o,y:s.y/o};return n=n??0,a=a??n*o,{x:e.x+l.x*a,y:e.y+l.y*a}},Fl=function(e,r,n){return Math.max(e,Math.min(n,r))},Br=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},xW=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}},EW=function(e){e.x1=1/0,e.y1=1/0,e.x2=-1/0,e.y2=-1/0,e.w=0,e.h=0},SW=function(e,r,n){return{x1:e.x1+r,x2:e.x2+r,y1:e.y1+n,y2:e.y2+n,w:e.w,h:e.h}},Ck=function(e,r){e.x1=Math.min(e.x1,r.x1),e.x2=Math.max(e.x2,r.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,r.y1),e.y2=Math.max(e.y2,r.y2),e.h=e.y2-e.y1},CW=function(e,r,n){e.x1=Math.min(e.x1,r),e.x2=Math.max(e.x2,r),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,n),e.y2=Math.max(e.y2,n),e.h=e.y2-e.y1},Uf=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=r,e.x2+=r,e.y1-=r,e.y2+=r,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},Wf=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],n,a,s,o;if(r.length===1)n=a=s=o=r[0];else if(r.length===2)n=s=r[0],o=a=r[1];else if(r.length===4){var l=zt(r,4);n=l[0],a=l[1],s=l[2],o=l[3]}return e.x1-=o,e.x2+=a,e.y1-=n,e.y2+=s,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},rC=function(e,r){e.x1=r.x1,e.y1=r.y1,e.x2=r.x2,e.y2=r.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},Wy=function(e,r){return!(e.x1>r.x2||r.x1>e.x2||e.x2<r.x1||r.x2<e.x1||e.y2<r.y1||r.y2<e.y1||e.y1>r.y2||r.y1>e.y2)},Ws=function(e,r,n){return e.x1<=r&&r<=e.x2&&e.y1<=n&&n<=e.y2},TW=function(e,r){return Ws(e,r.x,r.y)},kW=function(e,r){return Ws(e,r.x1,r.y1)&&Ws(e,r.x2,r.y2)},Tk=function(e,r,n,a,s,o,l){var u=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",c=u==="auto"?Li(s,o):u,f=s/2,h=o/2;c=Math.min(c,f,h);var d=c!==f,p=c!==h,g;if(d){var m=n-f+c-l,v=a-h-l,y=n+f-c+l,b=v;if(g=Ri(e,r,n,a,m,v,y,b,!1),g.length>0)return g}if(p){var w=n+f+l,_=a-h+c-l,x=w,S=a+h-c+l;if(g=Ri(e,r,n,a,w,_,x,S,!1),g.length>0)return g}if(d){var E=n-f+c-l,A=a+h+l,T=n+f-c+l,D=A;if(g=Ri(e,r,n,a,E,A,T,D,!1),g.length>0)return g}if(p){var k=n-f-l,M=a-h+c-l,P=k,I=a+h-c+l;if(g=Ri(e,r,n,a,k,M,P,I,!1),g.length>0)return g}var B;{var L=n-f+c,N=a-h+c;if(B=Ml(e,r,n,a,L,N,c+l),B.length>0&&B[0]<=L&&B[1]<=N)return[B[0],B[1]]}{var F=n+f-c,q=a-h+c;if(B=Ml(e,r,n,a,F,q,c+l),B.length>0&&B[0]>=F&&B[1]<=q)return[B[0],B[1]]}{var H=n+f-c,V=a+h-c;if(B=Ml(e,r,n,a,H,V,c+l),B.length>0&&B[0]>=H&&B[1]>=V)return[B[0],B[1]]}{var z=n-f+c,Y=a+h-c;if(B=Ml(e,r,n,a,z,Y,c+l),B.length>0&&B[0]<=z&&B[1]>=Y)return[B[0],B[1]]}return[]},AW=function(e,r,n,a,s,o,l){var u=l,c=Math.min(n,s),f=Math.max(n,s),h=Math.min(a,o),d=Math.max(a,o);return c-u<=e&&e<=f+u&&h-u<=r&&r<=d+u},MW=function(e,r,n,a,s,o,l,u,c){var f={x1:Math.min(n,l,s)-c,x2:Math.max(n,l,s)+c,y1:Math.min(a,u,o)-c,y2:Math.max(a,u,o)+c};return!(e<f.x1||e>f.x2||r<f.y1||r>f.y2)},PW=function(e,r,n,a){n-=a;var s=r*r-4*e*n;if(s<0)return[];var o=Math.sqrt(s),l=2*e,u=(-r+o)/l,c=(-r-o)/l;return[u,c]},RW=function(e,r,n,a,s){var o=1e-5;e===0&&(e=o),r/=e,n/=e,a/=e;var l,u,c,f,h,d,p,g;if(u=(3*n-r*r)/9,c=-(27*a)+r*(9*n-2*(r*r)),c/=54,l=u*u*u+c*c,s[1]=0,p=r/3,l>0){h=c+Math.sqrt(l),h=h<0?-Math.pow(-h,1/3):Math.pow(h,1/3),d=c-Math.sqrt(l),d=d<0?-Math.pow(-d,1/3):Math.pow(d,1/3),s[0]=-p+h+d,p+=(h+d)/2,s[4]=s[2]=-p,p=Math.sqrt(3)*(-d+h)/2,s[3]=p,s[5]=-p;return}if(s[5]=s[3]=0,l===0){g=c<0?-Math.pow(-c,1/3):Math.pow(c,1/3),s[0]=-p+2*g,s[4]=s[2]=-(g+p);return}u=-u,f=u*u*u,f=Math.acos(c/Math.sqrt(f)),g=2*Math.sqrt(u),s[0]=-p+g*Math.cos(f/3),s[2]=-p+g*Math.cos((f+2*Math.PI)/3),s[4]=-p+g*Math.cos((f+4*Math.PI)/3)},DW=function(e,r,n,a,s,o,l,u){var c=1*n*n-4*n*s+2*n*l+4*s*s-4*s*l+l*l+a*a-4*a*o+2*a*u+4*o*o-4*o*u+u*u,f=1*9*n*s-3*n*n-3*n*l-6*s*s+3*s*l+9*a*o-3*a*a-3*a*u-6*o*o+3*o*u,h=1*3*n*n-6*n*s+n*l-n*e+2*s*s+2*s*e-l*e+3*a*a-6*a*o+a*u-a*r+2*o*o+2*o*r-u*r,d=1*n*s-n*n+n*e-s*e+a*o-a*a+a*r-o*r,p=[];RW(c,f,h,d,p);for(var g=1e-7,m=[],v=0;v<6;v+=2)Math.abs(p[v+1])<g&&p[v]>=0&&p[v]<=1&&m.push(p[v]);m.push(1),m.push(0);for(var y=-1,b,w,_,x=0;x<m.length;x++)b=Math.pow(1-m[x],2)*n+2*(1-m[x])*m[x]*s+m[x]*m[x]*l,w=Math.pow(1-m[x],2)*a+2*(1-m[x])*m[x]*o+m[x]*m[x]*u,_=Math.pow(b-e,2)+Math.pow(w-r,2),y>=0?_<y&&(y=_):y=_;return y},OW=function(e,r,n,a,s,o){var l=[e-n,r-a],u=[s-n,o-a],c=u[0]*u[0]+u[1]*u[1],f=l[0]*l[0]+l[1]*l[1],h=l[0]*u[0]+l[1]*u[1],d=h*h/c;return h<0?f:d>c?(e-s)*(e-s)+(r-o)*(r-o):f-d},Or=function(e,r,n){for(var a,s,o,l,u,c=0,f=0;f<n.length/2;f++)if(a=n[f*2],s=n[f*2+1],f+1<n.length/2?(o=n[(f+1)*2],l=n[(f+1)*2+1]):(o=n[(f+1-n.length/2)*2],l=n[(f+1-n.length/2)*2+1]),!(a==e&&o==e))if(a>=e&&e>=o||a<=e&&e<=o)u=(e-a)/(o-a)*(l-s)+s,u>r&&c++;else continue;return c%2!==0},ni=function(e,r,n,a,s,o,l,u,c){var f=new Array(n.length),h;u[0]!=null?(h=Math.atan(u[1]/u[0]),u[0]<0?h=h+Math.PI/2:h=-h-Math.PI/2):h=u;for(var d=Math.cos(-h),p=Math.sin(-h),g=0;g<f.length/2;g++)f[g*2]=o/2*(n[g*2]*d-n[g*2+1]*p),f[g*2+1]=l/2*(n[g*2+1]*d+n[g*2]*p),f[g*2]+=a,f[g*2+1]+=s;var m;if(c>0){var v=ih(f,-c);m=nh(v)}else m=f;return Or(e,r,m)},IW=function(e,r,n,a,s,o,l,u){for(var c=new Array(n.length*2),f=0;f<u.length;f++){var h=u[f];c[f*4+0]=h.startX,c[f*4+1]=h.startY,c[f*4+2]=h.stopX,c[f*4+3]=h.stopY;var d=Math.pow(h.cx-e,2)+Math.pow(h.cy-r,2);if(d<=Math.pow(h.radius,2))return!0}return Or(e,r,c)},nh=function(e){for(var r=new Array(e.length/2),n,a,s,o,l,u,c,f,h=0;h<e.length/4;h++){n=e[h*4],a=e[h*4+1],s=e[h*4+2],o=e[h*4+3],h<e.length/4-1?(l=e[(h+1)*4],u=e[(h+1)*4+1],c=e[(h+1)*4+2],f=e[(h+1)*4+3]):(l=e[0],u=e[1],c=e[2],f=e[3]);var d=Ri(n,a,s,o,l,u,c,f,!0);r[h*2]=d[0],r[h*2+1]=d[1]}return r},ih=function(e,r){for(var n=new Array(e.length*2),a,s,o,l,u=0;u<e.length/2;u++){a=e[u*2],s=e[u*2+1],u<e.length/2-1?(o=e[(u+1)*2],l=e[(u+1)*2+1]):(o=e[0],l=e[1]);var c=l-s,f=-(o-a),h=Math.sqrt(c*c+f*f),d=c/h,p=f/h;n[u*4]=a+d*r,n[u*4+1]=s+p*r,n[u*4+2]=o+d*r,n[u*4+3]=l+p*r}return n},BW=function(e,r,n,a,s,o){var l=n-e,u=a-r;l/=s,u/=o;var c=Math.sqrt(l*l+u*u),f=c-1;if(f<0)return[];var h=f/c;return[(n-e)*h+e,(a-r)*h+r]},Oa=function(e,r,n,a,s,o,l){return e-=s,r-=o,e/=n/2+l,r/=a/2+l,e*e+r*r<=1},Ml=function(e,r,n,a,s,o,l){var u=[n-e,a-r],c=[e-s,r-o],f=u[0]*u[0]+u[1]*u[1],h=2*(c[0]*u[0]+c[1]*u[1]),d=c[0]*c[0]+c[1]*c[1]-l*l,p=h*h-4*f*d;if(p<0)return[];var g=(-h+Math.sqrt(p))/(2*f),m=(-h-Math.sqrt(p))/(2*f),v=Math.min(g,m),y=Math.max(g,m),b=[];if(v>=0&&v<=1&&b.push(v),y>=0&&y<=1&&b.push(y),b.length===0)return[];var w=b[0]*u[0]+e,_=b[0]*u[1]+r;if(b.length>1){if(b[0]==b[1])return[w,_];var x=b[1]*u[0]+e,S=b[1]*u[1]+r;return[w,_,x,S]}else return[w,_]},nm=function(e,r,n){return r<=e&&e<=n||n<=e&&e<=r?e:e<=r&&r<=n||n<=r&&r<=e?r:n},Ri=function(e,r,n,a,s,o,l,u,c){var f=e-s,h=n-e,d=l-s,p=r-o,g=a-r,m=u-o,v=d*p-m*f,y=h*p-g*f,b=m*h-d*g;if(b!==0){var w=v/b,_=y/b,x=.001,S=0-x,E=1+x;return S<=w&&w<=E&&S<=_&&_<=E?[e+w*h,r+w*g]:c?[e+w*h,r+w*g]:[]}else return v===0||y===0?nm(e,n,l)===l?[l,u]:nm(e,n,s)===s?[s,o]:nm(s,l,n)===n?[n,a]:[]:[]},ql=function(e,r,n,a,s,o,l,u){var c=[],f,h=new Array(n.length),d=!0;o==null&&(d=!1);var p;if(d){for(var g=0;g<h.length/2;g++)h[g*2]=n[g*2]*o+a,h[g*2+1]=n[g*2+1]*l+s;if(u>0){var m=ih(h,-u);p=nh(m)}else p=h}else p=n;for(var v,y,b,w,_=0;_<p.length/2;_++)v=p[_*2],y=p[_*2+1],_<p.length/2-1?(b=p[(_+1)*2],w=p[(_+1)*2+1]):(b=p[0],w=p[1]),f=Ri(e,r,a,s,v,y,b,w),f.length!==0&&c.push(f[0],f[1]);return c},LW=function(e,r,n,a,s,o,l,u,c){var f=[],h,d=new Array(n.length*2);c.forEach(function(b,w){w===0?(d[d.length-2]=b.startX,d[d.length-1]=b.startY):(d[w*4-2]=b.startX,d[w*4-1]=b.startY),d[w*4]=b.stopX,d[w*4+1]=b.stopY,h=Ml(e,r,a,s,b.cx,b.cy,b.radius),h.length!==0&&f.push(h[0],h[1])});for(var p=0;p<d.length/4;p++)h=Ri(e,r,a,s,d[p*4],d[p*4+1],d[p*4+2],d[p*4+3],!1),h.length!==0&&f.push(h[0],h[1]);if(f.length>2){for(var g=[f[0],f[1]],m=Math.pow(g[0]-e,2)+Math.pow(g[1]-r,2),v=1;v<f.length/2;v++){var y=Math.pow(f[v*2]-e,2)+Math.pow(f[v*2+1]-r,2);y<=m&&(g[0]=f[v*2],g[1]=f[v*2+1],m=y)}return g}return f},Df=function(e,r,n){var a=[e[0]-r[0],e[1]-r[1]],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]),o=(s-n)/s;return o<0&&(o=1e-5),[r[0]+o*a[0],r[1]+o*a[1]]},br=function(e,r){var n=vy(e,r);return n=kk(n),n},kk=function(e){for(var r,n,a=e.length/2,s=1/0,o=1/0,l=-1/0,u=-1/0,c=0;c<a;c++)r=e[2*c],n=e[2*c+1],s=Math.min(s,r),l=Math.max(l,r),o=Math.min(o,n),u=Math.max(u,n);for(var f=2/(l-s),h=2/(u-o),d=0;d<a;d++)r=e[2*d]=e[2*d]*f,n=e[2*d+1]=e[2*d+1]*h,s=Math.min(s,r),l=Math.max(l,r),o=Math.min(o,n),u=Math.max(u,n);if(o<-1)for(var p=0;p<a;p++)n=e[2*p+1]=e[2*p+1]+(-1-o);return e},vy=function(e,r){var n=1/e*2*Math.PI,a=e%2===0?Math.PI/2+n/2:Math.PI/2;a+=r;for(var s=new Array(e*2),o,l=0;l<e;l++)o=l*n+a,s[2*l]=Math.cos(o),s[2*l+1]=Math.sin(-o);return s},Li=function(e,r){return Math.min(e/4,r/4,8)},Ak=function(e,r){return Math.min(e/10,r/10,8)},Gy=function(){return 8},NW=function(e,r,n){return[e-2*r+n,2*(r-e),e]},my=function(e,r){return{heightOffset:Math.min(15,.05*r),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}};function FW(t,e){function r(h){for(var d=[],p=0;p<h.length;p++){var g=h[p],m=h[(p+1)%h.length],v={x:m.x-g.x,y:m.y-g.y},y={x:-v.y,y:v.x},b=Math.sqrt(y.x*y.x+y.y*y.y);d.push({x:y.x/b,y:y.y/b})}return d}function n(h,d){var p=1/0,g=-1/0,m=Ir(h),v;try{for(m.s();!(v=m.n()).done;){var y=v.value,b=y.x*d.x+y.y*d.y;p=Math.min(p,b),g=Math.max(g,b)}}catch(w){m.e(w)}finally{m.f()}return{min:p,max:g}}function a(h,d){return!(h.max<d.min||d.max<h.min)}var s=[].concat(Jf(r(t)),Jf(r(e))),o=Ir(s),l;try{for(o.s();!(l=o.n()).done;){var u=l.value,c=n(t,u),f=n(e,u);if(!a(c,f))return!1}}catch(h){o.e(h)}finally{o.f()}return!0}var qW=ar({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),VW={pageRank:function(e){for(var r=qW(e),n=r.dampingFactor,a=r.precision,s=r.iterations,o=r.weight,l=this._private.cy,u=this.byGroup(),c=u.nodes,f=u.edges,h=c.length,d=h*h,p=f.length,g=new Array(d),m=new Array(h),v=(1-n)/h,y=0;y<h;y++){for(var b=0;b<h;b++){var w=y*h+b;g[w]=0}m[y]=0}for(var _=0;_<p;_++){var x=f[_],S=x.data("source"),E=x.data("target");if(S!==E){var A=c.indexOfId(S),T=c.indexOfId(E),D=o(x),k=T*h+A;g[k]+=D,m[A]+=D}}for(var M=1/h+v,P=0;P<h;P++)if(m[P]===0)for(var I=0;I<h;I++){var B=I*h+P;g[B]=M}else for(var L=0;L<h;L++){var N=L*h+P;g[N]=g[N]/m[P]+v}for(var F=new Array(h),q=new Array(h),H,V=0;V<h;V++)F[V]=1;for(var z=0;z<s;z++){for(var Y=0;Y<h;Y++)q[Y]=0;for(var Q=0;Q<h;Q++)for(var J=0;J<h;J++){var ee=Q*h+J;q[Q]+=g[ee]*F[J]}wW(q),H=F,F=q,q=H;for(var ae=0,ue=0;ue<h;ue++){var re=H[ue]-F[ue];ae+=re*re}if(ae<a)break}var U={rank:function(j){return j=l.collection(j)[0],F[c.indexOf(j)]}};return U}},nC=ar({root:null,weight:function(e){return 1},directed:!1,alpha:0}),Vs={degreeCentralityNormalized:function(e){e=nC(e);var r=this.cy(),n=this.nodes(),a=n.length;if(e.directed){for(var f={},h={},d=0,p=0,g=0;g<a;g++){var m=n[g],v=m.id();e.root=m;var y=this.degreeCentrality(e);d<y.indegree&&(d=y.indegree),p<y.outdegree&&(p=y.outdegree),f[v]=y.indegree,h[v]=y.outdegree}return{indegree:function(w){return d==0?0:(_e(w)&&(w=r.filter(w)),f[w.id()]/d)},outdegree:function(w){return p===0?0:(_e(w)&&(w=r.filter(w)),h[w.id()]/p)}}}else{for(var s={},o=0,l=0;l<a;l++){var u=n[l];e.root=u;var c=this.degreeCentrality(e);o<c.degree&&(o=c.degree),s[u.id()]=c.degree}return{degree:function(w){return o===0?0:(_e(w)&&(w=r.filter(w)),s[w.id()]/o)}}}},degreeCentrality:function(e){e=nC(e);var r=this.cy(),n=this,a=e,s=a.root,o=a.weight,l=a.directed,u=a.alpha;if(s=r.collection(s)[0],l){for(var p=s.connectedEdges(),g=p.filter(function(S){return S.target().same(s)&&n.has(S)}),m=p.filter(function(S){return S.source().same(s)&&n.has(S)}),v=g.length,y=m.length,b=0,w=0,_=0;_<g.length;_++)b+=o(g[_]);for(var x=0;x<m.length;x++)w+=o(m[x]);return{indegree:Math.pow(v,1-u)*Math.pow(b,u),outdegree:Math.pow(y,1-u)*Math.pow(w,u)}}else{for(var c=s.connectedEdges().intersection(n),f=c.length,h=0,d=0;d<c.length;d++)h+=o(c[d]);return{degree:Math.pow(f,1-u)*Math.pow(h,u)}}}};Vs.dc=Vs.degreeCentrality;Vs.dcn=Vs.degreeCentralityNormalised=Vs.degreeCentralityNormalized;var iC=ar({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),zs={closenessCentralityNormalized:function(e){for(var r=iC(e),n=r.harmonic,a=r.weight,s=r.directed,o=this.cy(),l={},u=0,c=this.nodes(),f=this.floydWarshall({weight:a,directed:s}),h=0;h<c.length;h++){for(var d=0,p=c[h],g=0;g<c.length;g++)if(h!==g){var m=f.distance(p,c[g]);n?d+=1/m:d+=m}n||(d=1/d),u<d&&(u=d),l[p.id()]=d}return{closeness:function(y){return u==0?0:(_e(y)?y=o.filter(y)[0].id():y=y.id(),l[y]/u)}}},closenessCentrality:function(e){var r=iC(e),n=r.root,a=r.weight,s=r.directed,o=r.harmonic;n=this.filter(n)[0];for(var l=this.dijkstra({root:n,weight:a,directed:s}),u=0,c=this.nodes(),f=0;f<c.length;f++){var h=c[f];if(!h.same(n)){var d=l.distanceTo(h);o?u+=1/d:u+=d}}return o?u:1/u}};zs.cc=zs.closenessCentrality;zs.ccn=zs.closenessCentralityNormalised=zs.closenessCentralityNormalized;var zW=ar({weight:null,directed:!1}),yy={betweennessCentrality:function(e){for(var r=zW(e),n=r.directed,a=r.weight,s=a!=null,o=this.cy(),l=this.nodes(),u={},c={},f=0,h={set:function(w,_){c[w]=_,_>f&&(f=_)},get:function(w){return c[w]}},d=0;d<l.length;d++){var p=l[d],g=p.id();n?u[g]=p.outgoers().nodes():u[g]=p.openNeighborhood().nodes(),h.set(g,0)}for(var m=function(){for(var w=l[v].id(),_=[],x={},S={},E={},A=new $l(function(Q,J){return E[Q]-E[J]}),T=0;T<l.length;T++){var D=l[T].id();x[D]=[],S[D]=0,E[D]=1/0}for(S[w]=1,E[w]=0,A.push(w);!A.empty();){var k=A.pop();if(_.push(k),s)for(var M=0;M<u[k].length;M++){var P=u[k][M],I=o.getElementById(k),B=void 0;I.edgesTo(P).length>0?B=I.edgesTo(P)[0]:B=P.edgesTo(I)[0];var L=a(B);P=P.id(),E[P]>E[k]+L&&(E[P]=E[k]+L,A.nodes.indexOf(P)<0?A.push(P):A.updateItem(P),S[P]=0,x[P]=[]),E[P]==E[k]+L&&(S[P]=S[P]+S[k],x[P].push(k))}else for(var N=0;N<u[k].length;N++){var F=u[k][N].id();E[F]==1/0&&(A.push(F),E[F]=E[k]+1),E[F]==E[k]+1&&(S[F]=S[F]+S[k],x[F].push(k))}}for(var q={},H=0;H<l.length;H++)q[l[H].id()]=0;for(;_.length>0;){for(var V=_.pop(),z=0;z<x[V].length;z++){var Y=x[V][z];q[Y]=q[Y]+S[Y]/S[V]*(1+q[V])}V!=l[v].id()&&h.set(V,h.get(V)+q[V])}},v=0;v<l.length;v++)m();var y={betweenness:function(w){var _=o.collection(w).id();return h.get(_)},betweennessNormalized:function(w){if(f==0)return 0;var _=o.collection(w).id();return h.get(_)/f}};return y.betweennessNormalised=y.betweennessNormalized,y}};yy.bc=yy.betweennessCentrality;var HW=ar({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(t){return 1}]}),UW=function(e){return HW(e)},WW=function(e,r){for(var n=0,a=0;a<r.length;a++)n+=r[a](e);return n},GW=function(e,r,n){for(var a=0;a<r;a++)e[a*r+a]=n},Mk=function(e,r){for(var n,a=0;a<r;a++){n=0;for(var s=0;s<r;s++)n+=e[s*r+a];for(var o=0;o<r;o++)e[o*r+a]=e[o*r+a]/n}},KW=function(e,r,n){for(var a=new Array(n*n),s=0;s<n;s++){for(var o=0;o<n;o++)a[s*n+o]=0;for(var l=0;l<n;l++)for(var u=0;u<n;u++)a[s*n+u]+=e[s*n+l]*r[l*n+u]}return a},jW=function(e,r,n){for(var a=e.slice(0),s=1;s<n;s++)e=KW(e,a,r);return e},YW=function(e,r,n){for(var a=new Array(r*r),s=0;s<r*r;s++)a[s]=Math.pow(e[s],n);return Mk(a,r),a},ZW=function(e,r,n,a){for(var s=0;s<n;s++){var o=Math.round(e[s]*Math.pow(10,a))/Math.pow(10,a),l=Math.round(r[s]*Math.pow(10,a))/Math.pow(10,a);if(o!==l)return!1}return!0},XW=function(e,r,n,a){for(var s=[],o=0;o<r;o++){for(var l=[],u=0;u<r;u++)Math.round(e[o*r+u]*1e3)/1e3>0&&l.push(n[u]);l.length!==0&&s.push(a.collection(l))}return s},$W=function(e,r){for(var n=0;n<e.length;n++)if(!r[n]||e[n].id()!==r[n].id())return!1;return!0},QW=function(e){for(var r=0;r<e.length;r++)for(var n=0;n<e.length;n++)r!=n&&$W(e[r],e[n])&&e.splice(n,1);return e},aC=function(e){for(var r=this.nodes(),n=this.edges(),a=this.cy(),s=UW(e),o={},l=0;l<r.length;l++)o[r[l].id()]=l;for(var u=r.length,c=u*u,f=new Array(c),h,d=0;d<c;d++)f[d]=0;for(var p=0;p<n.length;p++){var g=n[p],m=o[g.source().id()],v=o[g.target().id()],y=WW(g,s.attributes);f[m*u+v]+=y,f[v*u+m]+=y}GW(f,u,s.multFactor),Mk(f,u);for(var b=!0,w=0;b&&w<s.maxIterations;)b=!1,h=jW(f,u,s.expandFactor),f=YW(h,u,s.inflateFactor),ZW(f,h,c,4)||(b=!0),w++;var _=XW(f,u,r,a);return _=QW(_),_},JW={markovClustering:aC,mcl:aC},e8=function(e){return e},Pk=function(e,r){return Math.abs(r-e)},sC=function(e,r,n){return e+Pk(r,n)},oC=function(e,r,n){return e+Math.pow(n-r,2)},t8=function(e){return Math.sqrt(e)},r8=function(e,r,n){return Math.max(e,Pk(r,n))},xl=function(e,r,n,a,s){for(var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:e8,l=a,u,c,f=0;f<e;f++)u=r(f),c=n(f),l=s(l,u,c);return o(l)},Gs={euclidean:function(e,r,n){return e>=2?xl(e,r,n,0,oC,t8):xl(e,r,n,0,sC)},squaredEuclidean:function(e,r,n){return xl(e,r,n,0,oC)},manhattan:function(e,r,n){return xl(e,r,n,0,sC)},max:function(e,r,n){return xl(e,r,n,-1/0,r8)}};Gs["squared-euclidean"]=Gs.squaredEuclidean;Gs.squaredeuclidean=Gs.squaredEuclidean;function mh(t,e,r,n,a,s){var o;return Ct(t)?o=t:o=Gs[t]||Gs.euclidean,e===0&&Ct(t)?o(a,s):o(e,r,n,a,s)}var n8=ar({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),Ky=function(e){return n8(e)},ah=function(e,r,n,a,s){var o=s!=="kMedoids",l=o?function(h){return n[h]}:function(h){return a[h](n)},u=function(d){return a[d](r)},c=n,f=r;return mh(e,a.length,l,u,c,f)},im=function(e,r,n){for(var a=n.length,s=new Array(a),o=new Array(a),l=new Array(r),u=null,c=0;c<a;c++)s[c]=e.min(n[c]).value,o[c]=e.max(n[c]).value;for(var f=0;f<r;f++){u=[];for(var h=0;h<a;h++)u[h]=Math.random()*(o[h]-s[h])+s[h];l[f]=u}return l},Rk=function(e,r,n,a,s){for(var o=1/0,l=0,u=0;u<r.length;u++){var c=ah(n,e,r[u],a,s);c<o&&(o=c,l=u)}return l},Dk=function(e,r,n){for(var a=[],s=null,o=0;o<r.length;o++)s=r[o],n[s.id()]===e&&a.push(s);return a},i8=function(e,r,n){return Math.abs(r-e)<=n},a8=function(e,r,n){for(var a=0;a<e.length;a++)for(var s=0;s<e[a].length;s++){var o=Math.abs(e[a][s]-r[a][s]);if(o>n)return!1}return!0},s8=function(e,r,n){for(var a=0;a<n;a++)if(e===r[a])return!0;return!1},lC=function(e,r){var n=new Array(r);if(e.length<50)for(var a=0;a<r;a++){for(var s=e[Math.floor(Math.random()*e.length)];s8(s,n,a);)s=e[Math.floor(Math.random()*e.length)];n[a]=s}else for(var o=0;o<r;o++)n[o]=e[Math.floor(Math.random()*e.length)];return n},uC=function(e,r,n){for(var a=0,s=0;s<r.length;s++)a+=ah("manhattan",r[s],e,n,"kMedoids");return a},o8=function(e){var r=this.cy(),n=this.nodes(),a=null,s=Ky(e),o=new Array(s.k),l={},u;s.testMode?typeof s.testCentroids=="number"?(s.testCentroids,u=im(n,s.k,s.attributes)):Ut(s.testCentroids)==="object"?u=s.testCentroids:u=im(n,s.k,s.attributes):u=im(n,s.k,s.attributes);for(var c=!0,f=0;c&&f<s.maxIterations;){for(var h=0;h<n.length;h++)a=n[h],l[a.id()]=Rk(a,u,s.distance,s.attributes,"kMeans");c=!1;for(var d=0;d<s.k;d++){var p=Dk(d,n,l);if(p.length!==0){for(var g=s.attributes.length,m=u[d],v=new Array(g),y=new Array(g),b=0;b<g;b++){y[b]=0;for(var w=0;w<p.length;w++)a=p[w],y[b]+=s.attributes[b](a);v[b]=y[b]/p.length,i8(v[b],m[b],s.sensitivityThreshold)||(c=!0)}u[d]=v,o[d]=r.collection(p)}}f++}return o},l8=function(e){var r=this.cy(),n=this.nodes(),a=null,s=Ky(e),o=new Array(s.k),l,u={},c,f=new Array(s.k);s.testMode?typeof s.testCentroids=="number"||(Ut(s.testCentroids)==="object"?l=s.testCentroids:l=lC(n,s.k)):l=lC(n,s.k);for(var h=!0,d=0;h&&d<s.maxIterations;){for(var p=0;p<n.length;p++)a=n[p],u[a.id()]=Rk(a,l,s.distance,s.attributes,"kMedoids");h=!1;for(var g=0;g<l.length;g++){var m=Dk(g,n,u);if(m.length!==0){f[g]=uC(l[g],m,s.attributes);for(var v=0;v<m.length;v++)c=uC(m[v],m,s.attributes),c<f[g]&&(f[g]=c,l[g]=m[v],h=!0);o[g]=r.collection(m)}}d++}return o},u8=function(e,r,n,a,s){for(var o,l,u=0;u<r.length;u++)for(var c=0;c<e.length;c++)a[u][c]=Math.pow(n[u][c],s.m);for(var f=0;f<e.length;f++)for(var h=0;h<s.attributes.length;h++){o=0,l=0;for(var d=0;d<r.length;d++)o+=a[d][f]*s.attributes[h](r[d]),l+=a[d][f];e[f][h]=o/l}},c8=function(e,r,n,a,s){for(var o=0;o<e.length;o++)r[o]=e[o].slice();for(var l,u,c,f=2/(s.m-1),h=0;h<n.length;h++)for(var d=0;d<a.length;d++){l=0;for(var p=0;p<n.length;p++)u=ah(s.distance,a[d],n[h],s.attributes,"cmeans"),c=ah(s.distance,a[d],n[p],s.attributes,"cmeans"),l+=Math.pow(u/c,f);e[d][h]=1/l}},f8=function(e,r,n,a){for(var s=new Array(n.k),o=0;o<s.length;o++)s[o]=[];for(var l,u,c=0;c<r.length;c++){l=-1/0,u=-1;for(var f=0;f<r[0].length;f++)r[c][f]>l&&(l=r[c][f],u=f);s[u].push(e[c])}for(var h=0;h<s.length;h++)s[h]=a.collection(s[h]);return s},cC=function(e){var r=this.cy(),n=this.nodes(),a=Ky(e),s,o,l,u,c;u=new Array(n.length);for(var f=0;f<n.length;f++)u[f]=new Array(a.k);l=new Array(n.length);for(var h=0;h<n.length;h++)l[h]=new Array(a.k);for(var d=0;d<n.length;d++){for(var p=0,g=0;g<a.k;g++)l[d][g]=Math.random(),p+=l[d][g];for(var m=0;m<a.k;m++)l[d][m]=l[d][m]/p}o=new Array(a.k);for(var v=0;v<a.k;v++)o[v]=new Array(a.attributes.length);c=new Array(n.length);for(var y=0;y<n.length;y++)c[y]=new Array(a.k);for(var b=!0,w=0;b&&w<a.maxIterations;)b=!1,u8(o,n,l,c,a),c8(l,u,o,n,a),a8(l,u,a.sensitivityThreshold)||(b=!0),w++;return s=f8(n,l,a,r),{clusters:s,degreeOfMembership:l}},h8={kMeans:o8,kMedoids:l8,fuzzyCMeans:cC,fcm:cC},d8=ar({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),p8={single:"min",complete:"max"},g8=function(e){var r=d8(e),n=p8[r.linkage];return n!=null&&(r.linkage=n),r},fC=function(e,r,n,a,s){for(var o=0,l=1/0,u,c=s.attributes,f=function(T,D){return mh(s.distance,c.length,function(k){return c[k](T)},function(k){return c[k](D)},T,D)},h=0;h<e.length;h++){var d=e[h].key,p=n[d][a[d]];p<l&&(o=d,l=p)}if(s.mode==="threshold"&&l>=s.threshold||s.mode==="dendrogram"&&e.length===1)return!1;var g=r[o],m=r[a[o]],v;s.mode==="dendrogram"?v={left:g,right:m,key:g.key}:v={value:g.value.concat(m.value),key:g.key},e[g.index]=v,e.splice(m.index,1),r[g.key]=v;for(var y=0;y<e.length;y++){var b=e[y];g.key===b.key?u=1/0:s.linkage==="min"?(u=n[g.key][b.key],n[g.key][b.key]>n[m.key][b.key]&&(u=n[m.key][b.key])):s.linkage==="max"?(u=n[g.key][b.key],n[g.key][b.key]<n[m.key][b.key]&&(u=n[m.key][b.key])):s.linkage==="mean"?u=(n[g.key][b.key]*g.size+n[m.key][b.key]*m.size)/(g.size+m.size):s.mode==="dendrogram"?u=f(b.value,g.value):u=f(b.value[0],g.value[0]),n[g.key][b.key]=n[b.key][g.key]=u}for(var w=0;w<e.length;w++){var _=e[w].key;if(a[_]===g.key||a[_]===m.key){for(var x=_,S=0;S<e.length;S++){var E=e[S].key;n[_][E]<n[_][x]&&(x=E)}a[_]=x}e[w].index=w}return g.key=m.key=g.index=m.index=null,!0},Ns=function(e,r,n){e&&(e.value?r.push(e.value):(e.left&&Ns(e.left,r),e.right&&Ns(e.right,r)))},by=function(e,r){if(!e)return"";if(e.left&&e.right){var n=by(e.left,r),a=by(e.right,r),s=r.add({group:"nodes",data:{id:n+","+a}});return r.add({group:"edges",data:{source:n,target:s.id()}}),r.add({group:"edges",data:{source:a,target:s.id()}}),s.id()}else if(e.value)return e.value.id()},wy=function(e,r,n){if(!e)return[];var a=[],s=[],o=[];return r===0?(e.left&&Ns(e.left,a),e.right&&Ns(e.right,s),o=a.concat(s),[n.collection(o)]):r===1?e.value?[n.collection(e.value)]:(e.left&&Ns(e.left,a),e.right&&Ns(e.right,s),[n.collection(a),n.collection(s)]):e.value?[n.collection(e.value)]:(e.left&&(a=wy(e.left,r-1,n)),e.right&&(s=wy(e.right,r-1,n)),a.concat(s))},hC=function(e){for(var r=this.cy(),n=this.nodes(),a=g8(e),s=a.attributes,o=function(w,_){return mh(a.distance,s.length,function(x){return s[x](w)},function(x){return s[x](_)},w,_)},l=[],u=[],c=[],f=[],h=0;h<n.length;h++){var d={value:a.mode==="dendrogram"?n[h]:[n[h]],key:h,index:h};l[h]=d,f[h]=d,u[h]=[],c[h]=0}for(var p=0;p<l.length;p++)for(var g=0;g<=p;g++){var m=void 0;a.mode==="dendrogram"?m=p===g?1/0:o(l[p].value,l[g].value):m=p===g?1/0:o(l[p].value[0],l[g].value[0]),u[p][g]=m,u[g][p]=m,m<u[p][c[p]]&&(c[p]=g)}for(var v=fC(l,f,u,c,a);v;)v=fC(l,f,u,c,a);var y;return a.mode==="dendrogram"?(y=wy(l[0],a.dendrogramDepth,r),a.addDendrogram&&by(l[0],r)):(y=new Array(l.length),l.forEach(function(b,w){b.key=b.index=null,y[w]=r.collection(b.value)})),y},v8={hierarchicalClustering:hC,hca:hC},m8=ar({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),y8=function(e){var r=e.damping,n=e.preference;.5<=r&&r<1||St("Damping must range on [0.5, 1).  Got: ".concat(r));var a=["median","mean","min","max"];return a.some(function(s){return s===n})||le(n)||St("Preference must be one of [".concat(a.map(function(s){return"'".concat(s,"'")}).join(", "),"] or a number.  Got: ").concat(n)),m8(e)},b8=function(e,r,n,a){var s=function(l,u){return a[u](l)};return-mh(e,a.length,function(o){return s(r,o)},function(o){return s(n,o)},r,n)},w8=function(e,r){var n=null;return r==="median"?n=yW(e):r==="mean"?n=mW(e):r==="min"?n=gW(e):r==="max"?n=vW(e):n=r,n},_8=function(e,r,n){for(var a=[],s=0;s<e;s++)r[s*e+s]+n[s*e+s]>0&&a.push(s);return a},dC=function(e,r,n){for(var a=[],s=0;s<e;s++){for(var o=-1,l=-1/0,u=0;u<n.length;u++){var c=n[u];r[s*e+c]>l&&(o=c,l=r[s*e+c])}o>0&&a.push(o)}for(var f=0;f<n.length;f++)a[n[f]]=n[f];return a},x8=function(e,r,n){for(var a=dC(e,r,n),s=0;s<n.length;s++){for(var o=[],l=0;l<a.length;l++)a[l]===n[s]&&o.push(l);for(var u=-1,c=-1/0,f=0;f<o.length;f++){for(var h=0,d=0;d<o.length;d++)h+=r[o[d]*e+o[f]];h>c&&(u=f,c=h)}n[s]=o[u]}return a=dC(e,r,n),a},pC=function(e){for(var r=this.cy(),n=this.nodes(),a=y8(e),s={},o=0;o<n.length;o++)s[n[o].id()]=o;var l,u,c,f,h,d;l=n.length,u=l*l,c=new Array(u);for(var p=0;p<u;p++)c[p]=-1/0;for(var g=0;g<l;g++)for(var m=0;m<l;m++)g!==m&&(c[g*l+m]=b8(a.distance,n[g],n[m],a.attributes));f=w8(c,a.preference);for(var v=0;v<l;v++)c[v*l+v]=f;h=new Array(u);for(var y=0;y<u;y++)h[y]=0;d=new Array(u);for(var b=0;b<u;b++)d[b]=0;for(var w=new Array(l),_=new Array(l),x=new Array(l),S=0;S<l;S++)w[S]=0,_[S]=0,x[S]=0;for(var E=new Array(l*a.minIterations),A=0;A<E.length;A++)E[A]=0;var T;for(T=0;T<a.maxIterations;T++){for(var D=0;D<l;D++){for(var k=-1/0,M=-1/0,P=-1,I=0,B=0;B<l;B++)w[B]=h[D*l+B],I=d[D*l+B]+c[D*l+B],I>=k?(M=k,k=I,P=B):I>M&&(M=I);for(var L=0;L<l;L++)h[D*l+L]=(1-a.damping)*(c[D*l+L]-k)+a.damping*w[L];h[D*l+P]=(1-a.damping)*(c[D*l+P]-M)+a.damping*w[P]}for(var N=0;N<l;N++){for(var F=0,q=0;q<l;q++)w[q]=d[q*l+N],_[q]=Math.max(0,h[q*l+N]),F+=_[q];F-=_[N],_[N]=h[N*l+N],F+=_[N];for(var H=0;H<l;H++)d[H*l+N]=(1-a.damping)*Math.min(0,F-_[H])+a.damping*w[H];d[N*l+N]=(1-a.damping)*(F-_[N])+a.damping*w[N]}for(var V=0,z=0;z<l;z++){var Y=d[z*l+z]+h[z*l+z]>0?1:0;E[T%a.minIterations*l+z]=Y,V+=Y}if(V>0&&(T>=a.minIterations-1||T==a.maxIterations-1)){for(var Q=0,J=0;J<l;J++){x[J]=0;for(var ee=0;ee<a.minIterations;ee++)x[J]+=E[ee*l+J];(x[J]===0||x[J]===a.minIterations)&&Q++}if(Q===l)break}}for(var ae=_8(l,h,d),ue=x8(l,c,ae),re={},U=0;U<ae.length;U++)re[ae[U]]=[];for(var G=0;G<n.length;G++){var j=s[n[G].id()],se=ue[j];se!=null&&re[se].push(n[G])}for(var fe=new Array(ae.length),Pe=0;Pe<ae.length;Pe++)fe[Pe]=r.collection(re[ae[Pe]]);return fe},E8={affinityPropagation:pC,ap:pC},S8=ar({root:void 0,directed:!1}),C8={hierholzer:function(e){if(!Qe(e)){var r=arguments;e={root:r[0],directed:r[1]}}var n=S8(e),a=n.root,s=n.directed,o=this,l=!1,u,c,f;a&&(f=_e(a)?this.filter(a)[0].id():a[0].id());var h={},d={};s?o.forEach(function(b){var w=b.id();if(b.isNode()){var _=b.indegree(!0),x=b.outdegree(!0),S=_-x,E=x-_;S==1?u?l=!0:u=w:E==1?c?l=!0:c=w:(E>1||S>1)&&(l=!0),h[w]=[],b.outgoers().forEach(function(A){A.isEdge()&&h[w].push(A.id())})}else d[w]=[void 0,b.target().id()]}):o.forEach(function(b){var w=b.id();if(b.isNode()){var _=b.degree(!0);_%2&&(u?c?l=!0:c=w:u=w),h[w]=[],b.connectedEdges().forEach(function(x){return h[w].push(x.id())})}else d[w]=[b.source().id(),b.target().id()]});var p={found:!1,trail:void 0};if(l)return p;if(c&&u)if(s){if(f&&c!=f)return p;f=c}else{if(f&&c!=f&&u!=f)return p;f||(f=c)}else f||(f=o[0].id());var g=function(w){for(var _=w,x=[w],S,E,A;h[_].length;)S=h[_].shift(),E=d[S][0],A=d[S][1],_!=A?(h[A]=h[A].filter(function(T){return T!=S}),_=A):!s&&_!=E&&(h[E]=h[E].filter(function(T){return T!=S}),_=E),x.unshift(S),x.unshift(_);return x},m=[],v=[];for(v=g(f);v.length!=1;)h[v[0]].length==0?(m.unshift(o.getElementById(v.shift())),m.unshift(o.getElementById(v.shift()))):v=g(v.shift()).concat(v);m.unshift(o.getElementById(v.shift()));for(var y in h)if(h[y].length)return p;return p.found=!0,p.trail=this.spawn(m,!0),p}},Of=function(){var e=this,r={},n=0,a=0,s=[],o=[],l={},u=function(d,p){for(var g=o.length-1,m=[],v=e.spawn();o[g].x!=d||o[g].y!=p;)m.push(o.pop().edge),g--;m.push(o.pop().edge),m.forEach(function(y){var b=y.connectedNodes().intersection(e);v.merge(y),b.forEach(function(w){var _=w.id(),x=w.connectedEdges().intersection(e);v.merge(w),r[_].cutVertex?v.merge(x.filter(function(S){return S.isLoop()})):v.merge(x)})}),s.push(v)},c=function(d,p,g){d===g&&(a+=1),r[p]={id:n,low:n++,cutVertex:!1};var m=e.getElementById(p).connectedEdges().intersection(e);if(m.size()===0)s.push(e.spawn(e.getElementById(p)));else{var v,y,b,w;m.forEach(function(_){v=_.source().id(),y=_.target().id(),b=v===p?y:v,b!==g&&(w=_.id(),l[w]||(l[w]=!0,o.push({x:p,y:b,edge:_})),b in r?r[p].low=Math.min(r[p].low,r[b].id):(c(d,b,p),r[p].low=Math.min(r[p].low,r[b].low),r[p].id<=r[b].low&&(r[p].cutVertex=!0,u(p,b))))})}};e.forEach(function(h){if(h.isNode()){var d=h.id();d in r||(a=0,c(d,d),r[d].cutVertex=a>1)}});var f=Object.keys(r).filter(function(h){return r[h].cutVertex}).map(function(h){return e.getElementById(h)});return{cut:e.spawn(f),components:s}},T8={hopcroftTarjanBiconnected:Of,htbc:Of,htb:Of,hopcroftTarjanBiconnectedComponents:Of},If=function(){var e=this,r={},n=0,a=[],s=[],o=e.spawn(e),l=function(c){s.push(c),r[c]={index:n,low:n++,explored:!1};var f=e.getElementById(c).connectedEdges().intersection(e);if(f.forEach(function(m){var v=m.target().id();v!==c&&(v in r||l(v),r[v].explored||(r[c].low=Math.min(r[c].low,r[v].low)))}),r[c].index===r[c].low){for(var h=e.spawn();;){var d=s.pop();if(h.merge(e.getElementById(d)),r[d].low=r[c].index,r[d].explored=!0,d===c)break}var p=h.edgesWith(h),g=h.merge(p);a.push(g),o=o.difference(g)}};return e.forEach(function(u){if(u.isNode()){var c=u.id();c in r||l(c)}}),{cut:o,components:a}},k8={tarjanStronglyConnected:If,tsc:If,tscc:If,tarjanStronglyConnectedComponents:If},Ok={};[Nl,nW,iW,sW,lW,cW,dW,VW,Vs,zs,yy,JW,h8,v8,E8,C8,T8,k8].forEach(function(t){Ce(Ok,t)});var Ik=0,Bk=1,Lk=2,mn=function(e){if(!(this instanceof mn))return new mn(e);this.id="Thenable/1.0.7",this.state=Ik,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};mn.prototype={fulfill:function(e){return gC(this,Bk,"fulfillValue",e)},reject:function(e){return gC(this,Lk,"rejectReason",e)},then:function(e,r){var n=this,a=new mn;return n.onFulfilled.push(mC(e,a,"fulfill")),n.onRejected.push(mC(r,a,"reject")),Nk(n),a.proxy}};var gC=function(e,r,n,a){return e.state===Ik&&(e.state=r,e[n]=a,Nk(e)),e},Nk=function(e){e.state===Bk?vC(e,"onFulfilled",e.fulfillValue):e.state===Lk&&vC(e,"onRejected",e.rejectReason)},vC=function(e,r,n){if(e[r].length!==0){var a=e[r];e[r]=[];var s=function(){for(var l=0;l<a.length;l++)a[l](n)};typeof setImmediate=="function"?setImmediate(s):setTimeout(s,0)}},mC=function(e,r,n){return function(a){if(typeof e!="function")r[n].call(r,a);else{var s;try{s=e(a)}catch(o){r.reject(o);return}Fk(r,s)}}},Fk=function(e,r){if(e===r||e.proxy===r){e.reject(new TypeError("cannot resolve promise with itself"));return}var n;if(Ut(r)==="object"&&r!==null||typeof r=="function")try{n=r.then}catch(s){e.reject(s);return}if(typeof n=="function"){var a=!1;try{n.call(r,function(s){a||(a=!0,s===r?e.reject(new TypeError("circular thenable chain")):Fk(e,s))},function(s){a||(a=!0,e.reject(s))})}catch(s){a||e.reject(s)}return}e.fulfill(r)};mn.all=function(t){return new mn(function(e,r){for(var n=new Array(t.length),a=0,s=function(u,c){n[u]=c,a++,a===t.length&&e(n)},o=0;o<t.length;o++)(function(l){var u=t[l],c=u!=null&&u.then!=null;if(c)u.then(function(h){s(l,h)},function(h){r(h)});else{var f=u;s(l,f)}})(o)})};mn.resolve=function(t){return new mn(function(e,r){e(t)})};mn.reject=function(t){return new mn(function(e,r){r(t)})};var Ys=typeof Promise<"u"?Promise:mn,_y=function(e,r,n){var a=Ly(e),s=!a,o=this._private=Ce({duration:1e3},r,n);if(o.target=e,o.style=o.style||o.css,o.started=!1,o.playing=!1,o.hooked=!1,o.applying=!1,o.progress=0,o.completes=[],o.frames=[],o.complete&&Ct(o.complete)&&o.completes.push(o.complete),s){var l=e.position();o.startPosition=o.startPosition||{x:l.x,y:l.y},o.startStyle=o.startStyle||e.cy().style().getAnimationStartStyle(e,o.style)}if(a){var u=e.pan();o.startPan={x:u.x,y:u.y},o.startZoom=e.zoom()}this.length=1,this[0]=this},La=_y.prototype;Ce(La,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var r,n=e.target._private.animation;e.queue?r=n.queue:r=n.current,r.push(this),Hr(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var r=this._private;return e===void 0?r.progress*r.duration:this.progress(e/r.duration)},progress:function(e){var r=this._private,n=r.playing;return e===void 0?r.progress:(n&&this.pause(),r.progress=e,r.started=!1,n&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,r=e.playing;r&&this.pause(),e.progress=1-e.progress,e.started=!1;var n=function(c,f){var h=e[c];h!=null&&(e[c]=e[f],e[f]=h)};if(n("zoom","startZoom"),n("pan","startPan"),n("position","startPosition"),e.style)for(var a=0;a<e.style.length;a++){var s=e.style[a],o=s.name,l=e.startStyle[o];e.startStyle[o]=s,e.style[a]=l}return r&&this.play(),this},promise:function(e){var r=this._private,n;switch(e){case"frame":n=r.frames;break;default:case"complete":case"completed":n=r.completes}return new Ys(function(a,s){n.push(function(){a()})})}});La.complete=La.completed;La.run=La.play;La.running=La.playing;var A8={animated:function(){return function(){var r=this,n=r.length!==void 0,a=n?r:[r],s=this._private.cy||this;if(!s.styleEnabled())return!1;var o=a[0];if(o)return o._private.animation.current.length>0}},clearQueue:function(){return function(){var r=this,n=r.length!==void 0,a=n?r:[r],s=this._private.cy||this;if(!s.styleEnabled())return this;for(var o=0;o<a.length;o++){var l=a[o];l._private.animation.queue=[]}return this}},delay:function(){return function(r,n){var a=this._private.cy||this;return a.styleEnabled()?this.animate({delay:r,duration:r,complete:n}):this}},delayAnimation:function(){return function(r,n){var a=this._private.cy||this;return a.styleEnabled()?this.animation({delay:r,duration:r,complete:n}):this}},animation:function(){return function(r,n){var a=this,s=a.length!==void 0,o=s?a:[a],l=this._private.cy||this,u=!s,c=!u;if(!l.styleEnabled())return this;var f=l.style();r=Ce({},r,n);var h=Object.keys(r).length===0;if(h)return new _y(o[0],r);switch(r.duration===void 0&&(r.duration=400),r.duration){case"slow":r.duration=600;break;case"fast":r.duration=200;break}if(c&&(r.style=f.getPropsList(r.style||r.css),r.css=void 0),c&&r.renderedPosition!=null){var d=r.renderedPosition,p=l.pan(),g=l.zoom();r.position=Sk(d,g,p)}if(u&&r.panBy!=null){var m=r.panBy,v=l.pan();r.pan={x:v.x+m.x,y:v.y+m.y}}var y=r.center||r.centre;if(u&&y!=null){var b=l.getCenterPan(y.eles,r.zoom);b!=null&&(r.pan=b)}if(u&&r.fit!=null){var w=r.fit,_=l.getFitViewport(w.eles||w.boundingBox,w.padding);_!=null&&(r.pan=_.pan,r.zoom=_.zoom)}if(u&&Qe(r.zoom)){var x=l.getZoomedViewport(r.zoom);x!=null?(x.zoomed&&(r.zoom=x.zoom),x.panned&&(r.pan=x.pan)):r.zoom=null}return new _y(o[0],r)}},animate:function(){return function(r,n){var a=this,s=a.length!==void 0,o=s?a:[a],l=this._private.cy||this;if(!l.styleEnabled())return this;n&&(r=Ce({},r,n));for(var u=0;u<o.length;u++){var c=o[u],f=c.animated()&&(r.queue===void 0||r.queue),h=c.animation(r,f?{queue:!0}:void 0);h.play()}return this}},stop:function(){return function(r,n){var a=this,s=a.length!==void 0,o=s?a:[a],l=this._private.cy||this;if(!l.styleEnabled())return this;for(var u=0;u<o.length;u++){for(var c=o[u],f=c._private,h=f.animation.current,d=0;d<h.length;d++){var p=h[d],g=p._private;n&&(g.duration=0)}r&&(f.animation.queue=[]),n||(f.animation.current=[])}return l.notify("draw"),this}}},am,yC;function yh(){if(yC)return am;yC=1;var t=Array.isArray;return am=t,am}var sm,bC;function M8(){if(bC)return sm;bC=1;var t=yh(),e=Zl(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(s,o){if(t(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||e(s)?!0:n.test(s)||!r.test(s)||o!=null&&s in Object(o)}return sm=a,sm}var om,wC;function P8(){if(wC)return om;wC=1;var t=gk(),e=Yl(),r="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!e(l))return!1;var u=t(l);return u==n||u==a||u==r||u==s}return om=o,om}var lm,_C;function R8(){if(_C)return lm;_C=1;var t=ph(),e=t["__core-js_shared__"];return lm=e,lm}var um,xC;function D8(){if(xC)return um;xC=1;var t=R8(),e=function(){var n=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!e&&e in n}return um=r,um}var cm,EC;function O8(){if(EC)return cm;EC=1;var t=Function.prototype,e=t.toString;function r(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return cm=r,cm}var fm,SC;function I8(){if(SC)return fm;SC=1;var t=P8(),e=D8(),r=Yl(),n=O8(),a=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,u=o.toString,c=l.hasOwnProperty,f=RegExp("^"+u.call(c).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h(d){if(!r(d)||e(d))return!1;var p=t(d)?f:s;return p.test(n(d))}return fm=h,fm}var hm,CC;function B8(){if(CC)return hm;CC=1;function t(e,r){return e?.[r]}return hm=t,hm}var dm,TC;function jy(){if(TC)return dm;TC=1;var t=I8(),e=B8();function r(n,a){var s=e(n,a);return t(s)?s:void 0}return dm=r,dm}var pm,kC;function bh(){if(kC)return pm;kC=1;var t=jy(),e=t(Object,"create");return pm=e,pm}var gm,AC;function L8(){if(AC)return gm;AC=1;var t=bh();function e(){this.__data__=t?t(null):{},this.size=0}return gm=e,gm}var vm,MC;function N8(){if(MC)return vm;MC=1;function t(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}return vm=t,vm}var mm,PC;function F8(){if(PC)return mm;PC=1;var t=bh(),e="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function a(s){var o=this.__data__;if(t){var l=o[s];return l===e?void 0:l}return n.call(o,s)?o[s]:void 0}return mm=a,mm}var ym,RC;function q8(){if(RC)return ym;RC=1;var t=bh(),e=Object.prototype,r=e.hasOwnProperty;function n(a){var s=this.__data__;return t?s[a]!==void 0:r.call(s,a)}return ym=n,ym}var bm,DC;function V8(){if(DC)return bm;DC=1;var t=bh(),e="__lodash_hash_undefined__";function r(n,a){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=t&&a===void 0?e:a,this}return bm=r,bm}var wm,OC;function z8(){if(OC)return wm;OC=1;var t=L8(),e=N8(),r=F8(),n=q8(),a=V8();function s(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var c=o[l];this.set(c[0],c[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,wm=s,wm}var _m,IC;function H8(){if(IC)return _m;IC=1;function t(){this.__data__=[],this.size=0}return _m=t,_m}var xm,BC;function qk(){if(BC)return xm;BC=1;function t(e,r){return e===r||e!==e&&r!==r}return xm=t,xm}var Em,LC;function wh(){if(LC)return Em;LC=1;var t=qk();function e(r,n){for(var a=r.length;a--;)if(t(r[a][0],n))return a;return-1}return Em=e,Em}var Sm,NC;function U8(){if(NC)return Sm;NC=1;var t=wh(),e=Array.prototype,r=e.splice;function n(a){var s=this.__data__,o=t(s,a);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():r.call(s,o,1),--this.size,!0}return Sm=n,Sm}var Cm,FC;function W8(){if(FC)return Cm;FC=1;var t=wh();function e(r){var n=this.__data__,a=t(n,r);return a<0?void 0:n[a][1]}return Cm=e,Cm}var Tm,qC;function G8(){if(qC)return Tm;qC=1;var t=wh();function e(r){return t(this.__data__,r)>-1}return Tm=e,Tm}var km,VC;function K8(){if(VC)return km;VC=1;var t=wh();function e(r,n){var a=this.__data__,s=t(a,r);return s<0?(++this.size,a.push([r,n])):a[s][1]=n,this}return km=e,km}var Am,zC;function j8(){if(zC)return Am;zC=1;var t=H8(),e=U8(),r=W8(),n=G8(),a=K8();function s(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var c=o[l];this.set(c[0],c[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,Am=s,Am}var Mm,HC;function Y8(){if(HC)return Mm;HC=1;var t=jy(),e=ph(),r=t(e,"Map");return Mm=r,Mm}var Pm,UC;function Z8(){if(UC)return Pm;UC=1;var t=z8(),e=j8(),r=Y8();function n(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}return Pm=n,Pm}var Rm,WC;function X8(){if(WC)return Rm;WC=1;function t(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}return Rm=t,Rm}var Dm,GC;function _h(){if(GC)return Dm;GC=1;var t=X8();function e(r,n){var a=r.__data__;return t(n)?a[typeof n=="string"?"string":"hash"]:a.map}return Dm=e,Dm}var Om,KC;function $8(){if(KC)return Om;KC=1;var t=_h();function e(r){var n=t(this,r).delete(r);return this.size-=n?1:0,n}return Om=e,Om}var Im,jC;function Q8(){if(jC)return Im;jC=1;var t=_h();function e(r){return t(this,r).get(r)}return Im=e,Im}var Bm,YC;function J8(){if(YC)return Bm;YC=1;var t=_h();function e(r){return t(this,r).has(r)}return Bm=e,Bm}var Lm,ZC;function eG(){if(ZC)return Lm;ZC=1;var t=_h();function e(r,n){var a=t(this,r),s=a.size;return a.set(r,n),this.size+=a.size==s?0:1,this}return Lm=e,Lm}var Nm,XC;function tG(){if(XC)return Nm;XC=1;var t=Z8(),e=$8(),r=Q8(),n=J8(),a=eG();function s(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var c=o[l];this.set(c[0],c[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,Nm=s,Nm}var Fm,$C;function rG(){if($C)return Fm;$C=1;var t=tG(),e="Expected a function";function r(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new TypeError(e);var s=function(){var o=arguments,l=a?a.apply(this,o):o[0],u=s.cache;if(u.has(l))return u.get(l);var c=n.apply(this,o);return s.cache=u.set(l,c)||u,c};return s.cache=new(r.Cache||t),s}return r.Cache=t,Fm=r,Fm}var qm,QC;function nG(){if(QC)return qm;QC=1;var t=rG(),e=500;function r(n){var a=t(n,function(o){return s.size===e&&s.clear(),o}),s=a.cache;return a}return qm=r,qm}var Vm,JC;function Vk(){if(JC)return Vm;JC=1;var t=nG(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t(function(a){var s=[];return a.charCodeAt(0)===46&&s.push(""),a.replace(e,function(o,l,u,c){s.push(u?c.replace(r,"$1"):l||o)}),s});return Vm=n,Vm}var zm,eT;function zk(){if(eT)return zm;eT=1;function t(e,r){for(var n=-1,a=e==null?0:e.length,s=Array(a);++n<a;)s[n]=r(e[n],n,e);return s}return zm=t,zm}var Hm,tT;function iG(){if(tT)return Hm;tT=1;var t=Fy(),e=zk(),r=yh(),n=Zl(),a=t?t.prototype:void 0,s=a?a.toString:void 0;function o(l){if(typeof l=="string")return l;if(r(l))return e(l,o)+"";if(n(l))return s?s.call(l):"";var u=l+"";return u=="0"&&1/l==-1/0?"-0":u}return Hm=o,Hm}var Um,rT;function Hk(){if(rT)return Um;rT=1;var t=iG();function e(r){return r==null?"":t(r)}return Um=e,Um}var Wm,nT;function Uk(){if(nT)return Wm;nT=1;var t=yh(),e=M8(),r=Vk(),n=Hk();function a(s,o){return t(s)?s:e(s,o)?[s]:r(n(s))}return Wm=a,Wm}var Gm,iT;function Yy(){if(iT)return Gm;iT=1;var t=Zl();function e(r){if(typeof r=="string"||t(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return Gm=e,Gm}var Km,aT;function aG(){if(aT)return Km;aT=1;var t=Uk(),e=Yy();function r(n,a){a=t(a,n);for(var s=0,o=a.length;n!=null&&s<o;)n=n[e(a[s++])];return s&&s==o?n:void 0}return Km=r,Km}var jm,sT;function sG(){if(sT)return jm;sT=1;var t=aG();function e(r,n,a){var s=r==null?void 0:t(r,n);return s===void 0?a:s}return jm=e,jm}var oG=sG(),lG=jl(oG),Ym,oT;function uG(){if(oT)return Ym;oT=1;var t=jy(),e=function(){try{var r=t(Object,"defineProperty");return r({},"",{}),r}catch{}}();return Ym=e,Ym}var Zm,lT;function cG(){if(lT)return Zm;lT=1;var t=uG();function e(r,n,a){n=="__proto__"&&t?t(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}return Zm=e,Zm}var Xm,uT;function fG(){if(uT)return Xm;uT=1;var t=cG(),e=qk(),r=Object.prototype,n=r.hasOwnProperty;function a(s,o,l){var u=s[o];(!(n.call(s,o)&&e(u,l))||l===void 0&&!(o in s))&&t(s,o,l)}return Xm=a,Xm}var $m,cT;function hG(){if(cT)return $m;cT=1;var t=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function r(n,a){var s=typeof n;return a=a??t,!!a&&(s=="number"||s!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<a}return $m=r,$m}var Qm,fT;function dG(){if(fT)return Qm;fT=1;var t=fG(),e=Uk(),r=hG(),n=Yl(),a=Yy();function s(o,l,u,c){if(!n(o))return o;l=e(l,o);for(var f=-1,h=l.length,d=h-1,p=o;p!=null&&++f<h;){var g=a(l[f]),m=u;if(g==="__proto__"||g==="constructor"||g==="prototype")return o;if(f!=d){var v=p[g];m=c?c(v,g,p):void 0,m===void 0&&(m=n(v)?v:r(l[f+1])?[]:{})}t(p,g,m),p=p[g]}return o}return Qm=s,Qm}var Jm,hT;function pG(){if(hT)return Jm;hT=1;var t=dG();function e(r,n,a){return r==null?r:t(r,n,a)}return Jm=e,Jm}var gG=pG(),vG=jl(gG),ey,dT;function mG(){if(dT)return ey;dT=1;function t(e,r){var n=-1,a=e.length;for(r||(r=Array(a));++n<a;)r[n]=e[n];return r}return ey=t,ey}var ty,pT;function yG(){if(pT)return ty;pT=1;var t=zk(),e=mG(),r=yh(),n=Zl(),a=Vk(),s=Yy(),o=Hk();function l(u){return r(u)?t(u,s):n(u)?[u]:e(a(o(u)))}return ty=l,ty}var bG=yG(),wG=jl(bG),_G={data:function(e){var r={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(a){},beforeSet:function(a,s){},onSet:function(a){},canSet:function(a){return!0}};return e=Ce({},r,e),function(a,s){var o=e,l=this,u=l.length!==void 0,c=u?l:[l],f=u?l[0]:l;if(_e(a)){var h=a.indexOf(".")!==-1,d=h&&wG(a);if(o.allowGetting&&s===void 0){var p;return f&&(o.beforeGet(f),d&&f._private[o.field][a]===void 0?p=lG(f._private[o.field],d):p=f._private[o.field][a]),p}else if(o.allowSetting&&s!==void 0){var g=!o.immutableKeys[a];if(g){var m=ak({},a,s);o.beforeSet(l,m);for(var v=0,y=c.length;v<y;v++){var b=c[v];o.canSet(b)&&(d&&f._private[o.field][a]===void 0?vG(b._private[o.field],d,s):b._private[o.field][a]=s)}o.updateStyle&&l.updateStyle(),o.onSet(l),o.settingTriggersEvent&&l[o.triggerFnName](o.settingEvent)}}}else if(o.allowSetting&&Qe(a)){var w=a,_,x,S=Object.keys(w);o.beforeSet(l,w);for(var E=0;E<S.length;E++){_=S[E],x=w[_];var A=!o.immutableKeys[_];if(A)for(var T=0;T<c.length;T++){var D=c[T];o.canSet(D)&&(D._private[o.field][_]=x)}}o.updateStyle&&l.updateStyle(),o.onSet(l),o.settingTriggersEvent&&l[o.triggerFnName](o.settingEvent)}else if(o.allowBinding&&Ct(a)){var k=a;l.on(o.bindingEvent,k)}else if(o.allowGetting&&a===void 0){var M;return f&&(o.beforeGet(f),M=f._private[o.field]),M}return l}},removeData:function(e){var r={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return e=Ce({},r,e),function(a){var s=e,o=this,l=o.length!==void 0,u=l?o:[o];if(_e(a)){for(var c=a.split(/\s+/),f=c.length,h=0;h<f;h++){var d=c[h];if(!Ii(d)){var p=!s.immutableKeys[d];if(p)for(var g=0,m=u.length;g<m;g++)u[g]._private[s.field][d]=void 0}}s.triggerEvent&&o[s.triggerFnName](s.event)}else if(a===void 0){for(var v=0,y=u.length;v<y;v++)for(var b=u[v]._private[s.field],w=Object.keys(b),_=0;_<w.length;_++){var x=w[_],S=!s.immutableKeys[x];S&&(b[x]=void 0)}s.triggerEvent&&o[s.triggerFnName](s.event)}return o}}},xG={eventAliasesOn:function(e){var r=e;r.addListener=r.listen=r.bind=r.on,r.unlisten=r.unbind=r.off=r.removeListener,r.trigger=r.emit,r.pon=r.promiseOn=function(n,a){var s=this,o=Array.prototype.slice.call(arguments,0);return new Ys(function(l,u){var c=function(p){s.off.apply(s,h),l(p)},f=o.concat([c]),h=f.concat([]);s.on.apply(s,f)})}}},at={};[A8,_G,xG].forEach(function(t){Ce(at,t)});var EG={animate:at.animate(),animation:at.animation(),animated:at.animated(),clearQueue:at.clearQueue(),delay:at.delay(),delayAnimation:at.delayAnimation(),stop:at.stop()},Gf={classes:function(e){var r=this;if(e===void 0){var n=[];return r[0]._private.classes.forEach(function(g){return n.push(g)}),n}else dt(e)||(e=(e||"").match(/\S+/g)||[]);for(var a=[],s=new js(e),o=0;o<r.length;o++){for(var l=r[o],u=l._private,c=u.classes,f=!1,h=0;h<e.length;h++){var d=e[h],p=c.has(d);if(!p){f=!0;break}}f||(f=c.size!==e.length),f&&(u.classes=s,a.push(l))}return a.length>0&&this.spawn(a).updateStyle().emit("class"),r},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var r=this[0];return r!=null&&r._private.classes.has(e)},toggleClass:function(e,r){dt(e)||(e=e.match(/\S+/g)||[]);for(var n=this,a=r===void 0,s=[],o=0,l=n.length;o<l;o++)for(var u=n[o],c=u._private.classes,f=!1,h=0;h<e.length;h++){var d=e[h],p=c.has(d),g=!1;r||a&&!p?(c.add(d),g=!0):(!r||a&&p)&&(c.delete(d),g=!0),!f&&g&&(s.push(u),f=!0)}return s.length>0&&this.spawn(s).updateStyle().emit("class"),n},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,r){var n=this;if(r==null)r=250;else if(r===0)return n;return n.addClass(e),setTimeout(function(){n.removeClass(e)},r),n}};Gf.className=Gf.classNames=Gf.classes;var $e={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:Ht,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};$e.variable="(?:[\\w-.]|(?:\\\\"+$e.metaChar+"))+";$e.className="(?:[\\w-]|(?:\\\\"+$e.metaChar+"))+";$e.value=$e.string+"|"+$e.number;$e.id=$e.variable;(function(){var t,e,r;for(t=$e.comparatorOp.split("|"),r=0;r<t.length;r++)e=t[r],$e.comparatorOp+="|@"+e;for(t=$e.comparatorOp.split("|"),r=0;r<t.length;r++)e=t[r],!(e.indexOf("!")>=0)&&e!=="="&&($e.comparatorOp+="|\\!"+e)})();var ct=function(){return{checks:[]}},de={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},xy=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(t,e){return SU(t.selector,e.selector)}),SG=function(){for(var t={},e,r=0;r<xy.length;r++)e=xy[r],t[e.selector]=e.matches;return t}(),CG=function(e,r){return SG[e](r)},TG="("+xy.map(function(t){return t.selector}).join("|")+")",As=function(e){return e.replace(new RegExp("\\\\("+$e.metaChar+")","g"),function(r,n){return n})},Pi=function(e,r,n){e[e.length-1]=n},Ey=[{name:"group",query:!0,regex:"("+$e.group+")",populate:function(e,r,n){var a=zt(n,1),s=a[0];r.checks.push({type:de.GROUP,value:s==="*"?s:s+"s"})}},{name:"state",query:!0,regex:TG,populate:function(e,r,n){var a=zt(n,1),s=a[0];r.checks.push({type:de.STATE,value:s})}},{name:"id",query:!0,regex:"\\#("+$e.id+")",populate:function(e,r,n){var a=zt(n,1),s=a[0];r.checks.push({type:de.ID,value:As(s)})}},{name:"className",query:!0,regex:"\\.("+$e.className+")",populate:function(e,r,n){var a=zt(n,1),s=a[0];r.checks.push({type:de.CLASS,value:As(s)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+$e.variable+")\\s*\\]",populate:function(e,r,n){var a=zt(n,1),s=a[0];r.checks.push({type:de.DATA_EXIST,field:As(s)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+$e.variable+")\\s*("+$e.comparatorOp+")\\s*("+$e.value+")\\s*\\]",populate:function(e,r,n){var a=zt(n,3),s=a[0],o=a[1],l=a[2],u=new RegExp("^"+$e.string+"$").exec(l)!=null;u?l=l.substring(1,l.length-1):l=parseFloat(l),r.checks.push({type:de.DATA_COMPARE,field:As(s),operator:o,value:l})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+$e.boolOp+")\\s*("+$e.variable+")\\s*\\]",populate:function(e,r,n){var a=zt(n,2),s=a[0],o=a[1];r.checks.push({type:de.DATA_BOOL,field:As(o),operator:s})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+$e.meta+")\\s*("+$e.comparatorOp+")\\s*("+$e.number+")\\s*\\]\\]",populate:function(e,r,n){var a=zt(n,3),s=a[0],o=a[1],l=a[2];r.checks.push({type:de.META_COMPARE,field:As(s),operator:o,value:parseFloat(l)})}},{name:"nextQuery",separator:!0,regex:$e.separator,populate:function(e,r){var n=e.currentSubject,a=e.edgeCount,s=e.compoundCount,o=e[e.length-1];n!=null&&(o.subject=n,e.currentSubject=null),o.edgeCount=a,o.compoundCount=s,e.edgeCount=0,e.compoundCount=0;var l=e[e.length++]=ct();return l}},{name:"directedEdge",separator:!0,regex:$e.directedEdge,populate:function(e,r){if(e.currentSubject==null){var n=ct(),a=r,s=ct();return n.checks.push({type:de.DIRECTED_EDGE,source:a,target:s}),Pi(e,r,n),e.edgeCount++,s}else{var o=ct(),l=r,u=ct();return o.checks.push({type:de.NODE_SOURCE,source:l,target:u}),Pi(e,r,o),e.edgeCount++,u}}},{name:"undirectedEdge",separator:!0,regex:$e.undirectedEdge,populate:function(e,r){if(e.currentSubject==null){var n=ct(),a=r,s=ct();return n.checks.push({type:de.UNDIRECTED_EDGE,nodes:[a,s]}),Pi(e,r,n),e.edgeCount++,s}else{var o=ct(),l=r,u=ct();return o.checks.push({type:de.NODE_NEIGHBOR,node:l,neighbor:u}),Pi(e,r,o),u}}},{name:"child",separator:!0,regex:$e.child,populate:function(e,r){if(e.currentSubject==null){var n=ct(),a=ct(),s=e[e.length-1];return n.checks.push({type:de.CHILD,parent:s,child:a}),Pi(e,r,n),e.compoundCount++,a}else if(e.currentSubject===r){var o=ct(),l=e[e.length-1],u=ct(),c=ct(),f=ct(),h=ct();return o.checks.push({type:de.COMPOUND_SPLIT,left:l,right:u,subject:c}),c.checks=r.checks,r.checks=[{type:de.TRUE}],h.checks.push({type:de.TRUE}),u.checks.push({type:de.PARENT,parent:h,child:f}),Pi(e,l,o),e.currentSubject=c,e.compoundCount++,f}else{var d=ct(),p=ct(),g=[{type:de.PARENT,parent:d,child:p}];return d.checks=r.checks,r.checks=g,e.compoundCount++,p}}},{name:"descendant",separator:!0,regex:$e.descendant,populate:function(e,r){if(e.currentSubject==null){var n=ct(),a=ct(),s=e[e.length-1];return n.checks.push({type:de.DESCENDANT,ancestor:s,descendant:a}),Pi(e,r,n),e.compoundCount++,a}else if(e.currentSubject===r){var o=ct(),l=e[e.length-1],u=ct(),c=ct(),f=ct(),h=ct();return o.checks.push({type:de.COMPOUND_SPLIT,left:l,right:u,subject:c}),c.checks=r.checks,r.checks=[{type:de.TRUE}],h.checks.push({type:de.TRUE}),u.checks.push({type:de.ANCESTOR,ancestor:h,descendant:f}),Pi(e,l,o),e.currentSubject=c,e.compoundCount++,f}else{var d=ct(),p=ct(),g=[{type:de.ANCESTOR,ancestor:d,descendant:p}];return d.checks=r.checks,r.checks=g,e.compoundCount++,p}}},{name:"subject",modifier:!0,regex:$e.subject,populate:function(e,r){if(e.currentSubject!=null&&e.currentSubject!==r)return st("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=r;var n=e[e.length-1],a=n.checks[0],s=a==null?null:a.type;s===de.DIRECTED_EDGE?a.type=de.NODE_TARGET:s===de.UNDIRECTED_EDGE&&(a.type=de.NODE_NEIGHBOR,a.node=a.nodes[1],a.neighbor=a.nodes[0],a.nodes=null)}}];Ey.forEach(function(t){return t.regexObj=new RegExp("^"+t.regex)});var kG=function(e){for(var r,n,a,s=0;s<Ey.length;s++){var o=Ey[s],l=o.name,u=e.match(o.regexObj);if(u!=null){n=u,r=o,a=l;var c=u[0];e=e.substring(c.length);break}}return{expr:r,match:n,name:a,remaining:e}},AG=function(e){var r=e.match(/^\s+/);if(r){var n=r[0];e=e.substring(n.length)}return e},MG=function(e){var r=this,n=r.inputText=e,a=r[0]=ct();for(r.length=1,n=AG(n);;){var s=kG(n);if(s.expr==null)return st("The selector `"+e+"`is invalid"),!1;var o=s.match.slice(1),l=s.expr.populate(r,a,o);if(l===!1)return!1;if(l!=null&&(a=l),n=s.remaining,n.match(/^\s*$/))break}var u=r[r.length-1];r.currentSubject!=null&&(u.subject=r.currentSubject),u.edgeCount=r.edgeCount,u.compoundCount=r.compoundCount;for(var c=0;c<r.length;c++){var f=r[c];if(f.compoundCount>0&&f.edgeCount>0)return st("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(f.edgeCount>1)return st("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;f.edgeCount===1&&st("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},PG=function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(f){return f??""},r=function(f){return _e(f)?'"'+f+'"':e(f)},n=function(f){return" "+f+" "},a=function(f,h){var d=f.type,p=f.value;switch(d){case de.GROUP:{var g=e(p);return g.substring(0,g.length-1)}case de.DATA_COMPARE:{var m=f.field,v=f.operator;return"["+m+n(e(v))+r(p)+"]"}case de.DATA_BOOL:{var y=f.operator,b=f.field;return"["+e(y)+b+"]"}case de.DATA_EXIST:{var w=f.field;return"["+w+"]"}case de.META_COMPARE:{var _=f.operator,x=f.field;return"[["+x+n(e(_))+r(p)+"]]"}case de.STATE:return p;case de.ID:return"#"+p;case de.CLASS:return"."+p;case de.PARENT:case de.CHILD:return s(f.parent,h)+n(">")+s(f.child,h);case de.ANCESTOR:case de.DESCENDANT:return s(f.ancestor,h)+" "+s(f.descendant,h);case de.COMPOUND_SPLIT:{var S=s(f.left,h),E=s(f.subject,h),A=s(f.right,h);return S+(S.length>0?" ":"")+E+A}case de.TRUE:return""}},s=function(f,h){return f.checks.reduce(function(d,p,g){return d+(h===f&&g===0?"$":"")+a(p,h)},"")},o="",l=0;l<this.length;l++){var u=this[l];o+=s(u,u.subject),this.length>1&&l<this.length-1&&(o+=", ")}return this.toStringCache=o,o},RG={parse:MG,toString:PG},Wk=function(e,r,n){var a,s=_e(e),o=le(e),l=_e(n),u,c,f=!1,h=!1,d=!1;switch(r.indexOf("!")>=0&&(r=r.replace("!",""),h=!0),r.indexOf("@")>=0&&(r=r.replace("@",""),f=!0),(s||l||f)&&(u=!s&&!o?"":""+e,c=""+n),f&&(e=u=u.toLowerCase(),n=c=c.toLowerCase()),r){case"*=":a=u.indexOf(c)>=0;break;case"$=":a=u.indexOf(c,u.length-c.length)>=0;break;case"^=":a=u.indexOf(c)===0;break;case"=":a=e===n;break;case">":d=!0,a=e>n;break;case">=":d=!0,a=e>=n;break;case"<":d=!0,a=e<n;break;case"<=":d=!0,a=e<=n;break;default:a=!1;break}return h&&(e!=null||!d)&&(a=!a),a},DG=function(e,r){switch(r){case"?":return!!e;case"!":return!e;case"^":return e===void 0}},OG=function(e){return e!==void 0},Zy=function(e,r){return e.data(r)},IG=function(e,r){return e[r]()},kt=[],_t=function(e,r){return e.checks.every(function(n){return kt[n.type](n,r)})};kt[de.GROUP]=function(t,e){var r=t.value;return r==="*"||r===e.group()};kt[de.STATE]=function(t,e){var r=t.value;return CG(r,e)};kt[de.ID]=function(t,e){var r=t.value;return e.id()===r};kt[de.CLASS]=function(t,e){var r=t.value;return e.hasClass(r)};kt[de.META_COMPARE]=function(t,e){var r=t.field,n=t.operator,a=t.value;return Wk(IG(e,r),n,a)};kt[de.DATA_COMPARE]=function(t,e){var r=t.field,n=t.operator,a=t.value;return Wk(Zy(e,r),n,a)};kt[de.DATA_BOOL]=function(t,e){var r=t.field,n=t.operator;return DG(Zy(e,r),n)};kt[de.DATA_EXIST]=function(t,e){var r=t.field;return t.operator,OG(Zy(e,r))};kt[de.UNDIRECTED_EDGE]=function(t,e){var r=t.nodes[0],n=t.nodes[1],a=e.source(),s=e.target();return _t(r,a)&&_t(n,s)||_t(n,a)&&_t(r,s)};kt[de.NODE_NEIGHBOR]=function(t,e){return _t(t.node,e)&&e.neighborhood().some(function(r){return r.isNode()&&_t(t.neighbor,r)})};kt[de.DIRECTED_EDGE]=function(t,e){return _t(t.source,e.source())&&_t(t.target,e.target())};kt[de.NODE_SOURCE]=function(t,e){return _t(t.source,e)&&e.outgoers().some(function(r){return r.isNode()&&_t(t.target,r)})};kt[de.NODE_TARGET]=function(t,e){return _t(t.target,e)&&e.incomers().some(function(r){return r.isNode()&&_t(t.source,r)})};kt[de.CHILD]=function(t,e){return _t(t.child,e)&&_t(t.parent,e.parent())};kt[de.PARENT]=function(t,e){return _t(t.parent,e)&&e.children().some(function(r){return _t(t.child,r)})};kt[de.DESCENDANT]=function(t,e){return _t(t.descendant,e)&&e.ancestors().some(function(r){return _t(t.ancestor,r)})};kt[de.ANCESTOR]=function(t,e){return _t(t.ancestor,e)&&e.descendants().some(function(r){return _t(t.descendant,r)})};kt[de.COMPOUND_SPLIT]=function(t,e){return _t(t.subject,e)&&_t(t.left,e)&&_t(t.right,e)};kt[de.TRUE]=function(){return!0};kt[de.COLLECTION]=function(t,e){var r=t.value;return r.has(e)};kt[de.FILTER]=function(t,e){var r=t.value;return r(e)};var BG=function(e){var r=this;if(r.length===1&&r[0].checks.length===1&&r[0].checks[0].type===de.ID)return e.getElementById(r[0].checks[0].value).collection();var n=function(s){for(var o=0;o<r.length;o++){var l=r[o];if(_t(l,s))return!0}return!1};return r.text()==null&&(n=function(){return!0}),e.filter(n)},LG=function(e){for(var r=this,n=0;n<r.length;n++){var a=r[n];if(_t(a,e))return!0}return!1},NG={matches:LG,filter:BG},Ni=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||_e(e)&&e.match(/^\s*$/)||(Hr(e)?this.addQuery({checks:[{type:de.COLLECTION,value:e.collection()}]}):Ct(e)?this.addQuery({checks:[{type:de.FILTER,value:e}]}):_e(e)?this.parse(e)||(this.invalid=!0):St("A selector must be created from a string; found "))},Fi=Ni.prototype;[RG,NG].forEach(function(t){return Ce(Fi,t)});Fi.text=function(){return this.inputText};Fi.size=function(){return this.length};Fi.eq=function(t){return this[t]};Fi.sameText=function(t){return!this.invalid&&!t.invalid&&this.text()===t.text()};Fi.addQuery=function(t){this[this.length++]=t};Fi.selector=Fi.toString;var Di={allAre:function(e){var r=new Ni(e);return this.every(function(n){return r.matches(n)})},is:function(e){var r=new Ni(e);return this.some(function(n){return r.matches(n)})},some:function(e,r){for(var n=0;n<this.length;n++){var a=r?e.apply(r,[this[n],n,this]):e(this[n],n,this);if(a)return!0}return!1},every:function(e,r){for(var n=0;n<this.length;n++){var a=r?e.apply(r,[this[n],n,this]):e(this[n],n,this);if(!a)return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var r=this.length,n=e.length;return r!==n?!1:r===1?this[0]===e[0]:this.every(function(a){return e.hasElementWithId(a.id())})},anySame:function(e){return e=this.cy().collection(e),this.some(function(r){return e.hasElementWithId(r.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var r=this.neighborhood();return e.every(function(n){return r.hasElementWithId(n.id())})},contains:function(e){e=this.cy().collection(e);var r=this;return e.every(function(n){return r.hasElementWithId(n.id())})}};Di.allAreNeighbours=Di.allAreNeighbors;Di.has=Di.contains;Di.equal=Di.equals=Di.same;var en=function(e,r){return function(a,s,o,l){var u=a,c=this,f;if(u==null?f="":Hr(u)&&u.length===1&&(f=u.id()),c.length===1&&f){var h=c[0]._private,d=h.traversalCache=h.traversalCache||{},p=d[r]=d[r]||[],g=Ia(f),m=p[g];return m||(p[g]=e.call(c,a,s,o,l))}else return e.call(c,a,s,o,l)}},Ks={parent:function(e){var r=[];if(this.length===1){var n=this[0]._private.parent;if(n)return n}for(var a=0;a<this.length;a++){var s=this[a],o=s._private.parent;o&&r.push(o)}return this.spawn(r,!0).filter(e)},parents:function(e){for(var r=[],n=this.parent();n.nonempty();){for(var a=0;a<n.length;a++){var s=n[a];r.push(s)}n=n.parent()}return this.spawn(r,!0).filter(e)},commonAncestors:function(e){for(var r,n=0;n<this.length;n++){var a=this[n],s=a.parents();r=r||s,r=r.intersect(s)}return r.filter(e)},orphans:function(e){return this.stdFilter(function(r){return r.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(r){return r.isChild()}).filter(e)},children:en(function(t){for(var e=[],r=0;r<this.length;r++)for(var n=this[r],a=n._private.children,s=0;s<a.length;s++)e.push(a[s]);return this.spawn(e,!0).filter(t)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var r=[];function n(a){for(var s=0;s<a.length;s++){var o=a[s];r.push(o),o.children().nonempty()&&n(o.children())}}return n(this.children()),this.spawn(r,!0).filter(e)}};function Xy(t,e,r,n){for(var a=[],s=new js,o=t.cy(),l=o.hasCompoundNodes(),u=0;u<t.length;u++){var c=t[u];r?a.push(c):l&&n(a,s,c)}for(;a.length>0;){var f=a.shift();e(f),s.add(f.id()),l&&n(a,s,f)}return t}function Gk(t,e,r){if(r.isParent())for(var n=r._private.children,a=0;a<n.length;a++){var s=n[a];e.has(s.id())||t.push(s)}}Ks.forEachDown=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Xy(this,t,e,Gk)};function Kk(t,e,r){if(r.isChild()){var n=r._private.parent;e.has(n.id())||t.push(n)}}Ks.forEachUp=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Xy(this,t,e,Kk)};function FG(t,e,r){Kk(t,e,r),Gk(t,e,r)}Ks.forEachUpAndDown=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Xy(this,t,e,FG)};Ks.ancestors=Ks.parents;var Vl,jk;Vl=jk={data:at.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:at.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:at.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:at.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:at.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:at.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}};Vl.attr=Vl.data;Vl.removeAttr=Vl.removeData;var qG=jk,xh={};function ry(t){return function(e){var r=this;if(e===void 0&&(e=!0),r.length!==0)if(r.isNode()&&!r.removed()){for(var n=0,a=r[0],s=a._private.edges,o=0;o<s.length;o++){var l=s[o];!e&&l.isLoop()||(n+=t(a,l))}return n}else return}}Ce(xh,{degree:ry(function(t,e){return e.source().same(e.target())?2:1}),indegree:ry(function(t,e){return e.target().same(t)?1:0}),outdegree:ry(function(t,e){return e.source().same(t)?1:0})});function Ms(t,e){return function(r){for(var n,a=this.nodes(),s=0;s<a.length;s++){var o=a[s],l=o[t](r);l!==void 0&&(n===void 0||e(l,n))&&(n=l)}return n}}Ce(xh,{minDegree:Ms("degree",function(t,e){return t<e}),maxDegree:Ms("degree",function(t,e){return t>e}),minIndegree:Ms("indegree",function(t,e){return t<e}),maxIndegree:Ms("indegree",function(t,e){return t>e}),minOutdegree:Ms("outdegree",function(t,e){return t<e}),maxOutdegree:Ms("outdegree",function(t,e){return t>e})});Ce(xh,{totalDegree:function(e){for(var r=0,n=this.nodes(),a=0;a<n.length;a++)r+=n[a].degree(e);return r}});var vn,Yk,Zk=function(e,r,n){for(var a=0;a<e.length;a++){var s=e[a];if(!s.locked()){var o=s._private.position,l={x:r.x!=null?r.x-o.x:0,y:r.y!=null?r.y-o.y:0};s.isParent()&&!(l.x===0&&l.y===0)&&s.children().shift(l,n),s.dirtyBoundingBoxCache()}}},gT={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,r){Zk(e,r,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};vn=Yk={position:at.data(gT),silentPosition:at.data(Ce({},gT,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,r){Zk(e,r,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,r){if(Qe(e))r?this.silentPosition(e):this.position(e);else if(Ct(e)){var n=e,a=this.cy();a.startBatch();for(var s=0;s<this.length;s++){var o=this[s],l=void 0;(l=n(o,s))&&(r?o.silentPosition(l):o.position(l))}a.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,r,n){var a;if(Qe(e)?(a={x:le(e.x)?e.x:0,y:le(e.y)?e.y:0},n=r):_e(e)&&le(r)&&(a={x:0,y:0},a[e]=r),a!=null){var s=this.cy();s.startBatch();for(var o=0;o<this.length;o++){var l=this[o];if(!(s.hasCompoundNodes()&&l.isChild()&&l.ancestors().anySame(this))){var u=l.position(),c={x:u.x+a.x,y:u.y+a.y};n?l.silentPosition(c):l.position(c)}}s.endBatch()}return this},silentShift:function(e,r){return Qe(e)?this.shift(e,!0):_e(e)&&le(r)&&this.shift(e,r,!0),this},renderedPosition:function(e,r){var n=this[0],a=this.cy(),s=a.zoom(),o=a.pan(),l=Qe(e)?e:void 0,u=l!==void 0||r!==void 0&&_e(e);if(n&&n.isNode())if(u)for(var c=0;c<this.length;c++){var f=this[c];r!==void 0?f.position(e,(r-o[e])/s):l!==void 0&&f.position(Sk(l,s,o))}else{var h=n.position();return l=vh(h,s,o),e===void 0?l:l[e]}else if(!u)return;return this},relativePosition:function(e,r){var n=this[0],a=this.cy(),s=Qe(e)?e:void 0,o=s!==void 0||r!==void 0&&_e(e),l=a.hasCompoundNodes();if(n&&n.isNode())if(o)for(var u=0;u<this.length;u++){var c=this[u],f=l?c.parent():null,h=f&&f.length>0,d=h;h&&(f=f[0]);var p=d?f.position():{x:0,y:0};r!==void 0?c.position(e,r+p[e]):s!==void 0&&c.position({x:s.x+p.x,y:s.y+p.y})}else{var g=n.position(),m=l?n.parent():null,v=m&&m.length>0,y=v;v&&(m=m[0]);var b=y?m.position():{x:0,y:0};return s={x:g.x-b.x,y:g.y-b.y},e===void 0?s:s[e]}else if(!o)return;return this}};vn.modelPosition=vn.point=vn.position;vn.modelPositions=vn.points=vn.positions;vn.renderedPoint=vn.renderedPosition;vn.relativePoint=vn.relativePosition;var VG=Yk,Hs,Hi;Hs=Hi={};Hi.renderedBoundingBox=function(t){var e=this.boundingBox(t),r=this.cy(),n=r.zoom(),a=r.pan(),s=e.x1*n+a.x,o=e.x2*n+a.x,l=e.y1*n+a.y,u=e.y2*n+a.y;return{x1:s,x2:o,y1:l,y2:u,w:o-s,h:u-l}};Hi.dirtyCompoundBoundsCache=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();return!e.styleEnabled()||!e.hasCompoundNodes()?this:(this.forEachUp(function(r){if(r.isParent()){var n=r._private;n.compoundBoundsClean=!1,n.bbCache=null,t||r.emitAndNotify("bounds")}}),this)};Hi.updateCompoundBounds=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!t&&e.batching())return this;function r(o){if(!o.isParent())return;var l=o._private,u=o.children(),c=o.pstyle("compound-sizing-wrt-labels").value==="include",f={width:{val:o.pstyle("min-width").pfValue,left:o.pstyle("min-width-bias-left"),right:o.pstyle("min-width-bias-right")},height:{val:o.pstyle("min-height").pfValue,top:o.pstyle("min-height-bias-top"),bottom:o.pstyle("min-height-bias-bottom")}},h=u.boundingBox({includeLabels:c,includeOverlays:!1,useCache:!1}),d=l.position;(h.w===0||h.h===0)&&(h={w:o.pstyle("width").pfValue,h:o.pstyle("height").pfValue},h.x1=d.x-h.w/2,h.x2=d.x+h.w/2,h.y1=d.y-h.h/2,h.y2=d.y+h.h/2);function p(T,D,k){var M=0,P=0,I=D+k;return T>0&&I>0&&(M=D/I*T,P=k/I*T),{biasDiff:M,biasComplementDiff:P}}function g(T,D,k,M){if(k.units==="%")switch(M){case"width":return T>0?k.pfValue*T:0;case"height":return D>0?k.pfValue*D:0;case"average":return T>0&&D>0?k.pfValue*(T+D)/2:0;case"min":return T>0&&D>0?T>D?k.pfValue*D:k.pfValue*T:0;case"max":return T>0&&D>0?T>D?k.pfValue*T:k.pfValue*D:0;default:return 0}else return k.units==="px"?k.pfValue:0}var m=f.width.left.value;f.width.left.units==="px"&&f.width.val>0&&(m=m*100/f.width.val);var v=f.width.right.value;f.width.right.units==="px"&&f.width.val>0&&(v=v*100/f.width.val);var y=f.height.top.value;f.height.top.units==="px"&&f.height.val>0&&(y=y*100/f.height.val);var b=f.height.bottom.value;f.height.bottom.units==="px"&&f.height.val>0&&(b=b*100/f.height.val);var w=p(f.width.val-h.w,m,v),_=w.biasDiff,x=w.biasComplementDiff,S=p(f.height.val-h.h,y,b),E=S.biasDiff,A=S.biasComplementDiff;l.autoPadding=g(h.w,h.h,o.pstyle("padding"),o.pstyle("padding-relative-to").value),l.autoWidth=Math.max(h.w,f.width.val),d.x=(-_+h.x1+h.x2+x)/2,l.autoHeight=Math.max(h.h,f.height.val),d.y=(-E+h.y1+h.y2+A)/2}for(var n=0;n<this.length;n++){var a=this[n],s=a._private;(!s.compoundBoundsClean||t)&&(r(a),e.batching()||(s.compoundBoundsClean=!0))}return this};var Jr=function(e){return e===1/0||e===-1/0?0:e},gn=function(e,r,n,a,s){a-r===0||s-n===0||r==null||n==null||a==null||s==null||(e.x1=r<e.x1?r:e.x1,e.x2=a>e.x2?a:e.x2,e.y1=n<e.y1?n:e.y1,e.y2=s>e.y2?s:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},Ma=function(e,r){return r==null?e:gn(e,r.x1,r.y1,r.x2,r.y2)},El=function(e,r,n){return Dr(e,r,n)},Bf=function(e,r,n){if(!r.cy().headless()){var a=r._private,s=a.rstyle,o=s.arrowWidth/2,l=r.pstyle(n+"-arrow-shape").value,u,c;if(l!=="none"){n==="source"?(u=s.srcX,c=s.srcY):n==="target"?(u=s.tgtX,c=s.tgtY):(u=s.midX,c=s.midY);var f=a.arrowBounds=a.arrowBounds||{},h=f[n]=f[n]||{};h.x1=u-o,h.y1=c-o,h.x2=u+o,h.y2=c+o,h.w=h.x2-h.x1,h.h=h.y2-h.y1,Uf(h,1),gn(e,h.x1,h.y1,h.x2,h.y2)}}},ny=function(e,r,n){if(!r.cy().headless()){var a;n?a=n+"-":a="";var s=r._private,o=s.rstyle,l=r.pstyle(a+"label").strValue;if(l){var u=r.pstyle("text-halign"),c=r.pstyle("text-valign"),f=El(o,"labelWidth",n),h=El(o,"labelHeight",n),d=El(o,"labelX",n),p=El(o,"labelY",n),g=r.pstyle(a+"text-margin-x").pfValue,m=r.pstyle(a+"text-margin-y").pfValue,v=r.isEdge(),y=r.pstyle(a+"text-rotation"),b=r.pstyle("text-outline-width").pfValue,w=r.pstyle("text-border-width").pfValue,_=w/2,x=r.pstyle("text-background-padding").pfValue,S=2,E=h,A=f,T=A/2,D=E/2,k,M,P,I;if(v)k=d-T,M=d+T,P=p-D,I=p+D;else{switch(u.value){case"left":k=d-A,M=d;break;case"center":k=d-T,M=d+T;break;case"right":k=d,M=d+A;break}switch(c.value){case"top":P=p-E,I=p;break;case"center":P=p-D,I=p+D;break;case"bottom":P=p,I=p+E;break}}var B=g-Math.max(b,_)-x-S,L=g+Math.max(b,_)+x+S,N=m-Math.max(b,_)-x-S,F=m+Math.max(b,_)+x+S;k+=B,M+=L,P+=N,I+=F;var q=n||"main",H=s.labelBounds,V=H[q]=H[q]||{};V.x1=k,V.y1=P,V.x2=M,V.y2=I,V.w=M-k,V.h=I-P,V.leftPad=B,V.rightPad=L,V.topPad=N,V.botPad=F;var z=v&&y.strValue==="autorotate",Y=y.pfValue!=null&&y.pfValue!==0;if(z||Y){var Q=z?El(s.rstyle,"labelAngle",n):y.pfValue,J=Math.cos(Q),ee=Math.sin(Q),ae=(k+M)/2,ue=(P+I)/2;if(!v){switch(u.value){case"left":ae=M;break;case"right":ae=k;break}switch(c.value){case"top":ue=I;break;case"bottom":ue=P;break}}var re=function(ot,pe){return ot=ot-ae,pe=pe-ue,{x:ot*J-pe*ee+ae,y:ot*ee+pe*J+ue}},U=re(k,P),G=re(k,I),j=re(M,P),se=re(M,I);k=Math.min(U.x,G.x,j.x,se.x),M=Math.max(U.x,G.x,j.x,se.x),P=Math.min(U.y,G.y,j.y,se.y),I=Math.max(U.y,G.y,j.y,se.y)}var fe=q+"Rot",Pe=H[fe]=H[fe]||{};Pe.x1=k,Pe.y1=P,Pe.x2=M,Pe.y2=I,Pe.w=M-k,Pe.h=I-P,gn(e,k,P,M,I),gn(s.labelBounds.all,k,P,M,I)}return e}},zG=function(e,r){if(!r.cy().headless()){var n=r.pstyle("outline-opacity").value,a=r.pstyle("outline-width").value;if(n>0&&a>0){var s=r.pstyle("outline-offset").value,o=r.pstyle("shape").value,l=a+s,u=(e.w+l*2)/e.w,c=(e.h+l*2)/e.h,f=0,h=0;["diamond","pentagon","round-triangle"].includes(o)?(u=(e.w+l*2.4)/e.w,h=-l/3.6):["concave-hexagon","rhomboid","right-rhomboid"].includes(o)?u=(e.w+l*2.4)/e.w:o==="star"?(u=(e.w+l*2.8)/e.w,c=(e.h+l*2.6)/e.h,h=-l/3.8):o==="triangle"?(u=(e.w+l*2.8)/e.w,c=(e.h+l*2.4)/e.h,h=-l/1.4):o==="vee"&&(u=(e.w+l*4.4)/e.w,c=(e.h+l*3.8)/e.h,h=-l*.5);var d=e.h*c-e.h,p=e.w*u-e.w;if(Wf(e,[Math.ceil(d/2),Math.ceil(p/2)]),f!=0||h!==0){var g=SW(e,f,h);Ck(e,g)}}}},HG=function(e,r){var n=e._private.cy,a=n.styleEnabled(),s=n.headless(),o=Br(),l=e._private,u=e.isNode(),c=e.isEdge(),f,h,d,p,g,m,v=l.rstyle,y=u&&a?e.pstyle("bounds-expansion").pfValue:[0],b=function(wt){return wt.pstyle("display").value!=="none"},w=!a||b(e)&&(!c||b(e.source())&&b(e.target()));if(w){var _=0,x=0;a&&r.includeOverlays&&(_=e.pstyle("overlay-opacity").value,_!==0&&(x=e.pstyle("overlay-padding").value));var S=0,E=0;a&&r.includeUnderlays&&(S=e.pstyle("underlay-opacity").value,S!==0&&(E=e.pstyle("underlay-padding").value));var A=Math.max(x,E),T=0,D=0;if(a&&(T=e.pstyle("width").pfValue,D=T/2),u&&r.includeNodes){var k=e.position();g=k.x,m=k.y;var M=e.outerWidth(),P=M/2,I=e.outerHeight(),B=I/2;f=g-P,h=g+P,d=m-B,p=m+B,gn(o,f,d,h,p),a&&r.includeOutlines&&zG(o,e)}else if(c&&r.includeEdges)if(a&&!s){var L=e.pstyle("curve-style").strValue;if(f=Math.min(v.srcX,v.midX,v.tgtX),h=Math.max(v.srcX,v.midX,v.tgtX),d=Math.min(v.srcY,v.midY,v.tgtY),p=Math.max(v.srcY,v.midY,v.tgtY),f-=D,h+=D,d-=D,p+=D,gn(o,f,d,h,p),L==="haystack"){var N=v.haystackPts;if(N&&N.length===2){if(f=N[0].x,d=N[0].y,h=N[1].x,p=N[1].y,f>h){var F=f;f=h,h=F}if(d>p){var q=d;d=p,p=q}gn(o,f-D,d-D,h+D,p+D)}}else if(L==="bezier"||L==="unbundled-bezier"||L.endsWith("segments")||L.endsWith("taxi")){var H;switch(L){case"bezier":case"unbundled-bezier":H=v.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":H=v.linePts;break}if(H!=null)for(var V=0;V<H.length;V++){var z=H[V];f=z.x-D,h=z.x+D,d=z.y-D,p=z.y+D,gn(o,f,d,h,p)}}}else{var Y=e.source(),Q=Y.position(),J=e.target(),ee=J.position();if(f=Q.x,h=ee.x,d=Q.y,p=ee.y,f>h){var ae=f;f=h,h=ae}if(d>p){var ue=d;d=p,p=ue}f-=D,h+=D,d-=D,p+=D,gn(o,f,d,h,p)}if(a&&r.includeEdges&&c&&(Bf(o,e,"mid-source"),Bf(o,e,"mid-target"),Bf(o,e,"source"),Bf(o,e,"target")),a){var re=e.pstyle("ghost").value==="yes";if(re){var U=e.pstyle("ghost-offset-x").pfValue,G=e.pstyle("ghost-offset-y").pfValue;gn(o,o.x1+U,o.y1+G,o.x2+U,o.y2+G)}}var j=l.bodyBounds=l.bodyBounds||{};rC(j,o),Wf(j,y),Uf(j,1),a&&(f=o.x1,h=o.x2,d=o.y1,p=o.y2,gn(o,f-A,d-A,h+A,p+A));var se=l.overlayBounds=l.overlayBounds||{};rC(se,o),Wf(se,y),Uf(se,1);var fe=l.labelBounds=l.labelBounds||{};fe.all!=null?EW(fe.all):fe.all=Br(),a&&r.includeLabels&&(r.includeMainLabels&&ny(o,e,null),c&&(r.includeSourceLabels&&ny(o,e,"source"),r.includeTargetLabels&&ny(o,e,"target")))}return o.x1=Jr(o.x1),o.y1=Jr(o.y1),o.x2=Jr(o.x2),o.y2=Jr(o.y2),o.w=Jr(o.x2-o.x1),o.h=Jr(o.y2-o.y1),o.w>0&&o.h>0&&w&&(Wf(o,y),Uf(o,1)),o},Xk=function(e){var r=0,n=function(o){return(o?1:0)<<r++},a=0;return a+=n(e.incudeNodes),a+=n(e.includeEdges),a+=n(e.includeLabels),a+=n(e.includeMainLabels),a+=n(e.includeSourceLabels),a+=n(e.includeTargetLabels),a+=n(e.includeOverlays),a+=n(e.includeOutlines),a},$k=function(e){var r=function(l){return Math.round(l)};if(e.isEdge()){var n=e.source().position(),a=e.target().position();return XS([r(n.x),r(n.y),r(a.x),r(a.y)])}else{var s=e.position();return XS([r(s.x),r(s.y)])}},vT=function(e,r){var n=e._private,a,s=e.isEdge(),o=r==null?mT:Xk(r),l=o===mT;if(n.bbCache==null?(a=HG(e,zl),n.bbCache=a,n.bbCachePosKey=$k(e)):a=n.bbCache,!l){var u=e.isNode();a=Br(),(r.includeNodes&&u||r.includeEdges&&!u)&&(r.includeOverlays?Ma(a,n.overlayBounds):Ma(a,n.bodyBounds)),r.includeLabels&&(r.includeMainLabels&&(!s||r.includeSourceLabels&&r.includeTargetLabels)?Ma(a,n.labelBounds.all):(r.includeMainLabels&&Ma(a,n.labelBounds.mainRot),r.includeSourceLabels&&Ma(a,n.labelBounds.sourceRot),r.includeTargetLabels&&Ma(a,n.labelBounds.targetRot))),a.w=a.x2-a.x1,a.h=a.y2-a.y1}return a},zl={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},mT=Xk(zl),yT=ar(zl);Hi.boundingBox=function(t){var e,r=t===void 0||t.useCache===void 0||t.useCache===!0,n=Us(function(f){var h=f._private;return h.bbCache==null||h.styleDirty||h.bbCachePosKey!==$k(f)},function(f){return f.id()});if(r&&this.length===1&&!n(this[0]))t===void 0?t=zl:t=yT(t),e=vT(this[0],t);else{e=Br(),t=t||zl;var a=yT(t),s=this,o=s.cy(),l=o.styleEnabled();this.edges().forEach(n),this.nodes().forEach(n),l&&this.recalculateRenderedStyle(r),this.updateCompoundBounds(!r);for(var u=0;u<s.length;u++){var c=s[u];n(c)&&c.dirtyBoundingBoxCache(),Ma(e,vT(c,a))}}return e.x1=Jr(e.x1),e.y1=Jr(e.y1),e.x2=Jr(e.x2),e.y2=Jr(e.y2),e.w=Jr(e.x2-e.x1),e.h=Jr(e.y2-e.y1),e};Hi.dirtyBoundingBoxCache=function(){for(var t=0;t<this.length;t++){var e=this[t]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};Hi.boundingBoxAt=function(t){var e=this.nodes(),r=this.cy(),n=r.hasCompoundNodes(),a=r.collection();if(n&&(a=e.filter(function(c){return c.isParent()}),e=e.not(a)),Qe(t)){var s=t;t=function(){return s}}var o=function(f,h){return f._private.bbAtOldPos=t(f,h)},l=function(f){return f._private.bbAtOldPos};r.startBatch(),e.forEach(o).silentPositions(t),n&&(a.dirtyCompoundBoundsCache(),a.dirtyBoundingBoxCache(),a.updateCompoundBounds(!0));var u=xW(this.boundingBox({useCache:!1}));return e.silentPositions(l),n&&(a.dirtyCompoundBoundsCache(),a.dirtyBoundingBoxCache(),a.updateCompoundBounds(!0)),r.endBatch(),u};Hs.boundingbox=Hs.bb=Hs.boundingBox;Hs.renderedBoundingbox=Hs.renderedBoundingBox;var UG=Hi,Pl,Ql;Pl=Ql={};var Qk=function(e){e.uppercaseName=BS(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=BS(e.outerName),Pl[e.name]=function(){var n=this[0],a=n._private,s=a.cy,o=s._private.styleEnabled;if(n)if(o){if(n.isParent())return n.updateCompoundBounds(),a[e.autoName]||0;var l=n.pstyle(e.name);switch(l.strValue){case"label":return n.recalculateRenderedStyle(),a.rstyle[e.labelName]||0;default:return l.pfValue}}else return 1},Pl["outer"+e.uppercaseName]=function(){var n=this[0],a=n._private,s=a.cy,o=s._private.styleEnabled;if(n)if(o){var l=n[e.name](),u=n.pstyle("border-position").value,c;u==="center"?c=n.pstyle("border-width").pfValue:u==="outside"?c=2*n.pstyle("border-width").pfValue:c=0;var f=2*n.padding();return l+c+f}else return 1},Pl["rendered"+e.uppercaseName]=function(){var n=this[0];if(n){var a=n[e.name]();return a*this.cy().zoom()}},Pl["rendered"+e.uppercaseOuterName]=function(){var n=this[0];if(n){var a=n[e.outerName]();return a*this.cy().zoom()}}};Qk({name:"width"});Qk({name:"height"});Ql.padding=function(){var t=this[0],e=t._private;return t.isParent()?(t.updateCompoundBounds(),e.autoPadding!==void 0?e.autoPadding:t.pstyle("padding").pfValue):t.pstyle("padding").pfValue};Ql.paddedHeight=function(){var t=this[0];return t.height()+2*t.padding()};Ql.paddedWidth=function(){var t=this[0];return t.width()+2*t.padding()};var WG=Ql,GG=function(e,r){if(e.isEdge()&&e.takesUpSpace())return r(e)},KG=function(e,r){if(e.isEdge()&&e.takesUpSpace()){var n=e.cy();return vh(r(e),n.zoom(),n.pan())}},jG=function(e,r){if(e.isEdge()&&e.takesUpSpace()){var n=e.cy(),a=n.pan(),s=n.zoom();return r(e).map(function(o){return vh(o,s,a)})}},YG=function(e){return e.renderer().getControlPoints(e)},ZG=function(e){return e.renderer().getSegmentPoints(e)},XG=function(e){return e.renderer().getSourceEndpoint(e)},$G=function(e){return e.renderer().getTargetEndpoint(e)},QG=function(e){return e.renderer().getEdgeMidpoint(e)},bT={controlPoints:{get:YG,mult:!0},segmentPoints:{get:ZG,mult:!0},sourceEndpoint:{get:XG},targetEndpoint:{get:$G},midpoint:{get:QG}},JG=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)},e6=Object.keys(bT).reduce(function(t,e){var r=bT[e],n=JG(e);return t[e]=function(){return GG(this,r.get)},r.mult?t[n]=function(){return jG(this,r.get)}:t[n]=function(){return KG(this,r.get)},t},{}),t6=Ce({},VG,UG,WG,e6);var Jk=function(e,r){this.recycle(e,r)};function Sl(){return!1}function Lf(){return!0}Jk.prototype={instanceString:function(){return"event"},recycle:function(e,r){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=Sl,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?Lf:Sl):e!=null&&e.type?r=e:this.type=e,r!=null&&(this.originalEvent=r.originalEvent,this.type=r.type!=null?r.type:this.type,this.cy=r.cy,this.target=r.target,this.position=r.position,this.renderedPosition=r.renderedPosition,this.namespace=r.namespace,this.layout=r.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var n=this.position,a=this.cy.zoom(),s=this.cy.pan();this.renderedPosition={x:n.x*a+s.x,y:n.y*a+s.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=Lf;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=Lf;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Lf,this.stopPropagation()},isDefaultPrevented:Sl,isPropagationStopped:Sl,isImmediatePropagationStopped:Sl};var eA=/^([^.]+)(\.(?:[^.]+))?$/,r6=".*",tA={qualifierCompare:function(e,r){return e===r},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},wT=Object.keys(tA),n6={};function Eh(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:n6,e=arguments.length>1?arguments[1]:void 0,r=0;r<wT.length;r++){var n=wT[r];this[n]=t[n]||tA[n]}this.context=e||this.context,this.listeners=[],this.emitting=0}var qi=Eh.prototype,rA=function(e,r,n,a,s,o,l){Ct(a)&&(s=a,a=null),l&&(o==null?o=l:o=Ce({},o,l));for(var u=dt(n)?n:n.split(/\s+/),c=0;c<u.length;c++){var f=u[c];if(!Ii(f)){var h=f.match(eA);if(h){var d=h[1],p=h[2]?h[2]:null,g=r(e,f,d,p,a,s,o);if(g===!1)break}}}},_T=function(e,r){return e.addEventFields(e.context,r),new Jk(r.type,r)},i6=function(e,r,n){if(dU(n)){r(e,n);return}else if(Qe(n)){r(e,_T(e,n));return}for(var a=dt(n)?n:n.split(/\s+/),s=0;s<a.length;s++){var o=a[s];if(!Ii(o)){var l=o.match(eA);if(l){var u=l[1],c=l[2]?l[2]:null,f=_T(e,{type:u,namespace:c,target:e.context});r(e,f)}}}};qi.on=qi.addListener=function(t,e,r,n,a){return rA(this,function(s,o,l,u,c,f,h){Ct(f)&&s.listeners.push({event:o,callback:f,type:l,namespace:u,qualifier:c,conf:h})},t,e,r,n,a),this};qi.one=function(t,e,r,n){return this.on(t,e,r,n,{one:!0})};qi.removeListener=qi.off=function(t,e,r,n){var a=this;this.emitting!==0&&(this.listeners=KU(this.listeners));for(var s=this.listeners,o=function(c){var f=s[c];rA(a,function(h,d,p,g,m,v){if((f.type===p||t==="*")&&(!g&&f.namespace!==".*"||f.namespace===g)&&(!m||h.qualifierCompare(f.qualifier,m))&&(!v||f.callback===v))return s.splice(c,1),!1},t,e,r,n)},l=s.length-1;l>=0;l--)o(l);return this};qi.removeAllListeners=function(){return this.removeListener("*")};qi.emit=qi.trigger=function(t,e,r){var n=this.listeners,a=n.length;return this.emitting++,dt(e)||(e=[e]),i6(this,function(s,o){r!=null&&(n=[{event:o.event,type:o.type,namespace:o.namespace,callback:r}],a=n.length);for(var l=function(){var f=n[u];if(f.type===o.type&&(!f.namespace||f.namespace===o.namespace||f.namespace===r6)&&s.eventMatches(s.context,f,o)){var h=[o];e!=null&&YU(h,e),s.beforeEmit(s.context,f,o),f.conf&&f.conf.one&&(s.listeners=s.listeners.filter(function(g){return g!==f}));var d=s.callbackContext(s.context,f,o),p=f.callback.apply(d,h);s.afterEmit(s.context,f,o),p===!1&&(o.stopPropagation(),o.preventDefault())}},u=0;u<a;u++)l();s.bubble(s.context)&&!o.isPropagationStopped()&&s.parent(s.context).emit(o,e)},t),this.emitting--,this};var a6={qualifierCompare:function(e,r){return e==null||r==null?e==null&&r==null:e.sameText(r)},eventMatches:function(e,r,n){var a=r.qualifier;return a!=null?e!==n.target&&Kl(n.target)&&a.matches(n.target):!0},addEventFields:function(e,r){r.cy=e.cy(),r.target=e},callbackContext:function(e,r,n){return r.qualifier!=null?n.target:e},beforeEmit:function(e,r){r.conf&&r.conf.once&&r.conf.onceCollection.removeListener(r.event,r.qualifier,r.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},Nf=function(e){return _e(e)?new Ni(e):e},nA={createEmitter:function(){for(var e=0;e<this.length;e++){var r=this[e],n=r._private;n.emitter||(n.emitter=new Eh(a6,r))}return this},emitter:function(){return this._private.emitter},on:function(e,r,n){for(var a=Nf(r),s=0;s<this.length;s++){var o=this[s];o.emitter().on(e,a,n)}return this},removeListener:function(e,r,n){for(var a=Nf(r),s=0;s<this.length;s++){var o=this[s];o.emitter().removeListener(e,a,n)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){var r=this[e];r.emitter().removeAllListeners()}return this},one:function(e,r,n){for(var a=Nf(r),s=0;s<this.length;s++){var o=this[s];o.emitter().one(e,a,n)}return this},once:function(e,r,n){for(var a=Nf(r),s=0;s<this.length;s++){var o=this[s];o.emitter().on(e,a,n,{once:!0,onceCollection:this})}},emit:function(e,r){for(var n=0;n<this.length;n++){var a=this[n];a.emitter().emit(e,r)}return this},emitAndNotify:function(e,r){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,r),this}};at.eventAliasesOn(nA);var iA={nodes:function(e){return this.filter(function(r){return r.isNode()}).filter(e)},edges:function(e){return this.filter(function(r){return r.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),r=this.spawn(),n=0;n<this.length;n++){var a=this[n];a.isNode()?e.push(a):r.push(a)}return{nodes:e,edges:r}},filter:function(e,r){if(e===void 0)return this;if(_e(e)||Hr(e))return new Ni(e).filter(this);if(Ct(e)){for(var n=this.spawn(),a=this,s=0;s<a.length;s++){var o=a[s],l=r?e.apply(r,[o,s,a]):e(o,s,a);l&&n.push(o)}return n}return this.spawn()},not:function(e){if(e){_e(e)&&(e=this.filter(e));for(var r=this.spawn(),n=0;n<this.length;n++){var a=this[n],s=e.has(a);s||r.push(a)}return r}else return this},absoluteComplement:function(){var e=this.cy();return e.mutableElements().not(this)},intersect:function(e){if(_e(e)){var r=e;return this.filter(r)}for(var n=this.spawn(),a=this,s=e,o=this.length<e.length,l=o?a:s,u=o?s:a,c=0;c<l.length;c++){var f=l[c];u.has(f)&&n.push(f)}return n},xor:function(e){var r=this._private.cy;_e(e)&&(e=r.$(e));var n=this.spawn(),a=this,s=e,o=function(u,c){for(var f=0;f<u.length;f++){var h=u[f],d=h._private.data.id,p=c.hasElementWithId(d);p||n.push(h)}};return o(a,s),o(s,a),n},diff:function(e){var r=this._private.cy;_e(e)&&(e=r.$(e));var n=this.spawn(),a=this.spawn(),s=this.spawn(),o=this,l=e,u=function(f,h,d){for(var p=0;p<f.length;p++){var g=f[p],m=g._private.data.id,v=h.hasElementWithId(m);v?s.merge(g):d.push(g)}};return u(o,l,n),u(l,o,a),{left:n,right:a,both:s}},add:function(e){var r=this._private.cy;if(!e)return this;if(_e(e)){var n=e;e=r.mutableElements().filter(n)}for(var a=this.spawnSelf(),s=0;s<e.length;s++){var o=e[s],l=!this.has(o);l&&a.push(o)}return a},merge:function(e){var r=this._private,n=r.cy;if(!e)return this;if(e&&_e(e)){var a=e;e=n.mutableElements().filter(a)}for(var s=r.map,o=0;o<e.length;o++){var l=e[o],u=l._private.data.id,c=!s.has(u);if(c){var f=this.length++;this[f]=l,s.set(u,{ele:l,index:f})}}return this},unmergeAt:function(e){var r=this[e],n=r.id(),a=this._private,s=a.map;this[e]=void 0,s.delete(n);var o=e===this.length-1;if(this.length>1&&!o){var l=this.length-1,u=this[l],c=u._private.data.id;this[l]=void 0,this[e]=u,s.set(c,{ele:u,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var r=this._private,n=e._private.data.id,a=r.map,s=a.get(n);if(!s)return this;var o=s.index;return this.unmergeAt(o),this},unmerge:function(e){var r=this._private.cy;if(!e)return this;if(e&&_e(e)){var n=e;e=r.mutableElements().filter(n)}for(var a=0;a<e.length;a++)this.unmergeOne(e[a]);return this},unmergeBy:function(e){for(var r=this.length-1;r>=0;r--){var n=this[r];e(n)&&this.unmergeAt(r)}return this},map:function(e,r){for(var n=[],a=this,s=0;s<a.length;s++){var o=a[s],l=r?e.apply(r,[o,s,a]):e(o,s,a);n.push(l)}return n},reduce:function(e,r){for(var n=r,a=this,s=0;s<a.length;s++)n=e(n,a[s],s,a);return n},max:function(e,r){for(var n=-1/0,a,s=this,o=0;o<s.length;o++){var l=s[o],u=r?e.apply(r,[l,o,s]):e(l,o,s);u>n&&(n=u,a=l)}return{value:n,ele:a}},min:function(e,r){for(var n=1/0,a,s=this,o=0;o<s.length;o++){var l=s[o],u=r?e.apply(r,[l,o,s]):e(l,o,s);u<n&&(n=u,a=l)}return{value:n,ele:a}}},tt=iA;tt.u=tt["|"]=tt["+"]=tt.union=tt.or=tt.add;tt["\\"]=tt["!"]=tt["-"]=tt.difference=tt.relativeComplement=tt.subtract=tt.not;tt.n=tt["&"]=tt["."]=tt.and=tt.intersection=tt.intersect;tt["^"]=tt["(+)"]=tt["(-)"]=tt.symmetricDifference=tt.symdiff=tt.xor;tt.fnFilter=tt.filterFn=tt.stdFilter=tt.filter;tt.complement=tt.abscomp=tt.absoluteComplement;var s6={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},aA=function(e,r){var n=e.cy(),a=n.hasCompoundNodes();function s(f){var h=f.pstyle("z-compound-depth");return h.value==="auto"?a?f.zDepth():0:h.value==="bottom"?-1:h.value==="top"?qy:0}var o=s(e)-s(r);if(o!==0)return o;function l(f){var h=f.pstyle("z-index-compare");return h.value==="auto"&&f.isNode()?1:0}var u=l(e)-l(r);if(u!==0)return u;var c=e.pstyle("z-index").value-r.pstyle("z-index").value;return c!==0?c:e.poolIndex()-r.poolIndex()},sh={forEach:function(e,r){if(Ct(e))for(var n=this.length,a=0;a<n;a++){var s=this[a],o=r?e.apply(r,[s,a,this]):e(s,a,this);if(o===!1)break}return this},toArray:function(){for(var e=[],r=0;r<this.length;r++)e.push(this[r]);return e},slice:function(e,r){var n=[],a=this.length;r==null&&(r=a),e==null&&(e=0),e<0&&(e=a+e),r<0&&(r=a+r);for(var s=e;s>=0&&s<r&&s<a;s++)n.push(this[s]);return this.spawn(n)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!Ct(e))return this;var r=this.toArray().sort(e);return this.spawn(r)},sortByZIndex:function(){return this.sort(aA)},zDepth:function(){var e=this[0];if(e){var r=e._private,n=r.group;if(n==="nodes"){var a=r.data.parent?e.parents().size():0;return e.isParent()?a:qy-1}else{var s=r.source,o=r.target,l=s.zDepth(),u=o.zDepth();return Math.max(l,u,0)}}}};sh.each=sh.forEach;var o6=function(){var e="undefined",r=(typeof Symbol>"u"?"undefined":Ut(Symbol))!=e&&Ut(Symbol.iterator)!=e;r&&(sh[Symbol.iterator]=function(){var n=this,a={value:void 0,done:!1},s=0,o=this.length;return ak({next:function(){return s<o?a.value=n[s++]:(a.value=void 0,a.done=!0),a}},Symbol.iterator,function(){return this})})};o6();var l6=ar({nodeDimensionsIncludeLabels:!1}),Kf={layoutDimensions:function(e){e=l6(e);var r;if(!this.takesUpSpace())r={w:0,h:0};else if(e.nodeDimensionsIncludeLabels){var n=this.boundingBox();r={w:n.w,h:n.h}}else r={w:this.outerWidth(),h:this.outerHeight()};return(r.w===0||r.h===0)&&(r.w=r.h=1),r},layoutPositions:function(e,r,n){var a=this.nodes().filter(function(x){return!x.isParent()}),s=this.cy(),o=r.eles,l=function(S){return S.id()},u=Us(n,l);e.emit({type:"layoutstart",layout:e}),e.animations=[];var c=function(S,E,A){var T={x:E.x1+E.w/2,y:E.y1+E.h/2},D={x:(A.x-T.x)*S,y:(A.y-T.y)*S};return{x:T.x+D.x,y:T.y+D.y}},f=r.spacingFactor&&r.spacingFactor!==1,h=function(){if(!f)return null;for(var S=Br(),E=0;E<a.length;E++){var A=a[E],T=u(A,E);CW(S,T.x,T.y)}return S},d=h(),p=Us(function(x,S){var E=u(x,S);if(f){var A=Math.abs(r.spacingFactor);E=c(A,d,E)}return r.transform!=null&&(E=r.transform(x,E)),E},l);if(r.animate){for(var g=0;g<a.length;g++){var m=a[g],v=p(m,g),y=r.animateFilter==null||r.animateFilter(m,g);if(y){var b=m.animation({position:v,duration:r.animationDuration,easing:r.animationEasing});e.animations.push(b)}else m.position(v)}if(r.fit){var w=s.animation({fit:{boundingBox:o.boundingBoxAt(p),padding:r.padding},duration:r.animationDuration,easing:r.animationEasing});e.animations.push(w)}else if(r.zoom!==void 0&&r.pan!==void 0){var _=s.animation({zoom:r.zoom,pan:r.pan,duration:r.animationDuration,easing:r.animationEasing});e.animations.push(_)}e.animations.forEach(function(x){return x.play()}),e.one("layoutready",r.ready),e.emit({type:"layoutready",layout:e}),Ys.all(e.animations.map(function(x){return x.promise()})).then(function(){e.one("layoutstop",r.stop),e.emit({type:"layoutstop",layout:e})})}else a.positions(p),r.fit&&s.fit(r.eles,r.padding),r.zoom!=null&&s.zoom(r.zoom),r.pan&&s.pan(r.pan),e.one("layoutready",r.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",r.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){var r=this.cy();return r.makeLayout(Ce({},e,{eles:this}))}};Kf.createLayout=Kf.makeLayout=Kf.layout;function sA(t,e,r){var n=r._private,a=n.styleCache=n.styleCache||[],s;return(s=a[t])!=null||(s=a[t]=e(r)),s}function Sh(t,e){return t=Ia(t),function(n){return sA(t,e,n)}}function Ch(t,e){t=Ia(t);var r=function(a){return e.call(a)};return function(){var a=this[0];if(a)return sA(t,r,a)}}var nr={recalculateRenderedStyle:function(e){var r=this.cy(),n=r.renderer(),a=r.styleEnabled();return n&&a&&n.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e=this.cy(),r=function(s){return s._private.styleCache=null};if(e.hasCompoundNodes()){var n;n=this.spawnSelf().merge(this.descendants()).merge(this.parents()),n.merge(n.connectedEdges()),n.forEach(r)}else this.forEach(function(a){r(a),a.connectedEdges().forEach(r)});return this},updateStyle:function(e){var r=this._private.cy;if(!r.styleEnabled())return this;if(r.batching()){var n=r._private.batchStyleEles;return n.merge(this),this}var a=r.hasCompoundNodes(),s=this;e=!!(e||e===void 0),a&&(s=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var o=s;return e?o.emitAndNotify("style"):o.emit("style"),s.forEach(function(l){return l._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(e.styleEnabled())for(var r=0;r<this.length;r++){var n=this[r];n._private.styleDirty&&(n._private.styleDirty=!1,e.style().apply(n))}},parsedStyle:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this[0],a=n.cy();if(a.styleEnabled()&&n){n._private.styleDirty&&(n._private.styleDirty=!1,a.style().apply(n));var s=n._private.style[e];return s??(r?a.style().getDefaultProperty(e):null)}},numericStyle:function(e){var r=this[0];if(r.cy().styleEnabled()&&r){var n=r.pstyle(e);return n.pfValue!==void 0?n.pfValue:n.value}},numericStyleUnits:function(e){var r=this[0];if(r.cy().styleEnabled()&&r)return r.pstyle(e).units},renderedStyle:function(e){var r=this.cy();if(!r.styleEnabled())return this;var n=this[0];if(n)return r.style().getRenderedStyle(n,e)},style:function(e,r){var n=this.cy();if(!n.styleEnabled())return this;var a=!1,s=n.style();if(Qe(e)){var o=e;s.applyBypass(this,o,a),this.emitAndNotify("style")}else if(_e(e))if(r===void 0){var l=this[0];return l?s.getStylePropertyValue(l,e):void 0}else s.applyBypass(this,e,r,a),this.emitAndNotify("style");else if(e===void 0){var u=this[0];return u?s.getRawStyle(u):void 0}return this},removeStyle:function(e){var r=this.cy();if(!r.styleEnabled())return this;var n=!1,a=r.style(),s=this;if(e===void 0)for(var o=0;o<s.length;o++){var l=s[o];a.removeAllBypasses(l,n)}else{e=e.split(/\s+/);for(var u=0;u<s.length;u++){var c=s[u];a.removeBypasses(c,e,n)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var r=e.hasCompoundNodes(),n=this[0];if(n){var a=n._private,s=n.pstyle("opacity").value;if(!r)return s;var o=a.data.parent?n.parents():null;if(o)for(var l=0;l<o.length;l++){var u=o[l],c=u.pstyle("opacity").value;s=c*s}return s}},transparent:function(){var e=this.cy();if(!e.styleEnabled())return!1;var r=this[0],n=r.cy().hasCompoundNodes();if(r)return n?r.effectiveOpacity()===0:r.pstyle("opacity").value===0},backgrounding:function(){var e=this.cy();if(!e.styleEnabled())return!1;var r=this[0];return!!r._private.backgrounding}};function iy(t,e){var r=t._private,n=r.data.parent?t.parents():null;if(n)for(var a=0;a<n.length;a++){var s=n[a];if(!e(s))return!1}return!0}function $y(t){var e=t.ok,r=t.edgeOkViaNode||t.ok,n=t.parentOk||t.ok;return function(){var a=this.cy();if(!a.styleEnabled())return!0;var s=this[0],o=a.hasCompoundNodes();if(s){var l=s._private;if(!e(s))return!1;if(s.isNode())return!o||iy(s,n);var u=l.source,c=l.target;return r(u)&&(!o||iy(u,r))&&(u===c||r(c)&&(!o||iy(c,r)))}}}var Zs=Sh("eleTakesUpSpace",function(t){return t.pstyle("display").value==="element"&&t.width()!==0&&(t.isNode()?t.height()!==0:!0)});nr.takesUpSpace=Ch("takesUpSpace",$y({ok:Zs}));var u6=Sh("eleInteractive",function(t){return t.pstyle("events").value==="yes"&&t.pstyle("visibility").value==="visible"&&Zs(t)}),c6=Sh("parentInteractive",function(t){return t.pstyle("visibility").value==="visible"&&Zs(t)});nr.interactive=Ch("interactive",$y({ok:u6,parentOk:c6,edgeOkViaNode:Zs}));nr.noninteractive=function(){var t=this[0];if(t)return!t.interactive()};var f6=Sh("eleVisible",function(t){return t.pstyle("visibility").value==="visible"&&t.pstyle("opacity").pfValue!==0&&Zs(t)}),h6=Zs;nr.visible=Ch("visible",$y({ok:f6,edgeOkViaNode:h6}));nr.hidden=function(){var t=this[0];if(t)return!t.visible()};nr.isBundledBezier=Ch("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});nr.bypass=nr.css=nr.style;nr.renderedCss=nr.renderedStyle;nr.removeBypass=nr.removeCss=nr.removeStyle;nr.pstyle=nr.parsedStyle;var Oi={};function xT(t){return function(){var e=arguments,r=[];if(e.length===2){var n=e[0],a=e[1];this.on(t.event,n,a)}else if(e.length===1&&Ct(e[0])){var s=e[0];this.on(t.event,s)}else if(e.length===0||e.length===1&&dt(e[0])){for(var o=e.length===1?e[0]:null,l=0;l<this.length;l++){var u=this[l],c=!t.ableField||u._private[t.ableField],f=u._private[t.field]!=t.value;if(t.overrideAble){var h=t.overrideAble(u);if(h!==void 0&&(c=h,!h))return this}c&&(u._private[t.field]=t.value,f&&r.push(u))}var d=this.spawn(r);d.updateStyle(),d.emit(t.event),o&&d.emit(o)}return this}}function Xs(t){Oi[t.field]=function(){var e=this[0];if(e){if(t.overrideField){var r=t.overrideField(e);if(r!==void 0)return r}return e._private[t.field]}},Oi[t.on]=xT({event:t.on,field:t.field,ableField:t.ableField,overrideAble:t.overrideAble,value:!0}),Oi[t.off]=xT({event:t.off,field:t.field,ableField:t.ableField,overrideAble:t.overrideAble,value:!1})}Xs({field:"locked",overrideField:function(e){return e.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});Xs({field:"grabbable",overrideField:function(e){return e.cy().autoungrabify()||e.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});Xs({field:"selected",ableField:"selectable",overrideAble:function(e){return e.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});Xs({field:"selectable",overrideField:function(e){return e.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});Oi.deselect=Oi.unselect;Oi.grabbed=function(){var t=this[0];if(t)return t._private.grabbed};Xs({field:"active",on:"activate",off:"unactivate"});Xs({field:"pannable",on:"panify",off:"unpanify"});Oi.inactive=function(){var t=this[0];if(t)return!t._private.active};var pr={},ET=function(e){return function(n){for(var a=this,s=[],o=0;o<a.length;o++){var l=a[o];if(l.isNode()){for(var u=!1,c=l.connectedEdges(),f=0;f<c.length;f++){var h=c[f],d=h.source(),p=h.target();if(e.noIncomingEdges&&p===l&&d!==l||e.noOutgoingEdges&&d===l&&p!==l){u=!0;break}}u||s.push(l)}}return this.spawn(s,!0).filter(n)}},ST=function(e){return function(r){for(var n=this,a=[],s=0;s<n.length;s++){var o=n[s];if(o.isNode())for(var l=o.connectedEdges(),u=0;u<l.length;u++){var c=l[u],f=c.source(),h=c.target();e.outgoing&&f===o?(a.push(c),a.push(h)):e.incoming&&h===o&&(a.push(c),a.push(f))}}return this.spawn(a,!0).filter(r)}},CT=function(e){return function(r){for(var n=this,a=[],s={};;){var o=e.outgoing?n.outgoers():n.incomers();if(o.length===0)break;for(var l=!1,u=0;u<o.length;u++){var c=o[u],f=c.id();s[f]||(s[f]=!0,a.push(c),l=!0)}if(!l)break;n=o}return this.spawn(a,!0).filter(r)}};pr.clearTraversalCache=function(){for(var t=0;t<this.length;t++)this[t]._private.traversalCache=null};Ce(pr,{roots:ET({noIncomingEdges:!0}),leaves:ET({noOutgoingEdges:!0}),outgoers:en(ST({outgoing:!0}),"outgoers"),successors:CT({outgoing:!0}),incomers:en(ST({incoming:!0}),"incomers"),predecessors:CT({})});Ce(pr,{neighborhood:en(function(t){for(var e=[],r=this.nodes(),n=0;n<r.length;n++)for(var a=r[n],s=a.connectedEdges(),o=0;o<s.length;o++){var l=s[o],u=l.source(),c=l.target(),f=a===u?c:u;f.length>0&&e.push(f[0]),e.push(l[0])}return this.spawn(e,!0).filter(t)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}});pr.neighbourhood=pr.neighborhood;pr.closedNeighbourhood=pr.closedNeighborhood;pr.openNeighbourhood=pr.openNeighborhood;Ce(pr,{source:en(function(e){var r=this[0],n;return r&&(n=r._private.source||r.cy().collection()),n&&e?n.filter(e):n},"source"),target:en(function(e){var r=this[0],n;return r&&(n=r._private.target||r.cy().collection()),n&&e?n.filter(e):n},"target"),sources:TT({attr:"source"}),targets:TT({attr:"target"})});function TT(t){return function(r){for(var n=[],a=0;a<this.length;a++){var s=this[a],o=s._private[t.attr];o&&n.push(o)}return this.spawn(n,!0).filter(r)}}Ce(pr,{edgesWith:en(kT(),"edgesWith"),edgesTo:en(kT({thisIsSrc:!0}),"edgesTo")});function kT(t){return function(r){var n=[],a=this._private.cy,s=t||{};_e(r)&&(r=a.$(r));for(var o=0;o<r.length;o++)for(var l=r[o]._private.edges,u=0;u<l.length;u++){var c=l[u],f=c._private.data,h=this.hasElementWithId(f.source)&&r.hasElementWithId(f.target),d=r.hasElementWithId(f.source)&&this.hasElementWithId(f.target),p=h||d;p&&((s.thisIsSrc||s.thisIsTgt)&&(s.thisIsSrc&&!h||s.thisIsTgt&&!d)||n.push(c))}return this.spawn(n,!0)}}Ce(pr,{connectedEdges:en(function(t){for(var e=[],r=this,n=0;n<r.length;n++){var a=r[n];if(a.isNode())for(var s=a._private.edges,o=0;o<s.length;o++){var l=s[o];e.push(l)}}return this.spawn(e,!0).filter(t)},"connectedEdges"),connectedNodes:en(function(t){for(var e=[],r=this,n=0;n<r.length;n++){var a=r[n];a.isEdge()&&(e.push(a.source()[0]),e.push(a.target()[0]))}return this.spawn(e,!0).filter(t)},"connectedNodes"),parallelEdges:en(AT(),"parallelEdges"),codirectedEdges:en(AT({codirected:!0}),"codirectedEdges")});function AT(t){var e={codirected:!1};return t=Ce({},e,t),function(n){for(var a=[],s=this.edges(),o=t,l=0;l<s.length;l++)for(var u=s[l],c=u._private,f=c.source,h=f._private.data.id,d=c.data.target,p=f._private.edges,g=0;g<p.length;g++){var m=p[g],v=m._private.data,y=v.target,b=v.source,w=y===d&&b===h,_=h===y&&d===b;(o.codirected&&w||!o.codirected&&(w||_))&&a.push(m)}return this.spawn(a,!0).filter(n)}}Ce(pr,{components:function(e){var r=this,n=r.cy(),a=n.collection(),s=e==null?r.nodes():e.nodes(),o=[];e!=null&&s.empty()&&(s=e.sources());var l=function(f,h){a.merge(f),s.unmerge(f),h.merge(f)};if(s.empty())return r.spawn();var u=function(){var f=n.collection();o.push(f);var h=s[0];l(h,f),r.bfs({directed:!1,roots:h,visit:function(p){return l(p,f)}}),f.forEach(function(d){d.connectedEdges().forEach(function(p){r.has(p)&&f.has(p.source())&&f.has(p.target())&&f.merge(p)})})};do u();while(s.length>0);return o},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});pr.componentsOf=pr.components;var ir=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e===void 0){St("A collection must have a reference to the core");return}var s=new ti,o=!1;if(!r)r=[];else if(r.length>0&&Qe(r[0])&&!Kl(r[0])){o=!0;for(var l=[],u=new js,c=0,f=r.length;c<f;c++){var h=r[c];h.data==null&&(h.data={});var d=h.data;if(d.id==null)d.id=xk();else if(e.hasElementWithId(d.id)||u.has(d.id))continue;var p=new gh(e,h,!1);l.push(p),u.add(d.id)}r=l}this.length=0;for(var g=0,m=r.length;g<m;g++){var v=r[g][0];if(v!=null){var y=v._private.data.id;(!n||!s.has(y))&&(n&&s.set(y,{index:this.length,ele:v}),this[this.length]=v,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(b){this.lazyMap=b},rebuildMap:function(){for(var w=this.lazyMap=new ti,_=this.eles,x=0;x<_.length;x++){var S=_[x];w.set(S.id(),{index:x,ele:S})}}},n&&(this._private.map=s),o&&!a&&this.restore()},yt=gh.prototype=ir.prototype=Object.create(Array.prototype);yt.instanceString=function(){return"collection"};yt.spawn=function(t,e){return new ir(this.cy(),t,e)};yt.spawnSelf=function(){return this.spawn(this)};yt.cy=function(){return this._private.cy};yt.renderer=function(){return this._private.cy.renderer()};yt.element=function(){return this[0]};yt.collection=function(){return lk(this)?this:new ir(this._private.cy,[this])};yt.unique=function(){return new ir(this._private.cy,this,!0)};yt.hasElementWithId=function(t){return t=""+t,this._private.map.has(t)};yt.getElementById=function(t){t=""+t;var e=this._private.cy,r=this._private.map.get(t);return r?r.ele:new ir(e)};yt.$id=yt.getElementById;yt.poolIndex=function(){var t=this._private.cy,e=t._private.elements,r=this[0]._private.data.id;return e._private.map.get(r).index};yt.indexOf=function(t){var e=t[0]._private.data.id;return this._private.map.get(e).index};yt.indexOfId=function(t){return t=""+t,this._private.map.get(t).index};yt.json=function(t){var e=this.element(),r=this.cy();if(e==null&&t)return this;if(e!=null){var n=e._private;if(Qe(t)){if(r.startBatch(),t.data){e.data(t.data);var a=n.data;if(e.isEdge()){var s=!1,o={},l=t.data.source,u=t.data.target;l!=null&&l!=a.source&&(o.source=""+l,s=!0),u!=null&&u!=a.target&&(o.target=""+u,s=!0),s&&(e=e.move(o))}else{var c="parent"in t.data,f=t.data.parent;c&&(f!=null||a.parent!=null)&&f!=a.parent&&(f===void 0&&(f=null),f!=null&&(f=""+f),e=e.move({parent:f}))}}t.position&&e.position(t.position);var h=function(m,v,y){var b=t[m];b!=null&&b!==n[m]&&(b?e[v]():e[y]())};return h("removed","remove","restore"),h("selected","select","unselect"),h("selectable","selectify","unselectify"),h("locked","lock","unlock"),h("grabbable","grabify","ungrabify"),h("pannable","panify","unpanify"),t.classes!=null&&e.classes(t.classes),r.endBatch(),this}else if(t===void 0){var d={data:Bn(n.data),position:Bn(n.position),group:n.group,removed:n.removed,selected:n.selected,selectable:n.selectable,locked:n.locked,grabbable:n.grabbable,pannable:n.pannable,classes:null};d.classes="";var p=0;return n.classes.forEach(function(g){return d.classes+=p++===0?g:" "+g}),d}}};yt.jsons=function(){for(var t=[],e=0;e<this.length;e++){var r=this[e],n=r.json();t.push(n)}return t};yt.clone=function(){for(var t=this.cy(),e=[],r=0;r<this.length;r++){var n=this[r],a=n.json(),s=new gh(t,a,!1);e.push(s)}return new ir(t,e)};yt.copy=yt.clone;yt.restore=function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this,n=r.cy(),a=n._private,s=[],o=[],l,u=0,c=r.length;u<c;u++){var f=r[u];e&&!f.removed()||(f.isNode()?s.push(f):o.push(f))}l=s.concat(o);var h,d=function(){l.splice(h,1),h--};for(h=0;h<l.length;h++){var p=l[h],g=p._private,m=g.data;if(p.clearTraversalCache(),!(!e&&!g.removed)){if(m.id===void 0)m.id=xk();else if(le(m.id))m.id=""+m.id;else if(Ii(m.id)||!_e(m.id)){St("Can not create element with invalid string ID `"+m.id+"`"),d();continue}else if(n.hasElementWithId(m.id)){St("Can not create second element with ID `"+m.id+"`"),d();continue}}var v=m.id;if(p.isNode()){var y=g.position;y.x==null&&(y.x=0),y.y==null&&(y.y=0)}if(p.isEdge()){for(var b=p,w=["source","target"],_=w.length,x=!1,S=0;S<_;S++){var E=w[S],A=m[E];le(A)&&(A=m[E]=""+m[E]),A==null||A===""?(St("Can not create edge `"+v+"` with unspecified "+E),x=!0):n.hasElementWithId(A)||(St("Can not create edge `"+v+"` with nonexistant "+E+" `"+A+"`"),x=!0)}if(x){d();continue}var T=n.getElementById(m.source),D=n.getElementById(m.target);T.same(D)?T._private.edges.push(b):(T._private.edges.push(b),D._private.edges.push(b)),b._private.source=T,b._private.target=D}g.map=new ti,g.map.set(v,{ele:p,index:0}),g.removed=!1,e&&n.addToPool(p)}for(var k=0;k<s.length;k++){var M=s[k],P=M._private.data;le(P.parent)&&(P.parent=""+P.parent);var I=P.parent,B=I!=null;if(B||M._private.parent){var L=M._private.parent?n.collection().merge(M._private.parent):n.getElementById(I);if(L.empty())P.parent=void 0;else if(L[0].removed())st("Node added with missing parent, reference to parent removed"),P.parent=void 0,M._private.parent=null;else{for(var N=!1,F=L;!F.empty();){if(M.same(F)){N=!0,P.parent=void 0;break}F=F.parent()}N||(L[0]._private.children.push(M),M._private.parent=L[0],a.hasCompoundNodes=!0)}}}if(l.length>0){for(var q=l.length===r.length?r:new ir(n,l),H=0;H<q.length;H++){var V=q[H];V.isNode()||(V.parallelEdges().clearTraversalCache(),V.source().clearTraversalCache(),V.target().clearTraversalCache())}var z;a.hasCompoundNodes?z=n.collection().merge(q).merge(q.connectedNodes()).merge(q.parent()):z=q,z.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(t),t?q.emitAndNotify("add"):e&&q.emit("add")}return r};yt.removed=function(){var t=this[0];return t&&t._private.removed};yt.inside=function(){var t=this[0];return t&&!t._private.removed};yt.remove=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this,n=[],a={},s=r._private.cy;function o(I){for(var B=I._private.edges,L=0;L<B.length;L++)u(B[L])}function l(I){for(var B=I._private.children,L=0;L<B.length;L++)u(B[L])}function u(I){var B=a[I.id()];e&&I.removed()||B||(a[I.id()]=!0,I.isNode()?(n.push(I),o(I),l(I)):n.unshift(I))}for(var c=0,f=r.length;c<f;c++){var h=r[c];u(h)}function d(I,B){var L=I._private.edges;Bi(L,B),I.clearTraversalCache()}function p(I){I.clearTraversalCache()}var g=[];g.ids={};function m(I,B){B=B[0],I=I[0];var L=I._private.children,N=I.id();Bi(L,B),B._private.parent=null,g.ids[N]||(g.ids[N]=!0,g.push(I))}r.dirtyCompoundBoundsCache(),e&&s.removeFromPool(n);for(var v=0;v<n.length;v++){var y=n[v];if(y.isEdge()){var b=y.source()[0],w=y.target()[0];d(b,y),d(w,y);for(var _=y.parallelEdges(),x=0;x<_.length;x++){var S=_[x];p(S),S.isBundledBezier()&&S.dirtyBoundingBoxCache()}}else{var E=y.parent();E.length!==0&&m(E,y)}e&&(y._private.removed=!0)}var A=s._private.elements;s._private.hasCompoundNodes=!1;for(var T=0;T<A.length;T++){var D=A[T];if(D.isParent()){s._private.hasCompoundNodes=!0;break}}var k=new ir(this.cy(),n);k.size()>0&&(t?k.emitAndNotify("remove"):e&&k.emit("remove"));for(var M=0;M<g.length;M++){var P=g[M];(!e||!P.removed())&&P.updateStyle()}return k};yt.move=function(t){var e=this._private.cy,r=this,n=!1,a=!1,s=function(g){return g==null?g:""+g};if(t.source!==void 0||t.target!==void 0){var o=s(t.source),l=s(t.target),u=o!=null&&e.hasElementWithId(o),c=l!=null&&e.hasElementWithId(l);(u||c)&&(e.batch(function(){r.remove(n,a),r.emitAndNotify("moveout");for(var p=0;p<r.length;p++){var g=r[p],m=g._private.data;g.isEdge()&&(u&&(m.source=o),c&&(m.target=l))}r.restore(n,a)}),r.emitAndNotify("move"))}else if(t.parent!==void 0){var f=s(t.parent),h=f===null||e.hasElementWithId(f);if(h){var d=f===null?void 0:f;e.batch(function(){var p=r.remove(n,a);p.emitAndNotify("moveout");for(var g=0;g<r.length;g++){var m=r[g],v=m._private.data;m.isNode()&&(v.parent=d)}p.restore(n,a)}),r.emitAndNotify("move")}}return this};[Ok,EG,Gf,Di,Ks,qG,xh,t6,nA,iA,s6,sh,Kf,nr,Oi,pr].forEach(function(t){Ce(yt,t)});var d6={add:function(e){var r,n=this;if(Hr(e)){var a=e;if(a._private.cy===n)r=a.restore();else{for(var s=[],o=0;o<a.length;o++){var l=a[o];s.push(l.json())}r=new ir(n,s)}}else if(dt(e)){var u=e;r=new ir(n,u)}else if(Qe(e)&&(dt(e.nodes)||dt(e.edges))){for(var c=e,f=[],h=["nodes","edges"],d=0,p=h.length;d<p;d++){var g=h[d],m=c[g];if(dt(m))for(var v=0,y=m.length;v<y;v++){var b=Ce({group:g},m[v]);f.push(b)}}r=new ir(n,f)}else{var w=e;r=new gh(n,w).collection()}return r},remove:function(e){if(!Hr(e)){if(_e(e)){var r=e;e=this.$(r)}}return e.remove()}};function p6(t,e,r,n){var a=4,s=.001,o=1e-7,l=10,u=11,c=1/(u-1),f=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var h=0;h<4;++h)if(typeof arguments[h]!="number"||isNaN(arguments[h])||!isFinite(arguments[h]))return!1;t=Math.min(t,1),r=Math.min(r,1),t=Math.max(t,0),r=Math.max(r,0);var d=f?new Float32Array(u):new Array(u);function p(D,k){return 1-3*k+3*D}function g(D,k){return 3*k-6*D}function m(D){return 3*D}function v(D,k,M){return((p(k,M)*D+g(k,M))*D+m(k))*D}function y(D,k,M){return 3*p(k,M)*D*D+2*g(k,M)*D+m(k)}function b(D,k){for(var M=0;M<a;++M){var P=y(k,t,r);if(P===0)return k;var I=v(k,t,r)-D;k-=I/P}return k}function w(){for(var D=0;D<u;++D)d[D]=v(D*c,t,r)}function _(D,k,M){var P,I,B=0;do I=k+(M-k)/2,P=v(I,t,r)-D,P>0?M=I:k=I;while(Math.abs(P)>o&&++B<l);return I}function x(D){for(var k=0,M=1,P=u-1;M!==P&&d[M]<=D;++M)k+=c;--M;var I=(D-d[M])/(d[M+1]-d[M]),B=k+I*c,L=y(B,t,r);return L>=s?b(D,B):L===0?B:_(D,k,k+c)}var S=!1;function E(){S=!0,(t!==e||r!==n)&&w()}var A=function(k){return S||E(),t===e&&r===n?k:k===0?0:k===1?1:v(x(k),e,n)};A.getControlPoints=function(){return[{x:t,y:e},{x:r,y:n}]};var T="generateBezier("+[t,e,r,n]+")";return A.toString=function(){return T},A}var g6=function(){function t(n){return-n.tension*n.x-n.friction*n.v}function e(n,a,s){var o={x:n.x+s.dx*a,v:n.v+s.dv*a,tension:n.tension,friction:n.friction};return{dx:o.v,dv:t(o)}}function r(n,a){var s={dx:n.v,dv:t(n)},o=e(n,a*.5,s),l=e(n,a*.5,o),u=e(n,a,l),c=1/6*(s.dx+2*(o.dx+l.dx)+u.dx),f=1/6*(s.dv+2*(o.dv+l.dv)+u.dv);return n.x=n.x+c*a,n.v=n.v+f*a,n}return function n(a,s,o){var l={x:-1,v:0,tension:null,friction:null},u=[0],c=0,f=1/1e4,h=16/1e3,d,p,g;for(a=parseFloat(a)||500,s=parseFloat(s)||20,o=o||null,l.tension=a,l.friction=s,d=o!==null,d?(c=n(a,s),p=c/o*h):p=h;g=r(g||l,p),u.push(1+g.x),c+=16,Math.abs(g.x)>f&&Math.abs(g.v)>f;);return d?function(m){return u[m*(u.length-1)|0]}:c}}(),mt=function(e,r,n,a){var s=p6(e,r,n,a);return function(o,l,u){return o+(l-o)*s(u)}},jf={linear:function(e,r,n){return e+(r-e)*n},ease:mt(.25,.1,.25,1),"ease-in":mt(.42,0,1,1),"ease-out":mt(0,0,.58,1),"ease-in-out":mt(.42,0,.58,1),"ease-in-sine":mt(.47,0,.745,.715),"ease-out-sine":mt(.39,.575,.565,1),"ease-in-out-sine":mt(.445,.05,.55,.95),"ease-in-quad":mt(.55,.085,.68,.53),"ease-out-quad":mt(.25,.46,.45,.94),"ease-in-out-quad":mt(.455,.03,.515,.955),"ease-in-cubic":mt(.55,.055,.675,.19),"ease-out-cubic":mt(.215,.61,.355,1),"ease-in-out-cubic":mt(.645,.045,.355,1),"ease-in-quart":mt(.895,.03,.685,.22),"ease-out-quart":mt(.165,.84,.44,1),"ease-in-out-quart":mt(.77,0,.175,1),"ease-in-quint":mt(.755,.05,.855,.06),"ease-out-quint":mt(.23,1,.32,1),"ease-in-out-quint":mt(.86,0,.07,1),"ease-in-expo":mt(.95,.05,.795,.035),"ease-out-expo":mt(.19,1,.22,1),"ease-in-out-expo":mt(1,0,0,1),"ease-in-circ":mt(.6,.04,.98,.335),"ease-out-circ":mt(.075,.82,.165,1),"ease-in-out-circ":mt(.785,.135,.15,.86),spring:function(e,r,n){if(n===0)return jf.linear;var a=g6(e,r,n);return function(s,o,l){return s+(o-s)*a(l)}},"cubic-bezier":mt};function MT(t,e,r,n,a){if(n===1||e===r)return r;var s=a(e,r,n);return t==null||((t.roundValue||t.color)&&(s=Math.round(s)),t.min!==void 0&&(s=Math.max(s,t.min)),t.max!==void 0&&(s=Math.min(s,t.max))),s}function PT(t,e){return t.pfValue!=null||t.value!=null?t.pfValue!=null&&(e==null||e.type.units!=="%")?t.pfValue:t.value:t}function Ps(t,e,r,n,a){var s=a!=null?a.type:null;r<0?r=0:r>1&&(r=1);var o=PT(t,a),l=PT(e,a);if(le(o)&&le(l))return MT(s,o,l,r,n);if(dt(o)&&dt(l)){for(var u=[],c=0;c<l.length;c++){var f=o[c],h=l[c];if(f!=null&&h!=null){var d=MT(s,f,h,r,n);u.push(d)}else u.push(h)}return u}}function v6(t,e,r,n){var a=!n,s=t._private,o=e._private,l=o.easing,u=o.startTime,c=n?t:t.cy(),f=c.style();if(!o.easingImpl)if(l==null)o.easingImpl=jf.linear;else{var h;if(_e(l)){var d=f.parse("transition-timing-function",l);h=d.value}else h=l;var p,g;_e(h)?(p=h,g=[]):(p=h[1],g=h.slice(2).map(function(q){return+q})),g.length>0?(p==="spring"&&g.push(o.duration),o.easingImpl=jf[p].apply(null,g)):o.easingImpl=jf[p]}var m=o.easingImpl,v;if(o.duration===0?v=1:v=(r-u)/o.duration,o.applying&&(v=o.progress),v<0?v=0:v>1&&(v=1),o.delay==null){var y=o.startPosition,b=o.position;if(b&&a&&!t.locked()){var w={};Cl(y.x,b.x)&&(w.x=Ps(y.x,b.x,v,m)),Cl(y.y,b.y)&&(w.y=Ps(y.y,b.y,v,m)),t.position(w)}var _=o.startPan,x=o.pan,S=s.pan,E=x!=null&&n;E&&(Cl(_.x,x.x)&&(S.x=Ps(_.x,x.x,v,m)),Cl(_.y,x.y)&&(S.y=Ps(_.y,x.y,v,m)),t.emit("pan"));var A=o.startZoom,T=o.zoom,D=T!=null&&n;D&&(Cl(A,T)&&(s.zoom=Fl(s.minZoom,Ps(A,T,v,m),s.maxZoom)),t.emit("zoom")),(E||D)&&t.emit("viewport");var k=o.style;if(k&&k.length>0&&a){for(var M=0;M<k.length;M++){var P=k[M],I=P.name,B=P,L=o.startStyle[I],N=f.properties[L.name],F=Ps(L,B,v,m,N);f.overrideBypass(t,I,F)}t.emit("style")}}return o.progress=v,v}function Cl(t,e){return t==null||e==null?!1:le(t)&&le(e)?!0:!!(t&&e)}function m6(t,e,r,n){var a=e._private;a.started=!0,a.startTime=r-a.progress*a.duration}function RT(t,e){var r=e._private.aniEles,n=[];function a(f,h){var d=f._private,p=d.animation.current,g=d.animation.queue,m=!1;if(p.length===0){var v=g.shift();v&&p.push(v)}for(var y=function(S){for(var E=S.length-1;E>=0;E--){var A=S[E];A()}S.splice(0,S.length)},b=p.length-1;b>=0;b--){var w=p[b],_=w._private;if(_.stopped){p.splice(b,1),_.hooked=!1,_.playing=!1,_.started=!1,y(_.frames);continue}!_.playing&&!_.applying||(_.playing&&_.applying&&(_.applying=!1),_.started||m6(f,w,t),v6(f,w,t,h),_.applying&&(_.applying=!1),y(_.frames),_.step!=null&&_.step(t),w.completed()&&(p.splice(b,1),_.hooked=!1,_.playing=!1,_.started=!1,y(_.completes)),m=!0)}return!h&&p.length===0&&g.length===0&&n.push(f),m}for(var s=!1,o=0;o<r.length;o++){var l=r[o],u=a(l);s=s||u}var c=a(e,!0);(s||c)&&(r.length>0?e.notify("draw",r):e.notify("draw")),r.unmerge(n),e.emit("step")}var y6={animate:at.animate(),animation:at.animation(),animated:at.animated(),clearQueue:at.clearQueue(),delay:at.delay(),delayAnimation:at.delayAnimation(),stop:at.stop(),addToAnimationPool:function(e){var r=this;r.styleEnabled()&&r._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,!e.styleEnabled())return;function r(){e._private.animationsRunning&&th(function(s){RT(s,e),r()})}var n=e.renderer();n&&n.beforeRender?n.beforeRender(function(s,o){RT(o,e)},n.beforeRenderPriorities.animations):r()}},b6={qualifierCompare:function(e,r){return e==null||r==null?e==null&&r==null:e.sameText(r)},eventMatches:function(e,r,n){var a=r.qualifier;return a!=null?e!==n.target&&Kl(n.target)&&a.matches(n.target):!0},addEventFields:function(e,r){r.cy=e,r.target=e},callbackContext:function(e,r,n){return r.qualifier!=null?n.target:e}},Ff=function(e){return _e(e)?new Ni(e):e},oA={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new Eh(b6,this)),this},emitter:function(){return this._private.emitter},on:function(e,r,n){return this.emitter().on(e,Ff(r),n),this},removeListener:function(e,r,n){return this.emitter().removeListener(e,Ff(r),n),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,r,n){return this.emitter().one(e,Ff(r),n),this},once:function(e,r,n){return this.emitter().one(e,Ff(r),n),this},emit:function(e,r){return this.emitter().emit(e,r),this},emitAndNotify:function(e,r){return this.emit(e),this.notify(e,r),this}};at.eventAliasesOn(oA);var Sy={png:function(e){var r=this._private.renderer;return e=e||{},r.png(e)},jpg:function(e){var r=this._private.renderer;return e=e||{},e.bg=e.bg||"#fff",r.jpg(e)}};Sy.jpeg=Sy.jpg;var Yf={layout:function(e){var r=this;if(e==null){St("Layout options must be specified to make a layout");return}if(e.name==null){St("A `name` must be specified to make a layout");return}var n=e.name,a=r.extension("layout",n);if(a==null){St("No such layout `"+n+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var s;_e(e.eles)?s=r.$(e.eles):s=e.eles!=null?e.eles:r.$();var o=new a(Ce({},e,{cy:r,eles:s}));return o}};Yf.createLayout=Yf.makeLayout=Yf.layout;var w6={notify:function(e,r){var n=this._private;if(this.batching()){n.batchNotifications=n.batchNotifications||{};var a=n.batchNotifications[e]=n.batchNotifications[e]||this.collection();r!=null&&a.merge(r);return}if(n.notificationsEnabled){var s=this.renderer();this.destroyed()||!s||s.notify(e,r)}},notifications:function(e){var r=this._private;return e===void 0?r.notificationsEnabled:(r.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var r=this.renderer();Object.keys(e.batchNotifications).forEach(function(n){var a=e.batchNotifications[n];a.empty()?r.notify(n):r.notify(n,a)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var r=this;return this.batch(function(){for(var n=Object.keys(e),a=0;a<n.length;a++){var s=n[a],o=e[s],l=r.getElementById(s);l.data(o)}})}},_6=ar({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),Cy={renderTo:function(e,r,n,a){var s=this._private.renderer;return s.renderTo(e,r,n,a),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var r=this,n=r.extension("renderer",e.name);if(n==null){St("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}e.wheelSensitivity!==void 0&&st("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var a=_6(e);a.cy=r,r._private.renderer=new n(a),this.notify("init")},destroyRenderer:function(){var e=this;e.notify("destroy");var r=e.container();if(r)for(r._cyreg=null;r.childNodes.length>0;)r.removeChild(r.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(n){var a=n._private;a.rscratch={},a.rstyle={},a.animation.current=[],a.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};Cy.invalidateDimensions=Cy.resize;var Zf={collection:function(e,r){return _e(e)?this.$(e):Hr(e)?e.collection():dt(e)?(r||(r={}),new ir(this,e,r.unique,r.removed)):new ir(this)},nodes:function(e){var r=this.$(function(n){return n.isNode()});return e?r.filter(e):r},edges:function(e){var r=this.$(function(n){return n.isEdge()});return e?r.filter(e):r},$:function(e){var r=this._private.elements;return e?r.filter(e):r.spawnSelf()},mutableElements:function(){return this._private.elements}};Zf.elements=Zf.filter=Zf.$;var Xt={},Dl="t",x6="f";Xt.apply=function(t){for(var e=this,r=e._private,n=r.cy,a=n.collection(),s=0;s<t.length;s++){var o=t[s],l=e.getContextMeta(o);if(!l.empty){var u=e.getContextStyle(l),c=e.applyContextStyle(l,u,o);o._private.appliedInitStyle?e.updateTransitions(o,c.diffProps):o._private.appliedInitStyle=!0;var f=e.updateStyleHints(o);f&&a.push(o)}}return a};Xt.getPropertiesDiff=function(t,e){var r=this,n=r._private.propDiffs=r._private.propDiffs||{},a=t+"-"+e,s=n[a];if(s)return s;for(var o=[],l={},u=0;u<r.length;u++){var c=r[u],f=t[u]===Dl,h=e[u]===Dl,d=f!==h,p=c.mappedProperties.length>0;if(d||h&&p){var g=void 0;d&&p||d?g=c.properties:p&&(g=c.mappedProperties);for(var m=0;m<g.length;m++){for(var v=g[m],y=v.name,b=!1,w=u+1;w<r.length;w++){var _=r[w],x=e[w]===Dl;if(x&&(b=_.properties[v.name]!=null,b))break}!l[y]&&!b&&(l[y]=!0,o.push(y))}}}return n[a]=o,o};Xt.getContextMeta=function(t){for(var e=this,r="",n,a=t._private.styleCxtKey||"",s=0;s<e.length;s++){var o=e[s],l=o.selector&&o.selector.matches(t);l?r+=Dl:r+=x6}return n=e.getPropertiesDiff(a,r),t._private.styleCxtKey=r,{key:r,diffPropNames:n,empty:n.length===0}};Xt.getContextStyle=function(t){var e=t.key,r=this,n=this._private.contextStyles=this._private.contextStyles||{};if(n[e])return n[e];for(var a={_private:{key:e}},s=0;s<r.length;s++){var o=r[s],l=e[s]===Dl;if(l)for(var u=0;u<o.properties.length;u++){var c=o.properties[u];a[c.name]=c}}return n[e]=a,a};Xt.applyContextStyle=function(t,e,r){for(var n=this,a=t.diffPropNames,s={},o=n.types,l=0;l<a.length;l++){var u=a[l],c=e[u],f=r.pstyle(u);if(!c)if(f)f.bypass?c={name:u,deleteBypassed:!0}:c={name:u,delete:!0};else continue;if(f!==c){if(c.mapped===o.fn&&f!=null&&f.mapping!=null&&f.mapping.value===c.value){var h=f.mapping,d=h.fnValue=c.value(r);if(d===h.prevFnValue)continue}var p=s[u]={prev:f};n.applyParsedProperty(r,c),p.next=r.pstyle(u),p.next&&p.next.bypass&&(p.next=p.next.bypassed)}}return{diffProps:s}};Xt.updateStyleHints=function(t){var e=t._private,r=this,n=r.propertyGroupNames,a=r.propertyGroupKeys,s=function(j,se,fe){return r.getPropertiesHash(j,se,fe)},o=e.styleKey;if(t.removed())return!1;var l=e.group==="nodes",u=t._private.style;n=Object.keys(u);for(var c=0;c<a.length;c++){var f=a[c];e.styleKeys[f]=[Ra,Bs]}for(var h=function(j,se){return e.styleKeys[se][0]=Bl(j,e.styleKeys[se][0])},d=function(j,se){return e.styleKeys[se][1]=Ll(j,e.styleKeys[se][1])},p=function(j,se){h(j,se),d(j,se)},g=function(j,se){for(var fe=0;fe<j.length;fe++){var Pe=j.charCodeAt(fe);h(Pe,se),d(Pe,se)}},m=2e9,v=function(j){return-128<j&&j<128&&Math.floor(j)!==j?m-(j*1024|0):j},y=0;y<n.length;y++){var b=n[y],w=u[b];if(w!=null){var _=this.properties[b],x=_.type,S=_.groupKey,E=void 0;_.hashOverride!=null?E=_.hashOverride(t,w):w.pfValue!=null&&(E=w.pfValue);var A=_.enums==null?w.value:null,T=E!=null,D=A!=null,k=T||D,M=w.units;if(x.number&&k&&!x.multiple){var P=T?E:A;p(v(P),S),!T&&M!=null&&g(M,S)}else g(w.strValue,S)}}for(var I=[Ra,Bs],B=0;B<a.length;B++){var L=a[B],N=e.styleKeys[L];I[0]=Bl(N[0],I[0]),I[1]=Ll(N[1],I[1])}e.styleKey=zU(I[0],I[1]);var F=e.styleKeys;e.labelDimsKey=Mi(F.labelDimensions);var q=s(t,["label"],F.labelDimensions);if(e.labelKey=Mi(q),e.labelStyleKey=Mi(Pf(F.commonLabel,q)),!l){var H=s(t,["source-label"],F.labelDimensions);e.sourceLabelKey=Mi(H),e.sourceLabelStyleKey=Mi(Pf(F.commonLabel,H));var V=s(t,["target-label"],F.labelDimensions);e.targetLabelKey=Mi(V),e.targetLabelStyleKey=Mi(Pf(F.commonLabel,V))}if(l){var z=e.styleKeys,Y=z.nodeBody,Q=z.nodeBorder,J=z.nodeOutline,ee=z.backgroundImage,ae=z.compound,ue=z.pie,re=z.stripe,U=[Y,Q,J,ee,ae,ue,re].filter(function(G){return G!=null}).reduce(Pf,[Ra,Bs]);e.nodeKey=Mi(U),e.hasPie=ue!=null&&ue[0]!==Ra&&ue[1]!==Bs,e.hasStripe=re!=null&&re[0]!==Ra&&re[1]!==Bs}return o!==e.styleKey};Xt.clearStyleHints=function(t){var e=t._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null,e.hasStripe=null};Xt.applyParsedProperty=function(t,e){var r=this,n=e,a=t._private.style,s,o=r.types,l=r.properties[n.name].type,u=n.bypass,c=a[n.name],f=c&&c.bypass,h=t._private,d="mapping",p=function(Y){return Y==null?null:Y.pfValue!=null?Y.pfValue:Y.value},g=function(){var Y=p(c),Q=p(n);r.checkTriggers(t,n.name,Y,Q)};if(e.name==="curve-style"&&t.isEdge()&&(e.value!=="bezier"&&t.isLoop()||e.value==="haystack"&&(t.source().isParent()||t.target().isParent()))&&(n=e=this.parse(e.name,"bezier",u)),n.delete)return a[n.name]=void 0,g(),!0;if(n.deleteBypassed)return c?c.bypass?(c.bypassed=void 0,g(),!0):!1:(g(),!0);if(n.deleteBypass)return c?c.bypass?(a[n.name]=c.bypassed,g(),!0):!1:(g(),!0);var m=function(){st("Do not assign mappings to elements without corresponding data (i.e. ele `"+t.id()+"` has no mapping for property `"+n.name+"` with data field `"+n.field+"`); try a `["+n.field+"]` selector to limit scope to elements with `"+n.field+"` defined")};switch(n.mapped){case o.mapData:{for(var v=n.field.split("."),y=h.data,b=0;b<v.length&&y;b++){var w=v[b];y=y[w]}if(y==null)return m(),!1;var _;if(le(y)){var x=n.fieldMax-n.fieldMin;x===0?_=0:_=(y-n.fieldMin)/x}else return st("Do not use continuous mappers without specifying numeric data (i.e. `"+n.field+": "+y+"` for `"+t.id()+"` is non-numeric)"),!1;if(_<0?_=0:_>1&&(_=1),l.color){var S=n.valueMin[0],E=n.valueMax[0],A=n.valueMin[1],T=n.valueMax[1],D=n.valueMin[2],k=n.valueMax[2],M=n.valueMin[3]==null?1:n.valueMin[3],P=n.valueMax[3]==null?1:n.valueMax[3],I=[Math.round(S+(E-S)*_),Math.round(A+(T-A)*_),Math.round(D+(k-D)*_),Math.round(M+(P-M)*_)];s={bypass:n.bypass,name:n.name,value:I,strValue:"rgb("+I[0]+", "+I[1]+", "+I[2]+")"}}else if(l.number){var B=n.valueMin+(n.valueMax-n.valueMin)*_;s=this.parse(n.name,B,n.bypass,d)}else return!1;if(!s)return m(),!1;s.mapping=n,n=s;break}case o.data:{for(var L=n.field.split("."),N=h.data,F=0;F<L.length&&N;F++){var q=L[F];N=N[q]}if(N!=null&&(s=this.parse(n.name,N,n.bypass,d)),!s)return m(),!1;s.mapping=n,n=s;break}case o.fn:{var H=n.value,V=n.fnValue!=null?n.fnValue:H(t);if(n.prevFnValue=V,V==null)return st("Custom function mappers may not return null (i.e. `"+n.name+"` for ele `"+t.id()+"` is null)"),!1;if(s=this.parse(n.name,V,n.bypass,d),!s)return st("Custom function mappers may not return invalid values for the property type (i.e. `"+n.name+"` for ele `"+t.id()+"` is invalid)"),!1;s.mapping=Bn(n),n=s;break}case void 0:break;default:return!1}return u?(f?n.bypassed=c.bypassed:n.bypassed=c,a[n.name]=n):f?c.bypassed=n:a[n.name]=n,g(),!0};Xt.cleanElements=function(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(this.clearStyleHints(n),n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),!e)n._private.style={};else for(var a=n._private.style,s=Object.keys(a),o=0;o<s.length;o++){var l=s[o],u=a[l];u!=null&&(u.bypass?u.bypassed=null:a[l]=null)}}};Xt.update=function(){var t=this._private.cy,e=t.mutableElements();e.updateStyle()};Xt.updateTransitions=function(t,e){var r=this,n=t._private,a=t.pstyle("transition-property").value,s=t.pstyle("transition-duration").pfValue,o=t.pstyle("transition-delay").pfValue;if(a.length>0&&s>0){for(var l={},u=!1,c=0;c<a.length;c++){var f=a[c],h=t.pstyle(f),d=e[f];if(d){var p=d.prev,g=p,m=d.next!=null?d.next:h,v=!1,y=void 0,b=1e-6;g&&(le(g.pfValue)&&le(m.pfValue)?(v=m.pfValue-g.pfValue,y=g.pfValue+b*v):le(g.value)&&le(m.value)?(v=m.value-g.value,y=g.value+b*v):dt(g.value)&&dt(m.value)&&(v=g.value[0]!==m.value[0]||g.value[1]!==m.value[1]||g.value[2]!==m.value[2],y=g.strValue),v&&(l[f]=m.strValue,this.applyBypass(t,f,y),u=!0))}}if(!u)return;n.transitioning=!0,new Ys(function(w){o>0?t.delayAnimation(o).play().promise().then(w):w()}).then(function(){return t.animation({style:l,duration:s,easing:t.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){r.removeBypasses(t,a),t.emitAndNotify("style"),n.transitioning=!1})}else n.transitioning&&(this.removeBypasses(t,a),t.emitAndNotify("style"),n.transitioning=!1)};Xt.checkTrigger=function(t,e,r,n,a,s){var o=this.properties[e],l=a(o);t.removed()||l!=null&&l(r,n,t)&&s(o)};Xt.checkZOrderTrigger=function(t,e,r,n){var a=this;this.checkTrigger(t,e,r,n,function(s){return s.triggersZOrder},function(){a._private.cy.notify("zorder",t)})};Xt.checkBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(a){return a.triggersBounds},function(a){t.dirtyCompoundBoundsCache(),t.dirtyBoundingBoxCache()})};Xt.checkConnectedEdgesBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(a){return a.triggersBoundsOfConnectedEdges},function(a){t.connectedEdges().forEach(function(s){s.dirtyBoundingBoxCache()})})};Xt.checkParallelEdgesBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(a){return a.triggersBoundsOfParallelEdges},function(a){t.parallelEdges().forEach(function(s){s.dirtyBoundingBoxCache()})})};Xt.checkTriggers=function(t,e,r,n){t.dirtyStyleCache(),this.checkZOrderTrigger(t,e,r,n),this.checkBoundsTrigger(t,e,r,n),this.checkConnectedEdgesBoundsTrigger(t,e,r,n),this.checkParallelEdgesBoundsTrigger(t,e,r,n)};var Jl={};Jl.applyBypass=function(t,e,r,n){var a=this,s=[],o=!0;if(e==="*"||e==="**"){if(r!==void 0)for(var l=0;l<a.properties.length;l++){var u=a.properties[l],c=u.name,f=this.parse(c,r,!0);f&&s.push(f)}}else if(_e(e)){var h=this.parse(e,r,!0);h&&s.push(h)}else if(Qe(e)){var d=e;n=r;for(var p=Object.keys(d),g=0;g<p.length;g++){var m=p[g],v=d[m];if(v===void 0&&(v=d[dh(m)]),v!==void 0){var y=this.parse(m,v,!0);y&&s.push(y)}}}else return!1;if(s.length===0)return!1;for(var b=!1,w=0;w<t.length;w++){for(var _=t[w],x={},S=void 0,E=0;E<s.length;E++){var A=s[E];if(n){var T=_.pstyle(A.name);S=x[A.name]={prev:T}}b=this.applyParsedProperty(_,Bn(A))||b,n&&(S.next=_.pstyle(A.name))}b&&this.updateStyleHints(_),n&&this.updateTransitions(_,x,o)}return b};Jl.overrideBypass=function(t,e,r){e=Ny(e);for(var n=0;n<t.length;n++){var a=t[n],s=a._private.style[e],o=this.properties[e].type,l=o.color,u=o.mutiple,c=s?s.pfValue!=null?s.pfValue:s.value:null;!s||!s.bypass?this.applyBypass(a,e,r):(s.value=r,s.pfValue!=null&&(s.pfValue=r),l?s.strValue="rgb("+r.join(",")+")":u?s.strValue=r.join(" "):s.strValue=""+r,this.updateStyleHints(a)),this.checkTriggers(a,e,c,r)}};Jl.removeAllBypasses=function(t,e){return this.removeBypasses(t,this.propertyNames,e)};Jl.removeBypasses=function(t,e,r){for(var n=!0,a=0;a<t.length;a++){for(var s=t[a],o={},l=0;l<e.length;l++){var u=e[l],c=this.properties[u],f=s.pstyle(c.name);if(!(!f||!f.bypass)){var h="",d=this.parse(u,h,!0),p=o[c.name]={prev:f};this.applyParsedProperty(s,d),p.next=s.pstyle(c.name)}}this.updateStyleHints(s),r&&this.updateTransitions(s,o,n)}};var Qy={};Qy.getEmSizeInPixels=function(){var t=this.containerCss("font-size");return t!=null?parseFloat(t):1};Qy.containerCss=function(t){var e=this._private.cy,r=e.container(),n=e.window();if(n&&r&&n.getComputedStyle)return n.getComputedStyle(r).getPropertyValue(t)};var Ln={};Ln.getRenderedStyle=function(t,e){return e?this.getStylePropertyValue(t,e,!0):this.getRawStyle(t,!0)};Ln.getRawStyle=function(t,e){var r=this;if(t=t[0],t){for(var n={},a=0;a<r.properties.length;a++){var s=r.properties[a],o=r.getStylePropertyValue(t,s.name,e);o!=null&&(n[s.name]=o,n[dh(s.name)]=o)}return n}};Ln.getIndexedStyle=function(t,e,r,n){var a=t.pstyle(e)[r][n];return a??t.cy().style().getDefaultProperty(e)[r][0]};Ln.getStylePropertyValue=function(t,e,r){var n=this;if(t=t[0],t){var a=n.properties[e];a.alias&&(a=a.pointsTo);var s=a.type,o=t.pstyle(a.name);if(o){var l=o.value,u=o.units,c=o.strValue;if(r&&s.number&&l!=null&&le(l)){var f=t.cy().zoom(),h=function(v){return v*f},d=function(v,y){return h(v)+y},p=dt(l),g=p?u.every(function(m){return m!=null}):u!=null;return g?p?l.map(function(m,v){return d(m,u[v])}).join(" "):d(l,u):p?l.map(function(m){return _e(m)?m:""+h(m)}).join(" "):""+h(l)}else if(c!=null)return c}return null}};Ln.getAnimationStartStyle=function(t,e){for(var r={},n=0;n<e.length;n++){var a=e[n],s=a.name,o=t.pstyle(s);o!==void 0&&(Qe(o)?o=this.parse(s,o.strValue):o=this.parse(s,o)),o&&(r[s]=o)}return r};Ln.getPropsList=function(t){var e=this,r=[],n=t,a=e.properties;if(n)for(var s=Object.keys(n),o=0;o<s.length;o++){var l=s[o],u=n[l],c=a[l]||a[Ny(l)],f=this.parse(c.name,u);f&&r.push(f)}return r};Ln.getNonDefaultPropertiesHash=function(t,e,r){var n=r.slice(),a,s,o,l,u,c;for(u=0;u<e.length;u++)if(a=e[u],s=t.pstyle(a,!1),s!=null)if(s.pfValue!=null)n[0]=Bl(l,n[0]),n[1]=Ll(l,n[1]);else for(o=s.strValue,c=0;c<o.length;c++)l=o.charCodeAt(c),n[0]=Bl(l,n[0]),n[1]=Ll(l,n[1]);return n};Ln.getPropertiesHash=Ln.getNonDefaultPropertiesHash;var Th={};Th.appendFromJson=function(t){for(var e=this,r=0;r<t.length;r++){var n=t[r],a=n.selector,s=n.style||n.css,o=Object.keys(s);e.selector(a);for(var l=0;l<o.length;l++){var u=o[l],c=s[u];e.css(u,c)}}return e};Th.fromJson=function(t){var e=this;return e.resetToDefault(),e.appendFromJson(t),e};Th.json=function(){for(var t=[],e=this.defaultLength;e<this.length;e++){for(var r=this[e],n=r.selector,a=r.properties,s={},o=0;o<a.length;o++){var l=a[o];s[l.name]=l.strValue}t.push({selector:n?n.toString():"core",style:s})}return t};var Jy={};Jy.appendFromString=function(t){var e=this,r=this,n=""+t,a,s,o;n=n.replace(/[/][*](\s|.)+?[*][/]/g,"");function l(){n.length>a.length?n=n.substr(a.length):n=""}function u(){s.length>o.length?s=s.substr(o.length):s=""}for(;;){var c=n.match(/^\s*$/);if(c)break;var f=n.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!f){st("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+n);break}a=f[0];var h=f[1];if(h!=="core"){var d=new Ni(h);if(d.invalid){st("Skipping parsing of block: Invalid selector found in string stylesheet: "+h),l();continue}}var p=f[2],g=!1;s=p;for(var m=[];;){var v=s.match(/^\s*$/);if(v)break;var y=s.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!y){st("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+p),g=!0;break}o=y[0];var b=y[1],w=y[2],_=e.properties[b];if(!_){st("Skipping property: Invalid property name in: "+o),u();continue}var x=r.parse(b,w);if(!x){st("Skipping property: Invalid property definition in: "+o),u();continue}m.push({name:b,val:w}),u()}if(g){l();break}r.selector(h);for(var S=0;S<m.length;S++){var E=m[S];r.css(E.name,E.val)}l()}return r};Jy.fromString=function(t){var e=this;return e.resetToDefault(),e.appendFromString(t),e};var Nt={};(function(){var t=Ht,e=bU,r=_U,n=xU,a=EU,s=function(G){return"^"+G+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},o=function(G){var j=t+"|\\w+|"+e+"|"+r+"|"+n+"|"+a;return"^"+G+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+t+")\\s*\\,\\s*("+t+")\\s*,\\s*("+j+")\\s*\\,\\s*("+j+")\\)$"},l=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];Nt.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},axisDirectionExplicit:{enums:["leftward","rightward","upward","downward"]},axisDirectionPrimary:{enums:["horizontal","vertical"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:s("data")},layoutData:{mapping:!0,regex:s("layoutData")},scratch:{mapping:!0,regex:s("scratch")},mapData:{mapping:!0,regex:o("mapData")},mapLayoutData:{mapping:!0,regex:o("mapLayoutData")},mapScratch:{mapping:!0,regex:o("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:l,singleRegexMatchValue:!0},urls:{regexes:l,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(G,j){switch(G.length){case 2:return j[0]!=="deg"&&j[0]!=="rad"&&j[1]!=="deg"&&j[1]!=="rad";case 1:return _e(G[0])||j[0]==="deg"||j[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+t+")\\s*,\\s*("+t+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+t+")\\s*,\\s*("+t+")\\s*,\\s*("+t+")\\s*,\\s*("+t+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(G){var j=G.length;return j===1||j===2||j===4}}};var u={zeroNonZero:function(G,j){return(G==null||j==null)&&G!==j||G==0&&j!=0?!0:G!=0&&j==0},any:function(G,j){return G!=j},emptyNonEmpty:function(G,j){var se=Ii(G),fe=Ii(j);return se&&!fe||!se&&fe}},c=Nt.types,f=[{name:"label",type:c.text,triggersBounds:u.any,triggersZOrder:u.emptyNonEmpty},{name:"text-rotation",type:c.textRotation,triggersBounds:u.any},{name:"text-margin-x",type:c.bidirectionalSize,triggersBounds:u.any},{name:"text-margin-y",type:c.bidirectionalSize,triggersBounds:u.any}],h=[{name:"source-label",type:c.text,triggersBounds:u.any},{name:"source-text-rotation",type:c.textRotation,triggersBounds:u.any},{name:"source-text-margin-x",type:c.bidirectionalSize,triggersBounds:u.any},{name:"source-text-margin-y",type:c.bidirectionalSize,triggersBounds:u.any},{name:"source-text-offset",type:c.size,triggersBounds:u.any}],d=[{name:"target-label",type:c.text,triggersBounds:u.any},{name:"target-text-rotation",type:c.textRotation,triggersBounds:u.any},{name:"target-text-margin-x",type:c.bidirectionalSize,triggersBounds:u.any},{name:"target-text-margin-y",type:c.bidirectionalSize,triggersBounds:u.any},{name:"target-text-offset",type:c.size,triggersBounds:u.any}],p=[{name:"font-family",type:c.fontFamily,triggersBounds:u.any},{name:"font-style",type:c.fontStyle,triggersBounds:u.any},{name:"font-weight",type:c.fontWeight,triggersBounds:u.any},{name:"font-size",type:c.size,triggersBounds:u.any},{name:"text-transform",type:c.textTransform,triggersBounds:u.any},{name:"text-wrap",type:c.textWrap,triggersBounds:u.any},{name:"text-overflow-wrap",type:c.textOverflowWrap,triggersBounds:u.any},{name:"text-max-width",type:c.size,triggersBounds:u.any},{name:"text-outline-width",type:c.size,triggersBounds:u.any},{name:"line-height",type:c.positiveNumber,triggersBounds:u.any}],g=[{name:"text-valign",type:c.valign,triggersBounds:u.any},{name:"text-halign",type:c.halign,triggersBounds:u.any},{name:"color",type:c.color},{name:"text-outline-color",type:c.color},{name:"text-outline-opacity",type:c.zeroOneNumber},{name:"text-background-color",type:c.color},{name:"text-background-opacity",type:c.zeroOneNumber},{name:"text-background-padding",type:c.size,triggersBounds:u.any},{name:"text-border-opacity",type:c.zeroOneNumber},{name:"text-border-color",type:c.color},{name:"text-border-width",type:c.size,triggersBounds:u.any},{name:"text-border-style",type:c.borderStyle,triggersBounds:u.any},{name:"text-background-shape",type:c.textBackgroundShape,triggersBounds:u.any},{name:"text-justification",type:c.justification},{name:"box-select-labels",type:c.bool,triggersBounds:u.any}],m=[{name:"events",type:c.bool,triggersZOrder:u.any},{name:"text-events",type:c.bool,triggersZOrder:u.any}],v=[{name:"display",type:c.display,triggersZOrder:u.any,triggersBounds:u.any,triggersBoundsOfConnectedEdges:u.any,triggersBoundsOfParallelEdges:function(G,j,se){return G===j?!1:se.pstyle("curve-style").value==="bezier"}},{name:"visibility",type:c.visibility,triggersZOrder:u.any},{name:"opacity",type:c.zeroOneNumber,triggersZOrder:u.zeroNonZero},{name:"text-opacity",type:c.zeroOneNumber},{name:"min-zoomed-font-size",type:c.size},{name:"z-compound-depth",type:c.zCompoundDepth,triggersZOrder:u.any},{name:"z-index-compare",type:c.zIndexCompare,triggersZOrder:u.any},{name:"z-index",type:c.number,triggersZOrder:u.any}],y=[{name:"overlay-padding",type:c.size,triggersBounds:u.any},{name:"overlay-color",type:c.color},{name:"overlay-opacity",type:c.zeroOneNumber,triggersBounds:u.zeroNonZero},{name:"overlay-shape",type:c.overlayShape,triggersBounds:u.any},{name:"overlay-corner-radius",type:c.cornerRadius}],b=[{name:"underlay-padding",type:c.size,triggersBounds:u.any},{name:"underlay-color",type:c.color},{name:"underlay-opacity",type:c.zeroOneNumber,triggersBounds:u.zeroNonZero},{name:"underlay-shape",type:c.overlayShape,triggersBounds:u.any},{name:"underlay-corner-radius",type:c.cornerRadius}],w=[{name:"transition-property",type:c.propList},{name:"transition-duration",type:c.time},{name:"transition-delay",type:c.time},{name:"transition-timing-function",type:c.easing}],_=function(G,j){return j.value==="label"?-G.poolIndex():j.pfValue},x=[{name:"height",type:c.nodeSize,triggersBounds:u.any,hashOverride:_},{name:"width",type:c.nodeSize,triggersBounds:u.any,hashOverride:_},{name:"shape",type:c.nodeShape,triggersBounds:u.any},{name:"shape-polygon-points",type:c.polygonPointList,triggersBounds:u.any},{name:"corner-radius",type:c.cornerRadius},{name:"background-color",type:c.color},{name:"background-fill",type:c.fill},{name:"background-opacity",type:c.zeroOneNumber},{name:"background-blacken",type:c.nOneOneNumber},{name:"background-gradient-stop-colors",type:c.colors},{name:"background-gradient-stop-positions",type:c.percentages},{name:"background-gradient-direction",type:c.gradientDirection},{name:"padding",type:c.sizeMaybePercent,triggersBounds:u.any},{name:"padding-relative-to",type:c.paddingRelativeTo,triggersBounds:u.any},{name:"bounds-expansion",type:c.boundsExpansion,triggersBounds:u.any}],S=[{name:"border-color",type:c.color},{name:"border-opacity",type:c.zeroOneNumber},{name:"border-width",type:c.size,triggersBounds:u.any},{name:"border-style",type:c.borderStyle},{name:"border-cap",type:c.lineCap},{name:"border-join",type:c.lineJoin},{name:"border-dash-pattern",type:c.numbers},{name:"border-dash-offset",type:c.number},{name:"border-position",type:c.linePosition}],E=[{name:"outline-color",type:c.color},{name:"outline-opacity",type:c.zeroOneNumber},{name:"outline-width",type:c.size,triggersBounds:u.any},{name:"outline-style",type:c.borderStyle},{name:"outline-offset",type:c.size,triggersBounds:u.any}],A=[{name:"background-image",type:c.urls},{name:"background-image-crossorigin",type:c.bgCrossOrigin},{name:"background-image-opacity",type:c.zeroOneNumbers},{name:"background-image-containment",type:c.bgContainment},{name:"background-image-smoothing",type:c.bools},{name:"background-position-x",type:c.bgPos},{name:"background-position-y",type:c.bgPos},{name:"background-width-relative-to",type:c.bgRelativeTo},{name:"background-height-relative-to",type:c.bgRelativeTo},{name:"background-repeat",type:c.bgRepeat},{name:"background-fit",type:c.bgFit},{name:"background-clip",type:c.bgClip},{name:"background-width",type:c.bgWH},{name:"background-height",type:c.bgWH},{name:"background-offset-x",type:c.bgPos},{name:"background-offset-y",type:c.bgPos}],T=[{name:"position",type:c.position,triggersBounds:u.any},{name:"compound-sizing-wrt-labels",type:c.compoundIncludeLabels,triggersBounds:u.any},{name:"min-width",type:c.size,triggersBounds:u.any},{name:"min-width-bias-left",type:c.sizeMaybePercent,triggersBounds:u.any},{name:"min-width-bias-right",type:c.sizeMaybePercent,triggersBounds:u.any},{name:"min-height",type:c.size,triggersBounds:u.any},{name:"min-height-bias-top",type:c.sizeMaybePercent,triggersBounds:u.any},{name:"min-height-bias-bottom",type:c.sizeMaybePercent,triggersBounds:u.any}],D=[{name:"line-style",type:c.lineStyle},{name:"line-color",type:c.color},{name:"line-fill",type:c.fill},{name:"line-cap",type:c.lineCap},{name:"line-opacity",type:c.zeroOneNumber},{name:"line-dash-pattern",type:c.numbers},{name:"line-dash-offset",type:c.number},{name:"line-outline-width",type:c.size},{name:"line-outline-color",type:c.color},{name:"line-gradient-stop-colors",type:c.colors},{name:"line-gradient-stop-positions",type:c.percentages},{name:"curve-style",type:c.curveStyle,triggersBounds:u.any,triggersBoundsOfParallelEdges:function(G,j){return G===j?!1:G==="bezier"||j==="bezier"}},{name:"haystack-radius",type:c.zeroOneNumber,triggersBounds:u.any},{name:"source-endpoint",type:c.edgeEndpoint,triggersBounds:u.any},{name:"target-endpoint",type:c.edgeEndpoint,triggersBounds:u.any},{name:"control-point-step-size",type:c.size,triggersBounds:u.any},{name:"control-point-distances",type:c.bidirectionalSizes,triggersBounds:u.any},{name:"control-point-weights",type:c.numbers,triggersBounds:u.any},{name:"segment-distances",type:c.bidirectionalSizes,triggersBounds:u.any},{name:"segment-weights",type:c.numbers,triggersBounds:u.any},{name:"segment-radii",type:c.numbers,triggersBounds:u.any},{name:"radius-type",type:c.radiusType,triggersBounds:u.any},{name:"taxi-turn",type:c.bidirectionalSizeMaybePercent,triggersBounds:u.any},{name:"taxi-turn-min-distance",type:c.size,triggersBounds:u.any},{name:"taxi-direction",type:c.axisDirection,triggersBounds:u.any},{name:"taxi-radius",type:c.number,triggersBounds:u.any},{name:"edge-distances",type:c.edgeDistances,triggersBounds:u.any},{name:"arrow-scale",type:c.positiveNumber,triggersBounds:u.any},{name:"loop-direction",type:c.angle,triggersBounds:u.any},{name:"loop-sweep",type:c.angle,triggersBounds:u.any},{name:"source-distance-from-node",type:c.size,triggersBounds:u.any},{name:"target-distance-from-node",type:c.size,triggersBounds:u.any}],k=[{name:"ghost",type:c.bool,triggersBounds:u.any},{name:"ghost-offset-x",type:c.bidirectionalSize,triggersBounds:u.any},{name:"ghost-offset-y",type:c.bidirectionalSize,triggersBounds:u.any},{name:"ghost-opacity",type:c.zeroOneNumber}],M=[{name:"selection-box-color",type:c.color},{name:"selection-box-opacity",type:c.zeroOneNumber},{name:"selection-box-border-color",type:c.color},{name:"selection-box-border-width",type:c.size},{name:"active-bg-color",type:c.color},{name:"active-bg-opacity",type:c.zeroOneNumber},{name:"active-bg-size",type:c.size},{name:"outside-texture-bg-color",type:c.color},{name:"outside-texture-bg-opacity",type:c.zeroOneNumber}],P=[];Nt.pieBackgroundN=16,P.push({name:"pie-size",type:c.sizeMaybePercent}),P.push({name:"pie-hole",type:c.sizeMaybePercent}),P.push({name:"pie-start-angle",type:c.angle});for(var I=1;I<=Nt.pieBackgroundN;I++)P.push({name:"pie-"+I+"-background-color",type:c.color}),P.push({name:"pie-"+I+"-background-size",type:c.percent}),P.push({name:"pie-"+I+"-background-opacity",type:c.zeroOneNumber});var B=[];Nt.stripeBackgroundN=16,B.push({name:"stripe-size",type:c.sizeMaybePercent}),B.push({name:"stripe-direction",type:c.axisDirectionPrimary});for(var L=1;L<=Nt.stripeBackgroundN;L++)B.push({name:"stripe-"+L+"-background-color",type:c.color}),B.push({name:"stripe-"+L+"-background-size",type:c.percent}),B.push({name:"stripe-"+L+"-background-opacity",type:c.zeroOneNumber});var N=[],F=Nt.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:c.arrowShape,triggersBounds:u.any},{name:"arrow-color",type:c.color},{name:"arrow-fill",type:c.arrowFill},{name:"arrow-width",type:c.arrowWidth}].forEach(function(U){F.forEach(function(G){var j=G+"-"+U.name,se=U.type,fe=U.triggersBounds;N.push({name:j,type:se,triggersBounds:fe})})},{});var q=Nt.properties=[].concat(m,w,v,y,b,k,g,p,f,h,d,x,S,E,A,P,B,T,D,N,M),H=Nt.propertyGroups={behavior:m,transition:w,visibility:v,overlay:y,underlay:b,ghost:k,commonLabel:g,labelDimensions:p,mainLabel:f,sourceLabel:h,targetLabel:d,nodeBody:x,nodeBorder:S,nodeOutline:E,backgroundImage:A,pie:P,stripe:B,compound:T,edgeLine:D,edgeArrow:N,core:M},V=Nt.propertyGroupNames={},z=Nt.propertyGroupKeys=Object.keys(H);z.forEach(function(U){V[U]=H[U].map(function(G){return G.name}),H[U].forEach(function(G){return G.groupKey=U})});var Y=Nt.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];Nt.propertyNames=q.map(function(U){return U.name});for(var Q=0;Q<q.length;Q++){var J=q[Q];q[J.name]=J}for(var ee=0;ee<Y.length;ee++){var ae=Y[ee],ue=q[ae.pointsTo],re={name:ae.name,alias:!0,pointsTo:ue};q.push(re),q[ae.name]=re}})();Nt.getDefaultProperty=function(t){return this.getDefaultProperties()[t]};Nt.getDefaultProperties=function(){var t=this._private;if(t.defaultProperties!=null)return t.defaultProperties;for(var e=Ce({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","box-select-labels":"no","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%","pie-hole":0,"pie-start-angle":"0deg"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(u,c){for(var f=1;f<=Nt.pieBackgroundN;f++){var h=c.name.replace("{{i}}",f),d=c.value;u[h]=d}return u},{}),{"stripe-size":"100%","stripe-direction":"horizontal"},[{name:"stripe-{{i}}-background-color",value:"black"},{name:"stripe-{{i}}-background-size",value:"0%"},{name:"stripe-{{i}}-background-opacity",value:1}].reduce(function(u,c){for(var f=1;f<=Nt.stripeBackgroundN;f++){var h=c.name.replace("{{i}}",f),d=c.value;u[h]=d}return u},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(u,c){return Nt.arrowPrefixes.forEach(function(f){var h=f+"-"+c.name,d=c.value;u[h]=d}),u},{})),r={},n=0;n<this.properties.length;n++){var a=this.properties[n];if(!a.pointsTo){var s=a.name,o=e[s],l=this.parse(s,o);r[s]=l}}return t.defaultProperties=r,t.defaultProperties};Nt.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var kh={};kh.parse=function(t,e,r,n){var a=this;if(Ct(e))return a.parseImplWarn(t,e,r,n);var s=n==="mapping"||n===!0||n===!1||n==null?"dontcare":n,o=r?"t":"f",l=""+e,u=bk(t,l,o,s),c=a.propCache=a.propCache||[],f;return(f=c[u])||(f=c[u]=a.parseImplWarn(t,e,r,n)),(r||n==="mapping")&&(f=Bn(f),f&&(f.value=Bn(f.value))),f};kh.parseImplWarn=function(t,e,r,n){var a=this.parseImpl(t,e,r,n);return!a&&e!=null&&st("The style property `".concat(t,": ").concat(e,"` is invalid")),a&&(a.name==="width"||a.name==="height")&&e==="label"&&st("The style value of `label` is deprecated for `"+a.name+"`"),a};kh.parseImpl=function(t,e,r,n){var a=this;t=Ny(t);var s=a.properties[t],o=e,l=a.types;if(!s||e===void 0)return null;s.alias&&(s=s.pointsTo,t=s.name);var u=_e(e);u&&(e=e.trim());var c=s.type;if(!c)return null;if(r&&(e===""||e===null))return{name:t,value:e,bypass:!0,deleteBypass:!0};if(Ct(e))return{name:t,value:e,strValue:"fn",mapped:l.fn,bypass:r};var f,h;if(!(!u||n||e.length<7||e[1]!=="a")){if(e.length>=7&&e[0]==="d"&&(f=new RegExp(l.data.regex).exec(e))){if(r)return!1;var d=l.data;return{name:t,value:f,strValue:""+e,mapped:d,field:f[1],bypass:r}}else if(e.length>=10&&e[0]==="m"&&(h=new RegExp(l.mapData.regex).exec(e))){if(r||c.multiple)return!1;var p=l.mapData;if(!(c.color||c.number))return!1;var g=this.parse(t,h[4]);if(!g||g.mapped)return!1;var m=this.parse(t,h[5]);if(!m||m.mapped)return!1;if(g.pfValue===m.pfValue||g.strValue===m.strValue)return st("`"+t+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+t+": "+g.strValue+"`"),this.parse(t,g.strValue);if(c.color){var v=g.value,y=m.value,b=v[0]===y[0]&&v[1]===y[1]&&v[2]===y[2]&&(v[3]===y[3]||(v[3]==null||v[3]===1)&&(y[3]==null||y[3]===1));if(b)return!1}return{name:t,value:h,strValue:""+e,mapped:p,field:h[1],fieldMin:parseFloat(h[2]),fieldMax:parseFloat(h[3]),valueMin:g.value,valueMax:m.value,bypass:r}}}if(c.multiple&&n!=="multiple"){var w;if(u?w=e.split(/\s+/):dt(e)?w=e:w=[e],c.evenMultiple&&w.length%2!==0)return null;for(var _=[],x=[],S=[],E="",A=!1,T=0;T<w.length;T++){var D=a.parse(t,w[T],r,"multiple");A=A||_e(D.value),_.push(D.value),S.push(D.pfValue!=null?D.pfValue:D.value),x.push(D.units),E+=(T>0?" ":"")+D.strValue}return c.validate&&!c.validate(_,x)?null:c.singleEnum&&A?_.length===1&&_e(_[0])?{name:t,value:_[0],strValue:_[0],bypass:r}:null:{name:t,value:_,pfValue:S,strValue:E,bypass:r,units:x}}var k=function(){for(var re=0;re<c.enums.length;re++){var U=c.enums[re];if(U===e)return{name:t,value:e,strValue:""+e,bypass:r}}return null};if(c.number){var M,P="px";if(c.units&&(M=c.units),c.implicitUnits&&(P=c.implicitUnits),!c.unitless)if(u){var I="px|em"+(c.allowPercent?"|\\%":"");M&&(I=M);var B=e.match("^("+Ht+")("+I+")?$");B&&(e=B[1],M=B[2]||P)}else(!M||c.implicitUnits)&&(M=P);if(e=parseFloat(e),isNaN(e)&&c.enums===void 0)return null;if(isNaN(e)&&c.enums!==void 0)return e=o,k();if(c.integer&&!hU(e)||c.min!==void 0&&(e<c.min||c.strictMin&&e===c.min)||c.max!==void 0&&(e>c.max||c.strictMax&&e===c.max))return null;var L={name:t,value:e,strValue:""+e+(M||""),units:M,bypass:r};return c.unitless||M!=="px"&&M!=="em"?L.pfValue=e:L.pfValue=M==="px"||!M?e:this.getEmSizeInPixels()*e,(M==="ms"||M==="s")&&(L.pfValue=M==="ms"?e:1e3*e),(M==="deg"||M==="rad")&&(L.pfValue=M==="rad"?e:bW(e)),M==="%"&&(L.pfValue=e/100),L}else if(c.propList){var N=[],F=""+e;if(F!=="none"){for(var q=F.split(/\s*,\s*|\s+/),H=0;H<q.length;H++){var V=q[H].trim();a.properties[V]?N.push(V):st("`"+V+"` is not a valid property name")}if(N.length===0)return null}return{name:t,value:N,strValue:N.length===0?"none":N.join(" "),bypass:r}}else if(c.color){var z=hk(e);return z?{name:t,value:z,pfValue:z,strValue:"rgb("+z[0]+","+z[1]+","+z[2]+")",bypass:r}:null}else if(c.regex||c.regexes){if(c.enums){var Y=k();if(Y)return Y}for(var Q=c.regexes?c.regexes:[c.regex],J=0;J<Q.length;J++){var ee=new RegExp(Q[J]),ae=ee.exec(e);if(ae)return{name:t,value:c.singleRegexMatchValue?ae[1]:ae,strValue:""+e,bypass:r}}return null}else return c.string?{name:t,value:""+e,strValue:""+e,bypass:r}:c.enums?k():null};var Zt=function(e){if(!(this instanceof Zt))return new Zt(e);if(!Ly(e)){St("A style must have a core reference");return}this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()},gr=Zt.prototype;gr.instanceString=function(){return"style"};gr.clear=function(){for(var t=this._private,e=t.cy,r=e.elements(),n=0;n<this.length;n++)this[n]=void 0;return this.length=0,t.contextStyles={},t.propDiffs={},this.cleanElements(r,!0),r.forEach(function(a){var s=a[0]._private;s.styleDirty=!0,s.appliedInitStyle=!1}),this};gr.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};gr.core=function(t){return this._private.coreStyle[t]||this.getDefaultProperty(t)};gr.selector=function(t){var e=t==="core"?null:new Ni(t),r=this.length++;return this[r]={selector:e,properties:[],mappedProperties:[],index:r},this};gr.css=function(){var t=this,e=arguments;if(e.length===1)for(var r=e[0],n=0;n<t.properties.length;n++){var a=t.properties[n],s=r[a.name];s===void 0&&(s=r[dh(a.name)]),s!==void 0&&this.cssRule(a.name,s)}else e.length===2&&this.cssRule(e[0],e[1]);return this};gr.style=gr.css;gr.cssRule=function(t,e){var r=this.parse(t,e);if(r){var n=this.length-1;this[n].properties.push(r),this[n].properties[r.name]=r,r.name.match(/pie-(\d+)-background-size/)&&r.value&&(this._private.hasPie=!0),r.name.match(/stripe-(\d+)-background-size/)&&r.value&&(this._private.hasStripe=!0),r.mapped&&this[n].mappedProperties.push(r);var a=!this[n].selector;a&&(this._private.coreStyle[r.name]=r)}return this};gr.append=function(t){return uk(t)?t.appendToStyle(this):dt(t)?this.appendFromJson(t):_e(t)&&this.appendFromString(t),this};Zt.fromJson=function(t,e){var r=new Zt(t);return r.fromJson(e),r};Zt.fromString=function(t,e){return new Zt(t).fromString(e)};[Xt,Jl,Qy,Ln,Th,Jy,Nt,kh].forEach(function(t){Ce(gr,t)});Zt.types=gr.types;Zt.properties=gr.properties;Zt.propertyGroups=gr.propertyGroups;Zt.propertyGroupNames=gr.propertyGroupNames;Zt.propertyGroupKeys=gr.propertyGroupKeys;var E6={style:function(e){if(e){var r=this.setStyle(e);r.update()}return this._private.style},setStyle:function(e){var r=this._private;return uk(e)?r.style=e.generateStyle(this):dt(e)?r.style=Zt.fromJson(this,e):_e(e)?r.style=Zt.fromString(this,e):r.style=Zt(this),r.style},updateStyle:function(){this.mutableElements().updateStyle()}},S6="single",Na={autolock:function(e){if(e!==void 0)this._private.autolock=!!e;else return this._private.autolock;return this},autoungrabify:function(e){if(e!==void 0)this._private.autoungrabify=!!e;else return this._private.autoungrabify;return this},autounselectify:function(e){if(e!==void 0)this._private.autounselectify=!!e;else return this._private.autounselectify;return this},selectionType:function(e){var r=this._private;if(r.selectionType==null&&(r.selectionType=S6),e!==void 0)(e==="additive"||e==="single")&&(r.selectionType=e);else return r.selectionType;return this},panningEnabled:function(e){if(e!==void 0)this._private.panningEnabled=!!e;else return this._private.panningEnabled;return this},userPanningEnabled:function(e){if(e!==void 0)this._private.userPanningEnabled=!!e;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(e){if(e!==void 0)this._private.zoomingEnabled=!!e;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(e){if(e!==void 0)this._private.userZoomingEnabled=!!e;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(e){if(e!==void 0)this._private.boxSelectionEnabled=!!e;else return this._private.boxSelectionEnabled;return this},pan:function(){var e=arguments,r=this._private.pan,n,a,s,o,l;switch(e.length){case 0:return r;case 1:if(_e(e[0]))return n=e[0],r[n];if(Qe(e[0])){if(!this._private.panningEnabled)return this;s=e[0],o=s.x,l=s.y,le(o)&&(r.x=o),le(l)&&(r.y=l),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;n=e[0],a=e[1],(n==="x"||n==="y")&&le(a)&&(r[n]=a),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(e,r){var n=arguments,a=this._private.pan,s,o,l,u,c;if(!this._private.panningEnabled)return this;switch(n.length){case 1:Qe(e)&&(l=n[0],u=l.x,c=l.y,le(u)&&(a.x+=u),le(c)&&(a.y+=c),this.emit("pan viewport"));break;case 2:s=e,o=r,(s==="x"||s==="y")&&le(o)&&(a[s]+=o),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(e,r){var n=this.getFitViewport(e,r);if(n){var a=this._private;a.zoom=n.zoom,a.pan=n.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,r){if(le(e)&&r===void 0&&(r=e,e=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var n;if(_e(e)){var a=e;e=this.$(a)}else if(gU(e)){var s=e;n={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2},n.w=n.x2-n.x1,n.h=n.y2-n.y1}else Hr(e)||(e=this.mutableElements());if(!(Hr(e)&&e.empty())){n=n||e.boundingBox();var o=this.width(),l=this.height(),u;if(r=le(r)?r:0,!isNaN(o)&&!isNaN(l)&&o>0&&l>0&&!isNaN(n.w)&&!isNaN(n.h)&&n.w>0&&n.h>0){u=Math.min((o-2*r)/n.w,(l-2*r)/n.h),u=u>this._private.maxZoom?this._private.maxZoom:u,u=u<this._private.minZoom?this._private.minZoom:u;var c={x:(o-u*(n.x1+n.x2))/2,y:(l-u*(n.y1+n.y2))/2};return{zoom:u,pan:c}}}}},zoomRange:function(e,r){var n=this._private;if(r==null){var a=e;e=a.min,r=a.max}return le(e)&&le(r)&&e<=r?(n.minZoom=e,n.maxZoom=r):le(e)&&r===void 0&&e<=n.maxZoom?n.minZoom=e:le(r)&&e===void 0&&r>=n.minZoom&&(n.maxZoom=r),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var r=this._private,n=r.pan,a=r.zoom,s,o,l=!1;if(r.zoomingEnabled||(l=!0),le(e)?o=e:Qe(e)&&(o=e.level,e.position!=null?s=vh(e.position,a,n):e.renderedPosition!=null&&(s=e.renderedPosition),s!=null&&!r.panningEnabled&&(l=!0)),o=o>r.maxZoom?r.maxZoom:o,o=o<r.minZoom?r.minZoom:o,l||!le(o)||o===a||s!=null&&(!le(s.x)||!le(s.y)))return null;if(s!=null){var u=n,c=a,f=o,h={x:-f/c*(s.x-u.x)+s.x,y:-f/c*(s.y-u.y)+s.y};return{zoomed:!0,panned:!0,zoom:f,pan:h}}else return{zoomed:!0,panned:!1,zoom:o,pan:n}},zoom:function(e){if(e===void 0)return this._private.zoom;var r=this.getZoomedViewport(e),n=this._private;return r==null||!r.zoomed?this:(n.zoom=r.zoom,r.panned&&(n.pan.x=r.pan.x,n.pan.y=r.pan.y),this.emit("zoom"+(r.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(e){var r=this._private,n=!0,a=!0,s=[],o=!1,l=!1;if(!e)return this;if(le(e.zoom)||(n=!1),Qe(e.pan)||(a=!1),!n&&!a)return this;if(n){var u=e.zoom;u<r.minZoom||u>r.maxZoom||!r.zoomingEnabled?o=!0:(r.zoom=u,s.push("zoom"))}if(a&&(!o||!e.cancelOnFailedZoom)&&r.panningEnabled){var c=e.pan;le(c.x)&&(r.pan.x=c.x,l=!1),le(c.y)&&(r.pan.y=c.y,l=!1),l||s.push("pan")}return s.length>0&&(s.push("viewport"),this.emit(s.join(" ")),this.notify("viewport")),this},center:function(e){var r=this.getCenterPan(e);return r&&(this._private.pan=r,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,r){if(this._private.panningEnabled){if(_e(e)){var n=e;e=this.mutableElements().filter(n)}else Hr(e)||(e=this.mutableElements());if(e.length!==0){var a=e.boundingBox(),s=this.width(),o=this.height();r=r===void 0?this._private.zoom:r;var l={x:(s-r*(a.x1+a.x2))/2,y:(o-r*(a.y1+a.y2))/2};return l}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e=this._private,r=e.container,n=this;return e.sizeCache=e.sizeCache||(r?function(){var a=n.window().getComputedStyle(r),s=function(l){return parseFloat(a.getPropertyValue(l))};return{width:r.clientWidth-s("padding-left")-s("padding-right"),height:r.clientHeight-s("padding-top")-s("padding-bottom")}}():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,r=this._private.zoom,n=this.renderedExtent(),a={x1:(n.x1-e.x)/r,x2:(n.x2-e.x)/r,y1:(n.y1-e.y)/r,y2:(n.y2-e.y)/r};return a.w=a.x2-a.x1,a.h=a.y2-a.y1,a},renderedExtent:function(){var e=this.width(),r=this.height();return{x1:0,y1:0,x2:e,y2:r,w:e,h:r}},multiClickDebounceTime:function(e){if(e)this._private.multiClickDebounceTime=e;else return this._private.multiClickDebounceTime;return this}};Na.centre=Na.center;Na.autolockNodes=Na.autolock;Na.autoungrabifyNodes=Na.autoungrabify;var Hl={data:at.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:at.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:at.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:at.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};Hl.attr=Hl.data;Hl.removeAttr=Hl.removeData;var Ul=function(e){var r=this;e=Ce({},e);var n=e.container;n&&!eh(n)&&eh(n[0])&&(n=n[0]);var a=n?n._cyreg:null;a=a||{},a&&a.cy&&(a.cy.destroy(),a={});var s=a.readies=a.readies||[];n&&(n._cyreg=a),a.cy=r;var o=Vt!==void 0&&n!==void 0&&!e.headless,l=e;l.layout=Ce({name:o?"grid":"null"},l.layout),l.renderer=Ce({name:o?"canvas":"null"},l.renderer);var u=function(g,m,v){return m!==void 0?m:v!==void 0?v:g},c=this._private={container:n,ready:!1,options:l,elements:new ir(this),listeners:[],aniEles:new ir(this),data:l.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:u(!0,l.zoomingEnabled),userZoomingEnabled:u(!0,l.userZoomingEnabled),panningEnabled:u(!0,l.panningEnabled),userPanningEnabled:u(!0,l.userPanningEnabled),boxSelectionEnabled:u(!0,l.boxSelectionEnabled),autolock:u(!1,l.autolock,l.autolockNodes),autoungrabify:u(!1,l.autoungrabify,l.autoungrabifyNodes),autounselectify:u(!1,l.autounselectify),styleEnabled:l.styleEnabled===void 0?o:l.styleEnabled,zoom:le(l.zoom)?l.zoom:1,pan:{x:Qe(l.pan)&&le(l.pan.x)?l.pan.x:0,y:Qe(l.pan)&&le(l.pan.y)?l.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:u(250,l.multiClickDebounceTime)};this.createEmitter(),this.selectionType(l.selectionType),this.zoomRange({min:l.minZoom,max:l.maxZoom});var f=function(g,m){var v=g.some(vU);if(v)return Ys.all(g).then(m);m(g)};c.styleEnabled&&r.setStyle([]);var h=Ce({},l,l.renderer);r.initRenderer(h);var d=function(g,m,v){r.notifications(!1);var y=r.mutableElements();y.length>0&&y.remove(),g!=null&&(Qe(g)||dt(g))&&r.add(g),r.one("layoutready",function(w){r.notifications(!0),r.emit(w),r.one("load",m),r.emitAndNotify("load")}).one("layoutstop",function(){r.one("done",v),r.emit("done")});var b=Ce({},r._private.options.layout);b.eles=r.elements(),r.layout(b).run()};f([l.style,l.elements],function(p){var g=p[0],m=p[1];c.styleEnabled&&r.style().append(g),d(m,function(){r.startAnimationLoop(),c.ready=!0,Ct(l.ready)&&r.on("ready",l.ready);for(var v=0;v<s.length;v++){var y=s[v];r.on("ready",y)}a&&(a.readies=[]),r.emit("ready")},l.done)})},oh=Ul.prototype;Ce(oh,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},window:function(){var e=this._private.container;if(e==null)return Vt;var r=this._private.container.ownerDocument;return r===void 0||r==null?Vt:r.defaultView||Vt},mount:function(e){if(e!=null){var r=this,n=r._private,a=n.options;return!eh(e)&&eh(e[0])&&(e=e[0]),r.stopAnimationLoop(),r.destroyRenderer(),n.container=e,n.styleEnabled=!0,r.invalidateSize(),r.initRenderer(Ce({},a,a.renderer,{name:a.renderer.name==="null"?"canvas":a.renderer.name})),r.startAnimationLoop(),r.style(a.style),r.emit("mount"),r}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return Bn(this._private.options)},json:function(e){var r=this,n=r._private,a=r.mutableElements(),s=function(_){return r.getElementById(_.id())};if(Qe(e)){if(r.startBatch(),e.elements){var o={},l=function(_,x){for(var S=[],E=[],A=0;A<_.length;A++){var T=_[A];if(!T.data.id){st("cy.json() cannot handle elements without an ID attribute");continue}var D=""+T.data.id,k=r.getElementById(D);o[D]=!0,k.length!==0?E.push({ele:k,json:T}):(x&&(T.group=x),S.push(T))}r.add(S);for(var M=0;M<E.length;M++){var P=E[M],I=P.ele,B=P.json;I.json(B)}};if(dt(e.elements))l(e.elements);else for(var u=["nodes","edges"],c=0;c<u.length;c++){var f=u[c],h=e.elements[f];dt(h)&&l(h,f)}var d=r.collection();a.filter(function(w){return!o[w.id()]}).forEach(function(w){w.isParent()?d.merge(w):w.remove()}),d.forEach(function(w){return w.children().move({parent:null})}),d.forEach(function(w){return s(w).remove()})}e.style&&r.style(e.style),e.zoom!=null&&e.zoom!==n.zoom&&r.zoom(e.zoom),e.pan&&(e.pan.x!==n.pan.x||e.pan.y!==n.pan.y)&&r.pan(e.pan),e.data&&r.data(e.data);for(var p=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],g=0;g<p.length;g++){var m=p[g];e[m]!=null&&r[m](e[m])}return r.endBatch(),this}else{var v=!!e,y={};v?y.elements=this.elements().map(function(w){return w.json()}):(y.elements={},a.forEach(function(w){var _=w.group();y.elements[_]||(y.elements[_]=[]),y.elements[_].push(w.json())})),this._private.styleEnabled&&(y.style=r.style().json()),y.data=Bn(r.data());var b=n.options;return y.zoomingEnabled=n.zoomingEnabled,y.userZoomingEnabled=n.userZoomingEnabled,y.zoom=n.zoom,y.minZoom=n.minZoom,y.maxZoom=n.maxZoom,y.panningEnabled=n.panningEnabled,y.userPanningEnabled=n.userPanningEnabled,y.pan=Bn(n.pan),y.boxSelectionEnabled=n.boxSelectionEnabled,y.renderer=Bn(b.renderer),y.hideEdgesOnViewport=b.hideEdgesOnViewport,y.textureOnViewport=b.textureOnViewport,y.wheelSensitivity=b.wheelSensitivity,y.motionBlur=b.motionBlur,y.multiClickDebounceTime=b.multiClickDebounceTime,y}}});oh.$id=oh.getElementById;[d6,y6,oA,Sy,Yf,w6,Cy,Zf,E6,Na,Hl].forEach(function(t){Ce(oh,t)});var C6={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}},T6={maximal:!1,acyclic:!1},Rs=function(e){return e.scratch("breadthfirst")},DT=function(e,r){return e.scratch("breadthfirst",r)};function lA(t){this.options=Ce({},C6,T6,t)}lA.prototype.run=function(){var t=this.options,e=t.cy,r=t.eles,n=r.nodes().filter(function(pe){return pe.isChildless()}),a=r,s=t.directed,o=t.acyclic||t.maximal||t.maximalAdjustments>0,l=!!t.boundingBox,u=e.extent(),c=Br(l?t.boundingBox:{x1:u.x1,y1:u.y1,w:u.w,h:u.h}),f;if(Hr(t.roots))f=t.roots;else if(dt(t.roots)){for(var h=[],d=0;d<t.roots.length;d++){var p=t.roots[d],g=e.getElementById(p);h.push(g)}f=e.collection(h)}else if(_e(t.roots))f=e.$(t.roots);else if(s)f=n.roots();else{var m=r.components();f=e.collection();for(var v=function(){var ge=m[y],Ee=ge.maxDegree(!1),Te=ge.filter(function(Se){return Se.degree(!1)===Ee});f=f.add(Te)},y=0;y<m.length;y++)v()}var b=[],w={},_=function(ge,Ee){b[Ee]==null&&(b[Ee]=[]);var Te=b[Ee].length;b[Ee].push(ge),DT(ge,{index:Te,depth:Ee})},x=function(ge,Ee){var Te=Rs(ge),Se=Te.depth,Ae=Te.index;b[Se][Ae]=null,ge.isChildless()&&_(ge,Ee)};a.bfs({roots:f,directed:t.directed,visit:function(ge,Ee,Te,Se,Ae){var De=ge[0],Ye=De.id();De.isChildless()&&_(De,Ae),w[Ye]=!0}});for(var S=[],E=0;E<n.length;E++){var A=n[E];w[A.id()]||S.push(A)}var T=function(ge){for(var Ee=b[ge],Te=0;Te<Ee.length;Te++){var Se=Ee[Te];if(Se==null){Ee.splice(Te,1),Te--;continue}DT(Se,{depth:ge,index:Te})}},D=function(ge,Ee){for(var Te=Rs(ge),Se=ge.incomers().filter(function(Dt){return Dt.isNode()&&r.has(Dt)}),Ae=-1,De=ge.id(),Ye=0;Ye<Se.length;Ye++){var ft=Se[Ye],Tt=Rs(ft);Ae=Math.max(Ae,Tt.depth)}if(Te.depth<=Ae){if(!t.acyclic&&Ee[De])return null;var Je=Ae+1;return x(ge,Je),Ee[De]=Je,!0}return!1};if(s&&o){var k=[],M={},P=function(ge){return k.push(ge)},I=function(){return k.shift()};for(n.forEach(function(pe){return k.push(pe)});k.length>0;){var B=I(),L=D(B,M);if(L)B.outgoers().filter(function(pe){return pe.isNode()&&r.has(pe)}).forEach(P);else if(L===null){st("Detected double maximal shift for node `"+B.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var N=0;if(t.avoidOverlap)for(var F=0;F<n.length;F++){var q=n[F],H=q.layoutDimensions(t),V=H.w,z=H.h;N=Math.max(N,V,z)}var Y={},Q=function(ge){if(Y[ge.id()])return Y[ge.id()];for(var Ee=Rs(ge).depth,Te=ge.neighborhood(),Se=0,Ae=0,De=0;De<Te.length;De++){var Ye=Te[De];if(!(Ye.isEdge()||Ye.isParent()||!n.has(Ye))){var ft=Rs(Ye);if(ft!=null){var Tt=ft.index,Je=ft.depth;if(!(Tt==null||Je==null)){var Dt=b[Je].length;Je<Ee&&(Se+=Tt/Dt,Ae++)}}}}return Ae=Math.max(1,Ae),Se=Se/Ae,Ae===0&&(Se=0),Y[ge.id()]=Se,Se},J=function(ge,Ee){var Te=Q(ge),Se=Q(Ee),Ae=Te-Se;return Ae===0?fk(ge.id(),Ee.id()):Ae};t.depthSort!==void 0&&(J=t.depthSort);for(var ee=b.length,ae=0;ae<ee;ae++)b[ae].sort(J),T(ae);for(var ue=[],re=0;re<S.length;re++)ue.push(S[re]);var U=function(){for(var ge=0;ge<ee;ge++)T(ge)};ue.length&&(b.unshift(ue),ee=b.length,U());for(var G=0,j=0;j<ee;j++)G=Math.max(b[j].length,G);var se={x:c.x1+c.w/2,y:c.y1+c.h/2},fe=n.reduce(function(pe,ge){return function(Ee){return{w:pe.w===-1?Ee.w:(pe.w+Ee.w)/2,h:pe.h===-1?Ee.h:(pe.h+Ee.h)/2}}(ge.boundingBox({includeLabels:t.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),Pe=Math.max(ee===1?0:l?(c.h-t.padding*2-fe.h)/(ee-1):(c.h-t.padding*2-fe.h)/(ee+1),N),wt=b.reduce(function(pe,ge){return Math.max(pe,ge.length)},0),ot=function(ge){var Ee=Rs(ge),Te=Ee.depth,Se=Ee.index;if(t.circle){var Ae=Math.min(c.w/2/ee,c.h/2/ee);Ae=Math.max(Ae,N);var De=Ae*Te+Ae-(ee>0&&b[0].length<=3?Ae/2:0),Ye=2*Math.PI/b[Te].length*Se;return Te===0&&b[0].length===1&&(De=1),{x:se.x+De*Math.cos(Ye),y:se.y+De*Math.sin(Ye)}}else{var ft=b[Te].length,Tt=Math.max(ft===1?0:l?(c.w-t.padding*2-fe.w)/((t.grid?wt:ft)-1):(c.w-t.padding*2-fe.w)/((t.grid?wt:ft)+1),N),Je={x:se.x+(Se+1-(ft+1)/2)*Tt,y:se.y+(Te+1-(ee+1)/2)*Pe};return Je}};return r.nodes().layoutPositions(this,t,ot),this};var k6={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function uA(t){this.options=Ce({},k6,t)}uA.prototype.run=function(){var t=this.options,e=t,r=t.cy,n=e.eles,a=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,s=n.nodes().not(":parent");e.sort&&(s=s.sort(e.sort));for(var o=Br(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()}),l={x:o.x1+o.w/2,y:o.y1+o.h/2},u=e.sweep===void 0?2*Math.PI-2*Math.PI/s.length:e.sweep,c=u/Math.max(1,s.length-1),f,h=0,d=0;d<s.length;d++){var p=s[d],g=p.layoutDimensions(e),m=g.w,v=g.h;h=Math.max(h,m,v)}if(le(e.radius)?f=e.radius:s.length<=1?f=0:f=Math.min(o.h,o.w)/2-h,s.length>1&&e.avoidOverlap){h*=1.75;var y=Math.cos(c)-Math.cos(0),b=Math.sin(c)-Math.sin(0),w=Math.sqrt(h*h/(y*y+b*b));f=Math.max(w,f)}var _=function(S,E){var A=e.startAngle+E*c*(a?1:-1),T=f*Math.cos(A),D=f*Math.sin(A),k={x:l.x+T,y:l.y+D};return k};return n.nodes().layoutPositions(this,e,_),this};var A6={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function cA(t){this.options=Ce({},A6,t)}cA.prototype.run=function(){for(var t=this.options,e=t,r=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,n=t.cy,a=e.eles,s=a.nodes().not(":parent"),o=Br(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),l={x:o.x1+o.w/2,y:o.y1+o.h/2},u=[],c=0,f=0;f<s.length;f++){var h=s[f],d=void 0;d=e.concentric(h),u.push({value:d,node:h}),h._private.scratch.concentric=d}s.updateStyle();for(var p=0;p<s.length;p++){var g=s[p],m=g.layoutDimensions(e);c=Math.max(c,m.w,m.h)}u.sort(function(fe,Pe){return Pe.value-fe.value});for(var v=e.levelWidth(s),y=[[]],b=y[0],w=0;w<u.length;w++){var _=u[w];if(b.length>0){var x=Math.abs(b[0].value-_.value);x>=v&&(b=[],y.push(b))}b.push(_)}var S=c+e.minNodeSpacing;if(!e.avoidOverlap){var E=y.length>0&&y[0].length>1,A=Math.min(o.w,o.h)/2-S,T=A/(y.length+E?1:0);S=Math.min(S,T)}for(var D=0,k=0;k<y.length;k++){var M=y[k],P=e.sweep===void 0?2*Math.PI-2*Math.PI/M.length:e.sweep,I=M.dTheta=P/Math.max(1,M.length-1);if(M.length>1&&e.avoidOverlap){var B=Math.cos(I)-Math.cos(0),L=Math.sin(I)-Math.sin(0),N=Math.sqrt(S*S/(B*B+L*L));D=Math.max(N,D)}M.r=D,D+=S}if(e.equidistant){for(var F=0,q=0,H=0;H<y.length;H++){var V=y[H],z=V.r-q;F=Math.max(F,z)}q=0;for(var Y=0;Y<y.length;Y++){var Q=y[Y];Y===0&&(q=Q.r),Q.r=q,q+=F}}for(var J={},ee=0;ee<y.length;ee++)for(var ae=y[ee],ue=ae.dTheta,re=ae.r,U=0;U<ae.length;U++){var G=ae[U],j=e.startAngle+(r?1:-1)*ue*U,se={x:l.x+re*Math.cos(j),y:l.y+re*Math.sin(j)};J[G.node.id()]=se}return a.nodes().layoutPositions(this,e,function(fe){var Pe=fe.id();return J[Pe]}),this};var ay,M6={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,r){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function Ah(t){this.options=Ce({},M6,t),this.options.layout=this;var e=this.options.eles.nodes(),r=this.options.eles.edges(),n=r.filter(function(a){var s=a.source().data("id"),o=a.target().data("id"),l=e.some(function(c){return c.data("id")===s}),u=e.some(function(c){return c.data("id")===o});return!l||!u});this.options.eles=this.options.eles.not(n)}Ah.prototype.run=function(){var t=this.options,e=t.cy,r=this;r.stopped=!1,(t.animate===!0||t.animate===!1)&&r.emit({type:"layoutstart",layout:r}),t.debug===!0?ay=!0:ay=!1;var n=P6(e,r,t);ay&&D6(n),t.randomize&&O6(n);var a=ri(),s=function(){I6(n,e,t),t.fit===!0&&e.fit(t.padding)},o=function(d){return!(r.stopped||d>=t.numIter||(B6(n,t),n.temperature=n.temperature*t.coolingFactor,n.temperature<t.minTemp))},l=function(){if(t.animate===!0||t.animate===!1)s(),r.one("layoutstop",t.stop),r.emit({type:"layoutstop",layout:r});else{var d=t.eles.nodes(),p=hA(n,t,d);d.layoutPositions(r,t,p)}},u=0,c=!0;if(t.animate===!0){var f=function(){for(var d=0;c&&d<t.refresh;)c=o(u),u++,d++;if(!c)IT(n,t),l();else{var p=ri();p-a>=t.animationThreshold&&s(),th(f)}};f()}else{for(;c;)c=o(u),u++;IT(n,t),l()}return this};Ah.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};Ah.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var P6=function(e,r,n){for(var a=n.eles.edges(),s=n.eles.nodes(),o=Br(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),l={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:s.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:a.size(),temperature:n.initialTemp,clientWidth:o.w,clientHeight:o.h,boundingBox:o},u=n.eles.components(),c={},f=0;f<u.length;f++)for(var h=u[f],d=0;d<h.length;d++){var p=h[d];c[p.id()]=f}for(var f=0;f<l.nodeSize;f++){var g=s[f],m=g.layoutDimensions(n),v={};v.isLocked=g.locked(),v.id=g.data("id"),v.parentId=g.data("parent"),v.cmptId=c[g.id()],v.children=[],v.positionX=g.position("x"),v.positionY=g.position("y"),v.offsetX=0,v.offsetY=0,v.height=m.w,v.width=m.h,v.maxX=v.positionX+v.width/2,v.minX=v.positionX-v.width/2,v.maxY=v.positionY+v.height/2,v.minY=v.positionY-v.height/2,v.padLeft=parseFloat(g.style("padding")),v.padRight=parseFloat(g.style("padding")),v.padTop=parseFloat(g.style("padding")),v.padBottom=parseFloat(g.style("padding")),v.nodeRepulsion=Ct(n.nodeRepulsion)?n.nodeRepulsion(g):n.nodeRepulsion,l.layoutNodes.push(v),l.idToIndex[v.id]=f}for(var y=[],b=0,w=-1,_=[],f=0;f<l.nodeSize;f++){var g=l.layoutNodes[f],x=g.parentId;x!=null?l.layoutNodes[l.idToIndex[x]].children.push(g.id):(y[++w]=g.id,_.push(g.id))}for(l.graphSet.push(_);b<=w;){var S=y[b++],E=l.idToIndex[S],p=l.layoutNodes[E],A=p.children;if(A.length>0){l.graphSet.push(A);for(var f=0;f<A.length;f++)y[++w]=A[f]}}for(var f=0;f<l.graphSet.length;f++)for(var T=l.graphSet[f],d=0;d<T.length;d++){var D=l.idToIndex[T[d]];l.indexToGraph[D]=f}for(var f=0;f<l.edgeSize;f++){var k=a[f],M={};M.id=k.data("id"),M.sourceId=k.data("source"),M.targetId=k.data("target");var P=Ct(n.idealEdgeLength)?n.idealEdgeLength(k):n.idealEdgeLength,I=Ct(n.edgeElasticity)?n.edgeElasticity(k):n.edgeElasticity,B=l.idToIndex[M.sourceId],L=l.idToIndex[M.targetId],N=l.indexToGraph[B],F=l.indexToGraph[L];if(N!=F){for(var q=R6(M.sourceId,M.targetId,l),H=l.graphSet[q],V=0,v=l.layoutNodes[B];H.indexOf(v.id)===-1;)v=l.layoutNodes[l.idToIndex[v.parentId]],V++;for(v=l.layoutNodes[L];H.indexOf(v.id)===-1;)v=l.layoutNodes[l.idToIndex[v.parentId]],V++;P*=V*n.nestingFactor}M.idealLength=P,M.elasticity=I,l.layoutEdges.push(M)}return l},R6=function(e,r,n){var a=fA(e,r,0,n);return 2>a.count?0:a.graph},fA=function(e,r,n,a){var s=a.graphSet[n];if(-1<s.indexOf(e)&&-1<s.indexOf(r))return{count:2,graph:n};for(var o=0,l=0;l<s.length;l++){var u=s[l],c=a.idToIndex[u],f=a.layoutNodes[c].children;if(f.length!==0){var h=a.indexToGraph[a.idToIndex[f[0]]],d=fA(e,r,h,a);if(d.count!==0)if(d.count===1){if(o++,o===2)break}else return d}}return{count:o,graph:n}},D6,O6=function(e,r){for(var n=e.clientWidth,a=e.clientHeight,s=0;s<e.nodeSize;s++){var o=e.layoutNodes[s];o.children.length===0&&!o.isLocked&&(o.positionX=Math.random()*n,o.positionY=Math.random()*a)}},hA=function(e,r,n){var a=e.boundingBox,s={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return r.boundingBox&&(n.forEach(function(o){var l=e.layoutNodes[e.idToIndex[o.data("id")]];s.x1=Math.min(s.x1,l.positionX),s.x2=Math.max(s.x2,l.positionX),s.y1=Math.min(s.y1,l.positionY),s.y2=Math.max(s.y2,l.positionY)}),s.w=s.x2-s.x1,s.h=s.y2-s.y1),function(o,l){var u=e.layoutNodes[e.idToIndex[o.data("id")]];if(r.boundingBox){var c=(u.positionX-s.x1)/s.w,f=(u.positionY-s.y1)/s.h;return{x:a.x1+c*a.w,y:a.y1+f*a.h}}else return{x:u.positionX,y:u.positionY}}},I6=function(e,r,n){var a=n.layout,s=n.eles.nodes(),o=hA(e,n,s);s.positions(o),e.ready!==!0&&(e.ready=!0,a.one("layoutready",n.ready),a.emit({type:"layoutready",layout:this}))},B6=function(e,r,n){L6(e,r),q6(e),V6(e,r),z6(e),H6(e)},L6=function(e,r){for(var n=0;n<e.graphSet.length;n++)for(var a=e.graphSet[n],s=a.length,o=0;o<s;o++)for(var l=e.layoutNodes[e.idToIndex[a[o]]],u=o+1;u<s;u++){var c=e.layoutNodes[e.idToIndex[a[u]]];N6(l,c,e,r)}},OT=function(e){return-1+2*e*Math.random()},N6=function(e,r,n,a){var s=e.cmptId,o=r.cmptId;if(!(s!==o&&!n.isCompound)){var l=r.positionX-e.positionX,u=r.positionY-e.positionY,c=1;l===0&&u===0&&(l=OT(c),u=OT(c));var f=F6(e,r,l,u);if(f>0)var h=a.nodeOverlap*f,d=Math.sqrt(l*l+u*u),p=h*l/d,g=h*u/d;else var m=lh(e,l,u),v=lh(r,-1*l,-1*u),y=v.x-m.x,b=v.y-m.y,w=y*y+b*b,d=Math.sqrt(w),h=(e.nodeRepulsion+r.nodeRepulsion)/w,p=h*y/d,g=h*b/d;e.isLocked||(e.offsetX-=p,e.offsetY-=g),r.isLocked||(r.offsetX+=p,r.offsetY+=g)}},F6=function(e,r,n,a){if(n>0)var s=e.maxX-r.minX;else var s=r.maxX-e.minX;if(a>0)var o=e.maxY-r.minY;else var o=r.maxY-e.minY;return s>=0&&o>=0?Math.sqrt(s*s+o*o):0},lh=function(e,r,n){var a=e.positionX,s=e.positionY,o=e.height||1,l=e.width||1,u=n/r,c=o/l,f={};return r===0&&0<n||r===0&&0>n?(f.x=a,f.y=s+o/2,f):0<r&&-1*c<=u&&u<=c?(f.x=a+l/2,f.y=s+l*n/2/r,f):0>r&&-1*c<=u&&u<=c?(f.x=a-l/2,f.y=s-l*n/2/r,f):0<n&&(u<=-1*c||u>=c)?(f.x=a+o*r/2/n,f.y=s+o/2,f):(0>n&&(u<=-1*c||u>=c)&&(f.x=a-o*r/2/n,f.y=s-o/2),f)},q6=function(e,r){for(var n=0;n<e.edgeSize;n++){var a=e.layoutEdges[n],s=e.idToIndex[a.sourceId],o=e.layoutNodes[s],l=e.idToIndex[a.targetId],u=e.layoutNodes[l],c=u.positionX-o.positionX,f=u.positionY-o.positionY;if(!(c===0&&f===0)){var h=lh(o,c,f),d=lh(u,-1*c,-1*f),p=d.x-h.x,g=d.y-h.y,m=Math.sqrt(p*p+g*g),v=Math.pow(a.idealLength-m,2)/a.elasticity;if(m!==0)var y=v*p/m,b=v*g/m;else var y=0,b=0;o.isLocked||(o.offsetX+=y,o.offsetY+=b),u.isLocked||(u.offsetX-=y,u.offsetY-=b)}}},V6=function(e,r){if(r.gravity!==0)for(var n=1,a=0;a<e.graphSet.length;a++){var s=e.graphSet[a],o=s.length;if(a===0)var l=e.clientHeight/2,u=e.clientWidth/2;else var c=e.layoutNodes[e.idToIndex[s[0]]],f=e.layoutNodes[e.idToIndex[c.parentId]],l=f.positionX,u=f.positionY;for(var h=0;h<o;h++){var d=e.layoutNodes[e.idToIndex[s[h]]];if(!d.isLocked){var p=l-d.positionX,g=u-d.positionY,m=Math.sqrt(p*p+g*g);if(m>n){var v=r.gravity*p/m,y=r.gravity*g/m;d.offsetX+=v,d.offsetY+=y}}}}},z6=function(e,r){var n=[],a=0,s=-1;for(n.push.apply(n,e.graphSet[0]),s+=e.graphSet[0].length;a<=s;){var o=n[a++],l=e.idToIndex[o],u=e.layoutNodes[l],c=u.children;if(0<c.length&&!u.isLocked){for(var f=u.offsetX,h=u.offsetY,d=0;d<c.length;d++){var p=e.layoutNodes[e.idToIndex[c[d]]];p.offsetX+=f,p.offsetY+=h,n[++s]=c[d]}u.offsetX=0,u.offsetY=0}}},H6=function(e,r){for(var n=0;n<e.nodeSize;n++){var a=e.layoutNodes[n];0<a.children.length&&(a.maxX=void 0,a.minX=void 0,a.maxY=void 0,a.minY=void 0)}for(var n=0;n<e.nodeSize;n++){var a=e.layoutNodes[n];if(!(0<a.children.length||a.isLocked)){var s=U6(a.offsetX,a.offsetY,e.temperature);a.positionX+=s.x,a.positionY+=s.y,a.offsetX=0,a.offsetY=0,a.minX=a.positionX-a.width,a.maxX=a.positionX+a.width,a.minY=a.positionY-a.height,a.maxY=a.positionY+a.height,dA(a,e)}}for(var n=0;n<e.nodeSize;n++){var a=e.layoutNodes[n];0<a.children.length&&!a.isLocked&&(a.positionX=(a.maxX+a.minX)/2,a.positionY=(a.maxY+a.minY)/2,a.width=a.maxX-a.minX,a.height=a.maxY-a.minY)}},U6=function(e,r,n){var a=Math.sqrt(e*e+r*r);if(a>n)var s={x:n*e/a,y:n*r/a};else var s={x:e,y:r};return s},dA=function(e,r){var n=e.parentId;if(n!=null){var a=r.layoutNodes[r.idToIndex[n]],s=!1;if((a.maxX==null||e.maxX+a.padRight>a.maxX)&&(a.maxX=e.maxX+a.padRight,s=!0),(a.minX==null||e.minX-a.padLeft<a.minX)&&(a.minX=e.minX-a.padLeft,s=!0),(a.maxY==null||e.maxY+a.padBottom>a.maxY)&&(a.maxY=e.maxY+a.padBottom,s=!0),(a.minY==null||e.minY-a.padTop<a.minY)&&(a.minY=e.minY-a.padTop,s=!0),s)return dA(a,r)}},IT=function(e,r){for(var n=e.layoutNodes,a=[],s=0;s<n.length;s++){var o=n[s],l=o.cmptId,u=a[l]=a[l]||[];u.push(o)}for(var c=0,s=0;s<a.length;s++){var f=a[s];if(f){f.x1=1/0,f.x2=-1/0,f.y1=1/0,f.y2=-1/0;for(var h=0;h<f.length;h++){var d=f[h];f.x1=Math.min(f.x1,d.positionX-d.width/2),f.x2=Math.max(f.x2,d.positionX+d.width/2),f.y1=Math.min(f.y1,d.positionY-d.height/2),f.y2=Math.max(f.y2,d.positionY+d.height/2)}f.w=f.x2-f.x1,f.h=f.y2-f.y1,c+=f.w*f.h}}a.sort(function(b,w){return w.w*w.h-b.w*b.h});for(var p=0,g=0,m=0,v=0,y=Math.sqrt(c)*e.clientWidth/e.clientHeight,s=0;s<a.length;s++){var f=a[s];if(f){for(var h=0;h<f.length;h++){var d=f[h];d.isLocked||(d.positionX+=p-f.x1,d.positionY+=g-f.y1)}p+=f.w+r.componentSpacing,m+=f.w+r.componentSpacing,v=Math.max(v,f.h),m>y&&(g+=v+r.componentSpacing,p=0,m=0,v=0)}}},W6={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function pA(t){this.options=Ce({},W6,t)}pA.prototype.run=function(){var t=this.options,e=t,r=t.cy,n=e.eles,a=n.nodes().not(":parent");e.sort&&(a=a.sort(e.sort));var s=Br(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()});if(s.h===0||s.w===0)n.nodes().layoutPositions(this,e,function(Y){return{x:s.x1,y:s.y1}});else{var o=a.size(),l=Math.sqrt(o*s.h/s.w),u=Math.round(l),c=Math.round(s.w/s.h*l),f=function(Q){if(Q==null)return Math.min(u,c);var J=Math.min(u,c);J==u?u=Q:c=Q},h=function(Q){if(Q==null)return Math.max(u,c);var J=Math.max(u,c);J==u?u=Q:c=Q},d=e.rows,p=e.cols!=null?e.cols:e.columns;if(d!=null&&p!=null)u=d,c=p;else if(d!=null&&p==null)u=d,c=Math.ceil(o/u);else if(d==null&&p!=null)c=p,u=Math.ceil(o/c);else if(c*u>o){var g=f(),m=h();(g-1)*m>=o?f(g-1):(m-1)*g>=o&&h(m-1)}else for(;c*u<o;){var v=f(),y=h();(y+1)*v>=o?h(y+1):f(v+1)}var b=s.w/c,w=s.h/u;if(e.condense&&(b=0,w=0),e.avoidOverlap)for(var _=0;_<a.length;_++){var x=a[_],S=x._private.position;(S.x==null||S.y==null)&&(S.x=0,S.y=0);var E=x.layoutDimensions(e),A=e.avoidOverlapPadding,T=E.w+A,D=E.h+A;b=Math.max(b,T),w=Math.max(w,D)}for(var k={},M=function(Q,J){return!!k["c-"+Q+"-"+J]},P=function(Q,J){k["c-"+Q+"-"+J]=!0},I=0,B=0,L=function(){B++,B>=c&&(B=0,I++)},N={},F=0;F<a.length;F++){var q=a[F],H=e.position(q);if(H&&(H.row!==void 0||H.col!==void 0)){var V={row:H.row,col:H.col};if(V.col===void 0)for(V.col=0;M(V.row,V.col);)V.col++;else if(V.row===void 0)for(V.row=0;M(V.row,V.col);)V.row++;N[q.id()]=V,P(V.row,V.col)}}var z=function(Q,J){var ee,ae;if(Q.locked()||Q.isParent())return!1;var ue=N[Q.id()];if(ue)ee=ue.col*b+b/2+s.x1,ae=ue.row*w+w/2+s.y1;else{for(;M(I,B);)L();ee=B*b+b/2+s.x1,ae=I*w+w/2+s.y1,P(I,B),L()}return{x:ee,y:ae}};a.layoutPositions(this,e,z)}return this};var G6={ready:function(){},stop:function(){}};function e0(t){this.options=Ce({},G6,t)}e0.prototype.run=function(){var t=this.options,e=t.eles,r=this;return t.cy,r.emit("layoutstart"),e.nodes().positions(function(){return{x:0,y:0}}),r.one("layoutready",t.ready),r.emit("layoutready"),r.one("layoutstop",t.stop),r.emit("layoutstop"),this};e0.prototype.stop=function(){return this};var K6={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function gA(t){this.options=Ce({},K6,t)}gA.prototype.run=function(){var t=this.options,e=t.eles,r=e.nodes(),n=Ct(t.positions);function a(s){if(t.positions==null)return pW(s.position());if(n)return t.positions(s);var o=t.positions[s._private.data.id];return o??null}return r.layoutPositions(this,t,function(s,o){var l=a(s);return s.locked()||l==null?!1:l}),this};var j6={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function vA(t){this.options=Ce({},j6,t)}vA.prototype.run=function(){var t=this.options,e=t.cy,r=t.eles,n=Br(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),a=function(o,l){return{x:n.x1+Math.round(Math.random()*n.w),y:n.y1+Math.round(Math.random()*n.h)}};return r.nodes().layoutPositions(this,t,a),this};var Y6=[{name:"breadthfirst",impl:lA},{name:"circle",impl:uA},{name:"concentric",impl:cA},{name:"cose",impl:Ah},{name:"grid",impl:pA},{name:"null",impl:e0},{name:"preset",impl:gA},{name:"random",impl:vA}];function mA(t){this.options=t,this.notifications=0}var BT=function(){},LT=function(){throw new Error("A headless instance can not render images")};mA.prototype={recalculateRenderedStyle:BT,notify:function(){this.notifications++},init:BT,isHeadless:function(){return!0},png:LT,jpg:LT};var t0={};t0.arrowShapeWidth=.3;t0.registerArrowShapes=function(){var t=this.arrowShapes={},e=this,r=function(c,f,h,d,p,g,m){var v=p.x-h/2-m,y=p.x+h/2+m,b=p.y-h/2-m,w=p.y+h/2+m,_=v<=c&&c<=y&&b<=f&&f<=w;return _},n=function(c,f,h,d,p){var g=c*Math.cos(d)-f*Math.sin(d),m=c*Math.sin(d)+f*Math.cos(d),v=g*h,y=m*h,b=v+p.x,w=y+p.y;return{x:b,y:w}},a=function(c,f,h,d){for(var p=[],g=0;g<c.length;g+=2){var m=c[g],v=c[g+1];p.push(n(m,v,f,h,d))}return p},s=function(c){for(var f=[],h=0;h<c.length;h++){var d=c[h];f.push(d.x,d.y)}return f},o=function(c){return c.pstyle("width").pfValue*c.pstyle("arrow-scale").pfValue*2},l=function(c,f){_e(f)&&(f=t[f]),t[c]=Ce({name:c,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(d,p,g,m,v,y){var b=s(a(this.points,g+2*y,m,v)),w=Or(d,p,b);return w},roughCollide:r,draw:function(d,p,g,m){var v=a(this.points,p,g,m);e.arrowShapeImpl("polygon")(d,v)},spacing:function(d){return 0},gap:o},f)};l("none",{collide:rh,roughCollide:rh,draw:Vy,spacing:QS,gap:QS}),l("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),l("arrow","triangle"),l("triangle-backcurve",{points:t.triangle.points,controlPoint:[0,-.15],roughCollide:r,draw:function(c,f,h,d,p){var g=a(this.points,f,h,d),m=this.controlPoint,v=n(m[0],m[1],f,h,d);e.arrowShapeImpl(this.name)(c,g,v)},gap:function(c){return o(c)*.8}}),l("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(c,f,h,d,p,g,m){var v=s(a(this.points,h+2*m,d,p)),y=s(a(this.pointsTee,h+2*m,d,p)),b=Or(c,f,v)||Or(c,f,y);return b},draw:function(c,f,h,d,p){var g=a(this.points,f,h,d),m=a(this.pointsTee,f,h,d);e.arrowShapeImpl(this.name)(c,g,m)}}),l("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(c,f,h,d,p,g,m){var v=p,y=Math.pow(v.x-c,2)+Math.pow(v.y-f,2)<=Math.pow((h+2*m)*this.radius,2),b=s(a(this.points,h+2*m,d,p));return Or(c,f,b)||y},draw:function(c,f,h,d,p){var g=a(this.pointsTr,f,h,d);e.arrowShapeImpl(this.name)(c,g,d.x,d.y,this.radius*f)},spacing:function(c){return e.getArrowWidth(c.pstyle("width").pfValue,c.pstyle("arrow-scale").value)*this.radius}}),l("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(c,f){var h=this.baseCrossLinePts.slice(),d=f/c,p=3,g=5;return h[p]=h[p]-d,h[g]=h[g]-d,h},collide:function(c,f,h,d,p,g,m){var v=s(a(this.points,h+2*m,d,p)),y=s(a(this.crossLinePts(h,g),h+2*m,d,p)),b=Or(c,f,v)||Or(c,f,y);return b},draw:function(c,f,h,d,p){var g=a(this.points,f,h,d),m=a(this.crossLinePts(f,p),f,h,d);e.arrowShapeImpl(this.name)(c,g,m)}}),l("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(c){return o(c)*.525}}),l("circle",{radius:.15,collide:function(c,f,h,d,p,g,m){var v=p,y=Math.pow(v.x-c,2)+Math.pow(v.y-f,2)<=Math.pow((h+2*m)*this.radius,2);return y},draw:function(c,f,h,d,p){e.arrowShapeImpl(this.name)(c,d.x,d.y,this.radius*f)},spacing:function(c){return e.getArrowWidth(c.pstyle("width").pfValue,c.pstyle("arrow-scale").value)*this.radius}}),l("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(c){return 1},gap:function(c){return 1}}),l("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),l("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(c){return c.pstyle("width").pfValue*c.pstyle("arrow-scale").value}}),l("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(c){return .95*c.pstyle("width").pfValue*c.pstyle("arrow-scale").value}})};var Va={};Va.projectIntoViewport=function(t,e){var r=this.cy,n=this.findContainerClientCoords(),a=n[0],s=n[1],o=n[4],l=r.pan(),u=r.zoom(),c=((t-a)/o-l.x)/u,f=((e-s)/o-l.y)/u;return[c,f]};Va.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var t=this.container,e=t.getBoundingClientRect(),r=this.cy.window().getComputedStyle(t),n=function(y){return parseFloat(r.getPropertyValue(y))},a={left:n("padding-left"),right:n("padding-right"),top:n("padding-top"),bottom:n("padding-bottom")},s={left:n("border-left-width"),right:n("border-right-width"),top:n("border-top-width"),bottom:n("border-bottom-width")},o=t.clientWidth,l=t.clientHeight,u=a.left+a.right,c=a.top+a.bottom,f=s.left+s.right,h=e.width/(o+f),d=o-u,p=l-c,g=e.left+a.left+s.left,m=e.top+a.top+s.top;return this.containerBB=[g,m,d,p,h]};Va.invalidateContainerClientCoordsCache=function(){this.containerBB=null};Va.findNearestElement=function(t,e,r,n){return this.findNearestElements(t,e,r,n)[0]};Va.findNearestElements=function(t,e,r,n){var a=this,s=this,o=s.getCachedZSortedEles(),l=[],u=s.cy.zoom(),c=s.cy.hasCompoundNodes(),f=(n?24:8)/u,h=(n?8:2)/u,d=(n?8:2)/u,p=1/0,g,m;r&&(o=o.interactive);function v(E,A){if(E.isNode()){if(m)return;m=E,l.push(E)}if(E.isEdge()&&(A==null||A<p))if(g){if(g.pstyle("z-compound-depth").value===E.pstyle("z-compound-depth").value&&g.pstyle("z-compound-depth").value===E.pstyle("z-compound-depth").value){for(var T=0;T<l.length;T++)if(l[T].isEdge()){l[T]=E,g=E,p=A??p;break}}}else l.push(E),g=E,p=A??p}function y(E){var A=E.outerWidth()+2*h,T=E.outerHeight()+2*h,D=A/2,k=T/2,M=E.position(),P=E.pstyle("corner-radius").value==="auto"?"auto":E.pstyle("corner-radius").pfValue,I=E._private.rscratch;if(M.x-D<=t&&t<=M.x+D&&M.y-k<=e&&e<=M.y+k){var B=s.nodeShapes[a.getNodeShape(E)];if(B.checkPoint(t,e,0,A,T,M.x,M.y,P,I))return v(E,0),!0}}function b(E){var A=E._private,T=A.rscratch,D=E.pstyle("width").pfValue,k=E.pstyle("arrow-scale").value,M=D/2+f,P=M*M,I=M*2,F=A.source,q=A.target,B;if(T.edgeType==="segments"||T.edgeType==="straight"||T.edgeType==="haystack"){for(var L=T.allpts,N=0;N+3<L.length;N+=2)if(AW(t,e,L[N],L[N+1],L[N+2],L[N+3],I)&&P>(B=OW(t,e,L[N],L[N+1],L[N+2],L[N+3])))return v(E,B),!0}else if(T.edgeType==="bezier"||T.edgeType==="multibezier"||T.edgeType==="self"||T.edgeType==="compound"){for(var L=T.allpts,N=0;N+5<T.allpts.length;N+=4)if(MW(t,e,L[N],L[N+1],L[N+2],L[N+3],L[N+4],L[N+5],I)&&P>(B=DW(t,e,L[N],L[N+1],L[N+2],L[N+3],L[N+4],L[N+5])))return v(E,B),!0}for(var F=F||A.source,q=q||A.target,H=a.getArrowWidth(D,k),V=[{name:"source",x:T.arrowStartX,y:T.arrowStartY,angle:T.srcArrowAngle},{name:"target",x:T.arrowEndX,y:T.arrowEndY,angle:T.tgtArrowAngle},{name:"mid-source",x:T.midX,y:T.midY,angle:T.midsrcArrowAngle},{name:"mid-target",x:T.midX,y:T.midY,angle:T.midtgtArrowAngle}],N=0;N<V.length;N++){var z=V[N],Y=s.arrowShapes[E.pstyle(z.name+"-arrow-shape").value],Q=E.pstyle("width").pfValue;if(Y.roughCollide(t,e,H,z.angle,{x:z.x,y:z.y},Q,f)&&Y.collide(t,e,H,z.angle,{x:z.x,y:z.y},Q,f))return v(E),!0}c&&l.length>0&&(y(F),y(q))}function w(E,A,T){return Dr(E,A,T)}function _(E,A){var T=E._private,D=d,k;A?k=A+"-":k="",E.boundingBox();var M=T.labelBounds[A||"main"],P=E.pstyle(k+"label").value,I=E.pstyle("text-events").strValue==="yes";if(!(!I||!P)){var B=w(T.rscratch,"labelX",A),L=w(T.rscratch,"labelY",A),N=w(T.rscratch,"labelAngle",A),F=E.pstyle(k+"text-margin-x").pfValue,q=E.pstyle(k+"text-margin-y").pfValue,H=M.x1-D-F,V=M.x2+D-F,z=M.y1-D-q,Y=M.y2+D-q;if(N){var Q=Math.cos(N),J=Math.sin(N),ee=function(se,fe){return se=se-B,fe=fe-L,{x:se*Q-fe*J+B,y:se*J+fe*Q+L}},ae=ee(H,z),ue=ee(H,Y),re=ee(V,z),U=ee(V,Y),G=[ae.x+F,ae.y+q,re.x+F,re.y+q,U.x+F,U.y+q,ue.x+F,ue.y+q];if(Or(t,e,G))return v(E),!0}else if(Ws(M,t,e))return v(E),!0}}for(var x=o.length-1;x>=0;x--){var S=o[x];S.isNode()?y(S)||_(S):b(S)||_(S)||_(S,"source")||_(S,"target")}return l};Va.getAllInBox=function(t,e,r,n){var a=this.getCachedZSortedEles().interactive,s=this.cy.zoom(),o=2/s,l=[],u=Math.min(t,r),c=Math.max(t,r),f=Math.min(e,n),h=Math.max(e,n);t=u,r=c,e=f,n=h;var d=Br({x1:t,y1:e,x2:r,y2:n});function p(P,I,B){return Dr(P,I,B)}function g(P,I){var B=P._private,L=o,N="";P.boundingBox();var F=B.labelBounds.main,q=p(B.rscratch,"labelX",I),H=p(B.rscratch,"labelY",I),V=p(B.rscratch,"labelAngle",I),z=P.pstyle(N+"text-margin-x").pfValue,Y=P.pstyle(N+"text-margin-y").pfValue,Q=F.x1-L-z,J=F.x2+L-z,ee=F.y1-L-Y,ae=F.y2+L-Y;if(V){var ue=Math.cos(V),re=Math.sin(V),U=function(j,se){return j=j-q,se=se-H,{x:j*ue-se*re+q,y:j*re+se*ue+H}};return[U(Q,ee),U(J,ee),U(J,ae),U(Q,ae)]}else return[{x:Q,y:ee},{x:J,y:ee},{x:J,y:ae},{x:Q,y:ae}]}for(var m=0;m<a.length;m++){var v=a[m];if(v.isNode()){var y=v,b=y.pstyle("text-events").strValue==="yes",w=y.pstyle("box-select-labels").strValue==="yes",_=y.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:w&&b});if(Wy(d,_)){var x=g(y),S=[{x:d.x1,y:d.y1},{x:d.x2,y:d.y1},{x:d.x2,y:d.y2},{x:d.x1,y:d.y2}];FW(x,S)&&l.push(y)}}else{var E=v,A=E._private,T=A.rscratch;if(T.startX!=null&&T.startY!=null&&!Ws(d,T.startX,T.startY)||T.endX!=null&&T.endY!=null&&!Ws(d,T.endX,T.endY))continue;if(T.edgeType==="bezier"||T.edgeType==="multibezier"||T.edgeType==="self"||T.edgeType==="compound"||T.edgeType==="segments"||T.edgeType==="haystack"){for(var D=A.rstyle.bezierPts||A.rstyle.linePts||A.rstyle.haystackPts,k=!0,M=0;M<D.length;M++)if(!TW(d,D[M])){k=!1;break}k&&l.push(E)}else(T.edgeType==="haystack"||T.edgeType==="straight")&&l.push(E)}}return l};var uh={};uh.calculateArrowAngles=function(t){var e=t._private.rscratch,r=e.edgeType==="haystack",n=e.edgeType==="bezier",a=e.edgeType==="multibezier",s=e.edgeType==="segments",o=e.edgeType==="compound",l=e.edgeType==="self",u,c,f,h,d,p,y,b;if(r?(f=e.haystackPts[0],h=e.haystackPts[1],d=e.haystackPts[2],p=e.haystackPts[3]):(f=e.arrowStartX,h=e.arrowStartY,d=e.arrowEndX,p=e.arrowEndY),y=e.midX,b=e.midY,s)u=f-e.segpts[0],c=h-e.segpts[1];else if(a||o||l||n){var g=e.allpts,m=Yt(g[0],g[2],g[4],.1),v=Yt(g[1],g[3],g[5],.1);u=f-m,c=h-v}else u=f-y,c=h-b;e.srcArrowAngle=Rf(u,c);var y=e.midX,b=e.midY;if(r&&(y=(f+d)/2,b=(h+p)/2),u=d-f,c=p-h,s){var g=e.allpts;if(g.length/2%2===0){var w=g.length/2,_=w-2;u=g[w]-g[_],c=g[w+1]-g[_+1]}else if(e.isRound)u=e.midVector[1],c=-e.midVector[0];else{var w=g.length/2-1,_=w-2;u=g[w]-g[_],c=g[w+1]-g[_+1]}}else if(a||o||l){var g=e.allpts,x=e.ctrlpts,S,E,A,T;if(x.length/2%2===0){var D=g.length/2-1,k=D+2,M=k+2;S=Yt(g[D],g[k],g[M],0),E=Yt(g[D+1],g[k+1],g[M+1],0),A=Yt(g[D],g[k],g[M],1e-4),T=Yt(g[D+1],g[k+1],g[M+1],1e-4)}else{var k=g.length/2-1,D=k-2,M=k+2;S=Yt(g[D],g[k],g[M],.4999),E=Yt(g[D+1],g[k+1],g[M+1],.4999),A=Yt(g[D],g[k],g[M],.5),T=Yt(g[D+1],g[k+1],g[M+1],.5)}u=A-S,c=T-E}if(e.midtgtArrowAngle=Rf(u,c),e.midDispX=u,e.midDispY=c,u*=-1,c*=-1,s){var g=e.allpts;if(g.length/2%2!==0){if(!e.isRound){var w=g.length/2-1,P=w+2;u=-(g[P]-g[w]),c=-(g[P+1]-g[w+1])}}}if(e.midsrcArrowAngle=Rf(u,c),s)u=d-e.segpts[e.segpts.length-2],c=p-e.segpts[e.segpts.length-1];else if(a||o||l||n){var g=e.allpts,I=g.length,m=Yt(g[I-6],g[I-4],g[I-2],.9),v=Yt(g[I-5],g[I-3],g[I-1],.9);u=d-m,c=p-v}else u=d-y,c=p-b;e.tgtArrowAngle=Rf(u,c)};uh.getArrowWidth=uh.getArrowHeight=function(t,e){var r=this.arrowWidthCache=this.arrowWidthCache||{},n=r[t+", "+e];return n||(n=Math.max(Math.pow(t*13.37,.9),29)*e,r[t+", "+e]=n,n)};var Ty,ky,In={},Qr={},NT,FT,Da,Xf,Jn,Ca,Pa,Dn,Ds,qf,yA,bA,Ay,My,qT,VT=function(e,r,n){n.x=r.x-e.x,n.y=r.y-e.y,n.len=Math.sqrt(n.x*n.x+n.y*n.y),n.nx=n.x/n.len,n.ny=n.y/n.len,n.ang=Math.atan2(n.ny,n.nx)},Z6=function(e,r){r.x=e.x*-1,r.y=e.y*-1,r.nx=e.nx*-1,r.ny=e.ny*-1,r.ang=e.ang>0?-(Math.PI-e.ang):Math.PI+e.ang},X6=function(e,r,n,a,s){if(e!==qT?VT(r,e,In):Z6(Qr,In),VT(r,n,Qr),NT=In.nx*Qr.ny-In.ny*Qr.nx,FT=In.nx*Qr.nx-In.ny*-Qr.ny,Jn=Math.asin(Math.max(-1,Math.min(1,NT))),Math.abs(Jn)<1e-6){Ty=r.x,ky=r.y,Pa=Ds=0;return}Da=1,Xf=!1,FT<0?Jn<0?Jn=Math.PI+Jn:(Jn=Math.PI-Jn,Da=-1,Xf=!0):Jn>0&&(Da=-1,Xf=!0),r.radius!==void 0?Ds=r.radius:Ds=a,Ca=Jn/2,qf=Math.min(In.len/2,Qr.len/2),s?(Dn=Math.abs(Math.cos(Ca)*Ds/Math.sin(Ca)),Dn>qf?(Dn=qf,Pa=Math.abs(Dn*Math.sin(Ca)/Math.cos(Ca))):Pa=Ds):(Dn=Math.min(qf,Ds),Pa=Math.abs(Dn*Math.sin(Ca)/Math.cos(Ca))),Ay=r.x+Qr.nx*Dn,My=r.y+Qr.ny*Dn,Ty=Ay-Qr.ny*Pa*Da,ky=My+Qr.nx*Pa*Da,yA=r.x+In.nx*Dn,bA=r.y+In.ny*Dn,qT=r};function wA(t,e){e.radius===0?t.lineTo(e.cx,e.cy):t.arc(e.cx,e.cy,e.radius,e.startAngle,e.endAngle,e.counterClockwise)}function r0(t,e,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return n===0||e.radius===0?{cx:e.x,cy:e.y,radius:0,startX:e.x,startY:e.y,stopX:e.x,stopY:e.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(X6(t,e,r,n,a),{cx:Ty,cy:ky,radius:Pa,startX:yA,startY:bA,stopX:Ay,stopY:My,startAngle:In.ang+Math.PI/2*Da,endAngle:Qr.ang-Math.PI/2*Da,counterClockwise:Xf})}var Wl=.01,$6=Math.sqrt(2*Wl),vr={};vr.findMidptPtsEtc=function(t,e){var r=e.posPts,n=e.intersectionPts,a=e.vectorNormInverse,s,o=t.pstyle("source-endpoint"),l=t.pstyle("target-endpoint"),u=o.units!=null&&l.units!=null,c=function(x,S,E,A){var T=A-S,D=E-x,k=Math.sqrt(D*D+T*T);return{x:-T/k,y:D/k}},f=t.pstyle("edge-distances").value;switch(f){case"node-position":s=r;break;case"intersection":s=n;break;case"endpoints":{if(u){var h=this.manualEndptToPx(t.source()[0],o),d=zt(h,2),p=d[0],g=d[1],m=this.manualEndptToPx(t.target()[0],l),v=zt(m,2),y=v[0],b=v[1],w={x1:p,y1:g,x2:y,y2:b};a=c(p,g,y,b),s=w}else st("Edge ".concat(t.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),s=n;break}}return{midptPts:s,vectorNormInverse:a}};vr.findHaystackPoints=function(t){for(var e=0;e<t.length;e++){var r=t[e],n=r._private,a=n.rscratch;if(!a.haystack){var s=Math.random()*2*Math.PI;a.source={x:Math.cos(s),y:Math.sin(s)},s=Math.random()*2*Math.PI,a.target={x:Math.cos(s),y:Math.sin(s)}}var o=n.source,l=n.target,u=o.position(),c=l.position(),f=o.width(),h=l.width(),d=o.height(),p=l.height(),g=r.pstyle("haystack-radius").value,m=g/2;a.haystackPts=a.allpts=[a.source.x*f*m+u.x,a.source.y*d*m+u.y,a.target.x*h*m+c.x,a.target.y*p*m+c.y],a.midX=(a.allpts[0]+a.allpts[2])/2,a.midY=(a.allpts[1]+a.allpts[3])/2,a.edgeType="haystack",a.haystack=!0,this.storeEdgeProjections(r),this.calculateArrowAngles(r),this.recalculateEdgeLabelProjections(r),this.calculateLabelAngles(r)}};vr.findSegmentsPoints=function(t,e){var r=t._private.rscratch,n=t.pstyle("segment-weights"),a=t.pstyle("segment-distances"),s=t.pstyle("segment-radii"),o=t.pstyle("radius-type"),l=Math.min(n.pfValue.length,a.pfValue.length),u=s.pfValue[s.pfValue.length-1],c=o.pfValue[o.pfValue.length-1];r.edgeType="segments",r.segpts=[],r.radii=[],r.isArcRadius=[];for(var f=0;f<l;f++){var h=n.pfValue[f],d=a.pfValue[f],p=1-h,g=h,m=this.findMidptPtsEtc(t,e),v=m.midptPts,y=m.vectorNormInverse,b={x:v.x1*p+v.x2*g,y:v.y1*p+v.y2*g};r.segpts.push(b.x+y.x*d,b.y+y.y*d),r.radii.push(s.pfValue[f]!==void 0?s.pfValue[f]:u),r.isArcRadius.push((o.pfValue[f]!==void 0?o.pfValue[f]:c)==="arc-radius")}};vr.findLoopPoints=function(t,e,r,n){var a=t._private.rscratch,s=e.dirCounts,o=e.srcPos,l=t.pstyle("control-point-distances"),u=l?l.pfValue[0]:void 0,c=t.pstyle("loop-direction").pfValue,f=t.pstyle("loop-sweep").pfValue,h=t.pstyle("control-point-step-size").pfValue;a.edgeType="self";var d=r,p=h;n&&(d=0,p=u);var g=c-Math.PI/2,m=g-f/2,v=g+f/2,y=c+"_"+f;d=s[y]===void 0?s[y]=0:++s[y],a.ctrlpts=[o.x+Math.cos(m)*1.4*p*(d/3+1),o.y+Math.sin(m)*1.4*p*(d/3+1),o.x+Math.cos(v)*1.4*p*(d/3+1),o.y+Math.sin(v)*1.4*p*(d/3+1)]};vr.findCompoundLoopPoints=function(t,e,r,n){var a=t._private.rscratch;a.edgeType="compound";var s=e.srcPos,o=e.tgtPos,l=e.srcW,u=e.srcH,c=e.tgtW,f=e.tgtH,h=t.pstyle("control-point-step-size").pfValue,d=t.pstyle("control-point-distances"),p=d?d.pfValue[0]:void 0,g=r,m=h;n&&(g=0,m=p);var v=50,y={x:s.x-l/2,y:s.y-u/2},b={x:o.x-c/2,y:o.y-f/2},w={x:Math.min(y.x,b.x),y:Math.min(y.y,b.y)},_=.5,x=Math.max(_,Math.log(l*Wl)),S=Math.max(_,Math.log(c*Wl));a.ctrlpts=[w.x,w.y-(1+Math.pow(v,1.12)/100)*m*(g/3+1)*x,w.x-(1+Math.pow(v,1.12)/100)*m*(g/3+1)*S,w.y]};vr.findStraightEdgePoints=function(t){t._private.rscratch.edgeType="straight"};vr.findBezierPoints=function(t,e,r,n,a){var s=t._private.rscratch,o=t.pstyle("control-point-step-size").pfValue,l=t.pstyle("control-point-distances"),u=t.pstyle("control-point-weights"),c=l&&u?Math.min(l.value.length,u.value.length):1,f=l?l.pfValue[0]:void 0,h=u.value[0],d=n;s.edgeType=d?"multibezier":"bezier",s.ctrlpts=[];for(var p=0;p<c;p++){var g=(.5-e.eles.length/2+r)*o*(a?-1:1),m=void 0,v=Uy(g);d&&(f=l?l.pfValue[p]:o,h=u.value[p]),n?m=f:m=f!==void 0?v*f:void 0;var y=m!==void 0?m:g,b=1-h,w=h,_=this.findMidptPtsEtc(t,e),x=_.midptPts,S=_.vectorNormInverse,E={x:x.x1*b+x.x2*w,y:x.y1*b+x.y2*w};s.ctrlpts.push(E.x+S.x*y,E.y+S.y*y)}};vr.findTaxiPoints=function(t,e){var r=t._private.rscratch;r.edgeType="segments";var n="vertical",a="horizontal",s="leftward",o="rightward",l="downward",u="upward",c="auto",f=e.posPts,h=e.srcW,d=e.srcH,p=e.tgtW,g=e.tgtH,m=t.pstyle("edge-distances").value,v=m!=="node-position",y=t.pstyle("taxi-direction").value,b=y,w=t.pstyle("taxi-turn"),_=w.units==="%",x=w.pfValue,S=x<0,E=t.pstyle("taxi-turn-min-distance").pfValue,A=v?(h+p)/2:0,T=v?(d+g)/2:0,D=f.x2-f.x1,k=f.y2-f.y1,M=function(R,K){return R>0?Math.max(R-K,0):Math.min(R+K,0)},P=M(D,A),I=M(k,T),B=!1;b===c?y=Math.abs(P)>Math.abs(I)?a:n:b===u||b===l?(y=n,B=!0):(b===s||b===o)&&(y=a,B=!0);var L=y===n,N=L?I:P,F=L?k:D,q=Uy(F),H=!1;!(B&&(_||S))&&(b===l&&F<0||b===u&&F>0||b===s&&F>0||b===o&&F<0)&&(q*=-1,N=q*Math.abs(N),H=!0);var V;if(_){var z=x<0?1+x:x;V=z*N}else{var Y=x<0?N:0;V=Y+x*q}var Q=function(R){return Math.abs(R)<E||Math.abs(R)>=Math.abs(N)},J=Q(V),ee=Q(Math.abs(N)-Math.abs(V)),ae=J||ee;if(ae&&!H)if(L){var ue=Math.abs(F)<=d/2,re=Math.abs(D)<=p/2;if(ue){var U=(f.x1+f.x2)/2,G=f.y1,j=f.y2;r.segpts=[U,G,U,j]}else if(re){var se=(f.y1+f.y2)/2,fe=f.x1,Pe=f.x2;r.segpts=[fe,se,Pe,se]}else r.segpts=[f.x1,f.y2]}else{var wt=Math.abs(F)<=h/2,ot=Math.abs(k)<=g/2;if(wt){var pe=(f.y1+f.y2)/2,ge=f.x1,Ee=f.x2;r.segpts=[ge,pe,Ee,pe]}else if(ot){var Te=(f.x1+f.x2)/2,Se=f.y1,Ae=f.y2;r.segpts=[Te,Se,Te,Ae]}else r.segpts=[f.x2,f.y1]}else if(L){var De=f.y1+V+(v?d/2*q:0),Ye=f.x1,ft=f.x2;r.segpts=[Ye,De,ft,De]}else{var Tt=f.x1+V+(v?h/2*q:0),Je=f.y1,Dt=f.y2;r.segpts=[Tt,Je,Tt,Dt]}if(r.isRound){var Xe=t.pstyle("taxi-radius").value,be=t.pstyle("radius-type").value[0]==="arc-radius";r.radii=new Array(r.segpts.length/2).fill(Xe),r.isArcRadius=new Array(r.segpts.length/2).fill(be)}};vr.tryToCorrectInvalidPoints=function(t,e){var r=t._private.rscratch;if(r.edgeType==="bezier"){var n=e.srcPos,a=e.tgtPos,s=e.srcW,o=e.srcH,l=e.tgtW,u=e.tgtH,c=e.srcShape,f=e.tgtShape,h=e.srcCornerRadius,d=e.tgtCornerRadius,p=e.srcRs,g=e.tgtRs,m=!le(r.startX)||!le(r.startY),v=!le(r.arrowStartX)||!le(r.arrowStartY),y=!le(r.endX)||!le(r.endY),b=!le(r.arrowEndX)||!le(r.arrowEndY),w=3,_=this.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.arrowShapeWidth,x=w*_,S=Ba({x:r.ctrlpts[0],y:r.ctrlpts[1]},{x:r.startX,y:r.startY}),E=S<x,A=Ba({x:r.ctrlpts[0],y:r.ctrlpts[1]},{x:r.endX,y:r.endY}),T=A<x,D=!1;if(m||v||E){D=!0;var k={x:r.ctrlpts[0]-n.x,y:r.ctrlpts[1]-n.y},M=Math.sqrt(k.x*k.x+k.y*k.y),P={x:k.x/M,y:k.y/M},I=Math.max(s,o),B={x:r.ctrlpts[0]+P.x*2*I,y:r.ctrlpts[1]+P.y*2*I},L=c.intersectLine(n.x,n.y,s,o,B.x,B.y,0,h,p);E?(r.ctrlpts[0]=r.ctrlpts[0]+P.x*(x-S),r.ctrlpts[1]=r.ctrlpts[1]+P.y*(x-S)):(r.ctrlpts[0]=L[0]+P.x*x,r.ctrlpts[1]=L[1]+P.y*x)}if(y||b||T){D=!0;var N={x:r.ctrlpts[0]-a.x,y:r.ctrlpts[1]-a.y},F=Math.sqrt(N.x*N.x+N.y*N.y),q={x:N.x/F,y:N.y/F},H=Math.max(s,o),V={x:r.ctrlpts[0]+q.x*2*H,y:r.ctrlpts[1]+q.y*2*H},z=f.intersectLine(a.x,a.y,l,u,V.x,V.y,0,d,g);T?(r.ctrlpts[0]=r.ctrlpts[0]+q.x*(x-A),r.ctrlpts[1]=r.ctrlpts[1]+q.y*(x-A)):(r.ctrlpts[0]=z[0]+q.x*x,r.ctrlpts[1]=z[1]+q.y*x)}D&&this.findEndpoints(t)}};vr.storeAllpts=function(t){var e=t._private.rscratch;if(e.edgeType==="multibezier"||e.edgeType==="bezier"||e.edgeType==="self"||e.edgeType==="compound"){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var r=0;r+1<e.ctrlpts.length;r+=2)e.allpts.push(e.ctrlpts[r],e.ctrlpts[r+1]),r+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[r]+e.ctrlpts[r+2])/2,(e.ctrlpts[r+1]+e.ctrlpts[r+3])/2);e.allpts.push(e.endX,e.endY);var n,a;e.ctrlpts.length/2%2===0?(n=e.allpts.length/2-1,e.midX=e.allpts[n],e.midY=e.allpts[n+1]):(n=e.allpts.length/2-3,a=.5,e.midX=Yt(e.allpts[n],e.allpts[n+2],e.allpts[n+4],a),e.midY=Yt(e.allpts[n+1],e.allpts[n+3],e.allpts[n+5],a))}else if(e.edgeType==="straight")e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if(e.edgeType==="segments"){if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.isRound){e.roundCorners=[];for(var s=2;s+3<e.allpts.length;s+=2){var o=e.radii[s/2-1],l=e.isArcRadius[s/2-1];e.roundCorners.push(r0({x:e.allpts[s-2],y:e.allpts[s-1]},{x:e.allpts[s],y:e.allpts[s+1],radius:o},{x:e.allpts[s+2],y:e.allpts[s+3]},o,l))}}if(e.segpts.length%4===0){var u=e.segpts.length/2,c=u-2;e.midX=(e.segpts[c]+e.segpts[u])/2,e.midY=(e.segpts[c+1]+e.segpts[u+1])/2}else{var f=e.segpts.length/2-1;if(!e.isRound)e.midX=e.segpts[f],e.midY=e.segpts[f+1];else{var h={x:e.segpts[f],y:e.segpts[f+1]},d=e.roundCorners[f/2];if(d.radius===0){var p={x:e.segpts[f+2],y:e.segpts[f+3]};e.midX=h.x,e.midY=h.y,e.midVector=[h.y-p.y,p.x-h.x]}else{var g=[h.x-d.cx,h.y-d.cy],m=d.radius/Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2));g=g.map(function(v){return v*m}),e.midX=d.cx+g[0],e.midY=d.cy+g[1],e.midVector=g}}}}};vr.checkForInvalidEdgeWarning=function(t){var e=t[0]._private.rscratch;e.nodesOverlap||le(e.startX)&&le(e.startY)&&le(e.endX)&&le(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,st("Edge `"+t.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};vr.findEdgeControlPoints=function(t){var e=this;if(!(!t||t.length===0)){for(var r=this,n=r.cy,a=n.hasCompoundNodes(),s=new ti,o=function(T,D){return[].concat(Jf(T),[D?1:0]).join("-")},l=[],u=[],c=0;c<t.length;c++){var f=t[c],h=f._private,d=f.pstyle("curve-style").value;if(!(f.removed()||!f.takesUpSpace())){if(d==="haystack"){u.push(f);continue}var p=d==="unbundled-bezier"||d.endsWith("segments")||d==="straight"||d==="straight-triangle"||d.endsWith("taxi"),g=d==="unbundled-bezier"||d==="bezier",m=h.source,v=h.target,y=m.poolIndex(),b=v.poolIndex(),w=[y,b].sort(),_=o(w,p),x=s.get(_);x==null&&(x={eles:[]},l.push({pairId:w,edgeIsUnbundled:p}),s.set(_,x)),x.eles.push(f),p&&(x.hasUnbundled=!0),g&&(x.hasBezier=!0)}}for(var S=function(){var T=l[E],D=T.pairId,k=T.edgeIsUnbundled,M=o(D,k),P=s.get(M),I;if(!P.hasUnbundled){var B=P.eles[0].parallelEdges().filter(function(be){return be.isBundledBezier()});zy(P.eles),B.forEach(function(be){return P.eles.push(be)}),P.eles.sort(function(be,te){return be.poolIndex()-te.poolIndex()})}var L=P.eles[0],N=L.source(),F=L.target();if(N.poolIndex()>F.poolIndex()){var q=N;N=F,F=q}var H=P.srcPos=N.position(),V=P.tgtPos=F.position(),z=P.srcW=N.outerWidth(),Y=P.srcH=N.outerHeight(),Q=P.tgtW=F.outerWidth(),J=P.tgtH=F.outerHeight(),ee=P.srcShape=r.nodeShapes[e.getNodeShape(N)],ae=P.tgtShape=r.nodeShapes[e.getNodeShape(F)],ue=P.srcCornerRadius=N.pstyle("corner-radius").value==="auto"?"auto":N.pstyle("corner-radius").pfValue,re=P.tgtCornerRadius=F.pstyle("corner-radius").value==="auto"?"auto":F.pstyle("corner-radius").pfValue,U=P.tgtRs=F._private.rscratch,G=P.srcRs=N._private.rscratch;P.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var j=0;j<P.eles.length;j++){var se=P.eles[j],fe=se[0]._private.rscratch,Pe=se.pstyle("curve-style").value,wt=Pe==="unbundled-bezier"||Pe.endsWith("segments")||Pe.endsWith("taxi"),ot=!N.same(se.source());if(!P.calculatedIntersection&&N!==F&&(P.hasBezier||P.hasUnbundled)){P.calculatedIntersection=!0;var pe=ee.intersectLine(H.x,H.y,z,Y,V.x,V.y,0,ue,G),ge=P.srcIntn=pe,Ee=ae.intersectLine(V.x,V.y,Q,J,H.x,H.y,0,re,U),Te=P.tgtIntn=Ee,Se=P.intersectionPts={x1:pe[0],x2:Ee[0],y1:pe[1],y2:Ee[1]},Ae=P.posPts={x1:H.x,x2:V.x,y1:H.y,y2:V.y},De=Ee[1]-pe[1],Ye=Ee[0]-pe[0],ft=Math.sqrt(Ye*Ye+De*De);le(ft)&&ft>=$6||(ft=Math.sqrt(Math.max(Ye*Ye,Wl)+Math.max(De*De,Wl)));var Tt=P.vector={x:Ye,y:De},Je=P.vectorNorm={x:Tt.x/ft,y:Tt.y/ft},Dt={x:-Je.y,y:Je.x};P.nodesOverlap=!le(ft)||ae.checkPoint(pe[0],pe[1],0,Q,J,V.x,V.y,re,U)||ee.checkPoint(Ee[0],Ee[1],0,z,Y,H.x,H.y,ue,G),P.vectorNormInverse=Dt,I={nodesOverlap:P.nodesOverlap,dirCounts:P.dirCounts,calculatedIntersection:!0,hasBezier:P.hasBezier,hasUnbundled:P.hasUnbundled,eles:P.eles,srcPos:V,srcRs:U,tgtPos:H,tgtRs:G,srcW:Q,srcH:J,tgtW:z,tgtH:Y,srcIntn:Te,tgtIntn:ge,srcShape:ae,tgtShape:ee,posPts:{x1:Ae.x2,y1:Ae.y2,x2:Ae.x1,y2:Ae.y1},intersectionPts:{x1:Se.x2,y1:Se.y2,x2:Se.x1,y2:Se.y1},vector:{x:-Tt.x,y:-Tt.y},vectorNorm:{x:-Je.x,y:-Je.y},vectorNormInverse:{x:-Dt.x,y:-Dt.y}}}var Xe=ot?I:P;fe.nodesOverlap=Xe.nodesOverlap,fe.srcIntn=Xe.srcIntn,fe.tgtIntn=Xe.tgtIntn,fe.isRound=Pe.startsWith("round"),a&&(N.isParent()||N.isChild()||F.isParent()||F.isChild())&&(N.parents().anySame(F)||F.parents().anySame(N)||N.same(F)&&N.isParent())?e.findCompoundLoopPoints(se,Xe,j,wt):N===F?e.findLoopPoints(se,Xe,j,wt):Pe.endsWith("segments")?e.findSegmentsPoints(se,Xe):Pe.endsWith("taxi")?e.findTaxiPoints(se,Xe):Pe==="straight"||!wt&&P.eles.length%2===1&&j===Math.floor(P.eles.length/2)?e.findStraightEdgePoints(se):e.findBezierPoints(se,Xe,j,wt,ot),e.findEndpoints(se),e.tryToCorrectInvalidPoints(se,Xe),e.checkForInvalidEdgeWarning(se),e.storeAllpts(se),e.storeEdgeProjections(se),e.calculateArrowAngles(se),e.recalculateEdgeLabelProjections(se),e.calculateLabelAngles(se)}},E=0;E<l.length;E++)S();this.findHaystackPoints(u)}};function _A(t){var e=[];if(t!=null){for(var r=0;r<t.length;r+=2){var n=t[r],a=t[r+1];e.push({x:n,y:a})}return e}}vr.getSegmentPoints=function(t){var e=t[0]._private.rscratch;this.recalculateRenderedStyle(t);var r=e.edgeType;if(r==="segments")return _A(e.segpts)};vr.getControlPoints=function(t){var e=t[0]._private.rscratch;this.recalculateRenderedStyle(t);var r=e.edgeType;if(r==="bezier"||r==="multibezier"||r==="self"||r==="compound")return _A(e.ctrlpts)};vr.getEdgeMidpoint=function(t){var e=t[0]._private.rscratch;return this.recalculateRenderedStyle(t),{x:e.midX,y:e.midY}};var eu={};eu.manualEndptToPx=function(t,e){var r=this,n=t.position(),a=t.outerWidth(),s=t.outerHeight(),o=t._private.rscratch;if(e.value.length===2){var l=[e.pfValue[0],e.pfValue[1]];return e.units[0]==="%"&&(l[0]=l[0]*a),e.units[1]==="%"&&(l[1]=l[1]*s),l[0]+=n.x,l[1]+=n.y,l}else{var u=e.pfValue[0];u=-Math.PI/2+u;var c=2*Math.max(a,s),f=[n.x+Math.cos(u)*c,n.y+Math.sin(u)*c];return r.nodeShapes[this.getNodeShape(t)].intersectLine(n.x,n.y,a,s,f[0],f[1],0,t.pstyle("corner-radius").value==="auto"?"auto":t.pstyle("corner-radius").pfValue,o)}};eu.findEndpoints=function(t){var e=this,r,n=t.source()[0],a=t.target()[0],s=n.position(),o=a.position(),l=t.pstyle("target-arrow-shape").value,u=t.pstyle("source-arrow-shape").value,c=t.pstyle("target-distance-from-node").pfValue,f=t.pstyle("source-distance-from-node").pfValue,h=n._private.rscratch,d=a._private.rscratch,p=t.pstyle("curve-style").value,g=t._private.rscratch,m=g.edgeType,v=p==="taxi",y=m==="self"||m==="compound",b=m==="bezier"||m==="multibezier"||y,w=m!=="bezier",_=m==="straight"||m==="segments",x=m==="segments",S=b||w||_,E=y||v,A=t.pstyle("source-endpoint"),T=E?"outside-to-node":A.value,D=n.pstyle("corner-radius").value==="auto"?"auto":n.pstyle("corner-radius").pfValue,k=t.pstyle("target-endpoint"),M=E?"outside-to-node":k.value,P=a.pstyle("corner-radius").value==="auto"?"auto":a.pstyle("corner-radius").pfValue;g.srcManEndpt=A,g.tgtManEndpt=k;var I,B,L,N;if(b){var F=[g.ctrlpts[0],g.ctrlpts[1]],q=w?[g.ctrlpts[g.ctrlpts.length-2],g.ctrlpts[g.ctrlpts.length-1]]:F;I=q,B=F}else if(_){var H=x?g.segpts.slice(0,2):[o.x,o.y],V=x?g.segpts.slice(g.segpts.length-2):[s.x,s.y];I=V,B=H}if(M==="inside-to-node")r=[o.x,o.y];else if(k.units)r=this.manualEndptToPx(a,k);else if(M==="outside-to-line")r=g.tgtIntn;else if(M==="outside-to-node"||M==="outside-to-node-or-label"?L=I:(M==="outside-to-line"||M==="outside-to-line-or-label")&&(L=[s.x,s.y]),r=e.nodeShapes[this.getNodeShape(a)].intersectLine(o.x,o.y,a.outerWidth(),a.outerHeight(),L[0],L[1],0,P,d),M==="outside-to-node-or-label"||M==="outside-to-line-or-label"){var z=a._private.rscratch,Y=z.labelWidth,Q=z.labelHeight,J=z.labelX,ee=z.labelY,ae=Y/2,ue=Q/2,re=a.pstyle("text-valign").value;re==="top"?ee-=ue:re==="bottom"&&(ee+=ue);var U=a.pstyle("text-halign").value;U==="left"?J-=ae:U==="right"&&(J+=ae);var G=ql(L[0],L[1],[J-ae,ee-ue,J+ae,ee-ue,J+ae,ee+ue,J-ae,ee+ue],o.x,o.y);if(G.length>0){var j=s,se=Aa(j,Ls(r)),fe=Aa(j,Ls(G)),Pe=se;if(fe<se&&(r=G,Pe=fe),G.length>2){var wt=Aa(j,{x:G[2],y:G[3]});wt<Pe&&(r=[G[2],G[3]])}}}var ot=Df(r,I,e.arrowShapes[l].spacing(t)+c),pe=Df(r,I,e.arrowShapes[l].gap(t)+c);if(g.endX=pe[0],g.endY=pe[1],g.arrowEndX=ot[0],g.arrowEndY=ot[1],T==="inside-to-node")r=[s.x,s.y];else if(A.units)r=this.manualEndptToPx(n,A);else if(T==="outside-to-line")r=g.srcIntn;else if(T==="outside-to-node"||T==="outside-to-node-or-label"?N=B:(T==="outside-to-line"||T==="outside-to-line-or-label")&&(N=[o.x,o.y]),r=e.nodeShapes[this.getNodeShape(n)].intersectLine(s.x,s.y,n.outerWidth(),n.outerHeight(),N[0],N[1],0,D,h),T==="outside-to-node-or-label"||T==="outside-to-line-or-label"){var ge=n._private.rscratch,Ee=ge.labelWidth,Te=ge.labelHeight,Se=ge.labelX,Ae=ge.labelY,De=Ee/2,Ye=Te/2,ft=n.pstyle("text-valign").value;ft==="top"?Ae-=Ye:ft==="bottom"&&(Ae+=Ye);var Tt=n.pstyle("text-halign").value;Tt==="left"?Se-=De:Tt==="right"&&(Se+=De);var Je=ql(N[0],N[1],[Se-De,Ae-Ye,Se+De,Ae-Ye,Se+De,Ae+Ye,Se-De,Ae+Ye],s.x,s.y);if(Je.length>0){var Dt=o,Xe=Aa(Dt,Ls(r)),be=Aa(Dt,Ls(Je)),te=Xe;if(be<Xe&&(r=[Je[0],Je[1]],te=be),Je.length>2){var R=Aa(Dt,{x:Je[2],y:Je[3]});R<te&&(r=[Je[2],Je[3]])}}}var K=Df(r,B,e.arrowShapes[u].spacing(t)+f),Z=Df(r,B,e.arrowShapes[u].gap(t)+f);g.startX=Z[0],g.startY=Z[1],g.arrowStartX=K[0],g.arrowStartY=K[1],S&&(!le(g.startX)||!le(g.startY)||!le(g.endX)||!le(g.endY)?g.badLine=!0:g.badLine=!1)};eu.getSourceEndpoint=function(t){var e=t[0]._private.rscratch;switch(this.recalculateRenderedStyle(t),e.edgeType){case"haystack":return{x:e.haystackPts[0],y:e.haystackPts[1]};default:return{x:e.arrowStartX,y:e.arrowStartY}}};eu.getTargetEndpoint=function(t){var e=t[0]._private.rscratch;switch(this.recalculateRenderedStyle(t),e.edgeType){case"haystack":return{x:e.haystackPts[2],y:e.haystackPts[3]};default:return{x:e.arrowEndX,y:e.arrowEndY}}};var n0={};function Q6(t,e,r){for(var n=function(c,f,h,d){return Yt(c,f,h,d)},a=e._private,s=a.rstyle.bezierPts,o=0;o<t.bezierProjPcts.length;o++){var l=t.bezierProjPcts[o];s.push({x:n(r[0],r[2],r[4],l),y:n(r[1],r[3],r[5],l)})}}n0.storeEdgeProjections=function(t){var e=t._private,r=e.rscratch,n=r.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,n==="multibezier"||n==="bezier"||n==="self"||n==="compound"){e.rstyle.bezierPts=[];for(var a=0;a+5<r.allpts.length;a+=4)Q6(this,t,r.allpts.slice(a,a+6))}else if(n==="segments")for(var s=e.rstyle.linePts=[],a=0;a+1<r.allpts.length;a+=2)s.push({x:r.allpts[a],y:r.allpts[a+1]});else if(n==="haystack"){var o=r.haystackPts;e.rstyle.haystackPts=[{x:o[0],y:o[1]},{x:o[2],y:o[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.arrowShapeWidth};n0.recalculateEdgeProjections=function(t){this.findEdgeControlPoints(t)};var Nn={};Nn.recalculateNodeLabelProjection=function(t){var e=t.pstyle("label").strValue;if(!Ii(e)){var r,n,a=t._private,s=t.width(),o=t.height(),l=t.padding(),u=t.position(),c=t.pstyle("text-halign").strValue,f=t.pstyle("text-valign").strValue,h=a.rscratch,d=a.rstyle;switch(c){case"left":r=u.x-s/2-l;break;case"right":r=u.x+s/2+l;break;default:r=u.x}switch(f){case"top":n=u.y-o/2-l;break;case"bottom":n=u.y+o/2+l;break;default:n=u.y}h.labelX=r,h.labelY=n,d.labelX=r,d.labelY=n,this.calculateLabelAngles(t),this.applyLabelDimensions(t)}};var xA=function(e,r){var n=Math.atan(r/e);return e===0&&n<0&&(n=n*-1),n},EA=function(e,r){var n=r.x-e.x,a=r.y-e.y;return xA(n,a)},J6=function(e,r,n,a){var s=Fl(0,a-.001,1),o=Fl(0,a+.001,1),l=qs(e,r,n,s),u=qs(e,r,n,o);return EA(l,u)};Nn.recalculateEdgeLabelProjections=function(t){var e,r=t._private,n=r.rscratch,a=this,s={mid:t.pstyle("label").strValue,source:t.pstyle("source-label").strValue,target:t.pstyle("target-label").strValue};if(s.mid||s.source||s.target){e={x:n.midX,y:n.midY};var o=function(h,d,p){ei(r.rscratch,h,d,p),ei(r.rstyle,h,d,p)};o("labelX",null,e.x),o("labelY",null,e.y);var l=xA(n.midDispX,n.midDispY);o("labelAutoAngle",null,l);var u=function(){if(u.cache)return u.cache;for(var h=[],d=0;d+5<n.allpts.length;d+=4){var p={x:n.allpts[d],y:n.allpts[d+1]},g={x:n.allpts[d+2],y:n.allpts[d+3]},m={x:n.allpts[d+4],y:n.allpts[d+5]};h.push({p0:p,p1:g,p2:m,startDist:0,length:0,segments:[]})}var v=r.rstyle.bezierPts,y=a.bezierProjPcts.length;function b(E,A,T,D,k){var M=Ba(A,T),P=E.segments[E.segments.length-1],I={p0:A,p1:T,t0:D,t1:k,startDist:P?P.startDist+P.length:0,length:M};E.segments.push(I),E.length+=M}for(var w=0;w<h.length;w++){var _=h[w],x=h[w-1];x&&(_.startDist=x.startDist+x.length),b(_,_.p0,v[w*y],0,a.bezierProjPcts[0]);for(var S=0;S<y-1;S++)b(_,v[w*y+S],v[w*y+S+1],a.bezierProjPcts[S],a.bezierProjPcts[S+1]);b(_,v[w*y+y-1],_.p2,a.bezierProjPcts[y-1],1)}return u.cache=h},c=function(h){var d,p=h==="source";if(s[h]){var g=t.pstyle(h+"-text-offset").pfValue;switch(n.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var m=u(),v,y=0,b=0,w=0;w<m.length;w++){for(var _=m[p?w:m.length-1-w],x=0;x<_.segments.length;x++){var S=_.segments[p?x:_.segments.length-1-x],E=w===m.length-1&&x===_.segments.length-1;if(y=b,b+=S.length,b>=g||E){v={cp:_,segment:S};break}}if(v)break}var A=v.cp,T=v.segment,D=(g-y)/T.length,k=T.t1-T.t0,M=p?T.t0+k*D:T.t1-k*D;M=Fl(0,M,1),e=qs(A.p0,A.p1,A.p2,M),d=J6(A.p0,A.p1,A.p2,M);break}case"straight":case"segments":case"haystack":{for(var P=0,I,B,L,N,F=n.allpts.length,q=0;q+3<F&&(p?(L={x:n.allpts[q],y:n.allpts[q+1]},N={x:n.allpts[q+2],y:n.allpts[q+3]}):(L={x:n.allpts[F-2-q],y:n.allpts[F-1-q]},N={x:n.allpts[F-4-q],y:n.allpts[F-3-q]}),I=Ba(L,N),B=P,P+=I,!(P>=g));q+=2);var H=g-B,V=H/I;V=Fl(0,V,1),e=_W(L,N,V),d=EA(L,N);break}}o("labelX",h,e.x),o("labelY",h,e.y),o("labelAutoAngle",h,d)}};c("source"),c("target"),this.applyLabelDimensions(t)}};Nn.applyLabelDimensions=function(t){this.applyPrefixedLabelDimensions(t),t.isEdge()&&(this.applyPrefixedLabelDimensions(t,"source"),this.applyPrefixedLabelDimensions(t,"target"))};Nn.applyPrefixedLabelDimensions=function(t,e){var r=t._private,n=this.getLabelText(t,e),a=Ia(n,t._private.labelDimsKey);if(Dr(r.rscratch,"prefixedLabelDimsKey",e)!==a){ei(r.rscratch,"prefixedLabelDimsKey",e,a);var s=this.calculateLabelDimensions(t,n),o=t.pstyle("line-height").pfValue,l=t.pstyle("text-wrap").strValue,u=Dr(r.rscratch,"labelWrapCachedLines",e)||[],c=l!=="wrap"?1:Math.max(u.length,1),f=s.height/c,h=f*o,d=s.width,p=s.height+(c-1)*(o-1)*f;ei(r.rstyle,"labelWidth",e,d),ei(r.rscratch,"labelWidth",e,d),ei(r.rstyle,"labelHeight",e,p),ei(r.rscratch,"labelHeight",e,p),ei(r.rscratch,"labelLineHeight",e,h)}};Nn.getLabelText=function(t,e){var r=t._private,n=e?e+"-":"",a=t.pstyle(n+"label").strValue,s=t.pstyle("text-transform").value,o=function(Y,Q){return Q?(ei(r.rscratch,Y,e,Q),Q):Dr(r.rscratch,Y,e)};if(!a)return"";s=="none"||(s=="uppercase"?a=a.toUpperCase():s=="lowercase"&&(a=a.toLowerCase()));var l=t.pstyle("text-wrap").value;if(l==="wrap"){var u=o("labelKey");if(u!=null&&o("labelWrapKey")===u)return o("labelWrapCachedText");for(var c="\u200B",f=a.split(`
`),h=t.pstyle("text-max-width").pfValue,d=t.pstyle("text-overflow-wrap").value,p=d==="anywhere",g=[],m=/[\s\u200b]+|$/g,v=0;v<f.length;v++){var y=f[v],b=this.calculateLabelDimensions(t,y),w=b.width;if(p){var _=y.split("").join(c);y=_}if(w>h){var x=y.matchAll(m),S="",E=0,A=Ir(x),T;try{for(A.s();!(T=A.n()).done;){var D=T.value,k=D[0],M=y.substring(E,D.index);E=D.index+k.length;var P=S.length===0?M:S+M+k,I=this.calculateLabelDimensions(t,P),B=I.width;B<=h?S+=M+k:(S&&g.push(S),S=M+k)}}catch(z){A.e(z)}finally{A.f()}S.match(/^[\s\u200b]+$/)||g.push(S)}else g.push(y)}o("labelWrapCachedLines",g),a=o("labelWrapCachedText",g.join(`
`)),o("labelWrapKey",u)}else if(l==="ellipsis"){var L=t.pstyle("text-max-width").pfValue,N="",F="\u2026",q=!1;if(this.calculateLabelDimensions(t,a).width<L)return a;for(var H=0;H<a.length;H++){var V=this.calculateLabelDimensions(t,N+a[H]+F).width;if(V>L)break;N+=a[H],H===a.length-1&&(q=!0)}return q||(N+=F),N}return a};Nn.getLabelJustification=function(t){var e=t.pstyle("text-justification").strValue,r=t.pstyle("text-halign").strValue;if(e==="auto")if(t.isNode())switch(r){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return e};Nn.calculateLabelDimensions=function(t,e){var r=this,n=r.cy.window(),a=n.document,s=0,o=t.pstyle("font-style").strValue,l=t.pstyle("font-size").pfValue,u=t.pstyle("font-family").strValue,c=t.pstyle("font-weight").strValue,f=this.labelCalcCanvas,h=this.labelCalcCanvasContext;if(!f){f=this.labelCalcCanvas=a.createElement("canvas"),h=this.labelCalcCanvasContext=f.getContext("2d");var d=f.style;d.position="absolute",d.left="-9999px",d.top="-9999px",d.zIndex="-1",d.visibility="hidden",d.pointerEvents="none"}h.font="".concat(o," ").concat(c," ").concat(l,"px ").concat(u);for(var p=0,g=0,m=e.split(`
`),v=0;v<m.length;v++){var y=m[v],b=h.measureText(y),w=Math.ceil(b.width),_=l;p=Math.max(w,p),g+=_}return p+=s,g+=s,{width:p,height:g}};Nn.calculateLabelAngle=function(t,e){var r=t._private,n=r.rscratch,a=t.isEdge(),s=e?e+"-":"",o=t.pstyle(s+"text-rotation"),l=o.strValue;return l==="none"?0:a&&l==="autorotate"?n.labelAutoAngle:l==="autorotate"?0:o.pfValue};Nn.calculateLabelAngles=function(t){var e=this,r=t.isEdge(),n=t._private,a=n.rscratch;a.labelAngle=e.calculateLabelAngle(t),r&&(a.sourceLabelAngle=e.calculateLabelAngle(t,"source"),a.targetLabelAngle=e.calculateLabelAngle(t,"target"))};var SA={},zT=28,HT=!1;SA.getNodeShape=function(t){var e=this,r=t.pstyle("shape").value;if(r==="cutrectangle"&&(t.width()<zT||t.height()<zT))return HT||(st("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),HT=!0),"rectangle";if(t.isParent())return r==="rectangle"||r==="roundrectangle"||r==="round-rectangle"||r==="cutrectangle"||r==="cut-rectangle"||r==="barrel"?r:"rectangle";if(r==="polygon"){var n=t.pstyle("shape-polygon-points").value;return e.nodeShapes.makePolygon(n).name}return r};var Mh={};Mh.registerCalculationListeners=function(){var t=this.cy,e=t.collection(),r=this,n=function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.merge(o),l)for(var u=0;u<o.length;u++){var c=o[u],f=c._private,h=f.rstyle;h.clean=!1,h.cleanConnected=!1}};r.binder(t).on("bounds.* dirty.*",function(o){var l=o.target;n(l)}).on("style.* background.*",function(o){var l=o.target;n(l,!1)});var a=function(o){if(o){var l=r.onUpdateEleCalcsFns;e.cleanStyle();for(var u=0;u<e.length;u++){var c=e[u],f=c._private.rstyle;c.isNode()&&!f.cleanConnected&&(n(c.connectedEdges()),f.cleanConnected=!0)}if(l)for(var h=0;h<l.length;h++){var d=l[h];d(o,e)}r.recalculateRenderedStyle(e),e=t.collection()}};r.flushRenderedStyleQueue=function(){a(!0)},r.beforeRender(a,r.beforeRenderPriorities.eleCalcs)};Mh.onUpdateEleCalcs=function(t){var e=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];e.push(t)};Mh.recalculateRenderedStyle=function(t,e){var r=function(_){return _._private.rstyle.cleanConnected};if(t.length!==0){var n=[],a=[];if(!this.destroyed){e===void 0&&(e=!0);for(var s=0;s<t.length;s++){var o=t[s],l=o._private,u=l.rstyle;o.isEdge()&&(!r(o.source())||!r(o.target()))&&(u.clean=!1),o.isEdge()&&o.isBundledBezier()&&o.parallelEdges().some(function(w){return!w._private.rstyle.clean&&w.isBundledBezier()})&&(u.clean=!1),!(e&&u.clean||o.removed())&&o.pstyle("display").value!=="none"&&(l.group==="nodes"?a.push(o):n.push(o),u.clean=!0)}for(var c=0;c<a.length;c++){var f=a[c],h=f._private,d=h.rstyle,p=f.position();this.recalculateNodeLabelProjection(f),d.nodeX=p.x,d.nodeY=p.y,d.nodeW=f.pstyle("width").pfValue,d.nodeH=f.pstyle("height").pfValue}this.recalculateEdgeProjections(n);for(var g=0;g<n.length;g++){var m=n[g],v=m._private,y=v.rstyle,b=v.rscratch;y.srcX=b.arrowStartX,y.srcY=b.arrowStartY,y.tgtX=b.arrowEndX,y.tgtY=b.arrowEndY,y.midX=b.midX,y.midY=b.midY,y.labelAngle=b.labelAngle,y.sourceLabelAngle=b.sourceLabelAngle,y.targetLabelAngle=b.targetLabelAngle}}}};var Ph={};Ph.updateCachedGrabbedEles=function(){var t=this.cachedZSortedEles;if(t){t.drag=[],t.nondrag=[];for(var e=[],r=0;r<t.length;r++){var n=t[r],a=n._private.rscratch;n.grabbed()&&!n.isParent()?e.push(n):a.inDragLayer?t.drag.push(n):t.nondrag.push(n)}for(var r=0;r<e.length;r++){var n=e[r];t.drag.push(n)}}};Ph.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};Ph.getCachedZSortedEles=function(t){if(t||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(aA),e.interactive=e.filter(function(r){return r.interactive()}),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e};var CA={};[Va,uh,vr,eu,n0,Nn,SA,Mh,Ph].forEach(function(t){Ce(CA,t)});var TA={};TA.getCachedImage=function(t,e,r){var n=this,a=n.imageCache=n.imageCache||{},s=a[t];if(s)return s.image.complete||s.image.addEventListener("load",r),s.image;s=a[t]=a[t]||{};var o=s.image=new Image;o.addEventListener("load",r),o.addEventListener("error",function(){o.error=!0});var l="data:",u=t.substring(0,l.length).toLowerCase()===l;return u||(e=e==="null"?null:e,o.crossOrigin=e),o.src=t,o};var $s={};$s.registerBinding=function(t,e,r,n){var a=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(t)){for(var s=[],o=0;o<t.length;o++){var l=t[o];if(l!==void 0){var u=this.binder(l);s.push(u.on.apply(u,a))}}return s}var u=this.binder(t);return u.on.apply(u,a)};$s.binder=function(t){var e=this,r=e.cy.window(),n=t===r||t===r.document||t===r.document.body||pU(t);if(e.supportsPassiveEvents==null){var a=!1;try{var s=Object.defineProperty({},"passive",{get:function(){return a=!0,!0}});r.addEventListener("test",null,s)}catch{}e.supportsPassiveEvents=a}var o=function(u,c,f){var h=Array.prototype.slice.call(arguments);return n&&e.supportsPassiveEvents&&(h[2]={capture:f??!1,passive:!1,once:!1}),e.bindings.push({target:t,args:h}),(t.addEventListener||t.on).apply(t,h),this};return{on:o,addEventListener:o,addListener:o,bind:o}};$s.nodeIsDraggable=function(t){return t&&t.isNode()&&!t.locked()&&t.grabbable()};$s.nodeIsGrabbable=function(t){return this.nodeIsDraggable(t)&&t.interactive()};$s.load=function(){var t=this,e=t.cy.window(),r=function(R){return R.selected()},n=function(R){var K=R.getRootNode();if(K&&K.nodeType===11&&K.host!==void 0)return K},a=function(R,K,Z,X){R==null&&(R=t.cy);for(var $=0;$<K.length;$++){var ye=K[$];R.emit({originalEvent:Z,type:ye,position:X})}},s=function(R){return R.shiftKey||R.metaKey||R.ctrlKey},o=function(R,K){var Z=!0;if(t.cy.hasCompoundNodes()&&R&&R.pannable())for(var X=0;K&&X<K.length;X++){var R=K[X];if(R.isNode()&&R.isParent()&&!R.pannable()){Z=!1;break}}else Z=!0;return Z},l=function(R){R[0]._private.grabbed=!0},u=function(R){R[0]._private.grabbed=!1},c=function(R){R[0]._private.rscratch.inDragLayer=!0},f=function(R){R[0]._private.rscratch.inDragLayer=!1},h=function(R){R[0]._private.rscratch.isGrabTarget=!0},d=function(R){R[0]._private.rscratch.isGrabTarget=!1},p=function(R,K){var Z=K.addToList,X=Z.has(R);!X&&R.grabbable()&&!R.locked()&&(Z.merge(R),l(R))},g=function(R,K){if(R.cy().hasCompoundNodes()&&!(K.inDragLayer==null&&K.addToList==null)){var Z=R.descendants();K.inDragLayer&&(Z.forEach(c),Z.connectedEdges().forEach(c)),K.addToList&&p(Z,K)}},m=function(R,K){K=K||{};var Z=R.cy().hasCompoundNodes();K.inDragLayer&&(R.forEach(c),R.neighborhood().stdFilter(function(X){return!Z||X.isEdge()}).forEach(c)),K.addToList&&R.forEach(function(X){p(X,K)}),g(R,K),b(R,{inDragLayer:K.inDragLayer}),t.updateCachedGrabbedEles()},v=m,y=function(R){R&&(t.getCachedZSortedEles().forEach(function(K){u(K),f(K),d(K)}),t.updateCachedGrabbedEles())},b=function(R,K){if(!(K.inDragLayer==null&&K.addToList==null)&&R.cy().hasCompoundNodes()){var Z=R.ancestors().orphans();if(!Z.same(R)){var X=Z.descendants().spawnSelf().merge(Z).unmerge(R).unmerge(R.descendants()),$=X.connectedEdges();K.inDragLayer&&($.forEach(c),X.forEach(c)),K.addToList&&X.forEach(function(ye){p(ye,K)})}}},w=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},_=typeof MutationObserver<"u",x=typeof ResizeObserver<"u";_?(t.removeObserver=new MutationObserver(function(te){for(var R=0;R<te.length;R++){var K=te[R],Z=K.removedNodes;if(Z)for(var X=0;X<Z.length;X++){var $=Z[X];if($===t.container){t.destroy();break}}}}),t.container.parentNode&&t.removeObserver.observe(t.container.parentNode,{childList:!0})):t.registerBinding(t.container,"DOMNodeRemoved",function(te){t.destroy()});var S=Xl(function(){t.cy.resize()},100);_&&(t.styleObserver=new MutationObserver(S),t.styleObserver.observe(t.container,{attributes:!0})),t.registerBinding(e,"resize",S),x&&(t.resizeObserver=new ResizeObserver(S),t.resizeObserver.observe(t.container));var E=function(R,K){for(;R!=null;)K(R),R=R.parentNode},A=function(){t.invalidateContainerClientCoordsCache()};E(t.container,function(te){t.registerBinding(te,"transitionend",A),t.registerBinding(te,"animationend",A),t.registerBinding(te,"scroll",A)}),t.registerBinding(t.container,"contextmenu",function(te){te.preventDefault()});var T=function(){return t.selection[4]!==0},D=function(R){for(var K=t.findContainerClientCoords(),Z=K[0],X=K[1],$=K[2],ye=K[3],ne=R.touches?R.touches:[R],we=!1,Le=0;Le<ne.length;Le++){var Ge=ne[Le];if(Z<=Ge.clientX&&Ge.clientX<=Z+$&&X<=Ge.clientY&&Ge.clientY<=X+ye){we=!0;break}}if(!we)return!1;for(var ke=t.container,Fe=R.target,Me=Fe.parentNode,Oe=!1;Me;){if(Me===ke){Oe=!0;break}Me=Me.parentNode}return!!Oe};t.registerBinding(t.container,"mousedown",function(R){if(D(R)&&!(t.hoverData.which===1&&R.which!==1)){R.preventDefault(),w(),t.hoverData.capture=!0,t.hoverData.which=R.which;var K=t.cy,Z=[R.clientX,R.clientY],X=t.projectIntoViewport(Z[0],Z[1]),$=t.selection,ye=t.findNearestElements(X[0],X[1],!0,!1),ne=ye[0],we=t.dragData.possibleDragElements;t.hoverData.mdownPos=X,t.hoverData.mdownGPos=Z;var Le=function(){t.hoverData.tapholdCancelled=!1,clearTimeout(t.hoverData.tapholdTimeout),t.hoverData.tapholdTimeout=setTimeout(function(){if(!t.hoverData.tapholdCancelled){var lt=t.hoverData.down;lt?lt.emit({originalEvent:R,type:"taphold",position:{x:X[0],y:X[1]}}):K.emit({originalEvent:R,type:"taphold",position:{x:X[0],y:X[1]}})}},t.tapholdDuration)};if(R.which==3){t.hoverData.cxtStarted=!0;var Ge={originalEvent:R,type:"cxttapstart",position:{x:X[0],y:X[1]}};ne?(ne.activate(),ne.emit(Ge),t.hoverData.down=ne):K.emit(Ge),t.hoverData.downTime=new Date().getTime(),t.hoverData.cxtDragged=!1}else if(R.which==1){ne&&ne.activate();{if(ne!=null&&t.nodeIsGrabbable(ne)){var ke=function(lt){return{originalEvent:R,type:lt,position:{x:X[0],y:X[1]}}},Fe=function(lt){lt.emit(ke("grab"))};if(h(ne),!ne.selected())we=t.dragData.possibleDragElements=K.collection(),v(ne,{addToList:we}),ne.emit(ke("grabon")).emit(ke("grab"));else{we=t.dragData.possibleDragElements=K.collection();var Me=K.$(function(Oe){return Oe.isNode()&&Oe.selected()&&t.nodeIsGrabbable(Oe)});m(Me,{addToList:we}),ne.emit(ke("grabon")),Me.forEach(Fe)}t.redrawHint("eles",!0),t.redrawHint("drag",!0)}t.hoverData.down=ne,t.hoverData.downs=ye,t.hoverData.downTime=new Date().getTime()}a(ne,["mousedown","tapstart","vmousedown"],R,{x:X[0],y:X[1]}),ne==null?($[4]=1,t.data.bgActivePosistion={x:X[0],y:X[1]},t.redrawHint("select",!0),t.redraw()):ne.pannable()&&($[4]=1),Le()}$[0]=$[2]=X[0],$[1]=$[3]=X[1]}},!1);var k=n(t.container);t.registerBinding([e,k],"mousemove",function(R){var K=t.hoverData.capture;if(!(!K&&!D(R))){var Z=!1,X=t.cy,$=X.zoom(),ye=[R.clientX,R.clientY],ne=t.projectIntoViewport(ye[0],ye[1]),we=t.hoverData.mdownPos,Le=t.hoverData.mdownGPos,Ge=t.selection,ke=null;!t.hoverData.draggingEles&&!t.hoverData.dragging&&!t.hoverData.selecting&&(ke=t.findNearestElement(ne[0],ne[1],!0,!1));var Fe=t.hoverData.last,Me=t.hoverData.down,Oe=[ne[0]-Ge[2],ne[1]-Ge[3]],lt=t.dragData.possibleDragElements,Ot;if(Le){var $t=ye[0]-Le[0],Gt=$t*$t,At=ye[1]-Le[1],Qt=At*At,Ft=Gt+Qt;t.hoverData.isOverThresholdDrag=Ot=Ft>=t.desktopTapThreshold2}var xr=s(R);Ot&&(t.hoverData.tapholdCancelled=!0);var bn=function(){var wn=t.hoverData.dragDelta=t.hoverData.dragDelta||[];wn.length===0?(wn.push(Oe[0]),wn.push(Oe[1])):(wn[0]+=Oe[0],wn[1]+=Oe[1])};Z=!0,a(ke,["mousemove","vmousemove","tapdrag"],R,{x:ne[0],y:ne[1]});var fi=function(){t.data.bgActivePosistion=void 0,t.hoverData.selecting||X.emit({originalEvent:R,type:"boxstart",position:{x:ne[0],y:ne[1]}}),Ge[4]=1,t.hoverData.selecting=!0,t.redrawHint("select",!0),t.redraw()};if(t.hoverData.which===3){if(Ot){var Un={originalEvent:R,type:"cxtdrag",position:{x:ne[0],y:ne[1]}};Me?Me.emit(Un):X.emit(Un),t.hoverData.cxtDragged=!0,(!t.hoverData.cxtOver||ke!==t.hoverData.cxtOver)&&(t.hoverData.cxtOver&&t.hoverData.cxtOver.emit({originalEvent:R,type:"cxtdragout",position:{x:ne[0],y:ne[1]}}),t.hoverData.cxtOver=ke,ke&&ke.emit({originalEvent:R,type:"cxtdragover",position:{x:ne[0],y:ne[1]}}))}}else if(t.hoverData.dragging){if(Z=!0,X.panningEnabled()&&X.userPanningEnabled()){var $a;if(t.hoverData.justStartedPan){var Du=t.hoverData.mdownPos;$a={x:(ne[0]-Du[0])*$,y:(ne[1]-Du[1])*$},t.hoverData.justStartedPan=!1}else $a={x:Oe[0]*$,y:Oe[1]*$};X.panBy($a),X.emit("dragpan"),t.hoverData.dragged=!0}ne=t.projectIntoViewport(R.clientX,R.clientY)}else if(Ge[4]==1&&(Me==null||Me.pannable())){if(Ot){if(!t.hoverData.dragging&&X.boxSelectionEnabled()&&(xr||!X.panningEnabled()||!X.userPanningEnabled()))fi();else if(!t.hoverData.selecting&&X.panningEnabled()&&X.userPanningEnabled()){var Ji=o(Me,t.hoverData.downs);Ji&&(t.hoverData.dragging=!0,t.hoverData.justStartedPan=!0,Ge[4]=0,t.data.bgActivePosistion=Ls(we),t.redrawHint("select",!0),t.redraw())}Me&&Me.pannable()&&Me.active()&&Me.unactivate()}}else{if(Me&&Me.pannable()&&Me.active()&&Me.unactivate(),(!Me||!Me.grabbed())&&ke!=Fe&&(Fe&&a(Fe,["mouseout","tapdragout"],R,{x:ne[0],y:ne[1]}),ke&&a(ke,["mouseover","tapdragover"],R,{x:ne[0],y:ne[1]}),t.hoverData.last=ke),Me)if(Ot){if(X.boxSelectionEnabled()&&xr)Me&&Me.grabbed()&&(y(lt),Me.emit("freeon"),lt.emit("free"),t.dragData.didDrag&&(Me.emit("dragfreeon"),lt.emit("dragfree"))),fi();else if(Me&&Me.grabbed()&&t.nodeIsDraggable(Me)){var Er=!t.dragData.didDrag;Er&&t.redrawHint("eles",!0),t.dragData.didDrag=!0,t.hoverData.draggingEles||m(lt,{inDragLayer:!0});var or={x:0,y:0};if(le(Oe[0])&&le(Oe[1])&&(or.x+=Oe[0],or.y+=Oe[1],Er)){var Sr=t.hoverData.dragDelta;Sr&&le(Sr[0])&&le(Sr[1])&&(or.x+=Sr[0],or.y+=Sr[1])}t.hoverData.draggingEles=!0,lt.silentShift(or).emit("position drag"),t.redrawHint("drag",!0),t.redraw()}}else bn();Z=!0}if(Ge[2]=ne[0],Ge[3]=ne[1],Z)return R.stopPropagation&&R.stopPropagation(),R.preventDefault&&R.preventDefault(),!1}},!1);var M,P,I;t.registerBinding(e,"mouseup",function(R){if(!(t.hoverData.which===1&&R.which!==1&&t.hoverData.capture)){var K=t.hoverData.capture;if(K){t.hoverData.capture=!1;var Z=t.cy,X=t.projectIntoViewport(R.clientX,R.clientY),$=t.selection,ye=t.findNearestElement(X[0],X[1],!0,!1),ne=t.dragData.possibleDragElements,we=t.hoverData.down,Le=s(R);if(t.data.bgActivePosistion&&(t.redrawHint("select",!0),t.redraw()),t.hoverData.tapholdCancelled=!0,t.data.bgActivePosistion=void 0,we&&we.unactivate(),t.hoverData.which===3){var Ge={originalEvent:R,type:"cxttapend",position:{x:X[0],y:X[1]}};if(we?we.emit(Ge):Z.emit(Ge),!t.hoverData.cxtDragged){var ke={originalEvent:R,type:"cxttap",position:{x:X[0],y:X[1]}};we?we.emit(ke):Z.emit(ke)}t.hoverData.cxtDragged=!1,t.hoverData.which=null}else if(t.hoverData.which===1){if(a(ye,["mouseup","tapend","vmouseup"],R,{x:X[0],y:X[1]}),!t.dragData.didDrag&&!t.hoverData.dragged&&!t.hoverData.selecting&&!t.hoverData.isOverThresholdDrag&&(a(we,["click","tap","vclick"],R,{x:X[0],y:X[1]}),P=!1,R.timeStamp-I<=Z.multiClickDebounceTime()?(M&&clearTimeout(M),P=!0,I=null,a(we,["dblclick","dbltap","vdblclick"],R,{x:X[0],y:X[1]})):(M=setTimeout(function(){P||a(we,["oneclick","onetap","voneclick"],R,{x:X[0],y:X[1]})},Z.multiClickDebounceTime()),I=R.timeStamp)),we==null&&!t.dragData.didDrag&&!t.hoverData.selecting&&!t.hoverData.dragged&&!s(R)&&(Z.$(r).unselect(["tapunselect"]),ne.length>0&&t.redrawHint("eles",!0),t.dragData.possibleDragElements=ne=Z.collection()),ye==we&&!t.dragData.didDrag&&!t.hoverData.selecting&&ye!=null&&ye._private.selectable&&(t.hoverData.dragging||(Z.selectionType()==="additive"||Le?ye.selected()?ye.unselect(["tapunselect"]):ye.select(["tapselect"]):Le||(Z.$(r).unmerge(ye).unselect(["tapunselect"]),ye.select(["tapselect"]))),t.redrawHint("eles",!0)),t.hoverData.selecting){var Fe=Z.collection(t.getAllInBox($[0],$[1],$[2],$[3]));t.redrawHint("select",!0),Fe.length>0&&t.redrawHint("eles",!0),Z.emit({type:"boxend",originalEvent:R,position:{x:X[0],y:X[1]}});var Me=function(Ot){return Ot.selectable()&&!Ot.selected()};Z.selectionType()==="additive"||Le||Z.$(r).unmerge(Fe).unselect(),Fe.emit("box").stdFilter(Me).select().emit("boxselect"),t.redraw()}if(t.hoverData.dragging&&(t.hoverData.dragging=!1,t.redrawHint("select",!0),t.redrawHint("eles",!0),t.redraw()),!$[4]){t.redrawHint("drag",!0),t.redrawHint("eles",!0);var Oe=we&&we.grabbed();y(ne),Oe&&(we.emit("freeon"),ne.emit("free"),t.dragData.didDrag&&(we.emit("dragfreeon"),ne.emit("dragfree")))}}$[4]=0,t.hoverData.down=null,t.hoverData.cxtStarted=!1,t.hoverData.draggingEles=!1,t.hoverData.selecting=!1,t.hoverData.isOverThresholdDrag=!1,t.dragData.didDrag=!1,t.hoverData.dragged=!1,t.hoverData.dragDelta=[],t.hoverData.mdownPos=null,t.hoverData.mdownGPos=null,t.hoverData.which=null}}},!1);var B=[],L=4,N,F=1e5,q=function(R,K){for(var Z=0;Z<R.length;Z++)if(R[Z]%K!==0)return!1;return!0},H=function(R){for(var K=Math.abs(R[0]),Z=1;Z<R.length;Z++)if(Math.abs(R[Z])!==K)return!1;return!0},V=function(R){var K=!1,Z=R.deltaY;if(Z==null&&(R.wheelDeltaY!=null?Z=R.wheelDeltaY/4:R.wheelDelta!=null&&(Z=R.wheelDelta/4)),N==null)if(B.length>=L){var X=B;if(N=q(X,5),!N){var $=Math.abs(X[0]);N=H(X)&&$>5}if(N)for(var ye=0;ye<X.length;ye++)F=Math.min(Math.abs(X[ye]),F)}else B.push(Z),K=!0;else N&&(F=Math.min(Math.abs(Z),F));if(!t.scrollingPage){var ne=t.cy,we=ne.zoom(),Le=ne.pan(),Ge=t.projectIntoViewport(R.clientX,R.clientY),ke=[Ge[0]*we+Le.x,Ge[1]*we+Le.y];if(t.hoverData.draggingEles||t.hoverData.dragging||t.hoverData.cxtStarted||T()){R.preventDefault();return}if(ne.panningEnabled()&&ne.userPanningEnabled()&&ne.zoomingEnabled()&&ne.userZoomingEnabled()){R.preventDefault(),t.data.wheelZooming=!0,clearTimeout(t.data.wheelTimeout),t.data.wheelTimeout=setTimeout(function(){t.data.wheelZooming=!1,t.redrawHint("eles",!0),t.redraw()},150);var Fe;K&&Math.abs(Z)>5&&(Z=Uy(Z)*5),Fe=Z/-250,N&&(Fe/=F,Fe*=3),Fe=Fe*t.wheelSensitivity;var Me=R.deltaMode===1;Me&&(Fe*=33);var Oe=ne.zoom()*Math.pow(10,Fe);R.type==="gesturechange"&&(Oe=t.gestureStartZoom*R.scale),ne.zoom({level:Oe,renderedPosition:{x:ke[0],y:ke[1]}}),ne.emit(R.type==="gesturechange"?"pinchzoom":"scrollzoom")}}};t.registerBinding(t.container,"wheel",V,!0),t.registerBinding(e,"scroll",function(R){t.scrollingPage=!0,clearTimeout(t.scrollingPageTimeout),t.scrollingPageTimeout=setTimeout(function(){t.scrollingPage=!1},250)},!0),t.registerBinding(t.container,"gesturestart",function(R){t.gestureStartZoom=t.cy.zoom(),t.hasTouchStarted||R.preventDefault()},!0),t.registerBinding(t.container,"gesturechange",function(te){t.hasTouchStarted||V(te)},!0),t.registerBinding(t.container,"mouseout",function(R){var K=t.projectIntoViewport(R.clientX,R.clientY);t.cy.emit({originalEvent:R,type:"mouseout",position:{x:K[0],y:K[1]}})},!1),t.registerBinding(t.container,"mouseover",function(R){var K=t.projectIntoViewport(R.clientX,R.clientY);t.cy.emit({originalEvent:R,type:"mouseover",position:{x:K[0],y:K[1]}})},!1);var z,Y,Q,J,ee,ae,ue,re,U,G,j,se,fe,Pe=function(R,K,Z,X){return Math.sqrt((Z-R)*(Z-R)+(X-K)*(X-K))},wt=function(R,K,Z,X){return(Z-R)*(Z-R)+(X-K)*(X-K)},ot;t.registerBinding(t.container,"touchstart",ot=function(R){if(t.hasTouchStarted=!0,!!D(R)){w(),t.touchData.capture=!0,t.data.bgActivePosistion=void 0;var K=t.cy,Z=t.touchData.now,X=t.touchData.earlier;if(R.touches[0]){var $=t.projectIntoViewport(R.touches[0].clientX,R.touches[0].clientY);Z[0]=$[0],Z[1]=$[1]}if(R.touches[1]){var $=t.projectIntoViewport(R.touches[1].clientX,R.touches[1].clientY);Z[2]=$[0],Z[3]=$[1]}if(R.touches[2]){var $=t.projectIntoViewport(R.touches[2].clientX,R.touches[2].clientY);Z[4]=$[0],Z[5]=$[1]}if(R.touches[1]){t.touchData.singleTouchMoved=!0,y(t.dragData.touchDragEles);var ye=t.findContainerClientCoords();U=ye[0],G=ye[1],j=ye[2],se=ye[3],z=R.touches[0].clientX-U,Y=R.touches[0].clientY-G,Q=R.touches[1].clientX-U,J=R.touches[1].clientY-G,fe=0<=z&&z<=j&&0<=Q&&Q<=j&&0<=Y&&Y<=se&&0<=J&&J<=se;var ne=K.pan(),we=K.zoom();ee=Pe(z,Y,Q,J),ae=wt(z,Y,Q,J),ue=[(z+Q)/2,(Y+J)/2],re=[(ue[0]-ne.x)/we,(ue[1]-ne.y)/we];var Le=200,Ge=Le*Le;if(ae<Ge&&!R.touches[2]){var ke=t.findNearestElement(Z[0],Z[1],!0,!0),Fe=t.findNearestElement(Z[2],Z[3],!0,!0);ke&&ke.isNode()?(ke.activate().emit({originalEvent:R,type:"cxttapstart",position:{x:Z[0],y:Z[1]}}),t.touchData.start=ke):Fe&&Fe.isNode()?(Fe.activate().emit({originalEvent:R,type:"cxttapstart",position:{x:Z[0],y:Z[1]}}),t.touchData.start=Fe):K.emit({originalEvent:R,type:"cxttapstart",position:{x:Z[0],y:Z[1]}}),t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxt=!0,t.touchData.cxtDragged=!1,t.data.bgActivePosistion=void 0,t.redraw();return}}if(R.touches[2])K.boxSelectionEnabled()&&R.preventDefault();else if(!R.touches[1]){if(R.touches[0]){var Me=t.findNearestElements(Z[0],Z[1],!0,!0),Oe=Me[0];if(Oe!=null&&(Oe.activate(),t.touchData.start=Oe,t.touchData.starts=Me,t.nodeIsGrabbable(Oe))){var lt=t.dragData.touchDragEles=K.collection(),Ot=null;t.redrawHint("eles",!0),t.redrawHint("drag",!0),Oe.selected()?(Ot=K.$(function(Ft){return Ft.selected()&&t.nodeIsGrabbable(Ft)}),m(Ot,{addToList:lt})):v(Oe,{addToList:lt}),h(Oe);var $t=function(xr){return{originalEvent:R,type:xr,position:{x:Z[0],y:Z[1]}}};Oe.emit($t("grabon")),Ot?Ot.forEach(function(Ft){Ft.emit($t("grab"))}):Oe.emit($t("grab"))}a(Oe,["touchstart","tapstart","vmousedown"],R,{x:Z[0],y:Z[1]}),Oe==null&&(t.data.bgActivePosistion={x:$[0],y:$[1]},t.redrawHint("select",!0),t.redraw()),t.touchData.singleTouchMoved=!1,t.touchData.singleTouchStartTime=+new Date,clearTimeout(t.touchData.tapholdTimeout),t.touchData.tapholdTimeout=setTimeout(function(){t.touchData.singleTouchMoved===!1&&!t.pinching&&!t.touchData.selecting&&a(t.touchData.start,["taphold"],R,{x:Z[0],y:Z[1]})},t.tapholdDuration)}}if(R.touches.length>=1){for(var Gt=t.touchData.startPosition=[null,null,null,null,null,null],At=0;At<Z.length;At++)Gt[At]=X[At]=Z[At];var Qt=R.touches[0];t.touchData.startGPosition=[Qt.clientX,Qt.clientY]}}},!1);var pe;t.registerBinding(e,"touchmove",pe=function(R){var K=t.touchData.capture;if(!(!K&&!D(R))){var Z=t.selection,X=t.cy,$=t.touchData.now,ye=t.touchData.earlier,ne=X.zoom();if(R.touches[0]){var we=t.projectIntoViewport(R.touches[0].clientX,R.touches[0].clientY);$[0]=we[0],$[1]=we[1]}if(R.touches[1]){var we=t.projectIntoViewport(R.touches[1].clientX,R.touches[1].clientY);$[2]=we[0],$[3]=we[1]}if(R.touches[2]){var we=t.projectIntoViewport(R.touches[2].clientX,R.touches[2].clientY);$[4]=we[0],$[5]=we[1]}var Le=t.touchData.startGPosition,Ge;if(K&&R.touches[0]&&Le){for(var ke=[],Fe=0;Fe<$.length;Fe++)ke[Fe]=$[Fe]-ye[Fe];var Me=R.touches[0].clientX-Le[0],Oe=Me*Me,lt=R.touches[0].clientY-Le[1],Ot=lt*lt,$t=Oe+Ot;Ge=$t>=t.touchTapThreshold2}if(K&&t.touchData.cxt){R.preventDefault();var Gt=R.touches[0].clientX-U,At=R.touches[0].clientY-G,Qt=R.touches[1].clientX-U,Ft=R.touches[1].clientY-G,xr=wt(Gt,At,Qt,Ft),bn=xr/ae,fi=150,Un=fi*fi,$a=1.5,Du=$a*$a;if(bn>=Du||xr>=Un){t.touchData.cxt=!1,t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var Ji={originalEvent:R,type:"cxttapend",position:{x:$[0],y:$[1]}};t.touchData.start?(t.touchData.start.unactivate().emit(Ji),t.touchData.start=null):X.emit(Ji)}}if(K&&t.touchData.cxt){var Ji={originalEvent:R,type:"cxtdrag",position:{x:$[0],y:$[1]}};t.data.bgActivePosistion=void 0,t.redrawHint("select",!0),t.touchData.start?t.touchData.start.emit(Ji):X.emit(Ji),t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxtDragged=!0;var Er=t.findNearestElement($[0],$[1],!0,!0);(!t.touchData.cxtOver||Er!==t.touchData.cxtOver)&&(t.touchData.cxtOver&&t.touchData.cxtOver.emit({originalEvent:R,type:"cxtdragout",position:{x:$[0],y:$[1]}}),t.touchData.cxtOver=Er,Er&&Er.emit({originalEvent:R,type:"cxtdragover",position:{x:$[0],y:$[1]}}))}else if(K&&R.touches[2]&&X.boxSelectionEnabled())R.preventDefault(),t.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,t.touchData.selecting||X.emit({originalEvent:R,type:"boxstart",position:{x:$[0],y:$[1]}}),t.touchData.selecting=!0,t.touchData.didSelect=!0,Z[4]=1,!Z||Z.length===0||Z[0]===void 0?(Z[0]=($[0]+$[2]+$[4])/3,Z[1]=($[1]+$[3]+$[5])/3,Z[2]=($[0]+$[2]+$[4])/3+1,Z[3]=($[1]+$[3]+$[5])/3+1):(Z[2]=($[0]+$[2]+$[4])/3,Z[3]=($[1]+$[3]+$[5])/3),t.redrawHint("select",!0),t.redraw();else if(K&&R.touches[1]&&!t.touchData.didSelect&&X.zoomingEnabled()&&X.panningEnabled()&&X.userZoomingEnabled()&&X.userPanningEnabled()){R.preventDefault(),t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var or=t.dragData.touchDragEles;if(or){t.redrawHint("drag",!0);for(var Sr=0;Sr<or.length;Sr++){var Ou=or[Sr]._private;Ou.grabbed=!1,Ou.rscratch.inDragLayer=!1}}var wn=t.touchData.start,Gt=R.touches[0].clientX-U,At=R.touches[0].clientY-G,Qt=R.touches[1].clientX-U,Ft=R.touches[1].clientY-G,Fb=Pe(Gt,At,Qt,Ft),lq=Fb/ee;if(fe){var uq=Gt-z,cq=At-Y,fq=Qt-Q,hq=Ft-J,dq=(uq+fq)/2,pq=(cq+hq)/2,ho=X.zoom(),dd=ho*lq,Iu=X.pan(),qb=re[0]*ho+Iu.x,Vb=re[1]*ho+Iu.y,gq={x:-dd/ho*(qb-Iu.x-dq)+qb,y:-dd/ho*(Vb-Iu.y-pq)+Vb};if(wn&&wn.active()){var or=t.dragData.touchDragEles;y(or),t.redrawHint("drag",!0),t.redrawHint("eles",!0),wn.unactivate().emit("freeon"),or.emit("free"),t.dragData.didDrag&&(wn.emit("dragfreeon"),or.emit("dragfree"))}X.viewport({zoom:dd,pan:gq,cancelOnFailedZoom:!0}),X.emit("pinchzoom"),ee=Fb,z=Gt,Y=At,Q=Qt,J=Ft,t.pinching=!0}if(R.touches[0]){var we=t.projectIntoViewport(R.touches[0].clientX,R.touches[0].clientY);$[0]=we[0],$[1]=we[1]}if(R.touches[1]){var we=t.projectIntoViewport(R.touches[1].clientX,R.touches[1].clientY);$[2]=we[0],$[3]=we[1]}if(R.touches[2]){var we=t.projectIntoViewport(R.touches[2].clientX,R.touches[2].clientY);$[4]=we[0],$[5]=we[1]}}else if(R.touches[0]&&!t.touchData.didSelect){var an=t.touchData.start,pd=t.touchData.last,Er;if(!t.hoverData.draggingEles&&!t.swipePanning&&(Er=t.findNearestElement($[0],$[1],!0,!0)),K&&an!=null&&R.preventDefault(),K&&an!=null&&t.nodeIsDraggable(an))if(Ge){var or=t.dragData.touchDragEles,zb=!t.dragData.didDrag;zb&&m(or,{inDragLayer:!0}),t.dragData.didDrag=!0;var po={x:0,y:0};if(le(ke[0])&&le(ke[1])&&(po.x+=ke[0],po.y+=ke[1],zb)){t.redrawHint("eles",!0);var sn=t.touchData.dragDelta;sn&&le(sn[0])&&le(sn[1])&&(po.x+=sn[0],po.y+=sn[1])}t.hoverData.draggingEles=!0,or.silentShift(po).emit("position drag"),t.redrawHint("drag",!0),t.touchData.startPosition[0]==ye[0]&&t.touchData.startPosition[1]==ye[1]&&t.redrawHint("eles",!0),t.redraw()}else{var sn=t.touchData.dragDelta=t.touchData.dragDelta||[];sn.length===0?(sn.push(ke[0]),sn.push(ke[1])):(sn[0]+=ke[0],sn[1]+=ke[1])}if(a(an||Er,["touchmove","tapdrag","vmousemove"],R,{x:$[0],y:$[1]}),(!an||!an.grabbed())&&Er!=pd&&(pd&&pd.emit({originalEvent:R,type:"tapdragout",position:{x:$[0],y:$[1]}}),Er&&Er.emit({originalEvent:R,type:"tapdragover",position:{x:$[0],y:$[1]}})),t.touchData.last=Er,K)for(var Sr=0;Sr<$.length;Sr++)$[Sr]&&t.touchData.startPosition[Sr]&&Ge&&(t.touchData.singleTouchMoved=!0);if(K&&(an==null||an.pannable())&&X.panningEnabled()&&X.userPanningEnabled()){var vq=o(an,t.touchData.starts);vq&&(R.preventDefault(),t.data.bgActivePosistion||(t.data.bgActivePosistion=Ls(t.touchData.startPosition)),t.swipePanning?(X.panBy({x:ke[0]*ne,y:ke[1]*ne}),X.emit("dragpan")):Ge&&(t.swipePanning=!0,X.panBy({x:Me*ne,y:lt*ne}),X.emit("dragpan"),an&&(an.unactivate(),t.redrawHint("select",!0),t.touchData.start=null)));var we=t.projectIntoViewport(R.touches[0].clientX,R.touches[0].clientY);$[0]=we[0],$[1]=we[1]}}for(var Fe=0;Fe<$.length;Fe++)ye[Fe]=$[Fe];K&&R.touches.length>0&&!t.hoverData.draggingEles&&!t.swipePanning&&t.data.bgActivePosistion!=null&&(t.data.bgActivePosistion=void 0,t.redrawHint("select",!0),t.redraw())}},!1);var ge;t.registerBinding(e,"touchcancel",ge=function(R){var K=t.touchData.start;t.touchData.capture=!1,K&&K.unactivate()});var Ee,Te,Se,Ae;if(t.registerBinding(e,"touchend",Ee=function(R){var K=t.touchData.start,Z=t.touchData.capture;if(Z)R.touches.length===0&&(t.touchData.capture=!1),R.preventDefault();else return;var X=t.selection;t.swipePanning=!1,t.hoverData.draggingEles=!1;var $=t.cy,ye=$.zoom(),ne=t.touchData.now,we=t.touchData.earlier;if(R.touches[0]){var Le=t.projectIntoViewport(R.touches[0].clientX,R.touches[0].clientY);ne[0]=Le[0],ne[1]=Le[1]}if(R.touches[1]){var Le=t.projectIntoViewport(R.touches[1].clientX,R.touches[1].clientY);ne[2]=Le[0],ne[3]=Le[1]}if(R.touches[2]){var Le=t.projectIntoViewport(R.touches[2].clientX,R.touches[2].clientY);ne[4]=Le[0],ne[5]=Le[1]}K&&K.unactivate();var Ge;if(t.touchData.cxt){if(Ge={originalEvent:R,type:"cxttapend",position:{x:ne[0],y:ne[1]}},K?K.emit(Ge):$.emit(Ge),!t.touchData.cxtDragged){var ke={originalEvent:R,type:"cxttap",position:{x:ne[0],y:ne[1]}};K?K.emit(ke):$.emit(ke)}t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxt=!1,t.touchData.start=null,t.redraw();return}if(!R.touches[2]&&$.boxSelectionEnabled()&&t.touchData.selecting){t.touchData.selecting=!1;var Fe=$.collection(t.getAllInBox(X[0],X[1],X[2],X[3]));X[0]=void 0,X[1]=void 0,X[2]=void 0,X[3]=void 0,X[4]=0,t.redrawHint("select",!0),$.emit({type:"boxend",originalEvent:R,position:{x:ne[0],y:ne[1]}});var Me=function(Un){return Un.selectable()&&!Un.selected()};Fe.emit("box").stdFilter(Me).select().emit("boxselect"),Fe.nonempty()&&t.redrawHint("eles",!0),t.redraw()}if(K?.unactivate(),R.touches[2])t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);else if(!R.touches[1]){if(!R.touches[0]){if(!R.touches[0]){t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var Oe=t.dragData.touchDragEles;if(K!=null){var lt=K._private.grabbed;y(Oe),t.redrawHint("drag",!0),t.redrawHint("eles",!0),lt&&(K.emit("freeon"),Oe.emit("free"),t.dragData.didDrag&&(K.emit("dragfreeon"),Oe.emit("dragfree"))),a(K,["touchend","tapend","vmouseup","tapdragout"],R,{x:ne[0],y:ne[1]}),K.unactivate(),t.touchData.start=null}else{var Ot=t.findNearestElement(ne[0],ne[1],!0,!0);a(Ot,["touchend","tapend","vmouseup","tapdragout"],R,{x:ne[0],y:ne[1]})}var $t=t.touchData.startPosition[0]-ne[0],Gt=$t*$t,At=t.touchData.startPosition[1]-ne[1],Qt=At*At,Ft=Gt+Qt,xr=Ft*ye*ye;t.touchData.singleTouchMoved||(K||$.$(":selected").unselect(["tapunselect"]),a(K,["tap","vclick"],R,{x:ne[0],y:ne[1]}),Te=!1,R.timeStamp-Ae<=$.multiClickDebounceTime()?(Se&&clearTimeout(Se),Te=!0,Ae=null,a(K,["dbltap","vdblclick"],R,{x:ne[0],y:ne[1]})):(Se=setTimeout(function(){Te||a(K,["onetap","voneclick"],R,{x:ne[0],y:ne[1]})},$.multiClickDebounceTime()),Ae=R.timeStamp)),K!=null&&!t.dragData.didDrag&&K._private.selectable&&xr<t.touchTapThreshold2&&!t.pinching&&($.selectionType()==="single"?($.$(r).unmerge(K).unselect(["tapunselect"]),K.select(["tapselect"])):K.selected()?K.unselect(["tapunselect"]):K.select(["tapselect"]),t.redrawHint("eles",!0)),t.touchData.singleTouchMoved=!0}}}for(var bn=0;bn<ne.length;bn++)we[bn]=ne[bn];t.dragData.didDrag=!1,R.touches.length===0&&(t.touchData.dragDelta=[],t.touchData.startPosition=[null,null,null,null,null,null],t.touchData.startGPosition=null,t.touchData.didSelect=!1),R.touches.length<2&&(R.touches.length===1&&(t.touchData.startGPosition=[R.touches[0].clientX,R.touches[0].clientY]),t.pinching=!1,t.redrawHint("eles",!0),t.redraw())},!1),typeof TouchEvent>"u"){var De=[],Ye=function(R){return{clientX:R.clientX,clientY:R.clientY,force:1,identifier:R.pointerId,pageX:R.pageX,pageY:R.pageY,radiusX:R.width/2,radiusY:R.height/2,screenX:R.screenX,screenY:R.screenY,target:R.target}},ft=function(R){return{event:R,touch:Ye(R)}},Tt=function(R){De.push(ft(R))},Je=function(R){for(var K=0;K<De.length;K++){var Z=De[K];if(Z.event.pointerId===R.pointerId){De.splice(K,1);return}}},Dt=function(R){var K=De.filter(function(Z){return Z.event.pointerId===R.pointerId})[0];K.event=R,K.touch=Ye(R)},Xe=function(R){R.touches=De.map(function(K){return K.touch})},be=function(R){return R.pointerType==="mouse"||R.pointerType===4};t.registerBinding(t.container,"pointerdown",function(te){be(te)||(te.preventDefault(),Tt(te),Xe(te),ot(te))}),t.registerBinding(t.container,"pointerup",function(te){be(te)||(Je(te),Xe(te),Ee(te))}),t.registerBinding(t.container,"pointercancel",function(te){be(te)||(Je(te),Xe(te),ge(te))}),t.registerBinding(t.container,"pointermove",function(te){be(te)||(te.preventDefault(),Dt(te),Xe(te),pe(te))})}};var ii={};ii.generatePolygon=function(t,e){return this.nodeShapes[t]={renderer:this,name:t,points:e,draw:function(n,a,s,o,l,u){this.renderer.nodeShapeImpl("polygon",n,a,s,o,l,this.points)},intersectLine:function(n,a,s,o,l,u,c,f){return ql(l,u,this.points,n,a,s/2,o/2,c)},checkPoint:function(n,a,s,o,l,u,c,f){return ni(n,a,this.points,u,c,o,l,[0,-1],s)}}};ii.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,r,n,a,s,o){this.renderer.nodeShapeImpl(this.name,e,r,n,a,s)},intersectLine:function(e,r,n,a,s,o,l,u){return BW(s,o,e,r,n/2+l,a/2+l)},checkPoint:function(e,r,n,a,s,o,l,u){return Oa(e,r,a,s,o,l,n)}}};ii.generateRoundPolygon=function(t,e){return this.nodeShapes[t]={renderer:this,name:t,points:e,getOrCreateCorners:function(n,a,s,o,l,u,c){if(u[c]!==void 0&&u[c+"-cx"]===n&&u[c+"-cy"]===a)return u[c];u[c]=new Array(e.length/2),u[c+"-cx"]=n,u[c+"-cy"]=a;var f=s/2,h=o/2;l=l==="auto"?Ak(s,o):l;for(var d=new Array(e.length/2),p=0;p<e.length/2;p++)d[p]={x:n+f*e[p*2],y:a+h*e[p*2+1]};var g,m,v,y,b=d.length;for(m=d[b-1],g=0;g<b;g++)v=d[g%b],y=d[(g+1)%b],u[c][g]=r0(m,v,y,l),m=v,v=y;return u[c]},draw:function(n,a,s,o,l,u,c){this.renderer.nodeShapeImpl("round-polygon",n,a,s,o,l,this.points,this.getOrCreateCorners(a,s,o,l,u,c,"drawCorners"))},intersectLine:function(n,a,s,o,l,u,c,f,h){return LW(l,u,this.points,n,a,s,o,c,this.getOrCreateCorners(n,a,s,o,f,h,"corners"))},checkPoint:function(n,a,s,o,l,u,c,f,h){return IW(n,a,this.points,u,c,o,l,this.getOrCreateCorners(u,c,o,l,f,h,"corners"))}}};ii.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:br(4,0),draw:function(e,r,n,a,s,o){this.renderer.nodeShapeImpl(this.name,e,r,n,a,s,this.points,o)},intersectLine:function(e,r,n,a,s,o,l,u){return Tk(s,o,e,r,n,a,l,u)},checkPoint:function(e,r,n,a,s,o,l,u){var c=a/2,f=s/2;u=u==="auto"?Li(a,s):u,u=Math.min(c,f,u);var h=u*2;return!!(ni(e,r,this.points,o,l,a,s-h,[0,-1],n)||ni(e,r,this.points,o,l,a-h,s,[0,-1],n)||Oa(e,r,h,h,o-c+u,l-f+u,n)||Oa(e,r,h,h,o+c-u,l-f+u,n)||Oa(e,r,h,h,o+c-u,l+f-u,n)||Oa(e,r,h,h,o-c+u,l+f-u,n))}}};ii.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:Gy(),points:br(4,0),draw:function(e,r,n,a,s,o){this.renderer.nodeShapeImpl(this.name,e,r,n,a,s,null,o)},generateCutTrianglePts:function(e,r,n,a,s){var o=s==="auto"?this.cornerLength:s,l=r/2,u=e/2,c=n-u,f=n+u,h=a-l,d=a+l;return{topLeft:[c,h+o,c+o,h,c+o,h+o],topRight:[f-o,h,f,h+o,f-o,h+o],bottomRight:[f,d-o,f-o,d,f-o,d-o],bottomLeft:[c+o,d,c,d-o,c+o,d-o]}},intersectLine:function(e,r,n,a,s,o,l,u){var c=this.generateCutTrianglePts(n+2*l,a+2*l,e,r,u),f=[].concat.apply([],[c.topLeft.splice(0,4),c.topRight.splice(0,4),c.bottomRight.splice(0,4),c.bottomLeft.splice(0,4)]);return ql(s,o,f,e,r)},checkPoint:function(e,r,n,a,s,o,l,u){var c=u==="auto"?this.cornerLength:u;if(ni(e,r,this.points,o,l,a,s-2*c,[0,-1],n)||ni(e,r,this.points,o,l,a-2*c,s,[0,-1],n))return!0;var f=this.generateCutTrianglePts(a,s,o,l);return Or(e,r,f.topLeft)||Or(e,r,f.topRight)||Or(e,r,f.bottomRight)||Or(e,r,f.bottomLeft)}}};ii.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:br(4,0),draw:function(e,r,n,a,s,o){this.renderer.nodeShapeImpl(this.name,e,r,n,a,s)},intersectLine:function(e,r,n,a,s,o,l,u){var c=.15,f=.5,h=.85,d=this.generateBarrelBezierPts(n+2*l,a+2*l,e,r),p=function(v){var y=qs({x:v[0],y:v[1]},{x:v[2],y:v[3]},{x:v[4],y:v[5]},c),b=qs({x:v[0],y:v[1]},{x:v[2],y:v[3]},{x:v[4],y:v[5]},f),w=qs({x:v[0],y:v[1]},{x:v[2],y:v[3]},{x:v[4],y:v[5]},h);return[v[0],v[1],y.x,y.y,b.x,b.y,w.x,w.y,v[4],v[5]]},g=[].concat(p(d.topLeft),p(d.topRight),p(d.bottomRight),p(d.bottomLeft));return ql(s,o,g,e,r)},generateBarrelBezierPts:function(e,r,n,a){var s=r/2,o=e/2,l=n-o,u=n+o,c=a-s,f=a+s,h=my(e,r),d=h.heightOffset,p=h.widthOffset,g=h.ctrlPtOffsetPct*e,m={topLeft:[l,c+d,l+g,c,l+p,c],topRight:[u-p,c,u-g,c,u,c+d],bottomRight:[u,f-d,u-g,f,u-p,f],bottomLeft:[l+p,f,l+g,f,l,f-d]};return m.topLeft.isTop=!0,m.topRight.isTop=!0,m.bottomLeft.isBottom=!0,m.bottomRight.isBottom=!0,m},checkPoint:function(e,r,n,a,s,o,l,u){var c=my(a,s),f=c.heightOffset,h=c.widthOffset;if(ni(e,r,this.points,o,l,a,s-2*f,[0,-1],n)||ni(e,r,this.points,o,l,a-2*h,s,[0,-1],n))return!0;for(var d=this.generateBarrelBezierPts(a,s,o,l),p=function(A,T,D){var k=D[4],M=D[2],P=D[0],I=D[5],B=D[1],L=Math.min(k,P),N=Math.max(k,P),F=Math.min(I,B),q=Math.max(I,B);if(L<=A&&A<=N&&F<=T&&T<=q){var H=NW(k,M,P),V=PW(H[0],H[1],H[2],A),z=V.filter(function(Y){return 0<=Y&&Y<=1});if(z.length>0)return z[0]}return null},g=Object.keys(d),m=0;m<g.length;m++){var v=g[m],y=d[v],b=p(e,r,y);if(b!=null){var w=y[5],_=y[3],x=y[1],S=Yt(w,_,x,b);if(y.isTop&&S<=r||y.isBottom&&r<=S)return!0}}return!1}}};ii.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:br(4,0),draw:function(e,r,n,a,s,o){this.renderer.nodeShapeImpl(this.name,e,r,n,a,s,this.points,o)},intersectLine:function(e,r,n,a,s,o,l,u){var c=e-(n/2+l),f=r-(a/2+l),h=f,d=e+(n/2+l),p=Ri(s,o,e,r,c,f,d,h,!1);return p.length>0?p:Tk(s,o,e,r,n,a,l,u)},checkPoint:function(e,r,n,a,s,o,l,u){u=u==="auto"?Li(a,s):u;var c=2*u;if(ni(e,r,this.points,o,l,a,s-c,[0,-1],n)||ni(e,r,this.points,o,l,a-c,s,[0,-1],n))return!0;var f=a/2+2*n,h=s/2+2*n,d=[o-f,l-h,o-f,l,o+f,l,o+f,l-h];return!!(Or(e,r,d)||Oa(e,r,c,c,o+a/2-u,l+s/2-u,n)||Oa(e,r,c,c,o-a/2+u,l+s/2-u,n))}}};ii.registerNodeShapes=function(){var t=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",br(3,0)),this.generateRoundPolygon("round-triangle",br(3,0)),this.generatePolygon("rectangle",br(4,0)),t.square=t.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var r=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",r),this.generateRoundPolygon("round-diamond",r)}this.generatePolygon("pentagon",br(5,0)),this.generateRoundPolygon("round-pentagon",br(5,0)),this.generatePolygon("hexagon",br(6,0)),this.generateRoundPolygon("round-hexagon",br(6,0)),this.generatePolygon("heptagon",br(7,0)),this.generateRoundPolygon("round-heptagon",br(7,0)),this.generatePolygon("octagon",br(8,0)),this.generateRoundPolygon("round-octagon",br(8,0));var n=new Array(20);{var a=vy(5,0),s=vy(5,Math.PI/5),o=.5*(3-Math.sqrt(5));o*=1.57;for(var l=0;l<s.length/2;l++)s[l*2]*=o,s[l*2+1]*=o;for(var l=0;l<20/4;l++)n[l*4]=a[l*2],n[l*4+1]=a[l*2+1],n[l*4+2]=s[l*2],n[l*4+3]=s[l*2+1]}n=kk(n),this.generatePolygon("star",n),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var u=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",u),this.generateRoundPolygon("round-tag",u)}t.makePolygon=function(c){var f=c.join("$"),h="polygon-"+f,d;return(d=this[h])?d:e.generatePolygon(h,c)}};var tu={};tu.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};tu.redraw=function(t){t=t||Ek();var e=this;e.averageRedrawTime===void 0&&(e.averageRedrawTime=0),e.lastRedrawTime===void 0&&(e.lastRedrawTime=0),e.lastDrawTime===void 0&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=t};tu.beforeRender=function(t,e){if(!this.destroyed){e==null&&St("Priority is not optional for beforeRender");var r=this.beforeRenderCallbacks;r.push({fn:t,priority:e}),r.sort(function(n,a){return a.priority-n.priority})}};var UT=function(e,r,n){for(var a=e.beforeRenderCallbacks,s=0;s<a.length;s++)a[s].fn(r,n)};tu.startRenderLoop=function(){var t=this,e=t.cy;if(!t.renderLoopStarted){t.renderLoopStarted=!0;var r=function(a){if(!t.destroyed){if(!e.batching())if(t.requestedFrame&&!t.skipFrame){UT(t,!0,a);var s=ri();t.render(t.renderOptions);var o=t.lastDrawTime=ri();t.averageRedrawTime===void 0&&(t.averageRedrawTime=o-s),t.redrawCount===void 0&&(t.redrawCount=0),t.redrawCount++,t.redrawTotalTime===void 0&&(t.redrawTotalTime=0);var l=o-s;t.redrawTotalTime+=l,t.lastRedrawTime=l,t.averageRedrawTime=t.averageRedrawTime/2+l/2,t.requestedFrame=!1}else UT(t,!1,a);t.skipFrame=!1,th(r)}};th(r)}};var eK=function(e){this.init(e)},kA=eK,Qs=kA.prototype;Qs.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];Qs.init=function(t){var e=this;e.options=t,e.cy=t.cy;var r=e.container=t.cy.container(),n=e.cy.window();if(n){var a=n.document,s=a.head,o="__________cytoscape_stylesheet",l="__________cytoscape_container",u=a.getElementById(o)!=null;if(r.className.indexOf(l)<0&&(r.className=(r.className||"")+" "+l),!u){var c=a.createElement("style");c.id=o,c.textContent="."+l+" { position: relative; }",s.insertBefore(c,s.children[0])}var f=n.getComputedStyle(r),h=f.getPropertyValue("position");h==="static"&&st("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=t.showFps,e.debug=t.debug,e.webgl=t.webgl,e.hideEdgesOnViewport=t.hideEdgesOnViewport,e.textureOnViewport=t.textureOnViewport,e.wheelSensitivity=t.wheelSensitivity,e.motionBlurEnabled=t.motionBlur,e.forcedPixelRatio=le(t.pixelRatio)?t.pixelRatio:null,e.motionBlur=t.motionBlur,e.motionBlurOpacity=t.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=t.desktopTapThreshold,e.desktopTapThreshold2=t.desktopTapThreshold*t.desktopTapThreshold,e.touchTapThreshold=t.touchTapThreshold,e.touchTapThreshold2=t.touchTapThreshold*t.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()};Qs.notify=function(t,e){var r=this,n=r.cy;if(!this.destroyed){if(t==="init"){r.load();return}if(t==="destroy"){r.destroy();return}(t==="add"||t==="remove"||t==="move"&&n.hasCompoundNodes()||t==="load"||t==="zorder"||t==="mount")&&r.invalidateCachedZSortedEles(),t==="viewport"&&r.redrawHint("select",!0),t==="gc"&&r.redrawHint("gc",!0),(t==="load"||t==="resize"||t==="mount")&&(r.invalidateContainerClientCoordsCache(),r.matchCanvasSize(r.container)),r.redrawHint("eles",!0),r.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};Qs.destroy=function(){var t=this;t.destroyed=!0,t.cy.stopAnimationLoop();for(var e=0;e<t.bindings.length;e++){var r=t.bindings[e],n=r,a=n.target;(a.off||a.removeEventListener).apply(a,n.args)}if(t.bindings=[],t.beforeRenderCallbacks=[],t.onUpdateEleCalcsFns=[],t.removeObserver&&t.removeObserver.disconnect(),t.styleObserver&&t.styleObserver.disconnect(),t.resizeObserver&&t.resizeObserver.disconnect(),t.labelCalcDiv)try{document.body.removeChild(t.labelCalcDiv)}catch{}};Qs.isHeadless=function(){return!1};[t0,CA,TA,$s,ii,tu].forEach(function(t){Ce(Qs,t)});var sy=1e3/60,AA={setupDequeueing:function(e){return function(){var n=this,a=this.renderer;if(!n.dequeueingSetup){n.dequeueingSetup=!0;var s=Xl(function(){a.redrawHint("eles",!0),a.redrawHint("drag",!0),a.redraw()},e.deqRedrawThreshold),o=function(c,f){var h=ri(),d=a.averageRedrawTime,p=a.lastRedrawTime,g=[],m=a.cy.extent(),v=a.getPixelRatio();for(c||a.flushRenderedStyleQueue();;){var y=ri(),b=y-h,w=y-f;if(p<sy){var _=sy-(c?d:0);if(w>=e.deqFastCost*_)break}else if(c){if(b>=e.deqCost*p||b>=e.deqAvgCost*d)break}else if(w>=e.deqNoDrawCost*sy)break;var x=e.deq(n,v,m);if(x.length>0)for(var S=0;S<x.length;S++)g.push(x[S]);else break}g.length>0&&(e.onDeqd(n,g),!c&&e.shouldRedraw(n,g,v,m)&&s())},l=e.priority||Vy;a.beforeRender(o,l(n))}}}},tK=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rh;Vi(this,t),this.idsByKey=new ti,this.keyForId=new ti,this.cachesByLvl=new ti,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=r}return zi(t,[{key:"getIdsFor",value:function(r){r==null&&St("Can not get id list for null key");var n=this.idsByKey,a=this.idsByKey.get(r);return a||(a=new js,n.set(r,a)),a}},{key:"addIdForKey",value:function(r,n){r!=null&&this.getIdsFor(r).add(n)}},{key:"deleteIdForKey",value:function(r,n){r!=null&&this.getIdsFor(r).delete(n)}},{key:"getNumberOfIdsForKey",value:function(r){return r==null?0:this.getIdsFor(r).size}},{key:"updateKeyMappingFor",value:function(r){var n=r.id(),a=this.keyForId.get(n),s=this.getKey(r);this.deleteIdForKey(a,n),this.addIdForKey(s,n),this.keyForId.set(n,s)}},{key:"deleteKeyMappingFor",value:function(r){var n=r.id(),a=this.keyForId.get(n);this.deleteIdForKey(a,n),this.keyForId.delete(n)}},{key:"keyHasChangedFor",value:function(r){var n=r.id(),a=this.keyForId.get(n),s=this.getKey(r);return a!==s}},{key:"isInvalid",value:function(r){return this.keyHasChangedFor(r)||this.doesEleInvalidateKey(r)}},{key:"getCachesAt",value:function(r){var n=this.cachesByLvl,a=this.lvls,s=n.get(r);return s||(s=new ti,n.set(r,s),a.push(r)),s}},{key:"getCache",value:function(r,n){return this.getCachesAt(n).get(r)}},{key:"get",value:function(r,n){var a=this.getKey(r),s=this.getCache(a,n);return s!=null&&this.updateKeyMappingFor(r),s}},{key:"getForCachedKey",value:function(r,n){var a=this.keyForId.get(r.id()),s=this.getCache(a,n);return s}},{key:"hasCache",value:function(r,n){return this.getCachesAt(n).has(r)}},{key:"has",value:function(r,n){var a=this.getKey(r);return this.hasCache(a,n)}},{key:"setCache",value:function(r,n,a){a.key=r,this.getCachesAt(n).set(r,a)}},{key:"set",value:function(r,n,a){var s=this.getKey(r);this.setCache(s,n,a),this.updateKeyMappingFor(r)}},{key:"deleteCache",value:function(r,n){this.getCachesAt(n).delete(r)}},{key:"delete",value:function(r,n){var a=this.getKey(r);this.deleteCache(a,n)}},{key:"invalidateKey",value:function(r){var n=this;this.lvls.forEach(function(a){return n.deleteCache(r,a)})}},{key:"invalidate",value:function(r){var n=r.id(),a=this.keyForId.get(n);this.deleteKeyMappingFor(r);var s=this.doesEleInvalidateKey(r);return s&&this.invalidateKey(a),s||this.getNumberOfIdsForKey(a)===0}}])}(),WT=25,Vf=50,$f=-4,Py=3,MA=7.99,rK=8,nK=1024,iK=1024,aK=1024,sK=.2,oK=.8,lK=10,uK=.15,cK=.1,fK=.9,hK=.9,dK=100,pK=1,Fs={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},gK=ar({getKey:null,doesEleInvalidateKey:rh,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:wk,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),Rl=function(e,r){var n=this;n.renderer=e,n.onDequeues=[];var a=gK(r);Ce(n,a),n.lookup=new tK(a.getKey,a.doesEleInvalidateKey),n.setupDequeueing()},Wt=Rl.prototype;Wt.reasons=Fs;Wt.getTextureQueue=function(t){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[t]=e.eleImgCaches[t]||[]};Wt.getRetiredTextureQueue=function(t){var e=this,r=e.eleImgCaches.retired=e.eleImgCaches.retired||{},n=r[t]=r[t]||[];return n};Wt.getElementQueue=function(){var t=this,e=t.eleCacheQueue=t.eleCacheQueue||new $l(function(r,n){return n.reqs-r.reqs});return e};Wt.getElementKeyToQueue=function(){var t=this,e=t.eleKeyToCacheQueue=t.eleKeyToCacheQueue||{};return e};Wt.getElement=function(t,e,r,n,a){var s=this,o=this.renderer,l=o.cy.zoom(),u=this.lookup;if(!e||e.w===0||e.h===0||isNaN(e.w)||isNaN(e.h)||!t.visible()||t.removed()||!s.allowEdgeTxrCaching&&t.isEdge()||!s.allowParentTxrCaching&&t.isParent())return null;if(n==null&&(n=Math.ceil(Hy(l*r))),n<$f)n=$f;else if(l>=MA||n>Py)return null;var c=Math.pow(2,n),f=e.h*c,h=e.w*c,d=o.eleTextBiggerThanMin(t,c);if(!this.isVisible(t,d))return null;var p=u.get(t,n);if(p&&p.invalidated&&(p.invalidated=!1,p.texture.invalidatedWidth-=p.width),p)return p;var g;if(f<=WT?g=WT:f<=Vf?g=Vf:g=Math.ceil(f/Vf)*Vf,f>aK||h>iK)return null;var m=s.getTextureQueue(g),v=m[m.length-2],y=function(){return s.recycleTexture(g,h)||s.addTexture(g,h)};v||(v=m[m.length-1]),v||(v=y()),v.width-v.usedWidth<h&&(v=y());for(var b=function(L){return L&&L.scaledLabelShown===d},w=a&&a===Fs.dequeue,_=a&&a===Fs.highQuality,x=a&&a===Fs.downscale,S,E=n+1;E<=Py;E++){var A=u.get(t,E);if(A){S=A;break}}var T=S&&S.level===n+1?S:null,D=function(){v.context.drawImage(T.texture.canvas,T.x,0,T.width,T.height,v.usedWidth,0,h,f)};if(v.context.setTransform(1,0,0,1,0,0),v.context.clearRect(v.usedWidth,0,h,g),b(T))D();else if(b(S))if(_){for(var k=S.level;k>n;k--)T=s.getElement(t,e,r,k,Fs.downscale);D()}else return s.queueElement(t,S.level-1),S;else{var M;if(!w&&!_&&!x)for(var P=n-1;P>=$f;P--){var I=u.get(t,P);if(I){M=I;break}}if(b(M))return s.queueElement(t,n),M;v.context.translate(v.usedWidth,0),v.context.scale(c,c),this.drawElement(v.context,t,e,d,!1),v.context.scale(1/c,1/c),v.context.translate(-v.usedWidth,0)}return p={x:v.usedWidth,texture:v,level:n,scale:c,width:h,height:f,scaledLabelShown:d},v.usedWidth+=Math.ceil(h+rK),v.eleCaches.push(p),u.set(t,n,p),s.checkTextureFullness(v),p};Wt.invalidateElements=function(t){for(var e=0;e<t.length;e++)this.invalidateElement(t[e])};Wt.invalidateElement=function(t){var e=this,r=e.lookup,n=[],a=r.isInvalid(t);if(a){for(var s=$f;s<=Py;s++){var o=r.getForCachedKey(t,s);o&&n.push(o)}var l=r.invalidate(t);if(l)for(var u=0;u<n.length;u++){var c=n[u],f=c.texture;f.invalidatedWidth+=c.width,c.invalidated=!0,e.checkTextureUtility(f)}e.removeFromQueue(t)}};Wt.checkTextureUtility=function(t){t.invalidatedWidth>=sK*t.width&&this.retireTexture(t)};Wt.checkTextureFullness=function(t){var e=this,r=e.getTextureQueue(t.height);t.usedWidth/t.width>oK&&t.fullnessChecks>=lK?Bi(r,t):t.fullnessChecks++};Wt.retireTexture=function(t){var e=this,r=t.height,n=e.getTextureQueue(r),a=this.lookup;Bi(n,t),t.retired=!0;for(var s=t.eleCaches,o=0;o<s.length;o++){var l=s[o];a.deleteCache(l.key,l.level)}zy(s);var u=e.getRetiredTextureQueue(r);u.push(t)};Wt.addTexture=function(t,e){var r=this,n=r.getTextureQueue(t),a={};return n.push(a),a.eleCaches=[],a.height=t,a.width=Math.max(nK,e),a.usedWidth=0,a.invalidatedWidth=0,a.fullnessChecks=0,a.canvas=r.renderer.makeOffscreenCanvas(a.width,a.height),a.context=a.canvas.getContext("2d"),a};Wt.recycleTexture=function(t,e){for(var r=this,n=r.getTextureQueue(t),a=r.getRetiredTextureQueue(t),s=0;s<a.length;s++){var o=a[s];if(o.width>=e)return o.retired=!1,o.usedWidth=0,o.invalidatedWidth=0,o.fullnessChecks=0,zy(o.eleCaches),o.context.setTransform(1,0,0,1,0,0),o.context.clearRect(0,0,o.width,o.height),Bi(a,o),n.push(o),o}};Wt.queueElement=function(t,e){var r=this,n=r.getElementQueue(),a=r.getElementKeyToQueue(),s=this.getKey(t),o=a[s];if(o)o.level=Math.max(o.level,e),o.eles.merge(t),o.reqs++,n.updateItem(o);else{var l={eles:t.spawn().merge(t),level:e,reqs:1,key:s};n.push(l),a[s]=l}};Wt.dequeue=function(t){for(var e=this,r=e.getElementQueue(),n=e.getElementKeyToQueue(),a=[],s=e.lookup,o=0;o<pK&&r.size()>0;o++){var l=r.pop(),u=l.key,c=l.eles[0],f=s.hasCache(c,l.level);if(n[u]=null,f)continue;a.push(l);var h=e.getBoundingBox(c);e.getElement(c,h,t,l.level,Fs.dequeue)}return a};Wt.removeFromQueue=function(t){var e=this,r=e.getElementQueue(),n=e.getElementKeyToQueue(),a=this.getKey(t),s=n[a];s!=null&&(s.eles.length===1?(s.reqs=qy,r.updateItem(s),r.pop(),n[a]=null):s.eles.unmerge(t))};Wt.onDequeue=function(t){this.onDequeues.push(t)};Wt.offDequeue=function(t){Bi(this.onDequeues,t)};Wt.setupDequeueing=AA.setupDequeueing({deqRedrawThreshold:dK,deqCost:uK,deqAvgCost:cK,deqNoDrawCost:fK,deqFastCost:hK,deq:function(e,r,n){return e.dequeue(r,n)},onDeqd:function(e,r){for(var n=0;n<e.onDequeues.length;n++){var a=e.onDequeues[n];a(r)}},shouldRedraw:function(e,r,n,a){for(var s=0;s<r.length;s++)for(var o=r[s].eles,l=0;l<o.length;l++){var u=o[l].boundingBox();if(Wy(u,a))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var vK=1,Ol=-4,ch=2,mK=3.99,yK=50,bK=50,wK=.15,_K=.1,xK=.9,EK=.9,SK=1,GT=250,CK=4e3*4e3,KT=32767,TK=!0,PA=function(e){var r=this,n=r.renderer=e,a=n.cy;r.layersByLevel={},r.firstGet=!0,r.lastInvalidationTime=ri()-2*GT,r.skipping=!1,r.eleTxrDeqs=a.collection(),r.scheduleElementRefinement=Xl(function(){r.refineElementTextures(r.eleTxrDeqs),r.eleTxrDeqs.unmerge(r.eleTxrDeqs)},bK),n.beforeRender(function(o,l){l-r.lastInvalidationTime<=GT?r.skipping=!0:r.skipping=!1},n.beforeRenderPriorities.lyrTxrSkip);var s=function(l,u){return u.reqs-l.reqs};r.layersQueue=new $l(s),r.setupDequeueing()},sr=PA.prototype,jT=0,kK=Math.pow(2,53)-1;sr.makeLayer=function(t,e){var r=Math.pow(2,e),n=Math.ceil(t.w*r),a=Math.ceil(t.h*r),s=this.renderer.makeOffscreenCanvas(n,a),o={id:jT=++jT%kK,bb:t,level:e,width:n,height:a,canvas:s,context:s.getContext("2d"),eles:[],elesQueue:[],reqs:0},l=o.context,u=-o.bb.x1,c=-o.bb.y1;return l.scale(r,r),l.translate(u,c),o};sr.getLayers=function(t,e,r){var n=this,a=n.renderer,s=a.cy,o=s.zoom(),l=n.firstGet;if(n.firstGet=!1,r==null){if(r=Math.ceil(Hy(o*e)),r<Ol)r=Ol;else if(o>=mK||r>ch)return null}n.validateLayersElesOrdering(r,t);var u=n.layersByLevel,c=Math.pow(2,r),f=u[r]=u[r]||[],h,d=n.levelIsComplete(r,t),p,g=function(){var D=function(B){if(n.validateLayersElesOrdering(B,t),n.levelIsComplete(B,t))return p=u[B],!0},k=function(B){if(!p)for(var L=r+B;Ol<=L&&L<=ch&&!D(L);L+=B);};k(1),k(-1);for(var M=f.length-1;M>=0;M--){var P=f[M];P.invalid&&Bi(f,P)}};if(!d)g();else return f;var m=function(){if(!h){h=Br();for(var D=0;D<t.length;D++)Ck(h,t[D].boundingBox())}return h},v=function(D){D=D||{};var k=D.after;m();var M=Math.ceil(h.w*c),P=Math.ceil(h.h*c);if(M>KT||P>KT)return null;var I=M*P;if(I>CK)return null;var B=n.makeLayer(h,r);if(k!=null){var L=f.indexOf(k)+1;f.splice(L,0,B)}else(D.insert===void 0||D.insert)&&f.unshift(B);return B};if(n.skipping&&!l)return null;for(var y=null,b=t.length/vK,w=!l,_=0;_<t.length;_++){var x=t[_],S=x._private.rscratch,E=S.imgLayerCaches=S.imgLayerCaches||{},A=E[r];if(A){y=A;continue}if((!y||y.eles.length>=b||!kW(y.bb,x.boundingBox()))&&(y=v({insert:!0,after:y}),!y))return null;p||w?n.queueLayer(y,x):n.drawEleInLayer(y,x,r,e),y.eles.push(x),E[r]=y}return p||(w?null:f)};sr.getEleLevelForLayerLevel=function(t,e){return t};sr.drawEleInLayer=function(t,e,r,n){var a=this,s=this.renderer,o=t.context,l=e.boundingBox();l.w===0||l.h===0||!e.visible()||(r=a.getEleLevelForLayerLevel(r,n),s.setImgSmoothing(o,!1),s.drawCachedElement(o,e,null,null,r,TK),s.setImgSmoothing(o,!0))};sr.levelIsComplete=function(t,e){var r=this,n=r.layersByLevel[t];if(!n||n.length===0)return!1;for(var a=0,s=0;s<n.length;s++){var o=n[s];if(o.reqs>0||o.invalid)return!1;a+=o.eles.length}return a===e.length};sr.validateLayersElesOrdering=function(t,e){var r=this.layersByLevel[t];if(r)for(var n=0;n<r.length;n++){for(var a=r[n],s=-1,o=0;o<e.length;o++)if(a.eles[0]===e[o]){s=o;break}if(s<0){this.invalidateLayer(a);continue}for(var l=s,o=0;o<a.eles.length;o++)if(a.eles[o]!==e[l+o]){this.invalidateLayer(a);break}}};sr.updateElementsInLayers=function(t,e){for(var r=this,n=Kl(t[0]),a=0;a<t.length;a++)for(var s=n?null:t[a],o=n?t[a]:t[a].ele,l=o._private.rscratch,u=l.imgLayerCaches=l.imgLayerCaches||{},c=Ol;c<=ch;c++){var f=u[c];f&&(s&&r.getEleLevelForLayerLevel(f.level)!==s.level||e(f,o,s))}};sr.haveLayers=function(){for(var t=this,e=!1,r=Ol;r<=ch;r++){var n=t.layersByLevel[r];if(n&&n.length>0){e=!0;break}}return e};sr.invalidateElements=function(t){var e=this;t.length!==0&&(e.lastInvalidationTime=ri(),!(t.length===0||!e.haveLayers())&&e.updateElementsInLayers(t,function(n,a,s){e.invalidateLayer(n)}))};sr.invalidateLayer=function(t){if(this.lastInvalidationTime=ri(),!t.invalid){var e=t.level,r=t.eles,n=this.layersByLevel[e];Bi(n,t),t.elesQueue=[],t.invalid=!0,t.replacement&&(t.replacement.invalid=!0);for(var a=0;a<r.length;a++){var s=r[a]._private.rscratch.imgLayerCaches;s&&(s[e]=null)}}};sr.refineElementTextures=function(t){var e=this;e.updateElementsInLayers(t,function(n,a,s){var o=n.replacement;if(o||(o=n.replacement=e.makeLayer(n.bb,n.level),o.replaces=n,o.eles=n.eles),!o.reqs)for(var l=0;l<o.eles.length;l++)e.queueLayer(o,o.eles[l])})};sr.enqueueElementRefinement=function(t){this.eleTxrDeqs.merge(t),this.scheduleElementRefinement()};sr.queueLayer=function(t,e){var r=this,n=r.layersQueue,a=t.elesQueue,s=a.hasId=a.hasId||{};if(!t.replacement){if(e){if(s[e.id()])return;a.push(e),s[e.id()]=!0}t.reqs?(t.reqs++,n.updateItem(t)):(t.reqs=1,n.push(t))}};sr.dequeue=function(t){for(var e=this,r=e.layersQueue,n=[],a=0;a<SK&&r.size()!==0;){var s=r.peek();if(s.replacement){r.pop();continue}if(s.replaces&&s!==s.replaces.replacement){r.pop();continue}if(s.invalid){r.pop();continue}var o=s.elesQueue.shift();o&&(e.drawEleInLayer(s,o,s.level,t),a++),n.length===0&&n.push(!0),s.elesQueue.length===0&&(r.pop(),s.reqs=0,s.replaces&&e.applyLayerReplacement(s),e.requestRedraw())}return n};sr.applyLayerReplacement=function(t){var e=this,r=e.layersByLevel[t.level],n=t.replaces,a=r.indexOf(n);if(!(a<0||n.invalid)){r[a]=t;for(var s=0;s<t.eles.length;s++){var o=t.eles[s]._private,l=o.imgLayerCaches=o.imgLayerCaches||{};l&&(l[t.level]=t)}e.requestRedraw()}};sr.requestRedraw=Xl(function(){var t=this.renderer;t.redrawHint("eles",!0),t.redrawHint("drag",!0),t.redraw()},100);sr.setupDequeueing=AA.setupDequeueing({deqRedrawThreshold:yK,deqCost:wK,deqAvgCost:_K,deqNoDrawCost:xK,deqFastCost:EK,deq:function(e,r){return e.dequeue(r)},onDeqd:Vy,shouldRedraw:wk,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var RA={},YT;function AK(t,e){for(var r=0;r<e.length;r++){var n=e[r];t.lineTo(n.x,n.y)}}function MK(t,e,r){for(var n,a=0;a<e.length;a++){var s=e[a];a===0&&(n=s),t.lineTo(s.x,s.y)}t.quadraticCurveTo(r.x,r.y,n.x,n.y)}function ZT(t,e,r){t.beginPath&&t.beginPath();for(var n=e,a=0;a<n.length;a++){var s=n[a];t.lineTo(s.x,s.y)}var o=r,l=r[0];t.moveTo(l.x,l.y);for(var a=1;a<o.length;a++){var s=o[a];t.lineTo(s.x,s.y)}t.closePath&&t.closePath()}function PK(t,e,r,n,a){t.beginPath&&t.beginPath(),t.arc(r,n,a,0,Math.PI*2,!1);var s=e,o=s[0];t.moveTo(o.x,o.y);for(var l=0;l<s.length;l++){var u=s[l];t.lineTo(u.x,u.y)}t.closePath&&t.closePath()}function RK(t,e,r,n){t.arc(e,r,n,0,Math.PI*2,!1)}RA.arrowShapeImpl=function(t){return(YT||(YT={polygon:AK,"triangle-backcurve":MK,"triangle-tee":ZT,"circle-triangle":PK,"triangle-cross":ZT,circle:RK}))[t]};var Fn={};Fn.drawElement=function(t,e,r,n,a,s){var o=this;e.isNode()?o.drawNode(t,e,r,n,a,s):o.drawEdge(t,e,r,n,a,s)};Fn.drawElementOverlay=function(t,e){var r=this;e.isNode()?r.drawNodeOverlay(t,e):r.drawEdgeOverlay(t,e)};Fn.drawElementUnderlay=function(t,e){var r=this;e.isNode()?r.drawNodeUnderlay(t,e):r.drawEdgeUnderlay(t,e)};Fn.drawCachedElementPortion=function(t,e,r,n,a,s,o,l){var u=this,c=r.getBoundingBox(e);if(!(c.w===0||c.h===0)){var f=r.getElement(e,c,n,a,s);if(f!=null){var h=l(u,e);if(h===0)return;var d=o(u,e),p=c.x1,g=c.y1,m=c.w,v=c.h,y,b,w,_,x;if(d!==0){var S=r.getRotationPoint(e);w=S.x,_=S.y,t.translate(w,_),t.rotate(d),x=u.getImgSmoothing(t),x||u.setImgSmoothing(t,!0);var E=r.getRotationOffset(e);y=E.x,b=E.y}else y=p,b=g;var A;h!==1&&(A=t.globalAlpha,t.globalAlpha=A*h),t.drawImage(f.texture.canvas,f.x,0,f.width,f.height,y,b,m,v),h!==1&&(t.globalAlpha=A),d!==0&&(t.rotate(-d),t.translate(-w,-_),x||u.setImgSmoothing(t,!1))}else r.drawElement(t,e)}};var DK=function(){return 0},OK=function(e,r){return e.getTextAngle(r,null)},IK=function(e,r){return e.getTextAngle(r,"source")},BK=function(e,r){return e.getTextAngle(r,"target")},LK=function(e,r){return r.effectiveOpacity()},oy=function(e,r){return r.pstyle("text-opacity").pfValue*r.effectiveOpacity()};Fn.drawCachedElement=function(t,e,r,n,a,s){var o=this,l=o.data,u=l.eleTxrCache,c=l.lblTxrCache,f=l.slbTxrCache,h=l.tlbTxrCache,d=e.boundingBox(),p=s===!0?u.reasons.highQuality:null;if(!(d.w===0||d.h===0||!e.visible())&&(!n||Wy(d,n))){var g=e.isEdge(),m=e.element()._private.rscratch.badLine;o.drawElementUnderlay(t,e),o.drawCachedElementPortion(t,e,u,r,a,p,DK,LK),(!g||!m)&&o.drawCachedElementPortion(t,e,c,r,a,p,OK,oy),g&&!m&&(o.drawCachedElementPortion(t,e,f,r,a,p,IK,oy),o.drawCachedElementPortion(t,e,h,r,a,p,BK,oy)),o.drawElementOverlay(t,e)}};Fn.drawElements=function(t,e){for(var r=this,n=0;n<e.length;n++){var a=e[n];r.drawElement(t,a)}};Fn.drawCachedElements=function(t,e,r,n){for(var a=this,s=0;s<e.length;s++){var o=e[s];a.drawCachedElement(t,o,r,n)}};Fn.drawCachedNodes=function(t,e,r,n){for(var a=this,s=0;s<e.length;s++){var o=e[s];o.isNode()&&a.drawCachedElement(t,o,r,n)}};Fn.drawLayeredElements=function(t,e,r,n){var a=this,s=a.data.lyrTxrCache.getLayers(e,r);if(s)for(var o=0;o<s.length;o++){var l=s[o],u=l.bb;u.w===0||u.h===0||t.drawImage(l.canvas,u.x1,u.y1,u.w,u.h)}else a.drawCachedElements(t,e,r,n)};var ai={};ai.drawEdge=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,l=e._private.rscratch;if(!(s&&!e.visible())&&!(l.badLine||l.allpts==null||isNaN(l.allpts[0]))){var u;r&&(u=r,t.translate(-u.x1,-u.y1));var c=s?e.pstyle("opacity").value:1,f=s?e.pstyle("line-opacity").value:1,h=e.pstyle("curve-style").value,d=e.pstyle("line-style").value,p=e.pstyle("width").pfValue,g=e.pstyle("line-cap").value,m=e.pstyle("line-outline-width").value,v=e.pstyle("line-outline-color").value,y=c*f,b=c*f,w=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y;h==="straight-triangle"?(o.eleStrokeStyle(t,e,B),o.drawEdgeTrianglePath(e,t,l.allpts)):(t.lineWidth=p,t.lineCap=g,o.eleStrokeStyle(t,e,B),o.drawEdgePath(e,t,l.allpts,d),t.lineCap="butt")},_=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y;if(t.lineWidth=p+m,t.lineCap=g,m>0)o.colorStrokeStyle(t,v[0],v[1],v[2],B);else{t.lineCap="butt";return}h==="straight-triangle"?o.drawEdgeTrianglePath(e,t,l.allpts):(o.drawEdgePath(e,t,l.allpts,d),t.lineCap="butt")},x=function(){a&&o.drawEdgeOverlay(t,e)},S=function(){a&&o.drawEdgeUnderlay(t,e)},E=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b;o.drawArrowheads(t,e,B)},A=function(){o.drawElementText(t,e,null,n)};t.lineJoin="round";var T=e.pstyle("ghost").value==="yes";if(T){var D=e.pstyle("ghost-offset-x").pfValue,k=e.pstyle("ghost-offset-y").pfValue,M=e.pstyle("ghost-opacity").value,P=y*M;t.translate(D,k),w(P),E(P),t.translate(-D,-k)}else _();S(),w(),E(),x(),A(),r&&t.translate(u.x1,u.y1)}};var DA=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(r,n){if(n.visible()){var a=n.pstyle("".concat(e,"-opacity")).value;if(a!==0){var s=this,o=s.usePaths(),l=n._private.rscratch,u=n.pstyle("".concat(e,"-padding")).pfValue,c=2*u,f=n.pstyle("".concat(e,"-color")).value;r.lineWidth=c,l.edgeType==="self"&&!o?r.lineCap="butt":r.lineCap="round",s.colorStrokeStyle(r,f[0],f[1],f[2],a),s.drawEdgePath(n,r,l.allpts,"solid")}}}};ai.drawEdgeOverlay=DA("overlay");ai.drawEdgeUnderlay=DA("underlay");ai.drawEdgePath=function(t,e,r,n){var a=t._private.rscratch,s=e,o,l=!1,u=this.usePaths(),c=t.pstyle("line-dash-pattern").pfValue,f=t.pstyle("line-dash-offset").pfValue;if(u){var h=r.join("$"),d=a.pathCacheKey&&a.pathCacheKey===h;d?(o=e=a.pathCache,l=!0):(o=e=new Path2D,a.pathCacheKey=h,a.pathCache=o)}if(s.setLineDash)switch(n){case"dotted":s.setLineDash([1,1]);break;case"dashed":s.setLineDash(c),s.lineDashOffset=f;break;case"solid":s.setLineDash([]);break}if(!l&&!a.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(r[0],r[1]),a.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var p=2;p+3<r.length;p+=4)e.quadraticCurveTo(r[p],r[p+1],r[p+2],r[p+3]);break;case"straight":case"haystack":for(var g=2;g+1<r.length;g+=2)e.lineTo(r[g],r[g+1]);break;case"segments":if(a.isRound){var m=Ir(a.roundCorners),v;try{for(m.s();!(v=m.n()).done;){var y=v.value;wA(e,y)}}catch(w){m.e(w)}finally{m.f()}e.lineTo(r[r.length-2],r[r.length-1])}else for(var b=2;b+1<r.length;b+=2)e.lineTo(r[b],r[b+1]);break}e=s,u?e.stroke(o):e.stroke(),e.setLineDash&&e.setLineDash([])};ai.drawEdgeTrianglePath=function(t,e,r){e.fillStyle=e.strokeStyle;for(var n=t.pstyle("width").pfValue,a=0;a+1<r.length;a+=2){var s=[r[a+2]-r[a],r[a+3]-r[a+1]],o=Math.sqrt(s[0]*s[0]+s[1]*s[1]),l=[s[1]/o,-s[0]/o],u=[l[0]*n/2,l[1]*n/2];e.beginPath(),e.moveTo(r[a]-u[0],r[a+1]-u[1]),e.lineTo(r[a]+u[0],r[a+1]+u[1]),e.lineTo(r[a+2],r[a+3]),e.closePath(),e.fill()}};ai.drawArrowheads=function(t,e,r){var n=e._private.rscratch,a=n.edgeType==="haystack";a||this.drawArrowhead(t,e,"source",n.arrowStartX,n.arrowStartY,n.srcArrowAngle,r),this.drawArrowhead(t,e,"mid-target",n.midX,n.midY,n.midtgtArrowAngle,r),this.drawArrowhead(t,e,"mid-source",n.midX,n.midY,n.midsrcArrowAngle,r),a||this.drawArrowhead(t,e,"target",n.arrowEndX,n.arrowEndY,n.tgtArrowAngle,r)};ai.drawArrowhead=function(t,e,r,n,a,s,o){if(!(isNaN(n)||n==null||isNaN(a)||a==null||isNaN(s)||s==null)){var l=this,u=e.pstyle(r+"-arrow-shape").value;if(u!=="none"){var c=e.pstyle(r+"-arrow-fill").value==="hollow"?"both":"filled",f=e.pstyle(r+"-arrow-fill").value,h=e.pstyle("width").pfValue,d=e.pstyle(r+"-arrow-width"),p=d.value==="match-line"?h:d.pfValue;d.units==="%"&&(p*=h);var g=e.pstyle("opacity").value;o===void 0&&(o=g);var m=t.globalCompositeOperation;(o!==1||f==="hollow")&&(t.globalCompositeOperation="destination-out",l.colorFillStyle(t,255,255,255,1),l.colorStrokeStyle(t,255,255,255,1),l.drawArrowShape(e,t,c,h,u,p,n,a,s),t.globalCompositeOperation=m);var v=e.pstyle(r+"-arrow-color").value;l.colorFillStyle(t,v[0],v[1],v[2],o),l.colorStrokeStyle(t,v[0],v[1],v[2],o),l.drawArrowShape(e,t,f,h,u,p,n,a,s)}}};ai.drawArrowShape=function(t,e,r,n,a,s,o,l,u){var c=this,f=this.usePaths()&&a!=="triangle-cross",h=!1,d,p=e,g={x:o,y:l},m=t.pstyle("arrow-scale").value,v=this.getArrowWidth(n,m),y=c.arrowShapes[a];if(f){var b=c.arrowPathCache=c.arrowPathCache||[],w=Ia(a),_=b[w];_!=null?(d=e=_,h=!0):(d=e=new Path2D,b[w]=d)}h||(e.beginPath&&e.beginPath(),f?y.draw(e,1,0,{x:0,y:0},1):y.draw(e,v,u,g,n),e.closePath&&e.closePath()),e=p,f&&(e.translate(o,l),e.rotate(u),e.scale(v,v)),(r==="filled"||r==="both")&&(f?e.fill(d):e.fill()),(r==="hollow"||r==="both")&&(e.lineWidth=s/(f?v:1),e.lineJoin="miter",f?e.stroke(d):e.stroke()),f&&(e.scale(1/v,1/v),e.rotate(-u),e.translate(-o,-l))};var i0={};i0.safeDrawImage=function(t,e,r,n,a,s,o,l,u,c){if(!(a<=0||s<=0||u<=0||c<=0))try{t.drawImage(e,r,n,a,s,o,l,u,c)}catch(f){st(f)}};i0.drawInscribedImage=function(t,e,r,n,a){var s=this,o=r.position(),l=o.x,u=o.y,c=r.cy().style(),f=c.getIndexedStyle.bind(c),h=f(r,"background-fit","value",n),d=f(r,"background-repeat","value",n),p=r.width(),g=r.height(),m=r.padding()*2,v=p+(f(r,"background-width-relative-to","value",n)==="inner"?0:m),y=g+(f(r,"background-height-relative-to","value",n)==="inner"?0:m),b=r._private.rscratch,w=f(r,"background-clip","value",n),_=w==="node",x=f(r,"background-image-opacity","value",n)*a,S=f(r,"background-image-smoothing","value",n),E=r.pstyle("corner-radius").value;E!=="auto"&&(E=r.pstyle("corner-radius").pfValue);var A=e.width||e.cachedW,T=e.height||e.cachedH;(A==null||T==null)&&(document.body.appendChild(e),A=e.cachedW=e.width||e.offsetWidth,T=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var D=A,k=T;if(f(r,"background-width","value",n)!=="auto"&&(f(r,"background-width","units",n)==="%"?D=f(r,"background-width","pfValue",n)*v:D=f(r,"background-width","pfValue",n)),f(r,"background-height","value",n)!=="auto"&&(f(r,"background-height","units",n)==="%"?k=f(r,"background-height","pfValue",n)*y:k=f(r,"background-height","pfValue",n)),!(D===0||k===0)){if(h==="contain"){var M=Math.min(v/D,y/k);D*=M,k*=M}else if(h==="cover"){var M=Math.max(v/D,y/k);D*=M,k*=M}var P=l-v/2,I=f(r,"background-position-x","units",n),B=f(r,"background-position-x","pfValue",n);I==="%"?P+=(v-D)*B:P+=B;var L=f(r,"background-offset-x","units",n),N=f(r,"background-offset-x","pfValue",n);L==="%"?P+=(v-D)*N:P+=N;var F=u-y/2,q=f(r,"background-position-y","units",n),H=f(r,"background-position-y","pfValue",n);q==="%"?F+=(y-k)*H:F+=H;var V=f(r,"background-offset-y","units",n),z=f(r,"background-offset-y","pfValue",n);V==="%"?F+=(y-k)*z:F+=z,b.pathCache&&(P-=l,F-=u,l=0,u=0);var Y=t.globalAlpha;t.globalAlpha=x;var Q=s.getImgSmoothing(t),J=!1;if(S==="no"&&Q?(s.setImgSmoothing(t,!1),J=!0):S==="yes"&&!Q&&(s.setImgSmoothing(t,!0),J=!0),d==="no-repeat")_&&(t.save(),b.pathCache?t.clip(b.pathCache):(s.nodeShapes[s.getNodeShape(r)].draw(t,l,u,v,y,E,b),t.clip())),s.safeDrawImage(t,e,0,0,A,T,P,F,D,k),_&&t.restore();else{var ee=t.createPattern(e,d);t.fillStyle=ee,s.nodeShapes[s.getNodeShape(r)].draw(t,l,u,v,y,E,b),t.translate(P,F),t.fill(),t.translate(-P,-F)}t.globalAlpha=Y,J&&s.setImgSmoothing(t,Q)}};var za={};za.eleTextBiggerThanMin=function(t,e){if(!e){var r=t.cy().zoom(),n=this.getPixelRatio(),a=Math.ceil(Hy(r*n));e=Math.pow(2,a)}var s=t.pstyle("font-size").pfValue*e,o=t.pstyle("min-zoomed-font-size").pfValue;return!(s<o)};za.drawElementText=function(t,e,r,n,a){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this;if(n==null){if(s&&!o.eleTextBiggerThanMin(e))return}else if(n===!1)return;if(e.isNode()){var l=e.pstyle("label");if(!l||!l.value)return;var u=o.getLabelJustification(e);t.textAlign=u,t.textBaseline="bottom"}else{var c=e.element()._private.rscratch.badLine,f=e.pstyle("label"),h=e.pstyle("source-label"),d=e.pstyle("target-label");if(c||(!f||!f.value)&&(!h||!h.value)&&(!d||!d.value))return;t.textAlign="center",t.textBaseline="bottom"}var p=!r,g;r&&(g=r,t.translate(-g.x1,-g.y1)),a==null?(o.drawText(t,e,null,p,s),e.isEdge()&&(o.drawText(t,e,"source",p,s),o.drawText(t,e,"target",p,s))):o.drawText(t,e,a,p,s),r&&t.translate(g.x1,g.y1)};za.getFontCache=function(t){var e;this.fontCaches=this.fontCaches||[];for(var r=0;r<this.fontCaches.length;r++)if(e=this.fontCaches[r],e.context===t)return e;return e={context:t},this.fontCaches.push(e),e};za.setupTextStyle=function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=e.pstyle("font-style").strValue,a=e.pstyle("font-size").pfValue+"px",s=e.pstyle("font-family").strValue,o=e.pstyle("font-weight").strValue,l=r?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,u=e.pstyle("text-outline-opacity").value*l,c=e.pstyle("color").value,f=e.pstyle("text-outline-color").value;t.font=n+" "+o+" "+a+" "+s,t.lineJoin="round",this.colorFillStyle(t,c[0],c[1],c[2],l),this.colorStrokeStyle(t,f[0],f[1],f[2],u)};function ly(t,e,r,n,a){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,o=arguments.length>6?arguments[6]:void 0;t.beginPath(),t.moveTo(e+s,r),t.lineTo(e+n-s,r),t.quadraticCurveTo(e+n,r,e+n,r+s),t.lineTo(e+n,r+a-s),t.quadraticCurveTo(e+n,r+a,e+n-s,r+a),t.lineTo(e+s,r+a),t.quadraticCurveTo(e,r+a,e,r+a-s),t.lineTo(e,r+s),t.quadraticCurveTo(e,r,e+s,r),t.closePath(),o?t.stroke():t.fill()}za.getTextAngle=function(t,e){var r,n=t._private,a=n.rscratch,s=e?e+"-":"",o=t.pstyle(s+"text-rotation");if(o.strValue==="autorotate"){var l=Dr(a,"labelAngle",e);r=t.isEdge()?l:0}else o.strValue==="none"?r=0:r=o.pfValue;return r};za.drawText=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=e._private,o=s.rscratch,l=a?e.effectiveOpacity():1;if(!(a&&(l===0||e.pstyle("text-opacity").value===0))){r==="main"&&(r=null);var u=Dr(o,"labelX",r),c=Dr(o,"labelY",r),f,h,d=this.getLabelText(e,r);if(d!=null&&d!==""&&!isNaN(u)&&!isNaN(c)){this.setupTextStyle(t,e,a);var p=r?r+"-":"",g=Dr(o,"labelWidth",r),m=Dr(o,"labelHeight",r),v=e.pstyle(p+"text-margin-x").pfValue,y=e.pstyle(p+"text-margin-y").pfValue,b=e.isEdge(),w=e.pstyle("text-halign").value,_=e.pstyle("text-valign").value;b&&(w="center",_="center"),u+=v,c+=y;var x;switch(n?x=this.getTextAngle(e,r):x=0,x!==0&&(f=u,h=c,t.translate(f,h),t.rotate(x),u=0,c=0),_){case"top":break;case"center":c+=m/2;break;case"bottom":c+=m;break}var S=e.pstyle("text-background-opacity").value,E=e.pstyle("text-border-opacity").value,A=e.pstyle("text-border-width").pfValue,T=e.pstyle("text-background-padding").pfValue,D=e.pstyle("text-background-shape").strValue,k=D.indexOf("round")===0,M=2;if(S>0||A>0&&E>0){var P=u-T;switch(w){case"left":P-=g;break;case"center":P-=g/2;break}var I=c-m-T,B=g+2*T,L=m+2*T;if(S>0){var N=t.fillStyle,F=e.pstyle("text-background-color").value;t.fillStyle="rgba("+F[0]+","+F[1]+","+F[2]+","+S*l+")",k?ly(t,P,I,B,L,M):t.fillRect(P,I,B,L),t.fillStyle=N}if(A>0&&E>0){var q=t.strokeStyle,H=t.lineWidth,V=e.pstyle("text-border-color").value,z=e.pstyle("text-border-style").value;if(t.strokeStyle="rgba("+V[0]+","+V[1]+","+V[2]+","+E*l+")",t.lineWidth=A,t.setLineDash)switch(z){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash([4,2]);break;case"double":t.lineWidth=A/4,t.setLineDash([]);break;case"solid":t.setLineDash([]);break}if(k?ly(t,P,I,B,L,M,"stroke"):t.strokeRect(P,I,B,L),z==="double"){var Y=A/2;k?ly(t,P+Y,I+Y,B-Y*2,L-Y*2,M,"stroke"):t.strokeRect(P+Y,I+Y,B-Y*2,L-Y*2)}t.setLineDash&&t.setLineDash([]),t.lineWidth=H,t.strokeStyle=q}}var Q=2*e.pstyle("text-outline-width").pfValue;if(Q>0&&(t.lineWidth=Q),e.pstyle("text-wrap").value==="wrap"){var J=Dr(o,"labelWrapCachedLines",r),ee=Dr(o,"labelLineHeight",r),ae=g/2,ue=this.getLabelJustification(e);switch(ue==="auto"||(w==="left"?ue==="left"?u+=-g:ue==="center"&&(u+=-ae):w==="center"?ue==="left"?u+=-ae:ue==="right"&&(u+=ae):w==="right"&&(ue==="center"?u+=ae:ue==="right"&&(u+=g))),_){case"top":c-=(J.length-1)*ee;break;case"center":case"bottom":c-=(J.length-1)*ee;break}for(var re=0;re<J.length;re++)Q>0&&t.strokeText(J[re],u,c),t.fillText(J[re],u,c),c+=ee}else Q>0&&t.strokeText(d,u,c),t.fillText(d,u,c);x!==0&&(t.rotate(-x),t.translate(-f,-h))}}};var Ui={};Ui.drawNode=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,l,u,c=e._private,f=c.rscratch,h=e.position();if(!(!le(h.x)||!le(h.y))&&!(s&&!e.visible())){var d=s?e.effectiveOpacity():1,p=o.usePaths(),g,m=!1,v=e.padding();l=e.width()+2*v,u=e.height()+2*v;var y;r&&(y=r,t.translate(-y.x1,-y.y1));for(var b=e.pstyle("background-image"),w=b.value,_=new Array(w.length),x=new Array(w.length),S=0,E=0;E<w.length;E++){var A=w[E],T=_[E]=A!=null&&A!=="none";if(T){var D=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",E);S++,x[E]=o.getCachedImage(A,D,function(){c.backgroundTimestamp=Date.now(),e.emitAndNotify("background")})}}var k=e.pstyle("background-blacken").value,M=e.pstyle("border-width").pfValue,P=e.pstyle("background-opacity").value*d,I=e.pstyle("border-color").value,B=e.pstyle("border-style").value,L=e.pstyle("border-join").value,N=e.pstyle("border-cap").value,F=e.pstyle("border-position").value,q=e.pstyle("border-dash-pattern").pfValue,H=e.pstyle("border-dash-offset").pfValue,V=e.pstyle("border-opacity").value*d,z=e.pstyle("outline-width").pfValue,Y=e.pstyle("outline-color").value,Q=e.pstyle("outline-style").value,J=e.pstyle("outline-opacity").value*d,ee=e.pstyle("outline-offset").value,ae=e.pstyle("corner-radius").value;ae!=="auto"&&(ae=e.pstyle("corner-radius").pfValue);var ue=function(){var be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:P;o.eleFillStyle(t,e,be)},re=function(){var be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:V;o.colorStrokeStyle(t,I[0],I[1],I[2],be)},U=function(){var be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:J;o.colorStrokeStyle(t,Y[0],Y[1],Y[2],be)},G=function(be,te,R,K){var Z=o.nodePathCache=o.nodePathCache||[],X=bk(R==="polygon"?R+","+K.join(","):R,""+te,""+be,""+ae),$=Z[X],ye,ne=!1;return $!=null?(ye=$,ne=!0,f.pathCache=ye):(ye=new Path2D,Z[X]=f.pathCache=ye),{path:ye,cacheHit:ne}},j=e.pstyle("shape").strValue,se=e.pstyle("shape-polygon-points").pfValue;if(p){t.translate(h.x,h.y);var fe=G(l,u,j,se);g=fe.path,m=fe.cacheHit}var Pe=function(){if(!m){var be=h;p&&(be={x:0,y:0}),o.nodeShapes[o.getNodeShape(e)].draw(g||t,be.x,be.y,l,u,ae,f)}p?t.fill(g):t.fill()},wt=function(){for(var be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:d,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,R=c.backgrounding,K=0,Z=0;Z<x.length;Z++){var X=e.cy().style().getIndexedStyle(e,"background-image-containment","value",Z);if(te&&X==="over"||!te&&X==="inside"){K++;continue}_[Z]&&x[Z].complete&&!x[Z].error&&(K++,o.drawInscribedImage(t,x[Z],e,Z,be))}c.backgrounding=K!==S,R!==c.backgrounding&&e.updateStyle(!1)},ot=function(){var be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d;o.hasPie(e)&&(o.drawPie(t,e,te),be&&(p||o.nodeShapes[o.getNodeShape(e)].draw(t,h.x,h.y,l,u,ae,f)))},pe=function(){var be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d;o.hasStripe(e)&&(t.save(),p?t.clip(f.pathCache):(o.nodeShapes[o.getNodeShape(e)].draw(t,h.x,h.y,l,u,ae,f),t.clip()),o.drawStripe(t,e,te),t.restore(),be&&(p||o.nodeShapes[o.getNodeShape(e)].draw(t,h.x,h.y,l,u,ae,f)))},ge=function(){var be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:d,te=(k>0?k:-k)*be,R=k>0?0:255;k!==0&&(o.colorFillStyle(t,R,R,R,te),p?t.fill(g):t.fill())},Ee=function(){if(M>0){if(t.lineWidth=M,t.lineCap=N,t.lineJoin=L,t.setLineDash)switch(B){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash(q),t.lineDashOffset=H;break;case"solid":case"double":t.setLineDash([]);break}if(F!=="center"){if(t.save(),t.lineWidth*=2,F==="inside")p?t.clip(g):t.clip();else{var be=new Path2D;be.rect(-l/2-M,-u/2-M,l+2*M,u+2*M),be.addPath(g),t.clip(be,"evenodd")}p?t.stroke(g):t.stroke(),t.restore()}else p?t.stroke(g):t.stroke();if(B==="double"){t.lineWidth=M/3;var te=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",p?t.stroke(g):t.stroke(),t.globalCompositeOperation=te}t.setLineDash&&t.setLineDash([])}},Te=function(){if(z>0){if(t.lineWidth=z,t.lineCap="butt",t.setLineDash)switch(Q){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash([4,2]);break;case"solid":case"double":t.setLineDash([]);break}var be=h;p&&(be={x:0,y:0});var te=o.getNodeShape(e),R=M;F==="inside"&&(R=0),F==="outside"&&(R*=2);var K=(l+R+(z+ee))/l,Z=(u+R+(z+ee))/u,X=l*K,$=u*Z,ye=o.nodeShapes[te].points,ne;if(p){var we=G(X,$,te,ye);ne=we.path}if(te==="ellipse")o.drawEllipsePath(ne||t,be.x,be.y,X,$);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(te)){var Le=0,Ge=0,ke=0;te==="round-diamond"?Le=(R+ee+z)*1.4:te==="round-heptagon"?(Le=(R+ee+z)*1.075,ke=-(R/2+ee+z)/35):te==="round-hexagon"?Le=(R+ee+z)*1.12:te==="round-pentagon"?(Le=(R+ee+z)*1.13,ke=-(R/2+ee+z)/15):te==="round-tag"?(Le=(R+ee+z)*1.12,Ge=(R/2+z+ee)*.07):te==="round-triangle"&&(Le=(R+ee+z)*(Math.PI/2),ke=-(R+ee/2+z)/Math.PI),Le!==0&&(K=(l+Le)/l,X=l*K,["round-hexagon","round-tag"].includes(te)||(Z=(u+Le)/u,$=u*Z)),ae=ae==="auto"?Ak(X,$):ae;for(var Fe=X/2,Me=$/2,Oe=ae+(R+z+ee)/2,lt=new Array(ye.length/2),Ot=new Array(ye.length/2),$t=0;$t<ye.length/2;$t++)lt[$t]={x:be.x+Ge+Fe*ye[$t*2],y:be.y+ke+Me*ye[$t*2+1]};var Gt,At,Qt,Ft,xr=lt.length;for(At=lt[xr-1],Gt=0;Gt<xr;Gt++)Qt=lt[Gt%xr],Ft=lt[(Gt+1)%xr],Ot[Gt]=r0(At,Qt,Ft,Oe),At=Qt,Qt=Ft;o.drawRoundPolygonPath(ne||t,be.x+Ge,be.y+ke,l*K,u*Z,ye,Ot)}else if(["roundrectangle","round-rectangle"].includes(te))ae=ae==="auto"?Li(X,$):ae,o.drawRoundRectanglePath(ne||t,be.x,be.y,X,$,ae+(R+z+ee)/2);else if(["cutrectangle","cut-rectangle"].includes(te))ae=ae==="auto"?Gy():ae,o.drawCutRectanglePath(ne||t,be.x,be.y,X,$,null,ae+(R+z+ee)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(te))ae=ae==="auto"?Li(X,$):ae,o.drawBottomRoundRectanglePath(ne||t,be.x,be.y,X,$,ae+(R+z+ee)/2);else if(te==="barrel")o.drawBarrelPath(ne||t,be.x,be.y,X,$);else if(te.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(te)){var bn=(R+z+ee)/l;ye=nh(ih(ye,bn)),o.drawPolygonPath(ne||t,be.x,be.y,l,u,ye)}else{var fi=(R+z+ee)/l;ye=nh(ih(ye,-fi)),o.drawPolygonPath(ne||t,be.x,be.y,l,u,ye)}if(p?t.stroke(ne):t.stroke(),Q==="double"){t.lineWidth=R/3;var Un=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",p?t.stroke(ne):t.stroke(),t.globalCompositeOperation=Un}t.setLineDash&&t.setLineDash([])}},Se=function(){a&&o.drawNodeOverlay(t,e,h,l,u)},Ae=function(){a&&o.drawNodeUnderlay(t,e,h,l,u)},De=function(){o.drawElementText(t,e,null,n)},Ye=e.pstyle("ghost").value==="yes";if(Ye){var ft=e.pstyle("ghost-offset-x").pfValue,Tt=e.pstyle("ghost-offset-y").pfValue,Je=e.pstyle("ghost-opacity").value,Dt=Je*d;t.translate(ft,Tt),U(),Te(),ue(Je*P),Pe(),wt(Dt,!0),re(Je*V),Ee(),ot(k!==0||M!==0),pe(k!==0||M!==0),wt(Dt,!1),ge(Dt),t.translate(-ft,-Tt)}p&&t.translate(-h.x,-h.y),Ae(),p&&t.translate(h.x,h.y),U(),Te(),ue(),Pe(),wt(d,!0),re(),Ee(),ot(k!==0||M!==0),pe(k!==0||M!==0),wt(d,!1),ge(),p&&t.translate(-h.x,-h.y),De(),Se(),r&&t.translate(y.x1,y.y1)}};var OA=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(r,n,a,s,o){var l=this;if(n.visible()){var u=n.pstyle("".concat(e,"-padding")).pfValue,c=n.pstyle("".concat(e,"-opacity")).value,f=n.pstyle("".concat(e,"-color")).value,h=n.pstyle("".concat(e,"-shape")).value,d=n.pstyle("".concat(e,"-corner-radius")).value;if(c>0){if(a=a||n.position(),s==null||o==null){var p=n.padding();s=n.width()+2*p,o=n.height()+2*p}l.colorFillStyle(r,f[0],f[1],f[2],c),l.nodeShapes[h].draw(r,a.x,a.y,s+u*2,o+u*2,d),r.fill()}}}};Ui.drawNodeOverlay=OA("overlay");Ui.drawNodeUnderlay=OA("underlay");Ui.hasPie=function(t){return t=t[0],t._private.hasPie};Ui.hasStripe=function(t){return t=t[0],t._private.hasStripe};Ui.drawPie=function(t,e,r,n){e=e[0],n=n||e.position();var a=e.cy().style(),s=e.pstyle("pie-size"),o=e.pstyle("pie-hole"),l=e.pstyle("pie-start-angle").pfValue,u=n.x,c=n.y,f=e.width(),h=e.height(),d=Math.min(f,h)/2,p,g=0,m=this.usePaths();if(m&&(u=0,c=0),s.units==="%"?d=d*s.pfValue:s.pfValue!==void 0&&(d=s.pfValue/2),o.units==="%"?p=d*o.pfValue:o.pfValue!==void 0&&(p=o.pfValue/2),!(p>=d))for(var v=1;v<=a.pieBackgroundN;v++){var y=e.pstyle("pie-"+v+"-background-size").value,b=e.pstyle("pie-"+v+"-background-color").value,w=e.pstyle("pie-"+v+"-background-opacity").value*r,_=y/100;_+g>1&&(_=1-g);var x=1.5*Math.PI+2*Math.PI*g;x+=l;var S=2*Math.PI*_,E=x+S;y===0||g>=1||g+_>1||(p===0?(t.beginPath(),t.moveTo(u,c),t.arc(u,c,d,x,E),t.closePath()):(t.beginPath(),t.arc(u,c,d,x,E),t.arc(u,c,p,E,x,!0),t.closePath()),this.colorFillStyle(t,b[0],b[1],b[2],w),t.fill(),g+=_)}};Ui.drawStripe=function(t,e,r,n){e=e[0],n=n||e.position();var a=e.cy().style(),s=n.x,o=n.y,l=e.width(),u=e.height(),c=0,f=this.usePaths();t.save();var h=e.pstyle("stripe-direction").value,d=e.pstyle("stripe-size");switch(h){case"vertical":break;case"righward":t.rotate(-Math.PI/2);break}var p=l,g=u;d.units==="%"?(p=p*d.pfValue,g=g*d.pfValue):d.pfValue!==void 0&&(p=d.pfValue,g=d.pfValue),f&&(s=0,o=0),o-=p/2,s-=g/2;for(var m=1;m<=a.stripeBackgroundN;m++){var v=e.pstyle("stripe-"+m+"-background-size").value,y=e.pstyle("stripe-"+m+"-background-color").value,b=e.pstyle("stripe-"+m+"-background-opacity").value*r,w=v/100;w+c>1&&(w=1-c),!(v===0||c>=1||c+w>1)&&(t.beginPath(),t.rect(s,o+g*c,p,g*w),t.closePath(),this.colorFillStyle(t,y[0],y[1],y[2],b),t.fill(),c+=w)}t.restore()};var wr={},NK=100;wr.getPixelRatio=function(){var t=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var e=this.cy.window(),r=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(e.devicePixelRatio||1)/r};wr.paintCache=function(t){for(var e=this.paintCaches=this.paintCaches||[],r=!0,n,a=0;a<e.length;a++)if(n=e[a],n.context===t){r=!1;break}return r&&(n={context:t},e.push(n)),n};wr.createGradientStyleFor=function(t,e,r,n,a){var s,o=this.usePaths(),l=r.pstyle(e+"-gradient-stop-colors").value,u=r.pstyle(e+"-gradient-stop-positions").pfValue;if(n==="radial-gradient")if(r.isEdge()){var c=r.sourceEndpoint(),f=r.targetEndpoint(),h=r.midpoint(),d=Ba(c,h),p=Ba(f,h);s=t.createRadialGradient(h.x,h.y,0,h.x,h.y,Math.max(d,p))}else{var g=o?{x:0,y:0}:r.position(),m=r.paddedWidth(),v=r.paddedHeight();s=t.createRadialGradient(g.x,g.y,0,g.x,g.y,Math.max(m,v))}else if(r.isEdge()){var y=r.sourceEndpoint(),b=r.targetEndpoint();s=t.createLinearGradient(y.x,y.y,b.x,b.y)}else{var w=o?{x:0,y:0}:r.position(),_=r.paddedWidth(),x=r.paddedHeight(),S=_/2,E=x/2,A=r.pstyle("background-gradient-direction").value;switch(A){case"to-bottom":s=t.createLinearGradient(w.x,w.y-E,w.x,w.y+E);break;case"to-top":s=t.createLinearGradient(w.x,w.y+E,w.x,w.y-E);break;case"to-left":s=t.createLinearGradient(w.x+S,w.y,w.x-S,w.y);break;case"to-right":s=t.createLinearGradient(w.x-S,w.y,w.x+S,w.y);break;case"to-bottom-right":case"to-right-bottom":s=t.createLinearGradient(w.x-S,w.y-E,w.x+S,w.y+E);break;case"to-top-right":case"to-right-top":s=t.createLinearGradient(w.x-S,w.y+E,w.x+S,w.y-E);break;case"to-bottom-left":case"to-left-bottom":s=t.createLinearGradient(w.x+S,w.y-E,w.x-S,w.y+E);break;case"to-top-left":case"to-left-top":s=t.createLinearGradient(w.x+S,w.y+E,w.x-S,w.y-E);break}}if(!s)return null;for(var T=u.length===l.length,D=l.length,k=0;k<D;k++)s.addColorStop(T?u[k]:k/(D-1),"rgba("+l[k][0]+","+l[k][1]+","+l[k][2]+","+a+")");return s};wr.gradientFillStyle=function(t,e,r,n){var a=this.createGradientStyleFor(t,"background",e,r,n);if(!a)return null;t.fillStyle=a};wr.colorFillStyle=function(t,e,r,n,a){t.fillStyle="rgba("+e+","+r+","+n+","+a+")"};wr.eleFillStyle=function(t,e,r){var n=e.pstyle("background-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientFillStyle(t,e,n,r);else{var a=e.pstyle("background-color").value;this.colorFillStyle(t,a[0],a[1],a[2],r)}};wr.gradientStrokeStyle=function(t,e,r,n){var a=this.createGradientStyleFor(t,"line",e,r,n);if(!a)return null;t.strokeStyle=a};wr.colorStrokeStyle=function(t,e,r,n,a){t.strokeStyle="rgba("+e+","+r+","+n+","+a+")"};wr.eleStrokeStyle=function(t,e,r){var n=e.pstyle("line-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientStrokeStyle(t,e,n,r);else{var a=e.pstyle("line-color").value;this.colorStrokeStyle(t,a[0],a[1],a[2],r)}};wr.matchCanvasSize=function(t){var e=this,r=e.data,n=e.findContainerClientCoords(),a=n[2],s=n[3],o=e.getPixelRatio(),l=e.motionBlurPxRatio;(t===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]||t===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG])&&(o=l);var u=a*o,c=s*o,f;if(!(u===e.canvasWidth&&c===e.canvasHeight)){e.fontCaches=null;var h=r.canvasContainer;h.style.width=a+"px",h.style.height=s+"px";for(var d=0;d<e.CANVAS_LAYERS;d++)f=r.canvases[d],f.width=u,f.height=c,f.style.width=a+"px",f.style.height=s+"px";for(var d=0;d<e.BUFFER_COUNT;d++)f=r.bufferCanvases[d],f.width=u,f.height=c,f.style.width=a+"px",f.style.height=s+"px";e.textureMult=1,o<=1&&(f=r.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,f.width=u*e.textureMult,f.height=c*e.textureMult),e.canvasWidth=u,e.canvasHeight=c,e.pixelRatio=o}};wr.renderTo=function(t,e,r,n){this.render({forcedContext:t,forcedZoom:e,forcedPan:r,drawAllLayers:!0,forcedPxRatio:n})};wr.clearCanvas=function(){var t=this,e=t.data;function r(n){n.clearRect(0,0,t.canvasWidth,t.canvasHeight)}r(e.contexts[t.NODE]),r(e.contexts[t.DRAG])};wr.render=function(t){var e=this;t=t||Ek();var r=e.cy,n=t.forcedContext,a=t.drawAllLayers,s=t.drawOnlyNodeLayer,o=t.forcedZoom,l=t.forcedPan,u=t.forcedPxRatio===void 0?this.getPixelRatio():t.forcedPxRatio,c=e.data,f=c.canvasNeedsRedraw,h=e.textureOnViewport&&!n&&(e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming),d=t.motionBlur!==void 0?t.motionBlur:e.motionBlur,p=e.motionBlurPxRatio,g=r.hasCompoundNodes(),m=e.hoverData.draggingEles,v=!!(e.hoverData.selecting||e.touchData.selecting);d=d&&!n&&e.motionBlurEnabled&&!v;var y=d;n||(e.prevPxRatio!==u&&(e.invalidateContainerClientCoordsCache(),e.matchCanvasSize(e.container),e.redrawHint("eles",!0),e.redrawHint("drag",!0)),e.prevPxRatio=u),!n&&e.motionBlurTimeout&&clearTimeout(e.motionBlurTimeout),d&&(e.mbFrames==null&&(e.mbFrames=0),e.mbFrames++,e.mbFrames<3&&(y=!1),e.mbFrames>e.minMbLowQualFrames&&(e.motionBlurPxRatio=e.mbPxRBlurry)),e.clearingMotionBlur&&(e.motionBlurPxRatio=1),e.textureDrawLastFrame&&!h&&(f[e.NODE]=!0,f[e.SELECT_BOX]=!0);var b=r.style(),w=r.zoom(),_=o!==void 0?o:w,x=r.pan(),S={x:x.x,y:x.y},E={zoom:w,pan:{x:x.x,y:x.y}},A=e.prevViewport,T=A===void 0||E.zoom!==A.zoom||E.pan.x!==A.pan.x||E.pan.y!==A.pan.y;!T&&!(m&&!g)&&(e.motionBlurPxRatio=1),l&&(S=l),_*=u,S.x*=u,S.y*=u;var D=e.getCachedZSortedEles();function k(re,U,G,j,se){var fe=re.globalCompositeOperation;re.globalCompositeOperation="destination-out",e.colorFillStyle(re,255,255,255,e.motionBlurTransparency),re.fillRect(U,G,j,se),re.globalCompositeOperation=fe}function M(re,U){var G,j,se,fe;!e.clearingMotionBlur&&(re===c.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]||re===c.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG])?(G={x:x.x*p,y:x.y*p},j=w*p,se=e.canvasWidth*p,fe=e.canvasHeight*p):(G=S,j=_,se=e.canvasWidth,fe=e.canvasHeight),re.setTransform(1,0,0,1,0,0),U==="motionBlur"?k(re,0,0,se,fe):!n&&(U===void 0||U)&&re.clearRect(0,0,se,fe),a||(re.translate(G.x,G.y),re.scale(j,j)),l&&re.translate(l.x,l.y),o&&re.scale(o,o)}if(h||(e.textureDrawLastFrame=!1),h){if(e.textureDrawLastFrame=!0,!e.textureCache){e.textureCache={},e.textureCache.bb=r.mutableElements().boundingBox(),e.textureCache.texture=e.data.bufferCanvases[e.TEXTURE_BUFFER];var P=e.data.bufferContexts[e.TEXTURE_BUFFER];P.setTransform(1,0,0,1,0,0),P.clearRect(0,0,e.canvasWidth*e.textureMult,e.canvasHeight*e.textureMult),e.render({forcedContext:P,drawOnlyNodeLayer:!0,forcedPxRatio:u*e.textureMult});var E=e.textureCache.viewport={zoom:r.zoom(),pan:r.pan(),width:e.canvasWidth,height:e.canvasHeight};E.mpan={x:(0-E.pan.x)/E.zoom,y:(0-E.pan.y)/E.zoom}}f[e.DRAG]=!1,f[e.NODE]=!1;var I=c.contexts[e.NODE],B=e.textureCache.texture,E=e.textureCache.viewport;I.setTransform(1,0,0,1,0,0),d?k(I,0,0,E.width,E.height):I.clearRect(0,0,E.width,E.height);var L=b.core("outside-texture-bg-color").value,N=b.core("outside-texture-bg-opacity").value;e.colorFillStyle(I,L[0],L[1],L[2],N),I.fillRect(0,0,E.width,E.height);var w=r.zoom();M(I,!1),I.clearRect(E.mpan.x,E.mpan.y,E.width/E.zoom/u,E.height/E.zoom/u),I.drawImage(B,E.mpan.x,E.mpan.y,E.width/E.zoom/u,E.height/E.zoom/u)}else e.textureOnViewport&&!n&&(e.textureCache=null);var F=r.extent(),q=e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming||e.hoverData.draggingEles||e.cy.animated(),H=e.hideEdgesOnViewport&&q,V=[];if(V[e.NODE]=!f[e.NODE]&&d&&!e.clearedForMotionBlur[e.NODE]||e.clearingMotionBlur,V[e.NODE]&&(e.clearedForMotionBlur[e.NODE]=!0),V[e.DRAG]=!f[e.DRAG]&&d&&!e.clearedForMotionBlur[e.DRAG]||e.clearingMotionBlur,V[e.DRAG]&&(e.clearedForMotionBlur[e.DRAG]=!0),f[e.NODE]||a||s||V[e.NODE]){var z=d&&!V[e.NODE]&&p!==1,I=n||(z?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]:c.contexts[e.NODE]),Y=d&&!z?"motionBlur":void 0;M(I,Y),H?e.drawCachedNodes(I,D.nondrag,u,F):e.drawLayeredElements(I,D.nondrag,u,F),e.debug&&e.drawDebugPoints(I,D.nondrag),!a&&!d&&(f[e.NODE]=!1)}if(!s&&(f[e.DRAG]||a||V[e.DRAG])){var z=d&&!V[e.DRAG]&&p!==1,I=n||(z?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG]:c.contexts[e.DRAG]);M(I,d&&!z?"motionBlur":void 0),H?e.drawCachedNodes(I,D.drag,u,F):e.drawCachedElements(I,D.drag,u,F),e.debug&&e.drawDebugPoints(I,D.drag),!a&&!d&&(f[e.DRAG]=!1)}if(this.drawSelectionRectangle(t,M),d&&p!==1){var Q=c.contexts[e.NODE],J=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE],ee=c.contexts[e.DRAG],ae=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG],ue=function(U,G,j){U.setTransform(1,0,0,1,0,0),j||!y?U.clearRect(0,0,e.canvasWidth,e.canvasHeight):k(U,0,0,e.canvasWidth,e.canvasHeight);var se=p;U.drawImage(G,0,0,e.canvasWidth*se,e.canvasHeight*se,0,0,e.canvasWidth,e.canvasHeight)};(f[e.NODE]||V[e.NODE])&&(ue(Q,J,V[e.NODE]),f[e.NODE]=!1),(f[e.DRAG]||V[e.DRAG])&&(ue(ee,ae,V[e.DRAG]),f[e.DRAG]=!1)}e.prevViewport=E,e.clearingMotionBlur&&(e.clearingMotionBlur=!1,e.motionBlurCleared=!0,e.motionBlur=!0),d&&(e.motionBlurTimeout=setTimeout(function(){e.motionBlurTimeout=null,e.clearedForMotionBlur[e.NODE]=!1,e.clearedForMotionBlur[e.DRAG]=!1,e.motionBlur=!1,e.clearingMotionBlur=!h,e.mbFrames=0,f[e.NODE]=!0,f[e.DRAG]=!0,e.redraw()},NK)),n||r.emit("render")};var Tl;wr.drawSelectionRectangle=function(t,e){var r=this,n=r.cy,a=r.data,s=n.style(),o=t.drawOnlyNodeLayer,l=t.drawAllLayers,u=a.canvasNeedsRedraw,c=t.forcedContext;if(r.showFps||!o&&u[r.SELECT_BOX]&&!l){var f=c||a.contexts[r.SELECT_BOX];if(e(f),r.selection[4]==1&&(r.hoverData.selecting||r.touchData.selecting)){var h=r.cy.zoom(),d=s.core("selection-box-border-width").value/h;f.lineWidth=d,f.fillStyle="rgba("+s.core("selection-box-color").value[0]+","+s.core("selection-box-color").value[1]+","+s.core("selection-box-color").value[2]+","+s.core("selection-box-opacity").value+")",f.fillRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]),d>0&&(f.strokeStyle="rgba("+s.core("selection-box-border-color").value[0]+","+s.core("selection-box-border-color").value[1]+","+s.core("selection-box-border-color").value[2]+","+s.core("selection-box-opacity").value+")",f.strokeRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]))}if(a.bgActivePosistion&&!r.hoverData.selecting){var h=r.cy.zoom(),p=a.bgActivePosistion;f.fillStyle="rgba("+s.core("active-bg-color").value[0]+","+s.core("active-bg-color").value[1]+","+s.core("active-bg-color").value[2]+","+s.core("active-bg-opacity").value+")",f.beginPath(),f.arc(p.x,p.y,s.core("active-bg-size").pfValue/h,0,2*Math.PI),f.fill()}var g=r.lastRedrawTime;if(r.showFps&&g){g=Math.round(g);var m=Math.round(1e3/g),v="1 frame = "+g+" ms = "+m+" fps";if(f.setTransform(1,0,0,1,0,0),f.fillStyle="rgba(255, 0, 0, 0.75)",f.strokeStyle="rgba(255, 0, 0, 0.75)",f.font="30px Arial",!Tl){var y=f.measureText(v);Tl=y.actualBoundingBoxAscent}f.fillText(v,0,Tl);var b=60;f.strokeRect(0,Tl+10,250,20),f.fillRect(0,Tl+10,250*Math.min(m/b,1),20)}l||(u[r.SELECT_BOX]=!1)}};function XT(t,e,r){var n=t.createShader(e);if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(n));return n}function FK(t,e,r){var n=XT(t,t.VERTEX_SHADER,e),a=XT(t,t.FRAGMENT_SHADER,r),s=t.createProgram();if(t.attachShader(s,n),t.attachShader(s,a),t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS))throw new Error("Could not initialize shaders");return s}function qK(t,e,r){r===void 0&&(r=e);var n=t.makeOffscreenCanvas(e,r),a=n.context=n.getContext("2d");return n.clear=function(){return a.clearRect(0,0,n.width,n.height)},n.clear(),n}function a0(t){var e=t.pixelRatio,r=t.cy.zoom(),n=t.cy.pan();return{zoom:r*e,pan:{x:n.x*e,y:n.y*e}}}function VK(t){var e=t.pixelRatio,r=t.cy.zoom();return r*e}function zK(t,e,r,n,a){var s=n*r+e.x,o=a*r+e.y;return o=Math.round(t.canvasHeight-o),[s,o]}function HK(t){return t.pstyle("background-fill").value!=="solid"||t.pstyle("background-image").strValue!=="none"?!1:t.pstyle("border-width").value===0||t.pstyle("border-opacity").value===0?!0:t.pstyle("border-style").value==="solid"}function UK(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Ta(t,e,r){var n=t[0]/255,a=t[1]/255,s=t[2]/255,o=e,l=r||new Array(4);return l[0]=n*o,l[1]=a*o,l[2]=s*o,l[3]=o,l}function Os(t,e){var r=e||new Array(4);return r[0]=(t>>0&255)/255,r[1]=(t>>8&255)/255,r[2]=(t>>16&255)/255,r[3]=(t>>24&255)/255,r}function WK(t){return t[0]+(t[1]<<8)+(t[2]<<16)+(t[3]<<24)}function GK(t,e){var r=t.createTexture();return r.buffer=function(n){t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n),t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null)},r.deleteTexture=function(){t.deleteTexture(r)},r}function IA(t,e){switch(e){case"float":return[1,t.FLOAT,4];case"vec2":return[2,t.FLOAT,4];case"vec3":return[3,t.FLOAT,4];case"vec4":return[4,t.FLOAT,4];case"int":return[1,t.INT,4];case"ivec2":return[2,t.INT,4]}}function BA(t,e,r){switch(e){case t.FLOAT:return new Float32Array(r);case t.INT:return new Int32Array(r)}}function KK(t,e,r,n,a,s){switch(e){case t.FLOAT:return new Float32Array(r.buffer,s*n,a);case t.INT:return new Int32Array(r.buffer,s*n,a)}}function jK(t,e,r,n){var a=IA(t,e),s=zt(a,2),o=s[0],l=s[1],u=BA(t,l,n),c=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,c),t.bufferData(t.ARRAY_BUFFER,u,t.STATIC_DRAW),l===t.FLOAT?t.vertexAttribPointer(r,o,l,!1,0,0):l===t.INT&&t.vertexAttribIPointer(r,o,l,0,0),t.enableVertexAttribArray(r),t.bindBuffer(t.ARRAY_BUFFER,null),c}function On(t,e,r,n){var a=IA(t,r),s=zt(a,3),o=s[0],l=s[1],u=s[2],c=BA(t,l,e*o),f=o*u,h=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,h),t.bufferData(t.ARRAY_BUFFER,e*f,t.DYNAMIC_DRAW),t.enableVertexAttribArray(n),l===t.FLOAT?t.vertexAttribPointer(n,o,l,!1,f,0):l===t.INT&&t.vertexAttribIPointer(n,o,l,f,0),t.vertexAttribDivisor(n,1),t.bindBuffer(t.ARRAY_BUFFER,null);for(var d=new Array(e),p=0;p<e;p++)d[p]=KK(t,l,c,f,o,p);return h.dataArray=c,h.stride=f,h.size=o,h.getView=function(g){return d[g]},h.setPoint=function(g,m,v){var y=d[g];y[0]=m,y[1]=v},h.bufferSubData=function(g){t.bindBuffer(t.ARRAY_BUFFER,h),g?t.bufferSubData(t.ARRAY_BUFFER,0,c,0,g*o):t.bufferSubData(t.ARRAY_BUFFER,0,c)},h}function YK(t,e,r){for(var n=9,a=new Float32Array(e*n),s=new Array(e),o=0;o<e;o++){var l=o*n*4;s[o]=new Float32Array(a.buffer,l,n)}var u=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferData(t.ARRAY_BUFFER,a.byteLength,t.DYNAMIC_DRAW);for(var c=0;c<3;c++){var f=r+c;t.enableVertexAttribArray(f),t.vertexAttribPointer(f,3,t.FLOAT,!1,3*12,c*12),t.vertexAttribDivisor(f,1)}return t.bindBuffer(t.ARRAY_BUFFER,null),u.getMatrixView=function(h){return s[h]},u.setData=function(h,d){s[d].set(h,0)},u.bufferSubData=function(){t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferSubData(t.ARRAY_BUFFER,0,a)},u}function ZK(t){var e=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,e);var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.bindFramebuffer(t.FRAMEBUFFER,null),e.setFramebufferAttachmentSizes=function(n,a){t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n,a,0,t.RGBA,t.UNSIGNED_BYTE,null)},e}var $T=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function uy(){var t=new $T(9);return $T!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function QT(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function XK(t,e,r){var n=e[0],a=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],f=e[7],h=e[8],d=r[0],p=r[1],g=r[2],m=r[3],v=r[4],y=r[5],b=r[6],w=r[7],_=r[8];return t[0]=d*n+p*o+g*c,t[1]=d*a+p*l+g*f,t[2]=d*s+p*u+g*h,t[3]=m*n+v*o+y*c,t[4]=m*a+v*l+y*f,t[5]=m*s+v*u+y*h,t[6]=b*n+w*o+_*c,t[7]=b*a+w*l+_*f,t[8]=b*s+w*u+_*h,t}function Qf(t,e,r){var n=e[0],a=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],f=e[7],h=e[8],d=r[0],p=r[1];return t[0]=n,t[1]=a,t[2]=s,t[3]=o,t[4]=l,t[5]=u,t[6]=d*n+p*o+c,t[7]=d*a+p*l+f,t[8]=d*s+p*u+h,t}function JT(t,e,r){var n=e[0],a=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],f=e[7],h=e[8],d=Math.sin(r),p=Math.cos(r);return t[0]=p*n+d*o,t[1]=p*a+d*l,t[2]=p*s+d*u,t[3]=p*o-d*n,t[4]=p*l-d*a,t[5]=p*u-d*s,t[6]=c,t[7]=f,t[8]=h,t}function Ry(t,e,r){var n=r[0],a=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function $K(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}var QK=function(){function t(e,r,n,a){Vi(this,t),this.debugID=Math.floor(Math.random()*1e4),this.r=e,this.texSize=r,this.texRows=n,this.texHeight=Math.floor(r/n),this.enableWrapping=!0,this.locked=!1,this.texture=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=a(e,r,r),this.scratch=a(e,r,this.texHeight,"scratch")}return zi(t,[{key:"lock",value:function(){this.locked=!0}},{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(r){var n=r.w,a=r.h,s=this.texHeight,o=this.texSize,l=s/a,u=n*l,c=a*l;return u>o&&(l=o/n,u=n*l,c=a*l),{scale:l,texW:u,texH:c}}},{key:"draw",value:function(r,n,a){var s=this;if(this.locked)throw new Error("can't draw, atlas is locked");var o=this.texSize,l=this.texRows,u=this.texHeight,c=this.getScale(n),f=c.scale,h=c.texW,d=c.texH,p=function(w,_){if(a&&_){var x=_.context,S=w.x,E=w.row,A=S,T=u*E;x.save(),x.translate(A,T),x.scale(f,f),a(x,n),x.restore()}},g=[null,null],m=function(){p(s.freePointer,s.canvas),g[0]={x:s.freePointer.x,y:s.freePointer.row*u,w:h,h:d},g[1]={x:s.freePointer.x+h,y:s.freePointer.row*u,w:0,h:d},s.freePointer.x+=h,s.freePointer.x==o&&(s.freePointer.x=0,s.freePointer.row++)},v=function(){var w=s.scratch,_=s.canvas;w.clear(),p({x:0,row:0},w);var x=o-s.freePointer.x,S=h-x,E=u;{var A=s.freePointer.x,T=s.freePointer.row*u,D=x;_.context.drawImage(w,0,0,D,E,A,T,D,E),g[0]={x:A,y:T,w:D,h:d}}{var k=x,M=(s.freePointer.row+1)*u,P=S;_&&_.context.drawImage(w,k,0,P,E,0,M,P,E),g[1]={x:0,y:M,w:P,h:d}}s.freePointer.x=S,s.freePointer.row++},y=function(){s.freePointer.x=0,s.freePointer.row++};if(this.freePointer.x+h<=o)m();else{if(this.freePointer.row>=l-1)return!1;this.freePointer.x===o?(y(),m()):this.enableWrapping?v():(y(),m())}return this.keyToLocation.set(r,g),this.needsBuffer=!0,g}},{key:"getOffsets",value:function(r){return this.keyToLocation.get(r)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(r){if(this.locked)return!1;var n=this.texSize,a=this.texRows,s=this.getScale(r),o=s.texW;return this.freePointer.x+o>n?this.freePointer.row<a-1:!0}},{key:"bufferIfNeeded",value:function(r){this.texture||(this.texture=GK(r,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1,this.locked&&(this.canvas=null,this.scratch=null))}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null),this.canvas=null,this.scratch=null,this.locked=!0}}])}(),JK=function(){function t(e,r,n,a){Vi(this,t),this.r=e,this.texSize=r,this.texRows=n,this.createTextureCanvas=a,this.atlases=[],this.styleKeyToAtlas=new Map,this.markedKeys=new Set}return zi(t,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function(){var r=this.r,n=this.texSize,a=this.texRows,s=this.createTextureCanvas;return new QK(r,n,a,s)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var r=this.r,n=this.texSize,a=this.texRows,s=this.createTextureCanvas,o=Math.floor(n/a);this.scratch=s(r,n,o,"scratch")}return this.scratch}},{key:"draw",value:function(r,n,a){var s=this.styleKeyToAtlas.get(r);return s||(s=this.atlases[this.atlases.length-1],(!s||!s.canFit(n))&&(s&&s.lock(),s=this._createAtlas(),this.atlases.push(s)),s.draw(r,n,a),this.styleKeyToAtlas.set(r,s)),s}},{key:"getAtlas",value:function(r){return this.styleKeyToAtlas.get(r)}},{key:"hasAtlas",value:function(r){return this.styleKeyToAtlas.has(r)}},{key:"markKeyForGC",value:function(r){this.markedKeys.add(r)}},{key:"gc",value:function(){var r=this,n=this.markedKeys;if(n.size===0){console.log("nothing to garbage collect");return}var a=[],s=new Map,o=null,l=Ir(this.atlases),u;try{var c=function(){var h=u.value,d=h.getKeys(),p=e9(n,d);if(p.size===0)return a.push(h),d.forEach(function(x){return s.set(x,h)}),1;o||(o=r._createAtlas(),a.push(o));var g=Ir(d),m;try{for(g.s();!(m=g.n()).done;){var v=m.value;if(!p.has(v)){var y=h.getOffsets(v),b=zt(y,2),w=b[0],_=b[1];o.canFit({w:w.w+_.w,h:w.h})||(o.lock(),o=r._createAtlas(),a.push(o)),h.canvas&&(r._copyTextureToNewAtlas(v,h,o),s.set(v,o))}}}catch(x){g.e(x)}finally{g.f()}h.dispose()};for(l.s();!(u=l.n()).done;)c()}catch(f){l.e(f)}finally{l.f()}this.atlases=a,this.styleKeyToAtlas=s,this.markedKeys=new Set}},{key:"_copyTextureToNewAtlas",value:function(r,n,a){var s=n.getOffsets(r),o=zt(s,2),l=o[0],u=o[1];if(u.w===0)a.draw(r,l,function(d){d.drawImage(n.canvas,l.x,l.y,l.w,l.h,0,0,l.w,l.h)});else{var c=this._getScratchCanvas();c.clear(),c.context.drawImage(n.canvas,l.x,l.y,l.w,l.h,0,0,l.w,l.h),c.context.drawImage(n.canvas,u.x,u.y,u.w,u.h,l.w,0,u.w,u.h);var f=l.w+u.w,h=l.h;a.draw(r,{w:f,h},function(d){d.drawImage(c,0,0,f,h,0,0,f,h)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}])}();function e9(t,e){return t.intersection?t.intersection(e):new Set(Jf(t).filter(function(r){return e.has(r)}))}var t9=function(){function t(e,r){Vi(this,t),this.r=e,this.globalOptions=r,this.atlasSize=r.webglTexSize,this.maxAtlasesPerBatch=r.webglTexPerBatch,this.renderTypes=new Map,this.collections=new Map,this.typeAndIdToKey=new Map}return zi(t,[{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"addAtlasCollection",value:function(r,n){var a=this.globalOptions,s=a.webglTexSize,o=a.createTextureCanvas,l=n.texRows,u=this._cacheScratchCanvas(o),c=new JK(this.r,s,l,u);this.collections.set(r,c)}},{key:"addRenderType",value:function(r,n){var a=n.collection;if(!this.collections.has(a))throw new Error("invalid atlas collection name '".concat(a,"'"));var s=this.collections.get(a),o=Ce({type:r,atlasCollection:s},n);this.renderTypes.set(r,o)}},{key:"getRenderTypeOpts",value:function(r){return this.renderTypes.get(r)}},{key:"getAtlasCollection",value:function(r){return this.collections.get(r)}},{key:"_cacheScratchCanvas",value:function(r){var n=-1,a=-1,s=null;return function(o,l,u,c){return c?((!s||l!=n||u!=a)&&(n=l,a=u,s=r(o,l,u)),s):r(o,l,u)}}},{key:"_key",value:function(r,n){return"".concat(r,"-").concat(n)}},{key:"invalidate",value:function(r){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=a.forceRedraw,o=s===void 0?!1:s,l=a.filterEle,u=l===void 0?function(){return!0}:l,c=a.filterType,f=c===void 0?function(){return!0}:c,h=!1,d=!1,p=Ir(r),g;try{for(p.s();!(g=p.n()).done;){var m=g.value;if(u(m)){var v=Ir(this.renderTypes.values()),y;try{var b=function(){var _=y.value,x=_.type;if(f(x)){var S=n.collections.get(_.collection),E=_.getKey(m),A=Array.isArray(E)?E:[E];if(o)A.forEach(function(M){return S.markKeyForGC(M)}),d=!0;else{var T=_.getID?_.getID(m):m.id(),D=n._key(x,T),k=n.typeAndIdToKey.get(D);k!==void 0&&!UK(A,k)&&(h=!0,n.typeAndIdToKey.delete(D),k.forEach(function(M){return S.markKeyForGC(M)}))}}};for(v.s();!(y=v.n()).done;)b()}catch(w){v.e(w)}finally{v.f()}}}}catch(w){p.e(w)}finally{p.f()}return d&&(this.gc(),h=!1),h}},{key:"gc",value:function(){var r=Ir(this.collections.values()),n;try{for(r.s();!(n=r.n()).done;){var a=n.value;a.gc()}}catch(s){r.e(s)}finally{r.f()}}},{key:"getOrCreateAtlas",value:function(r,n,a,s){var o=this.renderTypes.get(n),l=this.collections.get(o.collection),u=!1,c=l.draw(s,a,function(d){o.drawClipped?(d.save(),d.beginPath(),d.rect(0,0,a.w,a.h),d.clip(),o.drawElement(d,r,a,!0,!0),d.restore()):o.drawElement(d,r,a,!0,!0),u=!0});if(u){var f=o.getID?o.getID(r):r.id(),h=this._key(n,f);this.typeAndIdToKey.has(h)?this.typeAndIdToKey.get(h).push(s):this.typeAndIdToKey.set(h,[s])}return c}},{key:"getAtlasInfo",value:function(r,n){var a=this,s=this.renderTypes.get(n),o=s.getKey(r),l=Array.isArray(o)?o:[o];return l.map(function(u){var c=s.getBoundingBox(r,u),f=a.getOrCreateAtlas(r,n,c,u),h=f.getOffsets(u),d=zt(h,2),p=d[0],g=d[1];return{atlas:f,tex:p,tex1:p,tex2:g,bb:c}})}},{key:"getDebugInfo",value:function(){var r=[],n=Ir(this.collections),a;try{for(n.s();!(a=n.n()).done;){var s=zt(a.value,2),o=s[0],l=s[1],u=l.getCounts(),c=u.keyCount,f=u.atlasCount;r.push({type:o,keyCount:c,atlasCount:f})}}catch(h){n.e(h)}finally{n.f()}return r}}])}(),r9=function(){function t(e){Vi(this,t),this.globalOptions=e,this.atlasSize=e.webglTexSize,this.maxAtlasesPerBatch=e.webglTexPerBatch,this.batchAtlases=[]}return zi(t,[{key:"getMaxAtlasesPerBatch",value:function(){return this.maxAtlasesPerBatch}},{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlasesPerBatch},function(r,n){return n})}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function(r){return this.batchAtlases.length===this.maxAtlasesPerBatch?this.batchAtlases.includes(r):!0}},{key:"getAtlasIndexForBatch",value:function(r){var n=this.batchAtlases.indexOf(r);if(n<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)throw new Error("cannot add more atlases to batch");this.batchAtlases.push(r),n=this.batchAtlases.length-1}return n}}])}(),n9=`
  float circleSD(vec2 p, float r) {
    return distance(vec2(0), p) - r; // signed distance
  }
`,i9=`
  float rectangleSD(vec2 p, vec2 b) {
    vec2 d = abs(p)-b;
    return distance(vec2(0),max(d,0.0)) + min(max(d.x,d.y),0.0);
  }
`,a9=`
  float roundRectangleSD(vec2 p, vec2 b, vec4 cr) {
    cr.xy = (p.x > 0.0) ? cr.xy : cr.zw;
    cr.x  = (p.y > 0.0) ? cr.x  : cr.y;
    vec2 q = abs(p) - b + cr.x;
    return min(max(q.x, q.y), 0.0) + distance(vec2(0), max(q, 0.0)) - cr.x;
  }
`,s9=`
  float ellipseSD(vec2 p, vec2 ab) {
    p = abs( p ); // symmetry

    // find root with Newton solver
    vec2 q = ab*(p-ab);
    float w = (q.x<q.y)? 1.570796327 : 0.0;
    for( int i=0; i<5; i++ ) {
      vec2 cs = vec2(cos(w),sin(w));
      vec2 u = ab*vec2( cs.x,cs.y);
      vec2 v = ab*vec2(-cs.y,cs.x);
      w = w + dot(p-u,v)/(dot(p-u,u)+dot(v,v));
    }
    
    // compute final point and distance
    float d = length(p-ab*vec2(cos(w),sin(w)));
    
    // return signed distance
    return (dot(p/ab,p/ab)>1.0) ? d : -d;
  }
`,Il={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},fh={IGNORE:1,USE_BB:2},cy=0,ek=1,tk=2,fy=3,Is=4,zf=5,kl=6,Al=7,o9=function(){function t(e,r,n){Vi(this,t),this.r=e,this.gl=r,this.maxInstances=n.webglBatchSize,this.atlasSize=n.webglTexSize,this.bgColor=n.bgColor,this.debug=n.webglDebug,this.batchDebugInfo=[],n.enableWrapping=!0,n.createTextureCanvas=qK,this.atlasManager=new t9(e,n),this.batchManager=new r9(n),this.simpleShapeOptions=new Map,this.program=this._createShaderProgram(Il.SCREEN),this.pickingProgram=this._createShaderProgram(Il.PICKING),this.vao=this._createVAO()}return zi(t,[{key:"addAtlasCollection",value:function(r,n){this.atlasManager.addAtlasCollection(r,n)}},{key:"addTextureAtlasRenderType",value:function(r,n){this.atlasManager.addRenderType(r,n)}},{key:"addSimpleShapeRenderType",value:function(r,n){this.simpleShapeOptions.set(r,n)}},{key:"invalidate",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.type,s=this.atlasManager;return a?s.invalidate(r,{filterType:function(l){return l===a},forceRedraw:!0}):s.invalidate(r)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"_createShaderProgram",value:function(r){var n=this.gl,a=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; // a vertex from the unit square
      
      in mat3 aTransform; // used to transform verticies, eg into a bounding box
      in int aVertType; // the type of thing we are rendering

      // the z-index that is output when using picking mode
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex; // x/y/w/h of texture in atlas

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in vec2 aLineWidth; // also used for node border width

      // simple shapes
      in vec4 aCornerRadius; // for round-rectangle [top-right, bottom-right, top-left, bottom-left]
      in vec4 aColor; // also used for edges
      in vec4 aBorderColor; // aLineWidth is used for border width

      // output values passed to the fragment shader
      out vec2 vTexCoord;
      out vec4 vColor;
      out vec2 vPosition;
      // flat values are not interpolated
      flat out int vAtlasId; 
      flat out int vVertType;
      flat out vec2 vTopRight;
      flat out vec2 vBotLeft;
      flat out vec4 vCornerRadius;
      flat out vec4 vBorderColor;
      flat out vec2 vBorderWidth;
      flat out vec4 vIndex;
      
      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition; // TODO make this a vec3, simplifies some code below

        if(aVertType == `.concat(cy,`) {
          float texX = aTex.x; // texture coordinates
          float texY = aTex.y;
          float texW = aTex.z;
          float texH = aTex.w;

          if(vid == 1 || vid == 2 || vid == 4) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(Is," || aVertType == ").concat(Al,` 
             || aVertType == `).concat(zf," || aVertType == ").concat(kl,`) { // simple shapes

          // the bounding box is needed by the fragment shader
          vBotLeft  = (aTransform * vec3(0, 0, 1)).xy; // flat
          vTopRight = (aTransform * vec3(1, 1, 1)).xy; // flat
          vPosition = (aTransform * vec3(position, 1)).xy; // will be interpolated

          // calculations are done in the fragment shader, just pass these along
          vColor = aColor;
          vCornerRadius = aCornerRadius;
          vBorderColor = aBorderColor;
          vBorderWidth = aLineWidth;

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(ek,`) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          // stretch the unit square into a long skinny rectangle
          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth[0] * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vColor = aColor;
        } 
        else if(aVertType == `).concat(tk,`) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0, p1, p2, pos;
          if(position.x == 0.0) { // The left side of the unit square
            p0 = pointA;
            p1 = pointB;
            p2 = pointC;
            pos = position;
          } else { // The right side of the unit square, use same approach but flip the geometry upside down
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth[0];

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vColor = aColor;
        } 
        else if(aVertType == `).concat(fy,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2(  0.0,  0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
          vColor = aColor;
        }
        else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vVertType = aVertType;
        vIndex = aIndex;
      }
    `),s=this.batchManager.getIndexArray(),o=`#version 300 es
      precision highp float;

      // declare texture unit for each texture atlas in the batch
      `.concat(s.map(function(c){return"uniform sampler2D uTexture".concat(c,";")}).join(`
	`),`

      uniform vec4 uBGColor;
      uniform float uZoom;

      in vec2 vTexCoord;
      in vec4 vColor;
      in vec2 vPosition; // model coordinates

      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;
      flat in vec2 vTopRight;
      flat in vec2 vBotLeft;
      flat in vec4 vCornerRadius;
      flat in vec4 vBorderColor;
      flat in vec2 vBorderWidth;

      out vec4 outColor;

      `).concat(n9,`
      `).concat(i9,`
      `).concat(a9,`
      `).concat(s9,`

      vec4 blend(vec4 top, vec4 bot) { // blend colors with premultiplied alpha
        return vec4( 
          top.rgb + (bot.rgb * (1.0 - top.a)),
          top.a   + (bot.a   * (1.0 - top.a)) 
        );
      }

      vec4 distInterp(vec4 cA, vec4 cB, float d) { // interpolate color using Signed Distance
        // scale to the zoom level so that borders don't look blurry when zoomed in
        // note 1.5 is an aribitrary value chosen because it looks good
        return mix(cA, cB, 1.0 - smoothstep(0.0, 1.5 / uZoom, abs(d))); 
      }

      void main(void) {
        if(vVertType == `).concat(cy,`) {
          // look up the texel from the texture unit
          `).concat(s.map(function(c){return"if(vAtlasId == ".concat(c,") outColor = texture(uTexture").concat(c,", vTexCoord);")}).join(`
	else `),`
        } 
        else if(vVertType == `).concat(fy,`) {
          // mimics how canvas renderer uses context.globalCompositeOperation = 'destination-out';
          outColor = blend(vColor, uBGColor);
          outColor.a = 1.0; // make opaque, masks out line under arrow
        }
        else if(vVertType == `).concat(Is,` && vBorderWidth == vec2(0.0)) { // simple rectangle with no border
          outColor = vColor; // unit square is already transformed to the rectangle, nothing else needs to be done
        }
        else if(vVertType == `).concat(Is," || vVertType == ").concat(Al,` 
          || vVertType == `).concat(zf," || vVertType == ").concat(kl,`) { // use SDF

          float outerBorder = vBorderWidth[0];
          float innerBorder = vBorderWidth[1];
          float borderPadding = outerBorder * 2.0;
          float w = vTopRight.x - vBotLeft.x - borderPadding;
          float h = vTopRight.y - vBotLeft.y - borderPadding;
          vec2 b = vec2(w/2.0, h/2.0); // half width, half height
          vec2 p = vPosition - vec2(vTopRight.x - b[0] - outerBorder, vTopRight.y - b[1] - outerBorder); // translate to center

          float d; // signed distance
          if(vVertType == `).concat(Is,`) {
            d = rectangleSD(p, b);
          } else if(vVertType == `).concat(Al,` && w == h) {
            d = circleSD(p, b.x); // faster than ellipse
          } else if(vVertType == `).concat(Al,`) {
            d = ellipseSD(p, b);
          } else {
            d = roundRectangleSD(p, b, vCornerRadius.wzyx);
          }

          // use the distance to interpolate a color to smooth the edges of the shape, doesn't need multisampling
          // we must smooth colors inwards, because we can't change pixels outside the shape's bounding box
          if(d > 0.0) {
            if(d > outerBorder) {
              discard;
            } else {
              outColor = distInterp(vBorderColor, vec4(0), d - outerBorder);
            }
          } else {
            if(d > innerBorder) {
              vec4 outerColor = outerBorder == 0.0 ? vec4(0) : vBorderColor;
              vec4 innerBorderColor = blend(vBorderColor, vColor);
              outColor = distInterp(innerBorderColor, outerColor, d);
            } 
            else {
              vec4 outerColor;
              if(innerBorder == 0.0 && outerBorder == 0.0) {
                outerColor = vec4(0);
              } else if(innerBorder == 0.0) {
                outerColor = vBorderColor;
              } else {
                outerColor = blend(vBorderColor, vColor);
              }
              outColor = distInterp(vColor, outerColor, d - innerBorder);
            }
          }
        }
        else {
          outColor = vColor;
        }

        `).concat(r.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),l=FK(n,a,o);l.aPosition=n.getAttribLocation(l,"aPosition"),l.aIndex=n.getAttribLocation(l,"aIndex"),l.aVertType=n.getAttribLocation(l,"aVertType"),l.aTransform=n.getAttribLocation(l,"aTransform"),l.aAtlasId=n.getAttribLocation(l,"aAtlasId"),l.aTex=n.getAttribLocation(l,"aTex"),l.aPointAPointB=n.getAttribLocation(l,"aPointAPointB"),l.aPointCPointD=n.getAttribLocation(l,"aPointCPointD"),l.aLineWidth=n.getAttribLocation(l,"aLineWidth"),l.aColor=n.getAttribLocation(l,"aColor"),l.aCornerRadius=n.getAttribLocation(l,"aCornerRadius"),l.aBorderColor=n.getAttribLocation(l,"aBorderColor"),l.uPanZoomMatrix=n.getUniformLocation(l,"uPanZoomMatrix"),l.uAtlasSize=n.getUniformLocation(l,"uAtlasSize"),l.uBGColor=n.getUniformLocation(l,"uBGColor"),l.uZoom=n.getUniformLocation(l,"uZoom"),l.uTextures=[];for(var u=0;u<this.batchManager.getMaxAtlasesPerBatch();u++)l.uTextures.push(n.getUniformLocation(l,"uTexture".concat(u)));return l}},{key:"_createVAO",value:function(){var r=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=r.length/2;var n=this.maxInstances,a=this.gl,s=this.program,o=a.createVertexArray();return a.bindVertexArray(o),jK(a,"vec2",s.aPosition,r),this.transformBuffer=YK(a,n,s.aTransform),this.indexBuffer=On(a,n,"vec4",s.aIndex),this.vertTypeBuffer=On(a,n,"int",s.aVertType),this.atlasIdBuffer=On(a,n,"int",s.aAtlasId),this.texBuffer=On(a,n,"vec4",s.aTex),this.pointAPointBBuffer=On(a,n,"vec4",s.aPointAPointB),this.pointCPointDBuffer=On(a,n,"vec4",s.aPointCPointD),this.lineWidthBuffer=On(a,n,"vec2",s.aLineWidth),this.colorBuffer=On(a,n,"vec4",s.aColor),this.cornerRadiusBuffer=On(a,n,"vec4",s.aCornerRadius),this.borderColorBuffer=On(a,n,"vec4",s.aBorderColor),a.bindVertexArray(null),o}},{key:"buffers",get:function(){var r=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(n){return n.endsWith("Buffer")}).map(function(n){return r[n]})),this._buffers}},{key:"startFrame",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Il.SCREEN;this.panZoomMatrix=r,this.renderTarget=n,this.batchDebugInfo=[],this.wrappedCount=0,this.simpleCount=0,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.batchManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"_isVisible",value:function(r,n){return r.visible()?n&&n.isVisible?n.isVisible(r):!0:!1}},{key:"drawTexture",value:function(r,n,a){var s=this.atlasManager,o=this.batchManager,l=s.getRenderTypeOpts(a);if(this._isVisible(r,l)){if(this.renderTarget.picking&&l.getTexPickingMode){var u=l.getTexPickingMode(r);if(u===fh.IGNORE)return;if(u==fh.USE_BB){this.drawPickingRectangle(r,n,a);return}}var c=s.getAtlasInfo(r,a),f=Ir(c),h;try{for(f.s();!(h=f.n()).done;){var d=h.value,p=d.atlas,g=d.tex1,m=d.tex2;o.canAddToCurrentBatch(p)||this.endBatch();for(var v=o.getAtlasIndexForBatch(p),y=0,b=[[g,!0],[m,!1]];y<b.length;y++){var w=zt(b[y],2),_=w[0],x=w[1];if(_.w!=0){var S=this.instanceCount;this.vertTypeBuffer.getView(S)[0]=cy;var E=this.indexBuffer.getView(S);Os(n,E);var A=this.atlasIdBuffer.getView(S);A[0]=v;var T=this.texBuffer.getView(S);T[0]=_.x,T[1]=_.y,T[2]=_.w,T[3]=_.h;var D=this.transformBuffer.getMatrixView(S);this.setTransformMatrix(r,D,l,d,x),this.instanceCount++,x||this.wrappedCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}catch(k){f.e(k)}finally{f.f()}}}},{key:"setTransformMatrix",value:function(r,n,a,s){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,l=0;if(a.shapeProps&&a.shapeProps.padding&&(l=r.pstyle(a.shapeProps.padding).pfValue),s){var u=s.bb,c=s.tex1,f=s.tex2,h=c.w/(c.w+f.w);o||(h=1-h);var d=this._getAdjustedBB(u,l,o,h);this._applyTransformMatrix(n,d,a,r)}else{var p=a.getBoundingBox(r),g=this._getAdjustedBB(p,l,!0,1);this._applyTransformMatrix(n,g,a,r)}}},{key:"_applyTransformMatrix",value:function(r,n,a,s){var o,l;QT(r);var u=a.getRotation?a.getRotation(s):0;if(u!==0){var c=a.getRotationPoint(s),f=c.x,h=c.y;Qf(r,r,[f,h]),JT(r,r,u);var d=a.getRotationOffset(s);o=d.x+(n.xOffset||0),l=d.y+(n.yOffset||0)}else o=n.x1,l=n.y1;Qf(r,r,[o,l]),Ry(r,r,[n.w,n.h])}},{key:"_getAdjustedBB",value:function(r,n,a,s){var o=r.x1,l=r.y1,u=r.w,c=r.h,f=r.yOffset;n&&(o-=n,l-=n,u+=2*n,c+=2*n);var h=0,d=u*s;return a&&s<1?u=d:!a&&s<1&&(h=u-d,o+=h,u=d),{x1:o,y1:l,w:u,h:c,xOffset:h,yOffset:f}}},{key:"drawPickingRectangle",value:function(r,n,a){var s=this.atlasManager.getRenderTypeOpts(a),o=this.instanceCount;this.vertTypeBuffer.getView(o)[0]=Is;var l=this.indexBuffer.getView(o);Os(n,l);var u=this.colorBuffer.getView(o);Ta([0,0,0],1,u);var c=this.transformBuffer.getMatrixView(o);this.setTransformMatrix(r,c,s),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawNode",value:function(r,n,a){var s=this.simpleShapeOptions.get(a);if(this._isVisible(r,s)){var o=s.shapeProps,l=this._getVertTypeForShape(r,o.shape);if(l===void 0||s.isSimple&&!s.isSimple(r)){this.drawTexture(r,n,a);return}var u=this.instanceCount;if(this.vertTypeBuffer.getView(u)[0]=l,l===zf||l===kl){var c=s.getBoundingBox(r),f=this._getCornerRadius(r,o.radius,c),h=this.cornerRadiusBuffer.getView(u);h[0]=f,h[1]=f,h[2]=f,h[3]=f,l===kl&&(h[0]=0,h[2]=0)}var d=this.indexBuffer.getView(u);Os(n,d);var p=r.pstyle(o.color).value,g=r.pstyle(o.opacity).value,m=this.colorBuffer.getView(u);Ta(p,g,m);var v=this.lineWidthBuffer.getView(u);if(v[0]=0,v[1]=0,o.border){var y=r.pstyle("border-width").value;if(y>0){var b=r.pstyle("border-color").value,w=r.pstyle("border-opacity").value,_=this.borderColorBuffer.getView(u);Ta(b,w,_);var x=r.pstyle("border-position").value;if(x==="inside")v[0]=0,v[1]=-y;else if(x==="outside")v[0]=y,v[1]=0;else{var S=y/2;v[0]=S,v[1]=-S}}}var E=this.transformBuffer.getMatrixView(u);this.setTransformMatrix(r,E,s),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"_getVertTypeForShape",value:function(r,n){var a=r.pstyle(n).value;switch(a){case"rectangle":return Is;case"ellipse":return Al;case"roundrectangle":case"round-rectangle":return zf;case"bottom-round-rectangle":return kl;default:return}}},{key:"_getCornerRadius",value:function(r,n,a){var s=a.w,o=a.h;if(r.pstyle(n).value==="auto")return Li(s,o);var l=r.pstyle(n).pfValue,u=s/2,c=o/2;return Math.min(l,c,u)}},{key:"drawEdgeArrow",value:function(r,n,a){if(r.visible()){var s=r._private.rscratch,o,l,u;if(a==="source"?(o=s.arrowStartX,l=s.arrowStartY,u=s.srcArrowAngle):(o=s.arrowEndX,l=s.arrowEndY,u=s.tgtArrowAngle),!(isNaN(o)||o==null||isNaN(l)||l==null||isNaN(u)||u==null)){var c=r.pstyle(a+"-arrow-shape").value;if(c!=="none"){var f=r.pstyle(a+"-arrow-color").value,h=r.pstyle("opacity").value,d=r.pstyle("line-opacity").value,p=h*d,g=r.pstyle("width").pfValue,m=r.pstyle("arrow-scale").value,v=this.r.getArrowWidth(g,m),y=this.instanceCount,b=this.transformBuffer.getMatrixView(y);QT(b),Qf(b,b,[o,l]),Ry(b,b,[v,v]),JT(b,b,u),this.vertTypeBuffer.getView(y)[0]=fy;var w=this.indexBuffer.getView(y);Os(n,w);var _=this.colorBuffer.getView(y);Ta(f,p,_),this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"drawEdgeLine",value:function(r,n){if(r.visible()){var a=this._getEdgePoints(r);if(a){var s=r.pstyle("opacity").value,o=r.pstyle("line-opacity").value,l=r.pstyle("width").pfValue,u=r.pstyle("line-color").value,c=s*o;if(a.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),a.length==4){var f=this.instanceCount;this.vertTypeBuffer.getView(f)[0]=ek;var h=this.indexBuffer.getView(f);Os(n,h);var d=this.colorBuffer.getView(f);Ta(u,c,d);var p=this.lineWidthBuffer.getView(f);p[0]=l;var g=this.pointAPointBBuffer.getView(f);g[0]=a[0],g[1]=a[1],g[2]=a[2],g[3]=a[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var m=0;m<a.length-2;m+=2){var v=this.instanceCount;this.vertTypeBuffer.getView(v)[0]=tk;var y=this.indexBuffer.getView(v);Os(n,y);var b=this.colorBuffer.getView(v);Ta(u,c,b);var w=this.lineWidthBuffer.getView(v);w[0]=l;var _=a[m-2],x=a[m-1],S=a[m],E=a[m+1],A=a[m+2],T=a[m+3],D=a[m+4],k=a[m+5];m==0&&(_=2*S-A+.001,x=2*E-T+.001),m==a.length-4&&(D=2*A-S+.001,k=2*T-E+.001);var M=this.pointAPointBBuffer.getView(v);M[0]=_,M[1]=x,M[2]=S,M[3]=E;var P=this.pointCPointDBuffer.getView(v);P[0]=A,P[1]=T,P[2]=D,P[3]=k,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"_getEdgePoints",value:function(r){var n=r._private.rscratch;if(!(n.badLine||n.allpts==null||isNaN(n.allpts[0]))){var a=n.allpts;if(a.length==4)return a;var s=this._getNumSegments(r);return this._getCurveSegmentPoints(a,s)}}},{key:"_getNumSegments",value:function(r){var n=15;return Math.min(Math.max(n,5),this.maxInstances)}},{key:"_getCurveSegmentPoints",value:function(r,n){if(r.length==4)return r;for(var a=Array((n+1)*2),s=0;s<=n;s++)if(s==0)a[0]=r[0],a[1]=r[1];else if(s==n)a[s*2]=r[r.length-2],a[s*2+1]=r[r.length-1];else{var o=s/n;this._setCurvePoint(r,o,a,s*2)}return a}},{key:"_setCurvePoint",value:function(r,n,a,s){if(r.length<=2)a[s]=r[0],a[s+1]=r[1];else{for(var o=Array(r.length-2),l=0;l<o.length;l+=2){var u=(1-n)*r[l]+n*r[l+2],c=(1-n)*r[l+1]+n*r[l+3];o[l]=u,o[l+1]=c}return this._setCurvePoint(o,n,a,s)}}},{key:"endBatch",value:function(){var r=this.gl,n=this.vao,a=this.vertexCount,s=this.instanceCount;if(s!==0){var o=this.renderTarget.picking?this.pickingProgram:this.program;r.useProgram(o),r.bindVertexArray(n);var l=Ir(this.buffers),u;try{for(l.s();!(u=l.n()).done;){var c=u.value;c.bufferSubData(s)}}catch(g){l.e(g)}finally{l.f()}for(var f=this.batchManager.getAtlases(),h=0;h<f.length;h++)f[h].bufferIfNeeded(r);for(var d=0;d<f.length;d++)r.activeTexture(r.TEXTURE0+d),r.bindTexture(r.TEXTURE_2D,f[d].texture),r.uniform1i(o.uTextures[d],d);r.uniform1f(o.uZoom,VK(this.r)),r.uniformMatrix3fv(o.uPanZoomMatrix,!1,this.panZoomMatrix),r.uniform1i(o.uAtlasSize,this.batchManager.getAtlasSize());var p=Ta(this.bgColor,1);r.uniform4fv(o.uBGColor,p),r.drawArraysInstanced(r.TRIANGLES,0,a,s),r.bindVertexArray(null),r.bindTexture(r.TEXTURE_2D,null),this.debug&&this.batchDebugInfo.push({count:s,atlasCount:f.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){var r=this.atlasManager.getDebugInfo(),n=r.reduce(function(o,l){return o+l.atlasCount},0),a=this.batchDebugInfo,s=a.reduce(function(o,l){return o+l.count},0);return{atlasInfo:r,totalAtlases:n,wrappedCount:this.wrappedCount,simpleCount:this.simpleCount,batchCount:a.length,batchInfo:a,totalInstances:s}}}])}(),LA={};LA.initWebgl=function(t,e){var r=this,n=r.data.contexts[r.WEBGL];t.bgColor=l9(r),t.webglTexSize=Math.min(t.webglTexSize,n.getParameter(n.MAX_TEXTURE_SIZE)),t.webglTexRows=Math.min(t.webglTexRows,54),t.webglTexRowsNodes=Math.min(t.webglTexRowsNodes,54),t.webglBatchSize=Math.min(t.webglBatchSize,16384),t.webglTexPerBatch=Math.min(t.webglTexPerBatch,n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),r.webglDebug=t.webglDebug,r.webglDebugShowAtlases=t.webglDebugShowAtlases,r.pickingFrameBuffer=ZK(n),r.pickingFrameBuffer.needsDraw=!0,r.drawing=new o9(r,n,t);var a=function(h){return function(d){return r.getTextAngle(d,h)}},s=function(h){return function(d){var p=d.pstyle(h);return p&&p.value}},o=function(h){return function(d){return d.pstyle("".concat(h,"-opacity")).value>0}},l=function(h){var d=h.pstyle("text-events").strValue==="yes";return d?fh.USE_BB:fh.IGNORE},u=function(h){var d=h.position(),p=d.x,g=d.y,m=h.outerWidth(),v=h.outerHeight();return{w:m,h:v,x1:p-m/2,y1:g-v/2}};r.drawing.addAtlasCollection("node",{texRows:t.webglTexRowsNodes}),r.drawing.addAtlasCollection("label",{texRows:t.webglTexRows}),r.drawing.addTextureAtlasRenderType("node-body",{collection:"node",getKey:e.getStyleKey,getBoundingBox:e.getElementBox,drawElement:e.drawElement}),r.drawing.addSimpleShapeRenderType("node-body",{getBoundingBox:u,isSimple:HK,shapeProps:{shape:"shape",color:"background-color",opacity:"background-opacity",radius:"corner-radius",border:!0}}),r.drawing.addSimpleShapeRenderType("node-overlay",{getBoundingBox:u,isVisible:o("overlay"),shapeProps:{shape:"overlay-shape",color:"overlay-color",opacity:"overlay-opacity",padding:"overlay-padding",radius:"overlay-corner-radius"}}),r.drawing.addSimpleShapeRenderType("node-underlay",{getBoundingBox:u,isVisible:o("underlay"),shapeProps:{shape:"underlay-shape",color:"underlay-color",opacity:"underlay-opacity",padding:"underlay-padding",radius:"underlay-corner-radius"}}),r.drawing.addTextureAtlasRenderType("label",{collection:"label",getTexPickingMode:l,getKey:hy(e.getLabelKey,null),getBoundingBox:dy(e.getLabelBox,null),drawClipped:!0,drawElement:e.drawLabel,getRotation:a(null),getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:s("label")}),r.drawing.addTextureAtlasRenderType("edge-source-label",{collection:"label",getTexPickingMode:l,getKey:hy(e.getSourceLabelKey,"source"),getBoundingBox:dy(e.getSourceLabelBox,"source"),drawClipped:!0,drawElement:e.drawSourceLabel,getRotation:a("source"),getRotationPoint:e.getSourceLabelRotationPoint,getRotationOffset:e.getSourceLabelRotationOffset,isVisible:s("source-label")}),r.drawing.addTextureAtlasRenderType("edge-target-label",{collection:"label",getTexPickingMode:l,getKey:hy(e.getTargetLabelKey,"target"),getBoundingBox:dy(e.getTargetLabelBox,"target"),drawClipped:!0,drawElement:e.drawTargetLabel,getRotation:a("target"),getRotationPoint:e.getTargetLabelRotationPoint,getRotationOffset:e.getTargetLabelRotationOffset,isVisible:s("target-label")});var c=Xl(function(){console.log("garbage collect flag set"),r.data.gc=!0},1e4);r.onUpdateEleCalcs(function(f,h){var d=!1;h&&h.length>0&&(d|=r.drawing.invalidate(h)),d&&c()}),u9(r)};function l9(t){var e=t.cy.container(),r=e&&e.style&&e.style.backgroundColor||"white";return hk(r)}function NA(t,e){var r=t._private.rscratch;return Dr(r,"labelWrapCachedLines",e)||[]}var hy=function(e,r){return function(n){var a=e(n),s=NA(n,r);return s.length>1?s.map(function(o,l){return"".concat(a,"_").concat(l)}):a}},dy=function(e,r){return function(n,a){var s=e(n);if(typeof a=="string"){var o=a.indexOf("_");if(o>0){var l=Number(a.substring(o+1)),u=NA(n,r),c=s.h/u.length,f=c*l,h=s.y1+f;return{x1:s.x1,w:s.w,y1:h,h:c,yOffset:f}}}return s}};function u9(t){{var e=t.render;t.render=function(s){s=s||{};var o=t.cy;t.webgl&&(o.zoom()>MA?(c9(t),e.call(t,s)):(f9(t),qA(t,s,Il.SCREEN)))}}{var r=t.matchCanvasSize;t.matchCanvasSize=function(s){r.call(t,s),t.pickingFrameBuffer.setFramebufferAttachmentSizes(t.canvasWidth,t.canvasHeight),t.pickingFrameBuffer.needsDraw=!0}}t.findNearestElements=function(s,o,l,u){return m9(t,s,o)};{var n=t.invalidateCachedZSortedEles;t.invalidateCachedZSortedEles=function(){n.call(t),t.pickingFrameBuffer.needsDraw=!0}}{var a=t.notify;t.notify=function(s,o){a.call(t,s,o),s==="viewport"||s==="bounds"?t.pickingFrameBuffer.needsDraw=!0:s==="background"&&t.drawing.invalidate(o,{type:"node-body"})}}}function c9(t){var e=t.data.contexts[t.WEBGL];e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function f9(t){var e=function(n){n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.canvasWidth,t.canvasHeight),n.restore()};e(t.data.contexts[t.NODE]),e(t.data.contexts[t.DRAG])}function h9(t){var e=t.canvasWidth,r=t.canvasHeight,n=a0(t),a=n.pan,s=n.zoom,o=uy();Qf(o,o,[a.x,a.y]),Ry(o,o,[s,s]);var l=uy();$K(l,e,r);var u=uy();return XK(u,l,o),u}function FA(t,e){var r=t.canvasWidth,n=t.canvasHeight,a=a0(t),s=a.pan,o=a.zoom;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,r,n),e.translate(s.x,s.y),e.scale(o,o)}function d9(t,e){t.drawSelectionRectangle(e,function(r){return FA(t,r)})}function p9(t){var e=t.data.contexts[t.NODE];e.save(),FA(t,e),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.moveTo(-1e3,0),e.lineTo(1e3,0),e.stroke(),e.beginPath(),e.moveTo(0,-1e3),e.lineTo(0,1e3),e.stroke(),e.restore()}function g9(t){var e=function(a,s,o){for(var l=a.atlasManager.getAtlasCollection(s),u=t.data.contexts[t.NODE],c=l.atlases,f=0;f<c.length;f++){var h=c[f],d=h.canvas;if(d){var p=d.width,g=d.height,m=p*f,v=d.height*o,y=.4;u.save(),u.scale(y,y),u.drawImage(d,m,v),u.strokeStyle="black",u.rect(m,v,p,g),u.stroke(),u.restore()}}},r=0;e(t.drawing,"node",r++),e(t.drawing,"label",r++)}function v9(t,e,r,n,a){var s,o,l,u,c=a0(t),f=c.pan,h=c.zoom;{var d=zK(t,f,h,e,r),p=zt(d,2),g=p[0],m=p[1],v=6;s=g-v/2,o=m-v/2,l=v,u=v}if(l===0||u===0)return[];var y=t.data.contexts[t.WEBGL];y.bindFramebuffer(y.FRAMEBUFFER,t.pickingFrameBuffer),t.pickingFrameBuffer.needsDraw&&(y.viewport(0,0,y.canvas.width,y.canvas.height),qA(t,null,Il.PICKING),t.pickingFrameBuffer.needsDraw=!1);var b=l*u,w=new Uint8Array(b*4);y.readPixels(s,o,l,u,y.RGBA,y.UNSIGNED_BYTE,w),y.bindFramebuffer(y.FRAMEBUFFER,null);for(var _=new Set,x=0;x<b;x++){var S=w.slice(x*4,x*4+4),E=WK(S)-1;E>=0&&_.add(E)}return _}function m9(t,e,r){var n=v9(t,e,r),a=t.getCachedZSortedEles(),s,o,l=Ir(n),u;try{for(l.s();!(u=l.n()).done;){var c=u.value,f=a[c];if(!s&&f.isNode()&&(s=f),!o&&f.isEdge()&&(o=f),s&&o)break}}catch(h){l.e(h)}finally{l.f()}return[s,o].filter(Boolean)}function py(t,e,r){var n=t.drawing;e+=1,r.isNode()?(n.drawNode(r,e,"node-underlay"),n.drawNode(r,e,"node-body"),n.drawTexture(r,e,"label"),n.drawNode(r,e,"node-overlay")):(n.drawEdgeLine(r,e),n.drawEdgeArrow(r,e,"source"),n.drawEdgeArrow(r,e,"target"),n.drawTexture(r,e,"label"),n.drawTexture(r,e,"edge-source-label"),n.drawTexture(r,e,"edge-target-label"))}function qA(t,e,r){var n;t.webglDebug&&(n=performance.now());var a=t.drawing,s=0;if(r.screen&&t.data.canvasNeedsRedraw[t.SELECT_BOX]&&d9(t,e),t.data.canvasNeedsRedraw[t.NODE]||r.picking){var o=t.data.contexts[t.WEBGL];r.screen?(o.clearColor(0,0,0,0),o.enable(o.BLEND),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA)):o.disable(o.BLEND),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),o.viewport(0,0,o.canvas.width,o.canvas.height);var l=h9(t),u=t.getCachedZSortedEles();if(s=u.length,a.startFrame(l,r),r.screen){for(var c=0;c<u.nondrag.length;c++)py(t,c,u.nondrag[c]);for(var f=0;f<u.drag.length;f++)py(t,f,u.drag[f])}else if(r.picking)for(var h=0;h<u.length;h++)py(t,h,u[h]);a.endFrame(),r.screen&&t.webglDebugShowAtlases&&(p9(t),g9(t)),t.data.canvasNeedsRedraw[t.NODE]=!1,t.data.canvasNeedsRedraw[t.DRAG]=!1}if(t.webglDebug){var d=performance.now(),p=!1,g=Math.ceil(d-n),m=a.getDebugInfo(),v=["".concat(s," elements"),"".concat(m.totalInstances," instances"),"".concat(m.batchCount," batches"),"".concat(m.totalAtlases," atlases"),"".concat(m.wrappedCount," wrapped textures"),"".concat(m.simpleCount," simple shapes")].join(", ");if(p)console.log("WebGL (".concat(r.name,") - time ").concat(g,"ms, ").concat(v));else{console.log("WebGL (".concat(r.name,") - frame time ").concat(g,"ms")),console.log("Totals:"),console.log("  ".concat(v)),console.log("Texture Atlases Used:");var y=m.atlasInfo,b=Ir(y),w;try{for(b.s();!(w=b.n()).done;){var _=w.value;console.log("  ".concat(_.type,": ").concat(_.keyCount," keys, ").concat(_.atlasCount," atlases"))}}catch(x){b.e(x)}finally{b.f()}console.log("")}}t.data.gc&&(console.log("Garbage Collect!"),t.data.gc=!1,a.gc())}var Wi={};Wi.drawPolygonPath=function(t,e,r,n,a,s){var o=n/2,l=a/2;t.beginPath&&t.beginPath(),t.moveTo(e+o*s[0],r+l*s[1]);for(var u=1;u<s.length/2;u++)t.lineTo(e+o*s[u*2],r+l*s[u*2+1]);t.closePath()};Wi.drawRoundPolygonPath=function(t,e,r,n,a,s,o){o.forEach(function(l){return wA(t,l)}),t.closePath()};Wi.drawRoundRectanglePath=function(t,e,r,n,a,s){var o=n/2,l=a/2,u=s==="auto"?Li(n,a):Math.min(s,l,o);t.beginPath&&t.beginPath(),t.moveTo(e,r-l),t.arcTo(e+o,r-l,e+o,r,u),t.arcTo(e+o,r+l,e,r+l,u),t.arcTo(e-o,r+l,e-o,r,u),t.arcTo(e-o,r-l,e,r-l,u),t.lineTo(e,r-l),t.closePath()};Wi.drawBottomRoundRectanglePath=function(t,e,r,n,a,s){var o=n/2,l=a/2,u=s==="auto"?Li(n,a):s;t.beginPath&&t.beginPath(),t.moveTo(e,r-l),t.lineTo(e+o,r-l),t.lineTo(e+o,r),t.arcTo(e+o,r+l,e,r+l,u),t.arcTo(e-o,r+l,e-o,r,u),t.lineTo(e-o,r-l),t.lineTo(e,r-l),t.closePath()};Wi.drawCutRectanglePath=function(t,e,r,n,a,s,o){var l=n/2,u=a/2,c=o==="auto"?Gy():o;t.beginPath&&t.beginPath(),t.moveTo(e-l+c,r-u),t.lineTo(e+l-c,r-u),t.lineTo(e+l,r-u+c),t.lineTo(e+l,r+u-c),t.lineTo(e+l-c,r+u),t.lineTo(e-l+c,r+u),t.lineTo(e-l,r+u-c),t.lineTo(e-l,r-u+c),t.closePath()};Wi.drawBarrelPath=function(t,e,r,n,a){var s=n/2,o=a/2,l=e-s,u=e+s,c=r-o,f=r+o,h=my(n,a),d=h.widthOffset,p=h.heightOffset,g=h.ctrlPtOffsetPct*d;t.beginPath&&t.beginPath(),t.moveTo(l,c+p),t.lineTo(l,f-p),t.quadraticCurveTo(l+g,f,l+d,f),t.lineTo(u-d,f),t.quadraticCurveTo(u-g,f,u,f-p),t.lineTo(u,c+p),t.quadraticCurveTo(u-g,c,u-d,c),t.lineTo(l+d,c),t.quadraticCurveTo(l+g,c,l,c+p),t.closePath()};var rk=Math.sin(0),nk=Math.cos(0),Dy={},Oy={},VA=Math.PI/40;for(ka=0*Math.PI;ka<2*Math.PI;ka+=VA)Dy[ka]=Math.sin(ka),Oy[ka]=Math.cos(ka);var ka;Wi.drawEllipsePath=function(t,e,r,n,a){if(t.beginPath&&t.beginPath(),t.ellipse)t.ellipse(e,r,n/2,a/2,0,0,2*Math.PI);else for(var s,o,l=n/2,u=a/2,c=0*Math.PI;c<2*Math.PI;c+=VA)s=e-l*Dy[c]*rk+l*Oy[c]*nk,o=r+u*Oy[c]*rk+u*Dy[c]*nk,c===0?t.moveTo(s,o):t.lineTo(s,o);t.closePath()};var ru={};ru.createBuffer=function(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,[r,r.getContext("2d")]};ru.bufferCanvasImage=function(t){var e=this.cy,r=e.mutableElements(),n=r.boundingBox(),a=this.findContainerClientCoords(),s=t.full?Math.ceil(n.w):a[2],o=t.full?Math.ceil(n.h):a[3],l=le(t.maxWidth)||le(t.maxHeight),u=this.getPixelRatio(),c=1;if(t.scale!==void 0)s*=t.scale,o*=t.scale,c=t.scale;else if(l){var f=1/0,h=1/0;le(t.maxWidth)&&(f=c*t.maxWidth/s),le(t.maxHeight)&&(h=c*t.maxHeight/o),c=Math.min(f,h),s*=c,o*=c}l||(s*=u,o*=u,c*=u);var d=document.createElement("canvas");d.width=s,d.height=o,d.style.width=s+"px",d.style.height=o+"px";var p=d.getContext("2d");if(s>0&&o>0){p.clearRect(0,0,s,o),p.globalCompositeOperation="source-over";var g=this.getCachedZSortedEles();if(t.full)p.translate(-n.x1*c,-n.y1*c),p.scale(c,c),this.drawElements(p,g),p.scale(1/c,1/c),p.translate(n.x1*c,n.y1*c);else{var m=e.pan(),v={x:m.x*c,y:m.y*c};c*=e.zoom(),p.translate(v.x,v.y),p.scale(c,c),this.drawElements(p,g),p.scale(1/c,1/c),p.translate(-v.x,-v.y)}t.bg&&(p.globalCompositeOperation="destination-over",p.fillStyle=t.bg,p.rect(0,0,s,o),p.fill())}return d};function y9(t,e){for(var r=atob(t),n=new ArrayBuffer(r.length),a=new Uint8Array(n),s=0;s<r.length;s++)a[s]=r.charCodeAt(s);return new Blob([n],{type:e})}function ik(t){var e=t.indexOf(",");return t.substr(e+1)}function zA(t,e,r){var n=function(){return e.toDataURL(r,t.quality)};switch(t.output){case"blob-promise":return new Ys(function(a,s){try{e.toBlob(function(o){o!=null?a(o):s(new Error("`canvas.toBlob()` sent a null value in its callback"))},r,t.quality)}catch(o){s(o)}});case"blob":return y9(ik(n()),r);case"base64":return ik(n());case"base64uri":default:return n()}}ru.png=function(t){return zA(t,this.bufferCanvasImage(t),"image/png")};ru.jpg=function(t){return zA(t,this.bufferCanvasImage(t),"image/jpeg")};var HA={};HA.nodeShapeImpl=function(t,e,r,n,a,s,o,l){switch(t){case"ellipse":return this.drawEllipsePath(e,r,n,a,s);case"polygon":return this.drawPolygonPath(e,r,n,a,s,o);case"round-polygon":return this.drawRoundPolygonPath(e,r,n,a,s,o,l);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,r,n,a,s,l);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,r,n,a,s,o,l);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,r,n,a,s,l);case"barrel":return this.drawBarrelPath(e,r,n,a,s)}};var b9=UA,ze=UA.prototype;ze.CANVAS_LAYERS=3;ze.SELECT_BOX=0;ze.DRAG=1;ze.NODE=2;ze.WEBGL=3;ze.CANVAS_TYPES=["2d","2d","2d","webgl2"];ze.BUFFER_COUNT=3;ze.TEXTURE_BUFFER=0;ze.MOTIONBLUR_BUFFER_NODE=1;ze.MOTIONBLUR_BUFFER_DRAG=2;function UA(t){var e=this,r=e.cy.window(),n=r.document;t.webgl&&(ze.CANVAS_LAYERS=e.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),e.data={canvases:new Array(ze.CANVAS_LAYERS),contexts:new Array(ze.CANVAS_LAYERS),canvasNeedsRedraw:new Array(ze.CANVAS_LAYERS),bufferCanvases:new Array(ze.BUFFER_COUNT),bufferContexts:new Array(ze.CANVAS_LAYERS)};var a="-webkit-tap-highlight-color",s="rgba(0,0,0,0)";e.data.canvasContainer=n.createElement("div");var o=e.data.canvasContainer.style;e.data.canvasContainer.style[a]=s,o.position="relative",o.zIndex="0",o.overflow="hidden";var l=t.cy.container();l.appendChild(e.data.canvasContainer),l.style[a]=s;var u={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};mU()&&(u["-ms-touch-action"]="none",u["touch-action"]="none");for(var c=0;c<ze.CANVAS_LAYERS;c++){var f=e.data.canvases[c]=n.createElement("canvas"),h=ze.CANVAS_TYPES[c];e.data.contexts[c]=f.getContext(h),e.data.contexts[c]||St("Could not create canvas of type "+h),Object.keys(u).forEach(function(re){f.style[re]=u[re]}),f.style.position="absolute",f.setAttribute("data-id","layer"+c),f.style.zIndex=String(ze.CANVAS_LAYERS-c),e.data.canvasContainer.appendChild(f),e.data.canvasNeedsRedraw[c]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[ze.NODE].setAttribute("data-id","layer"+ze.NODE+"-node"),e.data.canvases[ze.SELECT_BOX].setAttribute("data-id","layer"+ze.SELECT_BOX+"-selectbox"),e.data.canvases[ze.DRAG].setAttribute("data-id","layer"+ze.DRAG+"-drag"),e.data.canvases[ze.WEBGL]&&e.data.canvases[ze.WEBGL].setAttribute("data-id","layer"+ze.WEBGL+"-webgl");for(var c=0;c<ze.BUFFER_COUNT;c++)e.data.bufferCanvases[c]=n.createElement("canvas"),e.data.bufferContexts[c]=e.data.bufferCanvases[c].getContext("2d"),e.data.bufferCanvases[c].style.position="absolute",e.data.bufferCanvases[c].setAttribute("data-id","buffer"+c),e.data.bufferCanvases[c].style.zIndex=String(-c-1),e.data.bufferCanvases[c].style.visibility="hidden";e.pathsEnabled=!0;var d=Br(),p=function(U){return{x:(U.x1+U.x2)/2,y:(U.y1+U.y2)/2}},g=function(U){return{x:-U.w/2,y:-U.h/2}},m=function(U){var G=U[0]._private,j=G.oldBackgroundTimestamp===G.backgroundTimestamp;return!j},v=function(U){return U[0]._private.nodeKey},y=function(U){return U[0]._private.labelStyleKey},b=function(U){return U[0]._private.sourceLabelStyleKey},w=function(U){return U[0]._private.targetLabelStyleKey},_=function(U,G,j,se,fe){return e.drawElement(U,G,j,!1,!1,fe)},x=function(U,G,j,se,fe){return e.drawElementText(U,G,j,se,"main",fe)},S=function(U,G,j,se,fe){return e.drawElementText(U,G,j,se,"source",fe)},E=function(U,G,j,se,fe){return e.drawElementText(U,G,j,se,"target",fe)},A=function(U){return U.boundingBox(),U[0]._private.bodyBounds},T=function(U){return U.boundingBox(),U[0]._private.labelBounds.main||d},D=function(U){return U.boundingBox(),U[0]._private.labelBounds.source||d},k=function(U){return U.boundingBox(),U[0]._private.labelBounds.target||d},M=function(U,G){return G},P=function(U){return p(A(U))},I=function(U,G,j){var se=U?U+"-":"";return{x:G.x+j.pstyle(se+"text-margin-x").pfValue,y:G.y+j.pstyle(se+"text-margin-y").pfValue}},B=function(U,G,j){var se=U[0]._private.rscratch;return{x:se[G],y:se[j]}},L=function(U){return I("",B(U,"labelX","labelY"),U)},N=function(U){return I("source",B(U,"sourceLabelX","sourceLabelY"),U)},F=function(U){return I("target",B(U,"targetLabelX","targetLabelY"),U)},q=function(U){return g(A(U))},H=function(U){return g(D(U))},V=function(U){return g(k(U))},z=function(U){var G=T(U),j=g(T(U));if(U.isNode()){switch(U.pstyle("text-halign").value){case"left":j.x=-G.w-(G.leftPad||0);break;case"right":j.x=-(G.rightPad||0);break}switch(U.pstyle("text-valign").value){case"top":j.y=-G.h-(G.topPad||0);break;case"bottom":j.y=-(G.botPad||0);break}}return j},Y=e.data.eleTxrCache=new Rl(e,{getKey:v,doesEleInvalidateKey:m,drawElement:_,getBoundingBox:A,getRotationPoint:P,getRotationOffset:q,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),Q=e.data.lblTxrCache=new Rl(e,{getKey:y,drawElement:x,getBoundingBox:T,getRotationPoint:L,getRotationOffset:z,isVisible:M}),J=e.data.slbTxrCache=new Rl(e,{getKey:b,drawElement:S,getBoundingBox:D,getRotationPoint:N,getRotationOffset:H,isVisible:M}),ee=e.data.tlbTxrCache=new Rl(e,{getKey:w,drawElement:E,getBoundingBox:k,getRotationPoint:F,getRotationOffset:V,isVisible:M}),ae=e.data.lyrTxrCache=new PA(e);e.onUpdateEleCalcs(function(U,G){Y.invalidateElements(G),Q.invalidateElements(G),J.invalidateElements(G),ee.invalidateElements(G),ae.invalidateElements(G);for(var j=0;j<G.length;j++){var se=G[j]._private;se.oldBackgroundTimestamp=se.backgroundTimestamp}});var ue=function(U){for(var G=0;G<U.length;G++)ae.enqueueElementRefinement(U[G].ele)};Y.onDequeue(ue),Q.onDequeue(ue),J.onDequeue(ue),ee.onDequeue(ue),t.webgl&&e.initWebgl(t,{getStyleKey:v,getLabelKey:y,getSourceLabelKey:b,getTargetLabelKey:w,drawElement:_,drawLabel:x,drawSourceLabel:S,drawTargetLabel:E,getElementBox:A,getLabelBox:T,getSourceLabelBox:D,getTargetLabelBox:k,getElementRotationPoint:P,getElementRotationOffset:q,getLabelRotationPoint:L,getSourceLabelRotationPoint:N,getTargetLabelRotationPoint:F,getLabelRotationOffset:z,getSourceLabelRotationOffset:H,getTargetLabelRotationOffset:V})}ze.redrawHint=function(t,e){var r=this;switch(t){case"eles":r.data.canvasNeedsRedraw[ze.NODE]=e;break;case"drag":r.data.canvasNeedsRedraw[ze.DRAG]=e;break;case"select":r.data.canvasNeedsRedraw[ze.SELECT_BOX]=e;break;case"gc":r.data.gc=!0;break}};var w9=typeof Path2D<"u";ze.path2dEnabled=function(t){if(t===void 0)return this.pathsEnabled;this.pathsEnabled=!!t};ze.usePaths=function(){return w9&&this.pathsEnabled};ze.setImgSmoothing=function(t,e){t.imageSmoothingEnabled!=null?t.imageSmoothingEnabled=e:(t.webkitImageSmoothingEnabled=e,t.mozImageSmoothingEnabled=e,t.msImageSmoothingEnabled=e)};ze.getImgSmoothing=function(t){return t.imageSmoothingEnabled!=null?t.imageSmoothingEnabled:t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled};ze.makeOffscreenCanvas=function(t,e){var r;if((typeof OffscreenCanvas>"u"?"undefined":Ut(OffscreenCanvas))!=="undefined")r=new OffscreenCanvas(t,e);else{var n=this.cy.window(),a=n.document;r=a.createElement("canvas"),r.width=t,r.height=e}return r};[RA,Fn,ai,i0,za,Ui,wr,LA,Wi,ru,HA].forEach(function(t){Ce(ze,t)});var _9=[{name:"null",impl:mA},{name:"base",impl:kA},{name:"canvas",impl:b9}],x9=[{type:"layout",extensions:Y6},{type:"renderer",extensions:_9}],WA={},GA={};function KA(t,e,r){var n=r,a=function(A){st("Can not register `"+e+"` for `"+t+"` since `"+A+"` already exists in the prototype and can not be overridden")};if(t==="core"){if(Ul.prototype[e])return a(e);Ul.prototype[e]=r}else if(t==="collection"){if(ir.prototype[e])return a(e);ir.prototype[e]=r}else if(t==="layout"){for(var s=function(A){this.options=A,r.call(this,A),Qe(this._private)||(this._private={}),this._private.cy=A.cy,this._private.listeners=[],this.createEmitter()},o=s.prototype=Object.create(r.prototype),l=[],u=0;u<l.length;u++){var c=l[u];o[c]=o[c]||function(){return this}}o.start&&!o.run?o.run=function(){return this.start(),this}:!o.start&&o.run&&(o.start=function(){return this.run(),this});var f=r.prototype.stop;o.stop=function(){var E=this.options;if(E&&E.animate){var A=this.animations;if(A)for(var T=0;T<A.length;T++)A[T].stop()}return f?f.call(this):this.emit("layoutstop"),this},o.destroy||(o.destroy=function(){return this}),o.cy=function(){return this._private.cy};var h=function(A){return A._private.cy},d={addEventFields:function(A,T){T.layout=A,T.cy=h(A),T.target=A},bubble:function(){return!0},parent:function(A){return h(A)}};Ce(o,{createEmitter:function(){return this._private.emitter=new Eh(d,this),this},emitter:function(){return this._private.emitter},on:function(A,T){return this.emitter().on(A,T),this},one:function(A,T){return this.emitter().one(A,T),this},once:function(A,T){return this.emitter().one(A,T),this},removeListener:function(A,T){return this.emitter().removeListener(A,T),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(A,T){return this.emitter().emit(A,T),this}}),at.eventAliasesOn(o),n=s}else if(t==="renderer"&&e!=="null"&&e!=="base"){var p=jA("renderer","base"),g=p.prototype,m=r,v=r.prototype,y=function(){p.apply(this,arguments),m.apply(this,arguments)},b=y.prototype;for(var w in g){var _=g[w],x=v[w]!=null;if(x)return a(w);b[w]=_}for(var S in v)b[S]=v[S];g.clientFunctions.forEach(function(E){b[E]=b[E]||function(){St("Renderer does not implement `renderer."+E+"()` on its prototype")}}),n=y}else if(t==="__proto__"||t==="constructor"||t==="prototype")return St(t+" is an illegal type to be registered, possibly lead to prototype pollutions");return dk({map:WA,keys:[t,e],value:n})}function jA(t,e){return pk({map:WA,keys:[t,e]})}function E9(t,e,r,n,a){return dk({map:GA,keys:[t,e,r,n],value:a})}function S9(t,e,r,n){return pk({map:GA,keys:[t,e,r,n]})}var Iy=function(){if(arguments.length===2)return jA.apply(null,arguments);if(arguments.length===3)return KA.apply(null,arguments);if(arguments.length===4)return S9.apply(null,arguments);if(arguments.length===5)return E9.apply(null,arguments);St("Invalid extension access syntax")};Ul.prototype.extension=Iy;x9.forEach(function(t){t.extensions.forEach(function(e){KA(t.type,e.name,e.impl)})});var hh=function(){if(!(this instanceof hh))return new hh;this.length=0},Fa=hh.prototype;Fa.instanceString=function(){return"stylesheet"};Fa.selector=function(t){var e=this.length++;return this[e]={selector:t,properties:[]},this};Fa.css=function(t,e){var r=this.length-1;if(_e(t))this[r].properties.push({name:t,value:e});else if(Qe(t))for(var n=t,a=Object.keys(n),s=0;s<a.length;s++){var o=a[s],l=n[o];if(l!=null){var u=Zt.properties[o]||Zt.properties[dh(o)];if(u!=null){var c=u.name,f=l;this[r].properties.push({name:c,value:f})}}}return this};Fa.style=Fa.css;Fa.generateStyle=function(t){var e=new Zt(t);return this.appendToStyle(e)};Fa.appendToStyle=function(t){for(var e=0;e<this.length;e++){var r=this[e],n=r.selector,a=r.properties;t.selector(n);for(var s=0;s<a.length;s++){var o=a[s];t.css(o.name,o.value)}}return t};var C9="3.32.0",qa=function(e){if(e===void 0&&(e={}),Qe(e))return new Ul(e);if(_e(e))return Iy.apply(Iy,arguments)};qa.use=function(t){var e=Array.prototype.slice.call(arguments,1);return e.unshift(qa),t.apply(null,e),this};qa.warnings=function(t){return _k(t)};qa.version=C9;qa.stylesheet=qa.Stylesheet=hh;YA.exports=qa});var $A=O((Nfe,XA)=>{function T9(){this.__data__=[],this.size=0}XA.exports=T9});var Ha=O((Ffe,QA)=>{function k9(t,e){return t===e||t!==t&&e!==e}QA.exports=k9});var nu=O((qfe,JA)=>{var A9=Ha();function M9(t,e){for(var r=t.length;r--;)if(A9(t[r][0],e))return r;return-1}JA.exports=M9});var t2=O((Vfe,e2)=>{var P9=nu(),R9=Array.prototype,D9=R9.splice;function O9(t){var e=this.__data__,r=P9(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():D9.call(e,r,1),--this.size,!0}e2.exports=O9});var n2=O((zfe,r2)=>{var I9=nu();function B9(t){var e=this.__data__,r=I9(e,t);return r<0?void 0:e[r][1]}r2.exports=B9});var a2=O((Hfe,i2)=>{var L9=nu();function N9(t){return L9(this.__data__,t)>-1}i2.exports=N9});var o2=O((Ufe,s2)=>{var F9=nu();function q9(t,e){var r=this.__data__,n=F9(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}s2.exports=q9});var iu=O((Wfe,l2)=>{var V9=$A(),z9=t2(),H9=n2(),U9=a2(),W9=o2();function Js(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Js.prototype.clear=V9;Js.prototype.delete=z9;Js.prototype.get=H9;Js.prototype.has=U9;Js.prototype.set=W9;l2.exports=Js});var c2=O((Gfe,u2)=>{var G9=iu();function K9(){this.__data__=new G9,this.size=0}u2.exports=K9});var h2=O((Kfe,f2)=>{function j9(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}f2.exports=j9});var p2=O((jfe,d2)=>{function Y9(t){return this.__data__.get(t)}d2.exports=Y9});var v2=O((Yfe,g2)=>{function Z9(t){return this.__data__.has(t)}g2.exports=Z9});var s0=O((Zfe,m2)=>{var X9=typeof global=="object"&&global&&global.Object===Object&&global;m2.exports=X9});var tn=O((Xfe,y2)=>{var $9=s0(),Q9=typeof self=="object"&&self&&self.Object===Object&&self,J9=$9||Q9||Function("return this")();y2.exports=J9});var Ua=O(($fe,b2)=>{var ej=tn(),tj=ej.Symbol;b2.exports=tj});var E2=O((Qfe,x2)=>{var w2=Ua(),_2=Object.prototype,rj=_2.hasOwnProperty,nj=_2.toString,au=w2?w2.toStringTag:void 0;function ij(t){var e=rj.call(t,au),r=t[au];try{t[au]=void 0;var n=!0}catch{}var a=nj.call(t);return n&&(e?t[au]=r:delete t[au]),a}x2.exports=ij});var C2=O((Jfe,S2)=>{var aj=Object.prototype,sj=aj.toString;function oj(t){return sj.call(t)}S2.exports=oj});var Gi=O((ehe,A2)=>{var T2=Ua(),lj=E2(),uj=C2(),cj="[object Null]",fj="[object Undefined]",k2=T2?T2.toStringTag:void 0;function hj(t){return t==null?t===void 0?fj:cj:k2&&k2 in Object(t)?lj(t):uj(t)}A2.exports=hj});var Ur=O((the,M2)=>{function dj(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}M2.exports=dj});var eo=O((rhe,P2)=>{var pj=Gi(),gj=Ur(),vj="[object AsyncFunction]",mj="[object Function]",yj="[object GeneratorFunction]",bj="[object Proxy]";function wj(t){if(!gj(t))return!1;var e=pj(t);return e==mj||e==yj||e==vj||e==bj}P2.exports=wj});var D2=O((nhe,R2)=>{var _j=tn(),xj=_j["__core-js_shared__"];R2.exports=xj});var B2=O((ihe,I2)=>{var o0=D2(),O2=function(){var t=/[^.]+$/.exec(o0&&o0.keys&&o0.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Ej(t){return!!O2&&O2 in t}I2.exports=Ej});var l0=O((ahe,L2)=>{var Sj=Function.prototype,Cj=Sj.toString;function Tj(t){if(t!=null){try{return Cj.call(t)}catch{}try{return t+""}catch{}}return""}L2.exports=Tj});var F2=O((she,N2)=>{var kj=eo(),Aj=B2(),Mj=Ur(),Pj=l0(),Rj=/[\\^$.*+?()[\]{}|]/g,Dj=/^\[object .+?Constructor\]$/,Oj=Function.prototype,Ij=Object.prototype,Bj=Oj.toString,Lj=Ij.hasOwnProperty,Nj=RegExp("^"+Bj.call(Lj).replace(Rj,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Fj(t){if(!Mj(t)||Aj(t))return!1;var e=kj(t)?Nj:Dj;return e.test(Pj(t))}N2.exports=Fj});var V2=O((ohe,q2)=>{function qj(t,e){return t?.[e]}q2.exports=qj});var Ki=O((lhe,z2)=>{var Vj=F2(),zj=V2();function Hj(t,e){var r=zj(t,e);return Vj(r)?r:void 0}z2.exports=Hj});var Rh=O((uhe,H2)=>{var Uj=Ki(),Wj=tn(),Gj=Uj(Wj,"Map");H2.exports=Gj});var su=O((che,U2)=>{var Kj=Ki(),jj=Kj(Object,"create");U2.exports=jj});var K2=O((fhe,G2)=>{var W2=su();function Yj(){this.__data__=W2?W2(null):{},this.size=0}G2.exports=Yj});var Y2=O((hhe,j2)=>{function Zj(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}j2.exports=Zj});var X2=O((dhe,Z2)=>{var Xj=su(),$j="__lodash_hash_undefined__",Qj=Object.prototype,Jj=Qj.hasOwnProperty;function e7(t){var e=this.__data__;if(Xj){var r=e[t];return r===$j?void 0:r}return Jj.call(e,t)?e[t]:void 0}Z2.exports=e7});var Q2=O((phe,$2)=>{var t7=su(),r7=Object.prototype,n7=r7.hasOwnProperty;function i7(t){var e=this.__data__;return t7?e[t]!==void 0:n7.call(e,t)}$2.exports=i7});var eM=O((ghe,J2)=>{var a7=su(),s7="__lodash_hash_undefined__";function o7(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=a7&&e===void 0?s7:e,this}J2.exports=o7});var rM=O((vhe,tM)=>{var l7=K2(),u7=Y2(),c7=X2(),f7=Q2(),h7=eM();function to(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}to.prototype.clear=l7;to.prototype.delete=u7;to.prototype.get=c7;to.prototype.has=f7;to.prototype.set=h7;tM.exports=to});var aM=O((mhe,iM)=>{var nM=rM(),d7=iu(),p7=Rh();function g7(){this.size=0,this.__data__={hash:new nM,map:new(p7||d7),string:new nM}}iM.exports=g7});var oM=O((yhe,sM)=>{function v7(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}sM.exports=v7});var ou=O((bhe,lM)=>{var m7=oM();function y7(t,e){var r=t.__data__;return m7(e)?r[typeof e=="string"?"string":"hash"]:r.map}lM.exports=y7});var cM=O((whe,uM)=>{var b7=ou();function w7(t){var e=b7(this,t).delete(t);return this.size-=e?1:0,e}uM.exports=w7});var hM=O((_he,fM)=>{var _7=ou();function x7(t){return _7(this,t).get(t)}fM.exports=x7});var pM=O((xhe,dM)=>{var E7=ou();function S7(t){return E7(this,t).has(t)}dM.exports=S7});var vM=O((Ehe,gM)=>{var C7=ou();function T7(t,e){var r=C7(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}gM.exports=T7});var Dh=O((She,mM)=>{var k7=aM(),A7=cM(),M7=hM(),P7=pM(),R7=vM();function ro(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ro.prototype.clear=k7;ro.prototype.delete=A7;ro.prototype.get=M7;ro.prototype.has=P7;ro.prototype.set=R7;mM.exports=ro});var bM=O((Che,yM)=>{var D7=iu(),O7=Rh(),I7=Dh(),B7=200;function L7(t,e){var r=this.__data__;if(r instanceof D7){var n=r.__data__;if(!O7||n.length<B7-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new I7(n)}return r.set(t,e),this.size=r.size,this}yM.exports=L7});var lu=O((The,wM)=>{var N7=iu(),F7=c2(),q7=h2(),V7=p2(),z7=v2(),H7=bM();function no(t){var e=this.__data__=new N7(t);this.size=e.size}no.prototype.clear=F7;no.prototype.delete=q7;no.prototype.get=V7;no.prototype.has=z7;no.prototype.set=H7;wM.exports=no});var Oh=O((khe,_M)=>{function U7(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}_M.exports=U7});var u0=O((Ahe,xM)=>{var W7=Ki(),G7=function(){try{var t=W7(Object,"defineProperty");return t({},"",{}),t}catch{}}();xM.exports=G7});var uu=O((Mhe,SM)=>{var EM=u0();function K7(t,e,r){e=="__proto__"&&EM?EM(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}SM.exports=K7});var cu=O((Phe,CM)=>{var j7=uu(),Y7=Ha(),Z7=Object.prototype,X7=Z7.hasOwnProperty;function $7(t,e,r){var n=t[e];(!(X7.call(t,e)&&Y7(n,r))||r===void 0&&!(e in t))&&j7(t,e,r)}CM.exports=$7});var io=O((Rhe,TM)=>{var Q7=cu(),J7=uu();function eY(t,e,r,n){var a=!r;r||(r={});for(var s=-1,o=e.length;++s<o;){var l=e[s],u=n?n(r[l],t[l],l,r,t):void 0;u===void 0&&(u=t[l]),a?J7(r,l,u):Q7(r,l,u)}return r}TM.exports=eY});var AM=O((Dhe,kM)=>{function tY(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}kM.exports=tY});var yn=O((Ohe,MM)=>{function rY(t){return t!=null&&typeof t=="object"}MM.exports=rY});var RM=O((Ihe,PM)=>{var nY=Gi(),iY=yn(),aY="[object Arguments]";function sY(t){return iY(t)&&nY(t)==aY}PM.exports=sY});var ao=O((Bhe,IM)=>{var DM=RM(),oY=yn(),OM=Object.prototype,lY=OM.hasOwnProperty,uY=OM.propertyIsEnumerable,cY=DM(function(){return arguments}())?DM:function(t){return oY(t)&&lY.call(t,"callee")&&!uY.call(t,"callee")};IM.exports=cY});var Rt=O((Lhe,BM)=>{var fY=Array.isArray;BM.exports=fY});var NM=O((Nhe,LM)=>{function hY(){return!1}LM.exports=hY});var Wa=O((fu,so)=>{var dY=tn(),pY=NM(),VM=typeof fu=="object"&&fu&&!fu.nodeType&&fu,FM=VM&&typeof so=="object"&&so&&!so.nodeType&&so,gY=FM&&FM.exports===VM,qM=gY?dY.Buffer:void 0,vY=qM?qM.isBuffer:void 0,mY=vY||pY;so.exports=mY});var hu=O((Fhe,zM)=>{var yY=9007199254740991,bY=/^(?:0|[1-9]\d*)$/;function wY(t,e){var r=typeof t;return e=e??yY,!!e&&(r=="number"||r!="symbol"&&bY.test(t))&&t>-1&&t%1==0&&t<e}zM.exports=wY});var Ih=O((qhe,HM)=>{var _Y=9007199254740991;function xY(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=_Y}HM.exports=xY});var WM=O((Vhe,UM)=>{var EY=Gi(),SY=Ih(),CY=yn(),TY="[object Arguments]",kY="[object Array]",AY="[object Boolean]",MY="[object Date]",PY="[object Error]",RY="[object Function]",DY="[object Map]",OY="[object Number]",IY="[object Object]",BY="[object RegExp]",LY="[object Set]",NY="[object String]",FY="[object WeakMap]",qY="[object ArrayBuffer]",VY="[object DataView]",zY="[object Float32Array]",HY="[object Float64Array]",UY="[object Int8Array]",WY="[object Int16Array]",GY="[object Int32Array]",KY="[object Uint8Array]",jY="[object Uint8ClampedArray]",YY="[object Uint16Array]",ZY="[object Uint32Array]",xt={};xt[zY]=xt[HY]=xt[UY]=xt[WY]=xt[GY]=xt[KY]=xt[jY]=xt[YY]=xt[ZY]=!0;xt[TY]=xt[kY]=xt[qY]=xt[AY]=xt[VY]=xt[MY]=xt[PY]=xt[RY]=xt[DY]=xt[OY]=xt[IY]=xt[BY]=xt[LY]=xt[NY]=xt[FY]=!1;function XY(t){return CY(t)&&SY(t.length)&&!!xt[EY(t)]}UM.exports=XY});var du=O((zhe,GM)=>{function $Y(t){return function(e){return t(e)}}GM.exports=$Y});var Bh=O((pu,oo)=>{var QY=s0(),KM=typeof pu=="object"&&pu&&!pu.nodeType&&pu,gu=KM&&typeof oo=="object"&&oo&&!oo.nodeType&&oo,JY=gu&&gu.exports===KM,c0=JY&&QY.process,eZ=function(){try{var t=gu&&gu.require&&gu.require("util").types;return t||c0&&c0.binding&&c0.binding("util")}catch{}}();oo.exports=eZ});var lo=O((Hhe,ZM)=>{var tZ=WM(),rZ=du(),jM=Bh(),YM=jM&&jM.isTypedArray,nZ=YM?rZ(YM):tZ;ZM.exports=nZ});var f0=O((Uhe,XM)=>{var iZ=AM(),aZ=ao(),sZ=Rt(),oZ=Wa(),lZ=hu(),uZ=lo(),cZ=Object.prototype,fZ=cZ.hasOwnProperty;function hZ(t,e){var r=sZ(t),n=!r&&aZ(t),a=!r&&!n&&oZ(t),s=!r&&!n&&!a&&uZ(t),o=r||n||a||s,l=o?iZ(t.length,String):[],u=l.length;for(var c in t)(e||fZ.call(t,c))&&!(o&&(c=="length"||a&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||lZ(c,u)))&&l.push(c);return l}XM.exports=hZ});var vu=O((Whe,$M)=>{var dZ=Object.prototype;function pZ(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||dZ;return t===r}$M.exports=pZ});var h0=O((Ghe,QM)=>{function gZ(t,e){return function(r){return t(e(r))}}QM.exports=gZ});var eP=O((Khe,JM)=>{var vZ=h0(),mZ=vZ(Object.keys,Object);JM.exports=mZ});var Lh=O((jhe,tP)=>{var yZ=vu(),bZ=eP(),wZ=Object.prototype,_Z=wZ.hasOwnProperty;function xZ(t){if(!yZ(t))return bZ(t);var e=[];for(var r in Object(t))_Z.call(t,r)&&r!="constructor"&&e.push(r);return e}tP.exports=xZ});var qn=O((Yhe,rP)=>{var EZ=eo(),SZ=Ih();function CZ(t){return t!=null&&SZ(t.length)&&!EZ(t)}rP.exports=CZ});var si=O((Zhe,nP)=>{var TZ=f0(),kZ=Lh(),AZ=qn();function MZ(t){return AZ(t)?TZ(t):kZ(t)}nP.exports=MZ});var aP=O((Xhe,iP)=>{var PZ=io(),RZ=si();function DZ(t,e){return t&&PZ(e,RZ(e),t)}iP.exports=DZ});var oP=O(($he,sP)=>{function OZ(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}sP.exports=OZ});var uP=O((Qhe,lP)=>{var IZ=Ur(),BZ=vu(),LZ=oP(),NZ=Object.prototype,FZ=NZ.hasOwnProperty;function qZ(t){if(!IZ(t))return LZ(t);var e=BZ(t),r=[];for(var n in t)n=="constructor"&&(e||!FZ.call(t,n))||r.push(n);return r}lP.exports=qZ});var ji=O((Jhe,cP)=>{var VZ=f0(),zZ=uP(),HZ=qn();function UZ(t){return HZ(t)?VZ(t,!0):zZ(t)}cP.exports=UZ});var hP=O((ede,fP)=>{var WZ=io(),GZ=ji();function KZ(t,e){return t&&WZ(e,GZ(e),t)}fP.exports=KZ});var d0=O((mu,uo)=>{var jZ=tn(),vP=typeof mu=="object"&&mu&&!mu.nodeType&&mu,dP=vP&&typeof uo=="object"&&uo&&!uo.nodeType&&uo,YZ=dP&&dP.exports===vP,pP=YZ?jZ.Buffer:void 0,gP=pP?pP.allocUnsafe:void 0;function ZZ(t,e){if(e)return t.slice();var r=t.length,n=gP?gP(r):new t.constructor(r);return t.copy(n),n}uo.exports=ZZ});var p0=O((tde,mP)=>{function XZ(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}mP.exports=XZ});var g0=O((rde,yP)=>{function $Z(t,e){for(var r=-1,n=t==null?0:t.length,a=0,s=[];++r<n;){var o=t[r];e(o,r,t)&&(s[a++]=o)}return s}yP.exports=$Z});var v0=O((nde,bP)=>{function QZ(){return[]}bP.exports=QZ});var Nh=O((ide,_P)=>{var JZ=g0(),eX=v0(),tX=Object.prototype,rX=tX.propertyIsEnumerable,wP=Object.getOwnPropertySymbols,nX=wP?function(t){return t==null?[]:(t=Object(t),JZ(wP(t),function(e){return rX.call(t,e)}))}:eX;_P.exports=nX});var EP=O((ade,xP)=>{var iX=io(),aX=Nh();function sX(t,e){return iX(t,aX(t),e)}xP.exports=sX});var Fh=O((sde,SP)=>{function oX(t,e){for(var r=-1,n=e.length,a=t.length;++r<n;)t[a+r]=e[r];return t}SP.exports=oX});var yu=O((ode,CP)=>{var lX=h0(),uX=lX(Object.getPrototypeOf,Object);CP.exports=uX});var m0=O((lde,TP)=>{var cX=Fh(),fX=yu(),hX=Nh(),dX=v0(),pX=Object.getOwnPropertySymbols,gX=pX?function(t){for(var e=[];t;)cX(e,hX(t)),t=fX(t);return e}:dX;TP.exports=gX});var AP=O((ude,kP)=>{var vX=io(),mX=m0();function yX(t,e){return vX(t,mX(t),e)}kP.exports=yX});var y0=O((cde,MP)=>{var bX=Fh(),wX=Rt();function _X(t,e,r){var n=e(t);return wX(t)?n:bX(n,r(t))}MP.exports=_X});var b0=O((fde,PP)=>{var xX=y0(),EX=Nh(),SX=si();function CX(t){return xX(t,SX,EX)}PP.exports=CX});var DP=O((hde,RP)=>{var TX=y0(),kX=m0(),AX=ji();function MX(t){return TX(t,AX,kX)}RP.exports=MX});var IP=O((dde,OP)=>{var PX=Ki(),RX=tn(),DX=PX(RX,"DataView");OP.exports=DX});var LP=O((pde,BP)=>{var OX=Ki(),IX=tn(),BX=OX(IX,"Promise");BP.exports=BX});var w0=O((gde,NP)=>{var LX=Ki(),NX=tn(),FX=LX(NX,"Set");NP.exports=FX});var qP=O((vde,FP)=>{var qX=Ki(),VX=tn(),zX=qX(VX,"WeakMap");FP.exports=zX});var Ka=O((mde,KP)=>{var _0=IP(),x0=Rh(),E0=LP(),S0=w0(),C0=qP(),GP=Gi(),co=l0(),VP="[object Map]",HX="[object Object]",zP="[object Promise]",HP="[object Set]",UP="[object WeakMap]",WP="[object DataView]",UX=co(_0),WX=co(x0),GX=co(E0),KX=co(S0),jX=co(C0),Ga=GP;(_0&&Ga(new _0(new ArrayBuffer(1)))!=WP||x0&&Ga(new x0)!=VP||E0&&Ga(E0.resolve())!=zP||S0&&Ga(new S0)!=HP||C0&&Ga(new C0)!=UP)&&(Ga=function(t){var e=GP(t),r=e==HX?t.constructor:void 0,n=r?co(r):"";if(n)switch(n){case UX:return WP;case WX:return VP;case GX:return zP;case KX:return HP;case jX:return UP}return e});KP.exports=Ga});var YP=O((yde,jP)=>{var YX=Object.prototype,ZX=YX.hasOwnProperty;function XX(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&ZX.call(t,"index")&&(r.index=t.index,r.input=t.input),r}jP.exports=XX});var T0=O((bde,ZP)=>{var $X=tn(),QX=$X.Uint8Array;ZP.exports=QX});var qh=O((wde,$P)=>{var XP=T0();function JX(t){var e=new t.constructor(t.byteLength);return new XP(e).set(new XP(t)),e}$P.exports=JX});var JP=O((_de,QP)=>{var e$=qh();function t$(t,e){var r=e?e$(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}QP.exports=t$});var tR=O((xde,eR)=>{var r$=/\w*$/;function n$(t){var e=new t.constructor(t.source,r$.exec(t));return e.lastIndex=t.lastIndex,e}eR.exports=n$});var sR=O((Ede,aR)=>{var rR=Ua(),nR=rR?rR.prototype:void 0,iR=nR?nR.valueOf:void 0;function i$(t){return iR?Object(iR.call(t)):{}}aR.exports=i$});var k0=O((Sde,oR)=>{var a$=qh();function s$(t,e){var r=e?a$(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}oR.exports=s$});var uR=O((Cde,lR)=>{var o$=qh(),l$=JP(),u$=tR(),c$=sR(),f$=k0(),h$="[object Boolean]",d$="[object Date]",p$="[object Map]",g$="[object Number]",v$="[object RegExp]",m$="[object Set]",y$="[object String]",b$="[object Symbol]",w$="[object ArrayBuffer]",_$="[object DataView]",x$="[object Float32Array]",E$="[object Float64Array]",S$="[object Int8Array]",C$="[object Int16Array]",T$="[object Int32Array]",k$="[object Uint8Array]",A$="[object Uint8ClampedArray]",M$="[object Uint16Array]",P$="[object Uint32Array]";function R$(t,e,r){var n=t.constructor;switch(e){case w$:return o$(t);case h$:case d$:return new n(+t);case _$:return l$(t,r);case x$:case E$:case S$:case C$:case T$:case k$:case A$:case M$:case P$:return f$(t,r);case p$:return new n;case g$:case y$:return new n(t);case v$:return u$(t);case m$:return new n;case b$:return c$(t)}}lR.exports=R$});var A0=O((Tde,fR)=>{var D$=Ur(),cR=Object.create,O$=function(){function t(){}return function(e){if(!D$(e))return{};if(cR)return cR(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();fR.exports=O$});var M0=O((kde,hR)=>{var I$=A0(),B$=yu(),L$=vu();function N$(t){return typeof t.constructor=="function"&&!L$(t)?I$(B$(t)):{}}hR.exports=N$});var pR=O((Ade,dR)=>{var F$=Ka(),q$=yn(),V$="[object Map]";function z$(t){return q$(t)&&F$(t)==V$}dR.exports=z$});var yR=O((Mde,mR)=>{var H$=pR(),U$=du(),gR=Bh(),vR=gR&&gR.isMap,W$=vR?U$(vR):H$;mR.exports=W$});var wR=O((Pde,bR)=>{var G$=Ka(),K$=yn(),j$="[object Set]";function Y$(t){return K$(t)&&G$(t)==j$}bR.exports=Y$});var SR=O((Rde,ER)=>{var Z$=wR(),X$=du(),_R=Bh(),xR=_R&&_R.isSet,$$=xR?X$(xR):Z$;ER.exports=$$});var P0=O((Dde,AR)=>{var Q$=lu(),J$=Oh(),eQ=cu(),tQ=aP(),rQ=hP(),nQ=d0(),iQ=p0(),aQ=EP(),sQ=AP(),oQ=b0(),lQ=DP(),uQ=Ka(),cQ=YP(),fQ=uR(),hQ=M0(),dQ=Rt(),pQ=Wa(),gQ=yR(),vQ=Ur(),mQ=SR(),yQ=si(),bQ=ji(),wQ=1,_Q=2,xQ=4,CR="[object Arguments]",EQ="[object Array]",SQ="[object Boolean]",CQ="[object Date]",TQ="[object Error]",TR="[object Function]",kQ="[object GeneratorFunction]",AQ="[object Map]",MQ="[object Number]",kR="[object Object]",PQ="[object RegExp]",RQ="[object Set]",DQ="[object String]",OQ="[object Symbol]",IQ="[object WeakMap]",BQ="[object ArrayBuffer]",LQ="[object DataView]",NQ="[object Float32Array]",FQ="[object Float64Array]",qQ="[object Int8Array]",VQ="[object Int16Array]",zQ="[object Int32Array]",HQ="[object Uint8Array]",UQ="[object Uint8ClampedArray]",WQ="[object Uint16Array]",GQ="[object Uint32Array]",bt={};bt[CR]=bt[EQ]=bt[BQ]=bt[LQ]=bt[SQ]=bt[CQ]=bt[NQ]=bt[FQ]=bt[qQ]=bt[VQ]=bt[zQ]=bt[AQ]=bt[MQ]=bt[kR]=bt[PQ]=bt[RQ]=bt[DQ]=bt[OQ]=bt[HQ]=bt[UQ]=bt[WQ]=bt[GQ]=!0;bt[TQ]=bt[TR]=bt[IQ]=!1;function Vh(t,e,r,n,a,s){var o,l=e&wQ,u=e&_Q,c=e&xQ;if(r&&(o=a?r(t,n,a,s):r(t)),o!==void 0)return o;if(!vQ(t))return t;var f=dQ(t);if(f){if(o=cQ(t),!l)return iQ(t,o)}else{var h=uQ(t),d=h==TR||h==kQ;if(pQ(t))return nQ(t,l);if(h==kR||h==CR||d&&!a){if(o=u||d?{}:hQ(t),!l)return u?sQ(t,rQ(o,t)):aQ(t,tQ(o,t))}else{if(!bt[h])return a?t:{};o=fQ(t,h,l)}}s||(s=new Q$);var p=s.get(t);if(p)return p;s.set(t,o),mQ(t)?t.forEach(function(v){o.add(Vh(v,e,r,v,t,s))}):gQ(t)&&t.forEach(function(v,y){o.set(y,Vh(v,e,r,y,t,s))});var g=c?u?lQ:oQ:u?bQ:yQ,m=f?void 0:g(t);return J$(m||t,function(v,y){m&&(y=v,v=t[y]),eQ(o,y,Vh(v,e,r,y,t,s))}),o}AR.exports=Vh});var PR=O((Ode,MR)=>{var KQ=P0(),jQ=4;function YQ(t){return KQ(t,jQ)}MR.exports=YQ});var zh=O((Ide,RR)=>{function ZQ(t){return function(){return t}}RR.exports=ZQ});var OR=O((Bde,DR)=>{function XQ(t){return function(e,r,n){for(var a=-1,s=Object(e),o=n(e),l=o.length;l--;){var u=o[t?l:++a];if(r(s[u],u,s)===!1)break}return e}}DR.exports=XQ});var Hh=O((Lde,IR)=>{var $Q=OR(),QQ=$Q();IR.exports=QQ});var Uh=O((Nde,BR)=>{var JQ=Hh(),eJ=si();function tJ(t,e){return t&&JQ(t,e,eJ)}BR.exports=tJ});var NR=O((Fde,LR)=>{var rJ=qn();function nJ(t,e){return function(r,n){if(r==null)return r;if(!rJ(r))return t(r,n);for(var a=r.length,s=e?a:-1,o=Object(r);(e?s--:++s<a)&&n(o[s],s,o)!==!1;);return r}}LR.exports=nJ});var bu=O((qde,FR)=>{var iJ=Uh(),aJ=NR(),sJ=aJ(iJ);FR.exports=sJ});var Yi=O((Vde,qR)=>{function oJ(t){return t}qR.exports=oJ});var R0=O((zde,VR)=>{var lJ=Yi();function uJ(t){return typeof t=="function"?t:lJ}VR.exports=uJ});var D0=O((Hde,zR)=>{var cJ=Oh(),fJ=bu(),hJ=R0(),dJ=Rt();function pJ(t,e){var r=dJ(t)?cJ:fJ;return r(t,hJ(e))}zR.exports=pJ});var O0=O((Ude,HR)=>{HR.exports=D0()});var WR=O((Wde,UR)=>{var gJ=bu();function vJ(t,e){var r=[];return gJ(t,function(n,a,s){e(n,a,s)&&r.push(n)}),r}UR.exports=vJ});var KR=O((Gde,GR)=>{var mJ="__lodash_hash_undefined__";function yJ(t){return this.__data__.set(t,mJ),this}GR.exports=yJ});var YR=O((Kde,jR)=>{function bJ(t){return this.__data__.has(t)}jR.exports=bJ});var I0=O((jde,ZR)=>{var wJ=Dh(),_J=KR(),xJ=YR();function Wh(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new wJ;++e<r;)this.add(t[e])}Wh.prototype.add=Wh.prototype.push=_J;Wh.prototype.has=xJ;ZR.exports=Wh});var $R=O((Yde,XR)=>{function EJ(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}XR.exports=EJ});var B0=O((Zde,QR)=>{function SJ(t,e){return t.has(e)}QR.exports=SJ});var L0=O((Xde,JR)=>{var CJ=I0(),TJ=$R(),kJ=B0(),AJ=1,MJ=2;function PJ(t,e,r,n,a,s){var o=r&AJ,l=t.length,u=e.length;if(l!=u&&!(o&&u>l))return!1;var c=s.get(t),f=s.get(e);if(c&&f)return c==e&&f==t;var h=-1,d=!0,p=r&MJ?new CJ:void 0;for(s.set(t,e),s.set(e,t);++h<l;){var g=t[h],m=e[h];if(n)var v=o?n(m,g,h,e,t,s):n(g,m,h,t,e,s);if(v!==void 0){if(v)continue;d=!1;break}if(p){if(!TJ(e,function(y,b){if(!kJ(p,b)&&(g===y||a(g,y,r,n,s)))return p.push(b)})){d=!1;break}}else if(!(g===m||a(g,m,r,n,s))){d=!1;break}}return s.delete(t),s.delete(e),d}JR.exports=PJ});var tD=O(($de,eD)=>{function RJ(t){var e=-1,r=Array(t.size);return t.forEach(function(n,a){r[++e]=[a,n]}),r}eD.exports=RJ});var Gh=O((Qde,rD)=>{function DJ(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}rD.exports=DJ});var oD=O((Jde,sD)=>{var nD=Ua(),iD=T0(),OJ=Ha(),IJ=L0(),BJ=tD(),LJ=Gh(),NJ=1,FJ=2,qJ="[object Boolean]",VJ="[object Date]",zJ="[object Error]",HJ="[object Map]",UJ="[object Number]",WJ="[object RegExp]",GJ="[object Set]",KJ="[object String]",jJ="[object Symbol]",YJ="[object ArrayBuffer]",ZJ="[object DataView]",aD=nD?nD.prototype:void 0,N0=aD?aD.valueOf:void 0;function XJ(t,e,r,n,a,s,o){switch(r){case ZJ:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case YJ:return!(t.byteLength!=e.byteLength||!s(new iD(t),new iD(e)));case qJ:case VJ:case UJ:return OJ(+t,+e);case zJ:return t.name==e.name&&t.message==e.message;case WJ:case KJ:return t==e+"";case HJ:var l=BJ;case GJ:var u=n&NJ;if(l||(l=LJ),t.size!=e.size&&!u)return!1;var c=o.get(t);if(c)return c==e;n|=FJ,o.set(t,e);var f=IJ(l(t),l(e),n,a,s,o);return o.delete(t),f;case jJ:if(N0)return N0.call(t)==N0.call(e)}return!1}sD.exports=XJ});var cD=O((epe,uD)=>{var lD=b0(),$J=1,QJ=Object.prototype,JJ=QJ.hasOwnProperty;function eee(t,e,r,n,a,s){var o=r&$J,l=lD(t),u=l.length,c=lD(e),f=c.length;if(u!=f&&!o)return!1;for(var h=u;h--;){var d=l[h];if(!(o?d in e:JJ.call(e,d)))return!1}var p=s.get(t),g=s.get(e);if(p&&g)return p==e&&g==t;var m=!0;s.set(t,e),s.set(e,t);for(var v=o;++h<u;){d=l[h];var y=t[d],b=e[d];if(n)var w=o?n(b,y,d,e,t,s):n(y,b,d,t,e,s);if(!(w===void 0?y===b||a(y,b,r,n,s):w)){m=!1;break}v||(v=d=="constructor")}if(m&&!v){var _=t.constructor,x=e.constructor;_!=x&&"constructor"in t&&"constructor"in e&&!(typeof _=="function"&&_ instanceof _&&typeof x=="function"&&x instanceof x)&&(m=!1)}return s.delete(t),s.delete(e),m}uD.exports=eee});var yD=O((tpe,mD)=>{var F0=lu(),tee=L0(),ree=oD(),nee=cD(),fD=Ka(),hD=Rt(),dD=Wa(),iee=lo(),aee=1,pD="[object Arguments]",gD="[object Array]",Kh="[object Object]",see=Object.prototype,vD=see.hasOwnProperty;function oee(t,e,r,n,a,s){var o=hD(t),l=hD(e),u=o?gD:fD(t),c=l?gD:fD(e);u=u==pD?Kh:u,c=c==pD?Kh:c;var f=u==Kh,h=c==Kh,d=u==c;if(d&&dD(t)){if(!dD(e))return!1;o=!0,f=!1}if(d&&!f)return s||(s=new F0),o||iee(t)?tee(t,e,r,n,a,s):ree(t,e,u,r,n,a,s);if(!(r&aee)){var p=f&&vD.call(t,"__wrapped__"),g=h&&vD.call(e,"__wrapped__");if(p||g){var m=p?t.value():t,v=g?e.value():e;return s||(s=new F0),a(m,v,r,n,s)}}return d?(s||(s=new F0),nee(t,e,r,n,a,s)):!1}mD.exports=oee});var q0=O((rpe,_D)=>{var lee=yD(),bD=yn();function wD(t,e,r,n,a){return t===e?!0:t==null||e==null||!bD(t)&&!bD(e)?t!==t&&e!==e:lee(t,e,r,n,wD,a)}_D.exports=wD});var ED=O((npe,xD)=>{var uee=lu(),cee=q0(),fee=1,hee=2;function dee(t,e,r,n){var a=r.length,s=a,o=!n;if(t==null)return!s;for(t=Object(t);a--;){var l=r[a];if(o&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++a<s;){l=r[a];var u=l[0],c=t[u],f=l[1];if(o&&l[2]){if(c===void 0&&!(u in t))return!1}else{var h=new uee;if(n)var d=n(c,f,u,t,e,h);if(!(d===void 0?cee(f,c,fee|hee,n,h):d))return!1}}return!0}xD.exports=dee});var V0=O((ipe,SD)=>{var pee=Ur();function gee(t){return t===t&&!pee(t)}SD.exports=gee});var TD=O((ape,CD)=>{var vee=V0(),mee=si();function yee(t){for(var e=mee(t),r=e.length;r--;){var n=e[r],a=t[n];e[r]=[n,a,vee(a)]}return e}CD.exports=yee});var z0=O((spe,kD)=>{function bee(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}kD.exports=bee});var MD=O((ope,AD)=>{var wee=ED(),_ee=TD(),xee=z0();function Eee(t){var e=_ee(t);return e.length==1&&e[0][2]?xee(e[0][0],e[0][1]):function(r){return r===t||wee(r,t,e)}}AD.exports=Eee});var ja=O((lpe,PD)=>{var See=Gi(),Cee=yn(),Tee="[object Symbol]";function kee(t){return typeof t=="symbol"||Cee(t)&&See(t)==Tee}PD.exports=kee});var jh=O((upe,RD)=>{var Aee=Rt(),Mee=ja(),Pee=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ree=/^\w*$/;function Dee(t,e){if(Aee(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Mee(t)?!0:Ree.test(t)||!Pee.test(t)||e!=null&&t in Object(e)}RD.exports=Dee});var ID=O((cpe,OD)=>{var DD=Dh(),Oee="Expected a function";function H0(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Oee);var r=function(){var n=arguments,a=e?e.apply(this,n):n[0],s=r.cache;if(s.has(a))return s.get(a);var o=t.apply(this,n);return r.cache=s.set(a,o)||s,o};return r.cache=new(H0.Cache||DD),r}H0.Cache=DD;OD.exports=H0});var LD=O((fpe,BD)=>{var Iee=ID(),Bee=500;function Lee(t){var e=Iee(t,function(n){return r.size===Bee&&r.clear(),n}),r=e.cache;return e}BD.exports=Lee});var FD=O((hpe,ND)=>{var Nee=LD(),Fee=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,qee=/\\(\\)?/g,Vee=Nee(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Fee,function(r,n,a,s){e.push(a?s.replace(qee,"$1"):n||r)}),e});ND.exports=Vee});var wu=O((dpe,qD)=>{function zee(t,e){for(var r=-1,n=t==null?0:t.length,a=Array(n);++r<n;)a[r]=e(t[r],r,t);return a}qD.exports=zee});var GD=O((ppe,WD)=>{var VD=Ua(),Hee=wu(),Uee=Rt(),Wee=ja(),Gee=1/0,zD=VD?VD.prototype:void 0,HD=zD?zD.toString:void 0;function UD(t){if(typeof t=="string")return t;if(Uee(t))return Hee(t,UD)+"";if(Wee(t))return HD?HD.call(t):"";var e=t+"";return e=="0"&&1/t==-Gee?"-0":e}WD.exports=UD});var U0=O((gpe,KD)=>{var Kee=GD();function jee(t){return t==null?"":Kee(t)}KD.exports=jee});var _u=O((vpe,jD)=>{var Yee=Rt(),Zee=jh(),Xee=FD(),$ee=U0();function Qee(t,e){return Yee(t)?t:Zee(t,e)?[t]:Xee($ee(t))}jD.exports=Qee});var fo=O((mpe,YD)=>{var Jee=ja(),ete=1/0;function tte(t){if(typeof t=="string"||Jee(t))return t;var e=t+"";return e=="0"&&1/t==-ete?"-0":e}YD.exports=tte});var xu=O((ype,ZD)=>{var rte=_u(),nte=fo();function ite(t,e){e=rte(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[nte(e[r++])];return r&&r==n?t:void 0}ZD.exports=ite});var $D=O((bpe,XD)=>{var ate=xu();function ste(t,e,r){var n=t==null?void 0:ate(t,e);return n===void 0?r:n}XD.exports=ste});var JD=O((wpe,QD)=>{function ote(t,e){return t!=null&&e in Object(t)}QD.exports=ote});var W0=O((_pe,eO)=>{var lte=_u(),ute=ao(),cte=Rt(),fte=hu(),hte=Ih(),dte=fo();function pte(t,e,r){e=lte(e,t);for(var n=-1,a=e.length,s=!1;++n<a;){var o=dte(e[n]);if(!(s=t!=null&&r(t,o)))break;t=t[o]}return s||++n!=a?s:(a=t==null?0:t.length,!!a&&hte(a)&&fte(o,a)&&(cte(t)||ute(t)))}eO.exports=pte});var G0=O((xpe,tO)=>{var gte=JD(),vte=W0();function mte(t,e){return t!=null&&vte(t,e,gte)}tO.exports=mte});var nO=O((Epe,rO)=>{var yte=q0(),bte=$D(),wte=G0(),_te=jh(),xte=V0(),Ete=z0(),Ste=fo(),Cte=1,Tte=2;function kte(t,e){return _te(t)&&xte(e)?Ete(Ste(t),e):function(r){var n=bte(r,t);return n===void 0&&n===e?wte(r,t):yte(e,n,Cte|Tte)}}rO.exports=kte});var K0=O((Spe,iO)=>{function Ate(t){return function(e){return e?.[t]}}iO.exports=Ate});var sO=O((Cpe,aO)=>{var Mte=xu();function Pte(t){return function(e){return Mte(e,t)}}aO.exports=Pte});var lO=O((Tpe,oO)=>{var Rte=K0(),Dte=sO(),Ote=jh(),Ite=fo();function Bte(t){return Ote(t)?Rte(Ite(t)):Dte(t)}oO.exports=Bte});var Vn=O((kpe,uO)=>{var Lte=MD(),Nte=nO(),Fte=Yi(),qte=Rt(),Vte=lO();function zte(t){return typeof t=="function"?t:t==null?Fte:typeof t=="object"?qte(t)?Nte(t[0],t[1]):Lte(t):Vte(t)}uO.exports=zte});var j0=O((Ape,cO)=>{var Hte=g0(),Ute=WR(),Wte=Vn(),Gte=Rt();function Kte(t,e){var r=Gte(t)?Hte:Ute;return r(t,Wte(e,3))}cO.exports=Kte});var hO=O((Mpe,fO)=>{var jte=Object.prototype,Yte=jte.hasOwnProperty;function Zte(t,e){return t!=null&&Yte.call(t,e)}fO.exports=Zte});var Y0=O((Ppe,dO)=>{var Xte=hO(),$te=W0();function Qte(t,e){return t!=null&&$te(t,e,Xte)}dO.exports=Qte});var gO=O((Rpe,pO)=>{var Jte=Lh(),ere=Ka(),tre=ao(),rre=Rt(),nre=qn(),ire=Wa(),are=vu(),sre=lo(),ore="[object Map]",lre="[object Set]",ure=Object.prototype,cre=ure.hasOwnProperty;function fre(t){if(t==null)return!0;if(nre(t)&&(rre(t)||typeof t=="string"||typeof t.splice=="function"||ire(t)||sre(t)||tre(t)))return!t.length;var e=ere(t);if(e==ore||e==lre)return!t.size;if(are(t))return!Jte(t).length;for(var r in t)if(cre.call(t,r))return!1;return!0}pO.exports=fre});var Z0=O((Dpe,vO)=>{function hre(t){return t===void 0}vO.exports=hre});var X0=O((Ope,mO)=>{var dre=bu(),pre=qn();function gre(t,e){var r=-1,n=pre(t)?Array(t.length):[];return dre(t,function(a,s,o){n[++r]=e(a,s,o)}),n}mO.exports=gre});var $0=O((Ipe,yO)=>{var vre=wu(),mre=Vn(),yre=X0(),bre=Rt();function wre(t,e){var r=bre(t)?vre:yre;return r(t,mre(e,3))}yO.exports=wre});var wO=O((Bpe,bO)=>{function _re(t,e,r,n){var a=-1,s=t==null?0:t.length;for(n&&s&&(r=t[++a]);++a<s;)r=e(r,t[a],a,t);return r}bO.exports=_re});var xO=O((Lpe,_O)=>{function xre(t,e,r,n,a){return a(t,function(s,o,l){r=n?(n=!1,s):e(r,s,o,l)}),r}_O.exports=xre});var Q0=O((Npe,EO)=>{var Ere=wO(),Sre=bu(),Cre=Vn(),Tre=xO(),kre=Rt();function Are(t,e,r){var n=kre(t)?Ere:Tre,a=arguments.length<3;return n(t,Cre(e,4),r,a,Sre)}EO.exports=Are});var CO=O((Fpe,SO)=>{var Mre=Gi(),Pre=Rt(),Rre=yn(),Dre="[object String]";function Ore(t){return typeof t=="string"||!Pre(t)&&Rre(t)&&Mre(t)==Dre}SO.exports=Ore});var kO=O((qpe,TO)=>{var Ire=K0(),Bre=Ire("length");TO.exports=Bre});var MO=O((Vpe,AO)=>{var Lre="\\ud800-\\udfff",Nre="\\u0300-\\u036f",Fre="\\ufe20-\\ufe2f",qre="\\u20d0-\\u20ff",Vre=Nre+Fre+qre,zre="\\ufe0e\\ufe0f",Hre="\\u200d",Ure=RegExp("["+Hre+Lre+Vre+zre+"]");function Wre(t){return Ure.test(t)}AO.exports=Wre});var FO=O((zpe,NO)=>{var RO="\\ud800-\\udfff",Gre="\\u0300-\\u036f",Kre="\\ufe20-\\ufe2f",jre="\\u20d0-\\u20ff",Yre=Gre+Kre+jre,Zre="\\ufe0e\\ufe0f",Xre="["+RO+"]",J0="["+Yre+"]",eb="\\ud83c[\\udffb-\\udfff]",$re="(?:"+J0+"|"+eb+")",DO="[^"+RO+"]",OO="(?:\\ud83c[\\udde6-\\uddff]){2}",IO="[\\ud800-\\udbff][\\udc00-\\udfff]",Qre="\\u200d",BO=$re+"?",LO="["+Zre+"]?",Jre="(?:"+Qre+"(?:"+[DO,OO,IO].join("|")+")"+LO+BO+")*",ene=LO+BO+Jre,tne="(?:"+[DO+J0+"?",J0,OO,IO,Xre].join("|")+")",PO=RegExp(eb+"(?="+eb+")|"+tne+ene,"g");function rne(t){for(var e=PO.lastIndex=0;PO.test(t);)++e;return e}NO.exports=rne});var VO=O((Hpe,qO)=>{var nne=kO(),ine=MO(),ane=FO();function sne(t){return ine(t)?ane(t):nne(t)}qO.exports=sne});var HO=O((Upe,zO)=>{var one=Lh(),lne=Ka(),une=qn(),cne=CO(),fne=VO(),hne="[object Map]",dne="[object Set]";function pne(t){if(t==null)return 0;if(une(t))return cne(t)?fne(t):t.length;var e=lne(t);return e==hne||e==dne?t.size:one(t).length}zO.exports=pne});var WO=O((Wpe,UO)=>{var gne=Oh(),vne=A0(),mne=Uh(),yne=Vn(),bne=yu(),wne=Rt(),_ne=Wa(),xne=eo(),Ene=Ur(),Sne=lo();function Cne(t,e,r){var n=wne(t),a=n||_ne(t)||Sne(t);if(e=yne(e,4),r==null){var s=t&&t.constructor;a?r=n?new s:[]:Ene(t)?r=xne(s)?vne(bne(t)):{}:r={}}return(a?gne:mne)(t,function(o,l,u){return e(r,o,l,u)}),r}UO.exports=Cne});var YO=O((Gpe,jO)=>{var GO=Ua(),Tne=ao(),kne=Rt(),KO=GO?GO.isConcatSpreadable:void 0;function Ane(t){return kne(t)||Tne(t)||!!(KO&&t&&t[KO])}jO.exports=Ane});var Yh=O((Kpe,XO)=>{var Mne=Fh(),Pne=YO();function ZO(t,e,r,n,a){var s=-1,o=t.length;for(r||(r=Pne),a||(a=[]);++s<o;){var l=t[s];e>0&&r(l)?e>1?ZO(l,e-1,r,n,a):Mne(a,l):n||(a[a.length]=l)}return a}XO.exports=ZO});var QO=O((jpe,$O)=>{function Rne(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}$O.exports=Rne});var tb=O((Ype,eI)=>{var Dne=QO(),JO=Math.max;function One(t,e,r){return e=JO(e===void 0?t.length-1:e,0),function(){for(var n=arguments,a=-1,s=JO(n.length-e,0),o=Array(s);++a<s;)o[a]=n[e+a];a=-1;for(var l=Array(e+1);++a<e;)l[a]=n[a];return l[e]=r(o),Dne(t,this,l)}}eI.exports=One});var nI=O((Zpe,rI)=>{var Ine=zh(),tI=u0(),Bne=Yi(),Lne=tI?function(t,e){return tI(t,"toString",{configurable:!0,enumerable:!1,value:Ine(e),writable:!0})}:Bne;rI.exports=Lne});var aI=O((Xpe,iI)=>{var Nne=800,Fne=16,qne=Date.now;function Vne(t){var e=0,r=0;return function(){var n=qne(),a=Fne-(n-r);if(r=n,a>0){if(++e>=Nne)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}iI.exports=Vne});var rb=O(($pe,sI)=>{var zne=nI(),Hne=aI(),Une=Hne(zne);sI.exports=Une});var Eu=O((Qpe,oI)=>{var Wne=Yi(),Gne=tb(),Kne=rb();function jne(t,e){return Kne(Gne(t,e,Wne),t+"")}oI.exports=jne});var nb=O((Jpe,lI)=>{function Yne(t,e,r,n){for(var a=t.length,s=r+(n?1:-1);n?s--:++s<a;)if(e(t[s],s,t))return s;return-1}lI.exports=Yne});var cI=O((ege,uI)=>{function Zne(t){return t!==t}uI.exports=Zne});var hI=O((tge,fI)=>{function Xne(t,e,r){for(var n=r-1,a=t.length;++n<a;)if(t[n]===e)return n;return-1}fI.exports=Xne});var pI=O((rge,dI)=>{var $ne=nb(),Qne=cI(),Jne=hI();function eie(t,e,r){return e===e?Jne(t,e,r):$ne(t,Qne,r)}dI.exports=eie});var vI=O((nge,gI)=>{var tie=pI();function rie(t,e){var r=t==null?0:t.length;return!!r&&tie(t,e,0)>-1}gI.exports=rie});var yI=O((ige,mI)=>{function nie(t,e,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(r(e,t[n]))return!0;return!1}mI.exports=nie});var wI=O((age,bI)=>{function iie(){}bI.exports=iie});var xI=O((sge,_I)=>{var ib=w0(),aie=wI(),sie=Gh(),oie=1/0,lie=ib&&1/sie(new ib([,-0]))[1]==oie?function(t){return new ib(t)}:aie;_I.exports=lie});var SI=O((oge,EI)=>{var uie=I0(),cie=vI(),fie=yI(),hie=B0(),die=xI(),pie=Gh(),gie=200;function vie(t,e,r){var n=-1,a=cie,s=t.length,o=!0,l=[],u=l;if(r)o=!1,a=fie;else if(s>=gie){var c=e?null:die(t);if(c)return pie(c);o=!1,a=hie,u=new uie}else u=e?[]:l;e:for(;++n<s;){var f=t[n],h=e?e(f):f;if(f=r||f!==0?f:0,o&&h===h){for(var d=u.length;d--;)if(u[d]===h)continue e;e&&u.push(h),l.push(f)}else a(u,h,r)||(u!==l&&u.push(h),l.push(f))}return l}EI.exports=vie});var ab=O((lge,CI)=>{var mie=qn(),yie=yn();function bie(t){return yie(t)&&mie(t)}CI.exports=bie});var kI=O((uge,TI)=>{var wie=Yh(),_ie=Eu(),xie=SI(),Eie=ab(),Sie=_ie(function(t){return xie(wie(t,1,Eie,!0))});TI.exports=Sie});var MI=O((cge,AI)=>{var Cie=wu();function Tie(t,e){return Cie(e,function(r){return t[r]})}AI.exports=Tie});var sb=O((fge,PI)=>{var kie=MI(),Aie=si();function Mie(t){return t==null?[]:kie(t,Aie(t))}PI.exports=Mie});var Wr=O((hge,RI)=>{var Zh;if(typeof Wn=="function")try{Zh={clone:PR(),constant:zh(),each:O0(),filter:j0(),has:Y0(),isArray:Rt(),isEmpty:gO(),isFunction:eo(),isUndefined:Z0(),keys:si(),map:$0(),reduce:Q0(),size:HO(),transform:WO(),union:kI(),values:sb()}}catch{}Zh||(Zh=window._);RI.exports=Zh});var Xh=O((pge,BI)=>{"use strict";var Ie=Wr();BI.exports=We;var Pie="\0",Ya="\0",DI="";function We(t){this._isDirected=Ie.has(t,"directed")?t.directed:!0,this._isMultigraph=Ie.has(t,"multigraph")?t.multigraph:!1,this._isCompound=Ie.has(t,"compound")?t.compound:!1,this._label=void 0,this._defaultNodeLabelFn=Ie.constant(void 0),this._defaultEdgeLabelFn=Ie.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[Ya]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}We.prototype._nodeCount=0;We.prototype._edgeCount=0;We.prototype.isDirected=function(){return this._isDirected};We.prototype.isMultigraph=function(){return this._isMultigraph};We.prototype.isCompound=function(){return this._isCompound};We.prototype.setGraph=function(t){return this._label=t,this};We.prototype.graph=function(){return this._label};We.prototype.setDefaultNodeLabel=function(t){return Ie.isFunction(t)||(t=Ie.constant(t)),this._defaultNodeLabelFn=t,this};We.prototype.nodeCount=function(){return this._nodeCount};We.prototype.nodes=function(){return Ie.keys(this._nodes)};We.prototype.sources=function(){var t=this;return Ie.filter(this.nodes(),function(e){return Ie.isEmpty(t._in[e])})};We.prototype.sinks=function(){var t=this;return Ie.filter(this.nodes(),function(e){return Ie.isEmpty(t._out[e])})};We.prototype.setNodes=function(t,e){var r=arguments,n=this;return Ie.each(t,function(a){r.length>1?n.setNode(a,e):n.setNode(a)}),this};We.prototype.setNode=function(t,e){return Ie.has(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=e),this):(this._nodes[t]=arguments.length>1?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=Ya,this._children[t]={},this._children[Ya][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)};We.prototype.node=function(t){return this._nodes[t]};We.prototype.hasNode=function(t){return Ie.has(this._nodes,t)};We.prototype.removeNode=function(t){var e=this;if(Ie.has(this._nodes,t)){var r=function(n){e.removeEdge(e._edgeObjs[n])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],Ie.each(this.children(t),function(n){e.setParent(n)}),delete this._children[t]),Ie.each(Ie.keys(this._in[t]),r),delete this._in[t],delete this._preds[t],Ie.each(Ie.keys(this._out[t]),r),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this};We.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(Ie.isUndefined(e))e=Ya;else{e+="";for(var r=e;!Ie.isUndefined(r);r=this.parent(r))if(r===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this};We.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]};We.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if(e!==Ya)return e}};We.prototype.children=function(t){if(Ie.isUndefined(t)&&(t=Ya),this._isCompound){var e=this._children[t];if(e)return Ie.keys(e)}else{if(t===Ya)return this.nodes();if(this.hasNode(t))return[]}};We.prototype.predecessors=function(t){var e=this._preds[t];if(e)return Ie.keys(e)};We.prototype.successors=function(t){var e=this._sucs[t];if(e)return Ie.keys(e)};We.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return Ie.union(e,this.successors(t))};We.prototype.isLeaf=function(t){var e;return this.isDirected()?e=this.successors(t):e=this.neighbors(t),e.length===0};We.prototype.filterNodes=function(t){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var r=this;Ie.each(this._nodes,function(s,o){t(o)&&e.setNode(o,s)}),Ie.each(this._edgeObjs,function(s){e.hasNode(s.v)&&e.hasNode(s.w)&&e.setEdge(s,r.edge(s))});var n={};function a(s){var o=r.parent(s);return o===void 0||e.hasNode(o)?(n[s]=o,o):o in n?n[o]:a(o)}return this._isCompound&&Ie.each(e.nodes(),function(s){e.setParent(s,a(s))}),e};We.prototype.setDefaultEdgeLabel=function(t){return Ie.isFunction(t)||(t=Ie.constant(t)),this._defaultEdgeLabelFn=t,this};We.prototype.edgeCount=function(){return this._edgeCount};We.prototype.edges=function(){return Ie.values(this._edgeObjs)};We.prototype.setPath=function(t,e){var r=this,n=arguments;return Ie.reduce(t,function(a,s){return n.length>1?r.setEdge(a,s,e):r.setEdge(a,s),s}),this};We.prototype.setEdge=function(){var t,e,r,n,a=!1,s=arguments[0];typeof s=="object"&&s!==null&&"v"in s?(t=s.v,e=s.w,r=s.name,arguments.length===2&&(n=arguments[1],a=!0)):(t=s,e=arguments[1],r=arguments[3],arguments.length>2&&(n=arguments[2],a=!0)),t=""+t,e=""+e,Ie.isUndefined(r)||(r=""+r);var o=Su(this._isDirected,t,e,r);if(Ie.has(this._edgeLabels,o))return a&&(this._edgeLabels[o]=n),this;if(!Ie.isUndefined(r)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(e),this._edgeLabels[o]=a?n:this._defaultEdgeLabelFn(t,e,r);var l=Rie(this._isDirected,t,e,r);return t=l.v,e=l.w,Object.freeze(l),this._edgeObjs[o]=l,OI(this._preds[e],t),OI(this._sucs[t],e),this._in[e][o]=l,this._out[t][o]=l,this._edgeCount++,this};We.prototype.edge=function(t,e,r){var n=arguments.length===1?ob(this._isDirected,arguments[0]):Su(this._isDirected,t,e,r);return this._edgeLabels[n]};We.prototype.hasEdge=function(t,e,r){var n=arguments.length===1?ob(this._isDirected,arguments[0]):Su(this._isDirected,t,e,r);return Ie.has(this._edgeLabels,n)};We.prototype.removeEdge=function(t,e,r){var n=arguments.length===1?ob(this._isDirected,arguments[0]):Su(this._isDirected,t,e,r),a=this._edgeObjs[n];return a&&(t=a.v,e=a.w,delete this._edgeLabels[n],delete this._edgeObjs[n],II(this._preds[e],t),II(this._sucs[t],e),delete this._in[e][n],delete this._out[t][n],this._edgeCount--),this};We.prototype.inEdges=function(t,e){var r=this._in[t];if(r){var n=Ie.values(r);return e?Ie.filter(n,function(a){return a.v===e}):n}};We.prototype.outEdges=function(t,e){var r=this._out[t];if(r){var n=Ie.values(r);return e?Ie.filter(n,function(a){return a.w===e}):n}};We.prototype.nodeEdges=function(t,e){var r=this.inEdges(t,e);if(r)return r.concat(this.outEdges(t,e))};function OI(t,e){t[e]?t[e]++:t[e]=1}function II(t,e){--t[e]||delete t[e]}function Su(t,e,r,n){var a=""+e,s=""+r;if(!t&&a>s){var o=a;a=s,s=o}return a+DI+s+DI+(Ie.isUndefined(n)?Pie:n)}function Rie(t,e,r,n){var a=""+e,s=""+r;if(!t&&a>s){var o=a;a=s,s=o}var l={v:a,w:s};return n&&(l.name=n),l}function ob(t,e){return Su(t,e.v,e.w,e.name)}});var NI=O((gge,LI)=>{LI.exports="2.1.8"});var qI=O((vge,FI)=>{FI.exports={Graph:Xh(),version:NI()}});var zI=O((mge,VI)=>{var zn=Wr(),Die=Xh();VI.exports={write:Oie,read:Lie};function Oie(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:Iie(t),edges:Bie(t)};return zn.isUndefined(t.graph())||(e.value=zn.clone(t.graph())),e}function Iie(t){return zn.map(t.nodes(),function(e){var r=t.node(e),n=t.parent(e),a={v:e};return zn.isUndefined(r)||(a.value=r),zn.isUndefined(n)||(a.parent=n),a})}function Bie(t){return zn.map(t.edges(),function(e){var r=t.edge(e),n={v:e.v,w:e.w};return zn.isUndefined(e.name)||(n.name=e.name),zn.isUndefined(r)||(n.value=r),n})}function Lie(t){var e=new Die(t.options).setGraph(t.value);return zn.each(t.nodes,function(r){e.setNode(r.v,r.value),r.parent&&e.setParent(r.v,r.parent)}),zn.each(t.edges,function(r){e.setEdge({v:r.v,w:r.w,name:r.name},r.value)}),e}});var UI=O((yge,HI)=>{var $h=Wr();HI.exports=Nie;function Nie(t){var e={},r=[],n;function a(s){$h.has(e,s)||(e[s]=!0,n.push(s),$h.each(t.successors(s),a),$h.each(t.predecessors(s),a))}return $h.each(t.nodes(),function(s){n=[],a(s),n.length&&r.push(n)}),r}});var lb=O((bge,GI)=>{var WI=Wr();GI.exports=rn;function rn(){this._arr=[],this._keyIndices={}}rn.prototype.size=function(){return this._arr.length};rn.prototype.keys=function(){return this._arr.map(function(t){return t.key})};rn.prototype.has=function(t){return WI.has(this._keyIndices,t)};rn.prototype.priority=function(t){var e=this._keyIndices[t];if(e!==void 0)return this._arr[e].priority};rn.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key};rn.prototype.add=function(t,e){var r=this._keyIndices;if(t=String(t),!WI.has(r,t)){var n=this._arr,a=n.length;return r[t]=a,n.push({key:t,priority:e}),this._decrease(a),!0}return!1};rn.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key};rn.prototype.decrease=function(t,e){var r=this._keyIndices[t];if(e>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[r].priority+" New: "+e);this._arr[r].priority=e,this._decrease(r)};rn.prototype._heapify=function(t){var e=this._arr,r=2*t,n=r+1,a=t;r<e.length&&(a=e[r].priority<e[a].priority?r:a,n<e.length&&(a=e[n].priority<e[a].priority?n:a),a!==t&&(this._swap(t,a),this._heapify(a)))};rn.prototype._decrease=function(t){for(var e=this._arr,r=e[t].priority,n;t!==0&&(n=t>>1,!(e[n].priority<r));)this._swap(t,n),t=n};rn.prototype._swap=function(t,e){var r=this._arr,n=this._keyIndices,a=r[t],s=r[e];r[t]=s,r[e]=a,n[s.key]=t,n[a.key]=e}});var ub=O((wge,KI)=>{var Fie=Wr(),qie=lb();KI.exports=zie;var Vie=Fie.constant(1);function zie(t,e,r,n){return Hie(t,String(e),r||Vie,n||function(a){return t.outEdges(a)})}function Hie(t,e,r,n){var a={},s=new qie,o,l,u=function(c){var f=c.v!==o?c.v:c.w,h=a[f],d=r(c),p=l.distance+d;if(d<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+c+" Weight: "+d);p<h.distance&&(h.distance=p,h.predecessor=o,s.decrease(f,p))};for(t.nodes().forEach(function(c){var f=c===e?0:Number.POSITIVE_INFINITY;a[c]={distance:f},s.add(c,f)});s.size()>0&&(o=s.removeMin(),l=a[o],l.distance!==Number.POSITIVE_INFINITY);)n(o).forEach(u);return a}});var YI=O((_ge,jI)=>{var Uie=ub(),Wie=Wr();jI.exports=Gie;function Gie(t,e,r){return Wie.transform(t.nodes(),function(n,a){n[a]=Uie(t,a,e,r)},{})}});var cb=O((xge,XI)=>{var ZI=Wr();XI.exports=Kie;function Kie(t){var e=0,r=[],n={},a=[];function s(o){var l=n[o]={onStack:!0,lowlink:e,index:e++};if(r.push(o),t.successors(o).forEach(function(f){ZI.has(n,f)?n[f].onStack&&(l.lowlink=Math.min(l.lowlink,n[f].index)):(s(f),l.lowlink=Math.min(l.lowlink,n[f].lowlink))}),l.lowlink===l.index){var u=[],c;do c=r.pop(),n[c].onStack=!1,u.push(c);while(o!==c);a.push(u)}}return t.nodes().forEach(function(o){ZI.has(n,o)||s(o)}),a}});var QI=O((Ege,$I)=>{var jie=Wr(),Yie=cb();$I.exports=Zie;function Zie(t){return jie.filter(Yie(t),function(e){return e.length>1||e.length===1&&t.hasEdge(e[0],e[0])})}});var eB=O((Sge,JI)=>{var Xie=Wr();JI.exports=Qie;var $ie=Xie.constant(1);function Qie(t,e,r){return Jie(t,e||$ie,r||function(n){return t.outEdges(n)})}function Jie(t,e,r){var n={},a=t.nodes();return a.forEach(function(s){n[s]={},n[s][s]={distance:0},a.forEach(function(o){s!==o&&(n[s][o]={distance:Number.POSITIVE_INFINITY})}),r(s).forEach(function(o){var l=o.v===s?o.w:o.v,u=e(o);n[s][l]={distance:u,predecessor:s}})}),a.forEach(function(s){var o=n[s];a.forEach(function(l){var u=n[l];a.forEach(function(c){var f=u[s],h=o[c],d=u[c],p=f.distance+h.distance;p<d.distance&&(d.distance=p,d.predecessor=h.predecessor)})})}),n}});var fb=O((Cge,rB)=>{var Cu=Wr();rB.exports=tB;tB.CycleException=Qh;function tB(t){var e={},r={},n=[];function a(s){if(Cu.has(r,s))throw new Qh;Cu.has(e,s)||(r[s]=!0,e[s]=!0,Cu.each(t.predecessors(s),a),delete r[s],n.push(s))}if(Cu.each(t.sinks(),a),Cu.size(e)!==t.nodeCount())throw new Qh;return n}function Qh(){}Qh.prototype=new Error});var aB=O((Tge,iB)=>{var nB=fb();iB.exports=eae;function eae(t){try{nB(t)}catch(e){if(e instanceof nB.CycleException)return!1;throw e}return!0}});var hb=O((kge,oB)=>{var Jh=Wr();oB.exports=tae;function tae(t,e,r){Jh.isArray(e)||(e=[e]);var n=(t.isDirected()?t.successors:t.neighbors).bind(t),a=[],s={};return Jh.each(e,function(o){if(!t.hasNode(o))throw new Error("Graph does not have node: "+o);sB(t,o,r==="post",s,n,a)}),a}function sB(t,e,r,n,a,s){Jh.has(n,e)||(n[e]=!0,r||s.push(e),Jh.each(a(e),function(o){sB(t,o,r,n,a,s)}),r&&s.push(e))}});var uB=O((Age,lB)=>{var rae=hb();lB.exports=nae;function nae(t,e){return rae(t,e,"post")}});var fB=O((Mge,cB)=>{var iae=hb();cB.exports=aae;function aae(t,e){return iae(t,e,"pre")}});var pB=O((Pge,dB)=>{var hB=Wr(),sae=Xh(),oae=lb();dB.exports=lae;function lae(t,e){var r=new sae,n={},a=new oae,s;function o(u){var c=u.v===s?u.w:u.v,f=a.priority(c);if(f!==void 0){var h=e(u);h<f&&(n[c]=s,a.decrease(c,h))}}if(t.nodeCount()===0)return r;hB.each(t.nodes(),function(u){a.add(u,Number.POSITIVE_INFINITY),r.setNode(u)}),a.decrease(t.nodes()[0],0);for(var l=!1;a.size()>0;){if(s=a.removeMin(),hB.has(n,s))r.setEdge(s,n[s]);else{if(l)throw new Error("Input graph is not connected: "+t);l=!0}t.nodeEdges(s).forEach(o)}return r}});var vB=O((Rge,gB)=>{gB.exports={components:UI(),dijkstra:ub(),dijkstraAll:YI(),findCycles:QI(),floydWarshall:eB(),isAcyclic:aB(),postorder:uB(),preorder:fB(),prim:pB(),tarjan:cb(),topsort:fb()}});var bB=O((Dge,yB)=>{var mB=qI();yB.exports={Graph:mB.Graph,json:zI(),alg:vB(),version:mB.version}});var nn=O((Oge,wB)=>{var ed;if(typeof Wn=="function")try{ed=bB()}catch{}ed||(ed=window.graphlib);wB.exports=ed});var xB=O((Bge,_B)=>{var uae=P0(),cae=1,fae=4;function hae(t){return uae(t,cae|fae)}_B.exports=hae});var Tu=O((Lge,EB)=>{var dae=Ha(),pae=qn(),gae=hu(),vae=Ur();function mae(t,e,r){if(!vae(r))return!1;var n=typeof e;return(n=="number"?pae(r)&&gae(e,r.length):n=="string"&&e in r)?dae(r[e],t):!1}EB.exports=mae});var TB=O((Nge,CB)=>{var yae=Eu(),bae=Ha(),wae=Tu(),_ae=ji(),SB=Object.prototype,xae=SB.hasOwnProperty,Eae=yae(function(t,e){t=Object(t);var r=-1,n=e.length,a=n>2?e[2]:void 0;for(a&&wae(e[0],e[1],a)&&(n=1);++r<n;)for(var s=e[r],o=_ae(s),l=-1,u=o.length;++l<u;){var c=o[l],f=t[c];(f===void 0||bae(f,SB[c])&&!xae.call(t,c))&&(t[c]=s[c])}return t});CB.exports=Eae});var AB=O((Fge,kB)=>{var Sae=Vn(),Cae=qn(),Tae=si();function kae(t){return function(e,r,n){var a=Object(e);if(!Cae(e)){var s=Sae(r,3);e=Tae(e),r=function(l){return s(a[l],l,a)}}var o=t(e,r,n);return o>-1?a[s?e[o]:o]:void 0}}kB.exports=kae});var PB=O((qge,MB)=>{var Aae=/\s/;function Mae(t){for(var e=t.length;e--&&Aae.test(t.charAt(e)););return e}MB.exports=Mae});var DB=O((Vge,RB)=>{var Pae=PB(),Rae=/^\s+/;function Dae(t){return t&&t.slice(0,Pae(t)+1).replace(Rae,"")}RB.exports=Dae});var LB=O((zge,BB)=>{var Oae=DB(),OB=Ur(),Iae=ja(),IB=NaN,Bae=/^[-+]0x[0-9a-f]+$/i,Lae=/^0b[01]+$/i,Nae=/^0o[0-7]+$/i,Fae=parseInt;function qae(t){if(typeof t=="number")return t;if(Iae(t))return IB;if(OB(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=OB(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Oae(t);var r=Lae.test(t);return r||Nae.test(t)?Fae(t.slice(2),r?2:8):Bae.test(t)?IB:+t}BB.exports=qae});var db=O((Hge,FB)=>{var Vae=LB(),NB=1/0,zae=17976931348623157e292;function Hae(t){if(!t)return t===0?t:0;if(t=Vae(t),t===NB||t===-NB){var e=t<0?-1:1;return e*zae}return t===t?t:0}FB.exports=Hae});var VB=O((Uge,qB)=>{var Uae=db();function Wae(t){var e=Uae(t),r=e%1;return e===e?r?e-r:e:0}qB.exports=Wae});var HB=O((Wge,zB)=>{var Gae=nb(),Kae=Vn(),jae=VB(),Yae=Math.max;function Zae(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var a=r==null?0:jae(r);return a<0&&(a=Yae(n+a,0)),Gae(t,Kae(e,3),a)}zB.exports=Zae});var WB=O((Gge,UB)=>{var Xae=AB(),$ae=HB(),Qae=Xae($ae);UB.exports=Qae});var pb=O((Kge,GB)=>{var Jae=Yh();function ese(t){var e=t==null?0:t.length;return e?Jae(t,1):[]}GB.exports=ese});var jB=O((jge,KB)=>{var tse=Hh(),rse=R0(),nse=ji();function ise(t,e){return t==null?t:tse(t,rse(e),nse)}KB.exports=ise});var ZB=O((Yge,YB)=>{function ase(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}YB.exports=ase});var $B=O((Zge,XB)=>{var sse=uu(),ose=Uh(),lse=Vn();function use(t,e){var r={};return e=lse(e,3),ose(t,function(n,a,s){sse(r,a,e(n,a,s))}),r}XB.exports=use});var td=O((Xge,QB)=>{var cse=ja();function fse(t,e,r){for(var n=-1,a=t.length;++n<a;){var s=t[n],o=e(s);if(o!=null&&(l===void 0?o===o&&!cse(o):r(o,l)))var l=o,u=s}return u}QB.exports=fse});var eL=O(($ge,JB)=>{function hse(t,e){return t>e}JB.exports=hse});var rL=O((Qge,tL)=>{var dse=td(),pse=eL(),gse=Yi();function vse(t){return t&&t.length?dse(t,gse,pse):void 0}tL.exports=vse});var gb=O((Jge,nL)=>{var mse=uu(),yse=Ha();function bse(t,e,r){(r!==void 0&&!yse(t[e],r)||r===void 0&&!(e in t))&&mse(t,e,r)}nL.exports=bse});var sL=O((eve,aL)=>{var wse=Gi(),_se=yu(),xse=yn(),Ese="[object Object]",Sse=Function.prototype,Cse=Object.prototype,iL=Sse.toString,Tse=Cse.hasOwnProperty,kse=iL.call(Object);function Ase(t){if(!xse(t)||wse(t)!=Ese)return!1;var e=_se(t);if(e===null)return!0;var r=Tse.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&iL.call(r)==kse}aL.exports=Ase});var vb=O((tve,oL)=>{function Mse(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}oL.exports=Mse});var uL=O((rve,lL)=>{var Pse=io(),Rse=ji();function Dse(t){return Pse(t,Rse(t))}lL.exports=Dse});var gL=O((nve,pL)=>{var cL=gb(),Ose=d0(),Ise=k0(),Bse=p0(),Lse=M0(),fL=ao(),hL=Rt(),Nse=ab(),Fse=Wa(),qse=eo(),Vse=Ur(),zse=sL(),Hse=lo(),dL=vb(),Use=uL();function Wse(t,e,r,n,a,s,o){var l=dL(t,r),u=dL(e,r),c=o.get(u);if(c){cL(t,r,c);return}var f=s?s(l,u,r+"",t,e,o):void 0,h=f===void 0;if(h){var d=hL(u),p=!d&&Fse(u),g=!d&&!p&&Hse(u);f=u,d||p||g?hL(l)?f=l:Nse(l)?f=Bse(l):p?(h=!1,f=Ose(u,!0)):g?(h=!1,f=Ise(u,!0)):f=[]:zse(u)||fL(u)?(f=l,fL(l)?f=Use(l):(!Vse(l)||qse(l))&&(f=Lse(u))):h=!1}h&&(o.set(u,f),a(f,u,n,s,o),o.delete(u)),cL(t,r,f)}pL.exports=Wse});var yL=O((ive,mL)=>{var Gse=lu(),Kse=gb(),jse=Hh(),Yse=gL(),Zse=Ur(),Xse=ji(),$se=vb();function vL(t,e,r,n,a){t!==e&&jse(e,function(s,o){if(a||(a=new Gse),Zse(s))Yse(t,e,o,r,vL,n,a);else{var l=n?n($se(t,o),s,o+"",t,e,a):void 0;l===void 0&&(l=s),Kse(t,o,l)}},Xse)}mL.exports=vL});var wL=O((ave,bL)=>{var Qse=Eu(),Jse=Tu();function eoe(t){return Qse(function(e,r){var n=-1,a=r.length,s=a>1?r[a-1]:void 0,o=a>2?r[2]:void 0;for(s=t.length>3&&typeof s=="function"?(a--,s):void 0,o&&Jse(r[0],r[1],o)&&(s=a<3?void 0:s,a=1),e=Object(e);++n<a;){var l=r[n];l&&t(e,l,n,s)}return e})}bL.exports=eoe});var xL=O((sve,_L)=>{var toe=yL(),roe=wL(),noe=roe(function(t,e,r){toe(t,e,r)});_L.exports=noe});var mb=O((ove,EL)=>{function ioe(t,e){return t<e}EL.exports=ioe});var CL=O((lve,SL)=>{var aoe=td(),soe=mb(),ooe=Yi();function loe(t){return t&&t.length?aoe(t,ooe,soe):void 0}SL.exports=loe});var kL=O((uve,TL)=>{var uoe=td(),coe=Vn(),foe=mb();function hoe(t,e){return t&&t.length?uoe(t,coe(e,2),foe):void 0}TL.exports=hoe});var ML=O((cve,AL)=>{var doe=tn(),poe=function(){return doe.Date.now()};AL.exports=poe});var DL=O((fve,RL)=>{var goe=cu(),voe=_u(),moe=hu(),PL=Ur(),yoe=fo();function boe(t,e,r,n){if(!PL(t))return t;e=voe(e,t);for(var a=-1,s=e.length,o=s-1,l=t;l!=null&&++a<s;){var u=yoe(e[a]),c=r;if(u==="__proto__"||u==="constructor"||u==="prototype")return t;if(a!=o){var f=l[u];c=n?n(f,u,l):void 0,c===void 0&&(c=PL(f)?f:moe(e[a+1])?[]:{})}goe(l,u,c),l=l[u]}return t}RL.exports=boe});var IL=O((hve,OL)=>{var woe=xu(),_oe=DL(),xoe=_u();function Eoe(t,e,r){for(var n=-1,a=e.length,s={};++n<a;){var o=e[n],l=woe(t,o);r(l,o)&&_oe(s,xoe(o,t),l)}return s}OL.exports=Eoe});var LL=O((dve,BL)=>{var Soe=IL(),Coe=G0();function Toe(t,e){return Soe(t,e,function(r,n){return Coe(t,n)})}BL.exports=Toe});var FL=O((pve,NL)=>{var koe=pb(),Aoe=tb(),Moe=rb();function Poe(t){return Moe(Aoe(t,void 0,koe),t+"")}NL.exports=Poe});var VL=O((gve,qL)=>{var Roe=LL(),Doe=FL(),Ooe=Doe(function(t,e){return t==null?{}:Roe(t,e)});qL.exports=Ooe});var HL=O((vve,zL)=>{var Ioe=Math.ceil,Boe=Math.max;function Loe(t,e,r,n){for(var a=-1,s=Boe(Ioe((e-t)/(r||1)),0),o=Array(s);s--;)o[n?s:++a]=t,t+=r;return o}zL.exports=Loe});var WL=O((mve,UL)=>{var Noe=HL(),Foe=Tu(),yb=db();function qoe(t){return function(e,r,n){return n&&typeof n!="number"&&Foe(e,r,n)&&(r=n=void 0),e=yb(e),r===void 0?(r=e,e=0):r=yb(r),n=n===void 0?e<r?1:-1:yb(n),Noe(e,r,n,t)}}UL.exports=qoe});var KL=O((yve,GL)=>{var Voe=WL(),zoe=Voe();GL.exports=zoe});var YL=O((bve,jL)=>{function Hoe(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}jL.exports=Hoe});var $L=O((wve,XL)=>{var ZL=ja();function Uoe(t,e){if(t!==e){var r=t!==void 0,n=t===null,a=t===t,s=ZL(t),o=e!==void 0,l=e===null,u=e===e,c=ZL(e);if(!l&&!c&&!s&&t>e||s&&o&&u&&!l&&!c||n&&o&&u||!r&&u||!a)return 1;if(!n&&!s&&!c&&t<e||c&&r&&a&&!n&&!s||l&&r&&a||!o&&a||!u)return-1}return 0}XL.exports=Uoe});var JL=O((_ve,QL)=>{var Woe=$L();function Goe(t,e,r){for(var n=-1,a=t.criteria,s=e.criteria,o=a.length,l=r.length;++n<o;){var u=Woe(a[n],s[n]);if(u){if(n>=l)return u;var c=r[n];return u*(c=="desc"?-1:1)}}return t.index-e.index}QL.exports=Goe});var tN=O((xve,eN)=>{var bb=wu(),Koe=xu(),joe=Vn(),Yoe=X0(),Zoe=YL(),Xoe=du(),$oe=JL(),Qoe=Yi(),Joe=Rt();function ele(t,e,r){e.length?e=bb(e,function(s){return Joe(s)?function(o){return Koe(o,s.length===1?s[0]:s)}:s}):e=[Qoe];var n=-1;e=bb(e,Xoe(joe));var a=Yoe(t,function(s,o,l){var u=bb(e,function(c){return c(s)});return{criteria:u,index:++n,value:s}});return Zoe(a,function(s,o){return $oe(s,o,r)})}eN.exports=ele});var iN=O((Eve,nN)=>{var tle=Yh(),rle=tN(),nle=Eu(),rN=Tu(),ile=nle(function(t,e){if(t==null)return[];var r=e.length;return r>1&&rN(t,e[0],e[1])?e=[]:r>2&&rN(e[0],e[1],e[2])&&(e=[e[0]]),rle(t,tle(e,1),[])});nN.exports=ile});var sN=O((Sve,aN)=>{var ale=U0(),sle=0;function ole(t){var e=++sle;return ale(t)+e}aN.exports=ole});var lN=O((Cve,oN)=>{function lle(t,e,r){for(var n=-1,a=t.length,s=e.length,o={};++n<a;){var l=n<s?e[n]:void 0;r(o,t[n],l)}return o}oN.exports=lle});var cN=O((Tve,uN)=>{var ule=cu(),cle=lN();function fle(t,e){return cle(t||[],e||[],ule)}uN.exports=fle});var Et=O((kve,fN)=>{var rd;if(typeof Wn=="function")try{rd={cloneDeep:xB(),constant:zh(),defaults:TB(),each:O0(),filter:j0(),find:WB(),flatten:pb(),forEach:D0(),forIn:jB(),has:Y0(),isUndefined:Z0(),last:ZB(),map:$0(),mapValues:$B(),max:rL(),merge:xL(),min:CL(),minBy:kL(),now:ML(),pick:VL(),range:KL(),reduce:Q0(),sortBy:iN(),uniqueId:sN(),values:sb(),zipObject:cN()}}catch{}rd||(rd=window._);fN.exports=rd});var pN=O((Mve,dN)=>{dN.exports=nd;function nd(){var t={};t._next=t._prev=t,this._sentinel=t}nd.prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return hN(e),e};nd.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&hN(t),t._next=e._next,e._next._prev=t,e._next=t,t._prev=e};nd.prototype.toString=function(){for(var t=[],e=this._sentinel,r=e._prev;r!==e;)t.push(JSON.stringify(r,hle)),r=r._prev;return"["+t.join(", ")+"]"};function hN(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function hle(t,e){if(t!=="_next"&&t!=="_prev")return e}});var vN=O((Pve,gN)=>{var oi=Et(),dle=nn().Graph,ple=pN();gN.exports=vle;var gle=oi.constant(1);function vle(t,e){if(t.nodeCount()<=1)return[];var r=yle(t,e||gle),n=mle(r.graph,r.buckets,r.zeroIdx);return oi.flatten(oi.map(n,function(a){return t.outEdges(a.v,a.w)}),!0)}function mle(t,e,r){for(var n=[],a=e[e.length-1],s=e[0],o;t.nodeCount();){for(;o=s.dequeue();)wb(t,e,r,o);for(;o=a.dequeue();)wb(t,e,r,o);if(t.nodeCount()){for(var l=e.length-2;l>0;--l)if(o=e[l].dequeue(),o){n=n.concat(wb(t,e,r,o,!0));break}}}return n}function wb(t,e,r,n,a){var s=a?[]:void 0;return oi.forEach(t.inEdges(n.v),function(o){var l=t.edge(o),u=t.node(o.v);a&&s.push({v:o.v,w:o.w}),u.out-=l,_b(e,r,u)}),oi.forEach(t.outEdges(n.v),function(o){var l=t.edge(o),u=o.w,c=t.node(u);c.in-=l,_b(e,r,c)}),t.removeNode(n.v),s}function yle(t,e){var r=new dle,n=0,a=0;oi.forEach(t.nodes(),function(l){r.setNode(l,{v:l,in:0,out:0})}),oi.forEach(t.edges(),function(l){var u=r.edge(l.v,l.w)||0,c=e(l),f=u+c;r.setEdge(l.v,l.w,f),a=Math.max(a,r.node(l.v).out+=c),n=Math.max(n,r.node(l.w).in+=c)});var s=oi.range(a+n+3).map(function(){return new ple}),o=n+1;return oi.forEach(r.nodes(),function(l){_b(s,o,r.node(l))}),{graph:r,buckets:s,zeroIdx:o}}function _b(t,e,r){r.out?r.in?t[r.out-r.in+e].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)}});var yN=O((Rve,mN)=>{"use strict";var Za=Et(),ble=vN();mN.exports={run:wle,undo:xle};function wle(t){var e=t.graph().acyclicer==="greedy"?ble(t,r(t)):_le(t);Za.forEach(e,function(n){var a=t.edge(n);t.removeEdge(n),a.forwardName=n.name,a.reversed=!0,t.setEdge(n.w,n.v,a,Za.uniqueId("rev"))});function r(n){return function(a){return n.edge(a).weight}}}function _le(t){var e=[],r={},n={};function a(s){Za.has(n,s)||(n[s]=!0,r[s]=!0,Za.forEach(t.outEdges(s),function(o){Za.has(r,o.w)?e.push(o):a(o.w)}),delete r[s])}return Za.forEach(t.nodes(),a),e}function xle(t){Za.forEach(t.edges(),function(e){var r=t.edge(e);if(r.reversed){t.removeEdge(e);var n=r.forwardName;delete r.reversed,delete r.forwardName,t.setEdge(e.w,e.v,r,n)}})}});var _r=O((Dve,xN)=>{"use strict";var it=Et(),bN=nn().Graph;xN.exports={addDummyNode:wN,simplify:Ele,asNonCompoundGraph:Sle,successorWeights:Cle,predecessorWeights:Tle,intersectRect:kle,buildLayerMatrix:Ale,normalizeRanks:Mle,removeEmptyRanks:Ple,addBorderNode:Rle,maxRank:_N,partition:Dle,time:Ole,notime:Ile};function wN(t,e,r,n){var a;do a=it.uniqueId(n);while(t.hasNode(a));return r.dummy=e,t.setNode(a,r),a}function Ele(t){var e=new bN().setGraph(t.graph());return it.forEach(t.nodes(),function(r){e.setNode(r,t.node(r))}),it.forEach(t.edges(),function(r){var n=e.edge(r.v,r.w)||{weight:0,minlen:1},a=t.edge(r);e.setEdge(r.v,r.w,{weight:n.weight+a.weight,minlen:Math.max(n.minlen,a.minlen)})}),e}function Sle(t){var e=new bN({multigraph:t.isMultigraph()}).setGraph(t.graph());return it.forEach(t.nodes(),function(r){t.children(r).length||e.setNode(r,t.node(r))}),it.forEach(t.edges(),function(r){e.setEdge(r,t.edge(r))}),e}function Cle(t){var e=it.map(t.nodes(),function(r){var n={};return it.forEach(t.outEdges(r),function(a){n[a.w]=(n[a.w]||0)+t.edge(a).weight}),n});return it.zipObject(t.nodes(),e)}function Tle(t){var e=it.map(t.nodes(),function(r){var n={};return it.forEach(t.inEdges(r),function(a){n[a.v]=(n[a.v]||0)+t.edge(a).weight}),n});return it.zipObject(t.nodes(),e)}function kle(t,e){var r=t.x,n=t.y,a=e.x-r,s=e.y-n,o=t.width/2,l=t.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");var u,c;return Math.abs(s)*o>Math.abs(a)*l?(s<0&&(l=-l),u=l*a/s,c=l):(a<0&&(o=-o),u=o,c=o*s/a),{x:r+u,y:n+c}}function Ale(t){var e=it.map(it.range(_N(t)+1),function(){return[]});return it.forEach(t.nodes(),function(r){var n=t.node(r),a=n.rank;it.isUndefined(a)||(e[a][n.order]=r)}),e}function Mle(t){var e=it.min(it.map(t.nodes(),function(r){return t.node(r).rank}));it.forEach(t.nodes(),function(r){var n=t.node(r);it.has(n,"rank")&&(n.rank-=e)})}function Ple(t){var e=it.min(it.map(t.nodes(),function(s){return t.node(s).rank})),r=[];it.forEach(t.nodes(),function(s){var o=t.node(s).rank-e;r[o]||(r[o]=[]),r[o].push(s)});var n=0,a=t.graph().nodeRankFactor;it.forEach(r,function(s,o){it.isUndefined(s)&&o%a!==0?--n:n&&it.forEach(s,function(l){t.node(l).rank+=n})})}function Rle(t,e,r,n){var a={width:0,height:0};return arguments.length>=4&&(a.rank=r,a.order=n),wN(t,"border",a,e)}function _N(t){return it.max(it.map(t.nodes(),function(e){var r=t.node(e).rank;if(!it.isUndefined(r))return r}))}function Dle(t,e){var r={lhs:[],rhs:[]};return it.forEach(t,function(n){e(n)?r.lhs.push(n):r.rhs.push(n)}),r}function Ole(t,e){var r=it.now();try{return e()}finally{console.log(t+" time: "+(it.now()-r)+"ms")}}function Ile(t,e){return e()}});var CN=O((Ove,SN)=>{"use strict";var EN=Et(),Ble=_r();SN.exports={run:Lle,undo:Fle};function Lle(t){t.graph().dummyChains=[],EN.forEach(t.edges(),function(e){Nle(t,e)})}function Nle(t,e){var r=e.v,n=t.node(r).rank,a=e.w,s=t.node(a).rank,o=e.name,l=t.edge(e),u=l.labelRank;if(s!==n+1){t.removeEdge(e);var c,f,h;for(h=0,++n;n<s;++h,++n)l.points=[],f={width:0,height:0,edgeLabel:l,edgeObj:e,rank:n},c=Ble.addDummyNode(t,"edge",f,"_d"),n===u&&(f.width=l.width,f.height=l.height,f.dummy="edge-label",f.labelpos=l.labelpos),t.setEdge(r,c,{weight:l.weight},o),h===0&&t.graph().dummyChains.push(c),r=c;t.setEdge(r,a,{weight:l.weight},o)}}function Fle(t){EN.forEach(t.graph().dummyChains,function(e){var r=t.node(e),n=r.edgeLabel,a;for(t.setEdge(r.edgeObj,n);r.dummy;)a=t.successors(e)[0],t.removeNode(e),n.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),e=a,r=t.node(e)})}});var ku=O((Ive,TN)=>{"use strict";var id=Et();TN.exports={longestPath:qle,slack:Vle};function qle(t){var e={};function r(n){var a=t.node(n);if(id.has(e,n))return a.rank;e[n]=!0;var s=id.min(id.map(t.outEdges(n),function(o){return r(o.w)-t.edge(o).minlen}));return(s===Number.POSITIVE_INFINITY||s===void 0||s===null)&&(s=0),a.rank=s}id.forEach(t.sources(),r)}function Vle(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}});var xb=O((Bve,kN)=>{"use strict";var ad=Et(),zle=nn().Graph,sd=ku().slack;kN.exports=Hle;function Hle(t){var e=new zle({directed:!1}),r=t.nodes()[0],n=t.nodeCount();e.setNode(r,{});for(var a,s;Ule(e,t)<n;)a=Wle(e,t),s=e.hasNode(a.v)?sd(t,a):-sd(t,a),Gle(e,t,s);return e}function Ule(t,e){function r(n){ad.forEach(e.nodeEdges(n),function(a){var s=a.v,o=n===s?a.w:s;!t.hasNode(o)&&!sd(e,a)&&(t.setNode(o,{}),t.setEdge(n,o,{}),r(o))})}return ad.forEach(t.nodes(),r),t.nodeCount()}function Wle(t,e){return ad.minBy(e.edges(),function(r){if(t.hasNode(r.v)!==t.hasNode(r.w))return sd(e,r)})}function Gle(t,e,r){ad.forEach(t.nodes(),function(n){e.node(n).rank+=r})}});var BN=O((Lve,IN)=>{"use strict";var li=Et(),Kle=xb(),jle=ku().slack,Yle=ku().longestPath,Zle=nn().alg.preorder,Xle=nn().alg.postorder,$le=_r().simplify;IN.exports=Xa;Xa.initLowLimValues=Sb;Xa.initCutValues=Eb;Xa.calcCutValue=MN;Xa.leaveEdge=RN;Xa.enterEdge=DN;Xa.exchangeEdges=ON;function Xa(t){t=$le(t),Yle(t);var e=Kle(t);Sb(e),Eb(e,t);for(var r,n;r=RN(e);)n=DN(e,t,r),ON(e,t,r,n)}function Eb(t,e){var r=Xle(t,t.nodes());r=r.slice(0,r.length-1),li.forEach(r,function(n){Qle(t,e,n)})}function Qle(t,e,r){var n=t.node(r),a=n.parent;t.edge(r,a).cutvalue=MN(t,e,r)}function MN(t,e,r){var n=t.node(r),a=n.parent,s=!0,o=e.edge(r,a),l=0;return o||(s=!1,o=e.edge(a,r)),l=o.weight,li.forEach(e.nodeEdges(r),function(u){var c=u.v===r,f=c?u.w:u.v;if(f!==a){var h=c===s,d=e.edge(u).weight;if(l+=h?d:-d,eue(t,r,f)){var p=t.edge(r,f).cutvalue;l+=h?-p:p}}}),l}function Sb(t,e){arguments.length<2&&(e=t.nodes()[0]),PN(t,{},1,e)}function PN(t,e,r,n,a){var s=r,o=t.node(n);return e[n]=!0,li.forEach(t.neighbors(n),function(l){li.has(e,l)||(r=PN(t,e,r,l,n))}),o.low=s,o.lim=r++,a?o.parent=a:delete o.parent,r}function RN(t){return li.find(t.edges(),function(e){return t.edge(e).cutvalue<0})}function DN(t,e,r){var n=r.v,a=r.w;e.hasEdge(n,a)||(n=r.w,a=r.v);var s=t.node(n),o=t.node(a),l=s,u=!1;s.lim>o.lim&&(l=o,u=!0);var c=li.filter(e.edges(),function(f){return u===AN(t,t.node(f.v),l)&&u!==AN(t,t.node(f.w),l)});return li.minBy(c,function(f){return jle(e,f)})}function ON(t,e,r,n){var a=r.v,s=r.w;t.removeEdge(a,s),t.setEdge(n.v,n.w,{}),Sb(t),Eb(t,e),Jle(t,e)}function Jle(t,e){var r=li.find(t.nodes(),function(a){return!e.node(a).parent}),n=Zle(t,r);n=n.slice(1),li.forEach(n,function(a){var s=t.node(a).parent,o=e.edge(a,s),l=!1;o||(o=e.edge(s,a),l=!0),e.node(a).rank=e.node(s).rank+(l?o.minlen:-o.minlen)})}function eue(t,e,r){return t.hasEdge(e,r)}function AN(t,e,r){return r.low<=e.lim&&e.lim<=r.lim}});var qN=O((Nve,FN)=>{"use strict";var tue=ku(),NN=tue.longestPath,rue=xb(),nue=BN();FN.exports=iue;function iue(t){switch(t.graph().ranker){case"network-simplex":LN(t);break;case"tight-tree":sue(t);break;case"longest-path":aue(t);break;default:LN(t)}}var aue=NN;function sue(t){NN(t),rue(t)}function LN(t){nue(t)}});var zN=O((Fve,VN)=>{var Cb=Et();VN.exports=oue;function oue(t){var e=uue(t);Cb.forEach(t.graph().dummyChains,function(r){for(var n=t.node(r),a=n.edgeObj,s=lue(t,e,a.v,a.w),o=s.path,l=s.lca,u=0,c=o[u],f=!0;r!==a.w;){if(n=t.node(r),f){for(;(c=o[u])!==l&&t.node(c).maxRank<n.rank;)u++;c===l&&(f=!1)}if(!f){for(;u<o.length-1&&t.node(c=o[u+1]).minRank<=n.rank;)u++;c=o[u]}t.setParent(r,c),r=t.successors(r)[0]}})}function lue(t,e,r,n){var a=[],s=[],o=Math.min(e[r].low,e[n].low),l=Math.max(e[r].lim,e[n].lim),u,c;u=r;do u=t.parent(u),a.push(u);while(u&&(e[u].low>o||l>e[u].lim));for(c=u,u=n;(u=t.parent(u))!==c;)s.push(u);return{path:a.concat(s.reverse()),lca:c}}function uue(t){var e={},r=0;function n(a){var s=r;Cb.forEach(t.children(a),n),e[a]={low:s,lim:r++}}return Cb.forEach(t.children(),n),e}});var WN=O((qve,UN)=>{var ui=Et(),Tb=_r();UN.exports={run:cue,cleanup:due};function cue(t){var e=Tb.addDummyNode(t,"root",{},"_root"),r=fue(t),n=ui.max(ui.values(r))-1,a=2*n+1;t.graph().nestingRoot=e,ui.forEach(t.edges(),function(o){t.edge(o).minlen*=a});var s=hue(t)+1;ui.forEach(t.children(),function(o){HN(t,e,a,s,n,r,o)}),t.graph().nodeRankFactor=a}function HN(t,e,r,n,a,s,o){var l=t.children(o);if(!l.length){o!==e&&t.setEdge(e,o,{weight:0,minlen:r});return}var u=Tb.addBorderNode(t,"_bt"),c=Tb.addBorderNode(t,"_bb"),f=t.node(o);t.setParent(u,o),f.borderTop=u,t.setParent(c,o),f.borderBottom=c,ui.forEach(l,function(h){HN(t,e,r,n,a,s,h);var d=t.node(h),p=d.borderTop?d.borderTop:h,g=d.borderBottom?d.borderBottom:h,m=d.borderTop?n:2*n,v=p!==g?1:a-s[o]+1;t.setEdge(u,p,{weight:m,minlen:v,nestingEdge:!0}),t.setEdge(g,c,{weight:m,minlen:v,nestingEdge:!0})}),t.parent(o)||t.setEdge(e,u,{weight:0,minlen:a+s[o]})}function fue(t){var e={};function r(n,a){var s=t.children(n);s&&s.length&&ui.forEach(s,function(o){r(o,a+1)}),e[n]=a}return ui.forEach(t.children(),function(n){r(n,1)}),e}function hue(t){return ui.reduce(t.edges(),function(e,r){return e+t.edge(r).weight},0)}function due(t){var e=t.graph();t.removeNode(e.nestingRoot),delete e.nestingRoot,ui.forEach(t.edges(),function(r){var n=t.edge(r);n.nestingEdge&&t.removeEdge(r)})}});var jN=O((Vve,KN)=>{var kb=Et(),pue=_r();KN.exports=gue;function gue(t){function e(r){var n=t.children(r),a=t.node(r);if(n.length&&kb.forEach(n,e),kb.has(a,"minRank")){a.borderLeft=[],a.borderRight=[];for(var s=a.minRank,o=a.maxRank+1;s<o;++s)GN(t,"borderLeft","_bl",r,a,s),GN(t,"borderRight","_br",r,a,s)}}kb.forEach(t.children(),e)}function GN(t,e,r,n,a,s){var o={width:0,height:0,rank:s,borderType:e},l=a[e][s-1],u=pue.addDummyNode(t,"border",o,r);a[e][s]=u,t.setParent(u,n),l&&t.setEdge(l,u,{weight:1})}});var $N=O((zve,XN)=>{"use strict";var Hn=Et();XN.exports={adjust:vue,undo:mue};function vue(t){var e=t.graph().rankdir.toLowerCase();(e==="lr"||e==="rl")&&ZN(t)}function mue(t){var e=t.graph().rankdir.toLowerCase();(e==="bt"||e==="rl")&&yue(t),(e==="lr"||e==="rl")&&(bue(t),ZN(t))}function ZN(t){Hn.forEach(t.nodes(),function(e){YN(t.node(e))}),Hn.forEach(t.edges(),function(e){YN(t.edge(e))})}function YN(t){var e=t.width;t.width=t.height,t.height=e}function yue(t){Hn.forEach(t.nodes(),function(e){Ab(t.node(e))}),Hn.forEach(t.edges(),function(e){var r=t.edge(e);Hn.forEach(r.points,Ab),Hn.has(r,"y")&&Ab(r)})}function Ab(t){t.y=-t.y}function bue(t){Hn.forEach(t.nodes(),function(e){Mb(t.node(e))}),Hn.forEach(t.edges(),function(e){var r=t.edge(e);Hn.forEach(r.points,Mb),Hn.has(r,"x")&&Mb(r)})}function Mb(t){var e=t.x;t.x=t.y,t.y=e}});var JN=O((Hve,QN)=>{"use strict";var ci=Et();QN.exports=wue;function wue(t){var e={},r=ci.filter(t.nodes(),function(l){return!t.children(l).length}),n=ci.max(ci.map(r,function(l){return t.node(l).rank})),a=ci.map(ci.range(n+1),function(){return[]});function s(l){if(!ci.has(e,l)){e[l]=!0;var u=t.node(l);a[u.rank].push(l),ci.forEach(t.successors(l),s)}}var o=ci.sortBy(r,function(l){return t.node(l).rank});return ci.forEach(o,s),a}});var tF=O((Uve,eF)=>{"use strict";var Zi=Et();eF.exports=_ue;function _ue(t,e){for(var r=0,n=1;n<e.length;++n)r+=xue(t,e[n-1],e[n]);return r}function xue(t,e,r){for(var n=Zi.zipObject(r,Zi.map(r,function(c,f){return f})),a=Zi.flatten(Zi.map(e,function(c){return Zi.sortBy(Zi.map(t.outEdges(c),function(f){return{pos:n[f.w],weight:t.edge(f).weight}}),"pos")}),!0),s=1;s<r.length;)s<<=1;var o=2*s-1;s-=1;var l=Zi.map(new Array(o),function(){return 0}),u=0;return Zi.forEach(a.forEach(function(c){var f=c.pos+s;l[f]+=c.weight;for(var h=0;f>0;)f%2&&(h+=l[f+1]),f=f-1>>1,l[f]+=c.weight;u+=c.weight*h})),u}});var iF=O((Wve,nF)=>{var rF=Et();nF.exports=Eue;function Eue(t,e){return rF.map(e,function(r){var n=t.inEdges(r);if(n.length){var a=rF.reduce(n,function(s,o){var l=t.edge(o),u=t.node(o.v);return{sum:s.sum+l.weight*u.order,weight:s.weight+l.weight}},{sum:0,weight:0});return{v:r,barycenter:a.sum/a.weight,weight:a.weight}}else return{v:r}})}});var sF=O((Gve,aF)=>{"use strict";var Gr=Et();aF.exports=Sue;function Sue(t,e){var r={};Gr.forEach(t,function(a,s){var o=r[a.v]={indegree:0,in:[],out:[],vs:[a.v],i:s};Gr.isUndefined(a.barycenter)||(o.barycenter=a.barycenter,o.weight=a.weight)}),Gr.forEach(e.edges(),function(a){var s=r[a.v],o=r[a.w];!Gr.isUndefined(s)&&!Gr.isUndefined(o)&&(o.indegree++,s.out.push(r[a.w]))});var n=Gr.filter(r,function(a){return!a.indegree});return Cue(n)}function Cue(t){var e=[];function r(s){return function(o){o.merged||(Gr.isUndefined(o.barycenter)||Gr.isUndefined(s.barycenter)||o.barycenter>=s.barycenter)&&Tue(s,o)}}function n(s){return function(o){o.in.push(s),--o.indegree===0&&t.push(o)}}for(;t.length;){var a=t.pop();e.push(a),Gr.forEach(a.in.reverse(),r(a)),Gr.forEach(a.out,n(a))}return Gr.map(Gr.filter(e,function(s){return!s.merged}),function(s){return Gr.pick(s,["vs","i","barycenter","weight"])})}function Tue(t,e){var r=0,n=0;t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.vs=e.vs.concat(t.vs),t.barycenter=r/n,t.weight=n,t.i=Math.min(e.i,t.i),e.merged=!0}});var uF=O((Kve,lF)=>{var Au=Et(),kue=_r();lF.exports=Aue;function Aue(t,e){var r=kue.partition(t,function(f){return Au.has(f,"barycenter")}),n=r.lhs,a=Au.sortBy(r.rhs,function(f){return-f.i}),s=[],o=0,l=0,u=0;n.sort(Mue(!!e)),u=oF(s,a,u),Au.forEach(n,function(f){u+=f.vs.length,s.push(f.vs),o+=f.barycenter*f.weight,l+=f.weight,u=oF(s,a,u)});var c={vs:Au.flatten(s,!0)};return l&&(c.barycenter=o/l,c.weight=l),c}function oF(t,e,r){for(var n;e.length&&(n=Au.last(e)).i<=r;)e.pop(),t.push(n.vs),r++;return r}function Mue(t){return function(e,r){return e.barycenter<r.barycenter?-1:e.barycenter>r.barycenter?1:t?r.i-e.i:e.i-r.i}}});var hF=O((jve,fF)=>{var Xi=Et(),Pue=iF(),Rue=sF(),Due=uF();fF.exports=cF;function cF(t,e,r,n){var a=t.children(e),s=t.node(e),o=s?s.borderLeft:void 0,l=s?s.borderRight:void 0,u={};o&&(a=Xi.filter(a,function(g){return g!==o&&g!==l}));var c=Pue(t,a);Xi.forEach(c,function(g){if(t.children(g.v).length){var m=cF(t,g.v,r,n);u[g.v]=m,Xi.has(m,"barycenter")&&Iue(g,m)}});var f=Rue(c,r);Oue(f,u);var h=Due(f,n);if(o&&(h.vs=Xi.flatten([o,h.vs,l],!0),t.predecessors(o).length)){var d=t.node(t.predecessors(o)[0]),p=t.node(t.predecessors(l)[0]);Xi.has(h,"barycenter")||(h.barycenter=0,h.weight=0),h.barycenter=(h.barycenter*h.weight+d.order+p.order)/(h.weight+2),h.weight+=2}return h}function Oue(t,e){Xi.forEach(t,function(r){r.vs=Xi.flatten(r.vs.map(function(n){return e[n]?e[n].vs:n}),!0)})}function Iue(t,e){Xi.isUndefined(t.barycenter)?(t.barycenter=e.barycenter,t.weight=e.weight):(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight)}});var pF=O((Yve,dF)=>{var Mu=Et(),Bue=nn().Graph;dF.exports=Lue;function Lue(t,e,r){var n=Nue(t),a=new Bue({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(s){return t.node(s)});return Mu.forEach(t.nodes(),function(s){var o=t.node(s),l=t.parent(s);(o.rank===e||o.minRank<=e&&e<=o.maxRank)&&(a.setNode(s),a.setParent(s,l||n),Mu.forEach(t[r](s),function(u){var c=u.v===s?u.w:u.v,f=a.edge(c,s),h=Mu.isUndefined(f)?0:f.weight;a.setEdge(c,s,{weight:t.edge(u).weight+h})}),Mu.has(o,"minRank")&&a.setNode(s,{borderLeft:o.borderLeft[e],borderRight:o.borderRight[e]}))}),a}function Nue(t){for(var e;t.hasNode(e=Mu.uniqueId("_root")););return e}});var vF=O((Zve,gF)=>{var Fue=Et();gF.exports=que;function que(t,e,r){var n={},a;Fue.forEach(r,function(s){for(var o=t.parent(s),l,u;o;){if(l=t.parent(o),l?(u=n[l],n[l]=o):(u=a,a=o),u&&u!==o){e.setEdge(u,o);return}o=l}})}});var _F=O((Xve,wF)=>{"use strict";var $i=Et(),Vue=JN(),zue=tF(),Hue=hF(),Uue=pF(),Wue=vF(),Gue=nn().Graph,mF=_r();wF.exports=Kue;function Kue(t){var e=mF.maxRank(t),r=yF(t,$i.range(1,e+1),"inEdges"),n=yF(t,$i.range(e-1,-1,-1),"outEdges"),a=Vue(t);bF(t,a);for(var s=Number.POSITIVE_INFINITY,o,l=0,u=0;u<4;++l,++u){jue(l%2?r:n,l%4>=2),a=mF.buildLayerMatrix(t);var c=zue(t,a);c<s&&(u=0,o=$i.cloneDeep(a),s=c)}bF(t,o)}function yF(t,e,r){return $i.map(e,function(n){return Uue(t,n,r)})}function jue(t,e){var r=new Gue;$i.forEach(t,function(n){var a=n.graph().root,s=Hue(n,a,r,e);$i.forEach(s.vs,function(o,l){n.node(o).order=l}),Wue(n,r,s.vs)})}function bF(t,e){$i.forEach(e,function(r){$i.forEach(r,function(n,a){t.node(n).order=a})})}});var RF=O(($ve,PF)=>{"use strict";var Be=Et(),Yue=nn().Graph,Zue=_r();PF.exports={positionX:Que,findType1Conflicts:xF,findType2Conflicts:EF,addConflict:Pb,hasConflict:SF,verticalAlignment:CF,horizontalCompaction:TF,alignCoordinates:AF,findSmallestWidthAlignment:kF,balance:MF};function xF(t,e){var r={};function n(a,s){var o=0,l=0,u=a.length,c=Be.last(s);return Be.forEach(s,function(f,h){var d=Xue(t,f),p=d?t.node(d).order:u;(d||f===c)&&(Be.forEach(s.slice(l,h+1),function(g){Be.forEach(t.predecessors(g),function(m){var v=t.node(m),y=v.order;(y<o||p<y)&&!(v.dummy&&t.node(g).dummy)&&Pb(r,m,g)})}),l=h+1,o=p)}),s}return Be.reduce(e,n),r}function EF(t,e){var r={};function n(s,o,l,u,c){var f;Be.forEach(Be.range(o,l),function(h){f=s[h],t.node(f).dummy&&Be.forEach(t.predecessors(f),function(d){var p=t.node(d);p.dummy&&(p.order<u||p.order>c)&&Pb(r,d,f)})})}function a(s,o){var l=-1,u,c=0;return Be.forEach(o,function(f,h){if(t.node(f).dummy==="border"){var d=t.predecessors(f);d.length&&(u=t.node(d[0]).order,n(o,c,h,l,u),c=h,l=u)}n(o,c,o.length,u,s.length)}),o}return Be.reduce(e,a),r}function Xue(t,e){if(t.node(e).dummy)return Be.find(t.predecessors(e),function(r){return t.node(r).dummy})}function Pb(t,e,r){if(e>r){var n=e;e=r,r=n}var a=t[e];a||(t[e]=a={}),a[r]=!0}function SF(t,e,r){if(e>r){var n=e;e=r,r=n}return Be.has(t[e],r)}function CF(t,e,r,n){var a={},s={},o={};return Be.forEach(e,function(l){Be.forEach(l,function(u,c){a[u]=u,s[u]=u,o[u]=c})}),Be.forEach(e,function(l){var u=-1;Be.forEach(l,function(c){var f=n(c);if(f.length){f=Be.sortBy(f,function(m){return o[m]});for(var h=(f.length-1)/2,d=Math.floor(h),p=Math.ceil(h);d<=p;++d){var g=f[d];s[c]===c&&u<o[g]&&!SF(r,c,g)&&(s[g]=c,s[c]=a[c]=a[g],u=o[g])}}})}),{root:a,align:s}}function TF(t,e,r,n,a){var s={},o=$ue(t,e,r,a),l=a?"borderLeft":"borderRight";function u(h,d){for(var p=o.nodes(),g=p.pop(),m={};g;)m[g]?h(g):(m[g]=!0,p.push(g),p=p.concat(d(g))),g=p.pop()}function c(h){s[h]=o.inEdges(h).reduce(function(d,p){return Math.max(d,s[p.v]+o.edge(p))},0)}function f(h){var d=o.outEdges(h).reduce(function(g,m){return Math.min(g,s[m.w]-o.edge(m))},Number.POSITIVE_INFINITY),p=t.node(h);d!==Number.POSITIVE_INFINITY&&p.borderType!==l&&(s[h]=Math.max(s[h],d))}return u(c,o.predecessors.bind(o)),u(f,o.successors.bind(o)),Be.forEach(n,function(h){s[h]=s[r[h]]}),s}function $ue(t,e,r,n){var a=new Yue,s=t.graph(),o=Jue(s.nodesep,s.edgesep,n);return Be.forEach(e,function(l){var u;Be.forEach(l,function(c){var f=r[c];if(a.setNode(f),u){var h=r[u],d=a.edge(h,f);a.setEdge(h,f,Math.max(o(t,c,u),d||0))}u=c})}),a}function kF(t,e){return Be.minBy(Be.values(e),function(r){var n=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY;return Be.forIn(r,function(s,o){var l=ece(t,o)/2;n=Math.max(s+l,n),a=Math.min(s-l,a)}),n-a})}function AF(t,e){var r=Be.values(e),n=Be.min(r),a=Be.max(r);Be.forEach(["u","d"],function(s){Be.forEach(["l","r"],function(o){var l=s+o,u=t[l],c;if(u!==e){var f=Be.values(u);c=o==="l"?n-Be.min(f):a-Be.max(f),c&&(t[l]=Be.mapValues(u,function(h){return h+c}))}})})}function MF(t,e){return Be.mapValues(t.ul,function(r,n){if(e)return t[e.toLowerCase()][n];var a=Be.sortBy(Be.map(t,n));return(a[1]+a[2])/2})}function Que(t){var e=Zue.buildLayerMatrix(t),r=Be.merge(xF(t,e),EF(t,e)),n={},a;Be.forEach(["u","d"],function(o){a=o==="u"?e:Be.values(e).reverse(),Be.forEach(["l","r"],function(l){l==="r"&&(a=Be.map(a,function(h){return Be.values(h).reverse()}));var u=(o==="u"?t.predecessors:t.successors).bind(t),c=CF(t,a,r,u),f=TF(t,a,c.root,c.align,l==="r");l==="r"&&(f=Be.mapValues(f,function(h){return-h})),n[o+l]=f})});var s=kF(t,n);return AF(n,s),MF(n,t.graph().align)}function Jue(t,e,r){return function(n,a,s){var o=n.node(a),l=n.node(s),u=0,c;if(u+=o.width/2,Be.has(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":c=-o.width/2;break;case"r":c=o.width/2;break}if(c&&(u+=r?c:-c),c=0,u+=(o.dummy?e:t)/2,u+=(l.dummy?e:t)/2,u+=l.width/2,Be.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":c=l.width/2;break;case"r":c=-l.width/2;break}return c&&(u+=r?c:-c),c=0,u}}function ece(t,e){return t.node(e).width}});var IF=O((Qve,OF)=>{"use strict";var Pu=Et(),DF=_r(),tce=RF().positionX;OF.exports=rce;function rce(t){t=DF.asNonCompoundGraph(t),nce(t),Pu.forEach(tce(t),function(e,r){t.node(r).x=e})}function nce(t){var e=DF.buildLayerMatrix(t),r=t.graph().ranksep,n=0;Pu.forEach(e,function(a){var s=Pu.max(Pu.map(a,function(o){return t.node(o).height}));Pu.forEach(a,function(o){t.node(o).y=n+s/2}),n+=s+r})}});var VF=O((Jve,qF)=>{"use strict";var He=Et(),BF=yN(),LF=CN(),ice=qN(),ace=_r().normalizeRanks,sce=zN(),oce=_r().removeEmptyRanks,NF=WN(),lce=jN(),FF=$N(),uce=_F(),cce=IF(),Qi=_r(),fce=nn().Graph;qF.exports=hce;function hce(t,e){var r=e&&e.debugTiming?Qi.time:Qi.notime;r("layout",function(){var n=r("  buildLayoutGraph",function(){return Ece(t)});r("  runLayout",function(){dce(n,r)}),r("  updateInputGraph",function(){pce(t,n)})})}function dce(t,e){e("    makeSpaceForEdgeLabels",function(){Sce(t)}),e("    removeSelfEdges",function(){Oce(t)}),e("    acyclic",function(){BF.run(t)}),e("    nestingGraph.run",function(){NF.run(t)}),e("    rank",function(){ice(Qi.asNonCompoundGraph(t))}),e("    injectEdgeLabelProxies",function(){Cce(t)}),e("    removeEmptyRanks",function(){oce(t)}),e("    nestingGraph.cleanup",function(){NF.cleanup(t)}),e("    normalizeRanks",function(){ace(t)}),e("    assignRankMinMax",function(){Tce(t)}),e("    removeEdgeLabelProxies",function(){kce(t)}),e("    normalize.run",function(){LF.run(t)}),e("    parentDummyChains",function(){sce(t)}),e("    addBorderSegments",function(){lce(t)}),e("    order",function(){uce(t)}),e("    insertSelfEdges",function(){Ice(t)}),e("    adjustCoordinateSystem",function(){FF.adjust(t)}),e("    position",function(){cce(t)}),e("    positionSelfEdges",function(){Bce(t)}),e("    removeBorderNodes",function(){Dce(t)}),e("    normalize.undo",function(){LF.undo(t)}),e("    fixupEdgeLabelCoords",function(){Pce(t)}),e("    undoCoordinateSystem",function(){FF.undo(t)}),e("    translateGraph",function(){Ace(t)}),e("    assignNodeIntersects",function(){Mce(t)}),e("    reversePoints",function(){Rce(t)}),e("    acyclic.undo",function(){BF.undo(t)})}function pce(t,e){He.forEach(t.nodes(),function(r){var n=t.node(r),a=e.node(r);n&&(n.x=a.x,n.y=a.y,e.children(r).length&&(n.width=a.width,n.height=a.height))}),He.forEach(t.edges(),function(r){var n=t.edge(r),a=e.edge(r);n.points=a.points,He.has(a,"x")&&(n.x=a.x,n.y=a.y)}),t.graph().width=e.graph().width,t.graph().height=e.graph().height}var gce=["nodesep","edgesep","ranksep","marginx","marginy"],vce={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},mce=["acyclicer","ranker","rankdir","align"],yce=["width","height"],bce={width:0,height:0},wce=["minlen","weight","width","height","labeloffset"],_ce={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},xce=["labelpos"];function Ece(t){var e=new fce({multigraph:!0,compound:!0}),r=Db(t.graph());return e.setGraph(He.merge({},vce,Rb(r,gce),He.pick(r,mce))),He.forEach(t.nodes(),function(n){var a=Db(t.node(n));e.setNode(n,He.defaults(Rb(a,yce),bce)),e.setParent(n,t.parent(n))}),He.forEach(t.edges(),function(n){var a=Db(t.edge(n));e.setEdge(n,He.merge({},_ce,Rb(a,wce),He.pick(a,xce)))}),e}function Sce(t){var e=t.graph();e.ranksep/=2,He.forEach(t.edges(),function(r){var n=t.edge(r);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(e.rankdir==="TB"||e.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function Cce(t){He.forEach(t.edges(),function(e){var r=t.edge(e);if(r.width&&r.height){var n=t.node(e.v),a=t.node(e.w),s={rank:(a.rank-n.rank)/2+n.rank,e};Qi.addDummyNode(t,"edge-proxy",s,"_ep")}})}function Tce(t){var e=0;He.forEach(t.nodes(),function(r){var n=t.node(r);n.borderTop&&(n.minRank=t.node(n.borderTop).rank,n.maxRank=t.node(n.borderBottom).rank,e=He.max(e,n.maxRank))}),t.graph().maxRank=e}function kce(t){He.forEach(t.nodes(),function(e){var r=t.node(e);r.dummy==="edge-proxy"&&(t.edge(r.e).labelRank=r.rank,t.removeNode(e))})}function Ace(t){var e=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,a=0,s=t.graph(),o=s.marginx||0,l=s.marginy||0;function u(c){var f=c.x,h=c.y,d=c.width,p=c.height;e=Math.min(e,f-d/2),r=Math.max(r,f+d/2),n=Math.min(n,h-p/2),a=Math.max(a,h+p/2)}He.forEach(t.nodes(),function(c){u(t.node(c))}),He.forEach(t.edges(),function(c){var f=t.edge(c);He.has(f,"x")&&u(f)}),e-=o,n-=l,He.forEach(t.nodes(),function(c){var f=t.node(c);f.x-=e,f.y-=n}),He.forEach(t.edges(),function(c){var f=t.edge(c);He.forEach(f.points,function(h){h.x-=e,h.y-=n}),He.has(f,"x")&&(f.x-=e),He.has(f,"y")&&(f.y-=n)}),s.width=r-e+o,s.height=a-n+l}function Mce(t){He.forEach(t.edges(),function(e){var r=t.edge(e),n=t.node(e.v),a=t.node(e.w),s,o;r.points?(s=r.points[0],o=r.points[r.points.length-1]):(r.points=[],s=a,o=n),r.points.unshift(Qi.intersectRect(n,s)),r.points.push(Qi.intersectRect(a,o))})}function Pce(t){He.forEach(t.edges(),function(e){var r=t.edge(e);if(He.has(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function Rce(t){He.forEach(t.edges(),function(e){var r=t.edge(e);r.reversed&&r.points.reverse()})}function Dce(t){He.forEach(t.nodes(),function(e){if(t.children(e).length){var r=t.node(e),n=t.node(r.borderTop),a=t.node(r.borderBottom),s=t.node(He.last(r.borderLeft)),o=t.node(He.last(r.borderRight));r.width=Math.abs(o.x-s.x),r.height=Math.abs(a.y-n.y),r.x=s.x+r.width/2,r.y=n.y+r.height/2}}),He.forEach(t.nodes(),function(e){t.node(e).dummy==="border"&&t.removeNode(e)})}function Oce(t){He.forEach(t.edges(),function(e){if(e.v===e.w){var r=t.node(e.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e,label:t.edge(e)}),t.removeEdge(e)}})}function Ice(t){var e=Qi.buildLayerMatrix(t);He.forEach(e,function(r){var n=0;He.forEach(r,function(a,s){var o=t.node(a);o.order=s+n,He.forEach(o.selfEdges,function(l){Qi.addDummyNode(t,"selfedge",{width:l.label.width,height:l.label.height,rank:o.rank,order:s+ ++n,e:l.e,label:l.label},"_se")}),delete o.selfEdges})})}function Bce(t){He.forEach(t.nodes(),function(e){var r=t.node(e);if(r.dummy==="selfedge"){var n=t.node(r.e.v),a=n.x+n.width/2,s=n.y,o=r.x-a,l=n.height/2;t.setEdge(r.e,r.label),t.removeNode(e),r.label.points=[{x:a+2*o/3,y:s-l},{x:a+5*o/6,y:s-l},{x:a+o,y:s},{x:a+5*o/6,y:s+l},{x:a+2*o/3,y:s+l}],r.label.x=r.x,r.label.y=r.y}})}function Rb(t,e){return He.mapValues(He.pick(t,e),Number)}function Db(t){var e={};return He.forEach(t,function(r,n){e[n.toLowerCase()]=r}),e}});var HF=O((eme,zF)=>{var od=Et(),Lce=_r(),Nce=nn().Graph;zF.exports={debugOrdering:Fce};function Fce(t){var e=Lce.buildLayerMatrix(t),r=new Nce({compound:!0,multigraph:!0}).setGraph({});return od.forEach(t.nodes(),function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+t.node(n).rank)}),od.forEach(t.edges(),function(n){r.setEdge(n.v,n.w,{},n.name)}),od.forEach(e,function(n,a){var s="layer"+a;r.setNode(s,{rank:"same"}),od.reduce(n,function(o,l){return r.setEdge(o,l,{style:"invis"}),l})}),r}});var WF=O((tme,UF)=>{UF.exports="0.8.5"});var Ob=O((rme,GF)=>{GF.exports={graphlib:nn(),layout:VF(),debug:HF(),util:{time:_r().time,notime:_r().notime},version:WF()}});var KF=O((Ru,Ib)=>{(function(e,r){typeof Ru=="object"&&typeof Ib=="object"?Ib.exports=r(Ob()):typeof define=="function"&&define.amd?define(["dagre"],r):typeof Ru=="object"?Ru.cytoscapeDagre=r(Ob()):e.cytoscapeDagre=r(e.dagre)})(Ru,function(t){return function(e){var r={};function n(a){if(r[a])return r[a].exports;var s=r[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=r,n.d=function(a,s,o){n.o(a,s)||Object.defineProperty(a,s,{enumerable:!0,get:o})},n.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},n.t=function(a,s){if(s&1&&(a=n(a)),s&8||s&4&&typeof a=="object"&&a&&a.__esModule)return a;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:a}),s&2&&typeof a!="string")for(var l in a)n.d(o,l,function(u){return a[u]}.bind(null,l));return o},n.n=function(a){var s=a&&a.__esModule?function(){return a.default}:function(){return a};return n.d(s,"a",s),s},n.o=function(a,s){return Object.prototype.hasOwnProperty.call(a,s)},n.p="",n(n.s=0)}([function(e,r,n){var a=n(1),s=function(l){l&&l("layout","dagre",a)};typeof cytoscape<"u"&&s(cytoscape),e.exports=s},function(e,r,n){function a(f){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?a=function(d){return typeof d}:a=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},a(f)}var s=function(h){return typeof h=="function"},o=n(2),l=n(3),u=n(4);function c(f){this.options=l({},o,f)}c.prototype.run=function(){var f=this.options,h=this,d=f.cy,p=f.eles,g=function(q,H){return s(H)?H.apply(q,[q]):H},m=f.boundingBox||{x1:0,y1:0,w:d.width(),h:d.height()};m.x2===void 0&&(m.x2=m.x1+m.w),m.w===void 0&&(m.w=m.x2-m.x1),m.y2===void 0&&(m.y2=m.y1+m.h),m.h===void 0&&(m.h=m.y2-m.y1);var v=new u.graphlib.Graph({multigraph:!0,compound:!0}),y={},b=function(q,H){H!=null&&(y[q]=H)};b("nodesep",f.nodeSep),b("edgesep",f.edgeSep),b("ranksep",f.rankSep),b("rankdir",f.rankDir),b("align",f.align),b("ranker",f.ranker),b("acyclicer",f.acyclicer),v.setGraph(y),v.setDefaultEdgeLabel(function(){return{}}),v.setDefaultNodeLabel(function(){return{}});var w=p.nodes();s(f.sort)&&(w=w.sort(f.sort));for(var _=0;_<w.length;_++){var x=w[_],S=x.layoutDimensions(f);v.setNode(x.id(),{width:S.w,height:S.h,name:x.id()})}for(var E=0;E<w.length;E++){var A=w[E];A.isChild()&&v.setParent(A.id(),A.parent().id())}var T=p.edges().stdFilter(function(F){return!F.source().isParent()&&!F.target().isParent()});s(f.sort)&&(T=T.sort(f.sort));for(var D=0;D<T.length;D++){var k=T[D];v.setEdge(k.source().id(),k.target().id(),{minlen:g(k,f.minLen),weight:g(k,f.edgeWeight),name:k.id()},k.id())}u.layout(v);for(var M=v.nodes(),P=0;P<M.length;P++){var I=M[P],B=v.node(I);d.getElementById(I).scratch().dagre=B}var L;f.boundingBox?(L={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0},w.forEach(function(F){var q=F.scratch().dagre;L.x1=Math.min(L.x1,q.x),L.x2=Math.max(L.x2,q.x),L.y1=Math.min(L.y1,q.y),L.y2=Math.max(L.y2,q.y)}),L.w=L.x2-L.x1,L.h=L.y2-L.y1):L=m;var N=function(q){if(f.boundingBox){var H=L.w===0?0:(q.x-L.x1)/L.w,V=L.h===0?0:(q.y-L.y1)/L.h;return{x:m.x1+H*m.w,y:m.y1+V*m.h}}else return q};return w.layoutPositions(h,f,function(F){F=a(F)==="object"?F:this;var q=F.scratch().dagre;return N({x:q.x,y:q.y})}),this},e.exports=c},function(e,r){var n={nodeSep:void 0,edgeSep:void 0,rankSep:void 0,rankDir:void 0,align:void 0,acyclicer:void 0,ranker:void 0,minLen:function(s){return 1},edgeWeight:function(s){return 1},fit:!0,padding:30,spacingFactor:void 0,nodeDimensionsIncludeLabels:!1,animate:!1,animateFilter:function(s,o){return!0},animationDuration:500,animationEasing:void 0,boundingBox:void 0,transform:function(s,o){return o},ready:function(){},sort:void 0,stop:function(){}};e.exports=n},function(e,r){e.exports=Object.assign!=null?Object.assign.bind(Object):function(n){for(var a=arguments.length,s=new Array(a>1?a-1:0),o=1;o<a;o++)s[o-1]=arguments[o];return s.forEach(function(l){Object.keys(l).forEach(function(u){return n[u]=l[u]})}),n}},function(e,r){e.exports=t}])})});var XF=O((exports,module)=>{"use strict";var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__name=(t,e)=>__defProp(t,"name",{value:e,configurable:!0}),__commonJS=(t,e)=>function(){return e||(0,t[__getOwnPropNames(t)[0]])((e={exports:{}}).exports,e),e.exports},__export=(t,e)=>{for(var r in e)__defProp(t,r,{get:e[r],enumerable:!0})},__copyProps=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of __getOwnPropNames(e))!__hasOwnProp.call(t,a)&&a!==r&&__defProp(t,a,{get:()=>e[a],enumerable:!(n=__getOwnPropDesc(e,a))||n.enumerable});return t},__toESM=(t,e,r)=>(r=t!=null?__create(__getProtoOf(t)):{},__copyProps(e||!t||!t.__esModule?__defProp(r,"default",{value:t,enumerable:!0}):r,t)),__toCommonJS=t=>__copyProps(__defProp({},"__esModule",{value:!0}),t),require_tree_sitter=__commonJS({"lib/tree-sitter.cjs"(exports,module){"use strict";var Module=(()=>{var _scriptName=typeof document<"u"?document.currentScript?.src:void 0;return typeof __filename<"u"&&(_scriptName=_scriptName||__filename),async function(moduleArg={}){var moduleRtn,Module=moduleArg,readyPromiseResolve,readyPromiseReject,readyPromise=new Promise((t,e)=>{readyPromiseResolve=t,readyPromiseReject=e}),ENVIRONMENT_IS_WEB=typeof window=="object",ENVIRONMENT_IS_WORKER=typeof WorkerGlobalScope<"u",ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type!="renderer",ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;Module.currentQueryProgressCallback=null,Module.currentProgressCallback=null,Module.currentLogCallback=null,Module.currentParseCallback=null;var moduleOverrides=Object.assign({},Module),arguments_=[],thisProgram="./this.program",quit_=__name((t,e)=>{throw e},"quit_"),scriptDirectory="";function locateFile(t){return Module.locateFile?Module.locateFile(t,scriptDirectory):scriptDirectory+t}__name(locateFile,"locateFile");var readAsync,readBinary;if(ENVIRONMENT_IS_NODE){var fs=Wn("fs"),nodePath=Wn("path");scriptDirectory=__dirname+"/",readBinary=__name(t=>{t=isFileURI(t)?new URL(t):t;var e=fs.readFileSync(t);return e},"readBinary"),readAsync=__name(async(t,e=!0)=>{t=isFileURI(t)?new URL(t):t;var r=fs.readFileSync(t,e?void 0:"utf8");return r},"readAsync"),!Module.thisProgram&&process.argv.length>1&&(thisProgram=process.argv[1].replace(/\\/g,"/")),arguments_=process.argv.slice(2),quit_=__name((t,e)=>{throw process.exitCode=t,e},"quit_")}else(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)&&(ENVIRONMENT_IS_WORKER?scriptDirectory=self.location.href:typeof document<"u"&&document.currentScript&&(scriptDirectory=document.currentScript.src),_scriptName&&(scriptDirectory=_scriptName),scriptDirectory.startsWith("blob:")?scriptDirectory="":scriptDirectory=scriptDirectory.substr(0,scriptDirectory.replace(/[?#].*/,"").lastIndexOf("/")+1),ENVIRONMENT_IS_WORKER&&(readBinary=__name(t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)},"readBinary")),readAsync=__name(async t=>{if(isFileURI(t))return new Promise((r,n)=>{var a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="arraybuffer",a.onload=()=>{if(a.status==200||a.status==0&&a.response){r(a.response);return}n(a.status)},a.onerror=n,a.send(null)});var e=await fetch(t,{credentials:"same-origin"});if(e.ok)return e.arrayBuffer();throw new Error(e.status+" : "+e.url)},"readAsync"));var out=Module.print||console.log.bind(console),err=Module.printErr||console.error.bind(console);Object.assign(Module,moduleOverrides),moduleOverrides=null,Module.arguments&&(arguments_=Module.arguments),Module.thisProgram&&(thisProgram=Module.thisProgram);var dynamicLibraries=Module.dynamicLibraries||[],wasmBinary=Module.wasmBinary,wasmMemory,ABORT=!1,EXITSTATUS;function assert(t,e){t||abort(e)}__name(assert,"assert");var HEAP,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAP64,HEAPU64,HEAPF64,HEAP_DATA_VIEW,runtimeInitialized=!1,dataURIPrefix="data:application/octet-stream;base64,",isDataURI=__name(t=>t.startsWith(dataURIPrefix),"isDataURI"),isFileURI=__name(t=>t.startsWith("file://"),"isFileURI");function updateMemoryViews(){var t=wasmMemory.buffer;Module.HEAP_DATA_VIEW=HEAP_DATA_VIEW=new DataView(t),Module.HEAP8=HEAP8=new Int8Array(t),Module.HEAP16=HEAP16=new Int16Array(t),Module.HEAPU8=HEAPU8=new Uint8Array(t),Module.HEAPU16=HEAPU16=new Uint16Array(t),Module.HEAP32=HEAP32=new Int32Array(t),Module.HEAPU32=HEAPU32=new Uint32Array(t),Module.HEAPF32=HEAPF32=new Float32Array(t),Module.HEAPF64=HEAPF64=new Float64Array(t),Module.HEAP64=HEAP64=new BigInt64Array(t),Module.HEAPU64=HEAPU64=new BigUint64Array(t)}if(__name(updateMemoryViews,"updateMemoryViews"),Module.wasmMemory)wasmMemory=Module.wasmMemory;else{var INITIAL_MEMORY=Module.INITIAL_MEMORY||33554432;wasmMemory=new WebAssembly.Memory({initial:INITIAL_MEMORY/65536,maximum:32768})}updateMemoryViews();var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATEXIT__=[],__ATPOSTRUN__=[],__RELOC_FUNCS__=[];function preRun(){if(Module.preRun)for(typeof Module.preRun=="function"&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}__name(preRun,"preRun");function initRuntime(){runtimeInitialized=!0,callRuntimeCallbacks(__RELOC_FUNCS__),callRuntimeCallbacks(__ATINIT__)}__name(initRuntime,"initRuntime");function preMain(){callRuntimeCallbacks(__ATMAIN__)}__name(preMain,"preMain");function postRun(){if(Module.postRun)for(typeof Module.postRun=="function"&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}__name(postRun,"postRun");function addOnPreRun(t){__ATPRERUN__.unshift(t)}__name(addOnPreRun,"addOnPreRun");function addOnInit(t){__ATINIT__.unshift(t)}__name(addOnInit,"addOnInit");function addOnPreMain(t){__ATMAIN__.unshift(t)}__name(addOnPreMain,"addOnPreMain");function addOnExit(t){}__name(addOnExit,"addOnExit");function addOnPostRun(t){__ATPOSTRUN__.unshift(t)}__name(addOnPostRun,"addOnPostRun");var runDependencies=0,dependenciesFulfilled=null;function getUniqueRunDependency(t){return t}__name(getUniqueRunDependency,"getUniqueRunDependency");function addRunDependency(t){runDependencies++,Module.monitorRunDependencies?.(runDependencies)}__name(addRunDependency,"addRunDependency");function removeRunDependency(t){if(runDependencies--,Module.monitorRunDependencies?.(runDependencies),runDependencies==0&&dependenciesFulfilled){var e=dependenciesFulfilled;dependenciesFulfilled=null,e()}}__name(removeRunDependency,"removeRunDependency");function abort(t){Module.onAbort?.(t),t="Aborted("+t+")",err(t),ABORT=!0,t+=". Build with -sASSERTIONS for more info.";var e=new WebAssembly.RuntimeError(t);throw readyPromiseReject(e),e}__name(abort,"abort");var wasmBinaryFile;function findWasmBinary(){var t="tree-sitter.wasm";return isDataURI(t)?t:locateFile(t)}__name(findWasmBinary,"findWasmBinary");function getBinarySync(t){if(t==wasmBinaryFile&&wasmBinary)return new Uint8Array(wasmBinary);if(readBinary)return readBinary(t);throw"both async and sync fetching of the wasm failed"}__name(getBinarySync,"getBinarySync");async function getWasmBinary(t){if(!wasmBinary)try{var e=await readAsync(t);return new Uint8Array(e)}catch{}return getBinarySync(t)}__name(getWasmBinary,"getWasmBinary");async function instantiateArrayBuffer(t,e){try{var r=await getWasmBinary(t),n=await WebAssembly.instantiate(r,e);return n}catch(a){err(`failed to asynchronously prepare wasm: ${a}`),abort(a)}}__name(instantiateArrayBuffer,"instantiateArrayBuffer");async function instantiateAsync(t,e,r){if(!t&&typeof WebAssembly.instantiateStreaming=="function"&&!isDataURI(e)&&!isFileURI(e)&&!ENVIRONMENT_IS_NODE)try{var n=fetch(e,{credentials:"same-origin"}),a=await WebAssembly.instantiateStreaming(n,r);return a}catch(s){err(`wasm streaming compile failed: ${s}`),err("falling back to ArrayBuffer instantiation")}return instantiateArrayBuffer(e,r)}__name(instantiateAsync,"instantiateAsync");function getWasmImports(){return{env:wasmImports,wasi_snapshot_preview1:wasmImports,"GOT.mem":new Proxy(wasmImports,GOTHandler),"GOT.func":new Proxy(wasmImports,GOTHandler)}}__name(getWasmImports,"getWasmImports");async function createWasm(){function t(s,o){wasmExports=s.exports,wasmExports=relocateExports(wasmExports,1024);var l=getDylinkMetadata(o);return l.neededDynlibs&&(dynamicLibraries=l.neededDynlibs.concat(dynamicLibraries)),mergeLibSymbols(wasmExports,"main"),LDSO.init(),loadDylibs(),addOnInit(wasmExports.__wasm_call_ctors),__RELOC_FUNCS__.push(wasmExports.__wasm_apply_data_relocs),removeRunDependency("wasm-instantiate"),wasmExports}__name(t,"receiveInstance"),addRunDependency("wasm-instantiate");function e(s){return t(s.instance,s.module)}__name(e,"receiveInstantiationResult");var r=getWasmImports();if(Module.instantiateWasm)try{return Module.instantiateWasm(r,t)}catch(s){err(`Module.instantiateWasm callback failed with error: ${s}`),readyPromiseReject(s)}wasmBinaryFile??=findWasmBinary();try{var n=await instantiateAsync(wasmBinary,wasmBinaryFile,r),a=e(n);return a}catch(s){return readyPromiseReject(s),Promise.reject(s)}}__name(createWasm,"createWasm");var ASM_CONSTS={};class ExitStatus{static{__name(this,"ExitStatus")}name="ExitStatus";constructor(e){this.message=`Program terminated with exit(${e})`,this.status=e}}var GOT={},currentModuleWeakSymbols=new Set([]),GOTHandler={get(t,e){var r=GOT[e];return r||(r=GOT[e]=new WebAssembly.Global({value:"i32",mutable:!0})),currentModuleWeakSymbols.has(e)||(r.required=!0),r}},LE_HEAP_LOAD_F32=__name(t=>HEAP_DATA_VIEW.getFloat32(t,!0),"LE_HEAP_LOAD_F32"),LE_HEAP_LOAD_F64=__name(t=>HEAP_DATA_VIEW.getFloat64(t,!0),"LE_HEAP_LOAD_F64"),LE_HEAP_LOAD_I16=__name(t=>HEAP_DATA_VIEW.getInt16(t,!0),"LE_HEAP_LOAD_I16"),LE_HEAP_LOAD_I32=__name(t=>HEAP_DATA_VIEW.getInt32(t,!0),"LE_HEAP_LOAD_I32"),LE_HEAP_LOAD_U16=__name(t=>HEAP_DATA_VIEW.getUint16(t,!0),"LE_HEAP_LOAD_U16"),LE_HEAP_LOAD_U32=__name(t=>HEAP_DATA_VIEW.getUint32(t,!0),"LE_HEAP_LOAD_U32"),LE_HEAP_STORE_F32=__name((t,e)=>HEAP_DATA_VIEW.setFloat32(t,e,!0),"LE_HEAP_STORE_F32"),LE_HEAP_STORE_F64=__name((t,e)=>HEAP_DATA_VIEW.setFloat64(t,e,!0),"LE_HEAP_STORE_F64"),LE_HEAP_STORE_I16=__name((t,e)=>HEAP_DATA_VIEW.setInt16(t,e,!0),"LE_HEAP_STORE_I16"),LE_HEAP_STORE_I32=__name((t,e)=>HEAP_DATA_VIEW.setInt32(t,e,!0),"LE_HEAP_STORE_I32"),LE_HEAP_STORE_U16=__name((t,e)=>HEAP_DATA_VIEW.setUint16(t,e,!0),"LE_HEAP_STORE_U16"),LE_HEAP_STORE_U32=__name((t,e)=>HEAP_DATA_VIEW.setUint32(t,e,!0),"LE_HEAP_STORE_U32"),callRuntimeCallbacks=__name(t=>{for(;t.length>0;)t.shift()(Module)},"callRuntimeCallbacks"),UTF8Decoder=typeof TextDecoder<"u"?new TextDecoder:void 0,UTF8ArrayToString=__name((t,e=0,r=NaN)=>{for(var n=e+r,a=e;t[a]&&!(a>=n);)++a;if(a-e>16&&t.buffer&&UTF8Decoder)return UTF8Decoder.decode(t.subarray(e,a));for(var s="";e<a;){var o=t[e++];if(!(o&128)){s+=String.fromCharCode(o);continue}var l=t[e++]&63;if((o&224)==192){s+=String.fromCharCode((o&31)<<6|l);continue}var u=t[e++]&63;if((o&240)==224?o=(o&15)<<12|l<<6|u:o=(o&7)<<18|l<<12|u<<6|t[e++]&63,o<65536)s+=String.fromCharCode(o);else{var c=o-65536;s+=String.fromCharCode(55296|c>>10,56320|c&1023)}}return s},"UTF8ArrayToString"),getDylinkMetadata=__name(t=>{var e=0,r=0;function n(){return t[e++]}__name(n,"getU8");function a(){for(var P=0,I=1;;){var B=t[e++];if(P+=(B&127)*I,I*=128,!(B&128))break}return P}__name(a,"getLEB");function s(){var P=a();return e+=P,UTF8ArrayToString(t,e-P,P)}__name(s,"getString");function o(P,I){if(P)throw new Error(I)}__name(o,"failIf");var l="dylink.0";if(t instanceof WebAssembly.Module){var u=WebAssembly.Module.customSections(t,l);u.length===0&&(l="dylink",u=WebAssembly.Module.customSections(t,l)),o(u.length===0,"need dylink section"),t=new Uint8Array(u[0]),r=t.length}else{var c=new Uint32Array(new Uint8Array(t.subarray(0,24)).buffer),f=c[0]==1836278016||c[0]==6386541;o(!f,"need to see wasm magic number"),o(t[8]!==0,"need the dylink section to be first"),e=9;var h=a();r=e+h,l=s()}var d={neededDynlibs:[],tlsExports:new Set,weakImports:new Set};if(l=="dylink"){d.memorySize=a(),d.memoryAlign=a(),d.tableSize=a(),d.tableAlign=a();for(var p=a(),g=0;g<p;++g){var m=s();d.neededDynlibs.push(m)}}else{o(l!=="dylink.0");for(var v=1,y=2,b=3,w=4,_=256,x=3,S=1;e<r;){var E=n(),A=a();if(E===v)d.memorySize=a(),d.memoryAlign=a(),d.tableSize=a(),d.tableAlign=a();else if(E===y)for(var p=a(),g=0;g<p;++g)m=s(),d.neededDynlibs.push(m);else if(E===b)for(var T=a();T--;){var D=s(),k=a();k&_&&d.tlsExports.add(D)}else if(E===w)for(var T=a();T--;){var M=s(),D=s(),k=a();(k&x)==S&&d.weakImports.add(D)}else e+=A}}return d},"getDylinkMetadata");function getValue(t,e="i8"){switch(e.endsWith("*")&&(e="*"),e){case"i1":return HEAP8[t];case"i8":return HEAP8[t];case"i16":return LE_HEAP_LOAD_I16((t>>1)*2);case"i32":return LE_HEAP_LOAD_I32((t>>2)*4);case"i64":return HEAP64[t>>3];case"float":return LE_HEAP_LOAD_F32((t>>2)*4);case"double":return LE_HEAP_LOAD_F64((t>>3)*8);case"*":return LE_HEAP_LOAD_U32((t>>2)*4);default:abort(`invalid type for getValue: ${e}`)}}__name(getValue,"getValue");var newDSO=__name((t,e,r)=>{var n={refcount:1/0,name:t,exports:r,global:!0};return LDSO.loadedLibsByName[t]=n,e!=null&&(LDSO.loadedLibsByHandle[e]=n),n},"newDSO"),LDSO={loadedLibsByName:{},loadedLibsByHandle:{},init(){newDSO("__main__",0,wasmImports)}},___heap_base=78224,alignMemory=__name((t,e)=>Math.ceil(t/e)*e,"alignMemory"),getMemory=__name(t=>{if(runtimeInitialized)return _calloc(t,1);var e=___heap_base,r=e+alignMemory(t,16);return ___heap_base=r,GOT.__heap_base.value=r,e},"getMemory"),isInternalSym=__name(t=>["__cpp_exception","__c_longjmp","__wasm_apply_data_relocs","__dso_handle","__tls_size","__tls_align","__set_stack_limits","_emscripten_tls_init","__wasm_init_tls","__wasm_call_ctors","__start_em_asm","__stop_em_asm","__start_em_js","__stop_em_js"].includes(t)||t.startsWith("__em_js__"),"isInternalSym"),uleb128Encode=__name((t,e)=>{t<128?e.push(t):e.push(t%128|128,t>>7)},"uleb128Encode"),sigToWasmTypes=__name(t=>{for(var e={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},r={parameters:[],results:t[0]=="v"?[]:[e[t[0]]]},n=1;n<t.length;++n)r.parameters.push(e[t[n]]);return r},"sigToWasmTypes"),generateFuncType=__name((t,e)=>{var r=t.slice(0,1),n=t.slice(1),a={i:127,p:127,j:126,f:125,d:124,e:111};e.push(96),uleb128Encode(n.length,e);for(var s=0;s<n.length;++s)e.push(a[n[s]]);r=="v"?e.push(0):e.push(1,a[r])},"generateFuncType"),convertJsFunctionToWasm=__name((t,e)=>{if(typeof WebAssembly.Function=="function")return new WebAssembly.Function(sigToWasmTypes(e),t);var r=[1];generateFuncType(e,r);var n=[0,97,115,109,1,0,0,0,1];uleb128Encode(r.length,n),n.push(...r),n.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var a=new WebAssembly.Module(new Uint8Array(n)),s=new WebAssembly.Instance(a,{e:{f:t}}),o=s.exports.f;return o},"convertJsFunctionToWasm"),wasmTableMirror=[],wasmTable=new WebAssembly.Table({initial:31,element:"anyfunc"}),getWasmTableEntry=__name(t=>{var e=wasmTableMirror[t];return e||(t>=wasmTableMirror.length&&(wasmTableMirror.length=t+1),wasmTableMirror[t]=e=wasmTable.get(t)),e},"getWasmTableEntry"),updateTableMap=__name((t,e)=>{if(functionsInTableMap)for(var r=t;r<t+e;r++){var n=getWasmTableEntry(r);n&&functionsInTableMap.set(n,r)}},"updateTableMap"),functionsInTableMap,getFunctionAddress=__name(t=>(functionsInTableMap||(functionsInTableMap=new WeakMap,updateTableMap(0,wasmTable.length)),functionsInTableMap.get(t)||0),"getFunctionAddress"),freeTableIndexes=[],getEmptyTableSlot=__name(()=>{if(freeTableIndexes.length)return freeTableIndexes.pop();try{wasmTable.grow(1)}catch(t){throw t instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":t}return wasmTable.length-1},"getEmptyTableSlot"),setWasmTableEntry=__name((t,e)=>{wasmTable.set(t,e),wasmTableMirror[t]=wasmTable.get(t)},"setWasmTableEntry"),addFunction=__name((t,e)=>{var r=getFunctionAddress(t);if(r)return r;var n=getEmptyTableSlot();try{setWasmTableEntry(n,t)}catch(s){if(!(s instanceof TypeError))throw s;var a=convertJsFunctionToWasm(t,e);setWasmTableEntry(n,a)}return functionsInTableMap.set(t,n),n},"addFunction"),updateGOT=__name((t,e)=>{for(var r in t)if(!isInternalSym(r)){var n=t[r];GOT[r]||=new WebAssembly.Global({value:"i32",mutable:!0}),(e||GOT[r].value==0)&&(typeof n=="function"?GOT[r].value=addFunction(n):typeof n=="number"?GOT[r].value=n:err(`unhandled export type for '${r}': ${typeof n}`))}},"updateGOT"),relocateExports=__name((t,e,r)=>{var n={};for(var a in t){var s=t[a];typeof s=="object"&&(s=s.value),typeof s=="number"&&(s+=e),n[a]=s}return updateGOT(n,r),n},"relocateExports"),isSymbolDefined=__name(t=>{var e=wasmImports[t];return!(!e||e.stub)},"isSymbolDefined"),dynCall=__name((t,e,r=[])=>{var n=getWasmTableEntry(e)(...r);return n},"dynCall"),stackSave=__name(()=>_emscripten_stack_get_current(),"stackSave"),stackRestore=__name(t=>__emscripten_stack_restore(t),"stackRestore"),createInvokeFunction=__name(t=>(e,...r)=>{var n=stackSave();try{return dynCall(t,e,r)}catch(a){if(stackRestore(n),a!==a+0)throw a;if(_setThrew(1,0),t[0]=="j")return 0n}},"createInvokeFunction"),resolveGlobalSymbol=__name((t,e=!1)=>{var r;return isSymbolDefined(t)?r=wasmImports[t]:t.startsWith("invoke_")&&(r=wasmImports[t]=createInvokeFunction(t.split("_")[1])),{sym:r,name:t}},"resolveGlobalSymbol"),UTF8ToString=__name((t,e)=>t?UTF8ArrayToString(HEAPU8,t,e):"","UTF8ToString"),loadWebAssemblyModule=__name((binary,flags,libName,localScope,handle)=>{var metadata=getDylinkMetadata(binary);currentModuleWeakSymbols=metadata.weakImports;function loadModule(){var firstLoad=!handle||!HEAP8[handle+8];if(firstLoad){var memAlign=Math.pow(2,metadata.memoryAlign),memoryBase=metadata.memorySize?alignMemory(getMemory(metadata.memorySize+memAlign),memAlign):0,tableBase=metadata.tableSize?wasmTable.length:0;handle&&(HEAP8[handle+8]=1,LE_HEAP_STORE_U32((handle+12>>2)*4,memoryBase),LE_HEAP_STORE_I32((handle+16>>2)*4,metadata.memorySize),LE_HEAP_STORE_U32((handle+20>>2)*4,tableBase),LE_HEAP_STORE_I32((handle+24>>2)*4,metadata.tableSize))}else memoryBase=LE_HEAP_LOAD_U32((handle+12>>2)*4),tableBase=LE_HEAP_LOAD_U32((handle+20>>2)*4);var tableGrowthNeeded=tableBase+metadata.tableSize-wasmTable.length;tableGrowthNeeded>0&&wasmTable.grow(tableGrowthNeeded);var moduleExports;function resolveSymbol(t){var e=resolveGlobalSymbol(t).sym;return!e&&localScope&&(e=localScope[t]),e||(e=moduleExports[t]),e}__name(resolveSymbol,"resolveSymbol");var proxyHandler={get(t,e){switch(e){case"__memory_base":return memoryBase;case"__table_base":return tableBase}if(e in wasmImports&&!wasmImports[e].stub)return wasmImports[e];if(!(e in t)){var r;t[e]=(...n)=>(r||=resolveSymbol(e),r(...n))}return t[e]}},proxy=new Proxy({},proxyHandler),info={"GOT.mem":new Proxy({},GOTHandler),"GOT.func":new Proxy({},GOTHandler),env:proxy,wasi_snapshot_preview1:proxy};function postInstantiation(module,instance){updateTableMap(tableBase,metadata.tableSize),moduleExports=relocateExports(instance.exports,memoryBase),flags.allowUndefined||reportUndefinedSymbols();function addEmAsm(addr,body){for(var args=[],arity=0;arity<16&&body.indexOf("$"+arity)!=-1;arity++)args.push("$"+arity);args=args.join(",");var func=`(${args}) => { ${body} };`;ASM_CONSTS[start]=eval(func)}if(__name(addEmAsm,"addEmAsm"),"__start_em_asm"in moduleExports)for(var start=moduleExports.__start_em_asm,stop=moduleExports.__stop_em_asm;start<stop;){var jsString=UTF8ToString(start);addEmAsm(start,jsString),start=HEAPU8.indexOf(0,start)+1}function addEmJs(name,cSig,body){var jsArgs=[];if(cSig=cSig.slice(1,-1),cSig!="void"){cSig=cSig.split(",");for(var i in cSig){var jsArg=cSig[i].split(" ").pop();jsArgs.push(jsArg.replace("*",""))}}var func=`(${jsArgs}) => ${body};`;moduleExports[name]=eval(func)}__name(addEmJs,"addEmJs");for(var name in moduleExports)if(name.startsWith("__em_js__")){var start=moduleExports[name],jsString=UTF8ToString(start),parts=jsString.split("<::>");addEmJs(name.replace("__em_js__",""),parts[0],parts[1]),delete moduleExports[name]}var applyRelocs=moduleExports.__wasm_apply_data_relocs;applyRelocs&&(runtimeInitialized?applyRelocs():__RELOC_FUNCS__.push(applyRelocs));var init=moduleExports.__wasm_call_ctors;return init&&(runtimeInitialized?init():__ATINIT__.push(init)),moduleExports}if(__name(postInstantiation,"postInstantiation"),flags.loadAsync){if(binary instanceof WebAssembly.Module){var instance=new WebAssembly.Instance(binary,info);return Promise.resolve(postInstantiation(binary,instance))}return WebAssembly.instantiate(binary,info).then(t=>postInstantiation(t.module,t.instance))}var module=binary instanceof WebAssembly.Module?binary:new WebAssembly.Module(binary),instance=new WebAssembly.Instance(module,info);return postInstantiation(module,instance)}return __name(loadModule,"loadModule"),flags.loadAsync?metadata.neededDynlibs.reduce((t,e)=>t.then(()=>loadDynamicLibrary(e,flags,localScope)),Promise.resolve()).then(loadModule):(metadata.neededDynlibs.forEach(t=>loadDynamicLibrary(t,flags,localScope)),loadModule())},"loadWebAssemblyModule"),mergeLibSymbols=__name((t,e)=>{for(var[r,n]of Object.entries(t)){let a=__name(o=>{isSymbolDefined(o)||(wasmImports[o]=n)},"setImport");a(r);let s="__main_argc_argv";r=="main"&&a(s),r==s&&a("main")}},"mergeLibSymbols"),asyncLoad=__name(async t=>{var e=await readAsync(t);return new Uint8Array(e)},"asyncLoad");function loadDynamicLibrary(t,e={global:!0,nodelete:!0},r,n){var a=LDSO.loadedLibsByName[t];if(a)return e.global?a.global||(a.global=!0,mergeLibSymbols(a.exports,t)):r&&Object.assign(r,a.exports),e.nodelete&&a.refcount!==1/0&&(a.refcount=1/0),a.refcount++,n&&(LDSO.loadedLibsByHandle[n]=a),e.loadAsync?Promise.resolve(!0):!0;a=newDSO(t,n,"loading"),a.refcount=e.nodelete?1/0:1,a.global=e.global;function s(){if(n){var u=LE_HEAP_LOAD_U32((n+28>>2)*4),c=LE_HEAP_LOAD_U32((n+32>>2)*4);if(u&&c){var f=HEAP8.slice(u,u+c);return e.loadAsync?Promise.resolve(f):f}}var h=locateFile(t);if(e.loadAsync)return asyncLoad(h);if(!readBinary)throw new Error(`${h}: file not found, and synchronous loading of external files is not available`);return readBinary(h)}__name(s,"loadLibData");function o(){return e.loadAsync?s().then(u=>loadWebAssemblyModule(u,e,t,r,n)):loadWebAssemblyModule(s(),e,t,r,n)}__name(o,"getExports");function l(u){a.global?mergeLibSymbols(u,t):r&&Object.assign(r,u),a.exports=u}return __name(l,"moduleLoaded"),e.loadAsync?o().then(u=>(l(u),!0)):(l(o()),!0)}__name(loadDynamicLibrary,"loadDynamicLibrary");var reportUndefinedSymbols=__name(()=>{for(var[t,e]of Object.entries(GOT))if(e.value==0){var r=resolveGlobalSymbol(t,!0).sym;if(!r&&!e.required)continue;if(typeof r=="function")e.value=addFunction(r,r.sig);else if(typeof r=="number")e.value=r;else throw new Error(`bad export type for '${t}': ${typeof r}`)}},"reportUndefinedSymbols"),loadDylibs=__name(()=>{if(!dynamicLibraries.length){reportUndefinedSymbols();return}addRunDependency("loadDylibs"),dynamicLibraries.reduce((t,e)=>t.then(()=>loadDynamicLibrary(e,{loadAsync:!0,global:!0,nodelete:!0,allowUndefined:!0})),Promise.resolve()).then(()=>{reportUndefinedSymbols(),removeRunDependency("loadDylibs")})},"loadDylibs"),noExitRuntime=Module.noExitRuntime||!0;function setValue(t,e,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":HEAP8[t]=e;break;case"i8":HEAP8[t]=e;break;case"i16":LE_HEAP_STORE_I16((t>>1)*2,e);break;case"i32":LE_HEAP_STORE_I32((t>>2)*4,e);break;case"i64":HEAP64[t>>3]=BigInt(e);break;case"float":LE_HEAP_STORE_F32((t>>2)*4,e);break;case"double":LE_HEAP_STORE_F64((t>>3)*8,e);break;case"*":LE_HEAP_STORE_U32((t>>2)*4,e);break;default:abort(`invalid type for setValue: ${r}`)}}__name(setValue,"setValue");var ___memory_base=new WebAssembly.Global({value:"i32",mutable:!1},1024),___stack_pointer=new WebAssembly.Global({value:"i32",mutable:!0},78224),___table_base=new WebAssembly.Global({value:"i32",mutable:!1},1),__abort_js=__name(()=>abort(""),"__abort_js");__abort_js.sig="v";var _emscripten_get_now=__name(()=>performance.now(),"_emscripten_get_now");_emscripten_get_now.sig="d";var _emscripten_date_now=__name(()=>Date.now(),"_emscripten_date_now");_emscripten_date_now.sig="d";var nowIsMonotonic=1,checkWasiClock=__name(t=>t>=0&&t<=3,"checkWasiClock"),INT53_MAX=9007199254740992,INT53_MIN=-9007199254740992,bigintToI53Checked=__name(t=>t<INT53_MIN||t>INT53_MAX?NaN:Number(t),"bigintToI53Checked");function _clock_time_get(t,e,r){if(e=bigintToI53Checked(e),!checkWasiClock(t))return 28;var n;if(t===0)n=_emscripten_date_now();else if(nowIsMonotonic)n=_emscripten_get_now();else return 52;var a=Math.round(n*1e3*1e3);return HEAP64[r>>3]=BigInt(a),0}__name(_clock_time_get,"_clock_time_get"),_clock_time_get.sig="iijp";var getHeapMax=__name(()=>2147483648,"getHeapMax"),growMemory=__name(t=>{var e=wasmMemory.buffer,r=(t-e.byteLength+65535)/65536|0;try{return wasmMemory.grow(r),updateMemoryViews(),1}catch{}},"growMemory"),_emscripten_resize_heap=__name(t=>{var e=HEAPU8.length;t>>>=0;var r=getHeapMax();if(t>r)return!1;for(var n=1;n<=4;n*=2){var a=e*(1+.2/n);a=Math.min(a,t+100663296);var s=Math.min(r,alignMemory(Math.max(t,a),65536)),o=growMemory(s);if(o)return!0}return!1},"_emscripten_resize_heap");_emscripten_resize_heap.sig="ip";var _fd_close=__name(t=>52,"_fd_close");_fd_close.sig="ii";function _fd_seek(t,e,r,n){return e=bigintToI53Checked(e),70}__name(_fd_seek,"_fd_seek"),_fd_seek.sig="iijip";var printCharBuffers=[null,[],[]],printChar=__name((t,e)=>{var r=printCharBuffers[t];e===0||e===10?((t===1?out:err)(UTF8ArrayToString(r)),r.length=0):r.push(e)},"printChar"),flush_NO_FILESYSTEM=__name(()=>{printCharBuffers[1].length&&printChar(1,10),printCharBuffers[2].length&&printChar(2,10)},"flush_NO_FILESYSTEM"),SYSCALLS={varargs:void 0,getStr(t){var e=UTF8ToString(t);return e}},_fd_write=__name((t,e,r,n)=>{for(var a=0,s=0;s<r;s++){var o=LE_HEAP_LOAD_U32((e>>2)*4),l=LE_HEAP_LOAD_U32((e+4>>2)*4);e+=8;for(var u=0;u<l;u++)printChar(t,HEAPU8[o+u]);a+=l}return LE_HEAP_STORE_U32((n>>2)*4,a),0},"_fd_write");_fd_write.sig="iippp";function _tree_sitter_log_callback(t,e){if(Module.currentLogCallback){let r=UTF8ToString(e);Module.currentLogCallback(r,t!==0)}}__name(_tree_sitter_log_callback,"_tree_sitter_log_callback");function _tree_sitter_parse_callback(t,e,r,n,a){let o=Module.currentParseCallback(e,{row:r,column:n});typeof o=="string"?(setValue(a,o.length,"i32"),stringToUTF16(o,t,10240)):setValue(a,0,"i32")}__name(_tree_sitter_parse_callback,"_tree_sitter_parse_callback");function _tree_sitter_progress_callback(t,e){return Module.currentProgressCallback?Module.currentProgressCallback({currentOffset:t,hasError:e}):!1}__name(_tree_sitter_progress_callback,"_tree_sitter_progress_callback");function _tree_sitter_query_progress_callback(t){return Module.currentQueryProgressCallback?Module.currentQueryProgressCallback({currentOffset:t}):!1}__name(_tree_sitter_query_progress_callback,"_tree_sitter_query_progress_callback");var runtimeKeepaliveCounter=0,keepRuntimeAlive=__name(()=>noExitRuntime||runtimeKeepaliveCounter>0,"keepRuntimeAlive"),_proc_exit=__name(t=>{EXITSTATUS=t,keepRuntimeAlive()||(Module.onExit?.(t),ABORT=!0),quit_(t,new ExitStatus(t))},"_proc_exit");_proc_exit.sig="vi";var exitJS=__name((t,e)=>{EXITSTATUS=t,_proc_exit(t)},"exitJS"),handleException=__name(t=>{if(t instanceof ExitStatus||t=="unwind")return EXITSTATUS;quit_(1,t)},"handleException"),lengthBytesUTF8=__name(t=>{for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);n<=127?e++:n<=2047?e+=2:n>=55296&&n<=57343?(e+=4,++r):e+=3}return e},"lengthBytesUTF8"),stringToUTF8Array=__name((t,e,r,n)=>{if(!(n>0))return 0;for(var a=r,s=r+n-1,o=0;o<t.length;++o){var l=t.charCodeAt(o);if(l>=55296&&l<=57343){var u=t.charCodeAt(++o);l=65536+((l&1023)<<10)|u&1023}if(l<=127){if(r>=s)break;e[r++]=l}else if(l<=2047){if(r+1>=s)break;e[r++]=192|l>>6,e[r++]=128|l&63}else if(l<=65535){if(r+2>=s)break;e[r++]=224|l>>12,e[r++]=128|l>>6&63,e[r++]=128|l&63}else{if(r+3>=s)break;e[r++]=240|l>>18,e[r++]=128|l>>12&63,e[r++]=128|l>>6&63,e[r++]=128|l&63}}return e[r]=0,r-a},"stringToUTF8Array"),stringToUTF8=__name((t,e,r)=>stringToUTF8Array(t,HEAPU8,e,r),"stringToUTF8"),stackAlloc=__name(t=>__emscripten_stack_alloc(t),"stackAlloc"),stringToUTF8OnStack=__name(t=>{var e=lengthBytesUTF8(t)+1,r=stackAlloc(e);return stringToUTF8(t,r,e),r},"stringToUTF8OnStack"),AsciiToString=__name(t=>{for(var e="";;){var r=HEAPU8[t++];if(!r)return e;e+=String.fromCharCode(r)}},"AsciiToString"),stringToUTF16=__name((t,e,r)=>{if(r??=2147483647,r<2)return 0;r-=2;for(var n=e,a=r<t.length*2?r/2:t.length,s=0;s<a;++s){var o=t.charCodeAt(s);LE_HEAP_STORE_I16((e>>1)*2,o),e+=2}return LE_HEAP_STORE_I16((e>>1)*2,0),e-n},"stringToUTF16"),wasmImports={__heap_base:___heap_base,__indirect_function_table:wasmTable,__memory_base:___memory_base,__stack_pointer:___stack_pointer,__table_base:___table_base,_abort_js:__abort_js,clock_time_get:_clock_time_get,emscripten_resize_heap:_emscripten_resize_heap,fd_close:_fd_close,fd_seek:_fd_seek,fd_write:_fd_write,memory:wasmMemory,tree_sitter_log_callback:_tree_sitter_log_callback,tree_sitter_parse_callback:_tree_sitter_parse_callback,tree_sitter_progress_callback:_tree_sitter_progress_callback,tree_sitter_query_progress_callback:_tree_sitter_query_progress_callback},wasmExports=await createWasm(),___wasm_call_ctors=wasmExports.__wasm_call_ctors,_malloc=Module._malloc=wasmExports.malloc,_calloc=Module._calloc=wasmExports.calloc,_realloc=Module._realloc=wasmExports.realloc,_free=Module._free=wasmExports.free,_memcmp=Module._memcmp=wasmExports.memcmp,_ts_language_symbol_count=Module._ts_language_symbol_count=wasmExports.ts_language_symbol_count,_ts_language_state_count=Module._ts_language_state_count=wasmExports.ts_language_state_count,_ts_language_version=Module._ts_language_version=wasmExports.ts_language_version,_ts_language_abi_version=Module._ts_language_abi_version=wasmExports.ts_language_abi_version,_ts_language_metadata=Module._ts_language_metadata=wasmExports.ts_language_metadata,_ts_language_name=Module._ts_language_name=wasmExports.ts_language_name,_ts_language_field_count=Module._ts_language_field_count=wasmExports.ts_language_field_count,_ts_language_next_state=Module._ts_language_next_state=wasmExports.ts_language_next_state,_ts_language_symbol_name=Module._ts_language_symbol_name=wasmExports.ts_language_symbol_name,_ts_language_symbol_for_name=Module._ts_language_symbol_for_name=wasmExports.ts_language_symbol_for_name,_strncmp=Module._strncmp=wasmExports.strncmp,_ts_language_symbol_type=Module._ts_language_symbol_type=wasmExports.ts_language_symbol_type,_ts_language_field_name_for_id=Module._ts_language_field_name_for_id=wasmExports.ts_language_field_name_for_id,_ts_lookahead_iterator_new=Module._ts_lookahead_iterator_new=wasmExports.ts_lookahead_iterator_new,_ts_lookahead_iterator_delete=Module._ts_lookahead_iterator_delete=wasmExports.ts_lookahead_iterator_delete,_ts_lookahead_iterator_reset_state=Module._ts_lookahead_iterator_reset_state=wasmExports.ts_lookahead_iterator_reset_state,_ts_lookahead_iterator_reset=Module._ts_lookahead_iterator_reset=wasmExports.ts_lookahead_iterator_reset,_ts_lookahead_iterator_next=Module._ts_lookahead_iterator_next=wasmExports.ts_lookahead_iterator_next,_ts_lookahead_iterator_current_symbol=Module._ts_lookahead_iterator_current_symbol=wasmExports.ts_lookahead_iterator_current_symbol,_ts_parser_delete=Module._ts_parser_delete=wasmExports.ts_parser_delete,_ts_parser_reset=Module._ts_parser_reset=wasmExports.ts_parser_reset,_ts_parser_set_language=Module._ts_parser_set_language=wasmExports.ts_parser_set_language,_ts_parser_timeout_micros=Module._ts_parser_timeout_micros=wasmExports.ts_parser_timeout_micros,_ts_parser_set_timeout_micros=Module._ts_parser_set_timeout_micros=wasmExports.ts_parser_set_timeout_micros,_ts_parser_set_included_ranges=Module._ts_parser_set_included_ranges=wasmExports.ts_parser_set_included_ranges,_ts_query_new=Module._ts_query_new=wasmExports.ts_query_new,_ts_query_delete=Module._ts_query_delete=wasmExports.ts_query_delete,_iswspace=Module._iswspace=wasmExports.iswspace,_iswalnum=Module._iswalnum=wasmExports.iswalnum,_ts_query_pattern_count=Module._ts_query_pattern_count=wasmExports.ts_query_pattern_count,_ts_query_capture_count=Module._ts_query_capture_count=wasmExports.ts_query_capture_count,_ts_query_string_count=Module._ts_query_string_count=wasmExports.ts_query_string_count,_ts_query_capture_name_for_id=Module._ts_query_capture_name_for_id=wasmExports.ts_query_capture_name_for_id,_ts_query_capture_quantifier_for_id=Module._ts_query_capture_quantifier_for_id=wasmExports.ts_query_capture_quantifier_for_id,_ts_query_string_value_for_id=Module._ts_query_string_value_for_id=wasmExports.ts_query_string_value_for_id,_ts_query_predicates_for_pattern=Module._ts_query_predicates_for_pattern=wasmExports.ts_query_predicates_for_pattern,_ts_query_start_byte_for_pattern=Module._ts_query_start_byte_for_pattern=wasmExports.ts_query_start_byte_for_pattern,_ts_query_end_byte_for_pattern=Module._ts_query_end_byte_for_pattern=wasmExports.ts_query_end_byte_for_pattern,_ts_query_is_pattern_rooted=Module._ts_query_is_pattern_rooted=wasmExports.ts_query_is_pattern_rooted,_ts_query_is_pattern_non_local=Module._ts_query_is_pattern_non_local=wasmExports.ts_query_is_pattern_non_local,_ts_query_is_pattern_guaranteed_at_step=Module._ts_query_is_pattern_guaranteed_at_step=wasmExports.ts_query_is_pattern_guaranteed_at_step,_ts_query_disable_capture=Module._ts_query_disable_capture=wasmExports.ts_query_disable_capture,_ts_query_disable_pattern=Module._ts_query_disable_pattern=wasmExports.ts_query_disable_pattern,_ts_tree_copy=Module._ts_tree_copy=wasmExports.ts_tree_copy,_ts_tree_delete=Module._ts_tree_delete=wasmExports.ts_tree_delete,_ts_init=Module._ts_init=wasmExports.ts_init,_ts_parser_new_wasm=Module._ts_parser_new_wasm=wasmExports.ts_parser_new_wasm,_ts_parser_enable_logger_wasm=Module._ts_parser_enable_logger_wasm=wasmExports.ts_parser_enable_logger_wasm,_ts_parser_parse_wasm=Module._ts_parser_parse_wasm=wasmExports.ts_parser_parse_wasm,_ts_parser_included_ranges_wasm=Module._ts_parser_included_ranges_wasm=wasmExports.ts_parser_included_ranges_wasm,_ts_language_type_is_named_wasm=Module._ts_language_type_is_named_wasm=wasmExports.ts_language_type_is_named_wasm,_ts_language_type_is_visible_wasm=Module._ts_language_type_is_visible_wasm=wasmExports.ts_language_type_is_visible_wasm,_ts_language_supertypes_wasm=Module._ts_language_supertypes_wasm=wasmExports.ts_language_supertypes_wasm,_ts_language_subtypes_wasm=Module._ts_language_subtypes_wasm=wasmExports.ts_language_subtypes_wasm,_ts_tree_root_node_wasm=Module._ts_tree_root_node_wasm=wasmExports.ts_tree_root_node_wasm,_ts_tree_root_node_with_offset_wasm=Module._ts_tree_root_node_with_offset_wasm=wasmExports.ts_tree_root_node_with_offset_wasm,_ts_tree_edit_wasm=Module._ts_tree_edit_wasm=wasmExports.ts_tree_edit_wasm,_ts_tree_included_ranges_wasm=Module._ts_tree_included_ranges_wasm=wasmExports.ts_tree_included_ranges_wasm,_ts_tree_get_changed_ranges_wasm=Module._ts_tree_get_changed_ranges_wasm=wasmExports.ts_tree_get_changed_ranges_wasm,_ts_tree_cursor_new_wasm=Module._ts_tree_cursor_new_wasm=wasmExports.ts_tree_cursor_new_wasm,_ts_tree_cursor_copy_wasm=Module._ts_tree_cursor_copy_wasm=wasmExports.ts_tree_cursor_copy_wasm,_ts_tree_cursor_delete_wasm=Module._ts_tree_cursor_delete_wasm=wasmExports.ts_tree_cursor_delete_wasm,_ts_tree_cursor_reset_wasm=Module._ts_tree_cursor_reset_wasm=wasmExports.ts_tree_cursor_reset_wasm,_ts_tree_cursor_reset_to_wasm=Module._ts_tree_cursor_reset_to_wasm=wasmExports.ts_tree_cursor_reset_to_wasm,_ts_tree_cursor_goto_first_child_wasm=Module._ts_tree_cursor_goto_first_child_wasm=wasmExports.ts_tree_cursor_goto_first_child_wasm,_ts_tree_cursor_goto_last_child_wasm=Module._ts_tree_cursor_goto_last_child_wasm=wasmExports.ts_tree_cursor_goto_last_child_wasm,_ts_tree_cursor_goto_first_child_for_index_wasm=Module._ts_tree_cursor_goto_first_child_for_index_wasm=wasmExports.ts_tree_cursor_goto_first_child_for_index_wasm,_ts_tree_cursor_goto_first_child_for_position_wasm=Module._ts_tree_cursor_goto_first_child_for_position_wasm=wasmExports.ts_tree_cursor_goto_first_child_for_position_wasm,_ts_tree_cursor_goto_next_sibling_wasm=Module._ts_tree_cursor_goto_next_sibling_wasm=wasmExports.ts_tree_cursor_goto_next_sibling_wasm,_ts_tree_cursor_goto_previous_sibling_wasm=Module._ts_tree_cursor_goto_previous_sibling_wasm=wasmExports.ts_tree_cursor_goto_previous_sibling_wasm,_ts_tree_cursor_goto_descendant_wasm=Module._ts_tree_cursor_goto_descendant_wasm=wasmExports.ts_tree_cursor_goto_descendant_wasm,_ts_tree_cursor_goto_parent_wasm=Module._ts_tree_cursor_goto_parent_wasm=wasmExports.ts_tree_cursor_goto_parent_wasm,_ts_tree_cursor_current_node_type_id_wasm=Module._ts_tree_cursor_current_node_type_id_wasm=wasmExports.ts_tree_cursor_current_node_type_id_wasm,_ts_tree_cursor_current_node_state_id_wasm=Module._ts_tree_cursor_current_node_state_id_wasm=wasmExports.ts_tree_cursor_current_node_state_id_wasm,_ts_tree_cursor_current_node_is_named_wasm=Module._ts_tree_cursor_current_node_is_named_wasm=wasmExports.ts_tree_cursor_current_node_is_named_wasm,_ts_tree_cursor_current_node_is_missing_wasm=Module._ts_tree_cursor_current_node_is_missing_wasm=wasmExports.ts_tree_cursor_current_node_is_missing_wasm,_ts_tree_cursor_current_node_id_wasm=Module._ts_tree_cursor_current_node_id_wasm=wasmExports.ts_tree_cursor_current_node_id_wasm,_ts_tree_cursor_start_position_wasm=Module._ts_tree_cursor_start_position_wasm=wasmExports.ts_tree_cursor_start_position_wasm,_ts_tree_cursor_end_position_wasm=Module._ts_tree_cursor_end_position_wasm=wasmExports.ts_tree_cursor_end_position_wasm,_ts_tree_cursor_start_index_wasm=Module._ts_tree_cursor_start_index_wasm=wasmExports.ts_tree_cursor_start_index_wasm,_ts_tree_cursor_end_index_wasm=Module._ts_tree_cursor_end_index_wasm=wasmExports.ts_tree_cursor_end_index_wasm,_ts_tree_cursor_current_field_id_wasm=Module._ts_tree_cursor_current_field_id_wasm=wasmExports.ts_tree_cursor_current_field_id_wasm,_ts_tree_cursor_current_depth_wasm=Module._ts_tree_cursor_current_depth_wasm=wasmExports.ts_tree_cursor_current_depth_wasm,_ts_tree_cursor_current_descendant_index_wasm=Module._ts_tree_cursor_current_descendant_index_wasm=wasmExports.ts_tree_cursor_current_descendant_index_wasm,_ts_tree_cursor_current_node_wasm=Module._ts_tree_cursor_current_node_wasm=wasmExports.ts_tree_cursor_current_node_wasm,_ts_node_symbol_wasm=Module._ts_node_symbol_wasm=wasmExports.ts_node_symbol_wasm,_ts_node_field_name_for_child_wasm=Module._ts_node_field_name_for_child_wasm=wasmExports.ts_node_field_name_for_child_wasm,_ts_node_field_name_for_named_child_wasm=Module._ts_node_field_name_for_named_child_wasm=wasmExports.ts_node_field_name_for_named_child_wasm,_ts_node_children_by_field_id_wasm=Module._ts_node_children_by_field_id_wasm=wasmExports.ts_node_children_by_field_id_wasm,_ts_node_first_child_for_byte_wasm=Module._ts_node_first_child_for_byte_wasm=wasmExports.ts_node_first_child_for_byte_wasm,_ts_node_first_named_child_for_byte_wasm=Module._ts_node_first_named_child_for_byte_wasm=wasmExports.ts_node_first_named_child_for_byte_wasm,_ts_node_grammar_symbol_wasm=Module._ts_node_grammar_symbol_wasm=wasmExports.ts_node_grammar_symbol_wasm,_ts_node_child_count_wasm=Module._ts_node_child_count_wasm=wasmExports.ts_node_child_count_wasm,_ts_node_named_child_count_wasm=Module._ts_node_named_child_count_wasm=wasmExports.ts_node_named_child_count_wasm,_ts_node_child_wasm=Module._ts_node_child_wasm=wasmExports.ts_node_child_wasm,_ts_node_named_child_wasm=Module._ts_node_named_child_wasm=wasmExports.ts_node_named_child_wasm,_ts_node_child_by_field_id_wasm=Module._ts_node_child_by_field_id_wasm=wasmExports.ts_node_child_by_field_id_wasm,_ts_node_next_sibling_wasm=Module._ts_node_next_sibling_wasm=wasmExports.ts_node_next_sibling_wasm,_ts_node_prev_sibling_wasm=Module._ts_node_prev_sibling_wasm=wasmExports.ts_node_prev_sibling_wasm,_ts_node_next_named_sibling_wasm=Module._ts_node_next_named_sibling_wasm=wasmExports.ts_node_next_named_sibling_wasm,_ts_node_prev_named_sibling_wasm=Module._ts_node_prev_named_sibling_wasm=wasmExports.ts_node_prev_named_sibling_wasm,_ts_node_descendant_count_wasm=Module._ts_node_descendant_count_wasm=wasmExports.ts_node_descendant_count_wasm,_ts_node_parent_wasm=Module._ts_node_parent_wasm=wasmExports.ts_node_parent_wasm,_ts_node_child_with_descendant_wasm=Module._ts_node_child_with_descendant_wasm=wasmExports.ts_node_child_with_descendant_wasm,_ts_node_descendant_for_index_wasm=Module._ts_node_descendant_for_index_wasm=wasmExports.ts_node_descendant_for_index_wasm,_ts_node_named_descendant_for_index_wasm=Module._ts_node_named_descendant_for_index_wasm=wasmExports.ts_node_named_descendant_for_index_wasm,_ts_node_descendant_for_position_wasm=Module._ts_node_descendant_for_position_wasm=wasmExports.ts_node_descendant_for_position_wasm,_ts_node_named_descendant_for_position_wasm=Module._ts_node_named_descendant_for_position_wasm=wasmExports.ts_node_named_descendant_for_position_wasm,_ts_node_start_point_wasm=Module._ts_node_start_point_wasm=wasmExports.ts_node_start_point_wasm,_ts_node_end_point_wasm=Module._ts_node_end_point_wasm=wasmExports.ts_node_end_point_wasm,_ts_node_start_index_wasm=Module._ts_node_start_index_wasm=wasmExports.ts_node_start_index_wasm,_ts_node_end_index_wasm=Module._ts_node_end_index_wasm=wasmExports.ts_node_end_index_wasm,_ts_node_to_string_wasm=Module._ts_node_to_string_wasm=wasmExports.ts_node_to_string_wasm,_ts_node_children_wasm=Module._ts_node_children_wasm=wasmExports.ts_node_children_wasm,_ts_node_named_children_wasm=Module._ts_node_named_children_wasm=wasmExports.ts_node_named_children_wasm,_ts_node_descendants_of_type_wasm=Module._ts_node_descendants_of_type_wasm=wasmExports.ts_node_descendants_of_type_wasm,_ts_node_is_named_wasm=Module._ts_node_is_named_wasm=wasmExports.ts_node_is_named_wasm,_ts_node_has_changes_wasm=Module._ts_node_has_changes_wasm=wasmExports.ts_node_has_changes_wasm,_ts_node_has_error_wasm=Module._ts_node_has_error_wasm=wasmExports.ts_node_has_error_wasm,_ts_node_is_error_wasm=Module._ts_node_is_error_wasm=wasmExports.ts_node_is_error_wasm,_ts_node_is_missing_wasm=Module._ts_node_is_missing_wasm=wasmExports.ts_node_is_missing_wasm,_ts_node_is_extra_wasm=Module._ts_node_is_extra_wasm=wasmExports.ts_node_is_extra_wasm,_ts_node_parse_state_wasm=Module._ts_node_parse_state_wasm=wasmExports.ts_node_parse_state_wasm,_ts_node_next_parse_state_wasm=Module._ts_node_next_parse_state_wasm=wasmExports.ts_node_next_parse_state_wasm,_ts_query_matches_wasm=Module._ts_query_matches_wasm=wasmExports.ts_query_matches_wasm,_ts_query_captures_wasm=Module._ts_query_captures_wasm=wasmExports.ts_query_captures_wasm,_memset=Module._memset=wasmExports.memset,_memcpy=Module._memcpy=wasmExports.memcpy,_memmove=Module._memmove=wasmExports.memmove,_iswalpha=Module._iswalpha=wasmExports.iswalpha,_iswblank=Module._iswblank=wasmExports.iswblank,_iswdigit=Module._iswdigit=wasmExports.iswdigit,_iswlower=Module._iswlower=wasmExports.iswlower,_iswupper=Module._iswupper=wasmExports.iswupper,_iswxdigit=Module._iswxdigit=wasmExports.iswxdigit,_memchr=Module._memchr=wasmExports.memchr,_strlen=Module._strlen=wasmExports.strlen,_strcmp=Module._strcmp=wasmExports.strcmp,_strncat=Module._strncat=wasmExports.strncat,_strncpy=Module._strncpy=wasmExports.strncpy,_towlower=Module._towlower=wasmExports.towlower,_towupper=Module._towupper=wasmExports.towupper,_setThrew=wasmExports.setThrew,__emscripten_stack_restore=wasmExports._emscripten_stack_restore,__emscripten_stack_alloc=wasmExports._emscripten_stack_alloc,_emscripten_stack_get_current=wasmExports.emscripten_stack_get_current,___wasm_apply_data_relocs=wasmExports.__wasm_apply_data_relocs;Module.setValue=setValue,Module.getValue=getValue,Module.UTF8ToString=UTF8ToString,Module.stringToUTF8=stringToUTF8,Module.lengthBytesUTF8=lengthBytesUTF8,Module.AsciiToString=AsciiToString,Module.stringToUTF16=stringToUTF16,Module.loadWebAssemblyModule=loadWebAssemblyModule;function callMain(t=[]){var e=resolveGlobalSymbol("main").sym;if(e){t.unshift(thisProgram);var r=t.length,n=stackAlloc((r+1)*4),a=n;t.forEach(o=>{LE_HEAP_STORE_U32((a>>2)*4,stringToUTF8OnStack(o)),a+=4}),LE_HEAP_STORE_U32((a>>2)*4,0);try{var s=e(r,n);return exitJS(s,!0),s}catch(o){return handleException(o)}}}__name(callMain,"callMain");function run(t=arguments_){if(runDependencies>0){dependenciesFulfilled=run;return}if(preRun(),runDependencies>0){dependenciesFulfilled=run;return}function e(){if(Module.calledRun=!0,!ABORT){initRuntime(),preMain(),readyPromiseResolve(Module),Module.onRuntimeInitialized?.();var r=Module.noInitialRun;r||callMain(t),postRun()}}__name(e,"doRun"),Module.setStatus?(Module.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>Module.setStatus(""),1),e()},1)):e()}if(__name(run,"run"),Module.preInit)for(typeof Module.preInit=="function"&&(Module.preInit=[Module.preInit]);Module.preInit.length>0;)Module.preInit.pop()();return run(),moduleRtn=readyPromise,moduleRtn}})();typeof exports=="object"&&typeof module=="object"?(module.exports=Module,module.exports.default=Module):typeof define=="function"&&define.amd&&define([],()=>Module)}}),index_exports={};__export(index_exports,{CaptureQuantifier:()=>CaptureQuantifier,LANGUAGE_VERSION:()=>LANGUAGE_VERSION,Language:()=>Language,LookaheadIterator:()=>LookaheadIterator,MIN_COMPATIBLE_VERSION:()=>MIN_COMPATIBLE_VERSION,Node:()=>Node,Parser:()=>Parser,Query:()=>Query,Tree:()=>Tree,TreeCursor:()=>TreeCursor});module.exports=__toCommonJS(index_exports);var SIZE_OF_SHORT=2,SIZE_OF_INT=4,SIZE_OF_CURSOR=4*SIZE_OF_INT,SIZE_OF_NODE=5*SIZE_OF_INT,SIZE_OF_POINT=2*SIZE_OF_INT,SIZE_OF_RANGE=2*SIZE_OF_INT+2*SIZE_OF_POINT,ZERO_POINT={row:0,column:0},INTERNAL=Symbol("INTERNAL");function assertInternal(t){if(t!==INTERNAL)throw new Error("Illegal constructor")}__name(assertInternal,"assertInternal");function isPoint(t){return!!t&&typeof t.row=="number"&&typeof t.column=="number"}__name(isPoint,"isPoint");function setModule(t){C=t}__name(setModule,"setModule");var C,LookaheadIterator=class{static{__name(this,"LookaheadIterator")}0=0;language;constructor(t,e,r){assertInternal(t),this[0]=e,this.language=r}get currentTypeId(){return C._ts_lookahead_iterator_current_symbol(this[0])}get currentType(){return this.language.types[this.currentTypeId]||"ERROR"}delete(){C._ts_lookahead_iterator_delete(this[0]),this[0]=0}reset(t,e){return C._ts_lookahead_iterator_reset(this[0],t[0],e)?(this.language=t,!0):!1}resetState(t){return!!C._ts_lookahead_iterator_reset_state(this[0],t)}[Symbol.iterator](){return{next:__name(()=>C._ts_lookahead_iterator_next(this[0])?{done:!1,value:this.currentType}:{done:!0,value:""},"next")}}};function getText(t,e,r,n){let a=r-e,s=t.textCallback(e,n);if(s){for(e+=s.length;e<r;){let o=t.textCallback(e,n);if(o&&o.length>0)e+=o.length,s+=o;else break}e>r&&(s=s.slice(0,a))}return s??""}__name(getText,"getText");var Tree=class Bb{static{__name(this,"Tree")}0=0;textCallback;language;constructor(e,r,n,a){assertInternal(e),this[0]=r,this.language=n,this.textCallback=a}copy(){let e=C._ts_tree_copy(this[0]);return new Bb(INTERNAL,e,this.language,this.textCallback)}delete(){C._ts_tree_delete(this[0]),this[0]=0}get rootNode(){return C._ts_tree_root_node_wasm(this[0]),unmarshalNode(this)}rootNodeWithOffset(e,r){let n=TRANSFER_BUFFER+SIZE_OF_NODE;return C.setValue(n,e,"i32"),marshalPoint(n+SIZE_OF_INT,r),C._ts_tree_root_node_with_offset_wasm(this[0]),unmarshalNode(this)}edit(e){marshalEdit(e),C._ts_tree_edit_wasm(this[0])}walk(){return this.rootNode.walk()}getChangedRanges(e){if(!(e instanceof Bb))throw new TypeError("Argument must be a Tree");C._ts_tree_get_changed_ranges_wasm(this[0],e[0]);let r=C.getValue(TRANSFER_BUFFER,"i32"),n=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),a=new Array(r);if(r>0){let s=n;for(let o=0;o<r;o++)a[o]=unmarshalRange(s),s+=SIZE_OF_RANGE;C._free(n)}return a}getIncludedRanges(){C._ts_tree_included_ranges_wasm(this[0]);let e=C.getValue(TRANSFER_BUFFER,"i32"),r=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),n=new Array(e);if(e>0){let a=r;for(let s=0;s<e;s++)n[s]=unmarshalRange(a),a+=SIZE_OF_RANGE;C._free(r)}return n}},TreeCursor=class jF{static{__name(this,"TreeCursor")}0=0;1=0;2=0;3=0;tree;constructor(e,r){assertInternal(e),this.tree=r,unmarshalTreeCursor(this)}copy(){let e=new jF(INTERNAL,this.tree);return C._ts_tree_cursor_copy_wasm(this.tree[0]),unmarshalTreeCursor(e),e}delete(){marshalTreeCursor(this),C._ts_tree_cursor_delete_wasm(this.tree[0]),this[0]=this[1]=this[2]=0}get currentNode(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_wasm(this.tree[0]),unmarshalNode(this.tree)}get currentFieldId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_field_id_wasm(this.tree[0])}get currentFieldName(){return this.tree.language.fields[this.currentFieldId]}get currentDepth(){return marshalTreeCursor(this),C._ts_tree_cursor_current_depth_wasm(this.tree[0])}get currentDescendantIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_current_descendant_index_wasm(this.tree[0])}get nodeType(){return this.tree.language.types[this.nodeTypeId]||"ERROR"}get nodeTypeId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_type_id_wasm(this.tree[0])}get nodeStateId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_state_id_wasm(this.tree[0])}get nodeId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_id_wasm(this.tree[0])}get nodeIsNamed(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_is_named_wasm(this.tree[0])===1}get nodeIsMissing(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_is_missing_wasm(this.tree[0])===1}get nodeText(){marshalTreeCursor(this);let e=C._ts_tree_cursor_start_index_wasm(this.tree[0]),r=C._ts_tree_cursor_end_index_wasm(this.tree[0]);C._ts_tree_cursor_start_position_wasm(this.tree[0]);let n=unmarshalPoint(TRANSFER_BUFFER);return getText(this.tree,e,r,n)}get startPosition(){return marshalTreeCursor(this),C._ts_tree_cursor_start_position_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get endPosition(){return marshalTreeCursor(this),C._ts_tree_cursor_end_position_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get startIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_start_index_wasm(this.tree[0])}get endIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_end_index_wasm(this.tree[0])}gotoFirstChild(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_first_child_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoLastChild(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_last_child_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoParent(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_parent_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoNextSibling(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_next_sibling_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoPreviousSibling(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_previous_sibling_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoDescendant(e){marshalTreeCursor(this),C._ts_tree_cursor_goto_descendant_wasm(this.tree[0],e),unmarshalTreeCursor(this)}gotoFirstChildForIndex(e){marshalTreeCursor(this),C.setValue(TRANSFER_BUFFER+SIZE_OF_CURSOR,e,"i32");let r=C._ts_tree_cursor_goto_first_child_for_index_wasm(this.tree[0]);return unmarshalTreeCursor(this),r===1}gotoFirstChildForPosition(e){marshalTreeCursor(this),marshalPoint(TRANSFER_BUFFER+SIZE_OF_CURSOR,e);let r=C._ts_tree_cursor_goto_first_child_for_position_wasm(this.tree[0]);return unmarshalTreeCursor(this),r===1}reset(e){marshalNode(e),marshalTreeCursor(this,TRANSFER_BUFFER+SIZE_OF_NODE),C._ts_tree_cursor_reset_wasm(this.tree[0]),unmarshalTreeCursor(this)}resetTo(e){marshalTreeCursor(this,TRANSFER_BUFFER),marshalTreeCursor(e,TRANSFER_BUFFER+SIZE_OF_CURSOR),C._ts_tree_cursor_reset_to_wasm(this.tree[0],e.tree[0]),unmarshalTreeCursor(this)}},Node=class{static{__name(this,"Node")}0=0;_children;_namedChildren;constructor(t,{id:e,tree:r,startIndex:n,startPosition:a,other:s}){assertInternal(t),this[0]=s,this.id=e,this.tree=r,this.startIndex=n,this.startPosition=a}id;startIndex;startPosition;tree;get typeId(){return marshalNode(this),C._ts_node_symbol_wasm(this.tree[0])}get grammarId(){return marshalNode(this),C._ts_node_grammar_symbol_wasm(this.tree[0])}get type(){return this.tree.language.types[this.typeId]||"ERROR"}get grammarType(){return this.tree.language.types[this.grammarId]||"ERROR"}get isNamed(){return marshalNode(this),C._ts_node_is_named_wasm(this.tree[0])===1}get isExtra(){return marshalNode(this),C._ts_node_is_extra_wasm(this.tree[0])===1}get isError(){return marshalNode(this),C._ts_node_is_error_wasm(this.tree[0])===1}get isMissing(){return marshalNode(this),C._ts_node_is_missing_wasm(this.tree[0])===1}get hasChanges(){return marshalNode(this),C._ts_node_has_changes_wasm(this.tree[0])===1}get hasError(){return marshalNode(this),C._ts_node_has_error_wasm(this.tree[0])===1}get endIndex(){return marshalNode(this),C._ts_node_end_index_wasm(this.tree[0])}get endPosition(){return marshalNode(this),C._ts_node_end_point_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get text(){return getText(this.tree,this.startIndex,this.endIndex,this.startPosition)}get parseState(){return marshalNode(this),C._ts_node_parse_state_wasm(this.tree[0])}get nextParseState(){return marshalNode(this),C._ts_node_next_parse_state_wasm(this.tree[0])}equals(t){return this.tree===t.tree&&this.id===t.id}child(t){return marshalNode(this),C._ts_node_child_wasm(this.tree[0],t),unmarshalNode(this.tree)}namedChild(t){return marshalNode(this),C._ts_node_named_child_wasm(this.tree[0],t),unmarshalNode(this.tree)}childForFieldId(t){return marshalNode(this),C._ts_node_child_by_field_id_wasm(this.tree[0],t),unmarshalNode(this.tree)}childForFieldName(t){let e=this.tree.language.fields.indexOf(t);return e!==-1?this.childForFieldId(e):null}fieldNameForChild(t){marshalNode(this);let e=C._ts_node_field_name_for_child_wasm(this.tree[0],t);return e?C.AsciiToString(e):null}fieldNameForNamedChild(t){marshalNode(this);let e=C._ts_node_field_name_for_named_child_wasm(this.tree[0],t);return e?C.AsciiToString(e):null}childrenForFieldName(t){let e=this.tree.language.fields.indexOf(t);return e!==-1&&e!==0?this.childrenForFieldId(e):[]}childrenForFieldId(t){marshalNode(this),C._ts_node_children_by_field_id_wasm(this.tree[0],t);let e=C.getValue(TRANSFER_BUFFER,"i32"),r=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),n=new Array(e);if(e>0){let a=r;for(let s=0;s<e;s++)n[s]=unmarshalNode(this.tree,a),a+=SIZE_OF_NODE;C._free(r)}return n}firstChildForIndex(t){marshalNode(this);let e=TRANSFER_BUFFER+SIZE_OF_NODE;return C.setValue(e,t,"i32"),C._ts_node_first_child_for_byte_wasm(this.tree[0]),unmarshalNode(this.tree)}firstNamedChildForIndex(t){marshalNode(this);let e=TRANSFER_BUFFER+SIZE_OF_NODE;return C.setValue(e,t,"i32"),C._ts_node_first_named_child_for_byte_wasm(this.tree[0]),unmarshalNode(this.tree)}get childCount(){return marshalNode(this),C._ts_node_child_count_wasm(this.tree[0])}get namedChildCount(){return marshalNode(this),C._ts_node_named_child_count_wasm(this.tree[0])}get firstChild(){return this.child(0)}get firstNamedChild(){return this.namedChild(0)}get lastChild(){return this.child(this.childCount-1)}get lastNamedChild(){return this.namedChild(this.namedChildCount-1)}get children(){if(!this._children){marshalNode(this),C._ts_node_children_wasm(this.tree[0]);let t=C.getValue(TRANSFER_BUFFER,"i32"),e=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32");if(this._children=new Array(t),t>0){let r=e;for(let n=0;n<t;n++)this._children[n]=unmarshalNode(this.tree,r),r+=SIZE_OF_NODE;C._free(e)}}return this._children}get namedChildren(){if(!this._namedChildren){marshalNode(this),C._ts_node_named_children_wasm(this.tree[0]);let t=C.getValue(TRANSFER_BUFFER,"i32"),e=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32");if(this._namedChildren=new Array(t),t>0){let r=e;for(let n=0;n<t;n++)this._namedChildren[n]=unmarshalNode(this.tree,r),r+=SIZE_OF_NODE;C._free(e)}}return this._namedChildren}descendantsOfType(t,e=ZERO_POINT,r=ZERO_POINT){Array.isArray(t)||(t=[t]);let n=[],a=this.tree.language.types;for(let c of t)c=="ERROR"&&n.push(65535);for(let c=0,f=a.length;c<f;c++)t.includes(a[c])&&n.push(c);let s=C._malloc(SIZE_OF_INT*n.length);for(let c=0,f=n.length;c<f;c++)C.setValue(s+c*SIZE_OF_INT,n[c],"i32");marshalNode(this),C._ts_node_descendants_of_type_wasm(this.tree[0],s,n.length,e.row,e.column,r.row,r.column);let o=C.getValue(TRANSFER_BUFFER,"i32"),l=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),u=new Array(o);if(o>0){let c=l;for(let f=0;f<o;f++)u[f]=unmarshalNode(this.tree,c),c+=SIZE_OF_NODE}return C._free(l),C._free(s),u}get nextSibling(){return marshalNode(this),C._ts_node_next_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get previousSibling(){return marshalNode(this),C._ts_node_prev_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get nextNamedSibling(){return marshalNode(this),C._ts_node_next_named_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get previousNamedSibling(){return marshalNode(this),C._ts_node_prev_named_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get descendantCount(){return marshalNode(this),C._ts_node_descendant_count_wasm(this.tree[0])}get parent(){return marshalNode(this),C._ts_node_parent_wasm(this.tree[0]),unmarshalNode(this.tree)}childWithDescendant(t){return marshalNode(this),marshalNode(t),C._ts_node_child_with_descendant_wasm(this.tree[0]),unmarshalNode(this.tree)}descendantForIndex(t,e=t){if(typeof t!="number"||typeof e!="number")throw new Error("Arguments must be numbers");marshalNode(this);let r=TRANSFER_BUFFER+SIZE_OF_NODE;return C.setValue(r,t,"i32"),C.setValue(r+SIZE_OF_INT,e,"i32"),C._ts_node_descendant_for_index_wasm(this.tree[0]),unmarshalNode(this.tree)}namedDescendantForIndex(t,e=t){if(typeof t!="number"||typeof e!="number")throw new Error("Arguments must be numbers");marshalNode(this);let r=TRANSFER_BUFFER+SIZE_OF_NODE;return C.setValue(r,t,"i32"),C.setValue(r+SIZE_OF_INT,e,"i32"),C._ts_node_named_descendant_for_index_wasm(this.tree[0]),unmarshalNode(this.tree)}descendantForPosition(t,e=t){if(!isPoint(t)||!isPoint(e))throw new Error("Arguments must be {row, column} objects");marshalNode(this);let r=TRANSFER_BUFFER+SIZE_OF_NODE;return marshalPoint(r,t),marshalPoint(r+SIZE_OF_POINT,e),C._ts_node_descendant_for_position_wasm(this.tree[0]),unmarshalNode(this.tree)}namedDescendantForPosition(t,e=t){if(!isPoint(t)||!isPoint(e))throw new Error("Arguments must be {row, column} objects");marshalNode(this);let r=TRANSFER_BUFFER+SIZE_OF_NODE;return marshalPoint(r,t),marshalPoint(r+SIZE_OF_POINT,e),C._ts_node_named_descendant_for_position_wasm(this.tree[0]),unmarshalNode(this.tree)}walk(){return marshalNode(this),C._ts_tree_cursor_new_wasm(this.tree[0]),new TreeCursor(INTERNAL,this.tree)}edit(t){if(this.startIndex>=t.oldEndIndex){this.startIndex=t.newEndIndex+(this.startIndex-t.oldEndIndex);let e,r;this.startPosition.row>t.oldEndPosition.row?(e=this.startPosition.row-t.oldEndPosition.row,r=this.startPosition.column):(e=0,r=this.startPosition.column,this.startPosition.column>=t.oldEndPosition.column&&(r=this.startPosition.column-t.oldEndPosition.column)),e>0?(this.startPosition.row+=e,this.startPosition.column=r):this.startPosition.column+=r}else this.startIndex>t.startIndex&&(this.startIndex=t.newEndIndex,this.startPosition.row=t.newEndPosition.row,this.startPosition.column=t.newEndPosition.column)}toString(){marshalNode(this);let t=C._ts_node_to_string_wasm(this.tree[0]),e=C.AsciiToString(t);return C._free(t),e}};function unmarshalCaptures(t,e,r,n,a){for(let s=0,o=a.length;s<o;s++){let l=C.getValue(r,"i32");r+=SIZE_OF_INT;let u=unmarshalNode(e,r);r+=SIZE_OF_NODE,a[s]={patternIndex:n,name:t.captureNames[l],node:u}}return r}__name(unmarshalCaptures,"unmarshalCaptures");function marshalNode(t){let e=TRANSFER_BUFFER;C.setValue(e,t.id,"i32"),e+=SIZE_OF_INT,C.setValue(e,t.startIndex,"i32"),e+=SIZE_OF_INT,C.setValue(e,t.startPosition.row,"i32"),e+=SIZE_OF_INT,C.setValue(e,t.startPosition.column,"i32"),e+=SIZE_OF_INT,C.setValue(e,t[0],"i32")}__name(marshalNode,"marshalNode");function unmarshalNode(t,e=TRANSFER_BUFFER){let r=C.getValue(e,"i32");if(e+=SIZE_OF_INT,r===0)return null;let n=C.getValue(e,"i32");e+=SIZE_OF_INT;let a=C.getValue(e,"i32");e+=SIZE_OF_INT;let s=C.getValue(e,"i32");e+=SIZE_OF_INT;let o=C.getValue(e,"i32");return new Node(INTERNAL,{id:r,tree:t,startIndex:n,startPosition:{row:a,column:s},other:o})}__name(unmarshalNode,"unmarshalNode");function marshalTreeCursor(t,e=TRANSFER_BUFFER){C.setValue(e+0*SIZE_OF_INT,t[0],"i32"),C.setValue(e+1*SIZE_OF_INT,t[1],"i32"),C.setValue(e+2*SIZE_OF_INT,t[2],"i32"),C.setValue(e+3*SIZE_OF_INT,t[3],"i32")}__name(marshalTreeCursor,"marshalTreeCursor");function unmarshalTreeCursor(t){t[0]=C.getValue(TRANSFER_BUFFER+0*SIZE_OF_INT,"i32"),t[1]=C.getValue(TRANSFER_BUFFER+1*SIZE_OF_INT,"i32"),t[2]=C.getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),t[3]=C.getValue(TRANSFER_BUFFER+3*SIZE_OF_INT,"i32")}__name(unmarshalTreeCursor,"unmarshalTreeCursor");function marshalPoint(t,e){C.setValue(t,e.row,"i32"),C.setValue(t+SIZE_OF_INT,e.column,"i32")}__name(marshalPoint,"marshalPoint");function unmarshalPoint(t){return{row:C.getValue(t,"i32")>>>0,column:C.getValue(t+SIZE_OF_INT,"i32")>>>0}}__name(unmarshalPoint,"unmarshalPoint");function marshalRange(t,e){marshalPoint(t,e.startPosition),t+=SIZE_OF_POINT,marshalPoint(t,e.endPosition),t+=SIZE_OF_POINT,C.setValue(t,e.startIndex,"i32"),t+=SIZE_OF_INT,C.setValue(t,e.endIndex,"i32"),t+=SIZE_OF_INT}__name(marshalRange,"marshalRange");function unmarshalRange(t){let e={};return e.startPosition=unmarshalPoint(t),t+=SIZE_OF_POINT,e.endPosition=unmarshalPoint(t),t+=SIZE_OF_POINT,e.startIndex=C.getValue(t,"i32")>>>0,t+=SIZE_OF_INT,e.endIndex=C.getValue(t,"i32")>>>0,e}__name(unmarshalRange,"unmarshalRange");function marshalEdit(t,e=TRANSFER_BUFFER){marshalPoint(e,t.startPosition),e+=SIZE_OF_POINT,marshalPoint(e,t.oldEndPosition),e+=SIZE_OF_POINT,marshalPoint(e,t.newEndPosition),e+=SIZE_OF_POINT,C.setValue(e,t.startIndex,"i32"),e+=SIZE_OF_INT,C.setValue(e,t.oldEndIndex,"i32"),e+=SIZE_OF_INT,C.setValue(e,t.newEndIndex,"i32"),e+=SIZE_OF_INT}__name(marshalEdit,"marshalEdit");function unmarshalLanguageMetadata(t){let e={};return e.major_version=C.getValue(t,"i32"),t+=SIZE_OF_INT,e.minor_version=C.getValue(t,"i32"),t+=SIZE_OF_INT,e.field_count=C.getValue(t,"i32"),e}__name(unmarshalLanguageMetadata,"unmarshalLanguageMetadata");var PREDICATE_STEP_TYPE_CAPTURE=1,PREDICATE_STEP_TYPE_STRING=2,QUERY_WORD_REGEX=/[\w-]+/g,CaptureQuantifier={Zero:0,ZeroOrOne:1,ZeroOrMore:2,One:3,OneOrMore:4},isCaptureStep=__name(t=>t.type==="capture","isCaptureStep"),isStringStep=__name(t=>t.type==="string","isStringStep"),QueryErrorKind={Syntax:1,NodeName:2,FieldName:3,CaptureName:4,PatternStructure:5},QueryError=class YF extends Error{constructor(e,r,n,a){super(YF.formatMessage(e,r)),this.kind=e,this.info=r,this.index=n,this.length=a,this.name="QueryError"}static{__name(this,"QueryError")}static formatMessage(e,r){switch(e){case QueryErrorKind.NodeName:return`Bad node name '${r.word}'`;case QueryErrorKind.FieldName:return`Bad field name '${r.word}'`;case QueryErrorKind.CaptureName:return`Bad capture name @${r.word}`;case QueryErrorKind.PatternStructure:return`Bad pattern structure at offset ${r.suffix}`;case QueryErrorKind.Syntax:return`Bad syntax at offset ${r.suffix}`}}};function parseAnyPredicate(t,e,r,n){if(t.length!==3)throw new Error(`Wrong number of arguments to \`#${r}\` predicate. Expected 2, got ${t.length-1}`);if(!isCaptureStep(t[1]))throw new Error(`First argument of \`#${r}\` predicate must be a capture. Got "${t[1].value}"`);let a=r==="eq?"||r==="any-eq?",s=!r.startsWith("any-");if(isCaptureStep(t[2])){let o=t[1].name,l=t[2].name;n[e].push(u=>{let c=[],f=[];for(let d of u)d.name===o&&c.push(d.node),d.name===l&&f.push(d.node);let h=__name((d,p,g)=>g?d.text===p.text:d.text!==p.text,"compare");return s?c.every(d=>f.some(p=>h(d,p,a))):c.some(d=>f.some(p=>h(d,p,a)))})}else{let o=t[1].name,l=t[2].value,u=__name(f=>f.text===l,"matches"),c=__name(f=>f.text!==l,"doesNotMatch");n[e].push(f=>{let h=[];for(let p of f)p.name===o&&h.push(p.node);let d=a?u:c;return s?h.every(d):h.some(d)})}}__name(parseAnyPredicate,"parseAnyPredicate");function parseMatchPredicate(t,e,r,n){if(t.length!==3)throw new Error(`Wrong number of arguments to \`#${r}\` predicate. Expected 2, got ${t.length-1}.`);if(t[1].type!=="capture")throw new Error(`First argument of \`#${r}\` predicate must be a capture. Got "${t[1].value}".`);if(t[2].type!=="string")throw new Error(`Second argument of \`#${r}\` predicate must be a string. Got @${t[2].name}.`);let a=r==="match?"||r==="any-match?",s=!r.startsWith("any-"),o=t[1].name,l=new RegExp(t[2].value);n[e].push(u=>{let c=[];for(let h of u)h.name===o&&c.push(h.node.text);let f=__name((h,d)=>d?l.test(h):!l.test(h),"test");return c.length===0?!a:s?c.every(h=>f(h,a)):c.some(h=>f(h,a))})}__name(parseMatchPredicate,"parseMatchPredicate");function parseAnyOfPredicate(t,e,r,n){if(t.length<2)throw new Error(`Wrong number of arguments to \`#${r}\` predicate. Expected at least 1. Got ${t.length-1}.`);if(t[1].type!=="capture")throw new Error(`First argument of \`#${r}\` predicate must be a capture. Got "${t[1].value}".`);let a=r==="any-of?",s=t[1].name,o=t.slice(2);if(!o.every(isStringStep))throw new Error(`Arguments to \`#${r}\` predicate must be strings.".`);let l=o.map(u=>u.value);n[e].push(u=>{let c=[];for(let f of u)f.name===s&&c.push(f.node.text);return c.length===0?!a:c.every(f=>l.includes(f))===a})}__name(parseAnyOfPredicate,"parseAnyOfPredicate");function parseIsPredicate(t,e,r,n,a){if(t.length<2||t.length>3)throw new Error(`Wrong number of arguments to \`#${r}\` predicate. Expected 1 or 2. Got ${t.length-1}.`);if(!t.every(isStringStep))throw new Error(`Arguments to \`#${r}\` predicate must be strings.".`);let s=r==="is?"?n:a;s[e]||(s[e]={}),s[e][t[1].value]=t[2]?.value??null}__name(parseIsPredicate,"parseIsPredicate");function parseSetDirective(t,e,r){if(t.length<2||t.length>3)throw new Error(`Wrong number of arguments to \`#set!\` predicate. Expected 1 or 2. Got ${t.length-1}.`);if(!t.every(isStringStep))throw new Error('Arguments to `#set!` predicate must be strings.".');r[e]||(r[e]={}),r[e][t[1].value]=t[2]?.value??null}__name(parseSetDirective,"parseSetDirective");function parsePattern(t,e,r,n,a,s,o,l,u,c,f){if(e===PREDICATE_STEP_TYPE_CAPTURE){let h=n[r];s.push({type:"capture",name:h})}else if(e===PREDICATE_STEP_TYPE_STRING)s.push({type:"string",value:a[r]});else if(s.length>0){if(s[0].type!=="string")throw new Error("Predicates must begin with a literal value");let h=s[0].value;switch(h){case"any-not-eq?":case"not-eq?":case"any-eq?":case"eq?":parseAnyPredicate(s,t,h,o);break;case"any-not-match?":case"not-match?":case"any-match?":case"match?":parseMatchPredicate(s,t,h,o);break;case"not-any-of?":case"any-of?":parseAnyOfPredicate(s,t,h,o);break;case"is?":case"is-not?":parseIsPredicate(s,t,h,c,f);break;case"set!":parseSetDirective(s,t,u);break;default:l[t].push({operator:h,operands:s.slice(1)})}s.length=0}}__name(parsePattern,"parsePattern");var Query=class{static{__name(this,"Query")}0=0;exceededMatchLimit;textPredicates;captureNames;captureQuantifiers;predicates;setProperties;assertedProperties;refutedProperties;matchLimit;constructor(t,e){let r=C.lengthBytesUTF8(e),n=C._malloc(r+1);C.stringToUTF8(e,n,r+1);let a=C._ts_query_new(t[0],n,r,TRANSFER_BUFFER,TRANSFER_BUFFER+SIZE_OF_INT);if(!a){let v=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),y=C.getValue(TRANSFER_BUFFER,"i32"),b=C.UTF8ToString(n,y).length,w=e.slice(b,b+100).split(`
`)[0],_=w.match(QUERY_WORD_REGEX)?.[0]??"";switch(C._free(n),v){case QueryErrorKind.Syntax:throw new QueryError(QueryErrorKind.Syntax,{suffix:`${b}: '${w}'...`},b,0);case QueryErrorKind.NodeName:throw new QueryError(v,{word:_},b,_.length);case QueryErrorKind.FieldName:throw new QueryError(v,{word:_},b,_.length);case QueryErrorKind.CaptureName:throw new QueryError(v,{word:_},b,_.length);case QueryErrorKind.PatternStructure:throw new QueryError(v,{suffix:`${b}: '${w}'...`},b,0)}}let s=C._ts_query_string_count(a),o=C._ts_query_capture_count(a),l=C._ts_query_pattern_count(a),u=new Array(o),c=new Array(l),f=new Array(s);for(let v=0;v<o;v++){let y=C._ts_query_capture_name_for_id(a,v,TRANSFER_BUFFER),b=C.getValue(TRANSFER_BUFFER,"i32");u[v]=C.UTF8ToString(y,b)}for(let v=0;v<l;v++){let y=new Array(o);for(let b=0;b<o;b++){let w=C._ts_query_capture_quantifier_for_id(a,v,b);y[b]=w}c[v]=y}for(let v=0;v<s;v++){let y=C._ts_query_string_value_for_id(a,v,TRANSFER_BUFFER),b=C.getValue(TRANSFER_BUFFER,"i32");f[v]=C.UTF8ToString(y,b)}let h=new Array(l),d=new Array(l),p=new Array(l),g=new Array(l),m=new Array(l);for(let v=0;v<l;v++){let y=C._ts_query_predicates_for_pattern(a,v,TRANSFER_BUFFER),b=C.getValue(TRANSFER_BUFFER,"i32");g[v]=[],m[v]=[];let w=new Array,_=y;for(let x=0;x<b;x++){let S=C.getValue(_,"i32");_+=SIZE_OF_INT;let E=C.getValue(_,"i32");_+=SIZE_OF_INT,parsePattern(v,S,E,u,f,w,m,g,h,d,p)}Object.freeze(m[v]),Object.freeze(g[v]),Object.freeze(h[v]),Object.freeze(d[v]),Object.freeze(p[v])}C._free(n),this[0]=a,this.captureNames=u,this.captureQuantifiers=c,this.textPredicates=m,this.predicates=g,this.setProperties=h,this.assertedProperties=d,this.refutedProperties=p,this.exceededMatchLimit=!1}delete(){C._ts_query_delete(this[0]),this[0]=0}matches(t,e={}){let r=e.startPosition??ZERO_POINT,n=e.endPosition??ZERO_POINT,a=e.startIndex??0,s=e.endIndex??0,o=e.matchLimit??4294967295,l=e.maxStartDepth??4294967295,u=e.timeoutMicros??0,c=e.progressCallback;if(typeof o!="number")throw new Error("Arguments must be numbers");if(this.matchLimit=o,s!==0&&a>s)throw new Error("`startIndex` cannot be greater than `endIndex`");if(n!==ZERO_POINT&&(r.row>n.row||r.row===n.row&&r.column>n.column))throw new Error("`startPosition` cannot be greater than `endPosition`");c&&(C.currentQueryProgressCallback=c),marshalNode(t),C._ts_query_matches_wasm(this[0],t.tree[0],r.row,r.column,n.row,n.column,a,s,o,l,u);let f=C.getValue(TRANSFER_BUFFER,"i32"),h=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),d=C.getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),p=new Array(f);this.exceededMatchLimit=!!d;let g=0,m=h;for(let v=0;v<f;v++){let y=C.getValue(m,"i32");m+=SIZE_OF_INT;let b=C.getValue(m,"i32");m+=SIZE_OF_INT;let w=new Array(b);if(m=unmarshalCaptures(this,t.tree,m,y,w),this.textPredicates[y].every(_=>_(w))){p[g]={pattern:y,patternIndex:y,captures:w};let _=this.setProperties[y];p[g].setProperties=_;let x=this.assertedProperties[y];p[g].assertedProperties=x;let S=this.refutedProperties[y];p[g].refutedProperties=S,g++}}return p.length=g,C._free(h),C.currentQueryProgressCallback=null,p}captures(t,e={}){let r=e.startPosition??ZERO_POINT,n=e.endPosition??ZERO_POINT,a=e.startIndex??0,s=e.endIndex??0,o=e.matchLimit??4294967295,l=e.maxStartDepth??4294967295,u=e.timeoutMicros??0,c=e.progressCallback;if(typeof o!="number")throw new Error("Arguments must be numbers");if(this.matchLimit=o,s!==0&&a>s)throw new Error("`startIndex` cannot be greater than `endIndex`");if(n!==ZERO_POINT&&(r.row>n.row||r.row===n.row&&r.column>n.column))throw new Error("`startPosition` cannot be greater than `endPosition`");c&&(C.currentQueryProgressCallback=c),marshalNode(t),C._ts_query_captures_wasm(this[0],t.tree[0],r.row,r.column,n.row,n.column,a,s,o,l,u);let f=C.getValue(TRANSFER_BUFFER,"i32"),h=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),d=C.getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),p=new Array;this.exceededMatchLimit=!!d;let g=new Array,m=h;for(let v=0;v<f;v++){let y=C.getValue(m,"i32");m+=SIZE_OF_INT;let b=C.getValue(m,"i32");m+=SIZE_OF_INT;let w=C.getValue(m,"i32");if(m+=SIZE_OF_INT,g.length=b,m=unmarshalCaptures(this,t.tree,m,y,g),this.textPredicates[y].every(_=>_(g))){let _=g[w],x=this.setProperties[y];_.setProperties=x;let S=this.assertedProperties[y];_.assertedProperties=S;let E=this.refutedProperties[y];_.refutedProperties=E,p.push(_)}}return C._free(h),C.currentQueryProgressCallback=null,p}predicatesForPattern(t){return this.predicates[t]}disableCapture(t){let e=C.lengthBytesUTF8(t),r=C._malloc(e+1);C.stringToUTF8(t,r,e+1),C._ts_query_disable_capture(this[0],r,e),C._free(r)}disablePattern(t){if(t>=this.predicates.length)throw new Error(`Pattern index is ${t} but the pattern count is ${this.predicates.length}`);C._ts_query_disable_pattern(this[0],t)}didExceedMatchLimit(){return this.exceededMatchLimit}startIndexForPattern(t){if(t>=this.predicates.length)throw new Error(`Pattern index is ${t} but the pattern count is ${this.predicates.length}`);return C._ts_query_start_byte_for_pattern(this[0],t)}endIndexForPattern(t){if(t>=this.predicates.length)throw new Error(`Pattern index is ${t} but the pattern count is ${this.predicates.length}`);return C._ts_query_end_byte_for_pattern(this[0],t)}patternCount(){return C._ts_query_pattern_count(this[0])}captureIndexForName(t){return this.captureNames.indexOf(t)}isPatternRooted(t){return C._ts_query_is_pattern_rooted(this[0],t)===1}isPatternNonLocal(t){return C._ts_query_is_pattern_non_local(this[0],t)===1}isPatternGuaranteedAtStep(t){return C._ts_query_is_pattern_guaranteed_at_step(this[0],t)===1}},LANGUAGE_FUNCTION_REGEX=/^tree_sitter_\w+$/,Language=class ZF{static{__name(this,"Language")}0=0;types;fields;constructor(e,r){assertInternal(e),this[0]=r,this.types=new Array(C._ts_language_symbol_count(this[0]));for(let n=0,a=this.types.length;n<a;n++)C._ts_language_symbol_type(this[0],n)<2&&(this.types[n]=C.UTF8ToString(C._ts_language_symbol_name(this[0],n)));this.fields=new Array(C._ts_language_field_count(this[0])+1);for(let n=0,a=this.fields.length;n<a;n++){let s=C._ts_language_field_name_for_id(this[0],n);s!==0?this.fields[n]=C.UTF8ToString(s):this.fields[n]=null}}get name(){let e=C._ts_language_name(this[0]);return e===0?null:C.UTF8ToString(e)}get version(){return C._ts_language_version(this[0])}get abiVersion(){return C._ts_language_abi_version(this[0])}get metadata(){C._ts_language_metadata(this[0]);let e=C.getValue(TRANSFER_BUFFER,"i32"),r=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32");return e===0?null:unmarshalLanguageMetadata(r)}get fieldCount(){return this.fields.length-1}get stateCount(){return C._ts_language_state_count(this[0])}fieldIdForName(e){let r=this.fields.indexOf(e);return r!==-1?r:null}fieldNameForId(e){return this.fields[e]??null}idForNodeType(e,r){let n=C.lengthBytesUTF8(e),a=C._malloc(n+1);C.stringToUTF8(e,a,n+1);let s=C._ts_language_symbol_for_name(this[0],a,n,r?1:0);return C._free(a),s||null}get nodeTypeCount(){return C._ts_language_symbol_count(this[0])}nodeTypeForId(e){let r=C._ts_language_symbol_name(this[0],e);return r?C.UTF8ToString(r):null}nodeTypeIsNamed(e){return!!C._ts_language_type_is_named_wasm(this[0],e)}nodeTypeIsVisible(e){return!!C._ts_language_type_is_visible_wasm(this[0],e)}get supertypes(){C._ts_language_supertypes_wasm(this[0]);let e=C.getValue(TRANSFER_BUFFER,"i32"),r=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),n=new Array(e);if(e>0){let a=r;for(let s=0;s<e;s++)n[s]=C.getValue(a,"i16"),a+=SIZE_OF_SHORT}return n}subtypes(e){C._ts_language_subtypes_wasm(this[0],e);let r=C.getValue(TRANSFER_BUFFER,"i32"),n=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),a=new Array(r);if(r>0){let s=n;for(let o=0;o<r;o++)a[o]=C.getValue(s,"i16"),s+=SIZE_OF_SHORT}return a}nextState(e,r){return C._ts_language_next_state(this[0],e,r)}lookaheadIterator(e){let r=C._ts_lookahead_iterator_new(this[0],e);return r?new LookaheadIterator(INTERNAL,r,this):null}query(e){return console.warn("Language.query is deprecated. Use new Query(language, source) instead."),new Query(this,e)}static async load(e){let r;e instanceof Uint8Array?r=Promise.resolve(e):globalThis.process?.versions.node?r=Wn("fs/promises").readFile(e):r=fetch(e).then(l=>l.arrayBuffer().then(u=>{if(l.ok)return new Uint8Array(u);{let c=new TextDecoder("utf-8").decode(u);throw new Error(`Language.load failed with status ${l.status}.

${c}`)}}));let n=await C.loadWebAssemblyModule(await r,{loadAsync:!0}),a=Object.keys(n),s=a.find(l=>LANGUAGE_FUNCTION_REGEX.test(l)&&!l.includes("external_scanner_"));if(!s)throw console.log(`Couldn't find language function in WASM file. Symbols:
${JSON.stringify(a,null,2)}`),new Error("Language.load failed: no language function found in WASM file");let o=n[s]();return new ZF(INTERNAL,o)}},import_tree_sitter=__toESM(require_tree_sitter(),1),Module2=null;async function initializeBinding(t){return Module2||(Module2=await(0,import_tree_sitter.default)(t)),Module2}__name(initializeBinding,"initializeBinding");function checkModule(){return!!Module2}__name(checkModule,"checkModule");var TRANSFER_BUFFER,LANGUAGE_VERSION,MIN_COMPATIBLE_VERSION,Parser=class{static{__name(this,"Parser")}0=0;1=0;logCallback=null;language=null;static async init(t){setModule(await initializeBinding(t)),TRANSFER_BUFFER=C._ts_init(),LANGUAGE_VERSION=C.getValue(TRANSFER_BUFFER,"i32"),MIN_COMPATIBLE_VERSION=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32")}constructor(){this.initialize()}initialize(){if(!checkModule())throw new Error("cannot construct a Parser before calling `init()`");C._ts_parser_new_wasm(),this[0]=C.getValue(TRANSFER_BUFFER,"i32"),this[1]=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32")}delete(){C._ts_parser_delete(this[0]),C._free(this[1]),this[0]=0,this[1]=0}setLanguage(t){let e;if(!t)e=0,this.language=null;else if(t.constructor===Language){e=t[0];let r=C._ts_language_version(e);if(r<MIN_COMPATIBLE_VERSION||LANGUAGE_VERSION<r)throw new Error(`Incompatible language version ${r}. Compatibility range ${MIN_COMPATIBLE_VERSION} through ${LANGUAGE_VERSION}.`);this.language=t}else throw new Error("Argument must be a Language");return C._ts_parser_set_language(this[0],e),this}parse(t,e,r){if(typeof t=="string")C.currentParseCallback=l=>t.slice(l);else if(typeof t=="function")C.currentParseCallback=t;else throw new Error("Argument must be a string or a function");r?.progressCallback?C.currentProgressCallback=r.progressCallback:C.currentProgressCallback=null,this.logCallback?(C.currentLogCallback=this.logCallback,C._ts_parser_enable_logger_wasm(this[0],1)):(C.currentLogCallback=null,C._ts_parser_enable_logger_wasm(this[0],0));let n=0,a=0;if(r?.includedRanges){n=r.includedRanges.length,a=C._calloc(n,SIZE_OF_RANGE);let l=a;for(let u=0;u<n;u++)marshalRange(l,r.includedRanges[u]),l+=SIZE_OF_RANGE}let s=C._ts_parser_parse_wasm(this[0],this[1],e?e[0]:0,a,n);if(!s)return C.currentParseCallback=null,C.currentLogCallback=null,C.currentProgressCallback=null,null;if(!this.language)throw new Error("Parser must have a language to parse");let o=new Tree(INTERNAL,s,this.language,C.currentParseCallback);return C.currentParseCallback=null,C.currentLogCallback=null,C.currentProgressCallback=null,o}reset(){C._ts_parser_reset(this[0])}getIncludedRanges(){C._ts_parser_included_ranges_wasm(this[0]);let t=C.getValue(TRANSFER_BUFFER,"i32"),e=C.getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),r=new Array(t);if(t>0){let n=e;for(let a=0;a<t;a++)r[a]=unmarshalRange(n),n+=SIZE_OF_RANGE;C._free(e)}return r}getTimeoutMicros(){return C._ts_parser_timeout_micros(this[0])}setTimeoutMicros(t){C._ts_parser_set_timeout_micros(this[0],0,t)}setLogger(t){if(!t)this.logCallback=null;else{if(typeof t!="function")throw new Error("Logger callback must be a function");this.logCallback=t}return this}getLogger(){return this.logCallback}}});var $F=O(ld=>{"use strict";Object.defineProperty(ld,"__esModule",{value:!0});ld.example=void 0;ld.example=`BEGIN
  A;
  PARBEGIN
    BEGIN
      B;
      C;
    END
    BEGIN
      D;
      E;
    END
  PAREND;
  F;
END
`});var QF=O(ud=>{"use strict";Object.defineProperty(ud,"__esModule",{value:!0});ud.interpret=void 0;var qce=t=>{let e=[],r=(n,a=[])=>{if(!n)return[];switch(n.type){case"call":return e.push({data:{id:n.id,label:n.label}}),a.forEach(l=>{e.push({data:{source:l.id,target:n.id}})}),[n];case"seq":let s=[...a];return Array.isArray(n.child)&&n.child.forEach(l=>{s=r(l,s)}),s;case"par":let o=[];return Array.isArray(n.child)&&n.child.forEach(l=>{let u=r(l,a);o=[...o,...u]}),o;default:return a}};return r(t),e};ud.interpret=qce});var JF=O(cd=>{"use strict";Object.defineProperty(cd,"__esModule",{value:!0});cd.parse=void 0;var Vce=t=>{let e=[],r=[];for(let n=0;n<t.rootNode.childCount;n++)switch(t.rootNode.child(n).type){case"begin":{e.push("begin"),r.push("[");break}case"end":{e.pop()!=="begin"&&console.log("error"),r.push("]");break}case"parbegin":{e.push("parbegin"),r.push("(");break}case"parend":{e.pop()!=="parbegin"&&console.log("error"),r.push(")");break}case"call":{r.push(t.rootNode.child(n).child(0).text);break}}return r};cd.parse=Vce});var eq=O(fd=>{"use strict";Object.defineProperty(fd,"__esModule",{value:!0});fd.stackify=void 0;var zce=t=>{let e=[],r=[];for(let n of t)if(n==="["){let a={type:"seq",child:r};e.push(a),r=[]}else if(n==="("){let a={type:"par",child:r};e.push(a),r=[]}else if(n==="]"||n===")"){let a=e.pop(),s={type:a.type,child:r};r=a.child,r.push(s)}else r.push({type:"call",id:crypto.randomUUID(),label:n});return r[0]};fd.stackify=zce});var $ce=O(hd=>{var iq=hd&&hd.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(hd,"__esModule",{value:!0});var aq=xi(),Hce=OS(),sq=iq(ZA()),Uce=iq(KF()),Lb=XF(),tq=$F(),Wce=QF(),Gce=JF(),Kce=eq();sq.default.use(Uce.default);var jce=document.getElementById("editor"),Yce=document.getElementById("treeContainer"),Zce,Nb,rq,oq=t=>{let e=Nb.parse(t),r=(0,Gce.parse)(e),n=(0,Kce.stackify)(r),a=(0,Wce.interpret)(n);(0,sq.default)({container:Yce,elements:a,layout:{name:"dagre"},style:[{selector:"node",css:{label:"data(label)"}}]})},Xce=aq.EditorView.updateListener.of(t=>{if(t.docChanged){let e=t.state.doc.toString();document.location.hash=encodeURI(e),oq(e)}}),nq=decodeURI(document.location.hash.substring(1));(async()=>(await Lb.Parser.init(),Nb=new Lb.Parser,rq=await Lb.Language.load("tree-sitter-parbeginparend.wasm"),Nb.setLanguage(rq),Zce=new aq.EditorView({extensions:[Hce.basicSetup,Xce],parent:jce,doc:nq||tq.example}),oq(tq.example)))()});$ce();})();
/*! Bundled license information:

cytoscape/dist/cytoscape.cjs.js:
  (*!
  Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
  Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
  Licensed under The MIT License (http://opensource.org/licenses/MIT)
  *)
  (*!
  Event object based on jQuery events, MIT license
  
  https://jquery.org/license/
  https://tldrlegal.com/license/mit-license
  https://github.com/jquery/jquery/blob/master/src/event.js
  *)
  (*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License *)
  (*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License *)
*/
