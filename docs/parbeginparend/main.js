"use strict";(()=>{var Id=Object.defineProperty;var uz=Object.getOwnPropertyDescriptor;var hz=Object.getOwnPropertyNames;var fz=Object.prototype.hasOwnProperty;var is=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var Nd=(r,e)=>()=>(r&&(e=r(r=0)),e);var B=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),cz=(r,e)=>{for(var t in e)Id(r,t,{get:e[t],enumerable:!0})},dz=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of hz(e))!fz.call(r,i)&&i!==t&&Id(r,i,{get:()=>e[i],enumerable:!(n=uz(e,i))||n.enumerable});return r};var pz=r=>dz(Id({},"__esModule",{value:!0}),r);var Ow=B(_d=>{"use strict";var Fd=[],Aw=[];(()=>{let r="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<r.length;e++)(e%2?Aw:Fd).push(t=t+r[e])})();function Mw(r){if(r<768)return!1;for(let e=0,t=Fd.length;;){let n=e+t>>1;if(r<Fd[n])t=n;else if(r>=Aw[n])e=n+1;else return!0;if(e==t)return!1}}function kw(r){return r>=127462&&r<=127487}var Ew=8205;function gz(r,e,t=!0,n=!0){return(t?Dw:vz)(r,e,n)}function Dw(r,e,t){if(e==r.length)return e;e&&Pw(r.charCodeAt(e))&&Bw(r.charCodeAt(e-1))&&e--;let n=qd(r,e);for(e+=Tw(n);e<r.length;){let i=qd(r,e);if(n==Ew||i==Ew||t&&Mw(i))e+=Tw(i),n=i;else if(kw(i)){let a=0,s=e-2;for(;s>=0&&kw(qd(r,s));)a++,s-=2;if(a%2==0)break;e+=2}else break}return e}function vz(r,e,t){for(;e>0;){let n=Dw(r,e-2,t);if(n<e)return n;e--}return 0}function qd(r,e){let t=r.charCodeAt(e);if(!Bw(t)||e+1==r.length)return t;let n=r.charCodeAt(e+1);return Pw(n)?(t-55296<<10)+(n-56320)+65536:t}function Pw(r){return r>=56320&&r<57344}function Bw(r){return r>=55296&&r<56320}function Tw(r){return r<65536?1:2}_d.findClusterBreak=gz;_d.isExtendingChar=Mw});var bi=B(De=>{"use strict";var mz=Ow(),Rt=class r{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,n){[e,t]=ls(this,e,t);let i=[];return this.decompose(0,e,i,2),n.length&&n.decompose(0,n.length,i,3),this.decompose(t,this.length,i,1),as.from(i,this.length-(t-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=ls(this,e,t);let n=[];return this.decompose(e,t,n,0),as.from(n,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),i=new ua(this),a=new ua(e);for(let s=t,o=t;;){if(i.next(s),a.next(s),s=0,i.lineBreak!=a.lineBreak||i.done!=a.done||i.value!=a.value)return!1;if(o+=i.value.length,i.done||o>=n)return!0}}iter(e=1){return new ua(this,e)}iterRange(e,t=this.length){return new Qu(this,e,t)}iterLines(e,t){let n;if(e==null)n=this.iter();else{t==null&&(t=this.lines+1);let i=this.line(e).from;n=this.iterRange(i,Math.max(i,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new Ju(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?r.empty:e.length<=32?new qr(e):as.from(qr.split(e,[]))}},qr=class r extends Rt{constructor(e,t=yz(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,n,i){for(let a=0;;a++){let s=this.text[a],o=i+s.length;if((t?n:o)>=e)return new eh(i,o,n,s);i=o+1,n++}}decompose(e,t,n,i){let a=e<=0&&t>=this.length?this:new r(Rw(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(i&1){let s=n.pop(),o=Zu(a.text,s.text.slice(),0,a.length);if(o.length<=32)n.push(new r(o,s.length+a.length));else{let l=o.length>>1;n.push(new r(o.slice(0,l)),new r(o.slice(l)))}}else n.push(a)}replace(e,t,n){if(!(n instanceof r))return super.replace(e,t,n);[e,t]=ls(this,e,t);let i=Zu(this.text,Zu(n.text,Rw(this.text,0,e)),t),a=this.length+n.length-(t-e);return i.length<=32?new r(i,a):as.from(r.split(i,[]),a)}sliceString(e,t=this.length,n=`
`){[e,t]=ls(this,e,t);let i="";for(let a=0,s=0;a<=t&&s<this.text.length;s++){let o=this.text[s],l=a+o.length;a>e&&s&&(i+=n),e<l&&t>a&&(i+=o.slice(Math.max(0,e-a),t-a)),a=l+1}return i}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let n=[],i=-1;for(let a of e)n.push(a),i+=a.length+1,n.length==32&&(t.push(new r(n,i)),n=[],i=-1);return i>-1&&t.push(new r(n,i)),t}},as=class r extends Rt{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,t,n,i){for(let a=0;;a++){let s=this.children[a],o=i+s.length,l=n+s.lines-1;if((t?l:o)>=e)return s.lineInner(e,t,n,i);i=o+1,n=l+1}}decompose(e,t,n,i){for(let a=0,s=0;s<=t&&a<this.children.length;a++){let o=this.children[a],l=s+o.length;if(e<=l&&t>=s){let u=i&((s<=e?1:0)|(l>=t?2:0));s>=e&&l<=t&&!u?n.push(o):o.decompose(e-s,t-s,n,u)}s=l+1}}replace(e,t,n){if([e,t]=ls(this,e,t),n.lines<this.lines)for(let i=0,a=0;i<this.children.length;i++){let s=this.children[i],o=a+s.length;if(e>=a&&t<=o){let l=s.replace(e-a,t-a,n),u=this.lines-s.lines+l.lines;if(l.lines<u>>4&&l.lines>u>>6){let h=this.children.slice();return h[i]=l,new r(h,this.length-(t-e)+n.length)}return super.replace(a,o,l)}a=o+1}return super.replace(e,t,n)}sliceString(e,t=this.length,n=`
`){[e,t]=ls(this,e,t);let i="";for(let a=0,s=0;a<this.children.length&&s<=t;a++){let o=this.children[a],l=s+o.length;s>e&&a&&(i+=n),e<l&&t>s&&(i+=o.sliceString(e-s,t-s,n)),s=l+1}return i}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof r))return 0;let n=0,[i,a,s,o]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=t,a+=t){if(i==s||a==o)return n;let l=this.children[i],u=e.children[a];if(l!=u)return n+l.scanIdentical(u,t);n+=l.length+1}}static from(e,t=e.reduce((n,i)=>n+i.length+1,-1)){let n=0;for(let d of e)n+=d.lines;if(n<32){let d=[];for(let p of e)p.flatten(d);return new qr(d,t)}let i=Math.max(32,n>>5),a=i<<1,s=i>>1,o=[],l=0,u=-1,h=[];function f(d){let p;if(d.lines>a&&d instanceof r)for(let g of d.children)f(g);else d.lines>s&&(l>s||!l)?(c(),o.push(d)):d instanceof qr&&l&&(p=h[h.length-1])instanceof qr&&d.lines+p.lines<=32?(l+=d.lines,u+=d.length+1,h[h.length-1]=new qr(p.text.concat(d.text),p.length+1+d.length)):(l+d.lines>i&&c(),l+=d.lines,u+=d.length+1,h.push(d))}function c(){l!=0&&(o.push(h.length==1?h[0]:r.from(h,u)),u=-1,l=h.length=0)}for(let d of e)f(d);return c(),o.length==1?o[0]:new r(o,t)}};Rt.empty=new qr([""],0);function yz(r){let e=-1;for(let t of r)e+=t.length+1;return e}function Zu(r,e,t=0,n=1e9){for(let i=0,a=0,s=!0;a<r.length&&i<=n;a++){let o=r[a],l=i+o.length;l>=t&&(l>n&&(o=o.slice(0,n-i)),i<t&&(o=o.slice(t-i)),s?(e[e.length-1]+=o,s=!1):e.push(o)),i=l+1}return e}function Rw(r,e,t){return Zu(r,[""],e,t)}var ua=class{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof qr?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,i=this.nodes[n],a=this.offsets[n],s=a>>1,o=i instanceof qr?i.text.length:i.children.length;if(s==(t>0?o:0)){if(n==0)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((a&1)==(t>0?0:1)){if(this.offsets[n]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(i instanceof qr){let l=i.text[s+(t<0?-1:0)];if(this.offsets[n]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=i.children[s+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof qr?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}},Qu=class{constructor(e,t,n){this.value="",this.done=!1,this.cursor=new ua(e,t>n?-1:1),this.pos=t>n?e.length:0,this.from=Math.min(t,n),this.to=Math.max(t,n)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*t,this.value=i.length<=n?i:t<0?i.slice(i.length-n):i.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}},Ju=class{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:n,value:i}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}};typeof Symbol<"u"&&(Rt.prototype[Symbol.iterator]=function(){return this.iter()},ua.prototype[Symbol.iterator]=Qu.prototype[Symbol.iterator]=Ju.prototype[Symbol.iterator]=function(){return this});var eh=class{constructor(e,t,n,i){this.from=e,this.to=t,this.number=n,this.text=i}get length(){return this.to-this.from}};function ls(r,e,t){return e=Math.max(0,Math.min(r.length,e)),[e,Math.max(e,Math.min(r.length,t))]}function Eo(r,e,t=!0,n=!0){return mz.findClusterBreak(r,e,t,n)}function bz(r){return r>=56320&&r<57344}function wz(r){return r>=55296&&r<56320}function xz(r,e){let t=r.charCodeAt(e);if(!wz(t)||e+1==r.length)return t;let n=r.charCodeAt(e+1);return bz(n)?(t-55296<<10)+(n-56320)+65536:t}function Sz(r){return r<=65535?String.fromCharCode(r):(r-=65536,String.fromCharCode((r>>10)+55296,(r&1023)+56320))}function Cz(r){return r<65536?1:2}var Vd=/\r\n?|\n/;De.MapMode=void 0;(function(r){r[r.Simple=0]="Simple",r[r.TrackDel=1]="TrackDel",r[r.TrackBefore=2]="TrackBefore",r[r.TrackAfter=3]="TrackAfter"})(De.MapMode||(De.MapMode={}));var mi=class r{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,n=0,i=0;t<this.sections.length;){let a=this.sections[t++],s=this.sections[t++];s<0?(e(n,i,a),i+=a):i+=s,n+=a}}iterChangedRanges(e,t=!1){Hd(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let n=this.sections[t++],i=this.sections[t++];i<0?e.push(n,i):e.push(i,n)}return new r(e)}composeDesc(e){return this.empty?e:e.empty?this:Fw(this,e)}mapDesc(e,t=!1){return e.empty?this:Wd(this,e,t)}mapPos(e,t=-1,n=De.MapMode.Simple){let i=0,a=0;for(let s=0;s<this.sections.length;){let o=this.sections[s++],l=this.sections[s++],u=i+o;if(l<0){if(u>e)return a+(e-i);a+=o}else{if(n!=De.MapMode.Simple&&u>=e&&(n==De.MapMode.TrackDel&&i<e&&u>e||n==De.MapMode.TrackBefore&&i<e||n==De.MapMode.TrackAfter&&u>e))return null;if(u>e||u==e&&t<0&&!o)return e==i||t<0?a:a+l;a+=l}i=u}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return a}touchesRange(e,t=e){for(let n=0,i=0;n<this.sections.length&&i<=t;){let a=this.sections[n++],s=this.sections[n++],o=i+a;if(s>=0&&i<=t&&o>=e)return i<e&&o>t?"cover":!0;i=o}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let n=this.sections[t++],i=this.sections[t++];e+=(e?" ":"")+n+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new r(e)}static create(e){return new r(e)}},hn=class r extends mi{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Hd(this,(t,n,i,a,s)=>e=e.replace(i,i+(n-t),s),!1),e}mapDesc(e,t=!1){return Wd(this,e,t,!0)}invert(e){let t=this.sections.slice(),n=[];for(let i=0,a=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o>=0){t[i]=o,t[i+1]=s;let l=i>>1;for(;n.length<l;)n.push(Rt.empty);n.push(s?e.slice(a,a+s):Rt.empty)}a+=s}return new r(t,n)}compose(e){return this.empty?e:e.empty?this:Fw(this,e,!0)}map(e,t=!1){return e.empty?this:Wd(this,e,t,!0)}iterChanges(e,t=!1){Hd(this,e,t)}get desc(){return mi.create(this.sections)}filter(e){let t=[],n=[],i=[],a=new ha(this);e:for(let s=0,o=0;;){let l=s==e.length?1e9:e[s++];for(;o<l||o==l&&a.len==0;){if(a.done)break e;let h=Math.min(a.len,l-o);lr(i,h,-1);let f=a.ins==-1?-1:a.off==0?a.ins:0;lr(t,h,f),f>0&&vi(n,t,a.text),a.forward(h),o+=h}let u=e[s++];for(;o<u;){if(a.done)break e;let h=Math.min(a.len,u-o);lr(t,h,-1),lr(i,h,a.ins==-1?-1:a.off==0?a.ins:0),a.forward(h),o+=h}}return{changes:new r(t,n),filtered:mi.create(i)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t],i=this.sections[t+1];i<0?e.push(n):i==0?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,n){let i=[],a=[],s=0,o=null;function l(h=!1){if(!h&&!i.length)return;s<t&&lr(i,t-s,-1);let f=new r(i,a);o=o?o.compose(f.map(o)):f,i=[],a=[],s=0}function u(h){if(Array.isArray(h))for(let f of h)u(f);else if(h instanceof r){if(h.length!=t)throw new RangeError(`Mismatched change set length (got ${h.length}, expected ${t})`);l(),o=o?o.compose(h.map(o)):h}else{let{from:f,to:c=f,insert:d}=h;if(f>c||f<0||c>t)throw new RangeError(`Invalid change range ${f} to ${c} (in doc of length ${t})`);let p=d?typeof d=="string"?Rt.of(d.split(n||Vd)):d:Rt.empty,g=p.length;if(f==c&&g==0)return;f<s&&l(),f>s&&lr(i,f-s,-1),lr(i,c-f,g),vi(a,i,p),s=c}}return u(e),l(!o),o}static empty(e){return new r(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],n=[];for(let i=0;i<e.length;i++){let a=e[i];if(typeof a=="number")t.push(a,-1);else{if(!Array.isArray(a)||typeof a[0]!="number"||a.some((s,o)=>o&&typeof s!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(a.length==1)t.push(a[0],0);else{for(;n.length<i;)n.push(Rt.empty);n[i]=Rt.of(a.slice(1)),t.push(a[0],n[i].length)}}}return new r(t,n)}static createSet(e,t){return new r(e,t)}};function lr(r,e,t,n=!1){if(e==0&&t<=0)return;let i=r.length-2;i>=0&&t<=0&&t==r[i+1]?r[i]+=e:i>=0&&e==0&&r[i]==0?r[i+1]+=t:n?(r[i]+=e,r[i+1]+=t):r.push(e,t)}function vi(r,e,t){if(t.length==0)return;let n=e.length-2>>1;if(n<r.length)r[r.length-1]=r[r.length-1].append(t);else{for(;r.length<n;)r.push(Rt.empty);r.push(t)}}function Hd(r,e,t){let n=r.inserted;for(let i=0,a=0,s=0;s<r.sections.length;){let o=r.sections[s++],l=r.sections[s++];if(l<0)i+=o,a+=o;else{let u=i,h=a,f=Rt.empty;for(;u+=o,h+=l,l&&n&&(f=f.append(n[s-2>>1])),!(t||s==r.sections.length||r.sections[s+1]<0);)o=r.sections[s++],l=r.sections[s++];e(i,u,a,h,f),i=u,a=h}}}function Wd(r,e,t,n=!1){let i=[],a=n?[]:null,s=new ha(r),o=new ha(e);for(let l=-1;;){if(s.done&&o.len||o.done&&s.len)throw new Error("Mismatched change set lengths");if(s.ins==-1&&o.ins==-1){let u=Math.min(s.len,o.len);lr(i,u,-1),s.forward(u),o.forward(u)}else if(o.ins>=0&&(s.ins<0||l==s.i||s.off==0&&(o.len<s.len||o.len==s.len&&!t))){let u=o.len;for(lr(i,o.ins,-1);u;){let h=Math.min(s.len,u);s.ins>=0&&l<s.i&&s.len<=h&&(lr(i,0,s.ins),a&&vi(a,i,s.text),l=s.i),s.forward(h),u-=h}o.next()}else if(s.ins>=0){let u=0,h=s.len;for(;h;)if(o.ins==-1){let f=Math.min(h,o.len);u+=f,h-=f,o.forward(f)}else if(o.ins==0&&o.len<h)h-=o.len,o.next();else break;lr(i,u,l<s.i?s.ins:0),a&&l<s.i&&vi(a,i,s.text),l=s.i,s.forward(s.len-h)}else{if(s.done&&o.done)return a?hn.createSet(i,a):mi.create(i);throw new Error("Mismatched change set lengths")}}}function Fw(r,e,t=!1){let n=[],i=t?[]:null,a=new ha(r),s=new ha(e);for(let o=!1;;){if(a.done&&s.done)return i?hn.createSet(n,i):mi.create(n);if(a.ins==0)lr(n,a.len,0,o),a.next();else if(s.len==0&&!s.done)lr(n,0,s.ins,o),i&&vi(i,n,s.text),s.next();else{if(a.done||s.done)throw new Error("Mismatched change set lengths");{let l=Math.min(a.len2,s.len),u=n.length;if(a.ins==-1){let h=s.ins==-1?-1:s.off?0:s.ins;lr(n,l,h,o),i&&h&&vi(i,n,s.text)}else s.ins==-1?(lr(n,a.off?0:a.len,l,o),i&&vi(i,n,a.textBit(l))):(lr(n,a.off?0:a.len,s.off?0:s.ins,o),i&&!s.off&&vi(i,n,s.text));o=(a.ins>l||s.ins>=0&&s.len>l)&&(o||n.length>u),a.forward2(l),s.forward(l)}}}}var ha=class{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Rt.empty:e[t]}textBit(e){let{inserted:t}=this.set,n=this.i-2>>1;return n>=t.length&&!e?Rt.empty:t[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}},la=class r{constructor(e,t,n){this.from=e,this.to=t,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let n,i;return this.empty?n=i=e.mapPos(this.from,t):(n=e.mapPos(this.from,1),i=e.mapPos(this.to,-1)),n==this.from&&i==this.to?this:new r(n,i,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return mr.range(e,t);let n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return mr.range(this.anchor,n)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return mr.range(e.anchor,e.head)}static create(e,t,n){return new r(e,t,n)}},mr=class r{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:r.create(this.ranges.map(n=>n.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new r([this.main],0)}addRange(e,t=!0){return r.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let n=this.ranges.slice();return n[t]=e,r.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new r(e.ranges.map(t=>la.fromJSON(t)),e.main)}static single(e,t=e){return new r([r.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,i=0;i<e.length;i++){let a=e[i];if(a.empty?a.from<=n:a.from<n)return r.normalized(e.slice(),t);n=a.to}return new r(e,t)}static cursor(e,t=0,n,i){return la.create(e,e,(t==0?0:t<0?8:16)|(n==null?7:Math.min(6,n))|(i??16777215)<<6)}static range(e,t,n,i){let a=(n??16777215)<<6|(i==null?7:Math.min(6,i));return t<e?la.create(t,e,48|a):la.create(e,t,(t>e?8:0)|a)}static normalized(e,t=0){let n=e[t];e.sort((i,a)=>i.from-a.from),t=e.indexOf(n);for(let i=1;i<e.length;i++){let a=e[i],s=e[i-1];if(a.empty?a.from<=s.to:a.from<s.to){let o=s.from,l=Math.max(a.to,s.to);i<=t&&t--,e.splice(--i,2,a.anchor>a.head?r.range(l,o):r.range(o,l))}}return new r(e,t)}};function _w(r,e){for(let t of r.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}var Zd=0,Er=class r{constructor(e,t,n,i,a){this.combine=e,this.compareInput=t,this.compare=n,this.isStatic=i,this.id=Zd++,this.default=e([]),this.extensions=typeof a=="function"?a(this):a}get reader(){return this}static define(e={}){return new r(e.combine||(t=>t),e.compareInput||((t,n)=>t===n),e.compare||(e.combine?(t,n)=>t===n:Qd),!!e.static,e.enables)}of(e){return new ss([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new ss(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new ss(e,this,2,t)}from(e,t){return t||(t=n=>n),this.compute([e],n=>t(n.field(e)))}};function Qd(r,e){return r==e||r.length==e.length&&r.every((t,n)=>t===e[n])}var ss=class{constructor(e,t,n,i){this.dependencies=e,this.facet=t,this.type=n,this.value=i,this.id=Zd++}dynamicSlot(e){var t;let n=this.value,i=this.facet.compareInput,a=this.id,s=e[a]>>1,o=this.type==2,l=!1,u=!1,h=[];for(let f of this.dependencies)f=="doc"?l=!0:f=="selection"?u=!0:(((t=e[f.id])!==null&&t!==void 0?t:1)&1)==0&&h.push(e[f.id]);return{create(f){return f.values[s]=n(f),1},update(f,c){if(l&&c.docChanged||u&&(c.docChanged||c.selection)||Gd(f,h)){let d=n(f);if(o?!Lw(d,f.values[s],i):!i(d,f.values[s]))return f.values[s]=d,1}return 0},reconfigure:(f,c)=>{let d,p=c.config.address[a];if(p!=null){let g=nh(c,p);if(this.dependencies.every(v=>v instanceof Er?c.facet(v)===f.facet(v):v instanceof fa?c.field(v,!1)==f.field(v,!1):!0)||(o?Lw(d=n(f),g,i):i(d=n(f),g)))return f.values[s]=g,0}else d=n(f);return f.values[s]=d,1}}}};function Lw(r,e,t){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(!t(r[n],e[n]))return!1;return!0}function Gd(r,e){let t=!1;for(let n of e)ko(r,n)&1&&(t=!0);return t}function kz(r,e,t){let n=t.map(l=>r[l.id]),i=t.map(l=>l.type),a=n.filter(l=>!(l&1)),s=r[e.id]>>1;function o(l){let u=[];for(let h=0;h<n.length;h++){let f=nh(l,n[h]);if(i[h]==2)for(let c of f)u.push(c);else u.push(f)}return e.combine(u)}return{create(l){for(let u of n)ko(l,u);return l.values[s]=o(l),1},update(l,u){if(!Gd(l,a))return 0;let h=o(l);return e.compare(h,l.values[s])?0:(l.values[s]=h,1)},reconfigure(l,u){let h=Gd(l,n),f=u.config.facets[e.id],c=u.facet(e);if(f&&!h&&Qd(t,f))return l.values[s]=c,0;let d=o(l);return e.compare(d,c)?(l.values[s]=c,0):(l.values[s]=d,1)}}}var Yu=Er.define({static:!0}),fa=class r{constructor(e,t,n,i,a){this.id=e,this.createF=t,this.updateF=n,this.compareF=i,this.spec=a,this.provides=void 0}static define(e){let t=new r(Zd++,e.create,e.update,e.compare||((n,i)=>n===i),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(Yu).find(n=>n.field==this);return(t?.create||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:n=>(n.values[t]=this.create(n),1),update:(n,i)=>{let a=n.values[t],s=this.updateF(a,i);return this.compareF(a,s)?0:(n.values[t]=s,1)},reconfigure:(n,i)=>{let a=n.facet(Yu),s=i.facet(Yu),o;return(o=a.find(l=>l.field==this))&&o!=s.find(l=>l.field==this)?(n.values[t]=o.create(n),1):i.config.address[this.id]!=null?(n.values[t]=i.field(this),0):(n.values[t]=this.create(n),1)}}}init(e){return[this,Yu.of({field:this,create:e})]}get extension(){return this}},sa={lowest:4,low:3,default:2,high:1,highest:0};function Co(r){return e=>new th(e,r)}var Ez={highest:Co(sa.highest),high:Co(sa.high),default:Co(sa.default),low:Co(sa.low),lowest:Co(sa.lowest)},th=class{constructor(e,t){this.inner=e,this.prec=t}},To=class r{of(e){return new Ao(this,e)}reconfigure(e){return r.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}},Ao=class{constructor(e,t){this.compartment=e,this.inner=t}},rh=class r{constructor(e,t,n,i,a,s){for(this.base=e,this.compartments=t,this.dynamicSlots=n,this.address=i,this.staticValues=a,this.facets=s,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,n){let i=[],a=Object.create(null),s=new Map;for(let c of Tz(e,t,s))c instanceof fa?i.push(c):(a[c.facet.id]||(a[c.facet.id]=[])).push(c);let o=Object.create(null),l=[],u=[];for(let c of i)o[c.id]=u.length<<1,u.push(d=>c.slot(d));let h=n?.config.facets;for(let c in a){let d=a[c],p=d[0].facet,g=h&&h[c]||[];if(d.every(v=>v.type==0))if(o[p.id]=l.length<<1|1,Qd(g,d))l.push(n.facet(p));else{let v=p.combine(d.map(m=>m.value));l.push(n&&p.compare(v,n.facet(p))?n.facet(p):v)}else{for(let v of d)v.type==0?(o[v.id]=l.length<<1|1,l.push(v.value)):(o[v.id]=u.length<<1,u.push(m=>v.dynamicSlot(m)));o[p.id]=u.length<<1,u.push(v=>kz(v,p,d))}}let f=u.map(c=>c(o));return new r(e,s,f,o,l,a)}};function Tz(r,e,t){let n=[[],[],[],[],[]],i=new Map;function a(s,o){let l=i.get(s);if(l!=null){if(l<=o)return;let u=n[l].indexOf(s);u>-1&&n[l].splice(u,1),s instanceof Ao&&t.delete(s.compartment)}if(i.set(s,o),Array.isArray(s))for(let u of s)a(u,o);else if(s instanceof Ao){if(t.has(s.compartment))throw new RangeError("Duplicate use of compartment in extensions");let u=e.get(s.compartment)||s.inner;t.set(s.compartment,u),a(u,o)}else if(s instanceof th)a(s.inner,s.prec);else if(s instanceof fa)n[o].push(s),s.provides&&a(s.provides,o);else if(s instanceof ss)n[o].push(s),s.facet.extensions&&a(s.facet.extensions,sa.default);else{let u=s.extension;if(!u)throw new Error(`Unrecognized extension value in extension set (${s}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);a(u,o)}}return a(r,sa.default),n.reduce((s,o)=>s.concat(o))}function ko(r,e){if(e&1)return 2;let t=e>>1,n=r.status[t];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;r.status[t]=4;let i=r.computeSlot(r,r.config.dynamicSlots[t]);return r.status[t]=2|i}function nh(r,e){return e&1?r.config.staticValues[e>>1]:r.values[e>>1]}var zw=Er.define(),Ud=Er.define({combine:r=>r.some(e=>e),static:!0}),Vw=Er.define({combine:r=>r.length?r[0]:void 0,static:!0}),Hw=Er.define(),Ww=Er.define(),Gw=Er.define(),Uw=Er.define({combine:r=>r.length?r[0]:!1}),yi=class{constructor(e,t){this.type=e,this.value=t}static define(){return new ih}},ih=class{of(e){return new yi(this,e)}},ah=class{constructor(e){this.map=e}of(e){return new ur(this,e)}},ur=class r{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new r(this.type,t)}is(e){return this.type==e}static define(e={}){return new ah(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let n=[];for(let i of e){let a=i.map(t);a&&n.push(a)}return n}};ur.reconfigure=ur.define();ur.appendConfig=ur.define();var Fr=class r{constructor(e,t,n,i,a,s){this.startState=e,this.changes=t,this.selection=n,this.effects=i,this.annotations=a,this.scrollIntoView=s,this._doc=null,this._state=null,n&&_w(n,t.newLength),a.some(o=>o.type==r.time)||(this.annotations=a.concat(r.time.of(Date.now())))}static create(e,t,n,i,a,s){return new r(e,t,n,i,a,s)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(r.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}};Fr.time=yi.define();Fr.userEvent=yi.define();Fr.addToHistory=yi.define();Fr.remote=yi.define();function Az(r,e){let t=[];for(let n=0,i=0;;){let a,s;if(n<r.length&&(i==e.length||e[i]>=r[n]))a=r[n++],s=r[n++];else if(i<e.length)a=e[i++],s=e[i++];else return t;!t.length||t[t.length-1]<a?t.push(a,s):t[t.length-1]<s&&(t[t.length-1]=s)}}function Kw(r,e,t){var n;let i,a,s;return t?(i=e.changes,a=hn.empty(e.changes.length),s=r.changes.compose(e.changes)):(i=e.changes.map(r.changes),a=r.changes.mapDesc(e.changes,!0),s=r.changes.compose(i)),{changes:s,selection:e.selection?e.selection.map(a):(n=r.selection)===null||n===void 0?void 0:n.map(i),effects:ur.mapEffects(r.effects,i).concat(ur.mapEffects(e.effects,a)),annotations:r.annotations.length?r.annotations.concat(e.annotations):e.annotations,scrollIntoView:r.scrollIntoView||e.scrollIntoView}}function Kd(r,e,t){let n=e.selection,i=os(e.annotations);return e.userEvent&&(i=i.concat(Fr.userEvent.of(e.userEvent))),{changes:e.changes instanceof hn?e.changes:hn.of(e.changes||[],t,r.facet(Vw)),selection:n&&(n instanceof mr?n:mr.single(n.anchor,n.head)),effects:os(e.effects),annotations:i,scrollIntoView:!!e.scrollIntoView}}function jw(r,e,t){let n=Kd(r,e.length?e[0]:{},r.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let a=1;a<e.length;a++){e[a].filter===!1&&(t=!1);let s=!!e[a].sequential;n=Kw(n,Kd(r,e[a],s?n.changes.newLength:r.doc.length),s)}let i=Fr.create(r,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return Dz(t?Mz(i):i)}function Mz(r){let e=r.startState,t=!0;for(let i of e.facet(Hw)){let a=i(r);if(a===!1){t=!1;break}Array.isArray(a)&&(t=t===!0?a:Az(t,a))}if(t!==!0){let i,a;if(t===!1)a=r.changes.invertedDesc,i=hn.empty(e.doc.length);else{let s=r.changes.filter(t);i=s.changes,a=s.filtered.mapDesc(s.changes).invertedDesc}r=Fr.create(e,i,r.selection&&r.selection.map(a),ur.mapEffects(r.effects,a),r.annotations,r.scrollIntoView)}let n=e.facet(Ww);for(let i=n.length-1;i>=0;i--){let a=n[i](r);a instanceof Fr?r=a:Array.isArray(a)&&a.length==1&&a[0]instanceof Fr?r=a[0]:r=jw(e,os(a),!1)}return r}function Dz(r){let e=r.startState,t=e.facet(Gw),n=r;for(let i=t.length-1;i>=0;i--){let a=t[i](r);a&&Object.keys(a).length&&(n=Kw(n,Kd(e,a,r.changes.newLength),!0))}return n==r?r:Fr.create(e,r.changes,r.selection,n.effects,n.annotations,n.scrollIntoView)}var Pz=[];function os(r){return r==null?Pz:Array.isArray(r)?r:[r]}De.CharCategory=void 0;(function(r){r[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other"})(De.CharCategory||(De.CharCategory={}));var Bz=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,jd;try{jd=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Oz(r){if(jd)return jd.test(r);for(let e=0;e<r.length;e++){let t=r[e];if(/\w/.test(t)||t>"\x80"&&(t.toUpperCase()!=t.toLowerCase()||Bz.test(t)))return!0}return!1}function Rz(r){return e=>{if(!/\S/.test(e))return De.CharCategory.Space;if(Oz(e))return De.CharCategory.Word;for(let t=0;t<r.length;t++)if(e.indexOf(r[t])>-1)return De.CharCategory.Word;return De.CharCategory.Other}}var Yr=class r{constructor(e,t,n,i,a,s){this.config=e,this.doc=t,this.selection=n,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=a,s&&(s._state=this);for(let o=0;o<this.config.dynamicSlots.length;o++)ko(this,o<<1);this.computeSlot=null}field(e,t=!0){let n=this.config.address[e.id];if(n==null){if(t)throw new RangeError("Field is not present in this state");return}return ko(this,n),nh(this,n)}update(...e){return jw(this,e,!0)}applyTransaction(e){let t=this.config,{base:n,compartments:i}=t;for(let o of e.effects)o.is(To.reconfigure)?(t&&(i=new Map,t.compartments.forEach((l,u)=>i.set(u,l)),t=null),i.set(o.value.compartment,o.value.extension)):o.is(ur.reconfigure)?(t=null,n=o.value):o.is(ur.appendConfig)&&(t=null,n=os(n).concat(o.value));let a;t?a=e.startState.values.slice():(t=rh.resolve(n,i,this),a=new r(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(l,u)=>u.reconfigure(l,this),null).values);let s=e.startState.facet(Ud)?e.newSelection:e.newSelection.asSingle();new r(t,e.newDoc,s,a,(o,l)=>l.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:mr.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,n=e(t.ranges[0]),i=this.changes(n.changes),a=[n.range],s=os(n.effects);for(let o=1;o<t.ranges.length;o++){let l=e(t.ranges[o]),u=this.changes(l.changes),h=u.map(i);for(let c=0;c<o;c++)a[c]=a[c].map(h);let f=i.mapDesc(u,!0);a.push(l.range.map(f)),i=i.compose(h),s=ur.mapEffects(s,h).concat(ur.mapEffects(os(l.effects),f))}return{changes:i,selection:mr.create(a,t.mainIndex),effects:s}}changes(e=[]){return e instanceof hn?e:hn.of(e,this.doc.length,this.facet(r.lineSeparator))}toText(e){return Rt.of(e.split(this.facet(r.lineSeparator)||Vd))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(ko(this,t),nh(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let i=e[n];i instanceof fa&&this.config.address[i.id]!=null&&(t[n]=i.spec.toJSON(this.field(e[n]),this))}return t}static fromJSON(e,t={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(n){for(let a in n)if(Object.prototype.hasOwnProperty.call(e,a)){let s=n[a],o=e[a];i.push(s.init(l=>s.spec.fromJSON(o,l)))}}return r.create({doc:e.doc,selection:mr.fromJSON(e.selection),extensions:t.extensions?i.concat([t.extensions]):i})}static create(e={}){let t=rh.resolve(e.extensions||[],new Map),n=e.doc instanceof Rt?e.doc:Rt.of((e.doc||"").split(t.staticFacet(r.lineSeparator)||Vd)),i=e.selection?e.selection instanceof mr?e.selection:mr.single(e.selection.anchor,e.selection.head):mr.single(0);return _w(i,n.length),t.staticFacet(Ud)||(i=i.asSingle()),new r(t,n,i,t.dynamicSlots.map(()=>null),(a,s)=>s.create(a),null)}get tabSize(){return this.facet(r.tabSize)}get lineBreak(){return this.facet(r.lineSeparator)||`
`}get readOnly(){return this.facet(Uw)}phrase(e,...t){for(let n of this.facet(r.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(n,i)=>{if(i=="$")return"$";let a=+(i||1);return!a||a>t.length?n:t[a-1]})),e}languageDataAt(e,t,n=-1){let i=[];for(let a of this.facet(zw))for(let s of a(this,t,n))Object.prototype.hasOwnProperty.call(s,e)&&i.push(s[e]);return i}charCategorizer(e){return Rz(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:n,length:i}=this.doc.lineAt(e),a=this.charCategorizer(e),s=e-n,o=e-n;for(;s>0;){let l=Eo(t,s,!1);if(a(t.slice(l,s))!=De.CharCategory.Word)break;s=l}for(;o<i;){let l=Eo(t,o);if(a(t.slice(o,l))!=De.CharCategory.Word)break;o=l}return s==o?null:mr.range(s+n,o+n)}};Yr.allowMultipleSelections=Ud;Yr.tabSize=Er.define({combine:r=>r.length?r[0]:4});Yr.lineSeparator=Vw;Yr.readOnly=Uw;Yr.phrases=Er.define({compare(r,e){let t=Object.keys(r),n=Object.keys(e);return t.length==n.length&&t.every(i=>r[i]==e[i])}});Yr.languageData=zw;Yr.changeFilter=Hw;Yr.transactionFilter=Ww;Yr.transactionExtender=Gw;To.reconfigure=ur.define();function Lz(r,e,t={}){let n={};for(let i of r)for(let a of Object.keys(i)){let s=i[a],o=n[a];if(o===void 0)n[a]=s;else if(!(o===s||s===void 0))if(Object.hasOwnProperty.call(t,a))n[a]=t[a](o,s);else throw new Error("Config merge conflict for field "+a)}for(let i in e)n[i]===void 0&&(n[i]=e[i]);return n}var ca=class{eq(e){return this==e}range(e,t=e){return us.create(e,t,this)}};ca.prototype.startSide=ca.prototype.endSide=0;ca.prototype.point=!1;ca.prototype.mapMode=De.MapMode.TrackDel;var us=class r{constructor(e,t,n){this.from=e,this.to=t,this.value=n}static create(e,t,n){return new r(e,t,n)}};function Yd(r,e){return r.from-e.from||r.value.startSide-e.value.startSide}var Xd=class r{constructor(e,t,n,i){this.from=e,this.to=t,this.value=n,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,t,n,i=0){let a=n?this.to:this.from;for(let s=i,o=a.length;;){if(s==o)return s;let l=s+o>>1,u=a[l]-e||(n?this.value[l].endSide:this.value[l].startSide)-t;if(l==s)return u>=0?s:o;u>=0?o=l:s=l+1}}between(e,t,n,i){for(let a=this.findIndex(t,-1e9,!0),s=this.findIndex(n,1e9,!1,a);a<s;a++)if(i(this.from[a]+e,this.to[a]+e,this.value[a])===!1)return!1}map(e,t){let n=[],i=[],a=[],s=-1,o=-1;for(let l=0;l<this.value.length;l++){let u=this.value[l],h=this.from[l]+e,f=this.to[l]+e,c,d;if(h==f){let p=t.mapPos(h,u.startSide,u.mapMode);if(p==null||(c=d=p,u.startSide!=u.endSide&&(d=t.mapPos(h,u.endSide),d<c)))continue}else if(c=t.mapPos(h,u.startSide),d=t.mapPos(f,u.endSide),c>d||c==d&&u.startSide>0&&u.endSide<=0)continue;(d-c||u.endSide-u.startSide)<0||(s<0&&(s=c),u.point&&(o=Math.max(o,d-c)),n.push(u),i.push(c-s),a.push(d-s))}return{mapped:n.length?new r(i,a,n,o):null,pos:s}}},Yn=class r{constructor(e,t,n,i){this.chunkPos=e,this.chunk=t,this.nextLayer=n,this.maxPoint=i}static create(e,t,n,i){return new r(e,t,n,i)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:n=!1,filterFrom:i=0,filterTo:a=this.length}=e,s=e.filter;if(t.length==0&&!s)return this;if(n&&(t=t.slice().sort(Yd)),this.isEmpty)return t.length?r.of(t):this;let o=new sh(this,null,-1).goto(0),l=0,u=[],h=new Mo;for(;o.value||l<t.length;)if(l<t.length&&(o.from-t[l].from||o.startSide-t[l].value.startSide)>=0){let f=t[l++];h.addInner(f.from,f.to,f.value)||u.push(f)}else o.rangeIndex==1&&o.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(o.chunkIndex)<t[l].from)&&(!s||i>this.chunkEnd(o.chunkIndex)||a<this.chunkPos[o.chunkIndex])&&h.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!s||i>o.to||a<o.from||s(o.from,o.to,o.value))&&(h.addInner(o.from,o.to,o.value)||u.push(us.create(o.from,o.to,o.value))),o.next());return h.finishInner(this.nextLayer.isEmpty&&!u.length?r.empty:this.nextLayer.update({add:u,filter:s,filterFrom:i,filterTo:a}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],n=[],i=-1;for(let s=0;s<this.chunk.length;s++){let o=this.chunkPos[s],l=this.chunk[s],u=e.touchesRange(o,o+l.length);if(u===!1)i=Math.max(i,l.maxPoint),t.push(l),n.push(e.mapPos(o));else if(u===!0){let{mapped:h,pos:f}=l.map(o,e);h&&(i=Math.max(i,h.maxPoint),t.push(h),n.push(f))}}let a=this.nextLayer.map(e);return t.length==0?a:new r(n,t,a||r.empty,i)}between(e,t,n){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let a=this.chunkPos[i],s=this.chunk[i];if(t>=a&&e<=a+s.length&&s.between(a,e-a,t-a,n)===!1)return}this.nextLayer.between(e,t,n)}}iter(e=0){return Do.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Do.from(e).goto(t)}static compare(e,t,n,i,a=-1){let s=e.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=a),o=t.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=a),l=Iw(s,o,n),u=new oa(s,l,a),h=new oa(o,l,a);n.iterGaps((f,c,d)=>Nw(u,f,h,c,d,i)),n.empty&&n.length==0&&Nw(u,0,h,0,0,i)}static eq(e,t,n=0,i){i==null&&(i=999999999);let a=e.filter(h=>!h.isEmpty&&t.indexOf(h)<0),s=t.filter(h=>!h.isEmpty&&e.indexOf(h)<0);if(a.length!=s.length)return!1;if(!a.length)return!0;let o=Iw(a,s),l=new oa(a,o,0).goto(n),u=new oa(s,o,0).goto(n);for(;;){if(l.to!=u.to||!$d(l.active,u.active)||l.point&&(!u.point||!l.point.eq(u.point)))return!1;if(l.to>i)return!0;l.next(),u.next()}}static spans(e,t,n,i,a=-1){let s=new oa(e,null,a).goto(t),o=t,l=s.openStart;for(;;){let u=Math.min(s.to,n);if(s.point){let h=s.activeForPoint(s.to),f=s.pointFrom<t?h.length+1:s.point.startSide<0?h.length:Math.min(h.length,l);i.point(o,u,s.point,h,f,s.pointRank),l=Math.min(s.openEnd(u),h.length)}else u>o&&(i.span(o,u,s.active,l),l=s.openEnd(u));if(s.to>n)return l+(s.point&&s.to>n?1:0);o=s.to,s.next()}}static of(e,t=!1){let n=new Mo;for(let i of e instanceof us?[e]:t?Iz(e):e)n.add(i.from,i.to,i.value);return n.finish()}static join(e){if(!e.length)return r.empty;let t=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let i=e[n];i!=r.empty;i=i.nextLayer)t=new r(i.chunkPos,i.chunk,t,Math.max(i.maxPoint,t.maxPoint));return t}};Yn.empty=new Yn([],[],null,-1);function Iz(r){if(r.length>1)for(let e=r[0],t=1;t<r.length;t++){let n=r[t];if(Yd(e,n)>0)return r.slice().sort(Yd);e=n}return r}Yn.empty.nextLayer=Yn.empty;var Mo=class r{finishChunk(e){this.chunks.push(new Xd(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,n){this.addInner(e,t,n)||(this.nextLayer||(this.nextLayer=new r)).add(e,t,n)}addInner(e,t,n){let i=e-this.lastTo||n.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return i<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}finish(){return this.finishInner(Yn.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=Yn.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}};function Iw(r,e,t){let n=new Map;for(let a of r)for(let s=0;s<a.chunk.length;s++)a.chunk[s].maxPoint<=0&&n.set(a.chunk[s],a.chunkPos[s]);let i=new Set;for(let a of e)for(let s=0;s<a.chunk.length;s++){let o=n.get(a.chunk[s]);o!=null&&(t?t.mapPos(o):o)==a.chunkPos[s]&&!t?.touchesRange(o,o+a.chunk[s].length)&&i.add(a.chunk[s])}return i}var sh=class{constructor(e,t,n,i=0){this.layer=e,this.skip=t,this.minPoint=n,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){let i=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(i)||this.layer.chunkEnd(this.chunkIndex)<e||i.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}},Do=class r{constructor(e){this.heap=e}static from(e,t=null,n=-1){let i=[];for(let a=0;a<e.length;a++)for(let s=e[a];!s.isEmpty;s=s.nextLayer)s.maxPoint>=n&&i.push(new sh(s,t,n,a));return i.length==1?i[0]:new r(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let n of this.heap)n.goto(e,t);for(let n=this.heap.length>>1;n>=0;n--)zd(this.heap,n);return this.next(),this}forward(e,t){for(let n of this.heap)n.forward(e,t);for(let n=this.heap.length>>1;n>=0;n--)zd(this.heap,n);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),zd(this.heap,0)}}};function zd(r,e){for(let t=r[e];;){let n=(e<<1)+1;if(n>=r.length)break;let i=r[n];if(n+1<r.length&&i.compare(r[n+1])>=0&&(i=r[n+1],n++),t.compare(i)<0)break;r[n]=t,r[e]=i,e=n}}var oa=class{constructor(e,t,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Do.from(e,t,n)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Xu(this.active,e),Xu(this.activeTo,e),Xu(this.activeRank,e),this.minActive=qw(this.active,this.activeTo)}addActive(e){let t=0,{value:n,to:i,rank:a}=this.cursor;for(;t<this.activeRank.length&&(a-this.activeRank[t]||i-this.activeTo[t])>0;)t++;$u(this.active,t,n),$u(this.activeTo,t,i),$u(this.activeRank,t,a),e&&$u(e,t,this.cursor.from),this.minActive=qw(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>e){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),n&&Xu(n,i)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let a=this.cursor.value;if(!a.point)this.addActive(n),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=a,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=a.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let i=n.length-1;i>=0&&n[i]<e;i--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}openEnd(e){let t=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}};function Nw(r,e,t,n,i,a){r.goto(e),t.goto(n);let s=n+i,o=n,l=n-e;for(;;){let u=r.to+l-t.to,h=u||r.endSide-t.endSide,f=h<0?r.to+l:t.to,c=Math.min(f,s);if(r.point||t.point?r.point&&t.point&&(r.point==t.point||r.point.eq(t.point))&&$d(r.activeForPoint(r.to),t.activeForPoint(t.to))||a.comparePoint(o,c,r.point,t.point):c>o&&!$d(r.active,t.active)&&a.compareRange(o,c,r.active,t.active),f>s)break;(u||r.openEnd!=t.openEnd)&&a.boundChange&&a.boundChange(f),o=f,h<=0&&r.next(),h>=0&&t.next()}}function $d(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!=e[t]&&!r[t].eq(e[t]))return!1;return!0}function Xu(r,e){for(let t=e,n=r.length-1;t<n;t++)r[t]=r[t+1];r.pop()}function $u(r,e,t){for(let n=r.length-1;n>=e;n--)r[n+1]=r[n];r[e]=t}function qw(r,e){let t=-1,n=1e9;for(let i=0;i<e.length;i++)(e[i]-n||r[i].endSide-r[t].endSide)<0&&(t=i,n=e[i]);return t}function Nz(r,e,t=r.length){let n=0;for(let i=0;i<t&&i<r.length;)r.charCodeAt(i)==9?(n+=e-n%e,i++):(n++,i=Eo(r,i));return n}function qz(r,e,t,n){for(let i=0,a=0;;){if(a>=e)return i;if(i==r.length)break;a+=r.charCodeAt(i)==9?t-a%t:1,i=Eo(r,i)}return n===!0?-1:r.length}De.Annotation=yi;De.AnnotationType=ih;De.ChangeDesc=mi;De.ChangeSet=hn;De.Compartment=To;De.EditorSelection=mr;De.EditorState=Yr;De.Facet=Er;De.Line=eh;De.Prec=Ez;De.Range=us;De.RangeSet=Yn;De.RangeSetBuilder=Mo;De.RangeValue=ca;De.SelectionRange=la;De.StateEffect=ur;De.StateEffectType=ah;De.StateField=fa;De.Text=Rt;De.Transaction=Fr;De.codePointAt=xz;De.codePointSize=Cz;De.combineConfig=Lz;De.countColumn=Nz;De.findClusterBreak=Eo;De.findColumn=qz;De.fromCodePoint=Sz});var np=B(Zw=>{var Jd="\u037C",Yw=typeof Symbol>"u"?"__"+Jd:Symbol.for(Jd),ep=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Xw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{},tp=Zw.StyleModule=function(e,t){this.rules=[];var n=t||{},i=n.finish;function a(l){return/^@/.test(l)?[l]:l.split(/,\s*/)}function s(l,u,h,f){var c=[],d=/^@(\w+)\b/.exec(l[0]),p=d&&d[1]=="keyframes";if(d&&u==null)return h.push(l[0]+";");for(var g in u){var v=u[g];if(/&/.test(g))s(g.split(/,\s*/).map(function(m){return l.map(function(y){return m.replace(/&/,y)})}).reduce(function(m,y){return m.concat(y)}),v,h);else if(v&&typeof v=="object"){if(!d)throw new RangeError("The value of a property ("+g+") should be a primitive value.");s(a(g),v,c,p)}else v!=null&&c.push(g.replace(/_.*/,"").replace(/[A-Z]/g,function(m){return"-"+m.toLowerCase()})+": "+v+";")}(c.length||p)&&h.push((i&&!d&&!f?l.map(i):l).join(", ")+" {"+c.join(" ")+"}")}for(var o in e)s(a(o),e[o],this.rules)};tp.prototype.getRules=function(){return this.rules.join(`
`)};tp.newName=function(){var e=Xw[Yw]||1;return Xw[Yw]=e+1,Jd+e.toString(36)};tp.mount=function(e,t,n){var i=e[ep],a=n&&n.nonce;i?a&&i.setNonce(a):i=new rp(e,a),i.mount(Array.isArray(t)?t:[t],e)};var $w=new Map,rp=function(e,t){var n=e.ownerDocument||e,i=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&i.CSSStyleSheet){var a=$w.get(n);if(a)return e[ep]=a;this.sheet=new i.CSSStyleSheet,$w.set(n,this)}else this.styleTag=n.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[ep]=this};rp.prototype.mount=function(e,t){for(var n=this.sheet,i=0,a=0,s=0;s<e.length;s++){var o=e[s],l=this.modules.indexOf(o);if(l<a&&l>-1&&(this.modules.splice(l,1),a--,l=-1),l==-1){if(this.modules.splice(a++,0,o),n)for(var u=0;u<o.rules.length;u++)n.insertRule(o.rules[u],i++)}else{for(;a<l;)i+=this.modules[a++].rules.length;i+=o.rules.length,a++}}if(n)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet].concat(t.adoptedStyleSheets));else{for(var h="",f=0;f<this.modules.length;f++)h+=this.modules[f].getRules()+`
`;this.styleTag.textContent=h;var c=t.head||t;this.styleTag.parentNode!=c&&c.insertBefore(this.styleTag,c.firstChild)}};rp.prototype.setNonce=function(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}});var Qw=B(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});var wi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Po={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Fz=typeof navigator<"u"&&/Mac/.test(navigator.platform),_z=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(Lt=0;Lt<10;Lt++)wi[48+Lt]=wi[96+Lt]=String(Lt);var Lt;for(Lt=1;Lt<=24;Lt++)wi[Lt+111]="F"+Lt;var Lt;for(Lt=65;Lt<=90;Lt++)wi[Lt]=String.fromCharCode(Lt+32),Po[Lt]=String.fromCharCode(Lt);var Lt;for(oh in wi)Po.hasOwnProperty(oh)||(Po[oh]=wi[oh]);var oh;function zz(r){var e=Fz&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||_z&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",t=!e&&r.key||(r.shiftKey?Po:wi)[r.keyCode]||r.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}Bo.base=wi;Bo.keyName=zz;Bo.shift=Po});var Ti=B(ae=>{"use strict";var H=bi(),gs=np(),ip=Qw();function Ko(r){let e;return r.nodeType==11?e=r.getSelection?r:r.ownerDocument:e=r,e.getSelection()}function fp(r,e){return e?r==e||r.contains(e.nodeType!=1?e.parentNode:e):!1}function mh(r,e){if(!e.anchorNode)return!1;try{return fp(r,e.anchorNode)}catch{return!1}}function vs(r){return r.nodeType==3?ga(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function Fo(r,e,t,n){return t?Jw(r,e,t,n,-1)||Jw(r,e,t,n,1):!1}function pa(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e}function kh(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}function Jw(r,e,t,n,i){for(;;){if(r==t&&e==n)return!0;if(e==(i<0?0:En(r))){if(r.nodeName=="DIV")return!1;let a=r.parentNode;if(!a||a.nodeType!=1)return!1;e=pa(r)+(i<0?0:1),r=a}else if(r.nodeType==1){if(r=r.childNodes[e+(i<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;e=i<0?En(r):0}else return!1}}function En(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function tl(r,e){let t=e?r.left:r.right;return{left:t,right:t,top:r.top,bottom:r.bottom}}function Vz(r){let e=r.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function zx(r,e){let t=e.width/r.offsetWidth,n=e.height/r.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-r.offsetWidth)<1)&&(t=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-r.offsetHeight)<1)&&(n=1),{scaleX:t,scaleY:n}}function Hz(r,e,t,n,i,a,s,o){let l=r.ownerDocument,u=l.defaultView||window;for(let h=r,f=!1;h&&!f;)if(h.nodeType==1){let c,d=h==l.body,p=1,g=1;if(d)c=Vz(u);else{if(/^(fixed|sticky)$/.test(getComputedStyle(h).position)&&(f=!0),h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let y=h.getBoundingClientRect();({scaleX:p,scaleY:g}=zx(h,y)),c={left:y.left,right:y.left+h.clientWidth*p,top:y.top,bottom:y.top+h.clientHeight*g}}let v=0,m=0;if(i=="nearest")e.top<c.top?(m=e.top-(c.top+s),t>0&&e.bottom>c.bottom+m&&(m=e.bottom-c.bottom+s)):e.bottom>c.bottom&&(m=e.bottom-c.bottom+s,t<0&&e.top-m<c.top&&(m=e.top-(c.top+s)));else{let y=e.bottom-e.top,b=c.bottom-c.top;m=(i=="center"&&y<=b?e.top+y/2-b/2:i=="start"||i=="center"&&t<0?e.top-s:e.bottom-b+s)-c.top}if(n=="nearest"?e.left<c.left?(v=e.left-(c.left+a),t>0&&e.right>c.right+v&&(v=e.right-c.right+a)):e.right>c.right&&(v=e.right-c.right+a,t<0&&e.left<c.left+v&&(v=e.left-(c.left+a))):v=(n=="center"?e.left+(e.right-e.left)/2-(c.right-c.left)/2:n=="start"==o?e.left-a:e.right-(c.right-c.left)+a)-c.left,v||m)if(d)u.scrollBy(v,m);else{let y=0,b=0;if(m){let w=h.scrollTop;h.scrollTop+=m/g,b=(h.scrollTop-w)*g}if(v){let w=h.scrollLeft;h.scrollLeft+=v/p,y=(h.scrollLeft-w)*p}e={left:e.left-y,top:e.top-b,right:e.right-y,bottom:e.bottom-b},y&&Math.abs(y-v)<1&&(n="nearest"),b&&Math.abs(b-m)<1&&(i="nearest")}if(d)break;(e.top<c.top||e.bottom>c.bottom||e.left<c.left||e.right>c.right)&&(e={left:Math.max(e.left,c.left),right:Math.min(e.right,c.right),top:Math.max(e.top,c.top),bottom:Math.min(e.bottom,c.bottom)}),h=h.assignedSlot||h.parentNode}else if(h.nodeType==11)h=h.host;else break}function Wz(r){let e=r.ownerDocument,t,n;for(let i=r.parentNode;i&&!(i==e.body||t&&n);)if(i.nodeType==1)!n&&i.scrollHeight>i.clientHeight&&(n=i),!t&&i.scrollWidth>i.clientWidth&&(t=i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;return{x:t,y:n}}var cp=class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?En(t):0),n,Math.min(e.focusOffset,n?En(n):0))}set(e,t,n,i){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=i}},hs=null;function Vx(r){if(r.setActive)return r.setActive();if(hs)return r.focus(hs);let e=[];for(let t=r;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(r.focus(hs==null?{get preventScroll(){return hs={preventScroll:!0},!0}}:void 0),!hs){hs=!1;for(let t=0;t<e.length;){let n=e[t++],i=e[t++],a=e[t++];n.scrollTop!=i&&(n.scrollTop=i),n.scrollLeft!=a&&(n.scrollLeft=a)}}}var ex;function ga(r,e,t=e){let n=ex||(ex=document.createRange());return n.setEnd(r,t),n.setStart(r,e),n}function ps(r,e,t,n){let i={key:e,code:e,keyCode:t,which:t,cancelable:!0};n&&({altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey}=n);let a=new KeyboardEvent("keydown",i);a.synthetic=!0,r.dispatchEvent(a);let s=new KeyboardEvent("keyup",i);return s.synthetic=!0,r.dispatchEvent(s),a.defaultPrevented||s.defaultPrevented}function Gz(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function Hx(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}function Uz(r,e){let t=e.focusNode,n=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=n)return!1;for(n=Math.min(n,En(t));;)if(n){if(t.nodeType!=1)return!1;let i=t.childNodes[n-1];i.contentEditable=="false"?n--:(t=i,n=En(t))}else{if(t==r)return!0;n=pa(t),t=t.parentNode}}function Wx(r){return r.scrollTop>Math.max(1,r.scrollHeight-r.clientHeight-4)}function Gx(r,e){for(let t=r,n=e;;){if(t.nodeType==3&&n>0)return{node:t,offset:n};if(t.nodeType==1&&n>0){if(t.contentEditable=="false")return null;t=t.childNodes[n-1],n=En(t)}else if(t.parentNode&&!kh(t))n=pa(t),t=t.parentNode;else return null}}function Ux(r,e){for(let t=r,n=e;;){if(t.nodeType==3&&n<t.nodeValue.length)return{node:t,offset:n};if(t.nodeType==1&&n<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[n],n=0}else if(t.parentNode&&!kh(t))n=pa(t)+1,t=t.parentNode;else return null}}var yr=class r{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new r(e.parentNode,pa(e),t)}static after(e,t){return new r(e.parentNode,pa(e)+1,t)}},Jp=[],pt=class r{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let n=this.dom,i=null,a;for(let s of this.children){if(s.flags&7){if(!s.dom&&(a=i?i.nextSibling:n.firstChild)){let o=r.get(a);(!o||!o.parent&&o.canReuseDOM(s))&&s.reuseDOM(a)}s.sync(e,t),s.flags&=-8}if(a=i?i.nextSibling:n.firstChild,t&&!t.written&&t.node==n&&a!=s.dom&&(t.written=!0),s.dom.parentNode==n)for(;a&&a!=s.dom;)a=tx(a);else n.insertBefore(s.dom,a);i=s.dom}for(a=i?i.nextSibling:n.firstChild,a&&t&&t.node==n&&(t.written=!0);a;)a=tx(a)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(e,t),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let n;if(e==this.dom)n=this.dom.childNodes[t];else{let i=En(e)==0?0:t==0?-1:1;for(;;){let a=e.parentNode;if(a==this.dom)break;i==0&&a.firstChild!=a.lastChild&&(e==a.firstChild?i=-1:i=1),e=a}i<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!r.get(n);)n=n.nextSibling;if(!n)return this.length;for(let i=0,a=0;;i++){let s=this.children[i];if(s.dom==n)return a;a+=s.length+s.breakAfter}}domBoundsAround(e,t,n=0){let i=-1,a=-1,s=-1,o=-1;for(let l=0,u=n,h=n;l<this.children.length;l++){let f=this.children[l],c=u+f.length;if(u<e&&c>t)return f.domBoundsAround(e,t,u);if(c>=e&&i==-1&&(i=l,a=u),u>t&&f.dom.parentNode==this.dom){s=l,o=h;break}h=c,u=c+f.breakAfter}return{from:a,to:o<0?n+this.length:o,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=Jp){this.markDirty();for(let i=e;i<t;i++){let a=this.children[i];a.parent==this&&n.indexOf(a)<0&&a.destroy()}n.length<250?this.children.splice(e,t-e,...n):this.children=[].concat(this.children.slice(0,e),n,this.children.slice(t));for(let i=0;i<n.length;i++)n[i].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new Eh(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,n,i,a,s){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}};pt.prototype.breakAfter=0;function tx(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}var Eh=class{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}};function Kx(r,e,t,n,i,a,s,o,l){let{children:u}=r,h=u.length?u[e]:null,f=a.length?a[a.length-1]:null,c=f?f.breakAfter:s;if(!(e==n&&h&&!s&&!c&&a.length<2&&h.merge(t,i,a.length?f:null,t==0,o,l))){if(n<u.length){let d=u[n];d&&(i<d.length||d.breakAfter&&f?.breakAfter)?(e==n&&(d=d.split(i),i=0),!c&&f&&d.merge(0,i,f,!0,0,l)?a[a.length-1]=d:((i||d.children.length&&!d.children[0].length)&&d.merge(0,i,null,!1,0,l),a.push(d))):d?.breakAfter&&(f?f.breakAfter=1:s=1),n++}for(h&&(h.breakAfter=s,t>0&&(!s&&a.length&&h.merge(t,h.length,a[0],!1,o,0)?h.breakAfter=a.shift().breakAfter:(t<h.length||h.children.length&&h.children[h.children.length-1].length==0)&&h.merge(t,h.length,null,!1,o,0),e++));e<n&&a.length;)if(u[n-1].become(a[a.length-1]))n--,a.pop(),l=a.length?0:o;else if(u[e].become(a[0]))e++,a.shift(),o=a.length?0:l;else break;!a.length&&e&&n<u.length&&!u[e-1].breakAfter&&u[n].merge(0,0,u[e-1],!1,o,l)&&e--,(e<n||a.length)&&r.replaceChildren(e,n,a)}}function jx(r,e,t,n,i,a){let s=r.childCursor(),{i:o,off:l}=s.findPos(t,1),{i:u,off:h}=s.findPos(e,-1),f=e-t;for(let c of n)f+=c.length;r.length+=f,Kx(r,u,h,o,l,n,0,i,a)}var Tr=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},dp=typeof document<"u"?document:{documentElement:{style:{}}},pp=/Edge\/(\d+)/.exec(Tr.userAgent),Yx=/MSIE \d/.test(Tr.userAgent),gp=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Tr.userAgent),_h=!!(Yx||gp||pp),rx=!_h&&/gecko\/(\d+)/i.test(Tr.userAgent),ap=!_h&&/Chrome\/(\d+)/.exec(Tr.userAgent),nx="webkitFontSmoothing"in dp.documentElement.style,Xx=!_h&&/Apple Computer/.test(Tr.vendor),ix=Xx&&(/Mobile\/\w+/.test(Tr.userAgent)||Tr.maxTouchPoints>2),he={mac:ix||/Mac/.test(Tr.platform),windows:/Win/.test(Tr.platform),linux:/Linux|X11/.test(Tr.platform),ie:_h,ie_version:Yx?dp.documentMode||6:gp?+gp[1]:pp?+pp[1]:0,gecko:rx,gecko_version:rx?+(/Firefox\/(\d+)/.exec(Tr.userAgent)||[0,0])[1]:0,chrome:!!ap,chrome_version:ap?+ap[1]:0,ios:ix,android:/Android\b/.test(Tr.userAgent),webkit:nx,safari:Xx,webkit_version:nx?+(/\bAppleWebKit\/(\d+)/.exec(Tr.userAgent)||[0,0])[1]:0,tabSize:dp.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"},Kz=256,Tn=class r extends pt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,n){return this.flags&8||n&&(!(n instanceof r)||this.length-(t-e)+n.length>Kz||n.flags&8)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new r(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new yr(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return jz(this.dom,e,t)}},Ci=class r extends pt{constructor(e,t=[],n=0){super(),this.mark=e,this.children=t,this.length=n;for(let i of t)i.setParent(this)}setAttrs(e){if(Hx(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,n,i,a,s){return n&&(!(n instanceof r&&n.mark.eq(this.mark))||e&&a<=0||t<this.length&&s<=0)?!1:(jx(this,e,t,n?n.children.slice():[],a-1,s-1),this.markDirty(),!0)}split(e){let t=[],n=0,i=-1,a=0;for(let o of this.children){let l=n+o.length;l>e&&t.push(n<e?o.split(e-n):o),i<0&&n>=e&&(i=a),n=l,a++}let s=this.length-e;return this.length=e,i>-1&&(this.children.length=i,this.markDirty()),new r(this.mark,t,s)}domAtPos(e){return $x(this,e)}coordsAt(e,t){return Qx(this,e,t)}};function jz(r,e,t){let n=r.nodeValue.length;e>n&&(e=n);let i=e,a=e,s=0;e==0&&t<0||e==n&&t>=0?he.chrome||he.gecko||(e?(i--,s=1):a<n&&(a++,s=-1)):t<0?i--:a<n&&a++;let o=ga(r,i,a).getClientRects();if(!o.length)return null;let l=o[(s?s<0:t>=0)?0:o.length-1];return he.safari&&!s&&l.width==0&&(l=Array.prototype.find.call(o,u=>u.width)||l),s?tl(l,s<0):l||null}var jo=class r extends pt{static create(e,t,n){return new r(e,t,n)}constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}split(e){let t=r.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,n,i,a,s){return n&&(!(n instanceof r)||!this.widget.compare(n.widget)||e>0&&a<=0||t<this.length&&s<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}become(e){return e instanceof r&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return H.Text.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,n=t&&t.state.doc,i=this.posAtStart;return n?n.slice(i,i+this.length):H.Text.empty}domAtPos(e){return(this.length?e==0:this.side>0)?yr.before(this.dom):yr.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;let i=this.dom.getClientRects(),a=null;if(!i.length)return null;let s=this.side?this.side<0:e>0;for(let o=s?i.length-1:0;a=i[o],!(e>0?o==0:o==i.length-1||a.top<a.bottom);o+=s?-1:1);return tl(a,!s)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}},Yo=class r extends pt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof r&&e.side==this.side}split(){return new r(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?yr.before(this.dom):yr.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return H.Text.empty}get isHidden(){return!0}};Tn.prototype.children=jo.prototype.children=Yo.prototype.children=Jp;function $x(r,e){let t=r.dom,{children:n}=r,i=0;for(let a=0;i<n.length;i++){let s=n[i],o=a+s.length;if(!(o==a&&s.getSide()<=0)){if(e>a&&e<o&&s.dom.parentNode==t)return s.domAtPos(e-a);if(e<=a)break;a=o}}for(let a=i;a>0;a--){let s=n[a-1];if(s.dom.parentNode==t)return s.domAtPos(s.length)}for(let a=i;a<n.length;a++){let s=n[a];if(s.dom.parentNode==t)return s.domAtPos(0)}return new yr(t,0)}function Zx(r,e,t){let n,{children:i}=r;t>0&&e instanceof Ci&&i.length&&(n=i[i.length-1])instanceof Ci&&n.mark.eq(e.mark)?Zx(n,e.children[0],t-1):(i.push(e),e.setParent(r)),r.length+=e.length}function Qx(r,e,t){let n=null,i=-1,a=null,s=-1;function o(u,h){for(let f=0,c=0;f<u.children.length&&c<=h;f++){let d=u.children[f],p=c+d.length;p>=h&&(d.children.length?o(d,h-c):(!a||a.isHidden&&(t>0||Xz(a,d)))&&(p>h||c==p&&d.getSide()>0)?(a=d,s=h-c):(c<h||c==p&&d.getSide()<0&&!d.isHidden)&&(n=d,i=h-c)),c=p}}o(r,e);let l=(t<0?n:a)||n||a;return l?l.coordsAt(Math.max(0,l==n?i:s),t):Yz(r)}function Yz(r){let e=r.dom.lastChild;if(!e)return r.dom.getBoundingClientRect();let t=vs(e);return t[t.length-1]||null}function Xz(r,e){let t=r.coordsAt(0,1),n=e.coordsAt(0,1);return t&&n&&n.top<t.bottom}function vp(r,e){for(let t in r)t=="class"&&e.class?e.class+=" "+r.class:t=="style"&&e.style?e.style+=";"+r.style:e[t]=r[t];return e}var ax=Object.create(null);function Th(r,e,t){if(r==e)return!0;r||(r=ax),e||(e=ax);let n=Object.keys(r),i=Object.keys(e);if(n.length-(t&&n.indexOf(t)>-1?1:0)!=i.length-(t&&i.indexOf(t)>-1?1:0))return!1;for(let a of n)if(a!=t&&(i.indexOf(a)==-1||r[a]!==e[a]))return!1;return!0}function mp(r,e,t){let n=!1;if(e)for(let i in e)t&&i in t||(n=!0,i=="style"?r.style.cssText="":r.removeAttribute(i));if(t)for(let i in t)e&&e[i]==t[i]||(n=!0,i=="style"?r.style.cssText=t[i]:r.setAttribute(i,t[i]));return n}function $z(r){let e=Object.create(null);for(let t=0;t<r.attributes.length;t++){let n=r.attributes[t];e[n.name]=n.value}return e}var $n=class{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}};ae.BlockType=void 0;(function(r){r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange"})(ae.BlockType||(ae.BlockType={}));var ot=class extends H.RangeValue{constructor(e,t,n,i){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=i}get heightRelevant(){return!1}static mark(e){return new Xo(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return t+=n&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new ki(e,t,t,n,e.widget||null,!1)}static replace(e){let t=!!e.block,n,i;if(e.isBlockGap)n=-5e8,i=4e8;else{let{start:a,end:s}=Jx(e,t);n=(a?t?-3e8:-1:5e8)-1,i=(s?t?2e8:1:-6e8)+1}return new ki(e,n,i,t,e.widget||null,!0)}static line(e){return new $o(e)}static set(e,t=!1){return H.RangeSet.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}};ot.none=H.RangeSet.empty;var Xo=class r extends ot{constructor(e){let{start:t,end:n}=Jx(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,n;return this==e||e instanceof r&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((n=e.attrs)===null||n===void 0?void 0:n.class))&&Th(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}};Xo.prototype.point=!1;var $o=class r extends ot{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof r&&this.spec.class==e.spec.class&&Th(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}};$o.prototype.mapMode=H.MapMode.TrackBefore;$o.prototype.point=!0;var ki=class r extends ot{constructor(e,t,n,i,a,s){super(t,n,a,e),this.block=i,this.isReplace=s,this.mapMode=i?t<=0?H.MapMode.TrackBefore:H.MapMode.TrackAfter:H.MapMode.TrackDel}get type(){return this.startSide!=this.endSide?ae.BlockType.WidgetRange:this.startSide<=0?ae.BlockType.WidgetBefore:ae.BlockType.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof r&&Zz(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}};ki.prototype.point=!0;function Jx(r,e=!1){let{inclusiveStart:t,inclusiveEnd:n}=r;return t==null&&(t=r.inclusive),n==null&&(n=r.inclusive),{start:t??e,end:n??e}}function Zz(r,e){return r==e||!!(r&&e&&r.compare(e))}function yh(r,e,t,n=0){let i=t.length-1;i>=0&&t[i]+n>=r?t[i]=Math.max(t[i],e):t.push(r,e)}var Jt=class r extends pt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,n,i,a,s){if(n){if(!(n instanceof r))return!1;this.dom||n.transferDOM(this)}return i&&this.setDeco(n?n.attrs:null),jx(this,e,t,n?n.children.slice():[],a,s),!0}split(e){let t=new r;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:n,off:i}=this.childPos(e);i&&(t.append(this.children[n].split(i),0),this.children[n].merge(i,this.children[n].length,null,!1,0,0),n++);for(let a=n;a<this.children.length;a++)t.append(this.children[a],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Th(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){Zx(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=vp(t,this.attrs||{})),n&&(this.attrs=vp({class:n},this.attrs||{}))}domAtPos(e){return $x(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var n;this.dom?this.flags&4&&(Hx(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(mp(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let i=this.dom.lastChild;for(;i&&pt.get(i)instanceof Ci;)i=i.lastChild;if(!i||!this.length||i.nodeName!="BR"&&((n=pt.get(i))===null||n===void 0?void 0:n.isEditable)==!1&&(!he.ios||!this.children.some(a=>a instanceof Tn))){let a=document.createElement("BR");a.cmIgnore=!0,this.dom.appendChild(a)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let n of this.children){if(!(n instanceof Tn)||/[^ -~]/.test(n.text))return null;let i=vs(n.dom);if(i.length!=1)return null;e+=i[0].width,t=i[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let n=Qx(this,e,t);if(!this.children.length&&n&&this.parent){let{heightOracle:i}=this.parent.view.viewState,a=n.bottom-n.top;if(Math.abs(a-i.lineHeight)<2&&i.textHeight<a){let s=(a-i.textHeight)/2;return{top:n.top+s,bottom:n.bottom-s,left:n.left,right:n.left}}}return n}become(e){return e instanceof r&&this.children.length==0&&e.children.length==0&&Th(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let n=0,i=0;n<e.children.length;n++){let a=e.children[n],s=i+a.length;if(s>=t){if(a instanceof r)return a;if(s>t)break}i=s+a.breakAfter}return null}},da=class r extends pt{constructor(e,t,n){super(),this.widget=e,this.length=t,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,t,n,i,a,s){return n&&(!(n instanceof r)||!this.widget.compare(n.widget)||e>0&&a<=0||t<this.length&&s<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?yr.before(this.dom):yr.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let n=new r(this.widget,t,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return Jp}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):H.Text.empty}domBoundsAround(){return null}become(e){return e instanceof r&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);return n||(this.widget instanceof Zo?null:tl(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:n}=this.deco;return t==n?!1:e<0?t<0:n>0}},Zo=class extends $n{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}},_o=class r{constructor(e,t,n,i){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof da&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Jt),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(lh(new Yo(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof da)&&this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:a,lineBreak:s,done:o}=this.cursor.next(this.skip);if(this.skip=0,o)throw new Error("Ran out of text content when drawing inline views");if(s){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=a,this.textOff=0}let i=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append(lh(new Tn(this.text.slice(this.textOff,this.textOff+i)),t),n),this.atCursorPos=!0,this.textOff+=i,e-=i,n=0}}span(e,t,n,i){this.buildText(t-e,n,i),this.pos=t,this.openStart<0&&(this.openStart=i)}point(e,t,n,i,a,s){if(this.disallowBlockEffectsFor[s]&&n instanceof ki){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=t-e;if(n instanceof ki)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new da(n.widget||Ei.block,o,n));else{let l=jo.create(n.widget||Ei.inline,o,o?0:n.startSide),u=this.atCursorPos&&!l.isEditable&&a<=i.length&&(e<t||n.startSide>0),h=!l.isEditable&&(e<t||a>i.length||n.startSide<=0),f=this.getLine();this.pendingBuffer==2&&!u&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(i),u&&(f.append(lh(new Yo(1),i),a),a=i.length+Math.max(0,a-i.length)),f.append(lh(l,i),a),this.atCursorPos=h,this.pendingBuffer=h?e<t||a>i.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=i.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=a)}static build(e,t,n,i,a){let s=new r(e,t,n,a);return s.openEnd=H.RangeSet.spans(i,t,n,s),s.openStart<0&&(s.openStart=s.openEnd),s.finish(s.openEnd),s}};function lh(r,e){for(let t of e)r=new Ci(t,[r],r.length);return r}var Ei=class extends $n{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}};Ei.inline=new Ei("span");Ei.block=new Ei("div");ae.Direction=void 0;(function(r){r[r.LTR=0]="LTR",r[r.RTL=1]="RTL"})(ae.Direction||(ae.Direction={}));var va=ae.Direction.LTR,eg=ae.Direction.RTL;function e1(r){let e=[];for(let t=0;t<r.length;t++)e.push(1<<+r[t]);return e}var Qz=e1("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Jz=e1("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),yp=Object.create(null),kn=[];for(let r of["()","[]","{}"]){let e=r.charCodeAt(0),t=r.charCodeAt(1);yp[e]=t,yp[t]=-e}function t1(r){return r<=247?Qz[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?Jz[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8204?256:64336<=r&&r<=65023?4:1}var e5=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/,cn=class{get dir(){return this.level%2?eg:va}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,n,i){let a=-1;for(let s=0;s<e.length;s++){let o=e[s];if(o.from<=t&&o.to>=t){if(o.level==n)return s;(a<0||(i!=0?i<0?o.from<t:o.to>t:e[a].level>o.level))&&(a=s)}}if(a<0)throw new RangeError("Index out of range");return a}};function r1(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++){let n=r[t],i=e[t];if(n.from!=i.from||n.to!=i.to||n.direction!=i.direction||!r1(n.inner,i.inner))return!1}return!0}var ht=[];function t5(r,e,t,n,i){for(let a=0;a<=n.length;a++){let s=a?n[a-1].to:e,o=a<n.length?n[a].from:t,l=a?256:i;for(let u=s,h=l,f=l;u<o;u++){let c=t1(r.charCodeAt(u));c==512?c=h:c==8&&f==4&&(c=16),ht[u]=c==4?2:c,c&7&&(f=c),h=c}for(let u=s,h=l,f=l;u<o;u++){let c=ht[u];if(c==128)u<o-1&&h==ht[u+1]&&h&24?c=ht[u]=h:ht[u]=256;else if(c==64){let d=u+1;for(;d<o&&ht[d]==64;)d++;let p=u&&h==8||d<t&&ht[d]==8?f==1?1:8:256;for(let g=u;g<d;g++)ht[g]=p;u=d-1}else c==8&&f==1&&(ht[u]=1);h=c,c&7&&(f=c)}}}function r5(r,e,t,n,i){let a=i==1?2:1;for(let s=0,o=0,l=0;s<=n.length;s++){let u=s?n[s-1].to:e,h=s<n.length?n[s].from:t;for(let f=u,c,d,p;f<h;f++)if(d=yp[c=r.charCodeAt(f)])if(d<0){for(let g=o-3;g>=0;g-=3)if(kn[g+1]==-d){let v=kn[g+2],m=v&2?i:v&4?v&1?a:i:0;m&&(ht[f]=ht[kn[g]]=m),o=g;break}}else{if(kn.length==189)break;kn[o++]=f,kn[o++]=c,kn[o++]=l}else if((p=ht[f])==2||p==1){let g=p==i;l=g?0:1;for(let v=o-3;v>=0;v-=3){let m=kn[v+2];if(m&2)break;if(g)kn[v+2]|=2;else{if(m&4)break;kn[v+2]|=4}}}}}function n5(r,e,t,n){for(let i=0,a=n;i<=t.length;i++){let s=i?t[i-1].to:r,o=i<t.length?t[i].from:e;for(let l=s;l<o;){let u=ht[l];if(u==256){let h=l+1;for(;;)if(h==o){if(i==t.length)break;h=t[i++].to,o=i<t.length?t[i].from:e}else if(ht[h]==256)h++;else break;let f=a==1,c=(h<e?ht[h]:n)==1,d=f==c?f?1:2:n;for(let p=h,g=i,v=g?t[g-1].to:r;p>l;)p==v&&(p=t[--g].from,v=g?t[g-1].to:r),ht[--p]=d;l=h}else a=u,l++}}}function bp(r,e,t,n,i,a,s){let o=n%2?2:1;if(n%2==i%2)for(let l=e,u=0;l<t;){let h=!0,f=!1;if(u==a.length||l<a[u].from){let g=ht[l];g!=o&&(h=!1,f=g==16)}let c=!h&&o==1?[]:null,d=h?n:n+1,p=l;e:for(;;)if(u<a.length&&p==a[u].from){if(f)break e;let g=a[u];if(!h)for(let v=g.to,m=u+1;;){if(v==t)break e;if(m<a.length&&a[m].from==v)v=a[m++].to;else{if(ht[v]==o)break e;break}}if(u++,c)c.push(g);else{g.from>l&&s.push(new cn(l,g.from,d));let v=g.direction==va!=!(d%2);wp(r,v?n+1:n,i,g.inner,g.from,g.to,s),l=g.to}p=g.to}else{if(p==t||(h?ht[p]!=o:ht[p]==o))break;p++}c?bp(r,l,p,n+1,i,c,s):l<p&&s.push(new cn(l,p,d)),l=p}else for(let l=t,u=a.length;l>e;){let h=!0,f=!1;if(!u||l>a[u-1].to){let g=ht[l-1];g!=o&&(h=!1,f=g==16)}let c=!h&&o==1?[]:null,d=h?n:n+1,p=l;e:for(;;)if(u&&p==a[u-1].to){if(f)break e;let g=a[--u];if(!h)for(let v=g.from,m=u;;){if(v==e)break e;if(m&&a[m-1].to==v)v=a[--m].from;else{if(ht[v-1]==o)break e;break}}if(c)c.push(g);else{g.to<l&&s.push(new cn(g.to,l,d));let v=g.direction==va!=!(d%2);wp(r,v?n+1:n,i,g.inner,g.from,g.to,s),l=g.from}p=g.from}else{if(p==e||(h?ht[p-1]!=o:ht[p-1]==o))break;p--}c?bp(r,p,l,n+1,i,c,s):p<l&&s.push(new cn(p,l,d)),l=p}}function wp(r,e,t,n,i,a,s){let o=e%2?2:1;t5(r,i,a,n,o),r5(r,i,a,n,o),n5(i,a,n,o),bp(r,i,a,e,t,n,s)}function n1(r,e,t){if(!r)return[new cn(0,0,e==eg?1:0)];if(e==va&&!t.length&&!e5.test(r))return i1(r.length);if(t.length)for(;r.length>ht.length;)ht[ht.length]=256;let n=[],i=e==va?0:1;return wp(r,i,i,t,0,r.length,n),n}function i1(r){return[new cn(0,r,0)]}var a1="";function s1(r,e,t,n,i){var a;let s=n.head-r.from,o=cn.find(e,s,(a=n.bidiLevel)!==null&&a!==void 0?a:-1,n.assoc),l=e[o],u=l.side(i,t);if(s==u){let c=o+=i?1:-1;if(c<0||c>=e.length)return null;l=e[o=c],s=l.side(!i,t),u=l.side(i,t)}let h=H.findClusterBreak(r.text,s,l.forward(i,t));(h<l.from||h>l.to)&&(h=u),a1=r.text.slice(Math.min(s,h),Math.max(s,h));let f=o==(i?e.length-1:0)?null:e[o+(i?1:-1)];return f&&h==u&&f.level+(i?0:1)<l.level?H.EditorSelection.cursor(f.side(!i,t)+r.from,f.forward(i,t)?1:-1,f.level):H.EditorSelection.cursor(h+r.from,l.forward(i,t)?-1:1,l.level)}function i5(r,e,t){for(let n=e;n<t;n++){let i=t1(r.charCodeAt(n));if(i==1)return va;if(i==2||i==4)return eg}return va}var o1=H.Facet.define(),l1=H.Facet.define(),u1=H.Facet.define(),h1=H.Facet.define(),xp=H.Facet.define(),f1=H.Facet.define(),c1=H.Facet.define(),tg=H.Facet.define(),rg=H.Facet.define(),d1=H.Facet.define({combine:r=>r.some(e=>e)}),p1=H.Facet.define({combine:r=>r.some(e=>e)}),g1=H.Facet.define(),zo=class r{constructor(e,t="nearest",n="nearest",i=5,a=5,s=!1){this.range=e,this.y=t,this.x=n,this.yMargin=i,this.xMargin=a,this.isSnapshot=s}map(e){return e.empty?this:new r(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new r(H.EditorSelection.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}},uh=H.StateEffect.define({map:(r,e)=>r.map(e)}),v1=H.StateEffect.define();function dn(r,e,t){let n=r.facet(h1);n.length?n[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}var Xn=H.Facet.define({combine:r=>r.length?r[0]:!0}),a5=0,Ro=H.Facet.define(),er=class r{constructor(e,t,n,i,a){this.id=e,this.create=t,this.domEventHandlers=n,this.domEventObservers=i,this.extension=a(this)}static define(e,t){let{eventHandlers:n,eventObservers:i,provide:a,decorations:s}=t||{};return new r(a5++,e,n,i,o=>{let l=[Ro.of(o)];return s&&l.push(Qo.of(u=>{let h=u.plugin(o);return h?s(h):ot.none})),a&&l.push(a(o)),l})}static fromClass(e,t){return r.define(n=>new e(n),t)}},Vo=class{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(n){if(dn(t.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){dn(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(n){dn(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}},m1=H.Facet.define(),zh=H.Facet.define(),Qo=H.Facet.define(),y1=H.Facet.define(),ng=H.Facet.define(),b1=H.Facet.define();function sx(r,e){let t=r.state.facet(b1);if(!t.length)return t;let n=t.map(a=>a instanceof Function?a(r):a),i=[];return H.RangeSet.spans(n,e.from,e.to,{point(){},span(a,s,o,l){let u=a-e.from,h=s-e.from,f=i;for(let c=o.length-1;c>=0;c--,l--){let d=o[c].spec.bidiIsolate,p;if(d==null&&(d=i5(e.text,u,h)),l>0&&f.length&&(p=f[f.length-1]).to==u&&p.direction==d)p.to=h,f=p.inner;else{let g={from:u,to:h,direction:d,inner:[]};f.push(g),f=g.inner}}}}),i}var w1=H.Facet.define();function ig(r){let e=0,t=0,n=0,i=0;for(let a of r.state.facet(w1)){let s=a(r);s&&(s.left!=null&&(e=Math.max(e,s.left)),s.right!=null&&(t=Math.max(t,s.right)),s.top!=null&&(n=Math.max(n,s.top)),s.bottom!=null&&(i=Math.max(i,s.bottom)))}return{left:e,right:t,top:n,bottom:i}}var Lo=H.Facet.define(),pn=class r{constructor(e,t,n,i){this.fromA=e,this.toA=t,this.fromB=n,this.toB=i}join(e){return new r(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let i=e[t-1];if(!(i.fromA>n.toA)){if(i.toA<n.fromA)break;n=n.join(i),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(t.length==0)return e;let n=[];for(let i=0,a=0,s=0,o=0;;i++){let l=i==e.length?null:e[i],u=s-o,h=l?l.fromB:1e9;for(;a<t.length&&t[a]<h;){let f=t[a],c=t[a+1],d=Math.max(o,f),p=Math.min(h,c);if(d<=p&&new r(d+u,p+u,d,p).addToSet(n),c>h)break;a+=2}if(!l)return n;new r(l.fromA,l.toA,l.fromB,l.toB).addToSet(n),s=l.toA,o=l.toB}}},Jo=class r{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=H.ChangeSet.empty(this.startState.doc.length);for(let a of n)this.changes=this.changes.compose(a.changes);let i=[];this.changes.iterChangedRanges((a,s,o,l)=>i.push(new pn(a,s,o,l))),this.changedRanges=i}static create(e,t,n){return new r(e,t,n)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}},Ah=class extends pt{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=ot.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Jt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new pn(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:u,toA:h})=>h<this.minWidthFrom||u>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let i=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?i=this.domChanged.newSel.head:!c5(e.changes,this.hasComposition)&&!e.selectionSet&&(i=e.state.selection.main.head));let a=i>-1?o5(this.view,e.changes,i):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:u,to:h}=this.hasComposition;n=new pn(u,h,e.changes.mapPos(u,-1),e.changes.mapPos(h,1)).addToSet(n.slice())}this.hasComposition=a?{from:a.range.fromB,to:a.range.toB}:null,(he.ie||he.chrome)&&!a&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let s=this.decorations,o=this.updateDeco(),l=h5(s,o,e.changes);return n=pn.extendWithRanges(n,l),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,a),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,n);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let s=he.chrome||he.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,s),this.flags&=-8,s&&(s.written||i.selectionRange.focusNode!=s.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(s=>s.flags&=-9);let a=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let s of this.children)s instanceof da&&s.widget instanceof Zo&&a.push(s.dom);i.updateGaps(a)}updateChildren(e,t,n){let i=n?n.range.addToSet(e.slice()):e,a=this.childCursor(t);for(let s=i.length-1;;s--){let o=s>=0?i[s]:null;if(!o)break;let{fromA:l,toA:u,fromB:h,toB:f}=o,c,d,p,g;if(n&&n.range.fromB<f&&n.range.toB>h){let w=_o.build(this.view.state.doc,h,n.range.fromB,this.decorations,this.dynamicDecorationMap),S=_o.build(this.view.state.doc,n.range.toB,f,this.decorations,this.dynamicDecorationMap);d=w.breakAtStart,p=w.openStart,g=S.openEnd;let C=this.compositionView(n);S.breakAtStart?C.breakAfter=1:S.content.length&&C.merge(C.length,C.length,S.content[0],!1,S.openStart,0)&&(C.breakAfter=S.content[0].breakAfter,S.content.shift()),w.content.length&&C.merge(0,0,w.content[w.content.length-1],!0,0,w.openEnd)&&w.content.pop(),c=w.content.concat(C).concat(S.content)}else({content:c,breakAtStart:d,openStart:p,openEnd:g}=_o.build(this.view.state.doc,h,f,this.decorations,this.dynamicDecorationMap));let{i:v,off:m}=a.findPos(u,1),{i:y,off:b}=a.findPos(l,-1);Kx(this,y,b,v,m,c,d,p,g)}n&&this.fixCompositionDOM(n)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let n of t.effects)n.is(v1)&&(this.editContextFormatting=n.value)}compositionView(e){let t=new Tn(e.text.nodeValue);t.flags|=8;for(let{deco:i}of e.marks)t=new Ci(i,[t],t.length);let n=new Jt;return n.append(t,0),n}fixCompositionDOM(e){let t=(a,s)=>{s.flags|=8|(s.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(s);let o=pt.get(a);o&&o!=s&&(o.dom=null),s.setDOM(a)},n=this.childPos(e.range.fromB,1),i=this.children[n.i];t(e.line,i);for(let a=e.marks.length-1;a>=-1;a--)n=i.childPos(n.off,1),i=i.children[n.i],t(a>=0?e.marks[a].node:e.text,i)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,i=n==this.dom,a=!i&&!(this.view.state.facet(Xn)||this.dom.tabIndex>-1)&&mh(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(i||t||a))return;let s=this.forceSelection;this.forceSelection=!1;let o=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(o.anchor)),u=o.empty?l:this.moveToLine(this.domAtPos(o.head));if(he.gecko&&o.empty&&!this.hasComposition&&s5(l)){let f=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(f,l.node.childNodes[l.offset]||null)),l=u=new yr(f,0),s=!0}let h=this.view.observer.selectionRange;(s||!h.focusNode||(!Fo(l.node,l.offset,h.anchorNode,h.anchorOffset)||!Fo(u.node,u.offset,h.focusNode,h.focusOffset))&&!this.suppressWidgetCursorChange(h,o))&&(this.view.observer.ignore(()=>{he.android&&he.chrome&&this.dom.contains(h.focusNode)&&f5(h.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let f=Ko(this.view.root);if(f)if(o.empty){if(he.gecko){let c=l5(l.node,l.offset);if(c&&c!=3){let d=(c==1?Gx:Ux)(l.node,l.offset);d&&(l=new yr(d.node,d.offset))}}f.collapse(l.node,l.offset),o.bidiLevel!=null&&f.caretBidiLevel!==void 0&&(f.caretBidiLevel=o.bidiLevel)}else if(f.extend){f.collapse(l.node,l.offset);try{f.extend(u.node,u.offset)}catch{}}else{let c=document.createRange();o.anchor>o.head&&([l,u]=[u,l]),c.setEnd(u.node,u.offset),c.setStart(l.node,l.offset),f.removeAllRanges(),f.addRange(c)}a&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(l,u)),this.impreciseAnchor=l.precise?null:new yr(h.anchorNode,h.anchorOffset),this.impreciseHead=u.precise?null:new yr(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&Fo(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,n=Ko(e.root),{anchorNode:i,anchorOffset:a}=e.observer.selectionRange;if(!n||!t.empty||!t.assoc||!n.modify)return;let s=Jt.find(this,t.head);if(!s)return;let o=s.posAtStart;if(t.head==o||t.head==o+s.length)return;let l=this.coordsAt(t.head,-1),u=this.coordsAt(t.head,1);if(!l||!u||l.bottom>u.top)return;let h=this.domAtPos(t.head+t.assoc);n.collapse(h.node,h.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let f=e.observer.selectionRange;e.docView.posFromDOM(f.anchorNode,f.anchorOffset)!=t.from&&n.collapse(i,a)}moveToLine(e){let t=this.dom,n;if(e.node!=t)return e;for(let i=e.offset;!n&&i<t.childNodes.length;i++){let a=pt.get(t.childNodes[i]);a instanceof Jt&&(n=a.domAtPos(0))}for(let i=e.offset-1;!n&&i>=0;i--){let a=pt.get(t.childNodes[i]);a instanceof Jt&&(n=a.domAtPos(a.length))}return n?new yr(n.node,n.offset,!0):e}nearest(e){for(let t=e;t;){let n=pt.get(t);if(n&&n.rootView==this)return n;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let i=this.children[t];if(n<i.length||i instanceof Jt)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){let n=null,i=0;for(let a=this.length,s=this.children.length-1;s>=0;s--){let o=this.children[s],l=a-o.breakAfter,u=l-o.length;if(l<e)break;if(u<=e&&(u<e||o.covers(-1))&&(l>e||o.covers(1))&&(!n||o instanceof Jt&&!(n instanceof Jt&&t>=0)))n=o,i=u;else if(n&&u==e&&l==e&&o instanceof da&&Math.abs(t)<2){if(o.deco.startSide<0)break;s&&(n=null)}a=u}return n?n.coordsAt(e-i,t):null}coordsForChar(e){let{i:t,off:n}=this.childPos(e,1),i=this.children[t];if(!(i instanceof Jt))return null;for(;i.children.length;){let{i:o,off:l}=i.childPos(n,1);for(;;o++){if(o==i.children.length)return null;if((i=i.children[o]).length)break}n=l}if(!(i instanceof Tn))return null;let a=H.findClusterBreak(i.text,n);if(a==n)return null;let s=ga(i.dom,n,a).getClientRects();for(let o=0;o<s.length;o++){let l=s[o];if(o==s.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let t=[],{from:n,to:i}=e,a=this.view.contentDOM.clientWidth,s=a>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,l=this.view.textDirection==ae.Direction.LTR;for(let u=0,h=0;h<this.children.length;h++){let f=this.children[h],c=u+f.length;if(c>i)break;if(u>=n){let d=f.dom.getBoundingClientRect();if(t.push(d.height),s){let p=f.dom.lastChild,g=p?vs(p):[];if(g.length){let v=g[g.length-1],m=l?v.right-d.left:d.right-v.left;m>o&&(o=m,this.minWidth=a,this.minWidthFrom=u,this.minWidthTo=c)}}}u=c+f.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?ae.Direction.RTL:ae.Direction.LTR}measureTextSize(){for(let a of this.children)if(a instanceof Jt){let s=a.measureTextSize();if(s)return s}let e=document.createElement("div"),t,n,i;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let a=vs(e.firstChild)[0];t=e.getBoundingClientRect().height,n=a?a.width/27:7,i=a?a.height:t,e.remove()}),{lineHeight:t,charWidth:n,textHeight:i}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new Eh(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,i=0;;i++){let a=i==t.viewports.length?null:t.viewports[i],s=a?a.from-1:this.length;if(s>n){let o=(t.lineBlockAt(s).bottom-t.lineBlockAt(n).top)/this.view.scaleY;e.push(ot.replace({widget:new Zo(o),block:!0,inclusive:!0,isBlockGap:!0}).range(n,s))}if(!a)break;n=a.to+1}return ot.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Qo).map(a=>(this.dynamicDecorationMap[e++]=typeof a=="function")?a(this.view):a),n=!1,i=this.view.state.facet(y1).map((a,s)=>{let o=typeof a=="function";return o&&(n=!0),o?a(this.view):a});for(i.length&&(this.dynamicDecorationMap[e++]=n,t.push(H.RangeSet.join(i))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let u=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=u.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let u of this.view.state.facet(g1))try{if(u(this.view,e.range,e))return!0}catch(h){dn(this.view.state,h,"scroll handler")}let{range:t}=e,n=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),i;if(!n)return;!t.empty&&(i=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(n={left:Math.min(n.left,i.left),top:Math.min(n.top,i.top),right:Math.max(n.right,i.right),bottom:Math.max(n.bottom,i.bottom)});let a=ig(this.view),s={left:n.left-a.left,top:n.top-a.top,right:n.right+a.right,bottom:n.bottom+a.bottom},{offsetWidth:o,offsetHeight:l}=this.view.scrollDOM;Hz(this.view.scrollDOM,s,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,o),-o),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==ae.Direction.LTR)}};function s5(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}function x1(r,e){let t=r.observer.selectionRange;if(!t.focusNode)return null;let n=Gx(t.focusNode,t.focusOffset),i=Ux(t.focusNode,t.focusOffset),a=n||i;if(i&&n&&i.node!=n.node){let o=pt.get(i.node);if(!o||o instanceof Tn&&o.text!=i.node.nodeValue)a=i;else if(r.docView.lastCompositionAfterCursor){let l=pt.get(n.node);!l||l instanceof Tn&&l.text!=n.node.nodeValue||(a=i)}}if(r.docView.lastCompositionAfterCursor=a!=n,!a)return null;let s=e-a.offset;return{from:s,to:s+a.node.nodeValue.length,node:a.node}}function o5(r,e,t){let n=x1(r,t);if(!n)return null;let{node:i,from:a,to:s}=n,o=i.nodeValue;if(/[\n\r]/.test(o)||r.state.doc.sliceString(n.from,n.to)!=o)return null;let l=e.invertedDesc,u=new pn(l.mapPos(a),l.mapPos(s),a,s),h=[];for(let f=i.parentNode;;f=f.parentNode){let c=pt.get(f);if(c instanceof Ci)h.push({node:f,deco:c.mark});else{if(c instanceof Jt||f.nodeName=="DIV"&&f.parentNode==r.contentDOM)return{range:u,text:i,marks:h,line:f};if(f!=r.contentDOM)h.push({node:f,deco:new Xo({inclusive:!0,attributes:$z(f),tagName:f.tagName.toLowerCase()})});else return null}}}function l5(r,e){return r.nodeType!=1?0:(e&&r.childNodes[e-1].contentEditable=="false"?1:0)|(e<r.childNodes.length&&r.childNodes[e].contentEditable=="false"?2:0)}var u5=class{constructor(){this.changes=[]}compareRange(e,t){yh(e,t,this.changes)}comparePoint(e,t){yh(e,t,this.changes)}boundChange(e){yh(e,e,this.changes)}};function h5(r,e,t){let n=new u5;return H.RangeSet.compare(r,e,t,n),n.changes}function f5(r,e){for(let t=r;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function c5(r,e){let t=!1;return e&&r.iterChangedRanges((n,i)=>{n<e.to&&i>e.from&&(t=!0)}),t}function d5(r,e,t=1){let n=r.charCategorizer(e),i=r.doc.lineAt(e),a=e-i.from;if(i.length==0)return H.EditorSelection.cursor(e);a==0?t=1:a==i.length&&(t=-1);let s=a,o=a;t<0?s=H.findClusterBreak(i.text,a,!1):o=H.findClusterBreak(i.text,a);let l=n(i.text.slice(s,o));for(;s>0;){let u=H.findClusterBreak(i.text,s,!1);if(n(i.text.slice(u,s))!=l)break;s=u}for(;o<i.length;){let u=H.findClusterBreak(i.text,o);if(n(i.text.slice(o,u))!=l)break;o=u}return H.EditorSelection.range(s+i.from,o+i.from)}function p5(r,e){return e.left>r?e.left-r:Math.max(0,r-e.right)}function g5(r,e){return e.top>r?e.top-r:Math.max(0,r-e.bottom)}function sp(r,e){return r.top<e.bottom-1&&r.bottom>e.top+1}function ox(r,e){return e<r.top?{top:e,left:r.left,right:r.right,bottom:r.bottom}:r}function lx(r,e){return e>r.bottom?{top:r.top,left:r.left,right:r.right,bottom:e}:r}function Sp(r,e,t){let n,i,a,s,o=!1,l,u,h,f;for(let p=r.firstChild;p;p=p.nextSibling){let g=vs(p);for(let v=0;v<g.length;v++){let m=g[v];i&&sp(i,m)&&(m=ox(lx(m,i.bottom),i.top));let y=p5(e,m),b=g5(t,m);if(y==0&&b==0)return p.nodeType==3?ux(p,e,t):Sp(p,e,t);if(!n||s>b||s==b&&a>y){n=p,i=m,a=y,s=b;let w=b?t<m.top?-1:1:y?e<m.left?-1:1:0;o=!w||(w>0?v<g.length-1:v>0)}y==0?t>m.bottom&&(!h||h.bottom<m.bottom)?(l=p,h=m):t<m.top&&(!f||f.top>m.top)&&(u=p,f=m):h&&sp(h,m)?h=lx(h,m.bottom):f&&sp(f,m)&&(f=ox(f,m.top))}}if(h&&h.bottom>=t?(n=l,i=h):f&&f.top<=t&&(n=u,i=f),!n)return{node:r,offset:0};let c=Math.max(i.left,Math.min(i.right,e));if(n.nodeType==3)return ux(n,c,t);if(o&&n.contentEditable!="false")return Sp(n,c,t);let d=Array.prototype.indexOf.call(r.childNodes,n)+(e>=(i.left+i.right)/2?1:0);return{node:r,offset:d}}function ux(r,e,t){let n=r.nodeValue.length,i=-1,a=1e9,s=0;for(let o=0;o<n;o++){let l=ga(r,o,o+1).getClientRects();for(let u=0;u<l.length;u++){let h=l[u];if(h.top==h.bottom)continue;s||(s=e-h.left);let f=(h.top>t?h.top-t:t-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&f<a){let c=e>=(h.left+h.right)/2,d=c;if((he.chrome||he.gecko)&&ga(r,o).getBoundingClientRect().left==h.right&&(d=!c),f<=0)return{node:r,offset:o+(d?1:0)};i=o+(d?1:0),a=f}}}return{node:r,offset:i>-1?i:s>0?r.nodeValue.length:0}}function S1(r,e,t,n=-1){var i,a;let s=r.contentDOM.getBoundingClientRect(),o=s.top+r.viewState.paddingTop,l,{docHeight:u}=r.viewState,{x:h,y:f}=e,c=f-o;if(c<0)return 0;if(c>u)return r.state.doc.length;for(let w=r.viewState.heightOracle.textHeight/2,S=!1;l=r.elementAtHeight(c),l.type!=ae.BlockType.Text;)for(;c=n>0?l.bottom+w:l.top-w,!(c>=0&&c<=u);){if(S)return t?null:0;S=!0,n=-n}f=o+c;let d=l.from;if(d<r.viewport.from)return r.viewport.from==0?0:t?null:hx(r,s,l,h,f);if(d>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:t?null:hx(r,s,l,h,f);let p=r.dom.ownerDocument,g=r.root.elementFromPoint?r.root:p,v=g.elementFromPoint(h,f);v&&!r.contentDOM.contains(v)&&(v=null),v||(h=Math.max(s.left+1,Math.min(s.right-1,h)),v=g.elementFromPoint(h,f),v&&!r.contentDOM.contains(v)&&(v=null));let m,y=-1;if(v&&((i=r.docView.nearest(v))===null||i===void 0?void 0:i.isEditable)!=!1){if(p.caretPositionFromPoint){let w=p.caretPositionFromPoint(h,f);w&&({offsetNode:m,offset:y}=w)}else if(p.caretRangeFromPoint){let w=p.caretRangeFromPoint(h,f);w&&({startContainer:m,startOffset:y}=w,(!r.contentDOM.contains(m)||he.safari&&v5(m,y,h)||he.chrome&&m5(m,y,h))&&(m=void 0))}m&&(y=Math.min(En(m),y))}if(!m||!r.docView.dom.contains(m)){let w=Jt.find(r.docView,d);if(!w)return c>l.top+l.height/2?l.to:l.from;({node:m,offset:y}=Sp(w.dom,h,f))}let b=r.docView.nearest(m);if(!b)return null;if(b.isWidget&&((a=b.dom)===null||a===void 0?void 0:a.nodeType)==1){let w=b.dom.getBoundingClientRect();return e.y<w.top||e.y<=w.bottom&&e.x<=(w.left+w.right)/2?b.posAtStart:b.posAtEnd}else return b.localPosFromDOM(m,y)+b.posAtStart}function hx(r,e,t,n,i){let a=Math.round((n-e.left)*r.defaultCharacterWidth);if(r.lineWrapping&&t.height>r.defaultLineHeight*1.5){let o=r.viewState.heightOracle.textHeight,l=Math.floor((i-t.top-(r.defaultLineHeight-o)*.5)/o);a+=l*r.viewState.heightOracle.lineLength}let s=r.state.sliceDoc(t.from,t.to);return t.from+H.findColumn(s,a,r.state.tabSize)}function v5(r,e,t){let n;if(r.nodeType!=3||e!=(n=r.nodeValue.length))return!1;for(let i=r.nextSibling;i;i=i.nextSibling)if(i.nodeType!=1||i.nodeName!="BR")return!1;return ga(r,n-1,n).getBoundingClientRect().left>t}function m5(r,e,t){if(e!=0)return!1;for(let i=r;;){let a=i.parentNode;if(!a||a.nodeType!=1||a.firstChild!=i)return!1;if(a.classList.contains("cm-line"))break;i=a}let n=r.nodeType==1?r.getBoundingClientRect():ga(r,0,Math.max(r.nodeValue.length,1)).getBoundingClientRect();return t-n.left>5}function Cp(r,e,t){let n=r.lineBlockAt(e);if(Array.isArray(n.type)){let i;for(let a of n.type){if(a.from>e)break;if(!(a.to<e)){if(a.from<e&&a.to>e)return a;(!i||a.type==ae.BlockType.Text&&(i.type!=a.type||(t<0?a.from<e:a.to>e)))&&(i=a)}}return i||n}return n}function y5(r,e,t,n){let i=Cp(r,e.head,e.assoc||-1),a=!n||i.type!=ae.BlockType.Text||!(r.lineWrapping||i.widgetLineBreaks)?null:r.coordsAtPos(e.assoc<0&&e.head>i.from?e.head-1:e.head);if(a){let s=r.dom.getBoundingClientRect(),o=r.textDirectionAt(i.from),l=r.posAtCoords({x:t==(o==ae.Direction.LTR)?s.right-1:s.left+1,y:(a.top+a.bottom)/2});if(l!=null)return H.EditorSelection.cursor(l,t?-1:1)}return H.EditorSelection.cursor(t?i.to:i.from,t?-1:1)}function fx(r,e,t,n){let i=r.state.doc.lineAt(e.head),a=r.bidiSpans(i),s=r.textDirectionAt(i.from);for(let o=e,l=null;;){let u=s1(i,a,s,o,t),h=a1;if(!u){if(i.number==(t?r.state.doc.lines:1))return o;h=`
`,i=r.state.doc.line(i.number+(t?1:-1)),a=r.bidiSpans(i),u=r.visualLineSide(i,!t)}if(l){if(!l(h))return o}else{if(!n)return u;l=n(h)}o=u}}function b5(r,e,t){let n=r.state.charCategorizer(e),i=n(t);return a=>{let s=n(a);return i==H.CharCategory.Space&&(i=s),i==s}}function w5(r,e,t,n){let i=e.head,a=t?1:-1;if(i==(t?r.state.doc.length:0))return H.EditorSelection.cursor(i,e.assoc);let s=e.goalColumn,o,l=r.contentDOM.getBoundingClientRect(),u=r.coordsAtPos(i,e.assoc||-1),h=r.documentTop;if(u)s==null&&(s=u.left-l.left),o=a<0?u.top:u.bottom;else{let d=r.viewState.lineBlockAt(i);s==null&&(s=Math.min(l.right-l.left,r.defaultCharacterWidth*(i-d.from))),o=(a<0?d.top:d.bottom)+h}let f=l.left+s,c=n??r.viewState.heightOracle.textHeight>>1;for(let d=0;;d+=10){let p=o+(c+d)*a,g=S1(r,{x:f,y:p},!1,a);if(p<l.top||p>l.bottom||(a<0?g<i:g>i)){let v=r.docView.coordsForChar(g),m=!v||p<v.top?-1:1;return H.EditorSelection.cursor(g,m,void 0,s)}}}function bh(r,e,t){for(;;){let n=0;for(let i of r)i.between(e-1,e+1,(a,s,o)=>{if(e>a&&e<s){let l=n||t||(e-a<s-e?-1:1);e=l<0?a:s,n=l}});if(!n)return e}}function op(r,e,t){let n=bh(r.state.facet(ng).map(i=>i(r)),t.from,e.head>t.from?-1:1);return n==t.from?t:H.EditorSelection.cursor(n,n<t.from?1:-1)}var Io="\uFFFF",kp=class{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(H.EditorState.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Io}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let i=e;;){this.findPointBefore(n,i);let a=this.text.length;this.readNode(i);let s=i.nextSibling;if(s==t)break;let o=pt.get(i),l=pt.get(s);(o&&l?o.breakAfter:(o?o.breakAfter:kh(i))||kh(s)&&(i.nodeName!="BR"||i.cmIgnore)&&this.text.length>a)&&this.lineBreak(),i=s}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let a=-1,s=1,o;if(this.lineSeparator?(a=t.indexOf(this.lineSeparator,n),s=this.lineSeparator.length):(o=i.exec(t))&&(a=o.index,s=o[0].length),this.append(t.slice(n,a<0?t.length:a)),a<0)break;if(this.lineBreak(),s>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=s-1);n=a+s}}readNode(e){if(e.cmIgnore)return;let t=pt.get(e),n=t&&t.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let i=n.iter();!i.next().done;)i.lineBreak?this.lineBreak():this.append(i.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(x5(e,n.node,n.offset)?t:0))}};function x5(r,e,t){for(;;){if(!e||t<En(e))return!1;if(e==r)return!0;t=pa(e)+1,e=e.parentNode}}var Mh=class{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}},Ep=class{constructor(e,t,n,i){this.typeOver=i,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:a,impreciseAnchor:s}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,n,0))){let o=a||s?[]:k5(e),l=new kp(o,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=E5(o,this.bounds.from)}else{let o=e.observer.selectionRange,l=a&&a.node==o.focusNode&&a.offset==o.focusOffset||!fp(e.contentDOM,o.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(o.focusNode,o.focusOffset),u=s&&s.node==o.anchorNode&&s.offset==o.anchorOffset||!fp(e.contentDOM,o.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(o.anchorNode,o.anchorOffset),h=e.viewport;if((he.ios||he.chrome)&&e.state.selection.main.empty&&l!=u&&(h.from>0||h.to<e.state.doc.length)){let f=Math.min(l,u),c=Math.max(l,u),d=h.from-f,p=h.to-c;(d==0||d==1||f==0)&&(p==0||p==-1||c==e.state.doc.length)&&(l=0,u=e.state.doc.length)}this.newSel=H.EditorSelection.single(u,l)}}};function C1(r,e){let t,{newSel:n}=e,i=r.state.selection.main,a=r.inputState.lastKeyTime>Date.now()-100?r.inputState.lastKeyCode:-1;if(e.bounds){let{from:s,to:o}=e.bounds,l=i.from,u=null;(a===8||he.android&&e.text.length<o-s)&&(l=i.to,u="end");let h=C5(r.state.doc.sliceString(s,o,Io),e.text,l-s,u);h&&(he.chrome&&a==13&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==Io+Io&&h.toB--,t={from:s+h.from,to:s+h.toA,insert:H.Text.of(e.text.slice(h.from,h.toB).split(Io))})}else n&&(!r.hasFocus&&r.state.facet(Xn)||n.main.eq(i))&&(n=null);if(!t&&!n)return!1;if(!t&&e.typeOver&&!i.empty&&n&&n.main.empty?t={from:i.from,to:i.to,insert:r.state.doc.slice(i.from,i.to)}:(he.mac||he.android)&&t&&t.from==t.to&&t.from==i.head-1&&/^\. ?$/.test(t.insert.toString())&&r.contentDOM.getAttribute("autocorrect")=="off"?(n&&t.insert.length==2&&(n=H.EditorSelection.single(n.main.anchor-1,n.main.head-1)),t={from:t.from,to:t.to,insert:H.Text.of([t.insert.toString().replace("."," ")])}):t&&t.from>=i.from&&t.to<=i.to&&(t.from!=i.from||t.to!=i.to)&&i.to-i.from-(t.to-t.from)<=4?t={from:i.from,to:i.to,insert:r.state.doc.slice(i.from,t.from).append(t.insert).append(r.state.doc.slice(t.to,i.to))}:he.chrome&&t&&t.from==t.to&&t.from==i.head&&t.insert.toString()==`
 `&&r.lineWrapping&&(n&&(n=H.EditorSelection.single(n.main.anchor-1,n.main.head-1)),t={from:i.from,to:i.to,insert:H.Text.of([" "])}),t)return ag(r,t,n,a);if(n&&!n.main.eq(i)){let s=!1,o="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(s=!0),o=r.inputState.lastSelectionOrigin),r.dispatch({selection:n,scrollIntoView:s,userEvent:o}),!0}else return!1}function ag(r,e,t,n=-1){if(he.ios&&r.inputState.flushIOSKey(e))return!0;let i=r.state.selection.main;if(he.android&&(e.to==i.to&&(e.from==i.from||e.from==i.from-1&&r.state.sliceDoc(e.from,i.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&ps(r.contentDOM,"Enter",13)||(e.from==i.from-1&&e.to==i.to&&e.insert.length==0||n==8&&e.insert.length<e.to-e.from&&e.to>i.head)&&ps(r.contentDOM,"Backspace",8)||e.from==i.from&&e.to==i.to+1&&e.insert.length==0&&ps(r.contentDOM,"Delete",46)))return!0;let a=e.insert.toString();r.inputState.composing>=0&&r.inputState.composing++;let s,o=()=>s||(s=S5(r,e,t));return r.state.facet(f1).some(l=>l(r,e.from,e.to,a,o))||r.dispatch(o()),!0}function S5(r,e,t){let n,i=r.state,a=i.selection.main;if(e.from>=a.from&&e.to<=a.to&&e.to-e.from>=(a.to-a.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&r.inputState.composing<0){let o=a.from<e.from?i.sliceDoc(a.from,e.from):"",l=a.to>e.to?i.sliceDoc(e.to,a.to):"";n=i.replaceSelection(r.state.toText(o+e.insert.sliceString(0,void 0,r.state.lineBreak)+l))}else{let o=i.changes(e),l=t&&t.main.to<=o.newLength?t.main:void 0;if(i.selection.ranges.length>1&&r.inputState.composing>=0&&e.to<=a.to&&e.to>=a.to-10){let u=r.state.sliceDoc(e.from,e.to),h,f=t&&x1(r,t.main.head);if(f){let p=e.insert.length-(e.to-e.from);h={from:f.from,to:f.to-p}}else h=r.state.doc.lineAt(a.head);let c=a.to-e.to,d=a.to-a.from;n=i.changeByRange(p=>{if(p.from==a.from&&p.to==a.to)return{changes:o,range:l||p.map(o)};let g=p.to-c,v=g-u.length;if(p.to-p.from!=d||r.state.sliceDoc(v,g)!=u||p.to>=h.from&&p.from<=h.to)return{range:p};let m=i.changes({from:v,to:g,insert:e.insert}),y=p.to-a.to;return{changes:m,range:l?H.EditorSelection.range(Math.max(0,l.anchor+y),Math.max(0,l.head+y)):p.map(m)}})}else n={changes:o,selection:l&&i.selection.replaceRange(l)}}let s="input.type";return(r.composing||r.inputState.compositionPendingChange&&r.inputState.compositionEndedAt>Date.now()-50)&&(r.inputState.compositionPendingChange=!1,s+=".compose",r.inputState.compositionFirstChange&&(s+=".start",r.inputState.compositionFirstChange=!1)),i.update(n,{userEvent:s,scrollIntoView:!0})}function C5(r,e,t,n){let i=Math.min(r.length,e.length),a=0;for(;a<i&&r.charCodeAt(a)==e.charCodeAt(a);)a++;if(a==i&&r.length==e.length)return null;let s=r.length,o=e.length;for(;s>0&&o>0&&r.charCodeAt(s-1)==e.charCodeAt(o-1);)s--,o--;if(n=="end"){let l=Math.max(0,a-Math.min(s,o));t-=s+l-a}if(s<a&&r.length<e.length){let l=t<=a&&t>=s?a-t:0;a-=l,o=a+(o-s),s=a}else if(o<a){let l=t<=a&&t>=o?a-t:0;a-=l,s=a+(s-o),o=a}return{from:a,toA:s,toB:o}}function k5(r){let e=[];if(r.root.activeElement!=r.contentDOM)return e;let{anchorNode:t,anchorOffset:n,focusNode:i,focusOffset:a}=r.observer.selectionRange;return t&&(e.push(new Mh(t,n)),(i!=t||a!=n)&&e.push(new Mh(i,a))),e}function E5(r,e){if(r.length==0)return null;let t=r[0].pos,n=r.length==2?r[1].pos:t;return t>-1&&n>-1?H.EditorSelection.single(t+e,n+e):null}var Tp=class{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,he.safari&&e.contentDOM.addEventListener("input",()=>null),he.gecko&&z5(e.contentDOM.ownerDocument)}handleEvent(e){!O5(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let n=this.handlers[e];if(n){for(let i of n.observers)i(this.view,t);for(let i of n.handlers){if(t.defaultPrevented)break;if(i(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=T5(e),n=this.handlers,i=this.view.contentDOM;for(let a in t)if(a!="scroll"){let s=!t[a].handlers.length,o=n[a];o&&s!=!o.handlers.length&&(i.removeEventListener(a,this.handleEvent),o=null),o||i.addEventListener(a,this.handleEvent,{passive:s})}for(let a in n)a!="scroll"&&!t[a]&&i.removeEventListener(a,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&E1.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),he.android&&he.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return he.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=k1.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||A5.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,ps(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:he.safari&&!he.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}};function cx(r,e){return(t,n)=>{try{return e.call(r,n,t)}catch(i){dn(t.state,i)}}}function T5(r){let e=Object.create(null);function t(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of r){let i=n.spec;if(i&&i.domEventHandlers)for(let a in i.domEventHandlers){let s=i.domEventHandlers[a];s&&t(a).handlers.push(cx(n.value,s))}if(i&&i.domEventObservers)for(let a in i.domEventObservers){let s=i.domEventObservers[a];s&&t(a).observers.push(cx(n.value,s))}}for(let n in gn)t(n).handlers.push(gn[n]);for(let n in $r)t(n).observers.push($r[n]);return e}var k1=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],A5="dthko",E1=[16,17,18,20,91,92,224,225],hh=6;function fh(r){return Math.max(0,r)*.7+8}function M5(r,e){return Math.max(Math.abs(r.clientX-e.clientX),Math.abs(r.clientY-e.clientY))}var Ap=class{constructor(e,t,n,i){this.view=e,this.startEvent=t,this.style=n,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=Wz(e.contentDOM),this.atoms=e.state.facet(ng).map(s=>s(e));let a=e.contentDOM.ownerDocument;a.addEventListener("mousemove",this.move=this.move.bind(this)),a.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(H.EditorState.allowMultipleSelections)&&D5(e,t),this.dragging=B5(e,t)&&M1(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&M5(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,n=0,i=0,a=0,s=this.view.win.innerWidth,o=this.view.win.innerHeight;this.scrollParents.x&&({left:i,right:s}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:a,bottom:o}=this.scrollParents.y.getBoundingClientRect());let l=ig(this.view);e.clientX-l.left<=i+hh?t=-fh(i-e.clientX):e.clientX+l.right>=s-hh&&(t=fh(e.clientX-s)),e.clientY-l.top<=a+hh?n=-fh(a-e.clientY):e.clientY+l.bottom>=o-hh&&(n=fh(e.clientY-o)),this.setScrollSpeed(t,n)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let n=0;n<e.ranges.length;n++){let i=e.ranges[n],a=null;if(i.empty){let s=bh(this.atoms,i.from,0);s!=i.from&&(a=H.EditorSelection.cursor(s,-1))}else{let s=bh(this.atoms,i.from,-1),o=bh(this.atoms,i.to,1);(s!=i.from||o!=i.to)&&(a=H.EditorSelection.range(i.from==i.anchor?s:o,i.from==i.head?s:o))}a&&(t||(t=e.ranges.slice()),t[n]=a)}return t?H.EditorSelection.create(t,e.mainIndex):e}select(e){let{view:t}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}};function D5(r,e){let t=r.state.facet(o1);return t.length?t[0](e):he.mac?e.metaKey:e.ctrlKey}function P5(r,e){let t=r.state.facet(l1);return t.length?t[0](e):he.mac?!e.altKey:!e.ctrlKey}function B5(r,e){let{main:t}=r.state.selection;if(t.empty)return!1;let n=Ko(r.root);if(!n||n.rangeCount==0)return!0;let i=n.getRangeAt(0).getClientRects();for(let a=0;a<i.length;a++){let s=i[a];if(s.left<=e.clientX&&s.right>=e.clientX&&s.top<=e.clientY&&s.bottom>=e.clientY)return!0}return!1}function O5(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,n;t!=r.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(n=pt.get(t))&&n.ignoreEvent(e))return!1;return!0}var gn=Object.create(null),$r=Object.create(null),T1=he.ie&&he.ie_version<15||he.ios&&he.webkit_version<604;function R5(r){let e=r.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{r.focus(),t.remove(),A1(r,t.value)},50)}function Vh(r,e,t){for(let n of r.facet(e))t=n(t,r);return t}function A1(r,e){e=Vh(r.state,tg,e);let{state:t}=r,n,i=1,a=t.toText(e),s=a.lines==t.selection.ranges.length;if(Mp!=null&&t.selection.ranges.every(l=>l.empty)&&Mp==a.toString()){let l=-1;n=t.changeByRange(u=>{let h=t.doc.lineAt(u.from);if(h.from==l)return{range:u};l=h.from;let f=t.toText((s?a.line(i++).text:e)+t.lineBreak);return{changes:{from:h.from,insert:f},range:H.EditorSelection.cursor(u.from+f.length)}})}else s?n=t.changeByRange(l=>{let u=a.line(i++);return{changes:{from:l.from,to:l.to,insert:u.text},range:H.EditorSelection.cursor(l.from+u.length)}}):n=t.replaceSelection(a);r.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}$r.scroll=r=>{r.inputState.lastScrollTop=r.scrollDOM.scrollTop,r.inputState.lastScrollLeft=r.scrollDOM.scrollLeft};gn.keydown=(r,e)=>(r.inputState.setSelectionOrigin("select"),e.keyCode==27&&r.inputState.tabFocusMode!=0&&(r.inputState.tabFocusMode=Date.now()+2e3),!1);$r.touchstart=(r,e)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")};$r.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")};gn.mousedown=(r,e)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let n of r.state.facet(u1))if(t=n(r,e),t)break;if(!t&&e.button==0&&(t=N5(r,e)),t){let n=!r.hasFocus;r.inputState.startMouseSelection(new Ap(r,e,t,n)),n&&r.observer.ignore(()=>{Vx(r.contentDOM);let a=r.root.activeElement;a&&!a.contains(r.contentDOM)&&a.blur()});let i=r.inputState.mouseSelection;if(i)return i.start(e),i.dragging===!1}return!1};function dx(r,e,t,n){if(n==1)return H.EditorSelection.cursor(e,t);if(n==2)return d5(r.state,e,t);{let i=Jt.find(r.docView,e),a=r.state.doc.lineAt(i?i.posAtEnd:e),s=i?i.posAtStart:a.from,o=i?i.posAtEnd:a.to;return o<r.state.doc.length&&o==a.to&&o++,H.EditorSelection.range(s,o)}}var px=(r,e,t)=>e>=t.top&&e<=t.bottom&&r>=t.left&&r<=t.right;function L5(r,e,t,n){let i=Jt.find(r.docView,e);if(!i)return 1;let a=e-i.posAtStart;if(a==0)return 1;if(a==i.length)return-1;let s=i.coordsAt(a,-1);if(s&&px(t,n,s))return-1;let o=i.coordsAt(a,1);return o&&px(t,n,o)?1:s&&s.bottom>=n?-1:1}function gx(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:L5(r,t,e.clientX,e.clientY)}}var I5=he.ie&&he.ie_version<=11,vx=null,mx=0,yx=0;function M1(r){if(!I5)return r.detail;let e=vx,t=yx;return vx=r,yx=Date.now(),mx=!e||t>Date.now()-400&&Math.abs(e.clientX-r.clientX)<2&&Math.abs(e.clientY-r.clientY)<2?(mx+1)%3:1}function N5(r,e){let t=gx(r,e),n=M1(e),i=r.state.selection;return{update(a){a.docChanged&&(t.pos=a.changes.mapPos(t.pos),i=i.map(a.changes))},get(a,s,o){let l=gx(r,a),u,h=dx(r,l.pos,l.bias,n);if(t.pos!=l.pos&&!s){let f=dx(r,t.pos,t.bias,n),c=Math.min(f.from,h.from),d=Math.max(f.to,h.to);h=c<h.from?H.EditorSelection.range(c,d):H.EditorSelection.range(d,c)}return s?i.replaceRange(i.main.extend(h.from,h.to)):o&&n==1&&i.ranges.length>1&&(u=q5(i,l.pos))?u:o?i.addRange(h):H.EditorSelection.create([h])}}}function q5(r,e){for(let t=0;t<r.ranges.length;t++){let{from:n,to:i}=r.ranges[t];if(n<=e&&i>=e)return H.EditorSelection.create(r.ranges.slice(0,t).concat(r.ranges.slice(t+1)),r.mainIndex==t?0:r.mainIndex-(r.mainIndex>t?1:0))}return null}gn.dragstart=(r,e)=>{let{selection:{main:t}}=r.state;if(e.target.draggable){let i=r.docView.nearest(e.target);if(i&&i.isWidget){let a=i.posAtStart,s=a+i.length;(a>=t.to||s<=t.from)&&(t=H.EditorSelection.range(a,s))}}let{inputState:n}=r;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",Vh(r.state,rg,r.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};gn.dragend=r=>(r.inputState.draggedContent=null,!1);function bx(r,e,t,n){if(t=Vh(r.state,tg,t),!t)return;let i=r.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:a}=r.inputState,s=n&&a&&P5(r,e)?{from:a.from,to:a.to}:null,o={from:i,insert:t},l=r.state.changes(s?[s,o]:o);r.focus(),r.dispatch({changes:l,selection:{anchor:l.mapPos(i,-1),head:l.mapPos(i,1)},userEvent:s?"move.drop":"input.drop"}),r.inputState.draggedContent=null}gn.drop=(r,e)=>{if(!e.dataTransfer)return!1;if(r.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let n=Array(t.length),i=0,a=()=>{++i==t.length&&bx(r,e,n.filter(s=>s!=null).join(r.state.lineBreak),!1)};for(let s=0;s<t.length;s++){let o=new FileReader;o.onerror=a,o.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(o.result)||(n[s]=o.result),a()},o.readAsText(t[s])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return bx(r,e,n,!0),!0}return!1};gn.paste=(r,e)=>{if(r.state.readOnly)return!0;r.observer.flush();let t=T1?null:e.clipboardData;return t?(A1(r,t.getData("text/plain")||t.getData("text/uri-list")),!0):(R5(r),!1)};function F5(r,e){let t=r.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),r.focus()},50)}function _5(r){let e=[],t=[],n=!1;for(let i of r.selection.ranges)i.empty||(e.push(r.sliceDoc(i.from,i.to)),t.push(i));if(!e.length){let i=-1;for(let{from:a}of r.selection.ranges){let s=r.doc.lineAt(a);s.number>i&&(e.push(s.text),t.push({from:s.from,to:Math.min(r.doc.length,s.to+1)})),i=s.number}n=!0}return{text:Vh(r,rg,e.join(r.lineBreak)),ranges:t,linewise:n}}var Mp=null;gn.copy=gn.cut=(r,e)=>{let{text:t,ranges:n,linewise:i}=_5(r.state);if(!t&&!i)return!1;Mp=i?t:null,e.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let a=T1?null:e.clipboardData;return a?(a.clearData(),a.setData("text/plain",t),!0):(F5(r,t),!1)};var D1=H.Annotation.define();function P1(r,e){let t=[];for(let n of r.facet(c1)){let i=n(r,e);i&&t.push(i)}return t.length?r.update({effects:t,annotations:D1.of(!0)}):null}function B1(r){setTimeout(()=>{let e=r.hasFocus;if(e!=r.inputState.notifiedFocused){let t=P1(r.state,e);t?r.dispatch(t):r.update([])}},10)}$r.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),B1(r)};$r.blur=r=>{r.observer.clearSelectionRange(),B1(r)};$r.compositionstart=$r.compositionupdate=r=>{r.observer.editContext||(r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0))};$r.compositionend=r=>{r.observer.editContext||(r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionPendingKey=!0,r.inputState.compositionPendingChange=r.observer.pendingRecords().length>0,r.inputState.compositionFirstChange=null,he.chrome&&he.android?r.observer.flushSoon():r.inputState.compositionPendingChange?Promise.resolve().then(()=>r.observer.flush()):setTimeout(()=>{r.inputState.composing<0&&r.docView.hasComposition&&r.update([])},50))};$r.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()};gn.beforeinput=(r,e)=>{var t,n;if(e.inputType=="insertReplacementText"&&r.observer.editContext){let a=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),s=e.getTargetRanges();if(a&&s.length){let o=s[0],l=r.posAtDOM(o.startContainer,o.startOffset),u=r.posAtDOM(o.endContainer,o.endOffset);return ag(r,{from:l,to:u,insert:r.state.toText(a)},null),!0}}let i;if(he.chrome&&he.android&&(i=k1.find(a=>a.inputType==e.inputType))&&(r.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let a=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var s;(((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0)>a+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}return he.ios&&e.inputType=="deleteContentForward"&&r.observer.flushSoon(),he.safari&&e.inputType=="insertText"&&r.inputState.composing>=0&&setTimeout(()=>$r.compositionend(r,e),20),!1};var wx=new Set;function z5(r){wx.has(r)||(wx.add(r),r.addEventListener("copy",()=>{}),r.addEventListener("cut",()=>{}))}var xx=["pre-wrap","normal","pre-line","break-spaces"],ma=!1;function Dp(){ma=!1}var Dh=class{constructor(e){this.lineWrapping=e,this.doc=H.Text.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return xx.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let i=e[n];i<0?n++:this.heightSamples[Math.floor(i*10)]||(t=!0,this.heightSamples[Math.floor(i*10)]=!0)}return t}refresh(e,t,n,i,a,s){let o=xx.indexOf(e)>-1,l=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=o;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=n,this.textHeight=i,this.lineLength=a,l){this.heightSamples={};for(let u=0;u<s.length;u++){let h=s[u];h<0?u++:this.heightSamples[Math.floor(h*10)]=!0}}return l}},Ph=class{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}},fn=class r{constructor(e,t,n,i,a){this.from=e,this.length=t,this.top=n,this.height=i,this._content=a}get type(){return typeof this._content=="number"?ae.BlockType.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof ki?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new r(this.from,this.length+e.length,this.top,this.height+e.height,t)}},dt;(function(r){r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight"})(dt||(dt={}));var wh=.001,Ar=class r{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>wh&&(ma=!0),this.height=e)}replace(e,t,n){return r.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,i){let a=this,s=n.doc;for(let o=i.length-1;o>=0;o--){let{fromA:l,toA:u,fromB:h,toB:f}=i[o],c=a.lineAt(l,dt.ByPosNoHeight,n.setDoc(t),0,0),d=c.to>=u?c:a.lineAt(u,dt.ByPosNoHeight,n,0,0);for(f+=d.to-u,u=d.to;o>0&&c.from<=i[o-1].toA;)l=i[o-1].fromA,h=i[o-1].fromB,o--,l<c.from&&(c=a.lineAt(l,dt.ByPosNoHeight,n,0,0));h+=c.from-l,l=c.from;let p=Bp.build(n.setDoc(s),e,h,f);a=Bh(a,a.replace(l,u,p))}return a.updateHeight(n,0)}static empty(){return new Xr(0,0)}static of(e){if(e.length==1)return e[0];let t=0,n=e.length,i=0,a=0;for(;;)if(t==n)if(i>a*2){let o=e[t-1];o.break?e.splice(--t,1,o.left,null,o.right):e.splice(--t,1,o.left,o.right),n+=1+o.break,i-=o.size}else if(a>i*2){let o=e[n];o.break?e.splice(n,1,o.left,null,o.right):e.splice(n,1,o.left,o.right),n+=2+o.break,a-=o.size}else break;else if(i<a){let o=e[t++];o&&(i+=o.size)}else{let o=e[--n];o&&(a+=o.size)}let s=0;return e[t-1]==null?(s=1,t--):e[t]==null&&(s=1,n++),new Pp(r.of(e.slice(0,t)),s,r.of(e.slice(n)))}};function Bh(r,e){return r==e?r:(r.constructor!=e.constructor&&(ma=!0),e)}Ar.prototype.size=1;var Oh=class extends Ar{constructor(e,t,n){super(e,t),this.deco=n}blockAt(e,t,n,i){return new fn(i,this.length,n,this.height,this.deco||0)}lineAt(e,t,n,i,a){return this.blockAt(0,n,i,a)}forEachLine(e,t,n,i,a,s){e<=a+this.length&&t>=a&&s(this.blockAt(0,n,i,a))}updateHeight(e,t=0,n=!1,i){return i&&i.from<=t&&i.more&&this.setHeight(i.heights[i.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}},Xr=class r extends Oh{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,n,i){return new fn(i,this.length,n,this.height,this.breaks)}replace(e,t,n){let i=n[0];return n.length==1&&(i instanceof r||i instanceof Si&&i.flags&4)&&Math.abs(this.length-i.length)<10?(i instanceof Si?i=new r(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):Ar.of(n)}updateHeight(e,t=0,n=!1,i){return i&&i.from<=t&&i.more?this.setHeight(i.heights[i.index++]):(n||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}},Si=class r extends Ar{constructor(e){super(e,0)}heightMetrics(e,t){let n=e.doc.lineAt(t).number,i=e.doc.lineAt(t+this.length).number,a=i-n+1,s,o=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*a);s=l/a,this.length>a+1&&(o=(this.height-l)/(this.length-a-1))}else s=this.height/a;return{firstLine:n,lastLine:i,perLine:s,perChar:o}}blockAt(e,t,n,i){let{firstLine:a,lastLine:s,perLine:o,perChar:l}=this.heightMetrics(t,i);if(t.lineWrapping){let u=i+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),h=t.doc.lineAt(u),f=o+h.length*l,c=Math.max(n,e-f/2);return new fn(h.from,h.length,c,f,0)}else{let u=Math.max(0,Math.min(s-a,Math.floor((e-n)/o))),{from:h,length:f}=t.doc.line(a+u);return new fn(h,f,n+o*u,o,0)}}lineAt(e,t,n,i,a){if(t==dt.ByHeight)return this.blockAt(e,n,i,a);if(t==dt.ByPosNoHeight){let{from:d,to:p}=n.doc.lineAt(e);return new fn(d,p-d,0,0,0)}let{firstLine:s,perLine:o,perChar:l}=this.heightMetrics(n,a),u=n.doc.lineAt(e),h=o+u.length*l,f=u.number-s,c=i+o*f+l*(u.from-a-f);return new fn(u.from,u.length,Math.max(i,Math.min(c,i+this.height-h)),h,0)}forEachLine(e,t,n,i,a,s){e=Math.max(e,a),t=Math.min(t,a+this.length);let{firstLine:o,perLine:l,perChar:u}=this.heightMetrics(n,a);for(let h=e,f=i;h<=t;){let c=n.doc.lineAt(h);if(h==e){let p=c.number-o;f+=l*p+u*(e-a-p)}let d=l+u*c.length;s(new fn(c.from,c.length,f,d,0)),f+=d,h=c.to+1}}replace(e,t,n){let i=this.length-t;if(i>0){let a=n[n.length-1];a instanceof r?n[n.length-1]=new r(a.length+i):n.push(null,new r(i-1))}if(e>0){let a=n[0];a instanceof r?n[0]=new r(e+a.length):n.unshift(new r(e-1),null)}return Ar.of(n)}decomposeLeft(e,t){t.push(new r(e-1),null)}decomposeRight(e,t){t.push(null,new r(this.length-e-1))}updateHeight(e,t=0,n=!1,i){let a=t+this.length;if(i&&i.from<=t+this.length&&i.more){let s=[],o=Math.max(t,i.from),l=-1;for(i.from>t&&s.push(new r(i.from-t-1).updateHeight(e,t));o<=a&&i.more;){let h=e.doc.lineAt(o).length;s.length&&s.push(null);let f=i.heights[i.index++];l==-1?l=f:Math.abs(f-l)>=wh&&(l=-2);let c=new Xr(h,f);c.outdated=!1,s.push(c),o+=h+1}o<=a&&s.push(null,new r(a-o).updateHeight(e,o));let u=Ar.of(s);return(l<0||Math.abs(u.height-this.height)>=wh||Math.abs(l-this.heightMetrics(e,t).perLine)>=wh)&&(ma=!0),Bh(this,u)}else(n||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}},Pp=class extends Ar{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,t,n,i){let a=n+this.left.height;return e<a?this.left.blockAt(e,t,n,i):this.right.blockAt(e,t,a,i+this.left.length+this.break)}lineAt(e,t,n,i,a){let s=i+this.left.height,o=a+this.left.length+this.break,l=t==dt.ByHeight?e<s:e<o,u=l?this.left.lineAt(e,t,n,i,a):this.right.lineAt(e,t,n,s,o);if(this.break||(l?u.to<o:u.from>o))return u;let h=t==dt.ByPosNoHeight?dt.ByPosNoHeight:dt.ByPos;return l?u.join(this.right.lineAt(o,h,n,s,o)):this.left.lineAt(o,h,n,i,a).join(u)}forEachLine(e,t,n,i,a,s){let o=i+this.left.height,l=a+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,n,i,a,s),t>=l&&this.right.forEachLine(e,t,n,o,l,s);else{let u=this.lineAt(l,dt.ByPos,n,i,a);e<u.from&&this.left.forEachLine(e,u.from-1,n,i,a,s),u.to>=e&&u.from<=t&&s(u),t>u.to&&this.right.forEachLine(u.to+1,t,n,o,l,s)}}replace(e,t,n){let i=this.left.length+this.break;if(t<i)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,t-i,n));let a=[];e>0&&this.decomposeLeft(e,a);let s=a.length;for(let o of n)a.push(o);if(e>0&&Sx(a,s-1),t<this.length){let o=a.length;this.decomposeRight(t,a),Sx(a,o)}return Ar.of(a)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,i=n+this.break;if(e>=i)return this.right.decomposeRight(e-i,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<i&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Ar.of(this.break?[e,null,t]:[e,t]):(this.left=Bh(this.left,e),this.right=Bh(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,i){let{left:a,right:s}=this,o=t+a.length+this.break,l=null;return i&&i.from<=t+a.length&&i.more?l=a=a.updateHeight(e,t,n,i):a.updateHeight(e,t,n),i&&i.from<=o+s.length&&i.more?l=s=s.updateHeight(e,o,n,i):s.updateHeight(e,o,n),l?this.balanced(a,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}};function Sx(r,e){let t,n;r[e]==null&&(t=r[e-1])instanceof Si&&(n=r[e+1])instanceof Si&&r.splice(e-1,3,new Si(t.length+1+n.length))}var V5=5,Bp=class r{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let n=Math.min(t,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof Xr?i.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new Xr(n-this.pos,-1)),this.writtenTo=n,t>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let i=n.widget?n.widget.estimatedHeight:0,a=n.widget?n.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let s=t-e;n.block?this.addBlock(new Oh(s,i,n)):(s||a||i>=V5)&&this.addLineDeco(i,a,s)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Xr(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new Si(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Xr)return e;let t=new Xr(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,n){let i=this.ensureLine();i.length+=n,i.collapsed+=n,i.widgetHeight=Math.max(i.widgetHeight,e),i.breaks+=t,this.writtenTo=this.pos=this.pos+n}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Xr)&&!this.isCovered?this.nodes.push(new Xr(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let i of this.nodes)i instanceof Xr&&i.updateHeight(this.oracle,n),n+=i?i.length:1;return this.nodes}static build(e,t,n,i){let a=new r(n,e);return H.RangeSet.spans(t,n,i,a,0),a.finish(n)}};function H5(r,e,t){let n=new Op;return H.RangeSet.compare(r,e,t,n,0),n.changes}var Op=class{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,i){(e<t||n&&n.heightRelevant||i&&i.heightRelevant)&&yh(e,t,this.changes,5)}};function W5(r,e){let t=r.getBoundingClientRect(),n=r.ownerDocument,i=n.defaultView||window,a=Math.max(0,t.left),s=Math.min(i.innerWidth,t.right),o=Math.max(0,t.top),l=Math.min(i.innerHeight,t.bottom);for(let u=r.parentNode;u&&u!=n.body;)if(u.nodeType==1){let h=u,f=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&f.overflow!="visible"){let c=h.getBoundingClientRect();a=Math.max(a,c.left),s=Math.min(s,c.right),o=Math.max(o,c.top),l=Math.min(u==r.parentNode?i.innerHeight:l,c.bottom)}u=f.position=="absolute"||f.position=="fixed"?h.offsetParent:h.parentNode}else if(u.nodeType==11)u=u.host;else break;return{left:a-t.left,right:Math.max(a,s)-t.left,top:o-(t.top+e),bottom:Math.max(o,l)-(t.top+e)}}function G5(r){let e=r.getBoundingClientRect(),t=r.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function U5(r,e){let t=r.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}var Ho=class{constructor(e,t,n,i){this.from=e,this.to=t,this.size=n,this.displaySize=i}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let i=e[n],a=t[n];if(i.from!=a.from||i.to!=a.to||i.size!=a.size)return!1}return!0}draw(e,t){return ot.replace({widget:new Rp(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}},Rp=class extends $n{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}},Rh=class{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Cx,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=ae.Direction.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(zh).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new Dh(t),this.stateDeco=e.facet(Qo).filter(n=>typeof n!="function"),this.heightMap=Ar.empty().applyChanges(this.stateDeco,H.Text.empty,this.heightOracle.setDoc(e.doc),[new pn(0,0,0,e.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ot.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let i=n?t.head:t.anchor;if(!e.some(({from:a,to:s})=>i>=a&&i<=s)){let{from:a,to:s}=this.lineBlockAt(i);e.push(new fs(a,s))}}return this.viewports=e.sort((n,i)=>n.from-i.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?Cx:new Lp(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(No(e,this.scaler))})}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(Qo).filter(h=>typeof h!="function");let i=e.changedRanges,a=pn.extendWithRanges(i,H5(n,this.stateDeco,e?e.changes:H.ChangeSet.empty(this.state.doc.length))),s=this.heightMap.height,o=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);Dp(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),a),(this.heightMap.height!=s||ma)&&(e.flags|=2),o?(this.scrollAnchorPos=e.changes.mapPos(o.from,-1),this.scrollAnchorHeight=o.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=s);let l=a.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let u=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(u||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(p1)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),i=this.heightOracle,a=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?ae.Direction.RTL:ae.Direction.LTR;let s=this.heightOracle.mustRefreshForWrapping(a),o=t.getBoundingClientRect(),l=s||this.mustMeasureContent||this.contentDOMHeight!=o.height;this.contentDOMHeight=o.height,this.mustMeasureContent=!1;let u=0,h=0;if(o.width&&o.height){let{scaleX:w,scaleY:S}=zx(t,o);(w>.005&&Math.abs(this.scaleX-w)>.005||S>.005&&Math.abs(this.scaleY-S)>.005)&&(this.scaleX=w,this.scaleY=S,u|=16,s=l=!0)}let f=(parseInt(n.paddingTop)||0)*this.scaleY,c=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=f||this.paddingBottom!=c)&&(this.paddingTop=f,this.paddingBottom=c,u|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,u|=16);let d=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=Wx(e.scrollDOM);let p=(this.printing?U5:W5)(t,this.paddingTop),g=p.top-this.pixelViewport.top,v=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let m=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(m!=this.inView&&(this.inView=m,m&&(l=!0)),!this.inView&&!this.scrollTarget&&!G5(e.dom))return 0;let y=o.width;if((this.contentDOMWidth!=y||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=o.width,this.editorHeight=e.scrollDOM.clientHeight,u|=16),l){let w=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(w)&&(s=!0),s||i.lineWrapping&&Math.abs(y-this.contentDOMWidth)>i.charWidth){let{lineHeight:S,charWidth:C,textHeight:x}=e.docView.measureTextSize();s=S>0&&i.refresh(a,S,C,x,y/C,w),s&&(e.docView.minWidth=0,u|=16)}g>0&&v>0?h=Math.max(g,v):g<0&&v<0&&(h=Math.min(g,v)),Dp();for(let S of this.viewports){let C=S.from==this.viewport.from?w:e.docView.measureVisibleLineHeights(S);this.heightMap=(s?Ar.empty().applyChanges(this.stateDeco,H.Text.empty,this.heightOracle,[new pn(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(i,0,s,new Ph(S.from,C))}ma&&(u|=2)}let b=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return b&&(u&2&&(u|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),u|=this.updateForViewport()),(u&2||b)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(s?[]:this.lineGaps,e)),u|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),u}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,a=this.heightOracle,{visibleTop:s,visibleBottom:o}=this,l=new fs(i.lineAt(s-n*1e3,dt.ByHeight,a,0,0).from,i.lineAt(o+(1-n)*1e3,dt.ByHeight,a,0,0).to);if(t){let{head:u}=t.range;if(u<l.from||u>l.to){let h=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),f=i.lineAt(u,dt.ByPos,a,0,0),c;t.y=="center"?c=(f.top+f.bottom)/2-h/2:t.y=="start"||t.y=="nearest"&&u<l.from?c=f.top:c=f.bottom-h,l=new fs(i.lineAt(c-1e3/2,dt.ByHeight,a,0,0).from,i.lineAt(c+h+1e3/2,dt.ByHeight,a,0,0).to)}}return l}mapViewport(e,t){let n=t.mapPos(e.from,-1),i=t.mapPos(e.to,1);return new fs(this.heightMap.lineAt(n,dt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,dt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,dt.ByPos,this.heightOracle,0,0),{bottom:a}=this.heightMap.lineAt(t,dt.ByPos,this.heightOracle,0,0),{visibleTop:s,visibleBottom:o}=this;return(e==0||i<=s-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||a>=o+Math.max(10,Math.min(n,250)))&&i>s-2*1e3&&a<o+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let i of e)t.touchesRange(i.from,i.to)||n.push(new Ho(t.mapPos(i.from),t.mapPos(i.to),i.size,i.displaySize));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,i=n?1e4:2e3,a=i>>1,s=i<<1;if(this.defaultTextDirection!=ae.Direction.LTR&&!n)return[];let o=[],l=(h,f,c,d)=>{if(f-h<a)return;let p=this.state.selection.main,g=[p.from];p.empty||g.push(p.to);for(let m of g)if(m>h&&m<f){l(h,m-10,c,d),l(m+10,f,c,d);return}let v=j5(e,m=>m.from>=c.from&&m.to<=c.to&&Math.abs(m.from-h)<a&&Math.abs(m.to-f)<a&&!g.some(y=>m.from<y&&m.to>y));if(!v){if(f<c.to&&t&&n&&t.visibleRanges.some(b=>b.from<=f&&b.to>=f)){let b=t.moveToLineBoundary(H.EditorSelection.cursor(f),!1,!0).head;b>h&&(f=b)}let m=this.gapSize(c,h,f,d),y=n||m<2e6?m:2e6;v=new Ho(h,f,m,y)}o.push(v)},u=h=>{if(h.length<s||h.type!=ae.BlockType.Text)return;let f=K5(h.from,h.to,this.stateDeco);if(f.total<s)return;let c=this.scrollTarget?this.scrollTarget.range.head:null,d,p;if(n){let g=i/this.heightOracle.lineLength*this.heightOracle.lineHeight,v,m;if(c!=null){let y=dh(f,c),b=((this.visibleBottom-this.visibleTop)/2+g)/h.height;v=y-b,m=y+b}else v=(this.visibleTop-h.top-g)/h.height,m=(this.visibleBottom-h.top+g)/h.height;d=ch(f,v),p=ch(f,m)}else{let g=f.total*this.heightOracle.charWidth,v=i*this.heightOracle.charWidth,m=0;if(g>2e6)for(let C of e)C.from>=h.from&&C.from<h.to&&C.size!=C.displaySize&&C.from*this.heightOracle.charWidth+m<this.pixelViewport.left&&(m=C.size-C.displaySize);let y=this.pixelViewport.left+m,b=this.pixelViewport.right+m,w,S;if(c!=null){let C=dh(f,c),x=((b-y)/2+v)/g;w=C-x,S=C+x}else w=(y-v)/g,S=(b+v)/g;d=ch(f,w),p=ch(f,S)}d>h.from&&l(h.from,d,h,f),p<h.to&&l(p,h.to,h,f)};for(let h of this.viewportLines)Array.isArray(h.type)?h.type.forEach(u):u(h);return o}gapSize(e,t,n,i){let a=dh(i,n)-dh(i,t);return this.heightOracle.lineWrapping?e.height*a:i.total*this.heightOracle.charWidth*a}updateLineGaps(e){Ho.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=ot.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let n=[];H.RangeSet.spans(t,this.viewport.from,this.viewport.to,{span(a,s){n.push({from:a,to:s})},point(){}},20);let i=0;if(n.length!=this.visibleRanges.length)i=12;else for(let a=0;a<n.length&&!(i&8);a++){let s=this.visibleRanges[a],o=n[a];(s.from!=o.from||s.to!=o.to)&&(i|=4,e&&e.mapPos(s.from,-1)==o.from&&e.mapPos(s.to,1)==o.to||(i|=8))}return this.visibleRanges=n,i}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||No(this.heightMap.lineAt(e,dt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||No(this.heightMap.lineAt(this.scaler.fromDOM(e),dt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return No(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}},fs=class{constructor(e,t){this.from=e,this.to=t}};function K5(r,e,t){let n=[],i=r,a=0;return H.RangeSet.spans(t,r,e,{span(){},point(s,o){s>i&&(n.push({from:i,to:s}),a+=s-i),i=o}},20),i<e&&(n.push({from:i,to:e}),a+=e-i),{total:a,ranges:n}}function ch({total:r,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let n=Math.floor(r*t);for(let i=0;;i++){let{from:a,to:s}=e[i],o=s-a;if(n<=o)return a+n;n-=o}}function dh(r,e){let t=0;for(let{from:n,to:i}of r.ranges){if(e<=i){t+=e-n;break}t+=i-n}return t/r.total}function j5(r,e){for(let t of r)if(e(t))return t}var Cx={toDOM(r){return r},fromDOM(r){return r},scale:1,eq(r){return r==this}},Lp=class r{constructor(e,t,n){let i=0,a=0,s=0;this.viewports=n.map(({from:o,to:l})=>{let u=t.lineAt(o,dt.ByPos,e,0,0).top,h=t.lineAt(l,dt.ByPos,e,0,0).bottom;return i+=h-u,{from:o,to:l,top:u,bottom:h,domTop:0,domBottom:0}}),this.scale=(7e6-i)/(t.height-i);for(let o of this.viewports)o.domTop=s+(o.top-a)*this.scale,s=o.domBottom=o.domTop+(o.bottom-o.top),a=o.bottom}toDOM(e){for(let t=0,n=0,i=0;;t++){let a=t<this.viewports.length?this.viewports[t]:null;if(!a||e<a.top)return i+(e-n)*this.scale;if(e<=a.bottom)return a.domTop+(e-a.top);n=a.bottom,i=a.domBottom}}fromDOM(e){for(let t=0,n=0,i=0;;t++){let a=t<this.viewports.length?this.viewports[t]:null;if(!a||e<a.domTop)return n+(e-i)/this.scale;if(e<=a.domBottom)return a.top+(e-a.domTop);n=a.bottom,i=a.domBottom}}eq(e){return e instanceof r?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,n)=>t.from==e.viewports[n].from&&t.to==e.viewports[n].to):!1}};function No(r,e){if(e.scale==1)return r;let t=e.toDOM(r.top),n=e.toDOM(r.bottom);return new fn(r.from,r.length,t,n-t,Array.isArray(r._content)?r._content.map(i=>No(i,e)):r._content)}var ph=H.Facet.define({combine:r=>r.join(" ")}),Ip=H.Facet.define({combine:r=>r.indexOf(!0)>-1}),Np=gs.StyleModule.newName(),O1=gs.StyleModule.newName(),R1=gs.StyleModule.newName(),L1={"&light":"."+O1,"&dark":"."+R1};function qp(r,e,t){return new gs.StyleModule(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,i=>{if(i=="&")return r;if(!t||!t[i])throw new RangeError(`Unsupported selector: ${i}`);return t[i]}):r+" "+n}})}var Y5=qp("."+Np,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},L1),X5={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},lp=he.ie&&he.ie_version<=11,Fp=class{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new cp,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let n of t)this.queue.push(n);(he.ie&&he.ie_version<=11||he.ios&&e.composing)&&t.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(he.chrome&&he.chrome_version<126)&&(this.editContext=new _p(e),e.state.facet(Xn)&&(e.contentDOM.editContext=this.editContext.editContext)),lp&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,n)=>t!=e[n]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,i=this.selectionRange;if(n.state.facet(Xn)?n.root.activeElement!=this.dom:!mh(this.dom,i))return;let a=i.anchorNode&&n.docView.nearest(i.anchorNode);if(a&&a.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(he.ie&&he.ie_version<=11||he.android&&he.chrome)&&!n.state.selection.main.empty&&i.focusNode&&Fo(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Ko(e.root);if(!t)return!1;let n=he.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&$5(this.view,t)||t;if(!n||this.selectionRange.eq(n))return!1;let i=mh(this.dom,n);return i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&Uz(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),i&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(n.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=t)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,X5),lp&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),lp&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let i=()=>{let a=this.delayedAndroidKey;a&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=a.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&a.force&&ps(this.dom,a.key,a.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(i)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,i=!1;for(let a of e){let s=this.readMutation(a);s&&(s.typeOver&&(i=!0),t==-1?{from:t,to:n}=s:(t=Math.min(s.from,t),n=Math.max(s.to,n)))}return{from:t,to:n,typeOver:i}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),i=this.selectionChanged&&mh(this.dom,this.selectionRange);if(e<0&&!i)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let a=new Ep(this.view,e,t,n);return this.view.docView.domChanged={newSel:a.newSel?a.newSel.main:null},a}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let n=this.view.state,i=C1(this.view,t);return this.view.state==n&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),i}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let n=kx(t,e.previousSibling||e.target.previousSibling,-1),i=kx(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:i?t.posBefore(i):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(Xn)!=e.state.facet(Xn)&&(e.view.contentDOM.editContext=e.state.facet(Xn)?this.editContext.editContext:null))}destroy(){var e,t,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}};function kx(r,e,t){for(;e;){let n=pt.get(e);if(n&&n.parent==r)return n;let i=e.parentNode;e=i!=r.dom?i:t>0?e.nextSibling:e.previousSibling}return null}function Ex(r,e){let t=e.startContainer,n=e.startOffset,i=e.endContainer,a=e.endOffset,s=r.docView.domAtPos(r.state.selection.main.anchor);return Fo(s.node,s.offset,i,a)&&([t,n,i,a]=[i,a,t,n]),{anchorNode:t,anchorOffset:n,focusNode:i,focusOffset:a}}function $5(r,e){if(e.getComposedRanges){let i=e.getComposedRanges(r.root)[0];if(i)return Ex(r,i)}let t=null;function n(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return r.contentDOM.addEventListener("beforeinput",n,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",n,!0),t?Ex(r,t):null}var _p=class{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=n=>{let i=e.state.selection.main,{anchor:a,head:s}=i,o=this.toEditorPos(n.updateRangeStart),l=this.toEditorPos(n.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:n.updateRangeStart,editorBase:o,drifted:!1});let u={from:o,to:l,insert:H.Text.of(n.text.split(`
`))};if(u.from==this.from&&a<this.from?u.from=a:u.to==this.to&&a>this.to&&(u.to=a),u.from==u.to&&!u.insert.length){let h=H.EditorSelection.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd));h.main.eq(i)||e.dispatch({selection:h,userEvent:"select"});return}if((he.mac||he.android)&&u.from==s-1&&/^\. ?$/.test(n.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(u={from:o,to:l,insert:H.Text.of([n.text.replace("."," ")])}),this.pendingContextChange=u,!e.state.readOnly){let h=this.to-this.from+(u.to-u.from+u.insert.length);ag(e,u,H.EditorSelection.single(this.toEditorPos(n.selectionStart,h),this.toEditorPos(n.selectionEnd,h)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=n=>{let i=[],a=null;for(let s=this.toEditorPos(n.rangeStart),o=this.toEditorPos(n.rangeEnd);s<o;s++){let l=e.coordsForChar(s);a=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||a||new DOMRect,i.push(a)}t.updateCharacterBounds(n.rangeStart,i)},this.handlers.textformatupdate=n=>{let i=[];for(let a of n.getTextFormats()){let s=a.underlineStyle,o=a.underlineThickness;if(s!="None"&&o!="None"){let l=this.toEditorPos(a.rangeStart),u=this.toEditorPos(a.rangeEnd);if(l<u){let h=`text-decoration: underline ${s=="Dashed"?"dashed ":s=="Squiggle"?"wavy ":""}${o=="Thin"?1:2}px`;i.push(ot.mark({attributes:{style:h}}).range(l,u))}}}e.dispatch({effects:v1.of(ot.set(i))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:n}=this.composing;this.composing=null,n&&this.reset(e.state)}};for(let n in this.handlers)t.addEventListener(n,this.handlers[n]);this.measureReq={read:n=>{this.editContext.updateControlBounds(n.contentDOM.getBoundingClientRect());let i=Ko(n.root);i&&i.rangeCount&&this.editContext.updateSelectionBounds(i.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,n=!1,i=this.pendingContextChange;return e.changes.iterChanges((a,s,o,l,u)=>{if(n)return;let h=u.length-(s-a);if(i&&s>=i.to)if(i.from==a&&i.to==s&&i.insert.eq(u)){i=this.pendingContextChange=null,t+=h,this.to+=h;return}else i=null,this.revertPending(e.state);if(a+=t,s+=t,s<=this.from)this.from+=h,this.to+=h;else if(a<this.to){if(a<this.from||s>this.to||this.to-this.from+u.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(a),this.toContextPos(s),u.toString()),this.to+=h}t+=h}),i&&!n&&this.revertPending(e.state),!n}update(e){let t=this.pendingContextChange,n=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(n.from,n.to)&&e.transactions.some(i=>!i.isUserEvent("input.type")&&i.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),i=this.toContextPos(t.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=i)&&this.editContext.updateSelection(n,i)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let n=this.composing;return n&&n.drifted?n.editorBase+(e-n.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}},je=class r{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(i=>i.forEach(a=>n(a,this)))||(i=>this.update(i)),this.dispatch=this.dispatch.bind(this),this._root=e.root||Gz(e.parent)||document,this.viewState=new Rh(e.state||H.EditorState.create(e)),e.scrollTo&&e.scrollTo.is(uh)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Ro).map(i=>new Vo(i));for(let i of this.plugins)i.update(this);this.observer=new Fp(this),this.inputState=new Tp(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Ah(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof H.Transaction?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,n=!1,i,a=this.state;for(let c of e){if(c.startState!=a)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");a=c.state}if(this.destroyed){this.viewState.state=a;return}let s=this.hasFocus,o=0,l=null;e.some(c=>c.annotation(D1))?(this.inputState.notifiedFocused=s,o=1):s!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=s,l=P1(a,s),l||(o=1));let u=this.observer.delayedAndroidKey,h=null;if(u?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(a.doc)||!this.state.selection.eq(a.selection))&&(h=null)):this.observer.clear(),a.facet(H.EditorState.phrases)!=this.state.facet(H.EditorState.phrases))return this.setState(a);i=Jo.create(this,a,e),i.flags|=o;let f=this.viewState.scrollTarget;try{this.updateState=2;for(let c of e){if(f&&(f=f.map(c.changes)),c.scrollIntoView){let{main:d}=c.state.selection;f=new zo(d.empty?d:H.EditorSelection.cursor(d.head,d.head>d.anchor?-1:1))}for(let d of c.effects)d.is(uh)&&(f=d.value.clip(this.state))}this.viewState.update(i,f),this.bidiCache=Lh.update(this.bidiCache,i.changes),i.empty||(this.updatePlugins(i),this.inputState.update(i)),t=this.docView.update(i),this.state.facet(Lo)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(c=>c.isUserEvent("select.pointer")))}finally{this.updateState=0}if(i.startState.facet(ph)!=i.state.facet(ph)&&(this.viewState.mustMeasureContent=!0),(t||n||f||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!i.empty)for(let c of this.state.facet(xp))try{c(i)}catch(d){dn(this.state,d,"update listener")}(l||h)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),h&&!C1(this,h)&&u.force&&ps(this.contentDOM,u.key,u.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new Rh(e),this.plugins=e.facet(Ro).map(n=>new Vo(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new Ah(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Ro),n=e.state.facet(Ro);if(t!=n){let i=[];for(let a of n){let s=t.indexOf(a);if(s<0)i.push(new Vo(a));else{let o=this.plugins[s];o.mustUpdate=e,i.push(o)}}for(let a of this.plugins)a.mustUpdate!=e&&a.destroy(this);this.plugins=i,this.pluginMap.clear()}else for(let i of this.plugins)i.mustUpdate=e;for(let i=0;i<this.plugins.length;i++)this.plugins[i].update(this);t!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(n){dn(this.state,n,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,n=this.scrollDOM,i=n.scrollTop*this.scaleY,{scrollAnchorPos:a,scrollAnchorHeight:s}=this.viewState;Math.abs(i-this.viewState.scrollTop)>1&&(s=-1),this.viewState.scrollAnchorHeight=-1;try{for(let o=0;;o++){if(s<0)if(Wx(n))a=-1,s=this.viewState.heightMap.height;else{let d=this.viewState.scrollAnchorAt(i);a=d.from,s=d.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(o>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let u=[];l&4||([this.measureRequests,u]=[u,this.measureRequests]);let h=u.map(d=>{try{return d.read(this)}catch(p){return dn(this.state,p),Tx}}),f=Jo.create(this,this.state,[]),c=!1;f.flags|=l,t?t.flags|=l:t=f,this.updateState=2,f.empty||(this.updatePlugins(f),this.inputState.update(f),this.updateAttrs(),c=this.docView.update(f),c&&this.docViewUpdate());for(let d=0;d<u.length;d++)if(h[d]!=Tx)try{let p=u[d];p.write&&p.write(h[d],this)}catch(p){dn(this.state,p)}if(c&&this.docView.updateSelection(!0),!f.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,s=-1;continue}else{let p=(a<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(a).top)-s;if(p>1||p<-1){i=i+p,n.scrollTop=i/this.scaleY,s=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let o of this.state.facet(xp))o(t)}get themeClasses(){return Np+" "+(this.state.facet(Ip)?R1:O1)+" "+this.state.facet(ph)}updateAttrs(){let e=Ax(this,m1,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Xn)?"true":"false",class:"cm-content",style:`${he.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),Ax(this,zh,t);let n=this.observer.ignore(()=>{let i=mp(this.contentDOM,this.contentAttrs,t),a=mp(this.dom,this.editorAttrs,e);return i||a});return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(e){let t=!0;for(let n of e)for(let i of n.effects)if(i.is(r.announce)){t&&(this.announceDOM.textContent=""),t=!1;let a=this.announceDOM.appendChild(document.createElement("div"));a.textContent=i.value}}mountStyles(){this.styleModules=this.state.facet(Lo);let e=this.state.facet(r.cspNonce);gs.StyleModule.mount(this.root,this.styleModules.concat(Y5).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(n=>n.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return op(this,e,fx(this,e,t,n))}moveByGroup(e,t){return op(this,e,fx(this,e,t,n=>b5(this,e.head,n)))}visualLineSide(e,t){let n=this.bidiSpans(e),i=this.textDirectionAt(e.from),a=n[t?n.length-1:0];return H.EditorSelection.cursor(a.side(t,i)+e.from,a.forward(!t,i)?1:-1)}moveToLineBoundary(e,t,n=!0){return y5(this,e,t,n)}moveVertically(e,t,n){return op(this,e,w5(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),S1(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let i=this.state.doc.lineAt(e),a=this.bidiSpans(i),s=a[cn.find(a,e-i.from,-1,t)];return tl(n,s.dir==ae.Direction.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(d1)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Z5)return i1(e.length);let t=this.textDirectionAt(e.from),n;for(let a of this.bidiCache)if(a.from==e.from&&a.dir==t&&(a.fresh||r1(a.isolates,n=sx(this,e))))return a.order;n||(n=sx(this,e));let i=n1(e.text,t,n);return this.bidiCache.push(new Lh(e.from,e.to,t,n,!0,i)),i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||he.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Vx(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return uh.of(new zo(typeof e=="number"?H.EditorSelection.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return uh.of(new zo(H.EditorSelection.cursor(n.from),"start","start",n.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return er.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return er.define(()=>({}),{eventObservers:e})}static theme(e,t){let n=gs.StyleModule.newName(),i=[ph.of(n),Lo.of(qp(`.${n}`,e))];return t&&t.dark&&i.push(Ip.of(!0)),i}static baseTheme(e){return H.Prec.lowest(Lo.of(qp("."+Np,e,L1)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),i=n&&pt.get(n)||pt.get(e);return((t=i?.rootView)===null||t===void 0?void 0:t.view)||null}};je.styleModule=Lo;je.inputHandler=f1;je.clipboardInputFilter=tg;je.clipboardOutputFilter=rg;je.scrollHandler=g1;je.focusChangeEffect=c1;je.perLineTextDirection=d1;je.exceptionSink=h1;je.updateListener=xp;je.editable=Xn;je.mouseSelectionStyle=u1;je.dragMovesSelection=l1;je.clickAddsSelectionRange=o1;je.decorations=Qo;je.outerDecorations=y1;je.atomicRanges=ng;je.bidiIsolatedRanges=b1;je.scrollMargins=w1;je.darkTheme=Ip;je.cspNonce=H.Facet.define({combine:r=>r.length?r[0]:""});je.contentAttributes=zh;je.editorAttributes=m1;je.lineWrapping=je.contentAttributes.of({class:"cm-lineWrapping"});je.announce=H.StateEffect.define();var Z5=4096,Tx={},Lh=class r{constructor(e,t,n,i,a,s){this.from=e,this.to=t,this.dir=n,this.isolates=i,this.fresh=a,this.order=s}static update(e,t){if(t.empty&&!e.some(a=>a.fresh))return e;let n=[],i=e.length?e[e.length-1].dir:ae.Direction.LTR;for(let a=Math.max(0,e.length-10);a<e.length;a++){let s=e[a];s.dir==i&&!t.touchesRange(s.from,s.to)&&n.push(new r(t.mapPos(s.from,1),t.mapPos(s.to,-1),s.dir,s.isolates,!1,s.order))}return n}};function Ax(r,e,t){for(let n=r.state.facet(e),i=n.length-1;i>=0;i--){let a=n[i],s=typeof a=="function"?a(r):a;s&&vp(s,t)}return t}var Q5=he.mac?"mac":he.windows?"win":he.linux?"linux":"key";function J5(r,e){let t=r.split(/-(?!$)/),n=t[t.length-1];n=="Space"&&(n=" ");let i,a,s,o;for(let l=0;l<t.length-1;++l){let u=t[l];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))i=!0;else if(/^(c|ctrl|control)$/i.test(u))a=!0;else if(/^s(hift)?$/i.test(u))s=!0;else if(/^mod$/i.test(u))e=="mac"?o=!0:a=!0;else throw new Error("Unrecognized modifier name: "+u)}return i&&(n="Alt-"+n),a&&(n="Ctrl-"+n),o&&(n="Meta-"+n),s&&(n="Shift-"+n),n}function gh(r,e,t){return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),t!==!1&&e.shiftKey&&(r="Shift-"+r),r}var eV=H.Prec.default(je.domEventHandlers({keydown(r,e){return q1(N1(e.state),r,e,"editor")}})),I1=H.Facet.define({enables:eV}),Mx=new WeakMap;function N1(r){let e=r.facet(I1),t=Mx.get(e);return t||Mx.set(e,t=nV(e.reduce((n,i)=>n.concat(i),[]))),t}function tV(r,e,t){return q1(N1(r.state),e,r,t)}var xi=null,rV=4e3;function nV(r,e=Q5){let t=Object.create(null),n=Object.create(null),i=(s,o)=>{let l=n[s];if(l==null)n[s]=o;else if(l!=o)throw new Error("Key binding "+s+" is used both as a regular binding and as a multi-stroke prefix")},a=(s,o,l,u,h)=>{var f,c;let d=t[s]||(t[s]=Object.create(null)),p=o.split(/ (?!$)/).map(m=>J5(m,e));for(let m=1;m<p.length;m++){let y=p.slice(0,m).join(" ");i(y,!0),d[y]||(d[y]={preventDefault:!0,stopPropagation:!1,run:[b=>{let w=xi={view:b,prefix:y,scope:s};return setTimeout(()=>{xi==w&&(xi=null)},rV),!0}]})}let g=p.join(" ");i(g,!1);let v=d[g]||(d[g]={preventDefault:!1,stopPropagation:!1,run:((c=(f=d._any)===null||f===void 0?void 0:f.run)===null||c===void 0?void 0:c.slice())||[]});l&&v.run.push(l),u&&(v.preventDefault=!0),h&&(v.stopPropagation=!0)};for(let s of r){let o=s.scope?s.scope.split(" "):["editor"];if(s.any)for(let u of o){let h=t[u]||(t[u]=Object.create(null));h._any||(h._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:f}=s;for(let c in h)h[c].run.push(d=>f(d,zp))}let l=s[e]||s.key;if(l)for(let u of o)a(u,l,s.run,s.preventDefault,s.stopPropagation),s.shift&&a(u,"Shift-"+l,s.shift,s.preventDefault,s.stopPropagation)}return t}var zp=null;function q1(r,e,t,n){zp=e;let i=ip.keyName(e),a=H.codePointAt(i,0),s=H.codePointSize(a)==i.length&&i!=" ",o="",l=!1,u=!1,h=!1;xi&&xi.view==t&&xi.scope==n&&(o=xi.prefix+" ",E1.indexOf(e.keyCode)<0&&(u=!0,xi=null));let f=new Set,c=v=>{if(v){for(let m of v.run)if(!f.has(m)&&(f.add(m),m(t)))return v.stopPropagation&&(h=!0),!0;v.preventDefault&&(v.stopPropagation&&(h=!0),u=!0)}return!1},d=r[n],p,g;return d&&(c(d[o+gh(i,e,!s)])?l=!0:s&&(e.altKey||e.metaKey||e.ctrlKey)&&!(he.windows&&e.ctrlKey&&e.altKey)&&(p=ip.base[e.keyCode])&&p!=i?(c(d[o+gh(p,e,!0)])||e.shiftKey&&(g=ip.shift[e.keyCode])!=i&&g!=p&&c(d[o+gh(g,e,!1)]))&&(l=!0):s&&e.shiftKey&&c(d[o+gh(i,e,!0)])&&(l=!0),!l&&c(d._any)&&(l=!0)),u&&(l=!0),l&&h&&e.stopPropagation(),zp=null,l}var ms=class r{constructor(e,t,n,i,a){this.className=e,this.left=t,this.top=n,this.width=i,this.height=a}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,n){if(n.empty){let i=e.coordsAtPos(n.head,n.assoc||1);if(!i)return[];let a=F1(e);return[new r(t,i.left-a.left,i.top-a.top,null,i.bottom-i.top)]}else return iV(e,t,n)}};function F1(r){let e=r.scrollDOM.getBoundingClientRect();return{left:(r.textDirection==ae.Direction.LTR?e.left:e.right-r.scrollDOM.clientWidth*r.scaleX)-r.scrollDOM.scrollLeft*r.scaleX,top:e.top-r.scrollDOM.scrollTop*r.scaleY}}function Dx(r,e,t,n){let i=r.coordsAtPos(e,t*2);if(!i)return n;let a=r.dom.getBoundingClientRect(),s=(i.top+i.bottom)/2,o=r.posAtCoords({x:a.left+1,y:s}),l=r.posAtCoords({x:a.right-1,y:s});return o==null||l==null?n:{from:Math.max(n.from,Math.min(o,l)),to:Math.min(n.to,Math.max(o,l))}}function iV(r,e,t){if(t.to<=r.viewport.from||t.from>=r.viewport.to)return[];let n=Math.max(t.from,r.viewport.from),i=Math.min(t.to,r.viewport.to),a=r.textDirection==ae.Direction.LTR,s=r.contentDOM,o=s.getBoundingClientRect(),l=F1(r),u=s.querySelector(".cm-line"),h=u&&window.getComputedStyle(u),f=o.left+(h?parseInt(h.paddingLeft)+Math.min(0,parseInt(h.textIndent)):0),c=o.right-(h?parseInt(h.paddingRight):0),d=Cp(r,n,1),p=Cp(r,i,-1),g=d.type==ae.BlockType.Text?d:null,v=p.type==ae.BlockType.Text?p:null;if(g&&(r.lineWrapping||d.widgetLineBreaks)&&(g=Dx(r,n,1,g)),v&&(r.lineWrapping||p.widgetLineBreaks)&&(v=Dx(r,i,-1,v)),g&&v&&g.from==v.from&&g.to==v.to)return y(b(t.from,t.to,g));{let S=g?b(t.from,null,g):w(d,!1),C=v?b(null,t.to,v):w(p,!0),x=[];return(g||d).to<(v||p).from-(g&&v?1:0)||d.widgetLineBreaks>1&&S.bottom+r.defaultLineHeight/2<C.top?x.push(m(f,S.bottom,c,C.top)):S.bottom<C.top&&r.elementAtHeight((S.bottom+C.top)/2).type==ae.BlockType.Text&&(S.bottom=C.top=(S.bottom+C.top)/2),y(S).concat(x).concat(y(C))}function m(S,C,x,A){return new ms(e,S-l.left,C-l.top,x-S,A-C)}function y({top:S,bottom:C,horizontal:x}){let A=[];for(let T=0;T<x.length;T+=2)A.push(m(x[T],S,x[T+1],C));return A}function b(S,C,x){let A=1e9,T=-1e9,D=[];function k(O,R,L,I,N){let q=r.coordsAtPos(O,O==x.to?-2:2),z=r.coordsAtPos(L,L==x.from?2:-2);!q||!z||(A=Math.min(q.top,z.top,A),T=Math.max(q.bottom,z.bottom,T),N==ae.Direction.LTR?D.push(a&&R?f:q.left,a&&I?c:z.right):D.push(!a&&I?f:z.left,!a&&R?c:q.right))}let E=S??x.from,M=C??x.to;for(let O of r.visibleRanges)if(O.to>E&&O.from<M)for(let R=Math.max(O.from,E),L=Math.min(O.to,M);;){let I=r.state.doc.lineAt(R);for(let N of r.bidiSpans(I)){let q=N.from+I.from,z=N.to+I.from;if(q>=L)break;z>R&&k(Math.max(q,R),S==null&&q<=E,Math.min(z,L),C==null&&z>=M,N.dir)}if(R=I.to+1,R>=L)break}return D.length==0&&k(E,S==null,M,C==null,r.textDirection),{top:A,bottom:T,horizontal:D}}function w(S,C){let x=o.top+(C?S.top:S.bottom);return{top:x,bottom:x,horizontal:[]}}}function aV(r,e){return r.constructor==e.constructor&&r.eq(e)}var Vp=class{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(xh)!=e.state.facet(xh)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,n=e.facet(xh);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,n)=>!aV(t,this.drawn[n]))){let t=this.dom.firstChild,n=0;for(let i of e)i.update&&t&&i.constructor&&this.drawn[n].constructor&&i.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(i.draw(),t);for(;t;){let i=t.nextSibling;t.remove(),t=i}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}},xh=H.Facet.define();function sg(r){return[er.define(e=>new Vp(e,r)),xh.of(r)]}var ys=H.Facet.define({combine(r){return H.combineConfig(r,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function sV(r={}){return[ys.of(r),lV,uV,hV,p1.of(!0)]}function oV(r){return r.facet(ys)}function _1(r){return r.startState.facet(ys)!=r.state.facet(ys)}var lV=sg({above:!0,markers(r){let{state:e}=r,t=e.facet(ys),n=[];for(let i of e.selection.ranges){let a=i==e.selection.main;if(i.empty||t.drawRangeCursor){let s=a?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",o=i.empty?i:H.EditorSelection.cursor(i.head,i.head>i.anchor?-1:1);for(let l of ms.forRange(r,s,o))n.push(l)}}return n},update(r,e){r.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=_1(r);return t&&Px(r.state,e),r.docChanged||r.selectionSet||t},mount(r,e){Px(e.state,r)},class:"cm-cursorLayer"});function Px(r,e){e.style.animationDuration=r.facet(ys).cursorBlinkRate+"ms"}var uV=sg({above:!1,markers(r){return r.state.selection.ranges.map(e=>e.empty?[]:ms.forRange(r,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(r,e){return r.docChanged||r.selectionSet||r.viewportChanged||_1(r)},class:"cm-selectionLayer"}),hV=H.Prec.highest(je.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),z1=H.StateEffect.define({map(r,e){return r==null?null:e.mapPos(r)}}),qo=H.StateField.define({create(){return null},update(r,e){return r!=null&&(r=e.changes.mapPos(r)),e.effects.reduce((t,n)=>n.is(z1)?n.value:t,r)}}),fV=er.fromClass(class{constructor(r){this.view=r,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(r){var e;let t=r.state.field(qo);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(r.startState.field(qo)!=t||r.docChanged||r.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:r}=this,e=r.state.field(qo),t=e!=null&&r.coordsAtPos(e);if(!t)return null;let n=r.scrollDOM.getBoundingClientRect();return{left:t.left-n.left+r.scrollDOM.scrollLeft*r.scaleX,top:t.top-n.top+r.scrollDOM.scrollTop*r.scaleY,height:t.bottom-t.top}}drawCursor(r){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;r?(this.cursor.style.left=r.left/e+"px",this.cursor.style.top=r.top/t+"px",this.cursor.style.height=r.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(r){this.view.state.field(qo)!=r&&this.view.dispatch({effects:z1.of(r)})}},{eventObservers:{dragover(r){this.setDropPos(this.view.posAtCoords({x:r.clientX,y:r.clientY}))},dragleave(r){(r.target==this.view.contentDOM||!this.view.contentDOM.contains(r.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function cV(){return[qo,fV]}function Bx(r,e,t,n,i){e.lastIndex=0;for(let a=r.iterRange(t,n),s=t,o;!a.next().done;s+=a.value.length)if(!a.lineBreak)for(;o=e.exec(a.value);)i(s+o.index,o)}function dV(r,e){let t=r.visibleRanges;if(t.length==1&&t[0].from==r.viewport.from&&t[0].to==r.viewport.to)return t;let n=[];for(let{from:i,to:a}of t)i=Math.max(r.state.doc.lineAt(i).from,i-e),a=Math.min(r.state.doc.lineAt(a).to,a+e),n.length&&n[n.length-1].to>=i?n[n.length-1].to=a:n.push({from:i,to:a});return n}var bs=class{constructor(e){let{regexp:t,decoration:n,decorate:i,boundary:a,maxLength:s=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,i)this.addMatch=(o,l,u,h)=>i(h,u,u+o[0].length,o,l);else if(typeof n=="function")this.addMatch=(o,l,u,h)=>{let f=n(o,l,u);f&&h(u,u+o[0].length,f)};else if(n)this.addMatch=(o,l,u,h)=>h(u,u+o[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=a,this.maxLength=s}createDeco(e){let t=new H.RangeSetBuilder,n=t.add.bind(t);for(let{from:i,to:a}of dV(e,this.maxLength))Bx(e.state.doc,this.regexp,i,a,(s,o)=>this.addMatch(o,e,s,n));return t.finish()}updateDeco(e,t){let n=1e9,i=-1;return e.docChanged&&e.changes.iterChanges((a,s,o,l)=>{l>=e.view.viewport.from&&o<=e.view.viewport.to&&(n=Math.min(o,n),i=Math.max(l,i))}),e.viewportMoved||i-n>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,t.map(e.changes),n,i):t}updateRange(e,t,n,i){for(let a of e.visibleRanges){let s=Math.max(a.from,n),o=Math.min(a.to,i);if(o>s){let l=e.state.doc.lineAt(s),u=l.to<o?e.state.doc.lineAt(o):l,h=Math.max(a.from,l.from),f=Math.min(a.to,u.to);if(this.boundary){for(;s>l.from;s--)if(this.boundary.test(l.text[s-1-l.from])){h=s;break}for(;o<u.to;o++)if(this.boundary.test(u.text[o-u.from])){f=o;break}}let c=[],d,p=(g,v,m)=>c.push(m.range(g,v));if(l==u)for(this.regexp.lastIndex=h-l.from;(d=this.regexp.exec(l.text))&&d.index<f-l.from;)this.addMatch(d,e,d.index+l.from,p);else Bx(e.state.doc,this.regexp,h,f,(g,v)=>this.addMatch(v,e,g,p));t=t.update({filterFrom:h,filterTo:f,filter:(g,v)=>g<h||v>f,add:c})}}return t}},Hp=/x/.unicode!=null?"gu":"g",pV=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,Hp),gV={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},up=null;function vV(){var r;if(up==null&&typeof document<"u"&&document.body){let e=document.body.style;up=((r=e.tabSize)!==null&&r!==void 0?r:e.MozTabSize)!=null}return up||!1}var Sh=H.Facet.define({combine(r){let e=H.combineConfig(r,{render:null,specialChars:pV,addSpecialChars:null});return(e.replaceTabs=!vV())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Hp)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Hp)),e}});function mV(r={}){return[Sh.of(r),yV()]}var Ox=null;function yV(){return Ox||(Ox=er.fromClass(class{constructor(r){this.view=r,this.decorations=ot.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(r.state.facet(Sh)),this.decorations=this.decorator.createDeco(r)}makeDecorator(r){return new bs({regexp:r.specialChars,decoration:(e,t,n)=>{let{doc:i}=t.state,a=H.codePointAt(e[0],0);if(a==9){let s=i.lineAt(n),o=t.state.tabSize,l=H.countColumn(s.text,o,n-s.from);return ot.replace({widget:new Gp((o-l%o)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[a]||(this.decorationCache[a]=ot.replace({widget:new Wp(r,a)}))},boundary:r.replaceTabs?void 0:/[^]/})}update(r){let e=r.state.facet(Sh);r.startState.facet(Sh)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(r.view)):this.decorations=this.decorator.updateDeco(r,this.decorations)}},{decorations:r=>r.decorations}))}var bV="\u2022";function wV(r){return r>=32?bV:r==10?"\u2424":String.fromCharCode(9216+r)}var Wp=class extends $n{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=wV(this.code),n=e.state.phrase("Control character")+" "+(gV[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,n,t);if(i)return i;let a=document.createElement("span");return a.textContent=t,a.title=n,a.setAttribute("aria-label",n),a.className="cm-specialChar",a}ignoreEvent(){return!1}},Gp=class extends $n{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}},Rx=er.fromClass(class{constructor(){this.height=1e3,this.attrs={style:"padding-bottom: 1000px"}}update(r){let{view:e}=r,t=e.viewState.editorHeight-e.defaultLineHeight-e.documentPadding.top-.5;t>=0&&t!=this.height&&(this.height=t,this.attrs={style:`padding-bottom: ${t}px`})}});function xV(){return[Rx,zh.of(r=>{var e;return((e=r.plugin(Rx))===null||e===void 0?void 0:e.attrs)||null})]}function SV(){return kV}var CV=ot.line({class:"cm-activeLine"}),kV=er.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.docChanged||r.selectionSet)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=-1,t=[];for(let n of r.state.selection.ranges){let i=r.lineBlockAt(n.head);i.from>e&&(t.push(CV.range(i.from)),e=i.from)}return ot.set(t)}},{decorations:r=>r.decorations}),Up=class extends $n{constructor(e){super(),this.content=e}toDOM(e){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(e):this.content.cloneNode(!0)),typeof this.content=="string"?t.setAttribute("aria-label","placeholder "+this.content):t.setAttribute("aria-hidden","true"),t}coordsAt(e){let t=e.firstChild?vs(e.firstChild):[];if(!t.length)return null;let n=window.getComputedStyle(e.parentNode),i=tl(t[0],n.direction!="rtl"),a=parseInt(n.lineHeight);return i.bottom-i.top>a*1.5?{left:i.left,right:i.right,top:i.top,bottom:i.top+a}:i}ignoreEvent(){return!1}};function EV(r){return er.fromClass(class{constructor(e){this.view=e,this.placeholder=r?ot.set([ot.widget({widget:new Up(r),side:1}).range(0)]):ot.none}get decorations(){return this.view.state.doc.length?ot.none:this.placeholder}},{decorations:e=>e.decorations})}var Kp=2e3;function TV(r,e,t){let n=Math.min(e.line,t.line),i=Math.max(e.line,t.line),a=[];if(e.off>Kp||t.off>Kp||e.col<0||t.col<0){let s=Math.min(e.off,t.off),o=Math.max(e.off,t.off);for(let l=n;l<=i;l++){let u=r.doc.line(l);u.length<=o&&a.push(H.EditorSelection.range(u.from+s,u.to+o))}}else{let s=Math.min(e.col,t.col),o=Math.max(e.col,t.col);for(let l=n;l<=i;l++){let u=r.doc.line(l),h=H.findColumn(u.text,s,r.tabSize,!0);if(h<0)a.push(H.EditorSelection.cursor(u.to));else{let f=H.findColumn(u.text,o,r.tabSize);a.push(H.EditorSelection.range(u.from+h,u.from+f))}}}return a}function AV(r,e){let t=r.coordsAtPos(r.viewport.from);return t?Math.round(Math.abs((t.left-e)/r.defaultCharacterWidth)):-1}function Lx(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1),n=r.state.doc.lineAt(t),i=t-n.from,a=i>Kp?-1:i==n.length?AV(r,e.clientX):H.countColumn(n.text,r.state.tabSize,t-n.from);return{line:n.number,col:a,off:i}}function MV(r,e){let t=Lx(r,e),n=r.state.selection;return t?{update(i){if(i.docChanged){let a=i.changes.mapPos(i.startState.doc.line(t.line).from),s=i.state.doc.lineAt(a);t={line:s.number,col:t.col,off:Math.min(t.off,s.length)},n=n.map(i.changes)}},get(i,a,s){let o=Lx(r,i);if(!o)return n;let l=TV(r.state,t,o);return l.length?s?H.EditorSelection.create(l.concat(n.ranges)):H.EditorSelection.create(l):n}}:null}function DV(r){let e=r?.eventFilter||(t=>t.altKey&&t.button==0);return je.mouseSelectionStyle.of((t,n)=>e(n)?MV(t,n):null)}var PV={Alt:[18,r=>!!r.altKey],Control:[17,r=>!!r.ctrlKey],Shift:[16,r=>!!r.shiftKey],Meta:[91,r=>!!r.metaKey]},BV={style:"cursor: crosshair"};function OV(r={}){let[e,t]=PV[r.key||"Alt"],n=er.fromClass(class{constructor(i){this.view=i,this.isDown=!1}set(i){this.isDown!=i&&(this.isDown=i,this.view.update([]))}},{eventObservers:{keydown(i){this.set(i.keyCode==e||t(i))},keyup(i){(i.keyCode==e||!t(i))&&this.set(!1)},mousemove(i){this.set(t(i))}}});return[n,je.contentAttributes.of(i=>{var a;return!((a=i.plugin(n))===null||a===void 0)&&a.isDown?BV:null})]}var Oo="-10000px",Ih=class{constructor(e,t,n,i){this.facet=t,this.createTooltipView=n,this.removeTooltipView=i,this.input=e.state.facet(t),this.tooltips=this.input.filter(s=>s);let a=null;this.tooltipViews=this.tooltips.map(s=>a=n(s,a))}update(e,t){var n;let i=e.state.facet(this.facet),a=i.filter(l=>l);if(i===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let s=[],o=t?[]:null;for(let l=0;l<a.length;l++){let u=a[l],h=-1;if(u){for(let f=0;f<this.tooltips.length;f++){let c=this.tooltips[f];c&&c.create==u.create&&(h=f)}if(h<0)s[l]=this.createTooltipView(u,l?s[l-1]:null),o&&(o[l]=!!u.above);else{let f=s[l]=this.tooltipViews[h];o&&(o[l]=t[h]),f.update&&f.update(e)}}}for(let l of this.tooltipViews)s.indexOf(l)<0&&(this.removeTooltipView(l),(n=l.destroy)===null||n===void 0||n.call(l));return t&&(o.forEach((l,u)=>t[u]=l),t.length=o.length),this.input=i,this.tooltips=a,this.tooltipViews=s,!0}};function RV(r={}){return Ch.of(r)}function LV(r){let e=r.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}var Ch=H.Facet.define({combine:r=>{var e,t,n;return{position:he.ios?"absolute":((e=r.find(i=>i.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=r.find(i=>i.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((n=r.find(i=>i.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||LV}}}),Ix=new WeakMap,Hh=er.fromClass(class{constructor(r){this.view=r,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=r.state.facet(Ch);this.position=e.position,this.parent=e.parent,this.classes=r.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new Ih(r,og,(t,n)=>this.createTooltip(t,n),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),r.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let r of this.manager.tooltipViews)this.intersectionObserver.observe(r.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(r){r.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(r,this.above);e&&this.observeIntersection();let t=e||r.geometryChanged,n=r.state.facet(Ch);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let i of this.manager.tooltipViews)i.dom.style.position=this.position;t=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let i of this.manager.tooltipViews)this.container.appendChild(i.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(r,e){let t=r.create(this.view),n=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),r.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let i=document.createElement("div");i.className="cm-tooltip-arrow",t.dom.appendChild(i)}return t.dom.style.position=this.position,t.dom.style.top=Oo,t.dom.style.left="0px",this.container.insertBefore(t.dom,n),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var r,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(r=n.destroy)===null||r===void 0||r.call(n);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let r=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:a}=this.manager.tooltipViews[0];if(he.gecko)t=a.offsetParent!=this.container.ownerDocument.body;else if(a.style.top==Oo&&a.style.left=="0px"){let s=a.getBoundingClientRect();t=Math.abs(s.top+1e4)>1||Math.abs(s.left)>1}}if(t||this.position=="absolute")if(this.parent){let a=this.parent.getBoundingClientRect();a.width&&a.height&&(r=a.width/this.parent.offsetWidth,e=a.height/this.parent.offsetHeight)}else({scaleX:r,scaleY:e}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),i=ig(this.view);return{visible:{left:n.left+i.left,top:n.top+i.top,right:n.right-i.right,bottom:n.bottom-i.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((a,s)=>{let o=this.manager.tooltipViews[s];return o.getCoords?o.getCoords(a.pos):this.view.coordsAtPos(a.pos)}),size:this.manager.tooltipViews.map(({dom:a})=>a.getBoundingClientRect()),space:this.view.state.facet(Ch).tooltipSpace(this.view),scaleX:r,scaleY:e,makeAbsolute:t}}writeMeasure(r){var e;if(r.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let o of this.manager.tooltipViews)o.dom.style.position="absolute"}let{visible:t,space:n,scaleX:i,scaleY:a}=r,s=[];for(let o=0;o<this.manager.tooltips.length;o++){let l=this.manager.tooltips[o],u=this.manager.tooltipViews[o],{dom:h}=u,f=r.pos[o],c=r.size[o];if(!f||l.clip!==!1&&(f.bottom<=Math.max(t.top,n.top)||f.top>=Math.min(t.bottom,n.bottom)||f.right<Math.max(t.left,n.left)-.1||f.left>Math.min(t.right,n.right)+.1)){h.style.top=Oo;continue}let d=l.arrow?u.dom.querySelector(".cm-tooltip-arrow"):null,p=d?7:0,g=c.right-c.left,v=(e=Ix.get(u))!==null&&e!==void 0?e:c.bottom-c.top,m=u.offset||NV,y=this.view.textDirection==ae.Direction.LTR,b=c.width>n.right-n.left?y?n.left:n.right-c.width:y?Math.max(n.left,Math.min(f.left-(d?14:0)+m.x,n.right-g)):Math.min(Math.max(n.left,f.left-g+(d?14:0)-m.x),n.right-g),w=this.above[o];!l.strictSide&&(w?f.top-v-p-m.y<n.top:f.bottom+v+p+m.y>n.bottom)&&w==n.bottom-f.bottom>f.top-n.top&&(w=this.above[o]=!w);let S=(w?f.top-n.top:n.bottom-f.bottom)-p;if(S<v&&u.resize!==!1){if(S<this.view.defaultLineHeight){h.style.top=Oo;continue}Ix.set(u,v),h.style.height=(v=S)/a+"px"}else h.style.height&&(h.style.height="");let C=w?f.top-v-p-m.y:f.bottom+p+m.y,x=b+g;if(u.overlap!==!0)for(let A of s)A.left<x&&A.right>b&&A.top<C+v&&A.bottom>C&&(C=w?A.top-v-2-p:A.bottom+p+2);if(this.position=="absolute"?(h.style.top=(C-r.parent.top)/a+"px",Nx(h,(b-r.parent.left)/i)):(h.style.top=C/a+"px",Nx(h,b/i)),d){let A=f.left+(y?m.x:-m.x)-(b+14-7);d.style.left=A/i+"px"}u.overlap!==!0&&s.push({left:b,top:C,right:x,bottom:C+v}),h.classList.toggle("cm-tooltip-above",w),h.classList.toggle("cm-tooltip-below",!w),u.positioned&&u.positioned(r.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let r of this.manager.tooltipViews)r.dom.style.top=Oo}},{eventObservers:{scroll(){this.maybeMeasure()}}});function Nx(r,e){let t=parseInt(r.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(r.style.left=e+"px")}var IV=je.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),NV={x:0,y:0},og=H.Facet.define({enables:[Hh,IV]}),el=H.Facet.define({combine:r=>r.reduce((e,t)=>e.concat(t),[])}),Nh=class r{static create(e){return new r(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Ih(e,el,(t,n)=>this.createHostedView(t,n),t=>t.dom.remove())}createHostedView(e,t){let n=e.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(n.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&n.mount&&n.mount(this.view),n}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let n of this.manager.tooltipViews){let i=n[e];if(i!==void 0){if(t===void 0)t=i;else if(t!==i)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}},qV=og.compute([el],r=>{let e=r.facet(el);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var n;return(n=t.end)!==null&&n!==void 0?n:t.pos})),create:Nh.create,above:e[0].above,arrow:e.some(t=>t.arrow)}}),jp=class{constructor(e,t,n,i,a){this.view=e,this.source=t,this.field=n,this.setHover=i,this.hoverTime=a,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,n=e.docView.nearest(t.target);if(!n)return;let i,a=1;if(n instanceof jo)i=n.posAtStart;else{if(i=e.posAtCoords(t),i==null)return;let o=e.coordsAtPos(i);if(!o||t.y<o.top||t.y>o.bottom||t.x<o.left-e.defaultCharacterWidth||t.x>o.right+e.defaultCharacterWidth)return;let l=e.bidiSpans(e.state.doc.lineAt(i)).find(h=>h.from<=i&&h.to>=i),u=l&&l.dir==ae.Direction.RTL?-1:1;a=t.x<o.left?-u:u}let s=this.source(e,i,a);if(s?.then){let o=this.pending={pos:i};s.then(l=>{this.pending==o&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>dn(e.state,l,"hover tooltip"))}else s&&!(Array.isArray(s)&&!s.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(s)?s:[s])})}get tooltip(){let e=this.view.plugin(Hh),t=e?e.manager.tooltips.findIndex(n=>n.create==Nh.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,n;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:i,tooltip:a}=this;if(i.length&&a&&!FV(a.dom,e)||this.pending){let{pos:s}=i[0]||this.pending,o=(n=(t=i[0])===null||t===void 0?void 0:t.end)!==null&&n!==void 0?n:s;(s==o?this.view.posAtCoords(this.lastMove)!=s:!_V(this.view,s,o,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:n}=this;n&&n.dom.contains(e.relatedTarget)?this.watchTooltipLeave(n.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=n=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}},vh=4;function FV(r,e){let{left:t,right:n,top:i,bottom:a}=r.getBoundingClientRect(),s;if(s=r.querySelector(".cm-tooltip-arrow")){let o=s.getBoundingClientRect();i=Math.min(o.top,i),a=Math.max(o.bottom,a)}return e.clientX>=t-vh&&e.clientX<=n+vh&&e.clientY>=i-vh&&e.clientY<=a+vh}function _V(r,e,t,n,i,a){let s=r.scrollDOM.getBoundingClientRect(),o=r.documentTop+r.documentPadding.top+r.contentHeight;if(s.left>n||s.right<n||s.top>i||Math.min(s.bottom,o)<i)return!1;let l=r.posAtCoords({x:n,y:i},!1);return l>=e&&l<=t}function zV(r,e={}){let t=H.StateEffect.define(),n=H.StateField.define({create(){return[]},update(i,a){if(i.length&&(e.hideOnChange&&(a.docChanged||a.selection)?i=[]:e.hideOn&&(i=i.filter(s=>!e.hideOn(a,s))),a.docChanged)){let s=[];for(let o of i){let l=a.changes.mapPos(o.pos,-1,H.MapMode.TrackDel);if(l!=null){let u=Object.assign(Object.create(null),o);u.pos=l,u.end!=null&&(u.end=a.changes.mapPos(u.end)),s.push(u)}}i=s}for(let s of a.effects)s.is(t)&&(i=s.value),s.is(V1)&&(i=[]);return i},provide:i=>el.from(i)});return{active:n,extension:[n,er.define(i=>new jp(i,r,n,t,e.hoverTime||300)),qV]}}function VV(r,e){let t=r.plugin(Hh);if(!t)return null;let n=t.manager.tooltips.indexOf(e);return n<0?null:t.manager.tooltipViews[n]}function HV(r){return r.facet(el).some(e=>e)}var V1=H.StateEffect.define(),WV=V1.of(null);function GV(r){let e=r.plugin(Hh);e&&e.maybeMeasure()}var Yp=H.Facet.define({combine(r){let e,t;for(let n of r)e=e||n.topContainer,t=t||n.bottomContainer;return{topContainer:e,bottomContainer:t}}});function UV(r){return r?[Yp.of(r)]:[]}function KV(r,e){let t=r.plugin(H1),n=t?t.specs.indexOf(e):-1;return n>-1?t.panels[n]:null}var H1=er.fromClass(class{constructor(r){this.input=r.state.facet(Xp),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(r));let e=r.state.facet(Yp);this.top=new cs(r,!0,e.topContainer),this.bottom=new cs(r,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(r){let e=r.state.facet(Yp);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new cs(r.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new cs(r.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=r.state.facet(Xp);if(t!=this.input){let n=t.filter(l=>l),i=[],a=[],s=[],o=[];for(let l of n){let u=this.specs.indexOf(l),h;u<0?(h=l(r.view),o.push(h)):(h=this.panels[u],h.update&&h.update(r)),i.push(h),(h.top?a:s).push(h)}this.specs=n,this.panels=i,this.top.sync(a),this.bottom.sync(s);for(let l of o)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let n of this.panels)n.update&&n.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:r=>je.scrollMargins.of(e=>{let t=e.plugin(r);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})}),cs=class{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=qx(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=qx(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}};function qx(r){let e=r.nextSibling;return r.remove(),e}var Xp=H.Facet.define({enables:H1}),vn=class extends H.RangeValue{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}};vn.prototype.elementClass="";vn.prototype.toDOM=void 0;vn.prototype.mapMode=H.MapMode.TrackBefore;vn.prototype.startSide=vn.prototype.endSide=-1;vn.prototype.point=!0;var Wo=H.Facet.define(),W1=H.Facet.define(),jV={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>H.RangeSet.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Go=H.Facet.define();function YV(r){return[lg(),Go.of(Object.assign(Object.assign({},jV),r))]}var $p=H.Facet.define({combine:r=>r.some(e=>e)});function lg(r){let e=[XV];return r&&r.fixed===!1&&e.push($p.of(!0)),e}var XV=er.fromClass(class{constructor(r){this.view=r,this.prevViewport=r.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=r.state.facet(Go).map(e=>new qh(r,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!r.state.facet($p),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),r.scrollDOM.insertBefore(this.dom,r.contentDOM)}update(r){if(this.updateGutters(r)){let e=this.prevViewport,t=r.view.viewport,n=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(n<(t.to-t.from)*.8)}r.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet($p)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=r.view.viewport}syncGutters(r){let e=this.dom.nextSibling;r&&this.dom.remove();let t=H.RangeSet.iter(this.view.state.facet(Wo),this.view.viewport.from),n=[],i=this.gutters.map(a=>new Qp(a,this.view.viewport,-this.view.documentPadding.top));for(let a of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(a.type)){let s=!0;for(let o of a.type)if(o.type==ae.BlockType.Text&&s){Zp(t,n,o.from);for(let l of i)l.line(this.view,o,n);s=!1}else if(o.widget)for(let l of i)l.widget(this.view,o)}else if(a.type==ae.BlockType.Text){Zp(t,n,a.from);for(let s of i)s.line(this.view,a,n)}else if(a.widget)for(let s of i)s.widget(this.view,a);for(let a of i)a.finish();r&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(r){let e=r.startState.facet(Go),t=r.state.facet(Go),n=r.docChanged||r.heightChanged||r.viewportChanged||!H.RangeSet.eq(r.startState.facet(Wo),r.state.facet(Wo),r.view.viewport.from,r.view.viewport.to);if(e==t)for(let i of this.gutters)i.update(r)&&(n=!0);else{n=!0;let i=[];for(let a of t){let s=e.indexOf(a);s<0?i.push(new qh(this.view,a)):(this.gutters[s].update(r),i.push(this.gutters[s]))}for(let a of this.gutters)a.dom.remove(),i.indexOf(a)<0&&a.destroy();for(let a of i)this.dom.appendChild(a.dom);this.gutters=i}return n}destroy(){for(let r of this.gutters)r.destroy();this.dom.remove()}},{provide:r=>je.scrollMargins.of(e=>{let t=e.plugin(r);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==ae.Direction.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function Fx(r){return Array.isArray(r)?r:[r]}function Zp(r,e,t){for(;r.value&&r.from<=t;)r.from==t&&e.push(r.value),r.next()}var Qp=class{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=H.RangeSet.iter(e.markers,t.from)}addElement(e,t,n){let{gutter:i}=this,a=(t.top-this.height)/e.scaleY,s=t.height/e.scaleY;if(this.i==i.elements.length){let o=new Fh(e,s,a,n);i.elements.push(o),i.dom.appendChild(o.dom)}else i.elements[this.i].update(e,s,a,n);this.height=t.bottom,this.i++}line(e,t,n){let i=[];Zp(this.cursor,i,t.from),n.length&&(i=i.concat(n));let a=this.gutter.config.lineMarker(e,t,i);a&&i.unshift(a);let s=this.gutter;i.length==0&&!s.config.renderEmptyElements||this.addElement(e,t,i)}widget(e,t){let n=this.gutter.config.widgetMarker(e,t.widget,t),i=n?[n]:null;for(let a of e.state.facet(W1)){let s=a(e,t.widget,t);s&&(i||(i=[])).push(s)}i&&this.addElement(e,t,i)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}},qh=class{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,i=>{let a=i.target,s;if(a!=this.dom&&this.dom.contains(a)){for(;a.parentNode!=this.dom;)a=a.parentNode;let l=a.getBoundingClientRect();s=(l.top+l.bottom)/2}else s=i.clientY;let o=e.lineBlockAtHeight(s-e.documentTop);t.domEventHandlers[n](e,o,i)&&i.preventDefault()});this.markers=Fx(t.markers(e)),t.initialSpacer&&(this.spacer=new Fh(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=Fx(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let i=this.config.updateSpacer(this.spacer.markers[0],e);i!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[i])}let n=e.view.viewport;return!H.RangeSet.eq(this.markers,t,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}},Fh=class{constructor(e,t,n,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,i)}update(e,t,n,i){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),$V(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,t){let n="cm-gutterElement",i=this.dom.firstChild;for(let a=0,s=0;;){let o=s,l=a<t.length?t[a++]:null,u=!1;if(l){let h=l.elementClass;h&&(n+=" "+h);for(let f=s;f<this.markers.length;f++)if(this.markers[f].compare(l)){o=f,u=!0;break}}else o=this.markers.length;for(;s<o;){let h=this.markers[s++];if(h.toDOM){h.destroy(i);let f=i.nextSibling;i.remove(),i=f}}if(!l)break;l.toDOM&&(u?i=i.nextSibling:this.dom.insertBefore(l.toDOM(e),i)),u&&s++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}};function $V(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(!r[t].compare(e[t]))return!1;return!0}var G1=H.Facet.define(),U1=H.Facet.define(),ds=H.Facet.define({combine(r){return H.combineConfig(r,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let i in t){let a=n[i],s=t[i];n[i]=a?(o,l,u)=>a(o,l,u)||s(o,l,u):s}return n}})}}),Uo=class extends vn{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}};function hp(r,e){return r.state.facet(ds).formatNumber(e,r.state)}var ZV=Go.compute([ds],r=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(G1)},lineMarker(e,t,n){return n.some(i=>i.toDOM)?null:new Uo(hp(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,n)=>{for(let i of e.state.facet(U1)){let a=i(e,t,n);if(a)return a}return null},lineMarkerChange:e=>e.startState.facet(ds)!=e.state.facet(ds),initialSpacer(e){return new Uo(hp(e,_x(e.state.doc.lines)))},updateSpacer(e,t){let n=hp(t.view,_x(t.view.state.doc.lines));return n==e.number?e:new Uo(n)},domEventHandlers:r.facet(ds).domEventHandlers}));function QV(r={}){return[ds.of(r),lg(),ZV]}function _x(r){let e=9;for(;e<r;)e=e*10+9;return e}var JV=new class extends vn{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},e3=Wo.compute(["selection"],r=>{let e=[],t=-1;for(let n of r.selection.ranges){let i=r.doc.lineAt(n.head).from;i>t&&(t=i,e.push(JV.range(i)))}return H.RangeSet.of(e)});function t3(){return e3}function K1(r){return er.define(e=>({decorations:r.createDeco(e),update(t){this.decorations=r.updateDeco(t,this.decorations)}}),{decorations:e=>e.decorations})}var r3=ot.mark({class:"cm-highlightTab"}),n3=ot.mark({class:"cm-highlightSpace"}),i3=K1(new bs({regexp:/\t| /g,decoration:r=>r[0]=="	"?r3:n3,boundary:/\S/}));function a3(){return i3}var s3=K1(new bs({regexp:/\s+$/g,decoration:ot.mark({class:"cm-trailingSpace"}),boundary:/\S/}));function o3(){return s3}var l3={HeightMap:Ar,HeightOracle:Dh,MeasuredHeights:Ph,QueryType:dt,ChangedRange:pn,computeOrder:n1,moveVisually:s1,clearHeightChangeFlag:Dp,getHeightChangeFlag:()=>ma};ae.BidiSpan=cn;ae.BlockInfo=fn;ae.Decoration=ot;ae.EditorView=je;ae.GutterMarker=vn;ae.MatchDecorator=bs;ae.RectangleMarker=ms;ae.ViewPlugin=er;ae.ViewUpdate=Jo;ae.WidgetType=$n;ae.__test=l3;ae.closeHoverTooltips=WV;ae.crosshairCursor=OV;ae.drawSelection=sV;ae.dropCursor=cV;ae.getDrawSelectionConfig=oV;ae.getPanel=KV;ae.getTooltip=VV;ae.gutter=YV;ae.gutterLineClass=Wo;ae.gutterWidgetClass=W1;ae.gutters=lg;ae.hasHoverTooltips=HV;ae.highlightActiveLine=SV;ae.highlightActiveLineGutter=t3;ae.highlightSpecialChars=mV;ae.highlightTrailingWhitespace=o3;ae.highlightWhitespace=a3;ae.hoverTooltip=zV;ae.keymap=I1;ae.layer=sg;ae.lineNumberMarkers=G1;ae.lineNumberWidgetMarker=U1;ae.lineNumbers=QV;ae.logException=dn;ae.panels=UV;ae.placeholder=EV;ae.rectangularSelection=DV;ae.repositionTooltips=GV;ae.runScopeHandlers=tV;ae.scrollPastEnd=xV;ae.showPanel=Xp;ae.showTooltip=og;ae.tooltips=RV});var Yh=B(Ge=>{"use strict";var u3=0,Mr=class{constructor(e,t){this.from=e,this.to=t}},gt=class{constructor(e={}){this.id=u3++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Zr.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};gt.closedBy=new gt({deserialize:r=>r.split(" ")});gt.openedBy=new gt({deserialize:r=>r.split(" ")});gt.group=new gt({deserialize:r=>r.split(" ")});gt.isolate=new gt({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});gt.contextHash=new gt({perNode:!0});gt.lookAhead=new gt({perNode:!0});gt.mounted=new gt({perNode:!0});var Ai=class{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[gt.mounted.id]}},h3=Object.create(null),Zr=class r{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):h3,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new r(e.name||"",t,e.id,n);if(e.props){for(let a of e.props)if(Array.isArray(a)||(a=a(i)),a){if(a[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[a[0].id]=a[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(gt.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(gt.group),a=-1;a<(i?i.length:0);a++){let s=t[a<0?n.name:i[a]];if(s)return s}}}};Zr.none=new Zr("",Object.create(null),0,8);var ug=class r{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let i=null;for(let a of e){let s=a(n);s&&(i||(i=Object.assign({},n.props)),i[s[0].id]=s[1])}t.push(i?new Zr(n.name,i,n.id,n.flags):n)}return new r(t)}},Wh=new WeakMap,j1=new WeakMap;Ge.IterMode=void 0;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(Ge.IterMode||(Ge.IterMode={}));var _r=class r{constructor(e,t,n,i,a){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,a&&a.length){this.props=Object.create(null);for(let[s,o]of a)this.props[typeof s=="number"?s:s.id]=o}}toString(){let e=Ai.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let i=n.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new ba(this.topNode,e)}cursorAt(e,t=0,n=0){let i=Wh.get(this)||this.topNode,a=new ba(i);return a.moveTo(e,t),Wh.set(this,a._tree),a}get topNode(){return new Dr(this,0,0,null)}resolve(e,t=0){let n=rl(Wh.get(this)||this.topNode,e,t,!1);return Wh.set(this,n),n}resolveInner(e,t=0){let n=rl(j1.get(this)||this.topNode,e,t,!0);return j1.set(this,n),n}resolveStack(e,t=0){return f3(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:a=this.length}=e,s=e.mode||0,o=(s&Ge.IterMode.IncludeAnonymous)>0;for(let l=this.cursor(s|Ge.IterMode.IncludeAnonymous);;){let u=!1;if(l.from<=a&&l.to>=i&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;u=!0}for(;u&&n&&(o||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;u=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Sg(Zr.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,i)=>new r(this.type,t,n,i,this.propValues),e.makeTree||((t,n,i)=>new r(Zr.none,t,n,i)))}static build(e){return c3(e)}};_r.empty=new _r(Zr.none,[],[],0);var hg=class r{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new r(this.buffer,this.index)}},Zn=class r{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return Zr.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],a=i.name;if(/\W/.test(a)&&!i.isError&&(a=JSON.stringify(a)),e+=4,n==e)return a;let s=[];for(;e<n;)s.push(this.childString(e)),e=this.buffer[e+3];return a+"("+s.join(",")+")"}findChild(e,t,n,i,a){let{buffer:s}=this,o=-1;for(let l=e;l!=t&&!(eS(a,i,s[l+1],s[l+2])&&(o=l,n>0));l=s[l+3]);return o}slice(e,t,n){let i=this.buffer,a=new Uint16Array(t-e),s=0;for(let o=e,l=0;o<t;){a[l++]=i[o++],a[l++]=i[o++]-n;let u=a[l++]=i[o++]-n;a[l++]=i[o++]-e,s=Math.max(s,u)}return new r(a,s,this.set)}};function eS(r,e,t,n){switch(r){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function rl(r,e,t,n){for(var i;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let s=!n&&r instanceof Dr&&r.index<0?null:r.parent;if(!s)return r;r=s}let a=n?0:Ge.IterMode.IgnoreOverlays;if(n)for(let s=r,o=s.parent;o;s=o,o=s.parent)s instanceof Dr&&s.index<0&&((i=o.enter(e,t,a))===null||i===void 0?void 0:i.from)!=s.from&&(r=o);for(;;){let s=r.enter(e,t,a);if(!s)return r;r=s}}var Uh=class{cursor(e=0){return new ba(this,e)}getChild(e,t=null,n=null){let i=Y1(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return Y1(this,e,t,n)}resolve(e,t=0){return rl(this,e,t,!1)}resolveInner(e,t=0){return rl(this,e,t,!0)}matchContext(e){return fg(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}get node(){return this}get next(){return this.parent}},Dr=class r extends Uh{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,a=0){for(let s=this;;){for(let{children:o,positions:l}=s._tree,u=t>0?o.length:-1;e!=u;e+=t){let h=o[e],f=l[e]+s.from;if(eS(i,n,f,f+h.length)){if(h instanceof Zn){if(a&Ge.IterMode.ExcludeBuffers)continue;let c=h.findChild(0,h.buffer.length,t,n-f,i);if(c>-1)return new ya(new cg(s,h,e,f),null,c)}else if(a&Ge.IterMode.IncludeAnonymous||!h.type.isAnonymous||xg(h)){let c;if(!(a&Ge.IterMode.IgnoreMounts)&&(c=Ai.get(h))&&!c.overlay)return new r(c.tree,f,e,s);let d=new r(h,f,e,s);return a&Ge.IterMode.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?h.children.length-1:0,t,n,i)}}}if(a&Ge.IterMode.IncludeAnonymous||!s.type.isAnonymous||(s.index>=0?e=s.index+t:e=t<0?-1:s._parent._tree.children.length,s=s._parent,!s))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&Ge.IterMode.IgnoreOverlays)&&(i=Ai.get(this._tree))&&i.overlay){let a=e-this.from;for(let{from:s,to:o}of i.overlay)if((t>0?s<=a:s<a)&&(t<0?o>=a:o>a))return new r(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function Y1(r,e,t,n){let i=r.cursor(),a=[];if(!i.firstChild())return a;if(t!=null){for(let s=!1;!s;)if(s=i.type.is(t),!i.nextSibling())return a}for(;;){if(n!=null&&i.type.is(n))return a;if(i.type.is(e)&&a.push(i.node),!i.nextSibling())return n==null?a:[]}}function fg(r,e,t=e.length-1){for(let n=r;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}var cg=class{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}},ya=class r extends Uh{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,a=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return a<0?null:new r(this.context,this,a)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&Ge.IterMode.ExcludeBuffers)return null;let{buffer:i}=this.context,a=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return a<0?null:new r(this.context,this,a)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new r(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new r(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,a=n.buffer[this.index+3];if(a>i){let s=n.buffer[this.index+1];e.push(n.slice(i,a,s)),t.push(0)}return new _r(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function tS(r){if(!r.length)return null;let e=0,t=r[0];for(let a=1;a<r.length;a++){let s=r[a];(s.from>t.from||s.to<t.to)&&(t=s,e=a)}let n=t instanceof Dr&&t.index<0?null:t.parent,i=r.slice();return n?i[e]=n:i.splice(e,1),new dg(i,t)}var dg=class{constructor(e,t){this.heads=e,this.node=t}get next(){return tS(this.heads)}};function f3(r,e,t){let n=r.resolveInner(e,t),i=null;for(let a=n instanceof Dr?n:n.context.parent;a;a=a.parent)if(a.index<0){let s=a.parent;(i||(i=[n])).push(s.resolve(e,t)),a=s}else{let s=Ai.get(a.tree);if(s&&s.overlay&&s.overlay[0].from<=e&&s.overlay[s.overlay.length-1].to>=e){let o=new Dr(s.tree,s.overlay[0].from+a.from,-1,a);(i||(i=[n])).push(rl(o,e,t,!1))}}return i?tS(i):n}var ba=class{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Dr)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof Dr?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,a=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return a<0?!1:(this.stack.push(this.index),this.yieldBuf(a))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&Ge.IterMode.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Ge.IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Ge.IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let a=0;a<this.index;a++)if(i.buffer.buffer[a+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let a=t+e,s=e<0?-1:n._tree.children.length;a!=s;a+=e){let o=n._tree.children[a];if(this.mode&Ge.IterMode.IncludeAnonymous||o instanceof Zn||!o.type.isAnonymous||xg(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,a=this.stack.length;a>=0;){for(let s=e;s;s=s._parent)if(s.index==i){if(i==this.index)return s;t=s,n=a+1;break e}i=this.stack[--a]}for(let i=n;i<this.stack.length;i++)t=new ya(this.buffer,t,this.stack[i]);return this.bufferNode=new ya(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return fg(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,a=this.stack.length-1;i>=0;a--){if(a<0)return fg(this._tree,e,i);let s=n[t.buffer[this.stack[a]]];if(!s.isAnonymous){if(e[i]&&e[i]!=s.name)return!1;i--}}return!0}};function xg(r){return r.children.some(e=>e instanceof Zn||!e.type.isAnonymous||xg(e))}function c3(r){var e;let{buffer:t,nodeSet:n,maxBufferLength:i=1024,reused:a=[],minRepeatType:s=n.types.length}=r,o=Array.isArray(t)?new hg(t,t.length):t,l=n.types,u=0,h=0;function f(S,C,x,A,T,D){let{id:k,start:E,end:M,size:O}=o,R=h,L=u;for(;O<0;)if(o.next(),O==-1){let F=a[k];x.push(F),A.push(E-S);return}else if(O==-3){u=k;return}else if(O==-4){h=k;return}else throw new RangeError(`Unrecognized record size: ${O}`);let I=l[k],N,q,z=E-S;if(M-E<=i&&(q=v(o.pos-C,T))){let F=new Uint16Array(q.size-q.skip),_=o.pos-q.size,U=F.length;for(;o.pos>_;)U=m(q.start,F,U);N=new Zn(F,M-q.start,n),z=q.start-S}else{let F=o.pos-O;o.next();let _=[],U=[],X=k>=s?k:-1,$=0,Q=M;for(;o.pos>F;)X>=0&&o.id==X&&o.size>=0?(o.end<=Q-i&&(p(_,U,E,$,o.end,Q,X,R,L),$=_.length,Q=o.end),o.next()):D>2500?c(E,F,_,U):f(E,F,_,U,X,D+1);if(X>=0&&$>0&&$<_.length&&p(_,U,E,$,E,Q,X,R,L),_.reverse(),U.reverse(),X>-1&&$>0){let ee=d(I,L);N=Sg(I,_,U,0,_.length,0,M-E,ee,ee)}else N=g(I,_,U,M-E,R-M,L)}x.push(N),A.push(z)}function c(S,C,x,A){let T=[],D=0,k=-1;for(;o.pos>C;){let{id:E,start:M,end:O,size:R}=o;if(R>4)o.next();else{if(k>-1&&M<k)break;k<0&&(k=O-i),T.push(E,M,O),D++,o.next()}}if(D){let E=new Uint16Array(D*4),M=T[T.length-2];for(let O=T.length-3,R=0;O>=0;O-=3)E[R++]=T[O],E[R++]=T[O+1]-M,E[R++]=T[O+2]-M,E[R++]=R;x.push(new Zn(E,T[2]-M,n)),A.push(M-S)}}function d(S,C){return(x,A,T)=>{let D=0,k=x.length-1,E,M;if(k>=0&&(E=x[k])instanceof _r){if(!k&&E.type==S&&E.length==T)return E;(M=E.prop(gt.lookAhead))&&(D=A[k]+E.length+M)}return g(S,x,A,T,D,C)}}function p(S,C,x,A,T,D,k,E,M){let O=[],R=[];for(;S.length>A;)O.push(S.pop()),R.push(C.pop()+x-T);S.push(g(n.types[k],O,R,D-T,E-D,M)),C.push(T-x)}function g(S,C,x,A,T,D,k){if(D){let E=[gt.contextHash,D];k=k?[E].concat(k):[E]}if(T>25){let E=[gt.lookAhead,T];k=k?[E].concat(k):[E]}return new _r(S,C,x,A,k)}function v(S,C){let x=o.fork(),A=0,T=0,D=0,k=x.end-i,E={size:0,start:0,skip:0};e:for(let M=x.pos-S;x.pos>M;){let O=x.size;if(x.id==C&&O>=0){E.size=A,E.start=T,E.skip=D,D+=4,A+=4,x.next();continue}let R=x.pos-O;if(O<0||R<M||x.start<k)break;let L=x.id>=s?4:0,I=x.start;for(x.next();x.pos>R;){if(x.size<0)if(x.size==-3)L+=4;else break e;else x.id>=s&&(L+=4);x.next()}T=I,A+=O,D+=L}return(C<0||A==S)&&(E.size=A,E.start=T,E.skip=D),E.size>4?E:void 0}function m(S,C,x){let{id:A,start:T,end:D,size:k}=o;if(o.next(),k>=0&&A<s){let E=x;if(k>4){let M=o.pos-(k-4);for(;o.pos>M;)x=m(S,C,x)}C[--x]=E,C[--x]=D-S,C[--x]=T-S,C[--x]=A}else k==-3?u=A:k==-4&&(h=A);return x}let y=[],b=[];for(;o.pos>0;)f(r.start||0,r.bufferStart||0,y,b,-1,0);let w=(e=r.length)!==null&&e!==void 0?e:y.length?b[0]+y[0].length:0;return new _r(l[r.topID],y.reverse(),b.reverse(),w)}var X1=new WeakMap;function Gh(r,e){if(!r.isAnonymous||e instanceof Zn||e.type!=r)return 1;let t=X1.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=r||!(n instanceof _r)){t=1;break}t+=Gh(r,n)}X1.set(e,t)}return t}function Sg(r,e,t,n,i,a,s,o,l){let u=0;for(let p=n;p<i;p++)u+=Gh(r,e[p]);let h=Math.ceil(u*1.5/8),f=[],c=[];function d(p,g,v,m,y){for(let b=v;b<m;){let w=b,S=g[b],C=Gh(r,p[b]);for(b++;b<m;b++){let x=Gh(r,p[b]);if(C+x>=h)break;C+=x}if(b==w+1){if(C>h){let x=p[w];d(x.children,x.positions,0,x.children.length,g[w]+y);continue}f.push(p[w])}else{let x=g[b-1]+p[b-1].length-S;f.push(Sg(r,p,g,w,b,S,x,null,l))}c.push(S+y-a)}}return d(e,t,n,i,0),(o||l)(f,c,s)}var pg=class{constructor(){this.map=new WeakMap}setBuffer(e,t,n){let i=this.map.get(e);i||this.map.set(e,i=new Map),i.set(t,n)}getBuffer(e,t){let n=this.map.get(e);return n&&n.get(t)}set(e,t){e instanceof ya?this.setBuffer(e.context.buffer,e.index,t):e instanceof Dr&&this.map.set(e.tree,t)}get(e){return e instanceof ya?this.getBuffer(e.context.buffer,e.index):e instanceof Dr?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}},nl=class r{constructor(e,t,n,i,a=!1,s=!1){this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(a?1:0)|(s?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let i=[new r(0,e.length,e,0,!1,n)];for(let a of t)a.to>e.length&&i.push(a);return i}static applyChanges(e,t,n=128){if(!t.length)return e;let i=[],a=1,s=e.length?e[0]:null;for(let o=0,l=0,u=0;;o++){let h=o<t.length?t[o]:null,f=h?h.fromA:1e9;if(f-l>=n)for(;s&&s.from<f;){let c=s;if(l>=c.from||f<=c.to||u){let d=Math.max(c.from,l)-u,p=Math.min(c.to,f)-u;c=d>=p?null:new r(d,p,c.tree,c.offset+u,o>0,!!h)}if(c&&i.push(c),s.to>f)break;s=a<e.length?e[a++]:null}if(!h)break;l=h.toA,u=h.toA-h.toB}return i}},gg=class{startParse(e,t,n){return typeof e=="string"&&(e=new vg(e)),n=n?n.length?n.map(i=>new Mr(i.from,i.to)):[new Mr(0,0)]:[new Mr(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let a=i.advance();if(a)return a}}},vg=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};function d3(r){return(e,t,n,i)=>new bg(e,r,t,n,i)}var Kh=class{constructor(e,t,n,i,a){this.parser=e,this.parse=t,this.overlay=n,this.target=i,this.from=a}};function $1(r){if(!r.length||r.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(r))}var mg=class{constructor(e,t,n,i,a,s,o){this.parser=e,this.predicate=t,this.mounts=n,this.index=i,this.start=a,this.target=s,this.prev=o,this.depth=0,this.ranges=[]}},yg=new gt({perNode:!0}),bg=class{constructor(e,t,n,i,a){this.nest=t,this.input=n,this.fragments=i,this.ranges=a,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let n=this.baseParse.advance();if(!n)return null;if(this.baseParse=null,this.baseTree=n,this.startInner(),this.stoppedAt!=null)for(let i of this.inner)i.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let n=this.baseTree;return this.stoppedAt!=null&&(n=new _r(n.type,n.children,n.positions,n.length,n.propValues.concat([[yg,this.stoppedAt]]))),n}let e=this.inner[this.innerDone],t=e.parse.advance();if(t){this.innerDone++;let n=Object.assign(Object.create(null),e.target.props);n[gt.mounted.id]=new Ai(t,e.overlay,e.parser),e.target.props=n}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].from<e&&(e=Math.min(e,this.inner[t].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].parse.stopAt(e)}startInner(){let e=new wg(this.fragments),t=null,n=null,i=new ba(new Dr(this.baseTree,this.ranges[0].from,0,null),Ge.IterMode.IncludeAnonymous|Ge.IterMode.IgnoreMounts);e:for(let a,s;;){let o=!0,l;if(this.stoppedAt!=null&&i.from>=this.stoppedAt)o=!1;else if(e.hasNode(i)){if(t){let u=t.mounts.find(h=>h.frag.from<=i.from&&h.frag.to>=i.to&&h.mount.overlay);if(u)for(let h of u.mount.overlay){let f=h.from+u.pos,c=h.to+u.pos;f>=i.from&&c<=i.to&&!t.ranges.some(d=>d.from<c&&d.to>f)&&t.ranges.push({from:f,to:c})}}o=!1}else if(n&&(s=p3(n.ranges,i.from,i.to)))o=s!=2;else if(!i.type.isAnonymous&&(a=this.nest(i,this.input))&&(i.from<i.to||!a.overlay)){i.tree||g3(i);let u=e.findMounts(i.from,a.parser);if(typeof a.overlay=="function")t=new mg(a.parser,a.overlay,u,this.inner.length,i.from,i.tree,t);else{let h=Q1(this.ranges,a.overlay||(i.from<i.to?[new Mr(i.from,i.to)]:[]));h.length&&$1(h),(h.length||!a.overlay)&&this.inner.push(new Kh(a.parser,h.length?a.parser.startParse(this.input,J1(u,h),h):a.parser.startParse(""),a.overlay?a.overlay.map(f=>new Mr(f.from-i.from,f.to-i.from)):null,i.tree,h.length?h[0].from:i.from)),a.overlay?h.length&&(n={ranges:h,depth:0,prev:n}):o=!1}}else if(t&&(l=t.predicate(i))&&(l===!0&&(l=new Mr(i.from,i.to)),l.from<l.to)){let u=t.ranges.length-1;u>=0&&t.ranges[u].to==l.from?t.ranges[u]={from:t.ranges[u].from,to:l.to}:t.ranges.push(l)}if(o&&i.firstChild())t&&t.depth++,n&&n.depth++;else for(;!i.nextSibling();){if(!i.parent())break e;if(t&&!--t.depth){let u=Q1(this.ranges,t.ranges);u.length&&($1(u),this.inner.splice(t.index,0,new Kh(t.parser,t.parser.startParse(this.input,J1(t.mounts,u),u),t.ranges.map(h=>new Mr(h.from-t.start,h.to-t.start)),t.target,u[0].from))),t=t.prev}n&&!--n.depth&&(n=n.prev)}}}};function p3(r,e,t){for(let n of r){if(n.from>=t)break;if(n.to>e)return n.from<=e&&n.to>=t?2:1}return 0}function Z1(r,e,t,n,i,a){if(e<t){let s=r.buffer[e+1];n.push(r.slice(e,t,s)),i.push(s-a)}}function g3(r){let{node:e}=r,t=[],n=e.context.buffer;do t.push(r.index),r.parent();while(!r.tree);let i=r.tree,a=i.children.indexOf(n),s=i.children[a],o=s.buffer,l=[a];function u(h,f,c,d,p,g){let v=t[g],m=[],y=[];Z1(s,h,v,m,y,d);let b=o[v+1],w=o[v+2];l.push(m.length);let S=g?u(v+4,o[v+3],s.set.types[o[v]],b,w-b,g-1):e.toTree();return m.push(S),y.push(b-d),Z1(s,o[v+3],f,m,y,d),new _r(c,m,y,p)}i.children[a]=u(0,o.length,Zr.none,0,s.length,t.length-1);for(let h of l){let f=r.tree.children[h],c=r.tree.positions[h];r.yield(new Dr(f,c+r.from,h,r._tree))}}var jh=class{constructor(e,t){this.offset=t,this.done=!1,this.cursor=e.cursor(Ge.IterMode.IncludeAnonymous|Ge.IterMode.IgnoreMounts)}moveTo(e){let{cursor:t}=this,n=e-this.offset;for(;!this.done&&t.from<n;)t.to>=e&&t.enter(n,1,Ge.IterMode.IgnoreOverlays|Ge.IterMode.ExcludeBuffers)||t.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let t=this.cursor.tree;;){if(t==e.tree)return!0;if(t.children.length&&t.positions[0]==0&&t.children[0]instanceof _r)t=t.children[0];else break}return!1}},wg=class{constructor(e){var t;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let n=this.curFrag=e[0];this.curTo=(t=n.tree.prop(yg))!==null&&t!==void 0?t:n.to,this.inner=new jh(n.tree,-n.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let t=this.curFrag=this.fragments[this.fragI];this.curTo=(e=t.tree.prop(yg))!==null&&e!==void 0?e:t.to,this.inner=new jh(t.tree,-t.offset)}}findMounts(e,t){var n;let i=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let a=this.inner.cursor.node;a;a=a.parent){let s=(n=a.tree)===null||n===void 0?void 0:n.prop(gt.mounted);if(s&&s.parser==t)for(let o=this.fragI;o<this.fragments.length;o++){let l=this.fragments[o];if(l.from>=a.to)break;l.tree==this.curFrag.tree&&i.push({frag:l,pos:a.from-l.offset,mount:s})}}}return i}};function Q1(r,e){let t=null,n=e;for(let i=1,a=0;i<r.length;i++){let s=r[i-1].to,o=r[i].from;for(;a<n.length;a++){let l=n[a];if(l.from>=o)break;l.to<=s||(t||(n=t=e.slice()),l.from<s?(t[a]=new Mr(l.from,s),l.to>o&&t.splice(a+1,0,new Mr(o,l.to))):l.to>o?t[a--]=new Mr(o,l.to):t.splice(a--,1))}}return n}function v3(r,e,t,n){let i=0,a=0,s=!1,o=!1,l=-1e9,u=[];for(;;){let h=i==r.length?1e9:s?r[i].to:r[i].from,f=a==e.length?1e9:o?e[a].to:e[a].from;if(s!=o){let c=Math.max(l,t),d=Math.min(h,f,n);c<d&&u.push(new Mr(c,d))}if(l=Math.min(h,f),l==1e9)break;h==l&&(s?(s=!1,i++):s=!0),f==l&&(o?(o=!1,a++):o=!0)}return u}function J1(r,e){let t=[];for(let{pos:n,mount:i,frag:a}of r){let s=n+(i.overlay?i.overlay[0].from:0),o=s+i.tree.length,l=Math.max(a.from,s),u=Math.min(a.to,o);if(i.overlay){let h=i.overlay.map(c=>new Mr(c.from+n,c.to+n)),f=v3(e,h,l,u);for(let c=0,d=l;;c++){let p=c==f.length,g=p?u:f[c].from;if(g>d&&t.push(new nl(d,g,i.tree,-s,a.from>=d||a.openStart,a.to<=g||a.openEnd)),p)break;d=f[c].to}}else t.push(new nl(l,u,i.tree,-s,a.from>=s||a.openStart,a.to<=o||a.openEnd))}return t}Ge.DefaultBufferLength=1024;Ge.MountedTree=Ai;Ge.NodeProp=gt;Ge.NodeSet=ug;Ge.NodeType=Zr;Ge.NodeWeakMap=pg;Ge.Parser=gg;Ge.Tree=_r;Ge.TreeBuffer=Zn;Ge.TreeCursor=ba;Ge.TreeFragment=nl;Ge.parseMixed=d3});var uS=B(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});var iS=Yh(),m3=0,Qr=class r{constructor(e,t,n,i){this.name=e,this.set=t,this.base=n,this.modified=i,this.id=m3++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let n=typeof e=="string"?e:"?";if(e instanceof r&&(t=e),t?.base)throw new Error("Can not derive from a modified tag");let i=new r(n,[],null,[]);if(i.set.push(i),t)for(let a of t.set)i.set.push(a);return i}static defineModifier(e){let t=new Qh(e);return n=>n.modified.indexOf(t)>-1?n:Qh.get(n.base||n,n.modified.concat(t).sort((i,a)=>i.id-a.id))}},y3=0,Qh=class r{constructor(e){this.name=e,this.instances=[],this.id=y3++}static get(e,t){if(!t.length)return e;let n=t[0].instances.find(o=>o.base==e&&b3(t,o.modified));if(n)return n;let i=[],a=new Qr(e.name,i,e,t);for(let o of t)o.instances.push(a);let s=w3(t);for(let o of e.set)if(!o.modified.length)for(let l of s)i.push(r.get(o,l));return a}};function b3(r,e){return r.length==e.length&&r.every((t,n)=>t==e[n])}function w3(r){let e=[[]];for(let t=0;t<r.length;t++)for(let n=0,i=e.length;n<i;n++)e.push(e[n].concat(r[t]));return e.sort((t,n)=>n.length-t.length)}function x3(r){let e=Object.create(null);for(let t in r){let n=r[t];Array.isArray(n)||(n=[n]);for(let i of t.split(" "))if(i){let a=[],s=2,o=i;for(let f=0;;){if(o=="..."&&f>0&&f+3==i.length){s=1;break}let c=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!c)throw new RangeError("Invalid path: "+i);if(a.push(c[0]=="*"?"":c[0][0]=='"'?JSON.parse(c[0]):c[0]),f+=c[0].length,f==i.length)break;let d=i[f++];if(f==i.length&&d=="!"){s=0;break}if(d!="/")throw new RangeError("Invalid path: "+i);o=i.slice(f)}let l=a.length-1,u=a[l];if(!u)throw new RangeError("Invalid path: "+i);let h=new ws(n,s,l>0?a.slice(0,l):null);e[u]=h.sort(e[u])}}return aS.add(e)}var aS=new iS.NodeProp,ws=class{constructor(e,t,n,i){this.tags=e,this.mode=t,this.context=n,this.next=i}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}};ws.empty=new ws([],2,null);function sS(r,e){let t=Object.create(null);for(let a of r)if(!Array.isArray(a.tag))t[a.tag.id]=a.class;else for(let s of a.tag)t[s.id]=a.class;let{scope:n,all:i=null}=e||{};return{style:a=>{let s=i;for(let o of a)for(let l of o.set){let u=t[l.id];if(u){s=s?s+" "+u:u;break}}return s},scope:n}}function S3(r,e){let t=null;for(let n of r){let i=n.style(e);i&&(t=t?t+" "+i:i)}return t}function oS(r,e,t,n=0,i=r.length){let a=new kg(n,Array.isArray(e)?e:[e],t);a.highlightRange(r.cursor(),n,i,"",a.highlighters),a.flush(i)}function C3(r,e,t,n,i,a=0,s=r.length){let o=a;function l(u,h){if(!(u<=o)){for(let f=r.slice(o,u),c=0;;){let d=f.indexOf(`
`,c),p=d<0?f.length:d;if(p>c&&n(f.slice(c,p),h),d<0)break;i(),c=d+1}o=u}}oS(e,t,(u,h,f)=>{l(u,""),l(h,f)},a,s),l(s,"")}var kg=class{constructor(e,t,n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,n,i,a){let{type:s,from:o,to:l}=e;if(o>=n||l<=t)return;s.isTop&&(a=this.highlighters.filter(d=>!d.scope||d.scope(s)));let u=i,h=lS(e)||ws.empty,f=S3(a,h.tags);if(f&&(u&&(u+=" "),u+=f,h.mode==1&&(i+=(i?" ":"")+f)),this.startSpan(Math.max(t,o),u),h.opaque)return;let c=e.tree&&e.tree.prop(iS.NodeProp.mounted);if(c&&c.overlay){let d=e.node.enter(c.overlay[0].from+o,1),p=this.highlighters.filter(v=>!v.scope||v.scope(c.tree.type)),g=e.firstChild();for(let v=0,m=o;;v++){let y=v<c.overlay.length?c.overlay[v]:null,b=y?y.from+o:l,w=Math.max(t,m),S=Math.min(n,b);if(w<S&&g)for(;e.from<S&&(this.highlightRange(e,w,S,i,a),this.startSpan(Math.min(S,e.to),u),!(e.to>=b||!e.nextSibling())););if(!y||b>n)break;m=y.to+o,m>t&&(this.highlightRange(d.cursor(),Math.max(t,y.from+o),Math.min(n,m),"",p),this.startSpan(Math.min(n,m),u))}g&&e.parent()}else if(e.firstChild()){c&&(i="");do if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,i,a),this.startSpan(Math.min(n,e.to),u)}while(e.nextSibling());e.parent()}}};function lS(r){let e=r.type.prop(aS);for(;e&&e.context&&!r.matchContext(e.context);)e=e.next;return e||null}var le=Qr.define,Xh=le(),Mi=le(),rS=le(Mi),nS=le(Mi),Di=le(),$h=le(Di),Cg=le(Di),Dn=le(),wa=le(Dn),An=le(),Mn=le(),Eg=le(),il=le(Eg),Zh=le(),Fe={comment:Xh,lineComment:le(Xh),blockComment:le(Xh),docComment:le(Xh),name:Mi,variableName:le(Mi),typeName:rS,tagName:le(rS),propertyName:nS,attributeName:le(nS),className:le(Mi),labelName:le(Mi),namespace:le(Mi),macroName:le(Mi),literal:Di,string:$h,docString:le($h),character:le($h),attributeValue:le($h),number:Cg,integer:le(Cg),float:le(Cg),bool:le(Di),regexp:le(Di),escape:le(Di),color:le(Di),url:le(Di),keyword:An,self:le(An),null:le(An),atom:le(An),unit:le(An),modifier:le(An),operatorKeyword:le(An),controlKeyword:le(An),definitionKeyword:le(An),moduleKeyword:le(An),operator:Mn,derefOperator:le(Mn),arithmeticOperator:le(Mn),logicOperator:le(Mn),bitwiseOperator:le(Mn),compareOperator:le(Mn),updateOperator:le(Mn),definitionOperator:le(Mn),typeOperator:le(Mn),controlOperator:le(Mn),punctuation:Eg,separator:le(Eg),bracket:il,angleBracket:le(il),squareBracket:le(il),paren:le(il),brace:le(il),content:Dn,heading:wa,heading1:le(wa),heading2:le(wa),heading3:le(wa),heading4:le(wa),heading5:le(wa),heading6:le(wa),contentSeparator:le(Dn),list:le(Dn),quote:le(Dn),emphasis:le(Dn),strong:le(Dn),link:le(Dn),monospace:le(Dn),strikethrough:le(Dn),inserted:le(),deleted:le(),changed:le(),invalid:le(),meta:Zh,documentMeta:le(Zh),annotation:le(Zh),processingInstruction:le(Zh),definition:Qr.defineModifier("definition"),constant:Qr.defineModifier("constant"),function:Qr.defineModifier("function"),standard:Qr.defineModifier("standard"),local:Qr.defineModifier("local"),special:Qr.defineModifier("special")};for(let r in Fe){let e=Fe[r];e instanceof Qr&&(e.name=r)}var k3=sS([{tag:Fe.link,class:"tok-link"},{tag:Fe.heading,class:"tok-heading"},{tag:Fe.emphasis,class:"tok-emphasis"},{tag:Fe.strong,class:"tok-strong"},{tag:Fe.keyword,class:"tok-keyword"},{tag:Fe.atom,class:"tok-atom"},{tag:Fe.bool,class:"tok-bool"},{tag:Fe.url,class:"tok-url"},{tag:Fe.labelName,class:"tok-labelName"},{tag:Fe.inserted,class:"tok-inserted"},{tag:Fe.deleted,class:"tok-deleted"},{tag:Fe.literal,class:"tok-literal"},{tag:Fe.string,class:"tok-string"},{tag:Fe.number,class:"tok-number"},{tag:[Fe.regexp,Fe.escape,Fe.special(Fe.string)],class:"tok-string2"},{tag:Fe.variableName,class:"tok-variableName"},{tag:Fe.local(Fe.variableName),class:"tok-variableName tok-local"},{tag:Fe.definition(Fe.variableName),class:"tok-variableName tok-definition"},{tag:Fe.special(Fe.variableName),class:"tok-variableName2"},{tag:Fe.definition(Fe.propertyName),class:"tok-propertyName tok-definition"},{tag:Fe.typeName,class:"tok-typeName"},{tag:Fe.namespace,class:"tok-namespace"},{tag:Fe.className,class:"tok-className"},{tag:Fe.macroName,class:"tok-macroName"},{tag:Fe.propertyName,class:"tok-propertyName"},{tag:Fe.operator,class:"tok-operator"},{tag:Fe.comment,class:"tok-comment"},{tag:Fe.meta,class:"tok-meta"},{tag:Fe.invalid,class:"tok-invalid"},{tag:Fe.punctuation,class:"tok-punctuation"}]);Pn.Tag=Qr;Pn.classHighlighter=k3;Pn.getStyleTags=lS;Pn.highlightCode=C3;Pn.highlightTree=oS;Pn.styleTags=x3;Pn.tagHighlighter=sS;Pn.tags=Fe});var af=B(we=>{"use strict";var Ue=Yh(),Qe=bi(),qe=Ti(),Ve=uS(),hS=np(),Tg,Pi=new Ue.NodeProp;function zg(r){return Qe.Facet.define({combine:r?e=>e.concat(r):void 0})}var bS=new Ue.NodeProp,tr=class{constructor(e,t,n=[],i=""){this.data=e,this.name=i,Qe.EditorState.prototype.hasOwnProperty("tree")||Object.defineProperty(Qe.EditorState.prototype,"tree",{get(){return Pr(this)}}),this.parser=t,this.extension=[Qn.of(this),Qe.EditorState.languageData.of((a,s,o)=>{let l=fS(a,s,o),u=l.type.prop(Pi);if(!u)return[];let h=a.facet(u),f=l.type.prop(bS);if(f){let c=l.resolve(s-l.from,o);for(let d of f)if(d.test(c,a)){let p=a.facet(d.facet);return d.type=="replace"?p:p.concat(h)}}return h})].concat(n)}isActiveAt(e,t,n=-1){return fS(e,t,n).type.prop(Pi)==this.data}findRegions(e){let t=e.facet(Qn);if(t?.data==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(a,s)=>{if(a.prop(Pi)==this.data){n.push({from:s,to:s+a.length});return}let o=a.prop(Ue.NodeProp.mounted);if(o){if(o.tree.prop(Pi)==this.data){if(o.overlay)for(let l of o.overlay)n.push({from:l.from+s,to:l.to+s});else n.push({from:s,to:s+a.length});return}else if(o.overlay){let l=n.length;if(i(o.tree,o.overlay[0].from+s),n.length>l)return}}for(let l=0;l<a.children.length;l++){let u=a.children[l];u instanceof Ue.Tree&&i(u,a.positions[l]+s)}};return i(Pr(e),0),n}get allowsNesting(){return!0}};tr.setState=Qe.StateEffect.define();function fS(r,e,t){let n=r.facet(Qn),i=Pr(r).topNode;if(!n||n.allowsNesting)for(let a=i;a;a=a.enter(e,t,Ue.IterMode.ExcludeBuffers))a.type.isTop&&(i=a);return i}var Dg=class r extends tr{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=zg(e.languageData);return new r(t,e.parser.configure({props:[Pi.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e,t){return new r(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}};function Pr(r){let e=r.field(tr.state,!1);return e?e.tree:Ue.Tree.empty}function wS(r,e,t=50){var n;let i=(n=r.field(tr.state,!1))===null||n===void 0?void 0:n.context;if(!i)return null;let a=i.viewport;i.updateViewport({from:0,to:e});let s=i.isDone(e)||i.work(t,e)?i.tree:null;return i.updateViewport(a),s}function E3(r,e=r.doc.length){var t;return((t=r.field(tr.state,!1))===null||t===void 0?void 0:t.context.isDone(e))||!1}function T3(r,e=r.viewport.to,t=100){let n=wS(r.state,e,t);return n!=Pr(r.state)&&r.dispatch({}),!!n}function A3(r){var e;return((e=r.plugin(SS))===null||e===void 0?void 0:e.isWorking())||!1}var ef=class{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}},al=null,xs=class r{constructor(e,t,n=[],i,a,s,o,l){this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=a,this.viewport=s,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new r(e,t,[],Ue.Tree.empty,0,n,[],null)}startParse(){return this.parser.startParse(new ef(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=Ue.Tree.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(Ue.TreeFragment.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Ue.TreeFragment.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=al;al=this;try{return e()}finally{al=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=cS(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:i,treeLen:a,viewport:s,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((u,h,f,c)=>l.push({fromA:u,toA:h,fromB:f,toB:c})),n=Ue.TreeFragment.applyChanges(n,l),i=Ue.Tree.empty,a=0,s={from:e.mapPos(s.from,-1),to:e.mapPos(s.to,1)},this.skipped.length){o=[];for(let u of this.skipped){let h=e.mapPos(u.from,1),f=e.mapPos(u.to,-1);h<f&&o.push({from:h,to:f})}}}return new r(this.parser,t,n,i,a,s,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:i,to:a}=this.skipped[n];i<e.to&&a>e.from&&(this.fragments=cS(this.fragments,i,a),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Ue.Parser{createParse(t,n,i){let a=i[0].from,s=i[i.length-1].to;return{parsedPos:a,advance(){let l=al;if(l){for(let u of i)l.tempSkipped.push(u);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=s,new Ue.Tree(Ue.NodeType.none,[],[],s-a)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return al}};function cS(r,e,t){return Ue.TreeFragment.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}var ll=class r{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new r(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=xs.create(e.facet(Qn).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new r(n)}};tr.state=Qe.StateField.define({create:ll.init,update(r,e){for(let t of e.effects)if(t.is(tr.setState))return t.value;return e.startState.facet(Qn)!=e.state.facet(Qn)?ll.init(e.state):r.apply(e)}});var xS=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(xS=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});var Ag=typeof navigator<"u"&&(!((Tg=navigator.scheduling)===null||Tg===void 0)&&Tg.isInputPending)?()=>navigator.scheduling.isInputPending():null,SS=qe.ViewPlugin.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(tr.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(tr.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=xS(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,a=n.field(tr.state);if(a.tree==a.context.tree&&a.context.isDone(i+1e5))return;let s=Date.now()+Math.min(this.chunkBudget,100,e&&!Ag?Math.max(25,e.timeRemaining()-5):1e9),o=a.context.treeLen<i&&n.doc.length>i+1e3,l=a.context.work(()=>Ag&&Ag()||Date.now()>s,i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(a.context.takeTree(),this.view.dispatch({effects:tr.setState.of(new ll(a.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(a.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>qe.logException(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Qn=Qe.Facet.define({combine(r){return r.length?r[0]:null},enables:r=>[tr.state,SS,qe.EditorView.contentAttributes.compute([r],e=>{let t=e.facet(r);return t&&t.name?{"data-language":t.name}:{}})]}),Pg=class{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}},Bg=class r{constructor(e,t,n,i,a,s=void 0){this.name=e,this.alias=t,this.extensions=n,this.filename=i,this.loadFunc=a,this.support=s,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:t,support:n}=e;if(!t){if(!n)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");t=()=>Promise.resolve(n)}return new r(e.name,(e.alias||[]).concat(e.name).map(i=>i.toLowerCase()),e.extensions||[],e.filename,t,n)}static matchFilename(e,t){for(let i of e)if(i.filename&&i.filename.test(t))return i;let n=/\.([^.]+)$/.exec(t);if(n){for(let i of e)if(i.extensions.indexOf(n[1])>-1)return i}return null}static matchLanguageName(e,t,n=!0){t=t.toLowerCase();for(let i of e)if(i.alias.some(a=>a==t))return i;if(n)for(let i of e)for(let a of i.alias){let s=t.indexOf(a);if(s>-1&&(a.length>2||!/\w/.test(t[s-1])&&!/\w/.test(t[s+a.length])))return i}return null}},CS=Qe.Facet.define(),Vg=Qe.Facet.define({combine:r=>{if(!r.length)return"  ";let e=r[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return e}});function ul(r){let e=r.facet(Vg);return e.charCodeAt(0)==9?r.tabSize*e.length:e.length}function Hg(r,e){let t="",n=r.tabSize,i=r.facet(Vg)[0];if(i=="	"){for(;e>=n;)t+="	",e-=n;i=" "}for(let a=0;a<e;a++)t+=i;return t}function Wg(r,e){r instanceof Qe.EditorState&&(r=new Ss(r));for(let n of r.state.facet(CS)){let i=n(r,e);if(i!==void 0)return i}let t=Pr(r.state);return t.length>=e?D3(r,t,e):null}function M3(r,e,t){let n=Object.create(null),i=new Ss(r,{overrideIndentation:s=>{var o;return(o=n[s])!==null&&o!==void 0?o:-1}}),a=[];for(let s=e;s<=t;){let o=r.doc.lineAt(s);s=o.to+1;let l=Wg(i,o.from);if(l==null)continue;/\S/.test(o.text)||(l=0);let u=/^\s*/.exec(o.text)[0],h=Hg(r,l);u!=h&&(n[o.from]=l,a.push({from:o.from,to:o.from+u.length,insert:h}))}return r.changes(a)}var Ss=class{constructor(e,t={}){this.state=e,this.options=t,this.unit=ul(e)}lineAt(e,t=1){let n=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:a}=this.options;return i!=null&&i>=n.from&&i<=n.to?a&&i==e?{text:"",from:e}:(t<0?i<e:i<=e)?{text:n.text.slice(i-n.from),from:i}:{text:n.text.slice(0,i-n.from),from:n.from}:n}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:i}=this.lineAt(e,t);return n.slice(e-i,Math.min(n.length,e+100-i))}column(e,t=1){let{text:n,from:i}=this.lineAt(e,t),a=this.countColumn(n,e-i),s=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return s>-1&&(a+=s-this.countColumn(n,n.search(/\S|$/))),a}countColumn(e,t=e.length){return Qe.countColumn(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:n,from:i}=this.lineAt(e,t),a=this.options.overrideIndentation;if(a){let s=a(i);if(s>-1)return s}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}},Gg=new Ue.NodeProp;function D3(r,e,t){let n=e.resolveStack(t),i=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(i!=n.node){let a=[];for(let s=i;s&&!(s.from==n.node.from&&s.type==n.node.type);s=s.parent)a.push(s);for(let s=a.length-1;s>=0;s--)n={node:a[s],next:n}}return kS(n,r,t)}function kS(r,e,t){for(let n=r;n;n=n.next){let i=B3(n.node);if(i)return i(tf.create(e,t,n))}return 0}function P3(r){return r.pos==r.options.simulateBreak&&r.options.simulateDoubleBreak}function B3(r){let e=r.type.prop(Gg);if(e)return e;let t=r.firstChild,n;if(t&&(n=t.type.prop(Ue.NodeProp.closedBy))){let i=r.lastChild,a=i&&n.indexOf(i.name)>-1;return s=>ES(s,!0,1,void 0,a&&!P3(s)?i.from:void 0)}return r.parent==null?O3:null}function O3(){return 0}var tf=class r extends Ss{constructor(e,t,n){super(e.state,e.options),this.base=e,this.pos=t,this.context=n}get node(){return this.context.node}static create(e,t,n){return new r(e,t,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(t.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(R3(n,e))break;t=this.state.doc.lineAt(n.from)}return this.lineIndent(t.from)}continue(){return kS(this.context.next,this.base,this.pos)}};function R3(r,e){for(let t=e;t;t=t.parent)if(r==t)return!0;return!1}function L3(r){let e=r.node,t=e.childAfter(e.from),n=e.lastChild;if(!t)return null;let i=r.options.simulateBreak,a=r.state.doc.lineAt(t.from),s=i==null||i<=a.from?a.to:Math.min(a.to,i);for(let o=t.to;;){let l=e.childAfter(o);if(!l||l==n)return null;if(!l.type.isSkipped){if(l.from>=s)return null;let u=/^ */.exec(a.text.slice(t.to-a.from))[0].length;return{from:t.from,to:t.to+u}}o=l.to}}function I3({closing:r,align:e=!0,units:t=1}){return n=>ES(n,e,t,r)}function ES(r,e,t,n,i){let a=r.textAfter,s=a.match(/^\s*/)[0].length,o=n&&a.slice(s,s+n.length)==n||i==r.pos+s,l=e?L3(r):null;return l?o?r.column(l.from):r.column(l.to):r.baseIndent+(o?0:r.unit*t)}var N3=r=>r.baseIndent;function q3({except:r,units:e=1}={}){return t=>{let n=r&&r.test(t.textAfter);return t.baseIndent+(n?0:e*t.unit)}}var F3=200;function _3(){return Qe.EditorState.transactionFilter.of(r=>{if(!r.docChanged||!r.isUserEvent("input.type")&&!r.isUserEvent("input.complete"))return r;let e=r.startState.languageDataAt("indentOnInput",r.startState.selection.main.head);if(!e.length)return r;let t=r.newDoc,{head:n}=r.newSelection.main,i=t.lineAt(n);if(n>i.from+F3)return r;let a=t.sliceString(i.from,n);if(!e.some(u=>u.test(a)))return r;let{state:s}=r,o=-1,l=[];for(let{head:u}of s.selection.ranges){let h=s.doc.lineAt(u);if(h.from==o)continue;o=h.from;let f=Wg(s,h.from);if(f==null)continue;let c=/^\s*/.exec(h.text)[0],d=Hg(s,f);c!=d&&l.push({from:h.from,to:h.from+c.length,insert:d})}return l.length?[r,{changes:l,sequential:!0}]:r})}var TS=Qe.Facet.define(),AS=new Ue.NodeProp;function z3(r){let e=r.firstChild,t=r.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?r.to:t.from}:null}function V3(r,e,t){let n=Pr(r);if(n.length<t)return null;let i=n.resolveStack(t,1),a=null;for(let s=i;s;s=s.next){let o=s.node;if(o.to<=t||o.from>t)continue;if(a&&o.from<e)break;let l=o.type.prop(AS);if(l&&(o.to<n.length-50||n.length==r.doc.length||!H3(o))){let u=l(o,r);u&&u.from<=t&&u.from>=e&&u.to>t&&(a=u)}}return a}function H3(r){let e=r.lastChild;return e&&e.to==r.to&&e.type.isError}function Cs(r,e,t){for(let n of r.facet(TS)){let i=n(r,e,t);if(i)return i}return V3(r,e,t)}function MS(r,e){let t=e.mapPos(r.from,1),n=e.mapPos(r.to,-1);return t>=n?void 0:{from:t,to:n}}var ks=Qe.StateEffect.define({map:MS}),xa=Qe.StateEffect.define({map:MS});function Ug(r){let e=[];for(let{head:t}of r.state.selection.ranges)e.some(n=>n.from<=t&&n.to>=t)||e.push(r.lineBlockAt(t));return e}var Jn=Qe.StateField.define({create(){return qe.Decoration.none},update(r,e){r=r.map(e.changes);for(let t of e.effects)if(t.is(ks)&&!G3(r,t.value.from,t.value.to)){let{preparePlaceholder:n}=e.state.facet(jg),i=n?qe.Decoration.replace({widget:new Og(n(e.state,t.value))}):dS;r=r.update({add:[i.range(t.value.from,t.value.to)]})}else t.is(xa)&&(r=r.update({filter:(n,i)=>t.value.from!=n||t.value.to!=i,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:n}=e.selection.main;r.between(n,n,(i,a)=>{i<n&&a>n&&(t=!0)}),t&&(r=r.update({filterFrom:n,filterTo:n,filter:(i,a)=>a<=n||i>=n}))}return r},provide:r=>qe.EditorView.decorations.from(r),toJSON(r,e){let t=[];return r.between(0,e.doc.length,(n,i)=>{t.push(n,i)}),t},fromJSON(r){if(!Array.isArray(r)||r.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<r.length;){let n=r[t++],i=r[t++];if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid JSON for fold state");e.push(dS.range(n,i))}return qe.Decoration.set(e,!0)}});function W3(r){return r.field(Jn,!1)||Qe.RangeSet.empty}function hl(r,e,t){var n;let i=null;return(n=r.field(Jn,!1))===null||n===void 0||n.between(e,t,(a,s)=>{(!i||i.from>a)&&(i={from:a,to:s})}),i}function G3(r,e,t){let n=!1;return r.between(e,e,(i,a)=>{i==e&&a==t&&(n=!0)}),n}function Kg(r,e){return r.field(Jn,!1)?e:e.concat(Qe.StateEffect.appendConfig.of(Yg()))}var DS=r=>{for(let e of Ug(r)){let t=Cs(r.state,e.from,e.to);if(t)return r.dispatch({effects:Kg(r.state,[ks.of(t),rf(r,t)])}),!0}return!1},PS=r=>{if(!r.state.field(Jn,!1))return!1;let e=[];for(let t of Ug(r)){let n=hl(r.state,t.from,t.to);n&&e.push(xa.of(n),rf(r,n,!1))}return e.length&&r.dispatch({effects:e}),e.length>0};function rf(r,e,t=!0){let n=r.state.doc.lineAt(e.from).number,i=r.state.doc.lineAt(e.to).number;return qe.EditorView.announce.of(`${r.state.phrase(t?"Folded lines":"Unfolded lines")} ${n} ${r.state.phrase("to")} ${i}.`)}var BS=r=>{let{state:e}=r,t=[];for(let n=0;n<e.doc.length;){let i=r.lineBlockAt(n),a=Cs(e,i.from,i.to);a&&t.push(ks.of(a)),n=(a?r.lineBlockAt(a.to):i).to+1}return t.length&&r.dispatch({effects:Kg(r.state,t)}),!!t.length},OS=r=>{let e=r.state.field(Jn,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,r.state.doc.length,(n,i)=>{t.push(xa.of({from:n,to:i}))}),r.dispatch({effects:t}),!0};function U3(r,e){for(let t=e;;){let n=Cs(r.state,t.from,t.to);if(n&&n.to>e.from)return n;if(!t.from)return null;t=r.lineBlockAt(t.from-1)}}var K3=r=>{let e=[];for(let t of Ug(r)){let n=hl(r.state,t.from,t.to);if(n)e.push(xa.of(n),rf(r,n,!1));else{let i=U3(r,t);i&&e.push(ks.of(i),rf(r,i))}}return e.length>0&&r.dispatch({effects:Kg(r.state,e)}),!!e.length},j3=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:DS},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:PS},{key:"Ctrl-Alt-[",run:BS},{key:"Ctrl-Alt-]",run:OS}],Y3={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},jg=Qe.Facet.define({combine(r){return Qe.combineConfig(r,Y3)}});function Yg(r){let e=[Jn,Z3];return r&&e.push(jg.of(r)),e}function RS(r,e){let{state:t}=r,n=t.facet(jg),i=s=>{let o=r.lineBlockAt(r.posAtDOM(s.target)),l=hl(r.state,o.from,o.to);l&&r.dispatch({effects:xa.of(l)}),s.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(r,i,e);let a=document.createElement("span");return a.textContent=n.placeholderText,a.setAttribute("aria-label",t.phrase("folded code")),a.title=t.phrase("unfold"),a.className="cm-foldPlaceholder",a.onclick=i,a}var dS=qe.Decoration.replace({widget:new class extends qe.WidgetType{toDOM(r){return RS(r,null)}}}),Og=class extends qe.WidgetType{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return RS(e,this.value)}},X3={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1},ol=class extends qe.GutterMarker{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}};function $3(r={}){let e=Object.assign(Object.assign({},X3),r),t=new ol(e,!0),n=new ol(e,!1),i=qe.ViewPlugin.fromClass(class{constructor(s){this.from=s.viewport.from,this.markers=this.buildMarkers(s)}update(s){(s.docChanged||s.viewportChanged||s.startState.facet(Qn)!=s.state.facet(Qn)||s.startState.field(Jn,!1)!=s.state.field(Jn,!1)||Pr(s.startState)!=Pr(s.state)||e.foldingChanged(s))&&(this.markers=this.buildMarkers(s.view))}buildMarkers(s){let o=new Qe.RangeSetBuilder;for(let l of s.viewportLineBlocks){let u=hl(s.state,l.from,l.to)?n:Cs(s.state,l.from,l.to)?t:null;u&&o.add(l.from,l.from,u)}return o.finish()}}),{domEventHandlers:a}=e;return[i,qe.gutter({class:"cm-foldGutter",markers(s){var o;return((o=s.plugin(i))===null||o===void 0?void 0:o.markers)||Qe.RangeSet.empty},initialSpacer(){return new ol(e,!1)},domEventHandlers:Object.assign(Object.assign({},a),{click:(s,o,l)=>{if(a.click&&a.click(s,o,l))return!0;let u=hl(s.state,o.from,o.to);if(u)return s.dispatch({effects:xa.of(u)}),!0;let h=Cs(s.state,o.from,o.to);return h?(s.dispatch({effects:ks.of(h)}),!0):!1}})}),Yg()]}var Z3=qe.EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}}),fl=class r{constructor(e,t){this.specs=e;let n;function i(o){let l=hS.StyleModule.newName();return(n||(n=Object.create(null)))["."+l]=o,l}let a=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,s=t.scope;this.scope=s instanceof tr?o=>o.prop(Pi)==s.data:s?o=>o==s:void 0,this.style=Ve.tagHighlighter(e.map(o=>({tag:o.tag,class:o.class||i(Object.assign({},o,{tag:null}))})),{all:a}).style,this.module=n?new hS.StyleModule(n):null,this.themeType=t.themeType}static define(e,t){return new r(e,t||{})}},Rg=Qe.Facet.define(),LS=Qe.Facet.define({combine(r){return r.length?[r[0]]:null}});function Jh(r){let e=r.facet(Rg);return e.length?e:r.facet(LS)}function Q3(r,e){let t=[e4],n;return r instanceof fl&&(r.module&&t.push(qe.EditorView.styleModule.of(r.module)),n=r.themeType),e?.fallback?t.push(LS.of(r)):n?t.push(Rg.computeN([qe.EditorView.darkTheme],i=>i.facet(qe.EditorView.darkTheme)==(n=="dark")?[r]:[])):t.push(Rg.of(r)),t}function J3(r,e,t){let n=Jh(r),i=null;if(n){for(let a of n)if(!a.scope||t&&a.scope(t)){let s=a.style(e);s&&(i=i?i+" "+s:s)}}return i}var Lg=class{constructor(e){this.markCache=Object.create(null),this.tree=Pr(e.state),this.decorations=this.buildDeco(e,Jh(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=Pr(e.state),n=Jh(e.state),i=n!=Jh(e.startState),{viewport:a}=e.view,s=e.changes.mapPos(this.decoratedTo,1);t.length<a.to&&!i&&t.type==this.tree.type&&s>=a.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=s):(t!=this.tree||e.viewportChanged||i)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=a.to)}buildDeco(e,t){if(!t||!this.tree.length)return qe.Decoration.none;let n=new Qe.RangeSetBuilder;for(let{from:i,to:a}of e.visibleRanges)Ve.highlightTree(this.tree,t,(s,o,l)=>{n.add(s,o,this.markCache[l]||(this.markCache[l]=qe.Decoration.mark({class:l})))},i,a);return n.finish()}},e4=Qe.Prec.high(qe.ViewPlugin.fromClass(Lg,{decorations:r=>r.decorations})),t4=fl.define([{tag:Ve.tags.meta,color:"#404740"},{tag:Ve.tags.link,textDecoration:"underline"},{tag:Ve.tags.heading,textDecoration:"underline",fontWeight:"bold"},{tag:Ve.tags.emphasis,fontStyle:"italic"},{tag:Ve.tags.strong,fontWeight:"bold"},{tag:Ve.tags.strikethrough,textDecoration:"line-through"},{tag:Ve.tags.keyword,color:"#708"},{tag:[Ve.tags.atom,Ve.tags.bool,Ve.tags.url,Ve.tags.contentSeparator,Ve.tags.labelName],color:"#219"},{tag:[Ve.tags.literal,Ve.tags.inserted],color:"#164"},{tag:[Ve.tags.string,Ve.tags.deleted],color:"#a11"},{tag:[Ve.tags.regexp,Ve.tags.escape,Ve.tags.special(Ve.tags.string)],color:"#e40"},{tag:Ve.tags.definition(Ve.tags.variableName),color:"#00f"},{tag:Ve.tags.local(Ve.tags.variableName),color:"#30a"},{tag:[Ve.tags.typeName,Ve.tags.namespace],color:"#085"},{tag:Ve.tags.className,color:"#167"},{tag:[Ve.tags.special(Ve.tags.variableName),Ve.tags.macroName],color:"#256"},{tag:Ve.tags.definition(Ve.tags.propertyName),color:"#00c"},{tag:Ve.tags.comment,color:"#940"},{tag:Ve.tags.invalid,color:"#f00"}]),r4=qe.EditorView.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),IS=1e4,NS="()[]{}",qS=Qe.Facet.define({combine(r){return Qe.combineConfig(r,{afterCursor:!0,brackets:NS,maxScanDistance:IS,renderMatch:a4})}}),n4=qe.Decoration.mark({class:"cm-matchingBracket"}),i4=qe.Decoration.mark({class:"cm-nonmatchingBracket"});function a4(r){let e=[],t=r.matched?n4:i4;return e.push(t.range(r.start.from,r.start.to)),r.end&&e.push(t.range(r.end.from,r.end.to)),e}var s4=Qe.StateField.define({create(){return qe.Decoration.none},update(r,e){if(!e.docChanged&&!e.selection)return r;let t=[],n=e.state.facet(qS);for(let i of e.state.selection.ranges){if(!i.empty)continue;let a=sl(e.state,i.head,-1,n)||i.head>0&&sl(e.state,i.head-1,1,n)||n.afterCursor&&(sl(e.state,i.head,1,n)||i.head<e.state.doc.length&&sl(e.state,i.head+1,-1,n));a&&(t=t.concat(n.renderMatch(a,e.state)))}return qe.Decoration.set(t,!0)},provide:r=>qe.EditorView.decorations.from(r)}),o4=[s4,r4];function l4(r={}){return[qS.of(r),o4]}var FS=new Ue.NodeProp;function Ig(r,e,t){let n=r.prop(e<0?Ue.NodeProp.openedBy:Ue.NodeProp.closedBy);if(n)return n;if(r.name.length==1){let i=t.indexOf(r.name);if(i>-1&&i%2==(e<0?1:0))return[t[i+e]]}return null}function Ng(r){let e=r.type.prop(FS);return e?e(r.node):r}function sl(r,e,t,n={}){let i=n.maxScanDistance||IS,a=n.brackets||NS,s=Pr(r),o=s.resolveInner(e,t);for(let l=o;l;l=l.parent){let u=Ig(l.type,t,a);if(u&&l.from<l.to){let h=Ng(l);if(h&&(t>0?e>=h.from&&e<h.to:e>h.from&&e<=h.to))return u4(r,e,t,l,h,u,a)}}return h4(r,e,t,s,o.type,i,a)}function u4(r,e,t,n,i,a,s){let o=n.parent,l={from:i.from,to:i.to},u=0,h=o?.cursor();if(h&&(t<0?h.childBefore(n.from):h.childAfter(n.to)))do if(t<0?h.to<=n.from:h.from>=n.to){if(u==0&&a.indexOf(h.type.name)>-1&&h.from<h.to){let f=Ng(h);return{start:l,end:f?{from:f.from,to:f.to}:void 0,matched:!0}}else if(Ig(h.type,t,s))u++;else if(Ig(h.type,-t,s)){if(u==0){let f=Ng(h);return{start:l,end:f&&f.from<f.to?{from:f.from,to:f.to}:void 0,matched:!1}}u--}}while(t<0?h.prevSibling():h.nextSibling());return{start:l,matched:!1}}function h4(r,e,t,n,i,a,s){let o=t<0?r.sliceDoc(e-1,e):r.sliceDoc(e,e+1),l=s.indexOf(o);if(l<0||l%2==0!=t>0)return null;let u={from:t<0?e-1:e,to:t>0?e+1:e},h=r.doc.iterRange(e,t>0?r.doc.length:0),f=0;for(let c=0;!h.next().done&&c<=a;){let d=h.value;t<0&&(c+=d.length);let p=e+c*t;for(let g=t>0?0:d.length-1,v=t>0?d.length:-1;g!=v;g+=t){let m=s.indexOf(d[g]);if(!(m<0||n.resolveInner(p+g,1).type!=i))if(m%2==0==t>0)f++;else{if(f==1)return{start:u,end:{from:p+g,to:p+g+1},matched:m>>1==l>>1};f--}}t>0&&(c+=d.length)}return h.done?{start:u,matched:!1}:null}function pS(r,e,t,n=0,i=0){e==null&&(e=r.search(/[^\s\u00a0]/),e==-1&&(e=r.length));let a=i;for(let s=n;s<e;s++)r.charCodeAt(s)==9?a+=t-a%t:a++;return a}var cl=class{constructor(e,t,n,i){this.string=e,this.tabSize=t,this.indentUnit=n,this.overrideIndent=i,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),n;if(typeof e=="string"?n=t==e:n=t&&(e instanceof RegExp?e.test(t):e(t)),n)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=pS(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:pS(this.string,null,this.tabSize)}match(e,t,n){if(typeof e=="string"){let i=s=>n?s.toLowerCase():s,a=this.string.substr(this.pos,e.length);return i(a)==i(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&t!==!1&&(this.pos+=i[0].length),i)}}current(){return this.string.slice(this.start,this.pos)}};function f4(r){return{name:r.name||"",token:r.token,blankLine:r.blankLine||(()=>{}),startState:r.startState||(()=>!0),copyState:r.copyState||c4,indent:r.indent||(()=>null),languageData:r.languageData||{},tokenTable:r.tokenTable||$g,mergeTokens:r.mergeTokens!==!1}}function c4(r){if(typeof r!="object")return r;let e={};for(let t in r){let n=r[t];e[t]=n instanceof Array?n.slice():n}return e}var gS=new WeakMap,qg=class r extends tr{constructor(e){let t=zg(e.languageData),n=f4(e),i,a=new class extends Ue.Parser{createParse(s,o,l){return new Fg(i,s,o,l)}};super(t,a,[],e.name),this.topNode=v4(t,this),i=this,this.streamParser=n,this.stateAfter=new Ue.NodeProp({perNode:!0}),this.tokenTable=e.tokenTable?new nf(n.tokenTable):g4}static define(e){return new r(e)}getIndent(e){let t,{overrideIndentation:n}=e.options;n&&(t=gS.get(e.state),t!=null&&t<e.pos-1e4&&(t=void 0));let i=Xg(this,e.node.tree,e.node.from,e.node.from,t??e.pos),a,s;if(i?(s=i.state,a=i.pos+1):(s=this.streamParser.startState(e.unit),a=e.node.from),e.pos-a>1e4)return null;for(;a<e.pos;){let l=e.state.doc.lineAt(a),u=Math.min(e.pos,l.to);if(l.length){let h=n?n(l.from):-1,f=new cl(l.text,e.state.tabSize,e.unit,h<0?void 0:h);for(;f.pos<u-l.from;)zS(this.streamParser.token,f,s)}else this.streamParser.blankLine(s,e.unit);if(u==e.pos)break;a=l.to+1}let o=e.lineAt(e.pos);return n&&t==null&&gS.set(e.state,o.from),this.streamParser.indent(s,/^\s*(.*)/.exec(o.text)[1],e)}get allowsNesting(){return!1}};function Xg(r,e,t,n,i){let a=t>=n&&t+e.length<=i&&e.prop(r.stateAfter);if(a)return{state:r.streamParser.copyState(a),pos:t+e.length};for(let s=e.children.length-1;s>=0;s--){let o=e.children[s],l=t+e.positions[s],u=o instanceof Ue.Tree&&l<i&&Xg(r,o,l,n,i);if(u)return u}return null}function _S(r,e,t,n,i){if(i&&t<=0&&n>=e.length)return e;!i&&t==0&&e.type==r.topNode&&(i=!0);for(let a=e.children.length-1;a>=0;a--){let s=e.positions[a],o=e.children[a],l;if(s<n&&o instanceof Ue.Tree){if(!(l=_S(r,o,t-s,n-s,i)))break;return i?new Ue.Tree(e.type,e.children.slice(0,a).concat(l),e.positions.slice(0,a+1),s+l.length):l}}return null}function d4(r,e,t,n,i){for(let a of e){let s=a.from+(a.openStart?25:0),o=a.to-(a.openEnd?25:0),l=s<=t&&o>t&&Xg(r,a.tree,0-a.offset,t,o),u;if(l&&l.pos<=n&&(u=_S(r,a.tree,t+a.offset,l.pos+a.offset,!1)))return{state:l.state,tree:u}}return{state:r.streamParser.startState(i?ul(i):4),tree:Ue.Tree.empty}}var Fg=class{constructor(e,t,n,i){this.lang=e,this.input=t,this.fragments=n,this.ranges=i,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=i[i.length-1].to;let a=xs.get(),s=i[0].from,{state:o,tree:l}=d4(e,n,s,this.to,a?.state);this.state=o,this.parsedPos=this.chunkStart=s+l.length;for(let u=0;u<l.children.length;u++)this.chunks.push(l.children[u]),this.chunkPos.push(l.positions[u]);a&&this.parsedPos<a.viewport.from-1e5&&i.some(u=>u.from<=a.viewport.from&&u.to>=a.viewport.from)&&(this.state=this.lang.streamParser.startState(ul(a.state)),a.skipUntilInView(this.parsedPos,a.viewport.from),this.parsedPos=a.viewport.from),this.moveRangeIndex()}advance(){let e=xs.get(),t=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),n=Math.min(t,this.chunkStart+2048);for(e&&(n=Math.min(n,e.viewport.to));this.parsedPos<n;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)t==`
`&&(t="");else{let n=t.indexOf(`
`);n>-1&&(t=t.slice(0,n))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),n=e+t.length;for(let i=this.rangeIndex;;){let a=this.ranges[i].to;if(a>=n||(t=t.slice(0,a-(n-t.length)),i++,i==this.ranges.length))break;let s=this.ranges[i].from,o=this.lineAfter(s);t+=o,n=s+o.length}return{line:t,end:n}}skipGapsTo(e,t,n){for(;;){let i=this.ranges[this.rangeIndex].to,a=e+t;if(n>0?i>a:i>=a)break;let s=this.ranges[++this.rangeIndex].from;t+=s-i}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,n,i){let a=4;if(this.ranges.length>1){i=this.skipGapsTo(t,i,1),t+=i;let o=this.chunk.length;i=this.skipGapsTo(n,i,-1),n+=i,a+=this.chunk.length-o}let s=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&a==4&&s>=0&&this.chunk[s]==e&&this.chunk[s+2]==t?this.chunk[s+2]=n:this.chunk.push(e,t,n,a),i}parseLine(e){let{line:t,end:n}=this.nextLine(),i=0,{streamParser:a}=this.lang,s=new cl(t,e?e.state.tabSize:4,e?ul(e.state):2);if(s.eol())a.blankLine(this.state,s.indentUnit);else for(;!s.eol();){let o=zS(a.token,s,this.state);if(o&&(i=this.emitToken(this.lang.tokenTable.resolve(o),this.parsedPos+s.start,this.parsedPos+s.pos,i)),s.start>1e4)break}this.parsedPos=n,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=Ue.Tree.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:p4,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new Ue.Tree(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new Ue.Tree(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}};function zS(r,e,t){e.start=e.pos;for(let n=0;n<10;n++){let i=r(e,t);if(e.pos>e.start)return i}throw new Error("Stream parser failed to advance stream.")}var $g=Object.create(null),dl=[Ue.NodeType.none],p4=new Ue.NodeSet(dl),vS=[],mS=Object.create(null),VS=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])VS[r]=HS($g,e);var nf=class{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),VS)}resolve(e){return e?this.table[e]||(this.table[e]=HS(this.extra,e)):0}},g4=new nf($g);function Mg(r,e){vS.indexOf(r)>-1||(vS.push(r),console.warn(e))}function HS(r,e){let t=[];for(let o of e.split(" ")){let l=[];for(let u of o.split(".")){let h=r[u]||Ve.tags[u];h?typeof h=="function"?l.length?l=l.map(h):Mg(u,`Modifier ${u} used at start of tag`):l.length?Mg(u,`Tag ${u} used as modifier`):l=Array.isArray(h)?h:[h]:Mg(u,`Unknown highlighting tag ${u}`)}for(let u of l)t.push(u)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+t.map(o=>o.id),a=mS[i];if(a)return a.id;let s=mS[i]=Ue.NodeType.define({id:dl.length,name:n,props:[Ve.styleTags({[n]:t})]});return dl.push(s),s.id}function v4(r,e){let t=Ue.NodeType.define({id:dl.length,name:"Document",props:[Pi.add(()=>r),Gg.add(()=>n=>e.getIndent(n))],top:!0});return dl.push(t),t}function WS(r){return r.length<=4096&&/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/.test(r)}function GS(r){for(let e=r.iter();!e.next().done;)if(WS(e.value))return!0;return!1}function m4(r){let e=!1;return r.iterChanges((t,n,i,a,s)=>{!e&&GS(s)&&(e=!0)}),e}var _g=Qe.Facet.define({combine:r=>r.some(e=>e)});function y4(r={}){let e=[b4];return r.alwaysIsolate&&e.push(_g.of(!0)),e}var b4=qe.ViewPlugin.fromClass(class{constructor(r){this.always=r.state.facet(_g)||r.textDirection!=qe.Direction.LTR||r.state.facet(qe.EditorView.perLineTextDirection),this.hasRTL=!this.always&&GS(r.state.doc),this.tree=Pr(r.state),this.decorations=this.always||this.hasRTL?yS(r,this.tree,this.always):qe.Decoration.none}update(r){let e=r.state.facet(_g)||r.view.textDirection!=qe.Direction.LTR||r.state.facet(qe.EditorView.perLineTextDirection);if(!e&&!this.hasRTL&&m4(r.changes)&&(this.hasRTL=!0),!e&&!this.hasRTL)return;let t=Pr(r.state);(e!=this.always||t!=this.tree||r.docChanged||r.viewportChanged)&&(this.tree=t,this.always=e,this.decorations=yS(r.view,t,e))}},{provide:r=>{function e(t){var n,i;return(i=(n=t.plugin(r))===null||n===void 0?void 0:n.decorations)!==null&&i!==void 0?i:qe.Decoration.none}return[qe.EditorView.outerDecorations.of(e),Qe.Prec.lowest(qe.EditorView.bidiIsolatedRanges.of(e))]}});function yS(r,e,t){let n=new Qe.RangeSetBuilder,i=r.visibleRanges;t||(i=w4(i,r.state.doc));for(let{from:a,to:s}of i)e.iterate({enter:o=>{let l=o.type.prop(Ue.NodeProp.isolate);l&&n.add(o.from,o.to,x4[l])},from:a,to:s});return n.finish()}function w4(r,e){let t=e.iter(),n=0,i=[],a=null;for(let{from:s,to:o}of r)if(!(a&&a.to>s&&(s=a.to,s>=o)))for(n+t.value.length<s&&(t.next(s-(n+t.value.length)),n=s);;){let l=n,u=n+t.value.length;if(!t.lineBreak&&WS(t.value)&&(a&&a.to>l-10?a.to=Math.min(o,u):i.push(a={from:l,to:Math.min(o,u)})),u>=o)break;n=u,t.next()}return i}var x4={rtl:qe.Decoration.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"rtl"},bidiIsolate:qe.Direction.RTL}),ltr:qe.Decoration.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"ltr"},bidiIsolate:qe.Direction.LTR}),auto:qe.Decoration.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"auto"},bidiIsolate:null})};we.DocInput=ef;we.HighlightStyle=fl;we.IndentContext=Ss;we.LRLanguage=Dg;we.Language=tr;we.LanguageDescription=Bg;we.LanguageSupport=Pg;we.ParseContext=xs;we.StreamLanguage=qg;we.StringStream=cl;we.TreeIndentContext=tf;we.bidiIsolates=y4;we.bracketMatching=l4;we.bracketMatchingHandle=FS;we.codeFolding=Yg;we.continuedIndent=q3;we.defaultHighlightStyle=t4;we.defineLanguageFacet=zg;we.delimitedIndent=I3;we.ensureSyntaxTree=wS;we.flatIndent=N3;we.foldAll=BS;we.foldCode=DS;we.foldEffect=ks;we.foldGutter=$3;we.foldInside=z3;we.foldKeymap=j3;we.foldNodeProp=AS;we.foldService=TS;we.foldState=Jn;we.foldable=Cs;we.foldedRanges=W3;we.forceParsing=T3;we.getIndentUnit=ul;we.getIndentation=Wg;we.highlightingFor=J3;we.indentNodeProp=Gg;we.indentOnInput=_3;we.indentRange=M3;we.indentService=CS;we.indentString=Hg;we.indentUnit=Vg;we.language=Qn;we.languageDataProp=Pi;we.matchBrackets=sl;we.sublanguageProp=bS;we.syntaxHighlighting=Q3;we.syntaxParserRunning=A3;we.syntaxTree=Pr;we.syntaxTreeAvailable=E3;we.toggleFold=K3;we.unfoldAll=OS;we.unfoldCode=PS;we.unfoldEffect=xa});var sk=B(ne=>{"use strict";var pe=bi(),Ca=Ti(),Mt=af(),Qg=Yh(),KS=r=>{let{state:e}=r,t=e.doc.lineAt(e.selection.main.from),n=lv(r.state,t.from);return n.line?jS(r):n.block?XS(r):!1};function ka(r,e){return({state:t,dispatch:n})=>{if(t.readOnly)return!1;let i=r(e,t);return i?(n(t.update(i)),!0):!1}}var jS=ka(uv,0),S4=ka(uv,1),C4=ka(uv,2),YS=ka(ff,0),k4=ka(ff,1),E4=ka(ff,2),XS=ka((r,e)=>ff(r,e,A4(e)),0);function lv(r,e){let t=r.languageDataAt("commentTokens",e,1);return t.length?t[0]:{}}var pl=50;function T4(r,{open:e,close:t},n,i){let a=r.sliceDoc(n-pl,n),s=r.sliceDoc(i,i+pl),o=/\s*$/.exec(a)[0].length,l=/^\s*/.exec(s)[0].length,u=a.length-o;if(a.slice(u-e.length,u)==e&&s.slice(l,l+t.length)==t)return{open:{pos:n-o,margin:o&&1},close:{pos:i+l,margin:l&&1}};let h,f;i-n<=2*pl?h=f=r.sliceDoc(n,i):(h=r.sliceDoc(n,n+pl),f=r.sliceDoc(i-pl,i));let c=/^\s*/.exec(h)[0].length,d=/\s*$/.exec(f)[0].length,p=f.length-d-t.length;return h.slice(c,c+e.length)==e&&f.slice(p,p+t.length)==t?{open:{pos:n+c+e.length,margin:/\s/.test(h.charAt(c+e.length))?1:0},close:{pos:i-d-t.length,margin:/\s/.test(f.charAt(p-1))?1:0}}:null}function A4(r){let e=[];for(let t of r.selection.ranges){let n=r.doc.lineAt(t.from),i=t.to<=n.to?n:r.doc.lineAt(t.to);i.from>n.from&&i.from==t.to&&(i=t.to==n.to+1?n:r.doc.lineAt(t.to-1));let a=e.length-1;a>=0&&e[a].to>n.from?e[a].to=i.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:i.to})}return e}function ff(r,e,t=e.selection.ranges){let n=t.map(a=>lv(e,a.from).block);if(!n.every(a=>a))return null;let i=t.map((a,s)=>T4(e,n[s],a.from,a.to));if(r!=2&&!i.every(a=>a))return{changes:e.changes(t.map((a,s)=>i[s]?[]:[{from:a.from,insert:n[s].open+" "},{from:a.to,insert:" "+n[s].close}]))};if(r!=1&&i.some(a=>a)){let a=[];for(let s=0,o;s<i.length;s++)if(o=i[s]){let l=n[s],{open:u,close:h}=o;a.push({from:u.pos-l.open.length,to:u.pos+u.margin},{from:h.pos-h.margin,to:h.pos+l.close.length})}return{changes:a}}return null}function uv(r,e,t=e.selection.ranges){let n=[],i=-1;for(let{from:a,to:s}of t){let o=n.length,l=1e9,u=lv(e,a).line;if(u){for(let h=a;h<=s;){let f=e.doc.lineAt(h);if(f.from>i&&(a==s||s>f.from)){i=f.from;let c=/^\s*/.exec(f.text)[0].length,d=c==f.length,p=f.text.slice(c,c+u.length)==u?c:-1;c<f.text.length&&c<l&&(l=c),n.push({line:f,comment:p,token:u,indent:c,empty:d,single:!1})}h=f.to+1}if(l<1e9)for(let h=o;h<n.length;h++)n[h].indent<n[h].line.text.length&&(n[h].indent=l);n.length==o+1&&(n[o].single=!0)}}if(r!=2&&n.some(a=>a.comment<0&&(!a.empty||a.single))){let a=[];for(let{line:o,token:l,indent:u,empty:h,single:f}of n)(f||!h)&&a.push({from:o.from+u,insert:l+" "});let s=e.changes(a);return{changes:s,selection:e.selection.map(s,1)}}else if(r!=1&&n.some(a=>a.comment>=0)){let a=[];for(let{line:s,comment:o,token:l}of n)if(o>=0){let u=s.from+o,h=u+l.length;s.text[h-s.from]==" "&&h++,a.push({from:u,to:h})}return{changes:a}}return null}var Jg=pe.Annotation.define(),$S=pe.Annotation.define(),ZS=pe.Facet.define(),QS=pe.Facet.define({combine(r){return pe.combineConfig(r,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(n,i)=>e(n,i)||t(n,i)})}}),cf=pe.StateField.define({create(){return Sa.empty},update(r,e){let t=e.state.facet(QS),n=e.annotation(Jg);if(n){let l=mn.fromTransaction(e,n.selection),u=n.side,h=u==0?r.undone:r.done;return l?h=lf(h,h.length,t.minDepth,l):h=nC(h,e.startState.selection),new Sa(u==0?n.rest:h,u==0?h:n.rest)}let i=e.annotation($S);if((i=="full"||i=="before")&&(r=r.isolate()),e.annotation(pe.Transaction.addToHistory)===!1)return e.changes.empty?r:r.addMapping(e.changes.desc);let a=mn.fromTransaction(e),s=e.annotation(pe.Transaction.time),o=e.annotation(pe.Transaction.userEvent);return a?r=r.addChanges(a,s,o,t,e):e.selection&&(r=r.addSelection(e.startState.selection,s,o,t.newGroupDelay)),(i=="full"||i=="after")&&(r=r.isolate()),r},toJSON(r){return{done:r.done.map(e=>e.toJSON()),undone:r.undone.map(e=>e.toJSON())}},fromJSON(r){return new Sa(r.done.map(mn.fromJSON),r.undone.map(mn.fromJSON))}});function M4(r={}){return[cf,QS.of(r),Ca.EditorView.domEventHandlers({beforeinput(e,t){let n=e.inputType=="historyUndo"?hv:e.inputType=="historyRedo"?of:null;return n?(e.preventDefault(),n(t)):!1}})]}var D4=cf;function df(r,e){return function({state:t,dispatch:n}){if(!e&&t.readOnly)return!1;let i=t.field(cf,!1);if(!i)return!1;let a=i.pop(r,t,e);return a?(n(a),!0):!1}}var hv=df(0,!1),of=df(1,!1),JS=df(0,!0),eC=df(1,!0);function tC(r){return function(e){let t=e.field(cf,!1);if(!t)return 0;let n=r==0?t.done:t.undone;return n.length-(n.length&&!n[0].changes?1:0)}}var P4=tC(0),B4=tC(1),mn=class r{constructor(e,t,n,i,a){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=i,this.selectionsAfter=a}setSelAfter(e){return new r(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(i=>i.toJSON())}}static fromJSON(e){return new r(e.changes&&pe.ChangeSet.fromJSON(e.changes),[],e.mapped&&pe.ChangeDesc.fromJSON(e.mapped),e.startSelection&&pe.EditorSelection.fromJSON(e.startSelection),e.selectionsAfter.map(pe.EditorSelection.fromJSON))}static fromTransaction(e,t){let n=Jr;for(let i of e.startState.facet(ZS)){let a=i(e);a.length&&(n=n.concat(a))}return!n.length&&e.changes.empty?null:new r(e.changes.invert(e.startState.doc),n,void 0,t||e.startState.selection,Jr)}static selection(e){return new r(void 0,Jr,void 0,void 0,e)}};function lf(r,e,t,n){let i=e+1>t+20?e-t-1:0,a=r.slice(i,e);return a.push(n),a}function O4(r,e){let t=[],n=!1;return r.iterChangedRanges((i,a)=>t.push(i,a)),e.iterChangedRanges((i,a,s,o)=>{for(let l=0;l<t.length;){let u=t[l++],h=t[l++];o>=u&&s<=h&&(n=!0)}}),n}function R4(r,e){return r.ranges.length==e.ranges.length&&r.ranges.filter((t,n)=>t.empty!=e.ranges[n].empty).length===0}function rC(r,e){return r.length?e.length?r.concat(e):r:e}var Jr=[],L4=200;function nC(r,e){if(r.length){let t=r[r.length-1],n=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-L4));return n.length&&n[n.length-1].eq(e)?r:(n.push(e),lf(r,r.length-1,1e9,t.setSelAfter(n)))}else return[mn.selection([e])]}function I4(r){let e=r[r.length-1],t=r.slice();return t[r.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function Zg(r,e){if(!r.length)return r;let t=r.length,n=Jr;for(;t;){let i=N4(r[t-1],e,n);if(i.changes&&!i.changes.empty||i.effects.length){let a=r.slice(0,t);return a[t-1]=i,a}else e=i.mapped,t--,n=i.selectionsAfter}return n.length?[mn.selection(n)]:Jr}function N4(r,e,t){let n=rC(r.selectionsAfter.length?r.selectionsAfter.map(o=>o.map(e)):Jr,t);if(!r.changes)return mn.selection(n);let i=r.changes.map(e),a=e.mapDesc(r.changes,!0),s=r.mapped?r.mapped.composeDesc(a):a;return new mn(i,pe.StateEffect.mapEffects(r.effects,e),s,r.startSelection.map(a),n)}var q4=/^(input\.type|delete)($|\.)/,Sa=class r{constructor(e,t,n=0,i=void 0){this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=i}isolate(){return this.prevTime?new r(this.done,this.undone):this}addChanges(e,t,n,i,a){let s=this.done,o=s[s.length-1];return o&&o.changes&&!o.changes.empty&&e.changes&&(!n||q4.test(n))&&(!o.selectionsAfter.length&&t-this.prevTime<i.newGroupDelay&&i.joinToEvent(a,O4(o.changes,e.changes))||n=="input.type.compose")?s=lf(s,s.length-1,i.minDepth,new mn(e.changes.compose(o.changes),rC(pe.StateEffect.mapEffects(e.effects,o.changes),o.effects),o.mapped,o.startSelection,Jr)):s=lf(s,s.length,i.minDepth,e),new r(s,Jr,t,n)}addSelection(e,t,n,i){let a=this.done.length?this.done[this.done.length-1].selectionsAfter:Jr;return a.length>0&&t-this.prevTime<i&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&R4(a[a.length-1],e)?this:new r(nC(this.done,e),this.undone,t,n)}addMapping(e){return new r(Zg(this.done,e),Zg(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,n){let i=e==0?this.done:this.undone;if(i.length==0)return null;let a=i[i.length-1],s=a.selectionsAfter[0]||t.selection;if(n&&a.selectionsAfter.length)return t.update({selection:a.selectionsAfter[a.selectionsAfter.length-1],annotations:Jg.of({side:e,rest:I4(i),selection:s}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(a.changes){let o=i.length==1?Jr:i.slice(0,i.length-1);return a.mapped&&(o=Zg(o,a.mapped)),t.update({changes:a.changes,selection:a.startSelection,effects:a.effects,annotations:Jg.of({side:e,rest:o,selection:s}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}};Sa.empty=new Sa(Jr,Jr);var F4=[{key:"Mod-z",run:hv,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:of,preventDefault:!0},{linux:"Ctrl-Shift-z",run:of,preventDefault:!0},{key:"Mod-u",run:JS,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:eC,preventDefault:!0}];function Es(r,e){return pe.EditorSelection.create(r.ranges.map(e),r.mainIndex)}function Bn(r,e){return r.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Br({state:r,dispatch:e},t){let n=Es(r.selection,t);return n.eq(r.selection,!0)?!1:(e(Bn(r,n)),!0)}function Ea(r,e){return pe.EditorSelection.cursor(e?r.to:r.from)}function pf(r,e){return Br(r,t=>t.empty?r.moveByChar(t,e):Ea(t,e))}function hr(r){return r.textDirectionAt(r.state.selection.main.head)==Ca.Direction.LTR}var fv=r=>pf(r,!hr(r)),cv=r=>pf(r,hr(r)),_4=r=>pf(r,!0),z4=r=>pf(r,!1);function dv(r,e,t){let n=e.head,i=r.doc.lineAt(n);return n==(t?i.to:i.from)?n=t?Math.min(r.doc.length,i.to+1):Math.max(0,i.from-1):n=i.from+pe.findClusterBreak(i.text,n-i.from,t),pe.EditorSelection.cursor(n,t?-1:1)}function iC(r,e){return Br(r,t=>t.empty?dv(r.state,t,e):Ea(t,e))}var V4=r=>iC(r,!0),H4=r=>iC(r,!1);function gf(r,e){return Br(r,t=>t.empty?r.moveByGroup(t,e):Ea(t,e))}var aC=r=>gf(r,!hr(r)),sC=r=>gf(r,hr(r)),W4=r=>gf(r,!0),G4=r=>gf(r,!1);function oC(r,e,t){let n=r.state.charCategorizer(e),i=n(t),a=i!=pe.CharCategory.Space;return s=>{let o=n(s);return o!=pe.CharCategory.Space?a&&o==i:(a=!1,!0)}}var U4=r=>Br(r,e=>e.empty?r.moveByChar(e,!0,t=>oC(r,e.head,t)):Ea(e,!0)),US=typeof Intl<"u"&&Intl.Segmenter?new Intl.Segmenter(void 0,{granularity:"word"}):null;function lC(r,e,t){let n=r.state.charCategorizer(e.from),i=pe.CharCategory.Space,a=e.from,s=0,o=!1,l=!1,u=!1,h=c=>{if(o)return!1;a+=t?c.length:-c.length;let d=n(c),p;if(d==pe.CharCategory.Word&&c.charCodeAt(0)<128&&/[\W_]/.test(c)&&(d=-1),i==pe.CharCategory.Space&&(i=d),i!=d)return!1;if(i==pe.CharCategory.Word)if(c.toLowerCase()==c){if(!t&&l)return!1;u=!0}else if(u){if(t)return!1;o=!0}else{if(l&&t&&n(p=r.state.sliceDoc(a,a+1))==pe.CharCategory.Word&&p.toLowerCase()==p)return!1;l=!0}return s++,!0},f=r.moveByChar(e,t,c=>(h(c),h));if(US&&i==pe.CharCategory.Word&&f.from==e.from+s*(t?1:-1)){let c=Math.min(e.head,f.head),d=Math.max(e.head,f.head),p=r.state.sliceDoc(c,d);if(p.length>1&&/[\u4E00-\uffff]/.test(p)){let g=Array.from(US.segment(p));if(g.length>1)return t?pe.EditorSelection.cursor(e.head+g[1].index,-1):pe.EditorSelection.cursor(f.head+g[g.length-1].index,1)}}return f}function uC(r,e){return Br(r,t=>t.empty?lC(r,t,e):Ea(t,e))}var K4=r=>uC(r,!0),j4=r=>uC(r,!1);function Y4(r,e,t){if(e.type.prop(t))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(r.sliceDoc(e.from,e.to)))||e.firstChild}function vf(r,e,t){let n=Mt.syntaxTree(r).resolveInner(e.head),i=t?Qg.NodeProp.closedBy:Qg.NodeProp.openedBy;for(let l=e.head;;){let u=t?n.childAfter(l):n.childBefore(l);if(!u)break;Y4(r,u,i)?n=u:l=t?u.to:u.from}let a=n.type.prop(i),s,o;return a&&(s=t?Mt.matchBrackets(r,n.from,1):Mt.matchBrackets(r,n.to,-1))&&s.matched?o=t?s.end.to:s.end.from:o=t?n.to:n.from,pe.EditorSelection.cursor(o,t?-1:1)}var hC=r=>Br(r,e=>vf(r.state,e,!hr(r))),fC=r=>Br(r,e=>vf(r.state,e,hr(r)));function cC(r,e){return Br(r,t=>{if(!t.empty)return Ea(t,e);let n=r.moveVertically(t,e);return n.head!=t.head?n:r.moveToLineBoundary(t,e)})}var pv=r=>cC(r,!1),gv=r=>cC(r,!0);function dC(r){let e=r.scrollDOM.clientHeight<r.scrollDOM.scrollHeight-2,t=0,n=0,i;if(e){for(let a of r.state.facet(Ca.EditorView.scrollMargins)){let s=a(r);s?.top&&(t=Math.max(s?.top,t)),s?.bottom&&(n=Math.max(s?.bottom,n))}i=r.scrollDOM.clientHeight-t-n}else i=(r.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:n,selfScroll:e,height:Math.max(r.defaultLineHeight,i-5)}}function pC(r,e){let t=dC(r),{state:n}=r,i=Es(n.selection,s=>s.empty?r.moveVertically(s,e,t.height):Ea(s,e));if(i.eq(n.selection))return!1;let a;if(t.selfScroll){let s=r.coordsAtPos(n.selection.main.head),o=r.scrollDOM.getBoundingClientRect(),l=o.top+t.marginTop,u=o.bottom-t.marginBottom;s&&s.top>l&&s.bottom<u&&(a=Ca.EditorView.scrollIntoView(i.main.head,{y:"start",yMargin:s.top-l}))}return r.dispatch(Bn(n,i),{effects:a}),!0}var ev=r=>pC(r,!1),uf=r=>pC(r,!0);function Bi(r,e,t){let n=r.lineBlockAt(e.head),i=r.moveToLineBoundary(e,t);if(i.head==e.head&&i.head!=(t?n.to:n.from)&&(i=r.moveToLineBoundary(e,t,!1)),!t&&i.head==n.from&&n.length){let a=/^\s*/.exec(r.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;a&&e.head!=n.from+a&&(i=pe.EditorSelection.cursor(n.from+a))}return i}var gC=r=>Br(r,e=>Bi(r,e,!0)),vC=r=>Br(r,e=>Bi(r,e,!1)),mC=r=>Br(r,e=>Bi(r,e,!hr(r))),yC=r=>Br(r,e=>Bi(r,e,hr(r))),bC=r=>Br(r,e=>pe.EditorSelection.cursor(r.lineBlockAt(e.head).from,1)),wC=r=>Br(r,e=>pe.EditorSelection.cursor(r.lineBlockAt(e.head).to,-1));function xC(r,e,t){let n=!1,i=Es(r.selection,a=>{let s=Mt.matchBrackets(r,a.head,-1)||Mt.matchBrackets(r,a.head,1)||a.head>0&&Mt.matchBrackets(r,a.head-1,1)||a.head<r.doc.length&&Mt.matchBrackets(r,a.head+1,-1);if(!s||!s.end)return a;n=!0;let o=s.start.from==a.head?s.end.to:s.end.from;return t?pe.EditorSelection.range(a.anchor,o):pe.EditorSelection.cursor(o)});return n?(e(Bn(r,i)),!0):!1}var SC=({state:r,dispatch:e})=>xC(r,e,!1),X4=({state:r,dispatch:e})=>xC(r,e,!0);function fr(r,e){let t=Es(r.state.selection,n=>{let i=e(n);return pe.EditorSelection.range(n.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)});return t.eq(r.state.selection)?!1:(r.dispatch(Bn(r.state,t)),!0)}function mf(r,e){return fr(r,t=>r.moveByChar(t,e))}var vv=r=>mf(r,!hr(r)),mv=r=>mf(r,hr(r)),$4=r=>mf(r,!0),Z4=r=>mf(r,!1),Q4=r=>fr(r,e=>dv(r.state,e,!0)),J4=r=>fr(r,e=>dv(r.state,e,!1));function yf(r,e){return fr(r,t=>r.moveByGroup(t,e))}var CC=r=>yf(r,!hr(r)),kC=r=>yf(r,hr(r)),eH=r=>yf(r,!0),tH=r=>yf(r,!1),rH=r=>fr(r,e=>r.moveByChar(e,!0,t=>oC(r,e.head,t)));function EC(r,e){return fr(r,t=>lC(r,t,e))}var nH=r=>EC(r,!0),iH=r=>EC(r,!1),TC=r=>fr(r,e=>vf(r.state,e,!hr(r))),AC=r=>fr(r,e=>vf(r.state,e,hr(r)));function MC(r,e){return fr(r,t=>r.moveVertically(t,e))}var yv=r=>MC(r,!1),bv=r=>MC(r,!0);function DC(r,e){return fr(r,t=>r.moveVertically(t,e,dC(r).height))}var tv=r=>DC(r,!1),rv=r=>DC(r,!0),PC=r=>fr(r,e=>Bi(r,e,!0)),BC=r=>fr(r,e=>Bi(r,e,!1)),OC=r=>fr(r,e=>Bi(r,e,!hr(r))),RC=r=>fr(r,e=>Bi(r,e,hr(r))),LC=r=>fr(r,e=>pe.EditorSelection.cursor(r.lineBlockAt(e.head).from)),IC=r=>fr(r,e=>pe.EditorSelection.cursor(r.lineBlockAt(e.head).to)),nv=({state:r,dispatch:e})=>(e(Bn(r,{anchor:0})),!0),iv=({state:r,dispatch:e})=>(e(Bn(r,{anchor:r.doc.length})),!0),av=({state:r,dispatch:e})=>(e(Bn(r,{anchor:r.selection.main.anchor,head:0})),!0),sv=({state:r,dispatch:e})=>(e(Bn(r,{anchor:r.selection.main.anchor,head:r.doc.length})),!0),NC=({state:r,dispatch:e})=>(e(r.update({selection:{anchor:0,head:r.doc.length},userEvent:"select"})),!0),qC=({state:r,dispatch:e})=>{let t=bf(r).map(({from:n,to:i})=>pe.EditorSelection.range(n,Math.min(i+1,r.doc.length)));return e(r.update({selection:pe.EditorSelection.create(t),userEvent:"select"})),!0},FC=({state:r,dispatch:e})=>{let t=Es(r.selection,n=>{let i=Mt.syntaxTree(r),a=i.resolveStack(n.from,1);if(n.empty){let s=i.resolveStack(n.from,-1);s.node.from>=a.node.from&&s.node.to<=a.node.to&&(a=s)}for(let s=a;s;s=s.next){let{node:o}=s;if((o.from<n.from&&o.to>=n.to||o.to>n.to&&o.from<=n.from)&&s.next)return pe.EditorSelection.range(o.to,o.from)}return n});return t.eq(r.selection)?!1:(e(Bn(r,t)),!0)},_C=({state:r,dispatch:e})=>{let t=r.selection,n=null;return t.ranges.length>1?n=pe.EditorSelection.create([t.main]):t.main.empty||(n=pe.EditorSelection.create([pe.EditorSelection.cursor(t.main.head)])),n?(e(Bn(r,n)),!0):!1};function Ts(r,e){if(r.state.readOnly)return!1;let t="delete.selection",{state:n}=r,i=n.changeByRange(a=>{let{from:s,to:o}=a;if(s==o){let l=e(a);l<s?(t="delete.backward",l=sf(r,l,!1)):l>s&&(t="delete.forward",l=sf(r,l,!0)),s=Math.min(s,l),o=Math.max(o,l)}else s=sf(r,s,!1),o=sf(r,o,!0);return s==o?{range:a}:{changes:{from:s,to:o},range:pe.EditorSelection.cursor(s,s<a.head?-1:1)}});return i.changes.empty?!1:(r.dispatch(n.update(i,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?Ca.EditorView.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function sf(r,e,t){if(r instanceof Ca.EditorView)for(let n of r.state.facet(Ca.EditorView.atomicRanges).map(i=>i(r)))n.between(e,e,(i,a)=>{i<e&&a>e&&(e=t?a:i)});return e}var wv=(r,e,t)=>Ts(r,n=>{let i=n.from,{state:a}=r,s=a.doc.lineAt(i),o,l;if(t&&!e&&i>s.from&&i<s.from+200&&!/[^ \t]/.test(o=s.text.slice(0,i-s.from))){if(o[o.length-1]=="	")return i-1;let u=pe.countColumn(o,a.tabSize),h=u%Mt.getIndentUnit(a)||Mt.getIndentUnit(a);for(let f=0;f<h&&o[o.length-1-f]==" ";f++)i--;l=i}else l=pe.findClusterBreak(s.text,i-s.from,e,e)+s.from,l==i&&s.number!=(e?a.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(s.text.slice(l-s.from,i-s.from))&&(l=pe.findClusterBreak(s.text,l-s.from,!1,!1)+s.from);return l}),hf=r=>wv(r,!1,!0),aH=r=>wv(r,!1,!1),xv=r=>wv(r,!0,!1),zC=(r,e)=>Ts(r,t=>{let n=t.head,{state:i}=r,a=i.doc.lineAt(n),s=i.charCategorizer(n);for(let o=null;;){if(n==(e?a.to:a.from)){n==t.head&&a.number!=(e?i.doc.lines:1)&&(n+=e?1:-1);break}let l=pe.findClusterBreak(a.text,n-a.from,e)+a.from,u=a.text.slice(Math.min(n,l)-a.from,Math.max(n,l)-a.from),h=s(u);if(o!=null&&h!=o)break;(u!=" "||n!=t.head)&&(o=h),n=l}return n}),Sv=r=>zC(r,!1),VC=r=>zC(r,!0),HC=r=>Ts(r,e=>{let t=r.lineBlockAt(e.head).to;return e.head<t?t:Math.min(r.state.doc.length,e.head+1)}),sH=r=>Ts(r,e=>{let t=r.lineBlockAt(e.head).from;return e.head>t?t:Math.max(0,e.head-1)}),WC=r=>Ts(r,e=>{let t=r.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),GC=r=>Ts(r,e=>{let t=r.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(r.state.doc.length,e.head+1)}),oH=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=[];for(let n=0,i="",a=r.doc.iter();;){if(a.next(),a.lineBreak||a.done){let s=i.search(/\s+$/);if(s>-1&&t.push({from:n-(i.length-s),to:n}),a.done)break;i=""}else i=a.value;n+=a.value.length}return t.length?(e(r.update({changes:t,userEvent:"delete"})),!0):!1},UC=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=r.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:pe.Text.of(["",""])},range:pe.EditorSelection.cursor(n.from)}));return e(r.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},KC=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=r.changeByRange(n=>{if(!n.empty||n.from==0||n.from==r.doc.length)return{range:n};let i=n.from,a=r.doc.lineAt(i),s=i==a.from?i-1:pe.findClusterBreak(a.text,i-a.from,!1)+a.from,o=i==a.to?i+1:pe.findClusterBreak(a.text,i-a.from,!0)+a.from;return{changes:{from:s,to:o,insert:r.doc.slice(i,o).append(r.doc.slice(s,i))},range:pe.EditorSelection.cursor(o)}});return t.changes.empty?!1:(e(r.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function bf(r){let e=[],t=-1;for(let n of r.selection.ranges){let i=r.doc.lineAt(n.from),a=r.doc.lineAt(n.to);if(!n.empty&&n.to==a.from&&(a=r.doc.lineAt(n.to-1)),t>=i.number){let s=e[e.length-1];s.to=a.to,s.ranges.push(n)}else e.push({from:i.from,to:a.to,ranges:[n]});t=a.number+1}return e}function jC(r,e,t){if(r.readOnly)return!1;let n=[],i=[];for(let a of bf(r)){if(t?a.to==r.doc.length:a.from==0)continue;let s=r.doc.lineAt(t?a.to+1:a.from-1),o=s.length+1;if(t){n.push({from:a.to,to:s.to},{from:a.from,insert:s.text+r.lineBreak});for(let l of a.ranges)i.push(pe.EditorSelection.range(Math.min(r.doc.length,l.anchor+o),Math.min(r.doc.length,l.head+o)))}else{n.push({from:s.from,to:a.from},{from:a.to,insert:r.lineBreak+s.text});for(let l of a.ranges)i.push(pe.EditorSelection.range(l.anchor-o,l.head-o))}}return n.length?(e(r.update({changes:n,scrollIntoView:!0,selection:pe.EditorSelection.create(i,r.selection.mainIndex),userEvent:"move.line"})),!0):!1}var YC=({state:r,dispatch:e})=>jC(r,e,!1),XC=({state:r,dispatch:e})=>jC(r,e,!0);function $C(r,e,t){if(r.readOnly)return!1;let n=[];for(let i of bf(r))t?n.push({from:i.from,insert:r.doc.slice(i.from,i.to)+r.lineBreak}):n.push({from:i.to,insert:r.lineBreak+r.doc.slice(i.from,i.to)});return e(r.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}var ZC=({state:r,dispatch:e})=>$C(r,e,!1),QC=({state:r,dispatch:e})=>$C(r,e,!0),JC=r=>{if(r.state.readOnly)return!1;let{state:e}=r,t=e.changes(bf(e).map(({from:i,to:a})=>(i>0?i--:a<e.doc.length&&a++,{from:i,to:a}))),n=Es(e.selection,i=>{let a;if(r.lineWrapping){let s=r.lineBlockAt(i.head),o=r.coordsAtPos(i.head,i.assoc||1);o&&(a=s.bottom+r.documentTop-o.bottom+r.defaultLineHeight/2)}return r.moveVertically(i,!0,a)}).map(t);return r.dispatch({changes:t,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0},lH=({state:r,dispatch:e})=>(e(r.update(r.replaceSelection(r.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0),uH=({state:r,dispatch:e})=>(e(r.update(r.changeByRange(t=>{let n=/^\s*/.exec(r.doc.lineAt(t.from).text)[0];return{changes:{from:t.from,to:t.to,insert:r.lineBreak+n},range:pe.EditorSelection.cursor(t.from+n.length+1)}}),{scrollIntoView:!0,userEvent:"input"})),!0);function hH(r,e){if(/\(\)|\[\]|\{\}/.test(r.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=Mt.syntaxTree(r).resolveInner(e),n=t.childBefore(e),i=t.childAfter(e),a;return n&&i&&n.to<=e&&i.from>=e&&(a=n.type.prop(Qg.NodeProp.closedBy))&&a.indexOf(i.name)>-1&&r.doc.lineAt(n.to).from==r.doc.lineAt(i.from).from&&!/\S/.test(r.sliceDoc(n.to,i.from))?{from:n.to,to:i.from}:null}var ov=tk(!1),ek=tk(!0);function tk(r){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange(i=>{let{from:a,to:s}=i,o=e.doc.lineAt(a),l=!r&&a==s&&hH(e,a);r&&(a=s=(s<=o.to?o:e.doc.lineAt(s)).to);let u=new Mt.IndentContext(e,{simulateBreak:a,simulateDoubleBreak:!!l}),h=Mt.getIndentation(u,a);for(h==null&&(h=pe.countColumn(/^\s*/.exec(e.doc.lineAt(a).text)[0],e.tabSize));s<o.to&&/\s/.test(o.text[s-o.from]);)s++;l?{from:a,to:s}=l:a>o.from&&a<o.from+100&&!/\S/.test(o.text.slice(0,a))&&(a=o.from);let f=["",Mt.indentString(e,h)];return l&&f.push(Mt.indentString(e,u.lineIndent(o.from,-1))),{changes:{from:a,to:s,insert:pe.Text.of(f)},range:pe.EditorSelection.cursor(a+1+f[1].length)}});return t(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function Cv(r,e){let t=-1;return r.changeByRange(n=>{let i=[];for(let s=n.from;s<=n.to;){let o=r.doc.lineAt(s);o.number>t&&(n.empty||n.to>o.from)&&(e(o,i,n),t=o.number),s=o.to+1}let a=r.changes(i);return{changes:i,range:pe.EditorSelection.range(a.mapPos(n.anchor,1),a.mapPos(n.head,1))}})}var rk=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=Object.create(null),n=new Mt.IndentContext(r,{overrideIndentation:a=>{let s=t[a];return s??-1}}),i=Cv(r,(a,s,o)=>{let l=Mt.getIndentation(n,a.from);if(l==null)return;/\S/.test(a.text)||(l=0);let u=/^\s*/.exec(a.text)[0],h=Mt.indentString(r,l);(u!=h||o.from<a.from+u.length)&&(t[a.from]=l,s.push({from:a.from,to:a.from+u.length,insert:h}))});return i.changes.empty||e(r.update(i,{userEvent:"indent"})),!0},wf=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(Cv(r,(t,n)=>{n.push({from:t.from,insert:r.facet(Mt.indentUnit)})}),{userEvent:"input.indent"})),!0),kv=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(Cv(r,(t,n)=>{let i=/^\s*/.exec(t.text)[0];if(!i)return;let a=pe.countColumn(i,r.tabSize),s=0,o=Mt.indentString(r,Math.max(0,a-Mt.getIndentUnit(r)));for(;s<i.length&&s<o.length&&i.charCodeAt(s)==o.charCodeAt(s);)s++;n.push({from:t.from+s,to:t.from+i.length,insert:o.slice(s)})}),{userEvent:"delete.dedent"})),!0),nk=r=>(r.setTabFocusMode(),!0),fH=r=>(r.setTabFocusMode(2e3),!0),cH=({state:r,dispatch:e})=>r.selection.ranges.some(t=>!t.empty)?wf({state:r,dispatch:e}):(e(r.update(r.replaceSelection("	"),{scrollIntoView:!0,userEvent:"input"})),!0),ik=[{key:"Ctrl-b",run:fv,shift:vv,preventDefault:!0},{key:"Ctrl-f",run:cv,shift:mv},{key:"Ctrl-p",run:pv,shift:yv},{key:"Ctrl-n",run:gv,shift:bv},{key:"Ctrl-a",run:bC,shift:LC},{key:"Ctrl-e",run:wC,shift:IC},{key:"Ctrl-d",run:xv},{key:"Ctrl-h",run:hf},{key:"Ctrl-k",run:HC},{key:"Ctrl-Alt-h",run:Sv},{key:"Ctrl-o",run:UC},{key:"Ctrl-t",run:KC},{key:"Ctrl-v",run:uf}],ak=[{key:"ArrowLeft",run:fv,shift:vv,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:aC,shift:CC,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:mC,shift:OC,preventDefault:!0},{key:"ArrowRight",run:cv,shift:mv,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:sC,shift:kC,preventDefault:!0},{mac:"Cmd-ArrowRight",run:yC,shift:RC,preventDefault:!0},{key:"ArrowUp",run:pv,shift:yv,preventDefault:!0},{mac:"Cmd-ArrowUp",run:nv,shift:av},{mac:"Ctrl-ArrowUp",run:ev,shift:tv},{key:"ArrowDown",run:gv,shift:bv,preventDefault:!0},{mac:"Cmd-ArrowDown",run:iv,shift:sv},{mac:"Ctrl-ArrowDown",run:uf,shift:rv},{key:"PageUp",run:ev,shift:tv},{key:"PageDown",run:uf,shift:rv},{key:"Home",run:vC,shift:BC,preventDefault:!0},{key:"Mod-Home",run:nv,shift:av},{key:"End",run:gC,shift:PC,preventDefault:!0},{key:"Mod-End",run:iv,shift:sv},{key:"Enter",run:ov,shift:ov},{key:"Mod-a",run:NC},{key:"Backspace",run:hf,shift:hf},{key:"Delete",run:xv},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Sv},{key:"Mod-Delete",mac:"Alt-Delete",run:VC},{mac:"Mod-Backspace",run:WC},{mac:"Mod-Delete",run:GC}].concat(ik.map(r=>({mac:r.key,run:r.run,shift:r.shift}))),dH=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:hC,shift:TC},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:fC,shift:AC},{key:"Alt-ArrowUp",run:YC},{key:"Shift-Alt-ArrowUp",run:ZC},{key:"Alt-ArrowDown",run:XC},{key:"Shift-Alt-ArrowDown",run:QC},{key:"Escape",run:_C},{key:"Mod-Enter",run:ek},{key:"Alt-l",mac:"Ctrl-l",run:qC},{key:"Mod-i",run:FC,preventDefault:!0},{key:"Mod-[",run:kv},{key:"Mod-]",run:wf},{key:"Mod-Alt-\\",run:rk},{key:"Shift-Mod-k",run:JC},{key:"Shift-Mod-\\",run:SC},{key:"Mod-/",run:KS},{key:"Alt-A",run:YS},{key:"Ctrl-m",mac:"Shift-Alt-m",run:nk}].concat(ak),pH={key:"Tab",run:wf,shift:kv};ne.blockComment=k4;ne.blockUncomment=E4;ne.copyLineDown=QC;ne.copyLineUp=ZC;ne.cursorCharBackward=z4;ne.cursorCharBackwardLogical=H4;ne.cursorCharForward=_4;ne.cursorCharForwardLogical=V4;ne.cursorCharLeft=fv;ne.cursorCharRight=cv;ne.cursorDocEnd=iv;ne.cursorDocStart=nv;ne.cursorGroupBackward=G4;ne.cursorGroupForward=W4;ne.cursorGroupForwardWin=U4;ne.cursorGroupLeft=aC;ne.cursorGroupRight=sC;ne.cursorLineBoundaryBackward=vC;ne.cursorLineBoundaryForward=gC;ne.cursorLineBoundaryLeft=mC;ne.cursorLineBoundaryRight=yC;ne.cursorLineDown=gv;ne.cursorLineEnd=wC;ne.cursorLineStart=bC;ne.cursorLineUp=pv;ne.cursorMatchingBracket=SC;ne.cursorPageDown=uf;ne.cursorPageUp=ev;ne.cursorSubwordBackward=j4;ne.cursorSubwordForward=K4;ne.cursorSyntaxLeft=hC;ne.cursorSyntaxRight=fC;ne.defaultKeymap=dH;ne.deleteCharBackward=hf;ne.deleteCharBackwardStrict=aH;ne.deleteCharForward=xv;ne.deleteGroupBackward=Sv;ne.deleteGroupForward=VC;ne.deleteLine=JC;ne.deleteLineBoundaryBackward=WC;ne.deleteLineBoundaryForward=GC;ne.deleteToLineEnd=HC;ne.deleteToLineStart=sH;ne.deleteTrailingWhitespace=oH;ne.emacsStyleKeymap=ik;ne.history=M4;ne.historyField=D4;ne.historyKeymap=F4;ne.indentLess=kv;ne.indentMore=wf;ne.indentSelection=rk;ne.indentWithTab=pH;ne.insertBlankLine=ek;ne.insertNewline=lH;ne.insertNewlineAndIndent=ov;ne.insertNewlineKeepIndent=uH;ne.insertTab=cH;ne.invertedEffects=ZS;ne.isolateHistory=$S;ne.lineComment=S4;ne.lineUncomment=C4;ne.moveLineDown=XC;ne.moveLineUp=YC;ne.redo=of;ne.redoDepth=B4;ne.redoSelection=eC;ne.selectAll=NC;ne.selectCharBackward=Z4;ne.selectCharBackwardLogical=J4;ne.selectCharForward=$4;ne.selectCharForwardLogical=Q4;ne.selectCharLeft=vv;ne.selectCharRight=mv;ne.selectDocEnd=sv;ne.selectDocStart=av;ne.selectGroupBackward=tH;ne.selectGroupForward=eH;ne.selectGroupForwardWin=rH;ne.selectGroupLeft=CC;ne.selectGroupRight=kC;ne.selectLine=qC;ne.selectLineBoundaryBackward=BC;ne.selectLineBoundaryForward=PC;ne.selectLineBoundaryLeft=OC;ne.selectLineBoundaryRight=RC;ne.selectLineDown=bv;ne.selectLineEnd=IC;ne.selectLineStart=LC;ne.selectLineUp=yv;ne.selectMatchingBracket=X4;ne.selectPageDown=rv;ne.selectPageUp=tv;ne.selectParentSyntax=FC;ne.selectSubwordBackward=iH;ne.selectSubwordForward=nH;ne.selectSyntaxLeft=TC;ne.selectSyntaxRight=AC;ne.simplifySelection=_C;ne.splitLine=UC;ne.standardKeymap=ak;ne.temporarilySetTabFocusMode=fH;ne.toggleBlockComment=YS;ne.toggleBlockCommentByLine=XS;ne.toggleComment=KS;ne.toggleLineComment=jS;ne.toggleTabFocusMode=nk;ne.transposeChars=KC;ne.undo=hv;ne.undoDepth=P4;ne.undoSelection=JS});var Ev=B((Lce,lk)=>{"use strict";function gH(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=t[n];typeof i=="string"?r.setAttribute(n,i):i!=null&&(r[n]=i)}e++}for(;e<arguments.length;e++)ok(r,arguments[e]);return r}function ok(r,e){if(typeof e=="string")r.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)r.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)ok(r,e[t]);else throw new RangeError("Unsupported child node: "+e)}lk.exports=gH});var xk=B(It=>{"use strict";var et=Ti(),Ie=bi(),rr=Ev(),uk=typeof String.prototype.normalize=="function"?r=>r.normalize("NFKD"):r=>r,ei=class{constructor(e,t,n=0,i=e.length,a,s){this.test=s,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,i),this.bufferStart=n,this.normalize=a?o=>a(uk(o)):uk,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Ie.codePointAt(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=Ie.fromCodePoint(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=Ie.codePointSize(e);let i=this.normalize(t);if(i.length)for(let a=0,s=n;;a++){let o=i.charCodeAt(a),l=this.match(o,s,this.bufferPos+this.bufferStart);if(a==i.length-1){if(l)return this.value=l,this;break}s==n&&a<t.length&&t.charCodeAt(a)==o&&s++}}}match(e,t,n){let i=null;for(let a=0;a<this.matches.length;a+=2){let s=this.matches[a],o=!1;this.query.charCodeAt(s)==e&&(s==this.query.length-1?i={from:this.matches[a+1],to:n}:(this.matches[a]++,o=!0)),o||(this.matches.splice(a,2),a-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:t,to:n}:this.matches.push(1,t)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferStart)&&(i=null),i}};typeof Symbol<"u"&&(ei.prototype[Symbol.iterator]=function(){return this});var ck={from:-1,to:-1,match:/.*/.exec("")},Rv="gm"+(/x/.unicode==null?"":"u"),ml=class{constructor(e,t,n,i=0,a=e.length){if(this.text=e,this.to=a,this.curLine="",this.done=!1,this.value=ck,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new kf(e,t,n,i,a);this.re=new RegExp(t,Rv+(n?.ignoreCase?"i":"")),this.test=n?.test,this.iter=e.iter();let s=e.lineAt(i);this.curLineStart=s.from,this.matchPos=Ef(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,i=n+t[0].length;if(this.matchPos=Ef(this.text,i+(n==i?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<i||n>this.value.to)&&(!this.test||this.test(n,i,t)))return this.value={from:n,to:i,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}},Tv=new WeakMap,Cf=class r{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,n){let i=Tv.get(e);if(!i||i.from>=n||i.to<=t){let o=new r(t,e.sliceString(t,n));return Tv.set(e,o),o}if(i.from==t&&i.to==n)return i;let{text:a,from:s}=i;return s>t&&(a=e.sliceString(t,s)+a,s=t),i.to<n&&(a+=e.sliceString(i.to,n)),Tv.set(e,new r(s,a)),new r(t,a.slice(t-s,n-s))}},kf=class{constructor(e,t,n,i,a){this.text=e,this.to=a,this.done=!1,this.value=ck,this.matchPos=Ef(e,i),this.re=new RegExp(t,Rv+(n?.ignoreCase?"i":"")),this.test=n?.test,this.flat=Cf.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let n=this.flat.from+t.index,i=n+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,i,t)))return this.value={from:n,to:i,match:t},this.matchPos=Ef(this.text,i+(n==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Cf.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}};typeof Symbol<"u"&&(ml.prototype[Symbol.iterator]=kf.prototype[Symbol.iterator]=function(){return this});function vH(r){try{return new RegExp(r,Rv),!0}catch{return!1}}function Ef(r,e){if(e>=r.length)return e;let t=r.lineAt(e),n;for(;e<t.to&&(n=t.text.charCodeAt(e-t.from))>=56320&&n<57344;)e++;return e}function Av(r){let e=String(r.state.doc.lineAt(r.state.selection.main.head).number),t=rr("input",{class:"cm-textfield",name:"line",value:e}),n=rr("form",{class:"cm-gotoLine",onkeydown:a=>{a.keyCode==27?(a.preventDefault(),r.dispatch({effects:gl.of(!1)}),r.focus()):a.keyCode==13&&(a.preventDefault(),i())},onsubmit:a=>{a.preventDefault(),i()}},rr("label",r.state.phrase("Go to line"),": ",t)," ",rr("button",{class:"cm-button",type:"submit"},r.state.phrase("go")),rr("button",{name:"close",onclick:()=>{r.dispatch({effects:gl.of(!1)}),r.focus()},"aria-label":r.state.phrase("close"),type:"button"},["\xD7"]));function i(){let a=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!a)return;let{state:s}=r,o=s.doc.lineAt(s.selection.main.head),[,l,u,h,f]=a,c=h?+h.slice(1):0,d=u?+u:o.number;if(u&&f){let v=d/100;l&&(v=v*(l=="-"?-1:1)+o.number/s.doc.lines),d=Math.round(s.doc.lines*v)}else u&&l&&(d=d*(l=="-"?-1:1)+o.number);let p=s.doc.line(Math.max(1,Math.min(s.doc.lines,d))),g=Ie.EditorSelection.cursor(p.from+Math.max(0,Math.min(c,p.length)));r.dispatch({effects:[gl.of(!1),et.EditorView.scrollIntoView(g.from,{y:"center"})],selection:g}),r.focus()}return{dom:n}}var gl=Ie.StateEffect.define(),hk=Ie.StateField.define({create(){return!0},update(r,e){for(let t of e.effects)t.is(gl)&&(r=t.value);return r},provide:r=>et.showPanel.from(r,e=>e?Av:null)}),dk=r=>{let e=et.getPanel(r,Av);if(!e){let t=[gl.of(!0)];r.state.field(hk,!1)==null&&t.push(Ie.StateEffect.appendConfig.of([hk,mH])),r.dispatch({effects:t}),e=et.getPanel(r,Av)}return e&&e.dom.querySelector("input").select(),!0},mH=et.EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),yH={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},pk=Ie.Facet.define({combine(r){return Ie.combineConfig(r,yH,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function bH(r){let e=[kH,CH];return r&&e.push(pk.of(r)),e}var wH=et.Decoration.mark({class:"cm-selectionMatch"}),xH=et.Decoration.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function fk(r,e,t,n){return(t==0||r(e.sliceDoc(t-1,t))!=Ie.CharCategory.Word)&&(n==e.doc.length||r(e.sliceDoc(n,n+1))!=Ie.CharCategory.Word)}function SH(r,e,t,n){return r(e.sliceDoc(t,t+1))==Ie.CharCategory.Word&&r(e.sliceDoc(n-1,n))==Ie.CharCategory.Word}var CH=et.ViewPlugin.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.selectionSet||r.docChanged||r.viewportChanged)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=r.state.facet(pk),{state:t}=r,n=t.selection;if(n.ranges.length>1)return et.Decoration.none;let i=n.main,a,s=null;if(i.empty){if(!e.highlightWordAroundCursor)return et.Decoration.none;let l=t.wordAt(i.head);if(!l)return et.Decoration.none;s=t.charCategorizer(i.head),a=t.sliceDoc(l.from,l.to)}else{let l=i.to-i.from;if(l<e.minSelectionLength||l>200)return et.Decoration.none;if(e.wholeWords){if(a=t.sliceDoc(i.from,i.to),s=t.charCategorizer(i.head),!(fk(s,t,i.from,i.to)&&SH(s,t,i.from,i.to)))return et.Decoration.none}else if(a=t.sliceDoc(i.from,i.to),!a)return et.Decoration.none}let o=[];for(let l of r.visibleRanges){let u=new ei(t.doc,a,l.from,l.to);for(;!u.next().done;){let{from:h,to:f}=u.value;if((!s||fk(s,t,h,f))&&(i.empty&&h<=i.from&&f>=i.to?o.push(xH.range(h,f)):(h>=i.to||f<=i.from)&&o.push(wH.range(h,f)),o.length>e.maxMatches))return et.Decoration.none}}return et.Decoration.set(o)}},{decorations:r=>r.decorations}),kH=et.EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),EH=({state:r,dispatch:e})=>{let{selection:t}=r,n=Ie.EditorSelection.create(t.ranges.map(i=>r.wordAt(i.head)||Ie.EditorSelection.cursor(i.head)),t.mainIndex);return n.eq(t)?!1:(e(r.update({selection:n})),!0)};function TH(r,e){let{main:t,ranges:n}=r.selection,i=r.wordAt(t.head),a=i&&i.from==t.from&&i.to==t.to;for(let s=!1,o=new ei(r.doc,e,n[n.length-1].to);;)if(o.next(),o.done){if(s)return null;o=new ei(r.doc,e,0,Math.max(0,n[n.length-1].from-1)),s=!0}else{if(s&&n.some(l=>l.from==o.value.from))continue;if(a){let l=r.wordAt(o.value.from);if(!l||l.from!=o.value.from||l.to!=o.value.to)continue}return o.value}}var gk=({state:r,dispatch:e})=>{let{ranges:t}=r.selection;if(t.some(a=>a.from===a.to))return EH({state:r,dispatch:e});let n=r.sliceDoc(t[0].from,t[0].to);if(r.selection.ranges.some(a=>r.sliceDoc(a.from,a.to)!=n))return!1;let i=TH(r,n);return i?(e(r.update({selection:r.selection.addRange(Ie.EditorSelection.range(i.from,i.to),!1),effects:et.EditorView.scrollIntoView(i.to)})),!0):!1},Ta=Ie.Facet.define({combine(r){return Ie.combineConfig(r,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Bv(e),scrollToMatch:e=>et.EditorView.scrollIntoView(e)})}});function AH(r){return r?[Ta.of(r),Ov]:Ov}var yl=class{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||vH(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new Dv(this):new Mv(this)}getCursor(e,t=0,n){let i=e.doc?e:Ie.EditorState.create({doc:e});return n==null&&(n=i.doc.length),this.regexp?Ms(this,i,t,n):As(this,i,t,n)}},Tf=class{constructor(e){this.spec=e}};function As(r,e,t,n){return new ei(e.doc,r.unquoted,t,n,r.caseSensitive?void 0:i=>i.toLowerCase(),r.wholeWord?MH(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function MH(r,e){return(t,n,i,a)=>((a>t||a+i.length<n)&&(a=Math.max(0,t-2),i=r.sliceString(a,Math.min(r.length,n+2))),(e(Af(i,t-a))!=Ie.CharCategory.Word||e(Mf(i,t-a))!=Ie.CharCategory.Word)&&(e(Mf(i,n-a))!=Ie.CharCategory.Word||e(Af(i,n-a))!=Ie.CharCategory.Word))}var Mv=class extends Tf{constructor(e){super(e)}nextMatch(e,t,n){let i=As(this.spec,e,n,e.doc.length).nextOverlapping();if(i.done){let a=Math.min(e.doc.length,t+this.spec.unquoted.length);i=As(this.spec,e,0,a).nextOverlapping()}return i.done||i.value.from==t&&i.value.to==n?null:i.value}prevMatchInRange(e,t,n){for(let i=n;;){let a=Math.max(t,i-1e4-this.spec.unquoted.length),s=As(this.spec,e,a,i),o=null;for(;!s.nextOverlapping().done;)o=s.value;if(o)return o;if(a==t)return null;i-=1e4}}prevMatch(e,t,n){let i=this.prevMatchInRange(e,0,t);return i||(i=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),i&&(i.from!=t||i.to!=n)?i:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let n=As(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=t)return null;i.push(n.value)}return i}highlight(e,t,n,i){let a=As(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!a.next().done;)i(a.value.from,a.value.to)}};function Ms(r,e,t,n){return new ml(e.doc,r.search,{ignoreCase:!r.caseSensitive,test:r.wholeWord?DH(e.charCategorizer(e.selection.main.head)):void 0},t,n)}function Af(r,e){return r.slice(Ie.findClusterBreak(r,e,!1),e)}function Mf(r,e){return r.slice(e,Ie.findClusterBreak(r,e))}function DH(r){return(e,t,n)=>!n[0].length||(r(Af(n.input,n.index))!=Ie.CharCategory.Word||r(Mf(n.input,n.index))!=Ie.CharCategory.Word)&&(r(Mf(n.input,n.index+n[0].length))!=Ie.CharCategory.Word||r(Af(n.input,n.index+n[0].length))!=Ie.CharCategory.Word)}var Dv=class extends Tf{nextMatch(e,t,n){let i=Ms(this.spec,e,n,e.doc.length).next();return i.done&&(i=Ms(this.spec,e,0,t).next()),i.done?null:i.value}prevMatchInRange(e,t,n){for(let i=1;;i++){let a=Math.max(t,n-i*1e4),s=Ms(this.spec,e,a,n),o=null;for(;!s.next().done;)o=s.value;if(o&&(a==t||o.from>a+10))return o;if(a==t)return null}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,n)=>{if(n=="&")return e.match[0];if(n=="$")return"$";for(let i=n.length;i>0;i--){let a=+n.slice(0,i);if(a>0&&a<e.match.length)return e.match[a]+n.slice(i)}return t})}matchAll(e,t){let n=Ms(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=t)return null;i.push(n.value)}return i}highlight(e,t,n,i){let a=Ms(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.doc.length));for(;!a.next().done;)i(a.value.from,a.value.to)}},Ds=Ie.StateEffect.define(),Lv=Ie.StateEffect.define(),On=Ie.StateField.define({create(r){return new vl(Df(r).create(),null)},update(r,e){for(let t of e.effects)t.is(Ds)?r=new vl(t.value.create(),r.panel):t.is(Lv)&&(r=new vl(r.query,t.value?Iv:null));return r},provide:r=>et.showPanel.from(r,e=>e.panel)});function PH(r){let e=r.field(On,!1);return e?e.query.spec:Df(r)}function BH(r){var e;return((e=r.field(On,!1))===null||e===void 0?void 0:e.panel)!=null}var vl=class{constructor(e,t){this.query=e,this.panel=t}},OH=et.Decoration.mark({class:"cm-searchMatch"}),RH=et.Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"}),LH=et.ViewPlugin.fromClass(class{constructor(r){this.view=r,this.decorations=this.highlight(r.state.field(On))}update(r){let e=r.state.field(On);(e!=r.startState.field(On)||r.docChanged||r.selectionSet||r.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:r,panel:e}){if(!e||!r.spec.valid)return et.Decoration.none;let{view:t}=this,n=new Ie.RangeSetBuilder;for(let i=0,a=t.visibleRanges,s=a.length;i<s;i++){let{from:o,to:l}=a[i];for(;i<s-1&&l>a[i+1].from-2*250;)l=a[++i].to;r.highlight(t.state,o,l,(u,h)=>{let f=t.state.selection.ranges.some(c=>c.from==u&&c.to==h);n.add(u,h,f?RH:OH)})}return n.finish()}},{decorations:r=>r.decorations});function xl(r){return e=>{let t=e.state.field(On,!1);return t&&t.query.spec.valid?r(e,t):Nv(e)}}var bl=xl((r,{query:e})=>{let{to:t}=r.state.selection.main,n=e.nextMatch(r.state,t,t);if(!n)return!1;let i=Ie.EditorSelection.single(n.from,n.to),a=r.state.facet(Ta);return r.dispatch({selection:i,effects:[Fv(r,n),a.scrollToMatch(i.main,r)],userEvent:"select.search"}),wk(r),!0}),wl=xl((r,{query:e})=>{let{state:t}=r,{from:n}=t.selection.main,i=e.prevMatch(t,n,n);if(!i)return!1;let a=Ie.EditorSelection.single(i.from,i.to),s=r.state.facet(Ta);return r.dispatch({selection:a,effects:[Fv(r,i),s.scrollToMatch(a.main,r)],userEvent:"select.search"}),wk(r),!0}),vk=xl((r,{query:e})=>{let t=e.matchAll(r.state,1e3);return!t||!t.length?!1:(r.dispatch({selection:Ie.EditorSelection.create(t.map(n=>Ie.EditorSelection.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),mk=({state:r,dispatch:e})=>{let t=r.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:n,to:i}=t.main,a=[],s=0;for(let o=new ei(r.doc,r.sliceDoc(n,i));!o.next().done;){if(a.length>1e3)return!1;o.value.from==n&&(s=a.length),a.push(Ie.EditorSelection.range(o.value.from,o.value.to))}return e(r.update({selection:Ie.EditorSelection.create(a,s),userEvent:"select.search.matches"})),!0},Pv=xl((r,{query:e})=>{let{state:t}=r,{from:n,to:i}=t.selection.main;if(t.readOnly)return!1;let a=e.nextMatch(t,n,n);if(!a)return!1;let s=a,o=[],l,u,h=[];if(s.from==n&&s.to==i&&(u=t.toText(e.getReplacement(s)),o.push({from:s.from,to:s.to,insert:u}),s=e.nextMatch(t,s.from,s.to),h.push(et.EditorView.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(n).number)+"."))),s){let f=o.length==0||o[0].from>=a.to?0:a.to-a.from-u.length;l=Ie.EditorSelection.single(s.from-f,s.to-f),h.push(Fv(r,s)),h.push(t.facet(Ta).scrollToMatch(l.main,r))}return r.dispatch({changes:o,selection:l,effects:h,userEvent:"input.replace"}),!0}),yk=xl((r,{query:e})=>{if(r.state.readOnly)return!1;let t=e.matchAll(r.state,1e9).map(i=>{let{from:a,to:s}=i;return{from:a,to:s,insert:e.getReplacement(i)}});if(!t.length)return!1;let n=r.state.phrase("replaced $ matches",t.length)+".";return r.dispatch({changes:t,effects:et.EditorView.announce.of(n),userEvent:"input.replace.all"}),!0});function Iv(r){return r.state.facet(Ta).createPanel(r)}function Df(r,e){var t,n,i,a,s;let o=r.selection.main,l=o.empty||o.to>o.from+100?"":r.sliceDoc(o.from,o.to);if(e&&!l)return e;let u=r.facet(Ta);return new yl({search:((t=e?.literal)!==null&&t!==void 0?t:u.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(n=e?.caseSensitive)!==null&&n!==void 0?n:u.caseSensitive,literal:(i=e?.literal)!==null&&i!==void 0?i:u.literal,regexp:(a=e?.regexp)!==null&&a!==void 0?a:u.regexp,wholeWord:(s=e?.wholeWord)!==null&&s!==void 0?s:u.wholeWord})}function bk(r){let e=et.getPanel(r,Iv);return e&&e.dom.querySelector("[main-field]")}function wk(r){let e=bk(r);e&&e==r.root.activeElement&&e.select()}var Nv=r=>{let e=r.state.field(On,!1);if(e&&e.panel){let t=bk(r);if(t&&t!=r.root.activeElement){let n=Df(r.state,e.query.spec);n.valid&&r.dispatch({effects:Ds.of(n)}),t.focus(),t.select()}}else r.dispatch({effects:[Lv.of(!0),e?Ds.of(Df(r.state,e.query.spec)):Ie.StateEffect.appendConfig.of(Ov)]});return!0},qv=r=>{let e=r.state.field(On,!1);if(!e||!e.panel)return!1;let t=et.getPanel(r,Iv);return t&&t.dom.contains(r.root.activeElement)&&r.focus(),r.dispatch({effects:Lv.of(!1)}),!0},IH=[{key:"Mod-f",run:Nv,scope:"editor search-panel"},{key:"F3",run:bl,shift:wl,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:bl,shift:wl,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:qv,scope:"editor search-panel"},{key:"Mod-Shift-l",run:mk},{key:"Mod-Alt-g",run:dk},{key:"Mod-d",run:gk,preventDefault:!0}],Bv=class{constructor(e){this.view=e;let t=this.query=e.state.field(On).query.spec;this.commit=this.commit.bind(this),this.searchField=rr("input",{value:t.search,placeholder:zr(e,"Find"),"aria-label":zr(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=rr("input",{value:t.replace,placeholder:zr(e,"Replace"),"aria-label":zr(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=rr("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=rr("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=rr("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function n(i,a,s){return rr("button",{class:"cm-button",name:i,onclick:a,type:"button"},s)}this.dom=rr("div",{onkeydown:i=>this.keydown(i),class:"cm-search"},[this.searchField,n("next",()=>bl(e),[zr(e,"next")]),n("prev",()=>wl(e),[zr(e,"previous")]),n("select",()=>vk(e),[zr(e,"all")]),rr("label",null,[this.caseField,zr(e,"match case")]),rr("label",null,[this.reField,zr(e,"regexp")]),rr("label",null,[this.wordField,zr(e,"by word")]),...e.state.readOnly?[]:[rr("br"),this.replaceField,n("replace",()=>Pv(e),[zr(e,"replace")]),n("replaceAll",()=>yk(e),[zr(e,"replace all")])],rr("button",{name:"close",onclick:()=>qv(e),"aria-label":zr(e,"close"),type:"button"},["\xD7"])])}commit(){let e=new yl({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Ds.of(e)}))}keydown(e){et.runScopeHandlers(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?wl:bl)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),Pv(this.view))}update(e){for(let t of e.transactions)for(let n of t.effects)n.is(Ds)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Ta).top}};function zr(r,e){return r.state.phrase(e)}var xf=30,Sf=/[\s\.,:;?!]/;function Fv(r,{from:e,to:t}){let n=r.state.doc.lineAt(e),i=r.state.doc.lineAt(t).to,a=Math.max(n.from,e-xf),s=Math.min(i,t+xf),o=r.state.sliceDoc(a,s);if(a!=n.from){for(let l=0;l<xf;l++)if(!Sf.test(o[l+1])&&Sf.test(o[l])){o=o.slice(l);break}}if(s!=i){for(let l=o.length-1;l>o.length-xf;l--)if(!Sf.test(o[l-1])&&Sf.test(o[l])){o=o.slice(0,l);break}}return et.EditorView.announce.of(`${r.state.phrase("current match")}. ${o} ${r.state.phrase("on line")} ${n.number}.`)}var NH=et.EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Ov=[On,Ie.Prec.low(LH),NH];It.RegExpCursor=ml;It.SearchCursor=ei;It.SearchQuery=yl;It.closeSearchPanel=qv;It.findNext=bl;It.findPrevious=wl;It.getSearchQuery=PH;It.gotoLine=dk;It.highlightSelectionMatches=bH;It.openSearchPanel=Nv;It.replaceAll=yk;It.replaceNext=Pv;It.search=AH;It.searchKeymap=IH;It.searchPanelOpen=BH;It.selectMatches=vk;It.selectNextOccurrence=gk;It.selectSelectionMatches=mk;It.setSearchQuery=Ds});var Jk=B(tt=>{"use strict";var ge=bi(),Dt=Ti(),Bs=af(),Cl=class{constructor(e,t,n,i){this.state=e,this.pos=t,this.explicit=n,this.view=i,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=Bs.syntaxTree(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),i=t.text.slice(n-t.from,this.pos-t.from),a=i.search(Lk(e,!1));return a<0?null:{from:n+a,to:this.pos,text:i.slice(a)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,n){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),n&&n.onDocChange&&(this.abortOnDocChange=!0))}};function Sk(r){let e=Object.keys(r).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function qH(r){let e=Object.create(null),t=Object.create(null);for(let{label:i}of r){e[i[0]]=!0;for(let a=1;a<i.length;a++)t[i[a]]=!0}let n=Sk(e)+Sk(t)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function Rk(r){let e=r.map(i=>typeof i=="string"?{label:i}:i),[t,n]=e.every(i=>/^\w+$/.test(i.label))?[/\w*$/,/\w+$/]:qH(e);return i=>{let a=i.matchBefore(n);return a||i.explicit?{from:a?a.from:i.pos,options:e,validFor:t}:null}}function FH(r,e){return t=>{for(let n=Bs.syntaxTree(t.state).resolveInner(t.pos,-1);n;n=n.parent){if(r.indexOf(n.name)>-1)return e(t);if(n.type.isTop)break}return null}}function _H(r,e){return t=>{for(let n=Bs.syntaxTree(t.state).resolveInner(t.pos,-1);n;n=n.parent){if(r.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return e(t)}}var Pf=class{constructor(e,t,n,i){this.completion=e,this.source=t,this.match=n,this.score=i}};function Ma(r){return r.selection.main.from}function Lk(r,e){var t;let{source:n}=r,i=e&&n[0]!="^",a=n[n.length-1]!="$";return!i&&!a?r:new RegExp(`${i?"^":""}(?:${n})${a?"$":""}`,(t=r.flags)!==null&&t!==void 0?t:r.ignoreCase?"i":"")}var Rf=ge.Annotation.define();function Ik(r,e,t,n){let{main:i}=r.selection,a=t-i.from,s=n-i.from;return Object.assign(Object.assign({},r.changeByRange(o=>{if(o!=i&&t!=n&&r.sliceDoc(o.from+a,o.from+s)!=r.sliceDoc(t,n))return{range:o};let l=r.toText(e);return{changes:{from:o.from+a,to:n==i.from?o.to:o.from+s,insert:l},range:ge.EditorSelection.cursor(o.from+a+l.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}var Ck=new WeakMap;function zH(r){if(!Array.isArray(r))return r;let e=Ck.get(r);return e||Ck.set(r,e=Rk(r)),e}var Bf=ge.StateEffect.define(),kl=ge.StateEffect.define(),Vv=class{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let n=ge.codePointAt(e,t),i=ge.codePointSize(n);this.chars.push(n);let a=e.slice(t,t+i),s=a.toUpperCase();this.folded.push(ge.codePointAt(s==a?a.toLowerCase():s,0)),t+=i}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:n,any:i,precise:a,byWord:s}=this;if(t.length==1){let y=ge.codePointAt(e,0),b=ge.codePointSize(y),w=b==e.length?0:-100;if(y!=t[0])if(y==n[0])w+=-200;else return null;return this.ret(w,[0,b])}let o=e.indexOf(this.pattern);if(o==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=t.length,u=0;if(o<0){for(let y=0,b=Math.min(e.length,200);y<b&&u<l;){let w=ge.codePointAt(e,y);(w==t[u]||w==n[u])&&(i[u++]=y),y+=ge.codePointSize(w)}if(u<l)return null}let h=0,f=0,c=!1,d=0,p=-1,g=-1,v=/[a-z]/.test(e),m=!0;for(let y=0,b=Math.min(e.length,200),w=0;y<b&&f<l;){let S=ge.codePointAt(e,y);o<0&&(h<l&&S==t[h]&&(a[h++]=y),d<l&&(S==t[d]||S==n[d]?(d==0&&(p=y),g=y+1,d++):d=0));let C,x=S<255?S>=48&&S<=57||S>=97&&S<=122?2:S>=65&&S<=90?1:0:(C=ge.fromCodePoint(S))!=C.toLowerCase()?1:C!=C.toUpperCase()?2:0;(!y||x==1&&v||w==0&&x!=0)&&(t[f]==S||n[f]==S&&(c=!0)?s[f++]=y:s.length&&(m=!1)),w=x,y+=ge.codePointSize(S)}return f==l&&s[0]==0&&m?this.result(-100+(c?-200:0),s,e):d==l&&p==0?this.ret(-200-e.length+(g==e.length?0:-100),[0,g]):o>-1?this.ret(-700-e.length,[o,o+this.pattern.length]):d==l?this.ret(-900-e.length,[p,g]):f==l?this.result(-100+(c?-200:0)+-700+(m?0:-1100),s,e):t.length==2?null:this.result((i[0]?-700:0)+-200+-1100,i,e)}result(e,t,n){let i=[],a=0;for(let s of t){let o=s+(this.astral?ge.codePointSize(ge.codePointAt(n,s)):1);a&&i[a-1]==s?i[a-1]=o:(i[a++]=s,i[a++]=o)}return this.ret(e-n.length,i)}},Hv=class{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),n=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return n==null?null:(this.matched=[0,t.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}},Kt=ge.Facet.define({combine(r){return ge.combineConfig(r,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:VH,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>n=>kk(e(n),t(n)),optionClass:(e,t)=>n=>kk(e(n),t(n)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function kk(r,e){return r?e?r+" "+e:r:e}function VH(r,e,t,n,i,a){let s=r.textDirection==Dt.Direction.RTL,o=s,l=!1,u="top",h,f,c=e.left-i.left,d=i.right-e.right,p=n.right-n.left,g=n.bottom-n.top;if(o&&c<Math.min(p,d)?o=!1:!o&&d<Math.min(p,c)&&(o=!0),p<=(o?c:d))h=Math.max(i.top,Math.min(t.top,i.bottom-g))-e.top,f=Math.min(400,o?c:d);else{l=!0,f=Math.min(400,(s?e.right:i.right-e.left)-30);let y=i.bottom-e.bottom;y>=g||y>e.top?h=t.bottom-e.top:(u="bottom",h=e.bottom-t.top)}let v=(e.bottom-e.top)/a.offsetHeight,m=(e.right-e.left)/a.offsetWidth;return{style:`${u}: ${h/v}px; max-width: ${f/m}px`,class:"cm-completionInfo-"+(l?s?"left-narrow":"right-narrow":o?"left":"right")}}function HH(r){let e=r.addToOptions.slice();return r.icons&&e.push({render(t){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),t.type&&n.classList.add(...t.type.split(/\s+/g).map(i=>"cm-completionIcon-"+i)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(t,n,i,a){let s=document.createElement("span");s.className="cm-completionLabel";let o=t.displayLabel||t.label,l=0;for(let u=0;u<a.length;){let h=a[u++],f=a[u++];h>l&&s.appendChild(document.createTextNode(o.slice(l,h)));let c=s.appendChild(document.createElement("span"));c.appendChild(document.createTextNode(o.slice(h,f))),c.className="cm-completionMatchedText",l=f}return l<o.length&&s.appendChild(document.createTextNode(o.slice(l))),s},position:50},{render(t){if(!t.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=t.detail,n},position:80}),e.sort((t,n)=>t.position-n.position).map(t=>t.render)}function _v(r,e,t){if(r<=t)return{from:0,to:r};if(e<0&&(e=0),e<=r>>1){let i=Math.floor(e/t);return{from:i*t,to:(i+1)*t}}let n=Math.floor((r-e)/t);return{from:r-(n+1)*t,to:r-n*t}}var Wv=class{constructor(e,t,n){this.view=e,this.stateField=t,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let i=e.state.field(t),{options:a,selected:s}=i.open,o=e.state.facet(Kt);this.optionContent=HH(o),this.optionClass=o.optionClass,this.tooltipClass=o.tooltipClass,this.range=_v(a.length,s,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:u}=e.state.field(t).open;for(let h=l.target,f;h&&h!=this.dom;h=h.parentNode)if(h.nodeName=="LI"&&(f=/-(\d+)$/.exec(h.id))&&+f[1]<u.length){this.applyCompletion(e,u[+f[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let u=e.state.field(this.stateField,!1);u&&u.tooltip&&e.state.facet(Kt).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:kl.of(null)})}),this.showOptions(a,i.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let n=e.state.field(this.stateField),i=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=i){let{options:a,selected:s,disabled:o}=n.open;(!i.open||i.open.options!=a)&&(this.range=_v(a.length,s,e.state.facet(Kt).maxRenderedOptions),this.showOptions(a,n.id)),this.updateSel(),o!=((t=i.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!o)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of t.split(" "))n&&this.dom.classList.add(n);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=_v(t.options.length,t.selected,this.view.state.facet(Kt).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:n}=t.options[t.selected],{info:i}=n;if(!i)return;let a=typeof i=="string"?document.createTextNode(i):i(n);if(!a)return;"then"in a?a.then(s=>{s&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(s,n)}).catch(s=>Dt.logException(this.view.state,s,"completion info")):this.addInfoPane(a,n)}}addInfoPane(e,t){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",e.nodeType!=null)n.appendChild(e),this.infoDestroy=null;else{let{dom:i,destroy:a}=e;n.appendChild(i),this.infoDestroy=a||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let n=this.list.firstChild,i=this.range.from;n;n=n.nextSibling,i++)n.nodeName!="LI"||!n.id?i--:i==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return t&&GH(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),i=e.getBoundingClientRect(),a=this.space;if(!a){let s=this.dom.ownerDocument.documentElement;a={left:0,top:0,right:s.clientWidth,bottom:s.clientHeight}}return i.top>Math.min(a.bottom,t.bottom)-10||i.bottom<Math.max(a.top,t.top)+10?null:this.view.state.facet(Kt).positionInfo(this.view,t,i,n,a,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,n){let i=document.createElement("ul");i.id=t,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions")),i.addEventListener("mousedown",s=>{s.target==i&&s.preventDefault()});let a=null;for(let s=n.from;s<n.to;s++){let{completion:o,match:l}=e[s],{section:u}=o;if(u){let c=typeof u=="string"?u:u.name;if(c!=a&&(s>n.from||n.from==0))if(a=c,typeof u!="string"&&u.header)i.appendChild(u.header(u));else{let d=i.appendChild(document.createElement("completion-section"));d.textContent=c}}let h=i.appendChild(document.createElement("li"));h.id=t+"-"+s,h.setAttribute("role","option");let f=this.optionClass(o);f&&(h.className=f);for(let c of this.optionContent){let d=c(o,this.view.state,this.view,l);d&&h.appendChild(d)}}return n.from&&i.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}};function WH(r,e){return t=>new Wv(t,r,e)}function GH(r,e){let t=r.getBoundingClientRect(),n=e.getBoundingClientRect(),i=t.height/r.offsetHeight;n.top<t.top?r.scrollTop-=(t.top-n.top)/i:n.bottom>t.bottom&&(r.scrollTop+=(n.bottom-t.bottom)/i)}function Ek(r){return(r.boost||0)*100+(r.apply?10:0)+(r.info?5:0)+(r.type?1:0)}function UH(r,e){let t=[],n=null,i=u=>{t.push(u);let{section:h}=u.completion;if(h){n||(n=[]);let f=typeof h=="string"?h:h.name;n.some(c=>c.name==f)||n.push(typeof h=="string"?{name:f}:h)}},a=e.facet(Kt);for(let u of r)if(u.hasResult()){let h=u.result.getMatch;if(u.result.filter===!1)for(let f of u.result.options)i(new Pf(f,u.source,h?h(f):[],1e9-t.length));else{let f=e.sliceDoc(u.from,u.to),c,d=a.filterStrict?new Hv(f):new Vv(f);for(let p of u.result.options)if(c=d.match(p.label)){let g=p.displayLabel?h?h(p,c.matched):[]:c.matched;i(new Pf(p,u.source,g,c.score+(p.boost||0)))}}}if(n){let u=Object.create(null),h=0,f=(c,d)=>{var p,g;return((p=c.rank)!==null&&p!==void 0?p:1e9)-((g=d.rank)!==null&&g!==void 0?g:1e9)||(c.name<d.name?-1:1)};for(let c of n.sort(f))h-=1e5,u[c.name]=h;for(let c of t){let{section:d}=c.completion;d&&(c.score+=u[typeof d=="string"?d:d.name])}}let s=[],o=null,l=a.compareCompletions;for(let u of t.sort((h,f)=>f.score-h.score||l(h.completion,f.completion))){let h=u.completion;!o||o.label!=h.label||o.detail!=h.detail||o.type!=null&&h.type!=null&&o.type!=h.type||o.apply!=h.apply||o.boost!=h.boost?s.push(u):Ek(u.completion)>Ek(o)&&(s[s.length-1]=u),o=u.completion}return s}var Gv=class r{constructor(e,t,n,i,a,s){this.options=e,this.attrs=t,this.tooltip=n,this.timestamp=i,this.selected=a,this.disabled=s}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new r(this.options,Tk(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,n,i,a,s){if(i&&!s&&e.some(u=>u.isPending))return i.setDisabled();let o=UH(e,t);if(!o.length)return i&&e.some(u=>u.isPending)?i.setDisabled():null;let l=t.facet(Kt).selectOnOpen?0:-1;if(i&&i.selected!=l&&i.selected!=-1){let u=i.options[i.selected].completion;for(let h=0;h<o.length;h++)if(o[h].completion==u){l=h;break}}return new r(o,Tk(n,l),{pos:e.reduce((u,h)=>h.hasResult()?Math.min(u,h.from):u,1e8),create:ZH,above:a.aboveCursor},i?i.timestamp:Date.now(),l,!1)}map(e){return new r(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new r(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}},Uv=class r{constructor(e,t,n){this.active=e,this.id=t,this.open=n}static start(){return new r(XH,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,n=t.facet(Kt),a=(n.override||t.languageDataAt("autocomplete",Ma(t)).map(zH)).map(l=>(this.active.find(h=>h.source==l)||new ti(l,this.active.some(h=>h.state!=0)?1:0)).update(e,n));a.length==this.active.length&&a.every((l,u)=>l==this.active[u])&&(a=this.active);let s=this.open,o=e.effects.some(l=>l.is(Qv));s&&e.docChanged&&(s=s.map(e.changes)),e.selection||a.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!KH(a,this.active)||o?s=Gv.build(a,t,this.id,s,n,o):s&&s.disabled&&!a.some(l=>l.isPending)&&(s=null),!s&&a.every(l=>!l.isPending)&&a.some(l=>l.hasResult())&&(a=a.map(l=>l.hasResult()?new ti(l.source,0):l));for(let l of e.effects)l.is(Jv)&&(s=s&&s.setSelected(l.value,this.id));return a==this.active&&s==this.open?this:new r(a,this.id,s)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?jH:YH}};function KH(r,e){if(r==e)return!0;for(let t=0,n=0;;){for(;t<r.length&&!r[t].hasResult();)t++;for(;n<e.length&&!e[n].hasResult();)n++;let i=t==r.length,a=n==e.length;if(i||a)return i==a;if(r[t++].result!=e[n++].result)return!1}}var jH={"aria-autocomplete":"list"},YH={};function Tk(r,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":r};return e>-1&&(t["aria-activedescendant"]=r+"-"+e),t}var XH=[];function Nk(r,e){if(r.isUserEvent("input.complete")){let n=r.annotation(Rf);if(n&&e.activateOnCompletion(n))return 12}let t=r.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:r.isUserEvent("delete.backward")?2:r.selection?8:r.docChanged?16:0}var ti=class r{constructor(e,t,n=!1){this.source=e,this.state=t,this.explicit=n}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let n=Nk(e,t),i=this;(n&8||n&16&&this.touches(e))&&(i=new r(i.source,0)),n&4&&i.state==0&&(i=new r(this.source,1)),i=i.updateFor(e,n);for(let a of e.effects)if(a.is(Bf))i=new r(i.source,1,a.value);else if(a.is(kl))i=new r(i.source,0);else if(a.is(Qv))for(let s of a.value)s.source==i.source&&(i=s);return i}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(Ma(e.state))}},Of=class r extends ti{constructor(e,t,n,i,a,s){super(e,3,t),this.limit=n,this.result=i,this.from=a,this.to=s}hasResult(){return!0}updateFor(e,t){var n;if(!(t&3))return this.map(e.changes);let i=this.result;i.map&&!e.changes.empty&&(i=i.map(i,e.changes));let a=e.changes.mapPos(this.from),s=e.changes.mapPos(this.to,1),o=Ma(e.state);if(o>s||!i||t&2&&(Ma(e.startState)==this.from||o<this.limit))return new ti(this.source,t&4?1:0);let l=e.changes.mapPos(this.limit);return $H(i.validFor,e.state,a,s)?new r(this.source,this.explicit,l,i,a,s):i.update&&(i=i.update(i,a,s,new Cl(e.state,o,!1)))?new r(this.source,this.explicit,l,i,i.from,(n=i.to)!==null&&n!==void 0?n:Ma(e.state)):new ti(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new r(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new ti(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}};function $H(r,e,t,n){if(!r)return!1;let i=e.sliceDoc(t,n);return typeof r=="function"?r(i,t,n,e):Lk(r,!0).test(i)}var Qv=ge.StateEffect.define({map(r,e){return r.map(t=>t.map(e))}}),Jv=ge.StateEffect.define(),Ut=ge.StateField.define({create(){return Uv.start()},update(r,e){return r.update(e)},provide:r=>[Dt.showTooltip.from(r,e=>e.tooltip),Dt.EditorView.contentAttributes.from(r,e=>e.attrs)]});function em(r,e){let t=e.completion.apply||e.completion.label,n=r.state.field(Ut).active.find(i=>i.source==e.source);return n instanceof Of?(typeof t=="string"?r.dispatch(Object.assign(Object.assign({},Ik(r.state,t,n.from,n.to)),{annotations:Rf.of(e.completion)})):t(r,e.completion,n.from,n.to),!0):!1}var ZH=WH(Ut,em);function Sl(r,e="option"){return t=>{let n=t.state.field(Ut,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<t.state.facet(Kt).interactionDelay)return!1;let i=1,a;e=="page"&&(a=Dt.getTooltip(t,n.open.tooltip))&&(i=Math.max(2,Math.floor(a.dom.offsetHeight/a.dom.querySelector("li").offsetHeight)-1));let{length:s}=n.open.options,o=n.open.selected>-1?n.open.selected+i*(r?1:-1):r?0:s-1;return o<0?o=e=="page"?0:s-1:o>=s&&(o=e=="page"?s-1:0),t.dispatch({effects:Jv.of(o)}),!0}}var qk=r=>{let e=r.state.field(Ut,!1);return r.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<r.state.facet(Kt).interactionDelay?!1:em(r,e.open.options[e.open.selected])},Kv=r=>r.state.field(Ut,!1)?(r.dispatch({effects:Bf.of(!0)}),!0):!1,Fk=r=>{let e=r.state.field(Ut,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(r.dispatch({effects:kl.of(null)}),!0)},jv=class{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}},QH=50,JH=1e3,eW=Dt.ViewPlugin.fromClass(class{constructor(r){this.view=r,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of r.state.field(Ut).active)e.isPending&&this.startQuery(e)}update(r){let e=r.state.field(Ut),t=r.state.facet(Kt);if(!r.selectionSet&&!r.docChanged&&r.startState.field(Ut)==e)return;let n=r.transactions.some(a=>{let s=Nk(a,t);return s&8||(a.selection||a.docChanged)&&!(s&3)});for(let a=0;a<this.running.length;a++){let s=this.running[a];if(n||s.context.abortOnDocChange&&r.docChanged||s.updates.length+r.transactions.length>QH&&Date.now()-s.time>JH){for(let o of s.context.abortListeners)try{o()}catch(l){Dt.logException(this.view.state,l)}s.context.abortListeners=null,this.running.splice(a--,1)}else s.updates.push(...r.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),r.transactions.some(a=>a.effects.some(s=>s.is(Bf)))&&(this.pendingStart=!0);let i=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(a=>a.isPending&&!this.running.some(s=>s.active.source==a.source))?setTimeout(()=>this.startUpdate(),i):-1,this.composing!=0)for(let a of r.transactions)a.isUserEvent("input.type")?this.composing=2:this.composing==2&&a.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:r}=this.view,e=r.field(Ut);for(let t of e.active)t.isPending&&!this.running.some(n=>n.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Kt).updateSyncTime))}startQuery(r){let{state:e}=this.view,t=Ma(e),n=new Cl(e,t,r.explicit,this.view),i=new jv(r,n);this.running.push(i),Promise.resolve(r.source(n)).then(a=>{i.context.aborted||(i.done=a||null,this.scheduleAccept())},a=>{this.view.dispatch({effects:kl.of(null)}),Dt.logException(this.view.state,a)})}scheduleAccept(){this.running.every(r=>r.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Kt).updateSyncTime))}accept(){var r;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Kt),n=this.view.state.field(Ut);for(let i=0;i<this.running.length;i++){let a=this.running[i];if(a.done===void 0)continue;if(this.running.splice(i--,1),a.done){let o=Ma(a.updates.length?a.updates[0].startState:this.view.state),l=Math.min(o,a.done.from+(a.active.explicit?0:1)),u=new Of(a.active.source,a.active.explicit,l,a.done,a.done.from,(r=a.done.to)!==null&&r!==void 0?r:o);for(let h of a.updates)u=u.update(h,t);if(u.hasResult()){e.push(u);continue}}let s=n.active.find(o=>o.source==a.active.source);if(s&&s.isPending)if(a.done==null){let o=new ti(a.active.source,0);for(let l of a.updates)o=o.update(l,t);o.isPending||e.push(o)}else this.startQuery(s)}(e.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:Qv.of(e)})}},{eventHandlers:{blur(r){let e=this.view.state.field(Ut,!1);if(e&&e.tooltip&&this.view.state.facet(Kt).closeOnBlur){let t=e.open&&Dt.getTooltip(this.view,e.open.tooltip);(!t||!t.dom.contains(r.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:kl.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Bf.of(!1)}),20),this.composing=0}}}),tW=typeof navigator=="object"&&/Win/.test(navigator.platform),rW=ge.Prec.highest(Dt.EditorView.domEventHandlers({keydown(r,e){let t=e.state.field(Ut,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||r.key.length>1||r.ctrlKey&&!(tW&&r.altKey)||r.metaKey)return!1;let n=t.open.options[t.open.selected],i=t.active.find(s=>s.source==n.source),a=n.completion.commitCharacters||i.result.commitCharacters;return a&&a.indexOf(r.key)>-1&&em(e,n),!1}})),_k=Dt.EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Yv=class{constructor(e,t,n,i){this.field=e,this.line=t,this.from=n,this.to=i}},Xv=class r{constructor(e,t,n){this.field=e,this.from=t,this.to=n}map(e){let t=e.mapPos(this.from,-1,ge.MapMode.TrackDel),n=e.mapPos(this.to,1,ge.MapMode.TrackDel);return t==null||n==null?null:new r(this.field,t,n)}},$v=class r{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let n=[],i=[t],a=e.doc.lineAt(t),s=/^\s*/.exec(a.text)[0];for(let l of this.lines){if(n.length){let u=s,h=/^\t*/.exec(l)[0].length;for(let f=0;f<h;f++)u+=e.facet(Bs.indentUnit);i.push(t+u.length-h),l=u+l.slice(h)}n.push(l),t+=l.length+1}let o=this.fieldPositions.map(l=>new Xv(l.field,i[l.line]+l.from,i[l.line]+l.to));return{text:n,ranges:o}}static parse(e){let t=[],n=[],i=[],a;for(let s of e.split(/\r\n?|\n/)){for(;a=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(s);){let o=a[1]?+a[1]:null,l=a[2]||a[3]||"",u=-1,h=l.replace(/\\[{}]/g,f=>f[1]);for(let f=0;f<t.length;f++)(o!=null?t[f].seq==o:h&&t[f].name==h)&&(u=f);if(u<0){let f=0;for(;f<t.length&&(o==null||t[f].seq!=null&&t[f].seq<o);)f++;t.splice(f,0,{seq:o,name:h}),u=f;for(let c of i)c.field>=u&&c.field++}i.push(new Yv(u,n.length,a.index,a.index+h.length)),s=s.slice(0,a.index)+l+s.slice(a.index+a[0].length)}s=s.replace(/\\([{}])/g,(o,l,u)=>{for(let h of i)h.line==n.length&&h.from>u&&(h.from--,h.to--);return l}),n.push(s)}return new r(n,i)}},nW=Dt.Decoration.widget({widget:new class extends Dt.WidgetType{toDOM(){let r=document.createElement("span");return r.className="cm-snippetFieldPosition",r}ignoreEvent(){return!1}}}),iW=Dt.Decoration.mark({class:"cm-snippetField"}),Ps=class r{constructor(e,t){this.ranges=e,this.active=t,this.deco=Dt.Decoration.set(e.map(n=>(n.from==n.to?nW:iW).range(n.from,n.to)))}map(e){let t=[];for(let n of this.ranges){let i=n.map(e);if(!i)return null;t.push(i)}return new r(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(n=>n.field==this.active&&n.from<=t.from&&n.to>=t.to))}},Tl=ge.StateEffect.define({map(r,e){return r&&r.map(e)}}),aW=ge.StateEffect.define(),Da=ge.StateField.define({create(){return null},update(r,e){for(let t of e.effects){if(t.is(Tl))return t.value;if(t.is(aW)&&r)return new Ps(r.ranges,t.value)}return r&&e.docChanged&&(r=r.map(e.changes)),r&&e.selection&&!r.selectionInsideField(e.selection)&&(r=null),r},provide:r=>Dt.EditorView.decorations.from(r,e=>e?e.deco:Dt.Decoration.none)});function tm(r,e){return ge.EditorSelection.create(r.filter(t=>t.field==e).map(t=>ge.EditorSelection.range(t.from,t.to)))}function zk(r){let e=$v.parse(r);return(t,n,i,a)=>{let{text:s,ranges:o}=e.instantiate(t.state,i),{main:l}=t.state.selection,u={changes:{from:i,to:a==l.from?l.to:a,insert:ge.Text.of(s)},scrollIntoView:!0,annotations:n?[Rf.of(n),ge.Transaction.userEvent.of("input.complete")]:void 0};if(o.length&&(u.selection=tm(o,0)),o.some(h=>h.field>0)){let h=new Ps(o,0),f=u.effects=[Tl.of(h)];t.state.field(Da,!1)===void 0&&f.push(ge.StateEffect.appendConfig.of([Da,uW,fW,_k]))}t.dispatch(t.state.update(u))}}function Vk(r){return({state:e,dispatch:t})=>{let n=e.field(Da,!1);if(!n||r<0&&n.active==0)return!1;let i=n.active+r,a=r>0&&!n.ranges.some(s=>s.field==i+r);return t(e.update({selection:tm(n.ranges,i),effects:Tl.of(a?null:new Ps(n.ranges,i)),scrollIntoView:!0})),!0}}var Hk=({state:r,dispatch:e})=>r.field(Da,!1)?(e(r.update({effects:Tl.of(null)})),!0):!1,Wk=Vk(1),Gk=Vk(-1);function sW(r){let e=r.field(Da,!1);return!!(e&&e.ranges.some(t=>t.field==e.active+1))}function oW(r){let e=r.field(Da,!1);return!!(e&&e.active>0)}var lW=[{key:"Tab",run:Wk,shift:Gk},{key:"Escape",run:Hk}],Zv=ge.Facet.define({combine(r){return r.length?r[0]:lW}}),uW=ge.Prec.highest(Dt.keymap.compute([Zv],r=>r.facet(Zv)));function hW(r,e){return Object.assign(Object.assign({},e),{apply:zk(r)})}var fW=Dt.EditorView.domEventHandlers({mousedown(r,e){let t=e.state.field(Da,!1),n;if(!t||(n=e.posAtCoords({x:r.clientX,y:r.clientY}))==null)return!1;let i=t.ranges.find(a=>a.from<=n&&a.to>=n);return!i||i.field==t.active?!1:(e.dispatch({selection:tm(t.ranges,i.field),effects:Tl.of(t.ranges.some(a=>a.field>i.field)?new Ps(t.ranges,i.field):null),scrollIntoView:!0}),!0)}});function cW(r){let e=r.replace(/[\]\-\\]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${e}]+`,"ug")}catch{return new RegExp(`[w${e}]`,"g")}}function Ak(r,e){return new RegExp(e(r.source),r.unicode?"u":"")}var Mk=Object.create(null);function dW(r){return Mk[r]||(Mk[r]=new WeakMap)}function Dk(r,e,t,n,i){for(let a=r.iterLines(),s=0;!a.next().done;){let{value:o}=a,l;for(e.lastIndex=0;l=e.exec(o);)if(!n[l[0]]&&s+l.index!=i&&(t.push({type:"text",label:l[0]}),n[l[0]]=!0,t.length>=2e3))return;s+=o.length+1}}function Uk(r,e,t,n,i){let a=r.length>=1e3,s=a&&e.get(r);if(s)return s;let o=[],l=Object.create(null);if(r.children){let u=0;for(let h of r.children){if(h.length>=1e3)for(let f of Uk(h,e,t,n-u,i-u))l[f.label]||(l[f.label]=!0,o.push(f));else Dk(h,t,o,l,i-u);u+=h.length+1}}else Dk(r,t,o,l,i);return a&&o.length<2e3&&e.set(r,o),o}var pW=r=>{let e=r.state.languageDataAt("wordChars",r.pos).join(""),t=cW(e),n=r.matchBefore(Ak(t,s=>s+"$"));if(!n&&!r.explicit)return null;let i=n?n.from:r.pos,a=Uk(r.state.doc,dW(e),t,5e4,i);return{from:i,options:a,validFor:Ak(t,s=>"^"+s)}},El={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Aa=ge.StateEffect.define({map(r,e){let t=e.mapPos(r,-1,ge.MapMode.TrackAfter);return t??void 0}}),rm=new class extends ge.RangeValue{};rm.startSide=1;rm.endSide=-1;var Kk=ge.StateField.define({create(){return ge.RangeSet.empty},update(r,e){if(r=r.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);r=r.update({filter:n=>n>=t.from&&n<=t.to})}for(let t of e.effects)t.is(Aa)&&(r=r.update({add:[rm.range(t.value,t.value+1)]}));return r}});function gW(){return[mW,Kk]}var zv="()[]{}<>\xAB\xBB\xBB\xAB\uFF3B\uFF3D\uFF5B\uFF5D";function jk(r){for(let e=0;e<zv.length;e+=2)if(zv.charCodeAt(e)==r)return zv.charAt(e+1);return ge.fromCodePoint(r<128?r:r+1)}function Yk(r,e){return r.languageDataAt("closeBrackets",e)[0]||El}var vW=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),mW=Dt.EditorView.inputHandler.of((r,e,t,n)=>{if((vW?r.composing:r.compositionStarted)||r.state.readOnly)return!1;let i=r.state.selection.main;if(n.length>2||n.length==2&&ge.codePointSize(ge.codePointAt(n,0))==1||e!=i.from||t!=i.to)return!1;let a=$k(r.state,n);return a?(r.dispatch(a),!0):!1}),Xk=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let n=Yk(r,r.selection.main.head).brackets||El.brackets,i=null,a=r.changeByRange(s=>{if(s.empty){let o=bW(r.doc,s.head);for(let l of n)if(l==o&&Lf(r.doc,s.head)==jk(ge.codePointAt(l,0)))return{changes:{from:s.head-l.length,to:s.head+l.length},range:ge.EditorSelection.cursor(s.head-l.length)}}return{range:i=s}});return i||e(r.update(a,{scrollIntoView:!0,userEvent:"delete.backward"})),!i},yW=[{key:"Backspace",run:Xk}];function $k(r,e){let t=Yk(r,r.selection.main.head),n=t.brackets||El.brackets;for(let i of n){let a=jk(ge.codePointAt(i,0));if(e==i)return a==i?SW(r,i,n.indexOf(i+i+i)>-1,t):wW(r,i,a,t.before||El.before);if(e==a&&Zk(r,r.selection.main.from))return xW(r,i,a)}return null}function Zk(r,e){let t=!1;return r.field(Kk).between(0,r.doc.length,n=>{n==e&&(t=!0)}),t}function Lf(r,e){let t=r.sliceString(e,e+2);return t.slice(0,ge.codePointSize(ge.codePointAt(t,0)))}function bW(r,e){let t=r.sliceString(e-2,e);return ge.codePointSize(ge.codePointAt(t,0))==t.length?t:t.slice(1)}function wW(r,e,t,n){let i=null,a=r.changeByRange(s=>{if(!s.empty)return{changes:[{insert:e,from:s.from},{insert:t,from:s.to}],effects:Aa.of(s.to+e.length),range:ge.EditorSelection.range(s.anchor+e.length,s.head+e.length)};let o=Lf(r.doc,s.head);return!o||/\s/.test(o)||n.indexOf(o)>-1?{changes:{insert:e+t,from:s.head},effects:Aa.of(s.head+e.length),range:ge.EditorSelection.cursor(s.head+e.length)}:{range:i=s}});return i?null:r.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function xW(r,e,t){let n=null,i=r.changeByRange(a=>a.empty&&Lf(r.doc,a.head)==t?{changes:{from:a.head,to:a.head+t.length,insert:t},range:ge.EditorSelection.cursor(a.head+t.length)}:n={range:a});return n?null:r.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function SW(r,e,t,n){let i=n.stringPrefixes||El.stringPrefixes,a=null,s=r.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:e,from:o.to}],effects:Aa.of(o.to+e.length),range:ge.EditorSelection.range(o.anchor+e.length,o.head+e.length)};let l=o.head,u=Lf(r.doc,l),h;if(u==e){if(Pk(r,l))return{changes:{insert:e+e,from:l},effects:Aa.of(l+e.length),range:ge.EditorSelection.cursor(l+e.length)};if(Zk(r,l)){let c=t&&r.sliceDoc(l,l+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:l,to:l+c.length,insert:c},range:ge.EditorSelection.cursor(l+c.length)}}}else{if(t&&r.sliceDoc(l-2*e.length,l)==e+e&&(h=Bk(r,l-2*e.length,i))>-1&&Pk(r,h))return{changes:{insert:e+e+e+e,from:l},effects:Aa.of(l+e.length),range:ge.EditorSelection.cursor(l+e.length)};if(r.charCategorizer(l)(u)!=ge.CharCategory.Word&&Bk(r,l,i)>-1&&!CW(r,l,e,i))return{changes:{insert:e+e,from:l},effects:Aa.of(l+e.length),range:ge.EditorSelection.cursor(l+e.length)}}return{range:a=o}});return a?null:r.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function Pk(r,e){let t=Bs.syntaxTree(r).resolveInner(e+1);return t.parent&&t.from==e}function CW(r,e,t,n){let i=Bs.syntaxTree(r).resolveInner(e,-1),a=n.reduce((s,o)=>Math.max(s,o.length),0);for(let s=0;s<5;s++){let o=r.sliceDoc(i.from,Math.min(i.to,i.from+t.length+a)),l=o.indexOf(t);if(!l||l>-1&&n.indexOf(o.slice(0,l))>-1){let h=i.firstChild;for(;h&&h.from==i.from&&h.to-h.from>t.length+l;){if(r.sliceDoc(h.to-t.length,h.to)==t)return!1;h=h.firstChild}return!0}let u=i.to==e&&i.parent;if(!u)break;i=u}return!1}function Bk(r,e,t){let n=r.charCategorizer(e);if(n(r.sliceDoc(e-1,e))!=ge.CharCategory.Word)return e;for(let i of t){let a=e-i.length;if(r.sliceDoc(a,e)==i&&n(r.sliceDoc(a-1,a))!=ge.CharCategory.Word)return a}return-1}function kW(r={}){return[rW,Ut,Kt.of(r),eW,EW,_k]}var Qk=[{key:"Ctrl-Space",run:Kv},{mac:"Alt-`",run:Kv},{key:"Escape",run:Fk},{key:"ArrowDown",run:Sl(!0)},{key:"ArrowUp",run:Sl(!1)},{key:"PageDown",run:Sl(!0,"page")},{key:"PageUp",run:Sl(!1,"page")},{key:"Enter",run:qk}],EW=ge.Prec.highest(Dt.keymap.computeN([Kt],r=>r.facet(Kt).defaultKeymap?[Qk]:[]));function TW(r){let e=r.field(Ut,!1);return e&&e.active.some(t=>t.isPending)?"pending":e&&e.active.some(t=>t.state!=0)?"active":null}var Ok=new WeakMap;function AW(r){var e;let t=(e=r.field(Ut,!1))===null||e===void 0?void 0:e.open;if(!t||t.disabled)return[];let n=Ok.get(t.options);return n||Ok.set(t.options,n=t.options.map(i=>i.completion)),n}function MW(r){var e;let t=(e=r.field(Ut,!1))===null||e===void 0?void 0:e.open;return t&&!t.disabled&&t.selected>=0?t.options[t.selected].completion:null}function DW(r){var e;let t=(e=r.field(Ut,!1))===null||e===void 0?void 0:e.open;return t&&!t.disabled&&t.selected>=0?t.selected:null}function PW(r){return Jv.of(r)}tt.CompletionContext=Cl;tt.acceptCompletion=qk;tt.autocompletion=kW;tt.clearSnippet=Hk;tt.closeBrackets=gW;tt.closeBracketsKeymap=yW;tt.closeCompletion=Fk;tt.completeAnyWord=pW;tt.completeFromList=Rk;tt.completionKeymap=Qk;tt.completionStatus=TW;tt.currentCompletions=AW;tt.deleteBracketPair=Xk;tt.hasNextSnippetField=sW;tt.hasPrevSnippetField=oW;tt.ifIn=FH;tt.ifNotIn=_H;tt.insertBracket=$k;tt.insertCompletionText=Ik;tt.moveCompletionSelection=Sl;tt.nextSnippetField=Wk;tt.pickedCompletion=Rf;tt.prevSnippetField=Gk;tt.selectedCompletion=MW;tt.selectedCompletionIndex=DW;tt.setSelectedCompletion=PW;tt.snippet=zk;tt.snippetCompletion=hW;tt.snippetKeymap=Zv;tt.startCompletion=Kv});var dE=B(Vr=>{"use strict";var Ft=Ti(),dr=bi(),Rn=Ev(),qf=class{constructor(e,t,n){this.from=e,this.to=t,this.diagnostic=n}},Pa=class r{constructor(e,t,n){this.diagnostics=e,this.panel=t,this.selected=n}static init(e,t,n){let i=n.facet(Ln).markerFilter;i&&(e=i(e,n));let a=e.slice().sort((h,f)=>h.from-f.from||h.to-f.to),s=new dr.RangeSetBuilder,o=[],l=0;for(let h=0;;){let f=h==a.length?null:a[h];if(!f&&!o.length)break;let c,d;for(o.length?(c=l,d=o.reduce((g,v)=>Math.min(g,v.to),f&&f.from>c?f.from:1e8)):(c=f.from,d=f.to,o.push(f),h++);h<a.length;){let g=a[h];if(g.from==c&&(g.to>g.from||g.to==c))o.push(g),h++,d=Math.min(g.to,d);else{d=Math.min(g.from,d);break}}let p=hE(o);if(o.some(g=>g.from==g.to||g.from==g.to-1&&n.doc.lineAt(g.from).to==g.from))s.add(c,c,Ft.Decoration.widget({widget:new im(p),diagnostics:o.slice()}));else{let g=o.reduce((v,m)=>m.markClass?v+" "+m.markClass:v,"");s.add(c,d,Ft.Decoration.mark({class:"cm-lintRange cm-lintRange-"+p+g,diagnostics:o.slice(),inclusiveEnd:o.some(v=>v.to>d)}))}l=d;for(let g=0;g<o.length;g++)o[g].to<=l&&o.splice(g--,1)}let u=s.finish();return new r(u,t,Os(u))}};function Os(r,e=null,t=0){let n=null;return r.between(t,1e9,(i,a,{spec:s})=>{if(!(e&&s.diagnostics.indexOf(e)<0))if(!n)n=new qf(i,a,e||s.diagnostics[0]);else{if(s.diagnostics.indexOf(n.diagnostic)<0)return!1;n=new qf(n.from,a,n.diagnostic)}}),n}function eE(r,e){let t=e.pos,n=e.end||t,i=r.state.facet(Ln).hideOn(r,t,n);if(i!=null)return i;let a=r.startState.doc.lineAt(e.pos);return!!(r.effects.some(s=>s.is(Ml))||r.changes.touchesRange(a.from,Math.max(a.to,n)))}function tE(r,e){return r.field(cr,!1)?e:e.concat(dr.StateEffect.appendConfig.of(cE))}function rE(r,e){return{effects:tE(r,[Ml.of(e)])}}var Ml=dr.StateEffect.define(),sm=dr.StateEffect.define(),nE=dr.StateEffect.define(),cr=dr.StateField.define({create(){return new Pa(Ft.Decoration.none,null,null)},update(r,e){if(e.docChanged&&r.diagnostics.size){let t=r.diagnostics.map(e.changes),n=null,i=r.panel;if(r.selected){let a=e.changes.mapPos(r.selected.from,1);n=Os(t,r.selected.diagnostic,a)||Os(t,null,a)}!t.size&&i&&e.state.facet(Ln).autoPanel&&(i=null),r=new Pa(t,i,n)}for(let t of e.effects)if(t.is(Ml)){let n=e.state.facet(Ln).autoPanel?t.value.length?Al.open:null:r.panel;r=Pa.init(t.value,n,e.state)}else t.is(sm)?r=new Pa(r.diagnostics,t.value?Al.open:null,r.selected):t.is(nE)&&(r=new Pa(r.diagnostics,r.panel,t.value));return r},provide:r=>[Ft.showPanel.from(r,e=>e.panel),Ft.EditorView.decorations.from(r,e=>e.diagnostics)]});function BW(r){let e=r.field(cr,!1);return e?e.diagnostics.size:0}var OW=Ft.Decoration.mark({class:"cm-lintRange cm-lintRange-active"});function RW(r,e,t){let{diagnostics:n}=r.state.field(cr),i,a=-1,s=-1;n.between(e-(t<0?1:0),e+(t>0?1:0),(l,u,{spec:h})=>{if(e>=l&&e<=u&&(l==u||(e>l||t>0)&&(e<u||t<0)))return i=h.diagnostics,a=l,s=u,!1});let o=r.state.facet(Ln).tooltipFilter;return i&&o&&(i=o(i,r.state)),i?{pos:a,end:s,above:r.state.doc.lineAt(a).to<s,create(){return{dom:iE(r,i)}}}:null}function iE(r,e){return Rn("ul",{class:"cm-tooltip-lint"},e.map(t=>uE(r,t,!1)))}var aE=r=>{let e=r.state.field(cr,!1);(!e||!e.panel)&&r.dispatch({effects:tE(r.state,[sm.of(!0)])});let t=Ft.getPanel(r,Al.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},nm=r=>{let e=r.state.field(cr,!1);return!e||!e.panel?!1:(r.dispatch({effects:sm.of(!1)}),!0)},sE=r=>{let e=r.state.field(cr,!1);if(!e)return!1;let t=r.state.selection.main,n=e.diagnostics.iter(t.to+1);return!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==t.from&&n.to==t.to)?!1:(r.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},LW=r=>{let{state:e}=r,t=e.field(cr,!1);if(!t)return!1;let n=e.selection.main,i,a,s,o;return t.diagnostics.between(0,e.doc.length,(l,u)=>{u<n.to&&(i==null||i<l)&&(i=l,a=u),(s==null||l>s)&&(s=l,o=u)}),s==null||i==null&&s==n.from?!1:(r.dispatch({selection:{anchor:i??s,head:a??o},scrollIntoView:!0}),!0)},IW=[{key:"Mod-Shift-m",run:aE,preventDefault:!0},{key:"F8",run:sE}],oE=Ft.ViewPlugin.fromClass(class{constructor(r){this.view=r,this.timeout=-1,this.set=!0;let{delay:e}=r.state.facet(Ln);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){clearTimeout(this.timeout);let r=Date.now();if(r<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-r);else{this.set=!1;let{state:e}=this.view,{sources:t}=e.facet(Ln);t.length&&NW(t.map(n=>Promise.resolve(n(this.view))),n=>{this.view.state.doc==e.doc&&this.view.dispatch(rE(this.view.state,n.reduce((i,a)=>i.concat(a))))},n=>{Ft.logException(this.view.state,n)})}}update(r){let e=r.state.facet(Ln);(r.docChanged||e!=r.startState.facet(Ln)||e.needsRefresh&&e.needsRefresh(r))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}});function NW(r,e,t){let n=[],i=-1;for(let a of r)a.then(s=>{n.push(s),clearTimeout(i),n.length==r.length?e(n):i=setTimeout(()=>e(n),200)},t)}var Ln=dr.Facet.define({combine(r){return Object.assign({sources:r.map(e=>e.source).filter(e=>e!=null)},dr.combineConfig(r.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,t)=>e?t?n=>e(n)||t(n):e:t}))}});function qW(r,e={}){return[Ln.of({source:r,config:e}),oE,cE]}function FW(r){let e=r.plugin(oE);e&&e.force()}function lE(r){let e=[];if(r)e:for(let{name:t}of r){for(let n=0;n<t.length;n++){let i=t[n];if(/[a-zA-Z]/.test(i)&&!e.some(a=>a.toLowerCase()==i.toLowerCase())){e.push(i);continue e}}e.push("")}return e}function uE(r,e,t){var n;let i=t?lE(e.actions):[];return Rn("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Rn("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(r):e.message),(n=e.actions)===null||n===void 0?void 0:n.map((a,s)=>{let o=!1,l=c=>{if(c.preventDefault(),o)return;o=!0;let d=Os(r.state.field(cr).diagnostics,e);d&&a.apply(r,d.from,d.to)},{name:u}=a,h=i[s]?u.indexOf(i[s]):-1,f=h<0?u:[u.slice(0,h),Rn("u",u.slice(h,h+1)),u.slice(h+1)];return Rn("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${u}${h<0?"":` (access key "${i[s]})"`}.`},f)}),e.source&&Rn("div",{class:"cm-diagnosticSource"},e.source))}var im=class extends Ft.WidgetType{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return Rn("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}},Ff=class{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=uE(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}},Al=class r{constructor(e){this.view=e,this.items=[];let t=i=>{if(i.keyCode==27)nm(this.view),this.view.focus();else if(i.keyCode==38||i.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(i.keyCode==40||i.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(i.keyCode==36)this.moveSelection(0);else if(i.keyCode==35)this.moveSelection(this.items.length-1);else if(i.keyCode==13)this.view.focus();else if(i.keyCode>=65&&i.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:a}=this.items[this.selectedIndex],s=lE(a.actions);for(let o=0;o<s.length;o++)if(s[o].toUpperCase().charCodeAt(0)==i.keyCode){let l=Os(this.view.state.field(cr).diagnostics,a);l&&a.actions[o].apply(e,l.from,l.to)}}else return;i.preventDefault()},n=i=>{for(let a=0;a<this.items.length;a++)this.items[a].dom.contains(i.target)&&this.moveSelection(a)};this.list=Rn("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:n}),this.dom=Rn("div",{class:"cm-panel-lint"},this.list,Rn("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>nm(this.view)},"\xD7")),this.update()}get selectedIndex(){let e=this.view.state.field(cr).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(cr),n=0,i=!1,a=null,s=new Set;for(e.between(0,this.view.state.doc.length,(o,l,{spec:u})=>{for(let h of u.diagnostics){if(s.has(h))continue;s.add(h);let f=-1,c;for(let d=n;d<this.items.length;d++)if(this.items[d].diagnostic==h){f=d;break}f<0?(c=new Ff(this.view,h),this.items.splice(n,0,c),i=!0):(c=this.items[f],f>n&&(this.items.splice(n,f-n),i=!0)),t&&c.diagnostic==t.diagnostic?c.dom.hasAttribute("aria-selected")||(c.dom.setAttribute("aria-selected","true"),a=c):c.dom.hasAttribute("aria-selected")&&c.dom.removeAttribute("aria-selected"),n++}});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)i=!0,this.items.pop();this.items.length==0&&(this.items.push(new Ff(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),i=!0),a?(this.list.setAttribute("aria-activedescendant",a.id),this.view.requestMeasure({key:this,read:()=>({sel:a.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:l})=>{let u=l.height/this.list.offsetHeight;o.top<l.top?this.list.scrollTop-=(l.top-o.top)/u:o.bottom>l.bottom&&(this.list.scrollTop+=(o.bottom-l.bottom)/u)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),i&&this.sync()}sync(){let e=this.list.firstChild;function t(){let n=e;e=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)t();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(cr),n=Os(t.diagnostics,this.items[e].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:nE.of(n)})}static open(e){return new r(e)}};function Nf(r,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(r)}</svg>')`}function If(r){return Nf(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${r}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}var _W=Ft.EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:If("#d11")},".cm-lintRange-warning":{backgroundImage:If("orange")},".cm-lintRange-info":{backgroundImage:If("#999")},".cm-lintRange-hint":{backgroundImage:If("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function zW(r){return r=="error"?4:r=="warning"?3:r=="info"?2:1}function hE(r){let e="hint",t=1;for(let n of r){let i=zW(n.severity);i>t&&(t=i,e=n.severity)}return e}var _f=class extends Ft.GutterMarker{constructor(e){super(),this.diagnostics=e,this.severity=hE(e)}toDOM(e){let t=document.createElement("div");t.className="cm-lint-marker cm-lint-marker-"+this.severity;let n=this.diagnostics,i=e.state.facet(zf).tooltipFilter;return i&&(n=i(n,e.state)),n.length&&(t.onmouseover=()=>HW(e,t,n)),t}};function VW(r,e){let t=n=>{let i=e.getBoundingClientRect();if(!(n.clientX>i.left-10&&n.clientX<i.right+10&&n.clientY>i.top-10&&n.clientY<i.bottom+10)){for(let a=n.target;a;a=a.parentNode)if(a.nodeType==1&&a.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",t),r.state.field(fE)&&r.dispatch({effects:om.of(null)})}};window.addEventListener("mousemove",t)}function HW(r,e,t){function n(){let s=r.elementAtHeight(e.getBoundingClientRect().top+5-r.documentTop);r.coordsAtPos(s.from)&&r.dispatch({effects:om.of({pos:s.from,above:!1,clip:!1,create(){return{dom:iE(r,t),getCoords:()=>e.getBoundingClientRect()}}})}),e.onmouseout=e.onmousemove=null,VW(r,e)}let{hoverTime:i}=r.state.facet(zf),a=setTimeout(n,i);e.onmouseout=()=>{clearTimeout(a),e.onmouseout=e.onmousemove=null},e.onmousemove=()=>{clearTimeout(a),a=setTimeout(n,i)}}function WW(r,e){let t=Object.create(null);for(let i of e){let a=r.lineAt(i.from);(t[a.from]||(t[a.from]=[])).push(i)}let n=[];for(let i in t)n.push(new _f(t[i]).range(+i));return dr.RangeSet.of(n,!0)}var GW=Ft.gutter({class:"cm-gutter-lint",markers:r=>r.state.field(am),widgetMarker:(r,e,t)=>{let n=[];return r.state.field(am).between(t.from,t.to,(i,a,s)=>{i>t.from&&i<t.to&&n.push(...s.diagnostics)}),n.length?new _f(n):null}}),am=dr.StateField.define({create(){return dr.RangeSet.empty},update(r,e){r=r.map(e.changes);let t=e.state.facet(zf).markerFilter;for(let n of e.effects)if(n.is(Ml)){let i=n.value;t&&(i=t(i||[],e.state)),r=WW(e.state.doc,i.slice(0))}return r}}),om=dr.StateEffect.define(),fE=dr.StateField.define({create(){return null},update(r,e){return r&&e.docChanged&&(r=eE(e,r)?null:Object.assign(Object.assign({},r),{pos:e.changes.mapPos(r.pos)})),e.effects.reduce((t,n)=>n.is(om)?n.value:t,r)},provide:r=>Ft.showTooltip.from(r)}),UW=Ft.EditorView.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:Nf('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:Nf('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:Nf('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),cE=[cr,Ft.EditorView.decorations.compute([cr],r=>{let{selected:e,panel:t}=r.field(cr);return!e||!t||e.from==e.to?Ft.Decoration.none:Ft.Decoration.set([OW.range(e.from,e.to)])}),Ft.hoverTooltip(RW,{hideOn:eE}),_W],zf=dr.Facet.define({combine(r){return dr.combineConfig(r,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function KW(r={}){return[zf.of(r),am,GW,UW,fE]}function jW(r,e){let t=r.field(cr,!1);if(t&&t.diagnostics.size){let n=[],i=[],a=-1;for(let s=dr.RangeSet.iter([t.diagnostics]);;s.next()){for(let o=0;o<n.length;o++)(!s.value||s.value.spec.diagnostics.indexOf(n[o])<0)&&(e(n[o],i[o],a),n.splice(o,1),i.splice(o--,1));if(!s.value)break;for(let o of s.value.spec.diagnostics)n.indexOf(o)<0&&(n.push(o),i.push(s.from));a=s.to}}}Vr.closeLintPanel=nm;Vr.diagnosticCount=BW;Vr.forEachDiagnostic=jW;Vr.forceLinting=FW;Vr.lintGutter=KW;Vr.lintKeymap=IW;Vr.linter=qW;Vr.nextDiagnostic=sE;Vr.openLintPanel=aE;Vr.previousDiagnostic=LW;Vr.setDiagnostics=rE;Vr.setDiagnosticsEffect=Ml});var gE=B(Dl=>{"use strict";Object.defineProperty(Dl,"__esModule",{value:!0});var Hr=Ti(),YW=bi(),Oi=af(),Rs=sk(),pE=xk(),Vf=Jk(),XW=dE(),$W=[Hr.lineNumbers(),Hr.highlightActiveLineGutter(),Hr.highlightSpecialChars(),Rs.history(),Oi.foldGutter(),Hr.drawSelection(),Hr.dropCursor(),YW.EditorState.allowMultipleSelections.of(!0),Oi.indentOnInput(),Oi.syntaxHighlighting(Oi.defaultHighlightStyle,{fallback:!0}),Oi.bracketMatching(),Vf.closeBrackets(),Vf.autocompletion(),Hr.rectangularSelection(),Hr.crosshairCursor(),Hr.highlightActiveLine(),pE.highlightSelectionMatches(),Hr.keymap.of([...Vf.closeBracketsKeymap,...Rs.defaultKeymap,...pE.searchKeymap,...Rs.historyKeymap,...Oi.foldKeymap,...Vf.completionKeymap,...XW.lintKeymap])],ZW=[Hr.highlightSpecialChars(),Rs.history(),Hr.drawSelection(),Oi.syntaxHighlighting(Oi.defaultHighlightStyle,{fallback:!0}),Hr.keymap.of([...Rs.defaultKeymap,...Rs.historyKeymap])];Object.defineProperty(Dl,"EditorView",{enumerable:!0,get:function(){return Hr.EditorView}});Dl.basicSetup=$W;Dl.minimalSetup=ZW});var BM=B((Uce,PM)=>{"use strict";function qy(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function QW(r){if(Array.isArray(r))return r}function JW(r){if(Array.isArray(r))return qy(r)}function Gi(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function eG(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,HA(n.key),n)}}function Ui(r,e,t){return e&&eG(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Lr(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=n0(r))||e){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,s=!0,o=!1;return{s:function(){t=t.call(r)},n:function(){var l=t.next();return s=l.done,l},e:function(l){o=!0,a=l},f:function(){try{s||t.return==null||t.return()}finally{if(o)throw a}}}}function VA(r,e,t){return(e=HA(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function tG(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function rG(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,i,a,s,o=[],l=!0,u=!1;try{if(a=(t=t.call(r)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=a.call(t)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(h){u=!0,i=h}finally{try{if(!l&&t.return!=null&&(s=t.return(),Object(s)!==s))return}finally{if(u)throw i}}return o}}function nG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zt(r,e){return QW(r)||rG(r,e)||n0(r,e)||nG()}function cc(r){return JW(r)||tG(r)||n0(r)||iG()}function aG(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function HA(r){var e=aG(r,"string");return typeof e=="symbol"?e:e+""}function Ht(r){"@babel/helpers - typeof";return Ht=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ht(r)}function n0(r,e){if(r){if(typeof r=="string")return qy(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?qy(r,e):void 0}}var _t=typeof window>"u"?null:window,vE=_t?_t.navigator:null;_t&&_t.document;var sG=Ht(""),WA=Ht({}),oG=Ht(function(){}),lG=typeof HTMLElement>"u"?"undefined":Ht(HTMLElement),Jl=function(e){return e&&e.instanceString&&kt(e.instanceString)?e.instanceString():null},be=function(e){return e!=null&&Ht(e)==sG},kt=function(e){return e!=null&&Ht(e)===oG},ft=function(e){return!Wr(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},$e=function(e){return e!=null&&Ht(e)===WA&&!ft(e)&&e.constructor===Object},uG=function(e){return e!=null&&Ht(e)===WA},se=function(e){return e!=null&&Ht(e)===Ht(1)&&!isNaN(e)},hG=function(e){return se(e)&&Math.floor(e)===e},dc=function(e){if(lG!=="undefined")return e!=null&&e instanceof HTMLElement},Wr=function(e){return eu(e)||GA(e)},eu=function(e){return Jl(e)==="collection"&&e._private.single},GA=function(e){return Jl(e)==="collection"&&!e._private.single},i0=function(e){return Jl(e)==="core"},UA=function(e){return Jl(e)==="stylesheet"},fG=function(e){return Jl(e)==="event"},Fi=function(e){return e==null?!0:!!(e===""||e.match(/^\s+$/))},cG=function(e){return typeof HTMLElement>"u"?!1:e instanceof HTMLElement},dG=function(e){return $e(e)&&se(e.x1)&&se(e.x2)&&se(e.y1)&&se(e.y2)},pG=function(e){return uG(e)&&kt(e.then)},gG=function(){return vE&&vE.userAgent.match(/msie|trident|edge/i)},Xs=function(e,t){t||(t=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var a=[],s=0;s<arguments.length;s++)a.push(arguments[s]);return a.join("$")});var n=function(){var a=this,s=arguments,o,l=t.apply(a,s),u=n.cache;return(o=u[l])||(o=u[l]=e.apply(a,s)),o};return n.cache={},n},a0=Xs(function(r){return r.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}),Tc=Xs(function(r){return r.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}),KA=Xs(function(r,e){return r+e[0].toUpperCase()+e.substring(1)},function(r,e){return r+"$"+e}),mE=function(e){return Fi(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},Vt="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",vG="rgb[a]?\\(("+Vt+"[%]?)\\s*,\\s*("+Vt+"[%]?)\\s*,\\s*("+Vt+"[%]?)(?:\\s*,\\s*("+Vt+"))?\\)",mG="rgb[a]?\\((?:"+Vt+"[%]?)\\s*,\\s*(?:"+Vt+"[%]?)\\s*,\\s*(?:"+Vt+"[%]?)(?:\\s*,\\s*(?:"+Vt+"))?\\)",yG="hsl[a]?\\(("+Vt+")\\s*,\\s*("+Vt+"[%])\\s*,\\s*("+Vt+"[%])(?:\\s*,\\s*("+Vt+"))?\\)",bG="hsl[a]?\\((?:"+Vt+")\\s*,\\s*(?:"+Vt+"[%])\\s*,\\s*(?:"+Vt+"[%])(?:\\s*,\\s*(?:"+Vt+"))?\\)",wG="\\#[0-9a-fA-F]{3}",xG="\\#[0-9a-fA-F]{6}",jA=function(e,t){return e<t?-1:e>t?1:0},SG=function(e,t){return-1*jA(e,t)},Ce=Object.assign!=null?Object.assign.bind(Object):function(r){for(var e=arguments,t=1;t<e.length;t++){var n=e[t];if(n!=null)for(var i=Object.keys(n),a=0;a<i.length;a++){var s=i[a];r[s]=n[s]}}return r},CG=function(e){if(!(!(e.length===4||e.length===7)||e[0]!=="#")){var t=e.length===4,n,i,a,s=16;return t?(n=parseInt(e[1]+e[1],s),i=parseInt(e[2]+e[2],s),a=parseInt(e[3]+e[3],s)):(n=parseInt(e[1]+e[2],s),i=parseInt(e[3]+e[4],s),a=parseInt(e[5]+e[6],s)),[n,i,a]}},kG=function(e){var t,n,i,a,s,o,l,u;function h(p,g,v){return v<0&&(v+=1),v>1&&(v-=1),v<1/6?p+(g-p)*6*v:v<1/2?g:v<2/3?p+(g-p)*(2/3-v)*6:p}var f=new RegExp("^"+yG+"$").exec(e);if(f){if(n=parseInt(f[1]),n<0?n=(360- -1*n%360)%360:n>360&&(n=n%360),n/=360,i=parseFloat(f[2]),i<0||i>100||(i=i/100,a=parseFloat(f[3]),a<0||a>100)||(a=a/100,s=f[4],s!==void 0&&(s=parseFloat(s),s<0||s>1)))return;if(i===0)o=l=u=Math.round(a*255);else{var c=a<.5?a*(1+i):a+i-a*i,d=2*a-c;o=Math.round(255*h(d,c,n+1/3)),l=Math.round(255*h(d,c,n)),u=Math.round(255*h(d,c,n-1/3))}t=[o,l,u,s]}return t},EG=function(e){var t,n=new RegExp("^"+vG+"$").exec(e);if(n){t=[];for(var i=[],a=1;a<=3;a++){var s=n[a];if(s[s.length-1]==="%"&&(i[a]=!0),s=parseFloat(s),i[a]&&(s=s/100*255),s<0||s>255)return;t.push(Math.floor(s))}var o=i[1]||i[2]||i[3],l=i[1]&&i[2]&&i[3];if(o&&!l)return;var u=n[4];if(u!==void 0){if(u=parseFloat(u),u<0||u>1)return;t.push(u)}}return t},TG=function(e){return AG[e.toLowerCase()]},YA=function(e){return(ft(e)?e:null)||TG(e)||CG(e)||EG(e)||kG(e)},AG={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},XA=function(e){for(var t=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var s=n[a];if($e(s))throw Error("Tried to set map with object key");a<n.length-1?(t[s]==null&&(t[s]={}),t=t[s]):t[s]=e.value}},$A=function(e){for(var t=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var s=n[a];if($e(s))throw Error("Tried to get map with object key");if(t=t[s],t==null)return t}return t},Hf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tu(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var lm,yE;function ru(){if(yE)return lm;yE=1;function r(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return lm=r,lm}var um,bE;function MG(){if(bE)return um;bE=1;var r=typeof Hf=="object"&&Hf&&Hf.Object===Object&&Hf;return um=r,um}var hm,wE;function Ac(){if(wE)return hm;wE=1;var r=MG(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=r||e||Function("return this")();return hm=t,hm}var fm,xE;function DG(){if(xE)return fm;xE=1;var r=Ac(),e=function(){return r.Date.now()};return fm=e,fm}var cm,SE;function PG(){if(SE)return cm;SE=1;var r=/\s/;function e(t){for(var n=t.length;n--&&r.test(t.charAt(n)););return n}return cm=e,cm}var dm,CE;function BG(){if(CE)return dm;CE=1;var r=PG(),e=/^\s+/;function t(n){return n&&n.slice(0,r(n)+1).replace(e,"")}return dm=t,dm}var pm,kE;function s0(){if(kE)return pm;kE=1;var r=Ac(),e=r.Symbol;return pm=e,pm}var gm,EE;function OG(){if(EE)return gm;EE=1;var r=s0(),e=Object.prototype,t=e.hasOwnProperty,n=e.toString,i=r?r.toStringTag:void 0;function a(s){var o=t.call(s,i),l=s[i];try{s[i]=void 0;var u=!0}catch{}var h=n.call(s);return u&&(o?s[i]=l:delete s[i]),h}return gm=a,gm}var vm,TE;function RG(){if(TE)return vm;TE=1;var r=Object.prototype,e=r.toString;function t(n){return e.call(n)}return vm=t,vm}var mm,AE;function ZA(){if(AE)return mm;AE=1;var r=s0(),e=OG(),t=RG(),n="[object Null]",i="[object Undefined]",a=r?r.toStringTag:void 0;function s(o){return o==null?o===void 0?i:n:a&&a in Object(o)?e(o):t(o)}return mm=s,mm}var ym,ME;function LG(){if(ME)return ym;ME=1;function r(e){return e!=null&&typeof e=="object"}return ym=r,ym}var bm,DE;function nu(){if(DE)return bm;DE=1;var r=ZA(),e=LG(),t="[object Symbol]";function n(i){return typeof i=="symbol"||e(i)&&r(i)==t}return bm=n,bm}var wm,PE;function IG(){if(PE)return wm;PE=1;var r=BG(),e=ru(),t=nu(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function l(u){if(typeof u=="number")return u;if(t(u))return n;if(e(u)){var h=typeof u.valueOf=="function"?u.valueOf():u;u=e(h)?h+"":h}if(typeof u!="string")return u===0?u:+u;u=r(u);var f=a.test(u);return f||s.test(u)?o(u.slice(2),f?2:8):i.test(u)?n:+u}return wm=l,wm}var xm,BE;function NG(){if(BE)return xm;BE=1;var r=ru(),e=DG(),t=IG(),n="Expected a function",i=Math.max,a=Math.min;function s(o,l,u){var h,f,c,d,p,g,v=0,m=!1,y=!1,b=!0;if(typeof o!="function")throw new TypeError(n);l=t(l)||0,r(u)&&(m=!!u.leading,y="maxWait"in u,c=y?i(t(u.maxWait)||0,l):c,b="trailing"in u?!!u.trailing:b);function w(M){var O=h,R=f;return h=f=void 0,v=M,d=o.apply(R,O),d}function S(M){return v=M,p=setTimeout(A,l),m?w(M):d}function C(M){var O=M-g,R=M-v,L=l-O;return y?a(L,c-R):L}function x(M){var O=M-g,R=M-v;return g===void 0||O>=l||O<0||y&&R>=c}function A(){var M=e();if(x(M))return T(M);p=setTimeout(A,C(M))}function T(M){return p=void 0,b&&h?w(M):(h=f=void 0,d)}function D(){p!==void 0&&clearTimeout(p),v=0,h=g=f=p=void 0}function k(){return p===void 0?d:T(e())}function E(){var M=e(),O=x(M);if(h=arguments,f=this,g=M,O){if(p===void 0)return S(g);if(y)return clearTimeout(p),p=setTimeout(A,l),w(g)}return p===void 0&&(p=setTimeout(A,l)),d}return E.cancel=D,E.flush=k,E}return xm=s,xm}var qG=NG(),iu=tu(qG),Sm=_t?_t.performance:null,QA=Sm&&Sm.now?function(){return Sm.now()}:function(){return Date.now()},FG=function(){if(_t){if(_t.requestAnimationFrame)return function(r){_t.requestAnimationFrame(r)};if(_t.mozRequestAnimationFrame)return function(r){_t.mozRequestAnimationFrame(r)};if(_t.webkitRequestAnimationFrame)return function(r){_t.webkitRequestAnimationFrame(r)};if(_t.msRequestAnimationFrame)return function(r){_t.msRequestAnimationFrame(r)}}return function(r){r&&setTimeout(function(){r(QA())},1e3/60)}}(),pc=function(e){return FG(e)},ai=QA,qa=9261,JA=65599,Vs=5381,e2=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qa,n=t,i;i=e.next(),!i.done;)n=n*JA+i.value|0;return n},Wl=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qa;return t*JA+e|0},Gl=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vs;return(t<<5)+t+e|0},_G=function(e,t){return e*2097152+t},Ri=function(e){return e[0]*2097152+e[1]},Wf=function(e,t){return[Wl(e[0],t[0]),Gl(e[1],t[1])]},OE=function(e,t){var n={value:0,done:!1},i=0,a=e.length,s={next:function(){return i<a?n.value=e[i++]:n.done=!0,n}};return e2(s,t)},za=function(e,t){var n={value:0,done:!1},i=0,a=e.length,s={next:function(){return i<a?n.value=e.charCodeAt(i++):n.done=!0,n}};return e2(s,t)},t2=function(){return zG(arguments)},zG=function(e){for(var t,n=0;n<e.length;n++){var i=e[n];n===0?t=za(i):t=za(i,t)}return t},RE=!0,VG=console.warn!=null,HG=console.trace!=null,o0=Number.MAX_SAFE_INTEGER||9007199254740991,r2=function(){return!0},gc=function(){return!1},LE=function(){return 0},l0=function(){},Ct=function(e){throw new Error(e)},n2=function(e){if(e!==void 0)RE=!!e;else return RE},it=function(e){n2()&&(VG?console.warn(e):(console.log(e),HG&&console.trace()))},WG=function(e){return Ce({},e)},Fn=function(e){return e==null?e:ft(e)?e.slice():$e(e)?WG(e):e},GG=function(e){return e.slice()},i2=function(e,t){for(t=e="";e++<36;t+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return t},UG={},a2=function(){return UG},ar=function(e){var t=Object.keys(e);return function(n){for(var i={},a=0;a<t.length;a++){var s=t[a],o=n?.[s];i[s]=o===void 0?e[s]:o}return i}},_i=function(e,t,n){for(var i=e.length-1;i>=0;i--)e[i]===t&&e.splice(i,1)},u0=function(e){e.splice(0,e.length)},KG=function(e,t){for(var n=0;n<t.length;n++){var i=t[n];e.push(i)}},Or=function(e,t,n){return n&&(t=KA(n,t)),e[t]},ni=function(e,t,n,i){n&&(t=KA(n,t)),e[t]=i},jG=function(){function r(){Gi(this,r),this._obj={}}return Ui(r,[{key:"set",value:function(t,n){return this._obj[t]=n,this}},{key:"delete",value:function(t){return this._obj[t]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(t){return this._obj[t]!==void 0}},{key:"get",value:function(t){return this._obj[t]}}])}(),ii=typeof Map<"u"?Map:jG,YG="undefined",XG=function(){function r(e){if(Gi(this,r),this._obj=Object.create(null),this.size=0,e!=null){var t;e.instanceString!=null&&e.instanceString()===this.instanceString()?t=e.toArray():t=e;for(var n=0;n<t.length;n++)this.add(t[n])}}return Ui(r,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(t){var n=this._obj;n[t]!==1&&(n[t]=1,this.size++)}},{key:"delete",value:function(t){var n=this._obj;n[t]===1&&(n[t]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(t){return this._obj[t]===1}},{key:"toArray",value:function(){var t=this;return Object.keys(this._obj).filter(function(n){return t.has(n)})}},{key:"forEach",value:function(t,n){return this.toArray().forEach(t,n)}}])}(),Js=(typeof Set>"u"?"undefined":Ht(Set))!==YG?Set:XG,Mc=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e===void 0||t===void 0||!i0(e)){Ct("An element must have a core reference and parameters set");return}var i=t.group;if(i==null&&(t.data&&t.data.source!=null&&t.data.target!=null?i="edges":i="nodes"),i!=="nodes"&&i!=="edges"){Ct("An element must be of type `nodes` or `edges`; you specified `"+i+"`");return}this.length=1,this[0]=this;var a=this._private={cy:e,single:!0,data:t.data||{},position:t.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:i,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!t.selected,selectable:t.selectable===void 0?!0:!!t.selectable,locked:!!t.locked,grabbed:!1,grabbable:t.grabbable===void 0?!0:!!t.grabbable,pannable:t.pannable===void 0?i==="edges":!!t.pannable,active:!1,classes:new Js,animation:{current:[],queue:[]},rscratch:{},scratch:t.scratch||{},edges:[],children:[],parent:t.parent&&t.parent.isNode()?t.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(a.position.x==null&&(a.position.x=0),a.position.y==null&&(a.position.y=0),t.renderedPosition){var s=t.renderedPosition,o=e.pan(),l=e.zoom();a.position={x:(s.x-o.x)/l,y:(s.y-o.y)/l}}var u=[];ft(t.classes)?u=t.classes:be(t.classes)&&(u=t.classes.split(/\s+/));for(var h=0,f=u.length;h<f;h++){var c=u[h];!c||c===""||a.classes.add(c)}this.createEmitter(),(n===void 0||n)&&this.restore();var d=t.style||t.css;d&&(it("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(d))},IE=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(n,i,a){var s;$e(n)&&!Wr(n)&&(s=n,n=s.roots||s.root,i=s.visit,a=s.directed),a=arguments.length===2&&!kt(i)?i:a,i=kt(i)?i:function(){};for(var o=this._private.cy,l=n=be(n)?this.filter(n):n,u=[],h=[],f={},c={},d={},p=0,g,v=this.byGroup(),m=v.nodes,y=v.edges,b=0;b<l.length;b++){var w=l[b],S=w.id();w.isNode()&&(u.unshift(w),e.bfs&&(d[S]=!0,h.push(w)),c[S]=0)}for(var C=function(){var M=e.bfs?u.shift():u.pop(),O=M.id();if(e.dfs){if(d[O])return 0;d[O]=!0,h.push(M)}var R=c[O],L=f[O],I=L!=null?L.source():null,N=L!=null?L.target():null,q=L==null?void 0:M.same(I)?N[0]:I[0],z;if(z=i(M,L,q,p++,R),z===!0)return g=M,1;if(z===!1)return 1;for(var F=M.connectedEdges().filter(function(Q){return(!a||Q.source().same(M))&&y.has(Q)}),_=0;_<F.length;_++){var U=F[_],X=U.connectedNodes().filter(function(Q){return!Q.same(M)&&m.has(Q)}),$=X.id();X.length!==0&&!d[$]&&(X=X[0],u.push(X),e.bfs&&(d[$]=!0,h.push(X)),f[$]=U,c[$]=c[O]+1)}},x;u.length!==0&&(x=C(),!(x!==0&&x===1)););for(var A=o.collection(),T=0;T<h.length;T++){var D=h[T],k=f[D.id()];k!=null&&A.push(k),A.push(D)}return{path:o.collection(A),found:o.collection(g)}}},Ul={breadthFirstSearch:IE({bfs:!0}),depthFirstSearch:IE({dfs:!0})};Ul.bfs=Ul.breadthFirstSearch;Ul.dfs=Ul.depthFirstSearch;var tc={exports:{}},$G=tc.exports,NE;function ZG(){return NE||(NE=1,function(r,e){(function(){var t,n,i,a,s,o,l,u,h,f,c,d,p,g,v;i=Math.floor,f=Math.min,n=function(m,y){return m<y?-1:m>y?1:0},h=function(m,y,b,w,S){var C;if(b==null&&(b=0),S==null&&(S=n),b<0)throw new Error("lo must be non-negative");for(w==null&&(w=m.length);b<w;)C=i((b+w)/2),S(y,m[C])<0?w=C:b=C+1;return[].splice.apply(m,[b,b-b].concat(y)),y},o=function(m,y,b){return b==null&&(b=n),m.push(y),g(m,0,m.length-1,b)},s=function(m,y){var b,w;return y==null&&(y=n),b=m.pop(),m.length?(w=m[0],m[0]=b,v(m,0,y)):w=b,w},u=function(m,y,b){var w;return b==null&&(b=n),w=m[0],m[0]=y,v(m,0,b),w},l=function(m,y,b){var w;return b==null&&(b=n),m.length&&b(m[0],y)<0&&(w=[m[0],y],y=w[0],m[0]=w[1],v(m,0,b)),y},a=function(m,y){var b,w,S,C,x,A;for(y==null&&(y=n),C=function(){A=[];for(var T=0,D=i(m.length/2);0<=D?T<D:T>D;0<=D?T++:T--)A.push(T);return A}.apply(this).reverse(),x=[],w=0,S=C.length;w<S;w++)b=C[w],x.push(v(m,b,y));return x},p=function(m,y,b){var w;if(b==null&&(b=n),w=m.indexOf(y),w!==-1)return g(m,0,w,b),v(m,w,b)},c=function(m,y,b){var w,S,C,x,A;if(b==null&&(b=n),S=m.slice(0,y),!S.length)return S;for(a(S,b),A=m.slice(y),C=0,x=A.length;C<x;C++)w=A[C],l(S,w,b);return S.sort(b).reverse()},d=function(m,y,b){var w,S,C,x,A,T,D,k,E;if(b==null&&(b=n),y*10<=m.length){if(C=m.slice(0,y).sort(b),!C.length)return C;for(S=C[C.length-1],D=m.slice(y),x=0,T=D.length;x<T;x++)w=D[x],b(w,S)<0&&(h(C,w,0,null,b),C.pop(),S=C[C.length-1]);return C}for(a(m,b),E=[],A=0,k=f(y,m.length);0<=k?A<k:A>k;0<=k?++A:--A)E.push(s(m,b));return E},g=function(m,y,b,w){var S,C,x;for(w==null&&(w=n),S=m[b];b>y;){if(x=b-1>>1,C=m[x],w(S,C)<0){m[b]=C,b=x;continue}break}return m[b]=S},v=function(m,y,b){var w,S,C,x,A;for(b==null&&(b=n),S=m.length,A=y,C=m[y],w=2*y+1;w<S;)x=w+1,x<S&&!(b(m[w],m[x])<0)&&(w=x),m[y]=m[w],y=w,w=2*y+1;return m[y]=C,g(m,A,y,b)},t=function(){m.push=o,m.pop=s,m.replace=u,m.pushpop=l,m.heapify=a,m.updateItem=p,m.nlargest=c,m.nsmallest=d;function m(y){this.cmp=y??n,this.nodes=[]}return m.prototype.push=function(y){return o(this.nodes,y,this.cmp)},m.prototype.pop=function(){return s(this.nodes,this.cmp)},m.prototype.peek=function(){return this.nodes[0]},m.prototype.contains=function(y){return this.nodes.indexOf(y)!==-1},m.prototype.replace=function(y){return u(this.nodes,y,this.cmp)},m.prototype.pushpop=function(y){return l(this.nodes,y,this.cmp)},m.prototype.heapify=function(){return a(this.nodes,this.cmp)},m.prototype.updateItem=function(y){return p(this.nodes,y,this.cmp)},m.prototype.clear=function(){return this.nodes=[]},m.prototype.empty=function(){return this.nodes.length===0},m.prototype.size=function(){return this.nodes.length},m.prototype.clone=function(){var y;return y=new m,y.nodes=this.nodes.slice(0),y},m.prototype.toArray=function(){return this.nodes.slice(0)},m.prototype.insert=m.prototype.push,m.prototype.top=m.prototype.peek,m.prototype.front=m.prototype.peek,m.prototype.has=m.prototype.contains,m.prototype.copy=m.prototype.clone,m}(),function(m,y){return r.exports=y()}(this,function(){return t})}).call($G)}(tc)),tc.exports}var Cm,qE;function QG(){return qE||(qE=1,Cm=ZG()),Cm}var JG=QG(),au=tu(JG),e8=ar({root:null,weight:function(e){return 1},directed:!1}),t8={dijkstra:function(e){if(!$e(e)){var t=arguments;e={root:t[0],weight:t[1],directed:t[2]}}var n=e8(e),i=n.root,a=n.weight,s=n.directed,o=this,l=a,u=be(i)?this.filter(i)[0]:i[0],h={},f={},c={},d=this.byGroup(),p=d.nodes,g=d.edges;g.unmergeBy(function(R){return R.isLoop()});for(var v=function(L){return h[L.id()]},m=function(L,I){h[L.id()]=I,y.updateItem(L)},y=new au(function(R,L){return v(R)-v(L)}),b=0;b<p.length;b++){var w=p[b];h[w.id()]=w.same(u)?0:1/0,y.push(w)}for(var S=function(L,I){for(var N=(s?L.edgesTo(I):L.edgesWith(I)).intersect(g),q=1/0,z,F=0;F<N.length;F++){var _=N[F],U=l(_);(U<q||!z)&&(q=U,z=_)}return{edge:z,dist:q}};y.size()>0;){var C=y.pop(),x=v(C),A=C.id();if(c[A]=x,x!==1/0)for(var T=C.neighborhood().intersect(p),D=0;D<T.length;D++){var k=T[D],E=k.id(),M=S(C,k),O=x+M.dist;O<v(k)&&(m(k,O),f[E]={node:C,edge:M.edge})}}return{distanceTo:function(L){var I=be(L)?p.filter(L)[0]:L[0];return c[I.id()]},pathTo:function(L){var I=be(L)?p.filter(L)[0]:L[0],N=[],q=I,z=q.id();if(I.length>0)for(N.unshift(I);f[z];){var F=f[z];N.unshift(F.edge),N.unshift(F.node),q=F.node,z=q.id()}return o.spawn(N)}}}},r8={kruskal:function(e){e=e||function(b){return 1};for(var t=this.byGroup(),n=t.nodes,i=t.edges,a=n.length,s=new Array(a),o=n,l=function(w){for(var S=0;S<s.length;S++){var C=s[S];if(C.has(w))return S}},u=0;u<a;u++)s[u]=this.spawn(n[u]);for(var h=i.sort(function(b,w){return e(b)-e(w)}),f=0;f<h.length;f++){var c=h[f],d=c.source()[0],p=c.target()[0],g=l(d),v=l(p),m=s[g],y=s[v];g!==v&&(o.merge(c),m.merge(y),s.splice(v,1))}return o}},n8=ar({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),i8={aStar:function(e){var t=this.cy(),n=n8(e),i=n.root,a=n.goal,s=n.heuristic,o=n.directed,l=n.weight;i=t.collection(i)[0],a=t.collection(a)[0];var u=i.id(),h=a.id(),f={},c={},d={},p=new au(function(z,F){return c[z.id()]-c[F.id()]}),g=new Js,v={},m={},y=function(F,_){p.push(F),g.add(_)},b,w,S=function(){b=p.pop(),w=b.id(),g.delete(w)},C=function(F){return g.has(F)};y(i,u),f[u]=0,c[u]=s(i);for(var x=0;p.size()>0;){if(S(),x++,w===h){for(var A=[],T=a,D=h,k=m[D];A.unshift(T),k!=null&&A.unshift(k),T=v[D],T!=null;)D=T.id(),k=m[D];return{found:!0,distance:f[w],path:this.spawn(A),steps:x}}d[w]=!0;for(var E=b._private.edges,M=0;M<E.length;M++){var O=E[M];if(this.hasElementWithId(O.id())&&!(o&&O.data("source")!==w)){var R=O.source(),L=O.target(),I=R.id()!==w?R:L,N=I.id();if(this.hasElementWithId(N)&&!d[N]){var q=f[w]+l(O);if(!C(N)){f[N]=q,c[N]=q+s(I),y(I,N),v[N]=b,m[N]=O;continue}q<f[N]&&(f[N]=q,c[N]=q+s(I),v[N]=b,m[N]=O)}}}}return{found:!1,distance:void 0,path:void 0,steps:x}}},a8=ar({weight:function(e){return 1},directed:!1}),s8={floydWarshall:function(e){for(var t=this.cy(),n=a8(e),i=n.weight,a=n.directed,s=i,o=this.byGroup(),l=o.nodes,u=o.edges,h=l.length,f=h*h,c=function(U){return l.indexOf(U)},d=function(U){return l[U]},p=new Array(f),g=0;g<f;g++){var v=g%h,m=(g-v)/h;m===v?p[g]=0:p[g]=1/0}for(var y=new Array(f),b=new Array(f),w=0;w<u.length;w++){var S=u[w],C=S.source()[0],x=S.target()[0];if(C!==x){var A=c(C),T=c(x),D=A*h+T,k=s(S);if(p[D]>k&&(p[D]=k,y[D]=T,b[D]=S),!a){var E=T*h+A;!a&&p[E]>k&&(p[E]=k,y[E]=A,b[E]=S)}}}for(var M=0;M<h;M++)for(var O=0;O<h;O++)for(var R=O*h+M,L=0;L<h;L++){var I=O*h+L,N=M*h+L;p[R]+p[N]<p[I]&&(p[I]=p[R]+p[N],y[I]=y[R])}var q=function(U){return(be(U)?t.filter(U):U)[0]},z=function(U){return c(q(U))},F={distance:function(U,X){var $=z(U),Q=z(X);return p[$*h+Q]},path:function(U,X){var $=z(U),Q=z(X),ee=d($);if($===Q)return ee.collection();if(y[$*h+Q]==null)return t.collection();var oe=t.collection(),te=$,V;for(oe.merge(ee);$!==Q;)te=$,$=y[$*h+Q],V=b[te*h+$],oe.merge(V),oe.merge(d($));return oe}};return F}},o8=ar({weight:function(e){return 1},directed:!1,root:null}),l8={bellmanFord:function(e){var t=this,n=o8(e),i=n.weight,a=n.directed,s=n.root,o=i,l=this,u=this.cy(),h=this.byGroup(),f=h.edges,c=h.nodes,d=c.length,p=new ii,g=!1,v=[];s=u.collection(s)[0],f.unmergeBy(function(at){return at.isLoop()});for(var m=f.length,y=function(ce){var de=p.get(ce.id());return de||(de={},p.set(ce.id(),de)),de},b=function(ce){return(be(ce)?u.$(ce):ce)[0]},w=function(ce){return y(b(ce)).dist},S=function(ce){for(var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s,xe=b(ce),ke=[],Se=xe;;){if(Se==null)return t.spawn();var Te=y(Se),Pe=Te.edge,Ke=Te.pred;if(ke.unshift(Se[0]),Se.same(de)&&ke.length>0)break;Pe!=null&&ke.unshift(Pe),Se=Ke}return l.spawn(ke)},C=0;C<d;C++){var x=c[C],A=y(x);x.same(s)?A.dist=0:A.dist=1/0,A.pred=null,A.edge=null}for(var T=!1,D=function(ce,de,xe,ke,Se,Te){var Pe=ke.dist+Te;Pe<Se.dist&&!xe.same(ke.edge)&&(Se.dist=Pe,Se.pred=ce,Se.edge=xe,T=!0)},k=1;k<d;k++){T=!1;for(var E=0;E<m;E++){var M=f[E],O=M.source(),R=M.target(),L=o(M),I=y(O),N=y(R);D(O,R,M,I,N,L),a||D(R,O,M,N,I,L)}if(!T)break}if(T)for(var q=[],z=0;z<m;z++){var F=f[z],_=F.source(),U=F.target(),X=o(F),$=y(_).dist,Q=y(U).dist;if($+X<Q||!a&&Q+X<$)if(g||(it("Graph contains a negative weight cycle for Bellman-Ford"),g=!0),e.findNegativeWeightCycles!==!1){var ee=[];$+X<Q&&ee.push(_),!a&&Q+X<$&&ee.push(U);for(var oe=ee.length,te=0;te<oe;te++){var V=ee[te],W=[V];W.push(y(V).edge);for(var K=y(V).pred;W.indexOf(K)===-1;)W.push(K),W.push(y(K).edge),K=y(K).pred;W=W.slice(W.indexOf(K));for(var ie=W[0].id(),ue=0,Me=2;Me<W.length;Me+=2)W[Me].id()<ie&&(ie=W[Me].id(),ue=Me);W=W.slice(ue).concat(W.slice(0,ue)),W.push(W[0]);var bt=W.map(function(at){return at.id()}).join(",");q.indexOf(bt)===-1&&(v.push(l.spawn(W)),q.push(bt))}}else break}return{distanceTo:w,pathTo:S,hasNegativeWeightCycle:g,negativeWeightCycles:v}}},u8=Math.sqrt(2),h8=function(e,t,n){n.length===0&&Ct("Karger-Stein must be run on a connected (sub)graph");for(var i=n[e],a=i[1],s=i[2],o=t[a],l=t[s],u=n,h=u.length-1;h>=0;h--){var f=u[h],c=f[1],d=f[2];(t[c]===o&&t[d]===l||t[c]===l&&t[d]===o)&&u.splice(h,1)}for(var p=0;p<u.length;p++){var g=u[p];g[1]===l?(u[p]=g.slice(),u[p][1]=o):g[2]===l&&(u[p]=g.slice(),u[p][2]=o)}for(var v=0;v<t.length;v++)t[v]===l&&(t[v]=o);return u},km=function(e,t,n,i){for(;n>i;){var a=Math.floor(Math.random()*t.length);t=h8(a,e,t),n--}return t},f8={kargerStein:function(){var e=this,t=this.byGroup(),n=t.nodes,i=t.edges;i.unmergeBy(function(N){return N.isLoop()});var a=n.length,s=i.length,o=Math.ceil(Math.pow(Math.log(a)/Math.LN2,2)),l=Math.floor(a/u8);if(a<2){Ct("At least 2 nodes are required for Karger-Stein algorithm");return}for(var u=[],h=0;h<s;h++){var f=i[h];u.push([h,n.indexOf(f.source()),n.indexOf(f.target())])}for(var c=1/0,d=[],p=new Array(a),g=new Array(a),v=new Array(a),m=function(q,z){for(var F=0;F<a;F++)z[F]=q[F]},y=0;y<=o;y++){for(var b=0;b<a;b++)g[b]=b;var w=km(g,u.slice(),a,l),S=w.slice();m(g,v);var C=km(g,w,l,2),x=km(v,S,l,2);C.length<=x.length&&C.length<c?(c=C.length,d=C,m(g,p)):x.length<=C.length&&x.length<c&&(c=x.length,d=x,m(v,p))}for(var A=this.spawn(d.map(function(N){return i[N[0]]})),T=this.spawn(),D=this.spawn(),k=p[0],E=0;E<p.length;E++){var M=p[E],O=n[E];M===k?T.merge(O):D.merge(O)}var R=function(q){var z=e.spawn();return q.forEach(function(F){z.merge(F),F.connectedEdges().forEach(function(_){e.contains(_)&&!A.contains(_)&&z.merge(_)})}),z},L=[R(T),R(D)],I={cut:A,components:L,partition1:T,partition2:D};return I}},c8=function(e){return{x:e.x,y:e.y}},Dc=function(e,t,n){return{x:e.x*t+n.x,y:e.y*t+n.y}},s2=function(e,t,n){return{x:(e.x-n.x)/t,y:(e.y-n.y)/t}},Hs=function(e){return{x:e[0],y:e[1]}},d8=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=1/0,a=t;a<n;a++){var s=e[a];isFinite(s)&&(i=Math.min(s,i))}return i},p8=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=-1/0,a=t;a<n;a++){var s=e[a];isFinite(s)&&(i=Math.max(s,i))}return i},g8=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=0,a=0,s=t;s<n;s++){var o=e[s];isFinite(o)&&(i+=o,a++)}return i/a},v8=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;i?e=e.slice(t,n):(n<e.length&&e.splice(n,e.length-n),t>0&&e.splice(0,t));for(var o=0,l=e.length-1;l>=0;l--){var u=e[l];s?isFinite(u)||(e[l]=-1/0,o++):e.splice(l,1)}a&&e.sort(function(c,d){return c-d});var h=e.length,f=Math.floor(h/2);return h%2!==0?e[f+1+o]:(e[f-1+o]+e[f+o])/2},m8=function(e){return Math.PI*e/180},Gf=function(e,t){return Math.atan2(t,e)-Math.PI/2},h0=Math.log2||function(r){return Math.log(r)/Math.log(2)},f0=function(e){return e>0?1:e<0?-1:0},Va=function(e,t){return Math.sqrt(La(e,t))},La=function(e,t){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i},y8=function(e){for(var t=e.length,n=0,i=0;i<t;i++)n+=e[i];for(var a=0;a<t;a++)e[a]=e[a]/n;return e},jt=function(e,t,n,i){return(1-i)*(1-i)*e+2*(1-i)*i*t+i*i*n},Us=function(e,t,n,i){return{x:jt(e.x,t.x,n.x,i),y:jt(e.y,t.y,n.y,i)}},b8=function(e,t,n,i){var a={x:t.x-e.x,y:t.y-e.y},s=Va(e,t),o={x:a.x/s,y:a.y/s};return n=n??0,i=i??n*s,{x:e.x+o.x*i,y:e.y+o.y*i}},Kl=function(e,t,n){return Math.max(e,Math.min(n,t))},Ir=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},w8=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}},x8=function(e){e.x1=1/0,e.y1=1/0,e.x2=-1/0,e.y2=-1/0,e.w=0,e.h=0},S8=function(e,t,n){return{x1:e.x1+t,x2:e.x2+t,y1:e.y1+n,y2:e.y2+n,w:e.w,h:e.h}},o2=function(e,t){e.x1=Math.min(e.x1,t.x1),e.x2=Math.max(e.x2,t.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,t.y1),e.y2=Math.max(e.y2,t.y2),e.h=e.y2-e.y1},C8=function(e,t,n){e.x1=Math.min(e.x1,t),e.x2=Math.max(e.x2,t),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,n),e.y2=Math.max(e.y2,n),e.h=e.y2-e.y1},rc=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=t,e.x2+=t,e.y1-=t,e.y2+=t,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},nc=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],n,i,a,s;if(t.length===1)n=i=a=s=t[0];else if(t.length===2)n=a=t[0],s=i=t[1];else if(t.length===4){var o=zt(t,4);n=o[0],i=o[1],a=o[2],s=o[3]}return e.x1-=s,e.x2+=i,e.y1-=n,e.y2+=a,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},FE=function(e,t){e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},c0=function(e,t){return!(e.x1>t.x2||t.x1>e.x2||e.x2<t.x1||t.x2<e.x1||e.y2<t.y1||t.y2<e.y1||e.y1>t.y2||t.y1>e.y2)},$s=function(e,t,n){return e.x1<=t&&t<=e.x2&&e.y1<=n&&n<=e.y2},k8=function(e,t){return $s(e,t.x,t.y)},E8=function(e,t){return $s(e,t.x1,t.y1)&&$s(e,t.x2,t.y2)},l2=function(e,t,n,i,a,s,o){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",u=l==="auto"?zi(a,s):l,h=a/2,f=s/2;u=Math.min(u,h,f);var c=u!==h,d=u!==f,p;if(c){var g=n-h+u-o,v=i-f-o,m=n+h-u+o,y=v;if(p=Ii(e,t,n,i,g,v,m,y,!1),p.length>0)return p}if(d){var b=n+h+o,w=i-f+u-o,S=b,C=i+f-u+o;if(p=Ii(e,t,n,i,b,w,S,C,!1),p.length>0)return p}if(c){var x=n-h+u-o,A=i+f+o,T=n+h-u+o,D=A;if(p=Ii(e,t,n,i,x,A,T,D,!1),p.length>0)return p}if(d){var k=n-h-o,E=i-f+u-o,M=k,O=i+f-u+o;if(p=Ii(e,t,n,i,k,E,M,O,!1),p.length>0)return p}var R;{var L=n-h+u,I=i-f+u;if(R=ql(e,t,n,i,L,I,u+o),R.length>0&&R[0]<=L&&R[1]<=I)return[R[0],R[1]]}{var N=n+h-u,q=i-f+u;if(R=ql(e,t,n,i,N,q,u+o),R.length>0&&R[0]>=N&&R[1]<=q)return[R[0],R[1]]}{var z=n+h-u,F=i+f-u;if(R=ql(e,t,n,i,z,F,u+o),R.length>0&&R[0]>=z&&R[1]>=F)return[R[0],R[1]]}{var _=n-h+u,U=i+f-u;if(R=ql(e,t,n,i,_,U,u+o),R.length>0&&R[0]<=_&&R[1]>=U)return[R[0],R[1]]}return[]},T8=function(e,t,n,i,a,s,o){var l=o,u=Math.min(n,a),h=Math.max(n,a),f=Math.min(i,s),c=Math.max(i,s);return u-l<=e&&e<=h+l&&f-l<=t&&t<=c+l},A8=function(e,t,n,i,a,s,o,l,u){var h={x1:Math.min(n,o,a)-u,x2:Math.max(n,o,a)+u,y1:Math.min(i,l,s)-u,y2:Math.max(i,l,s)+u};return!(e<h.x1||e>h.x2||t<h.y1||t>h.y2)},M8=function(e,t,n,i){n-=i;var a=t*t-4*e*n;if(a<0)return[];var s=Math.sqrt(a),o=2*e,l=(-t+s)/o,u=(-t-s)/o;return[l,u]},D8=function(e,t,n,i,a){var s=1e-5;e===0&&(e=s),t/=e,n/=e,i/=e;var o,l,u,h,f,c,d,p;if(l=(3*n-t*t)/9,u=-(27*i)+t*(9*n-2*(t*t)),u/=54,o=l*l*l+u*u,a[1]=0,d=t/3,o>0){f=u+Math.sqrt(o),f=f<0?-Math.pow(-f,1/3):Math.pow(f,1/3),c=u-Math.sqrt(o),c=c<0?-Math.pow(-c,1/3):Math.pow(c,1/3),a[0]=-d+f+c,d+=(f+c)/2,a[4]=a[2]=-d,d=Math.sqrt(3)*(-c+f)/2,a[3]=d,a[5]=-d;return}if(a[5]=a[3]=0,o===0){p=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3),a[0]=-d+2*p,a[4]=a[2]=-(p+d);return}l=-l,h=l*l*l,h=Math.acos(u/Math.sqrt(h)),p=2*Math.sqrt(l),a[0]=-d+p*Math.cos(h/3),a[2]=-d+p*Math.cos((h+2*Math.PI)/3),a[4]=-d+p*Math.cos((h+4*Math.PI)/3)},P8=function(e,t,n,i,a,s,o,l){var u=1*n*n-4*n*a+2*n*o+4*a*a-4*a*o+o*o+i*i-4*i*s+2*i*l+4*s*s-4*s*l+l*l,h=1*9*n*a-3*n*n-3*n*o-6*a*a+3*a*o+9*i*s-3*i*i-3*i*l-6*s*s+3*s*l,f=1*3*n*n-6*n*a+n*o-n*e+2*a*a+2*a*e-o*e+3*i*i-6*i*s+i*l-i*t+2*s*s+2*s*t-l*t,c=1*n*a-n*n+n*e-a*e+i*s-i*i+i*t-s*t,d=[];D8(u,h,f,c,d);for(var p=1e-7,g=[],v=0;v<6;v+=2)Math.abs(d[v+1])<p&&d[v]>=0&&d[v]<=1&&g.push(d[v]);g.push(1),g.push(0);for(var m=-1,y,b,w,S=0;S<g.length;S++)y=Math.pow(1-g[S],2)*n+2*(1-g[S])*g[S]*a+g[S]*g[S]*o,b=Math.pow(1-g[S],2)*i+2*(1-g[S])*g[S]*s+g[S]*g[S]*l,w=Math.pow(y-e,2)+Math.pow(b-t,2),m>=0?w<m&&(m=w):m=w;return m},B8=function(e,t,n,i,a,s){var o=[e-n,t-i],l=[a-n,s-i],u=l[0]*l[0]+l[1]*l[1],h=o[0]*o[0]+o[1]*o[1],f=o[0]*l[0]+o[1]*l[1],c=f*f/u;return f<0?h:c>u?(e-a)*(e-a)+(t-s)*(t-s):h-c},Rr=function(e,t,n){for(var i,a,s,o,l,u=0,h=0;h<n.length/2;h++)if(i=n[h*2],a=n[h*2+1],h+1<n.length/2?(s=n[(h+1)*2],o=n[(h+1)*2+1]):(s=n[(h+1-n.length/2)*2],o=n[(h+1-n.length/2)*2+1]),!(i==e&&s==e))if(i>=e&&e>=s||i<=e&&e<=s)l=(e-i)/(s-i)*(o-a)+a,l>t&&u++;else continue;return u%2!==0},si=function(e,t,n,i,a,s,o,l,u){var h=new Array(n.length),f;l[0]!=null?(f=Math.atan(l[1]/l[0]),l[0]<0?f=f+Math.PI/2:f=-f-Math.PI/2):f=l;for(var c=Math.cos(-f),d=Math.sin(-f),p=0;p<h.length/2;p++)h[p*2]=s/2*(n[p*2]*c-n[p*2+1]*d),h[p*2+1]=o/2*(n[p*2+1]*c+n[p*2]*d),h[p*2]+=i,h[p*2+1]+=a;var g;if(u>0){var v=mc(h,-u);g=vc(v)}else g=h;return Rr(e,t,g)},O8=function(e,t,n,i,a,s,o,l){for(var u=new Array(n.length*2),h=0;h<l.length;h++){var f=l[h];u[h*4+0]=f.startX,u[h*4+1]=f.startY,u[h*4+2]=f.stopX,u[h*4+3]=f.stopY;var c=Math.pow(f.cx-e,2)+Math.pow(f.cy-t,2);if(c<=Math.pow(f.radius,2))return!0}return Rr(e,t,u)},vc=function(e){for(var t=new Array(e.length/2),n,i,a,s,o,l,u,h,f=0;f<e.length/4;f++){n=e[f*4],i=e[f*4+1],a=e[f*4+2],s=e[f*4+3],f<e.length/4-1?(o=e[(f+1)*4],l=e[(f+1)*4+1],u=e[(f+1)*4+2],h=e[(f+1)*4+3]):(o=e[0],l=e[1],u=e[2],h=e[3]);var c=Ii(n,i,a,s,o,l,u,h,!0);t[f*2]=c[0],t[f*2+1]=c[1]}return t},mc=function(e,t){for(var n=new Array(e.length*2),i,a,s,o,l=0;l<e.length/2;l++){i=e[l*2],a=e[l*2+1],l<e.length/2-1?(s=e[(l+1)*2],o=e[(l+1)*2+1]):(s=e[0],o=e[1]);var u=o-a,h=-(s-i),f=Math.sqrt(u*u+h*h),c=u/f,d=h/f;n[l*4]=i+c*t,n[l*4+1]=a+d*t,n[l*4+2]=s+c*t,n[l*4+3]=o+d*t}return n},R8=function(e,t,n,i,a,s){var o=n-e,l=i-t;o/=a,l/=s;var u=Math.sqrt(o*o+l*l),h=u-1;if(h<0)return[];var f=h/u;return[(n-e)*f+e,(i-t)*f+t]},_a=function(e,t,n,i,a,s,o){return e-=a,t-=s,e/=n/2+o,t/=i/2+o,e*e+t*t<=1},ql=function(e,t,n,i,a,s,o){var l=[n-e,i-t],u=[e-a,t-s],h=l[0]*l[0]+l[1]*l[1],f=2*(u[0]*l[0]+u[1]*l[1]),c=u[0]*u[0]+u[1]*u[1]-o*o,d=f*f-4*h*c;if(d<0)return[];var p=(-f+Math.sqrt(d))/(2*h),g=(-f-Math.sqrt(d))/(2*h),v=Math.min(p,g),m=Math.max(p,g),y=[];if(v>=0&&v<=1&&y.push(v),m>=0&&m<=1&&y.push(m),y.length===0)return[];var b=y[0]*l[0]+e,w=y[0]*l[1]+t;if(y.length>1){if(y[0]==y[1])return[b,w];var S=y[1]*l[0]+e,C=y[1]*l[1]+t;return[b,w,S,C]}else return[b,w]},Em=function(e,t,n){return t<=e&&e<=n||n<=e&&e<=t?e:e<=t&&t<=n||n<=t&&t<=e?t:n},Ii=function(e,t,n,i,a,s,o,l,u){var h=e-a,f=n-e,c=o-a,d=t-s,p=i-t,g=l-s,v=c*d-g*h,m=f*d-p*h,y=g*f-c*p;if(y!==0){var b=v/y,w=m/y,S=.001,C=0-S,x=1+S;return C<=b&&b<=x&&C<=w&&w<=x?[e+b*f,t+b*p]:u?[e+b*f,t+b*p]:[]}else return v===0||m===0?Em(e,n,o)===o?[o,l]:Em(e,n,a)===a?[a,s]:Em(a,o,n)===n?[n,i]:[]:[]},jl=function(e,t,n,i,a,s,o,l){var u=[],h,f=new Array(n.length),c=!0;s==null&&(c=!1);var d;if(c){for(var p=0;p<f.length/2;p++)f[p*2]=n[p*2]*s+i,f[p*2+1]=n[p*2+1]*o+a;if(l>0){var g=mc(f,-l);d=vc(g)}else d=f}else d=n;for(var v,m,y,b,w=0;w<d.length/2;w++)v=d[w*2],m=d[w*2+1],w<d.length/2-1?(y=d[(w+1)*2],b=d[(w+1)*2+1]):(y=d[0],b=d[1]),h=Ii(e,t,i,a,v,m,y,b),h.length!==0&&u.push(h[0],h[1]);return u},L8=function(e,t,n,i,a,s,o,l,u){var h=[],f,c=new Array(n.length*2);u.forEach(function(y,b){b===0?(c[c.length-2]=y.startX,c[c.length-1]=y.startY):(c[b*4-2]=y.startX,c[b*4-1]=y.startY),c[b*4]=y.stopX,c[b*4+1]=y.stopY,f=ql(e,t,i,a,y.cx,y.cy,y.radius),f.length!==0&&h.push(f[0],f[1])});for(var d=0;d<c.length/4;d++)f=Ii(e,t,i,a,c[d*4],c[d*4+1],c[d*4+2],c[d*4+3],!1),f.length!==0&&h.push(f[0],f[1]);if(h.length>2){for(var p=[h[0],h[1]],g=Math.pow(p[0]-e,2)+Math.pow(p[1]-t,2),v=1;v<h.length/2;v++){var m=Math.pow(h[v*2]-e,2)+Math.pow(h[v*2+1]-t,2);m<=g&&(p[0]=h[v*2],p[1]=h[v*2+1],g=m)}return p}return h},Uf=function(e,t,n){var i=[e[0]-t[0],e[1]-t[1]],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]),s=(a-n)/a;return s<0&&(s=1e-5),[t[0]+s*i[0],t[1]+s*i[1]]},br=function(e,t){var n=Fy(e,t);return n=u2(n),n},u2=function(e){for(var t,n,i=e.length/2,a=1/0,s=1/0,o=-1/0,l=-1/0,u=0;u<i;u++)t=e[2*u],n=e[2*u+1],a=Math.min(a,t),o=Math.max(o,t),s=Math.min(s,n),l=Math.max(l,n);for(var h=2/(o-a),f=2/(l-s),c=0;c<i;c++)t=e[2*c]=e[2*c]*h,n=e[2*c+1]=e[2*c+1]*f,a=Math.min(a,t),o=Math.max(o,t),s=Math.min(s,n),l=Math.max(l,n);if(s<-1)for(var d=0;d<i;d++)n=e[2*d+1]=e[2*d+1]+(-1-s);return e},Fy=function(e,t){var n=1/e*2*Math.PI,i=e%2===0?Math.PI/2+n/2:Math.PI/2;i+=t;for(var a=new Array(e*2),s,o=0;o<e;o++)s=o*n+i,a[2*o]=Math.cos(s),a[2*o+1]=Math.sin(-s);return a},zi=function(e,t){return Math.min(e/4,t/4,8)},h2=function(e,t){return Math.min(e/10,t/10,8)},d0=function(){return 8},I8=function(e,t,n){return[e-2*t+n,2*(t-e),e]},_y=function(e,t){return{heightOffset:Math.min(15,.05*t),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}};function N8(r,e){function t(f){for(var c=[],d=0;d<f.length;d++){var p=f[d],g=f[(d+1)%f.length],v={x:g.x-p.x,y:g.y-p.y},m={x:-v.y,y:v.x},y=Math.sqrt(m.x*m.x+m.y*m.y);c.push({x:m.x/y,y:m.y/y})}return c}function n(f,c){var d=1/0,p=-1/0,g=Lr(f),v;try{for(g.s();!(v=g.n()).done;){var m=v.value,y=m.x*c.x+m.y*c.y;d=Math.min(d,y),p=Math.max(p,y)}}catch(b){g.e(b)}finally{g.f()}return{min:d,max:p}}function i(f,c){return!(f.max<c.min||c.max<f.min)}var a=[].concat(cc(t(r)),cc(t(e))),s=Lr(a),o;try{for(s.s();!(o=s.n()).done;){var l=o.value,u=n(r,l),h=n(e,l);if(!i(u,h))return!1}}catch(f){s.e(f)}finally{s.f()}return!0}var q8=ar({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),F8={pageRank:function(e){for(var t=q8(e),n=t.dampingFactor,i=t.precision,a=t.iterations,s=t.weight,o=this._private.cy,l=this.byGroup(),u=l.nodes,h=l.edges,f=u.length,c=f*f,d=h.length,p=new Array(c),g=new Array(f),v=(1-n)/f,m=0;m<f;m++){for(var y=0;y<f;y++){var b=m*f+y;p[b]=0}g[m]=0}for(var w=0;w<d;w++){var S=h[w],C=S.data("source"),x=S.data("target");if(C!==x){var A=u.indexOfId(C),T=u.indexOfId(x),D=s(S),k=T*f+A;p[k]+=D,g[A]+=D}}for(var E=1/f+v,M=0;M<f;M++)if(g[M]===0)for(var O=0;O<f;O++){var R=O*f+M;p[R]=E}else for(var L=0;L<f;L++){var I=L*f+M;p[I]=p[I]/g[M]+v}for(var N=new Array(f),q=new Array(f),z,F=0;F<f;F++)N[F]=1;for(var _=0;_<a;_++){for(var U=0;U<f;U++)q[U]=0;for(var X=0;X<f;X++)for(var $=0;$<f;$++){var Q=X*f+$;q[X]+=p[Q]*N[$]}y8(q),z=N,N=q,q=z;for(var ee=0,oe=0;oe<f;oe++){var te=z[oe]-N[oe];ee+=te*te}if(ee<i)break}var V={rank:function(K){return K=o.collection(K)[0],N[u.indexOf(K)]}};return V}},_E=ar({root:null,weight:function(e){return 1},directed:!1,alpha:0}),Ks={degreeCentralityNormalized:function(e){e=_E(e);var t=this.cy(),n=this.nodes(),i=n.length;if(e.directed){for(var h={},f={},c=0,d=0,p=0;p<i;p++){var g=n[p],v=g.id();e.root=g;var m=this.degreeCentrality(e);c<m.indegree&&(c=m.indegree),d<m.outdegree&&(d=m.outdegree),h[v]=m.indegree,f[v]=m.outdegree}return{indegree:function(b){return c==0?0:(be(b)&&(b=t.filter(b)),h[b.id()]/c)},outdegree:function(b){return d===0?0:(be(b)&&(b=t.filter(b)),f[b.id()]/d)}}}else{for(var a={},s=0,o=0;o<i;o++){var l=n[o];e.root=l;var u=this.degreeCentrality(e);s<u.degree&&(s=u.degree),a[l.id()]=u.degree}return{degree:function(b){return s===0?0:(be(b)&&(b=t.filter(b)),a[b.id()]/s)}}}},degreeCentrality:function(e){e=_E(e);var t=this.cy(),n=this,i=e,a=i.root,s=i.weight,o=i.directed,l=i.alpha;if(a=t.collection(a)[0],o){for(var d=a.connectedEdges(),p=d.filter(function(C){return C.target().same(a)&&n.has(C)}),g=d.filter(function(C){return C.source().same(a)&&n.has(C)}),v=p.length,m=g.length,y=0,b=0,w=0;w<p.length;w++)y+=s(p[w]);for(var S=0;S<g.length;S++)b+=s(g[S]);return{indegree:Math.pow(v,1-l)*Math.pow(y,l),outdegree:Math.pow(m,1-l)*Math.pow(b,l)}}else{for(var u=a.connectedEdges().intersection(n),h=u.length,f=0,c=0;c<u.length;c++)f+=s(u[c]);return{degree:Math.pow(h,1-l)*Math.pow(f,l)}}}};Ks.dc=Ks.degreeCentrality;Ks.dcn=Ks.degreeCentralityNormalised=Ks.degreeCentralityNormalized;var zE=ar({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),js={closenessCentralityNormalized:function(e){for(var t=zE(e),n=t.harmonic,i=t.weight,a=t.directed,s=this.cy(),o={},l=0,u=this.nodes(),h=this.floydWarshall({weight:i,directed:a}),f=0;f<u.length;f++){for(var c=0,d=u[f],p=0;p<u.length;p++)if(f!==p){var g=h.distance(d,u[p]);n?c+=1/g:c+=g}n||(c=1/c),l<c&&(l=c),o[d.id()]=c}return{closeness:function(m){return l==0?0:(be(m)?m=s.filter(m)[0].id():m=m.id(),o[m]/l)}}},closenessCentrality:function(e){var t=zE(e),n=t.root,i=t.weight,a=t.directed,s=t.harmonic;n=this.filter(n)[0];for(var o=this.dijkstra({root:n,weight:i,directed:a}),l=0,u=this.nodes(),h=0;h<u.length;h++){var f=u[h];if(!f.same(n)){var c=o.distanceTo(f);s?l+=1/c:l+=c}}return s?l:1/l}};js.cc=js.closenessCentrality;js.ccn=js.closenessCentralityNormalised=js.closenessCentralityNormalized;var _8=ar({weight:null,directed:!1}),zy={betweennessCentrality:function(e){for(var t=_8(e),n=t.directed,i=t.weight,a=i!=null,s=this.cy(),o=this.nodes(),l={},u={},h=0,f={set:function(b,w){u[b]=w,w>h&&(h=w)},get:function(b){return u[b]}},c=0;c<o.length;c++){var d=o[c],p=d.id();n?l[p]=d.outgoers().nodes():l[p]=d.openNeighborhood().nodes(),f.set(p,0)}for(var g=function(){for(var b=o[v].id(),w=[],S={},C={},x={},A=new au(function(X,$){return x[X]-x[$]}),T=0;T<o.length;T++){var D=o[T].id();S[D]=[],C[D]=0,x[D]=1/0}for(C[b]=1,x[b]=0,A.push(b);!A.empty();){var k=A.pop();if(w.push(k),a)for(var E=0;E<l[k].length;E++){var M=l[k][E],O=s.getElementById(k),R=void 0;O.edgesTo(M).length>0?R=O.edgesTo(M)[0]:R=M.edgesTo(O)[0];var L=i(R);M=M.id(),x[M]>x[k]+L&&(x[M]=x[k]+L,A.nodes.indexOf(M)<0?A.push(M):A.updateItem(M),C[M]=0,S[M]=[]),x[M]==x[k]+L&&(C[M]=C[M]+C[k],S[M].push(k))}else for(var I=0;I<l[k].length;I++){var N=l[k][I].id();x[N]==1/0&&(A.push(N),x[N]=x[k]+1),x[N]==x[k]+1&&(C[N]=C[N]+C[k],S[N].push(k))}}for(var q={},z=0;z<o.length;z++)q[o[z].id()]=0;for(;w.length>0;){for(var F=w.pop(),_=0;_<S[F].length;_++){var U=S[F][_];q[U]=q[U]+C[U]/C[F]*(1+q[F])}F!=o[v].id()&&f.set(F,f.get(F)+q[F])}},v=0;v<o.length;v++)g();var m={betweenness:function(b){var w=s.collection(b).id();return f.get(w)},betweennessNormalized:function(b){if(h==0)return 0;var w=s.collection(b).id();return f.get(w)/h}};return m.betweennessNormalised=m.betweennessNormalized,m}};zy.bc=zy.betweennessCentrality;var z8=ar({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(r){return 1}]}),V8=function(e){return z8(e)},H8=function(e,t){for(var n=0,i=0;i<t.length;i++)n+=t[i](e);return n},W8=function(e,t,n){for(var i=0;i<t;i++)e[i*t+i]=n},f2=function(e,t){for(var n,i=0;i<t;i++){n=0;for(var a=0;a<t;a++)n+=e[a*t+i];for(var s=0;s<t;s++)e[s*t+i]=e[s*t+i]/n}},G8=function(e,t,n){for(var i=new Array(n*n),a=0;a<n;a++){for(var s=0;s<n;s++)i[a*n+s]=0;for(var o=0;o<n;o++)for(var l=0;l<n;l++)i[a*n+l]+=e[a*n+o]*t[o*n+l]}return i},U8=function(e,t,n){for(var i=e.slice(0),a=1;a<n;a++)e=G8(e,i,t);return e},K8=function(e,t,n){for(var i=new Array(t*t),a=0;a<t*t;a++)i[a]=Math.pow(e[a],n);return f2(i,t),i},j8=function(e,t,n,i){for(var a=0;a<n;a++){var s=Math.round(e[a]*Math.pow(10,i))/Math.pow(10,i),o=Math.round(t[a]*Math.pow(10,i))/Math.pow(10,i);if(s!==o)return!1}return!0},Y8=function(e,t,n,i){for(var a=[],s=0;s<t;s++){for(var o=[],l=0;l<t;l++)Math.round(e[s*t+l]*1e3)/1e3>0&&o.push(n[l]);o.length!==0&&a.push(i.collection(o))}return a},X8=function(e,t){for(var n=0;n<e.length;n++)if(!t[n]||e[n].id()!==t[n].id())return!1;return!0},$8=function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e.length;n++)t!=n&&X8(e[t],e[n])&&e.splice(n,1);return e},VE=function(e){for(var t=this.nodes(),n=this.edges(),i=this.cy(),a=V8(e),s={},o=0;o<t.length;o++)s[t[o].id()]=o;for(var l=t.length,u=l*l,h=new Array(u),f,c=0;c<u;c++)h[c]=0;for(var d=0;d<n.length;d++){var p=n[d],g=s[p.source().id()],v=s[p.target().id()],m=H8(p,a.attributes);h[g*l+v]+=m,h[v*l+g]+=m}W8(h,l,a.multFactor),f2(h,l);for(var y=!0,b=0;y&&b<a.maxIterations;)y=!1,f=U8(h,l,a.expandFactor),h=K8(f,l,a.inflateFactor),j8(h,f,u,4)||(y=!0),b++;var w=Y8(h,l,t,i);return w=$8(w),w},Z8={markovClustering:VE,mcl:VE},Q8=function(e){return e},c2=function(e,t){return Math.abs(t-e)},HE=function(e,t,n){return e+c2(t,n)},WE=function(e,t,n){return e+Math.pow(n-t,2)},J8=function(e){return Math.sqrt(e)},eU=function(e,t,n){return Math.max(e,c2(t,n))},Pl=function(e,t,n,i,a){for(var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:Q8,o=i,l,u,h=0;h<e;h++)l=t(h),u=n(h),o=a(o,l,u);return s(o)},Zs={euclidean:function(e,t,n){return e>=2?Pl(e,t,n,0,WE,J8):Pl(e,t,n,0,HE)},squaredEuclidean:function(e,t,n){return Pl(e,t,n,0,WE)},manhattan:function(e,t,n){return Pl(e,t,n,0,HE)},max:function(e,t,n){return Pl(e,t,n,-1/0,eU)}};Zs["squared-euclidean"]=Zs.squaredEuclidean;Zs.squaredeuclidean=Zs.squaredEuclidean;function Pc(r,e,t,n,i,a){var s;return kt(r)?s=r:s=Zs[r]||Zs.euclidean,e===0&&kt(r)?s(i,a):s(e,t,n,i,a)}var tU=ar({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),p0=function(e){return tU(e)},yc=function(e,t,n,i,a){var s=a!=="kMedoids",o=s?function(f){return n[f]}:function(f){return i[f](n)},l=function(c){return i[c](t)},u=n,h=t;return Pc(e,i.length,o,l,u,h)},Tm=function(e,t,n){for(var i=n.length,a=new Array(i),s=new Array(i),o=new Array(t),l=null,u=0;u<i;u++)a[u]=e.min(n[u]).value,s[u]=e.max(n[u]).value;for(var h=0;h<t;h++){l=[];for(var f=0;f<i;f++)l[f]=Math.random()*(s[f]-a[f])+a[f];o[h]=l}return o},d2=function(e,t,n,i,a){for(var s=1/0,o=0,l=0;l<t.length;l++){var u=yc(n,e,t[l],i,a);u<s&&(s=u,o=l)}return o},p2=function(e,t,n){for(var i=[],a=null,s=0;s<t.length;s++)a=t[s],n[a.id()]===e&&i.push(a);return i},rU=function(e,t,n){return Math.abs(t-e)<=n},nU=function(e,t,n){for(var i=0;i<e.length;i++)for(var a=0;a<e[i].length;a++){var s=Math.abs(e[i][a]-t[i][a]);if(s>n)return!1}return!0},iU=function(e,t,n){for(var i=0;i<n;i++)if(e===t[i])return!0;return!1},GE=function(e,t){var n=new Array(t);if(e.length<50)for(var i=0;i<t;i++){for(var a=e[Math.floor(Math.random()*e.length)];iU(a,n,i);)a=e[Math.floor(Math.random()*e.length)];n[i]=a}else for(var s=0;s<t;s++)n[s]=e[Math.floor(Math.random()*e.length)];return n},UE=function(e,t,n){for(var i=0,a=0;a<t.length;a++)i+=yc("manhattan",t[a],e,n,"kMedoids");return i},aU=function(e){var t=this.cy(),n=this.nodes(),i=null,a=p0(e),s=new Array(a.k),o={},l;a.testMode?typeof a.testCentroids=="number"?(a.testCentroids,l=Tm(n,a.k,a.attributes)):Ht(a.testCentroids)==="object"?l=a.testCentroids:l=Tm(n,a.k,a.attributes):l=Tm(n,a.k,a.attributes);for(var u=!0,h=0;u&&h<a.maxIterations;){for(var f=0;f<n.length;f++)i=n[f],o[i.id()]=d2(i,l,a.distance,a.attributes,"kMeans");u=!1;for(var c=0;c<a.k;c++){var d=p2(c,n,o);if(d.length!==0){for(var p=a.attributes.length,g=l[c],v=new Array(p),m=new Array(p),y=0;y<p;y++){m[y]=0;for(var b=0;b<d.length;b++)i=d[b],m[y]+=a.attributes[y](i);v[y]=m[y]/d.length,rU(v[y],g[y],a.sensitivityThreshold)||(u=!0)}l[c]=v,s[c]=t.collection(d)}}h++}return s},sU=function(e){var t=this.cy(),n=this.nodes(),i=null,a=p0(e),s=new Array(a.k),o,l={},u,h=new Array(a.k);a.testMode?typeof a.testCentroids=="number"||(Ht(a.testCentroids)==="object"?o=a.testCentroids:o=GE(n,a.k)):o=GE(n,a.k);for(var f=!0,c=0;f&&c<a.maxIterations;){for(var d=0;d<n.length;d++)i=n[d],l[i.id()]=d2(i,o,a.distance,a.attributes,"kMedoids");f=!1;for(var p=0;p<o.length;p++){var g=p2(p,n,l);if(g.length!==0){h[p]=UE(o[p],g,a.attributes);for(var v=0;v<g.length;v++)u=UE(g[v],g,a.attributes),u<h[p]&&(h[p]=u,o[p]=g[v],f=!0);s[p]=t.collection(g)}}c++}return s},oU=function(e,t,n,i,a){for(var s,o,l=0;l<t.length;l++)for(var u=0;u<e.length;u++)i[l][u]=Math.pow(n[l][u],a.m);for(var h=0;h<e.length;h++)for(var f=0;f<a.attributes.length;f++){s=0,o=0;for(var c=0;c<t.length;c++)s+=i[c][h]*a.attributes[f](t[c]),o+=i[c][h];e[h][f]=s/o}},lU=function(e,t,n,i,a){for(var s=0;s<e.length;s++)t[s]=e[s].slice();for(var o,l,u,h=2/(a.m-1),f=0;f<n.length;f++)for(var c=0;c<i.length;c++){o=0;for(var d=0;d<n.length;d++)l=yc(a.distance,i[c],n[f],a.attributes,"cmeans"),u=yc(a.distance,i[c],n[d],a.attributes,"cmeans"),o+=Math.pow(l/u,h);e[c][f]=1/o}},uU=function(e,t,n,i){for(var a=new Array(n.k),s=0;s<a.length;s++)a[s]=[];for(var o,l,u=0;u<t.length;u++){o=-1/0,l=-1;for(var h=0;h<t[0].length;h++)t[u][h]>o&&(o=t[u][h],l=h);a[l].push(e[u])}for(var f=0;f<a.length;f++)a[f]=i.collection(a[f]);return a},KE=function(e){var t=this.cy(),n=this.nodes(),i=p0(e),a,s,o,l,u;l=new Array(n.length);for(var h=0;h<n.length;h++)l[h]=new Array(i.k);o=new Array(n.length);for(var f=0;f<n.length;f++)o[f]=new Array(i.k);for(var c=0;c<n.length;c++){for(var d=0,p=0;p<i.k;p++)o[c][p]=Math.random(),d+=o[c][p];for(var g=0;g<i.k;g++)o[c][g]=o[c][g]/d}s=new Array(i.k);for(var v=0;v<i.k;v++)s[v]=new Array(i.attributes.length);u=new Array(n.length);for(var m=0;m<n.length;m++)u[m]=new Array(i.k);for(var y=!0,b=0;y&&b<i.maxIterations;)y=!1,oU(s,n,o,u,i),lU(o,l,s,n,i),nU(o,l,i.sensitivityThreshold)||(y=!0),b++;return a=uU(n,o,i,t),{clusters:a,degreeOfMembership:o}},hU={kMeans:aU,kMedoids:sU,fuzzyCMeans:KE,fcm:KE},fU=ar({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),cU={single:"min",complete:"max"},dU=function(e){var t=fU(e),n=cU[t.linkage];return n!=null&&(t.linkage=n),t},jE=function(e,t,n,i,a){for(var s=0,o=1/0,l,u=a.attributes,h=function(T,D){return Pc(a.distance,u.length,function(k){return u[k](T)},function(k){return u[k](D)},T,D)},f=0;f<e.length;f++){var c=e[f].key,d=n[c][i[c]];d<o&&(s=c,o=d)}if(a.mode==="threshold"&&o>=a.threshold||a.mode==="dendrogram"&&e.length===1)return!1;var p=t[s],g=t[i[s]],v;a.mode==="dendrogram"?v={left:p,right:g,key:p.key}:v={value:p.value.concat(g.value),key:p.key},e[p.index]=v,e.splice(g.index,1),t[p.key]=v;for(var m=0;m<e.length;m++){var y=e[m];p.key===y.key?l=1/0:a.linkage==="min"?(l=n[p.key][y.key],n[p.key][y.key]>n[g.key][y.key]&&(l=n[g.key][y.key])):a.linkage==="max"?(l=n[p.key][y.key],n[p.key][y.key]<n[g.key][y.key]&&(l=n[g.key][y.key])):a.linkage==="mean"?l=(n[p.key][y.key]*p.size+n[g.key][y.key]*g.size)/(p.size+g.size):a.mode==="dendrogram"?l=h(y.value,p.value):l=h(y.value[0],p.value[0]),n[p.key][y.key]=n[y.key][p.key]=l}for(var b=0;b<e.length;b++){var w=e[b].key;if(i[w]===p.key||i[w]===g.key){for(var S=w,C=0;C<e.length;C++){var x=e[C].key;n[w][x]<n[w][S]&&(S=x)}i[w]=S}e[b].index=b}return p.key=g.key=p.index=g.index=null,!0},Ws=function(e,t,n){e&&(e.value?t.push(e.value):(e.left&&Ws(e.left,t),e.right&&Ws(e.right,t)))},Vy=function(e,t){if(!e)return"";if(e.left&&e.right){var n=Vy(e.left,t),i=Vy(e.right,t),a=t.add({group:"nodes",data:{id:n+","+i}});return t.add({group:"edges",data:{source:n,target:a.id()}}),t.add({group:"edges",data:{source:i,target:a.id()}}),a.id()}else if(e.value)return e.value.id()},Hy=function(e,t,n){if(!e)return[];var i=[],a=[],s=[];return t===0?(e.left&&Ws(e.left,i),e.right&&Ws(e.right,a),s=i.concat(a),[n.collection(s)]):t===1?e.value?[n.collection(e.value)]:(e.left&&Ws(e.left,i),e.right&&Ws(e.right,a),[n.collection(i),n.collection(a)]):e.value?[n.collection(e.value)]:(e.left&&(i=Hy(e.left,t-1,n)),e.right&&(a=Hy(e.right,t-1,n)),i.concat(a))},YE=function(e){for(var t=this.cy(),n=this.nodes(),i=dU(e),a=i.attributes,s=function(b,w){return Pc(i.distance,a.length,function(S){return a[S](b)},function(S){return a[S](w)},b,w)},o=[],l=[],u=[],h=[],f=0;f<n.length;f++){var c={value:i.mode==="dendrogram"?n[f]:[n[f]],key:f,index:f};o[f]=c,h[f]=c,l[f]=[],u[f]=0}for(var d=0;d<o.length;d++)for(var p=0;p<=d;p++){var g=void 0;i.mode==="dendrogram"?g=d===p?1/0:s(o[d].value,o[p].value):g=d===p?1/0:s(o[d].value[0],o[p].value[0]),l[d][p]=g,l[p][d]=g,g<l[d][u[d]]&&(u[d]=p)}for(var v=jE(o,h,l,u,i);v;)v=jE(o,h,l,u,i);var m;return i.mode==="dendrogram"?(m=Hy(o[0],i.dendrogramDepth,t),i.addDendrogram&&Vy(o[0],t)):(m=new Array(o.length),o.forEach(function(y,b){y.key=y.index=null,m[b]=t.collection(y.value)})),m},pU={hierarchicalClustering:YE,hca:YE},gU=ar({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),vU=function(e){var t=e.damping,n=e.preference;.5<=t&&t<1||Ct("Damping must range on [0.5, 1).  Got: ".concat(t));var i=["median","mean","min","max"];return i.some(function(a){return a===n})||se(n)||Ct("Preference must be one of [".concat(i.map(function(a){return"'".concat(a,"'")}).join(", "),"] or a number.  Got: ").concat(n)),gU(e)},mU=function(e,t,n,i){var a=function(o,l){return i[l](o)};return-Pc(e,i.length,function(s){return a(t,s)},function(s){return a(n,s)},t,n)},yU=function(e,t){var n=null;return t==="median"?n=v8(e):t==="mean"?n=g8(e):t==="min"?n=d8(e):t==="max"?n=p8(e):n=t,n},bU=function(e,t,n){for(var i=[],a=0;a<e;a++)t[a*e+a]+n[a*e+a]>0&&i.push(a);return i},XE=function(e,t,n){for(var i=[],a=0;a<e;a++){for(var s=-1,o=-1/0,l=0;l<n.length;l++){var u=n[l];t[a*e+u]>o&&(s=u,o=t[a*e+u])}s>0&&i.push(s)}for(var h=0;h<n.length;h++)i[n[h]]=n[h];return i},wU=function(e,t,n){for(var i=XE(e,t,n),a=0;a<n.length;a++){for(var s=[],o=0;o<i.length;o++)i[o]===n[a]&&s.push(o);for(var l=-1,u=-1/0,h=0;h<s.length;h++){for(var f=0,c=0;c<s.length;c++)f+=t[s[c]*e+s[h]];f>u&&(l=h,u=f)}n[a]=s[l]}return i=XE(e,t,n),i},$E=function(e){for(var t=this.cy(),n=this.nodes(),i=vU(e),a={},s=0;s<n.length;s++)a[n[s].id()]=s;var o,l,u,h,f,c;o=n.length,l=o*o,u=new Array(l);for(var d=0;d<l;d++)u[d]=-1/0;for(var p=0;p<o;p++)for(var g=0;g<o;g++)p!==g&&(u[p*o+g]=mU(i.distance,n[p],n[g],i.attributes));h=yU(u,i.preference);for(var v=0;v<o;v++)u[v*o+v]=h;f=new Array(l);for(var m=0;m<l;m++)f[m]=0;c=new Array(l);for(var y=0;y<l;y++)c[y]=0;for(var b=new Array(o),w=new Array(o),S=new Array(o),C=0;C<o;C++)b[C]=0,w[C]=0,S[C]=0;for(var x=new Array(o*i.minIterations),A=0;A<x.length;A++)x[A]=0;var T;for(T=0;T<i.maxIterations;T++){for(var D=0;D<o;D++){for(var k=-1/0,E=-1/0,M=-1,O=0,R=0;R<o;R++)b[R]=f[D*o+R],O=c[D*o+R]+u[D*o+R],O>=k?(E=k,k=O,M=R):O>E&&(E=O);for(var L=0;L<o;L++)f[D*o+L]=(1-i.damping)*(u[D*o+L]-k)+i.damping*b[L];f[D*o+M]=(1-i.damping)*(u[D*o+M]-E)+i.damping*b[M]}for(var I=0;I<o;I++){for(var N=0,q=0;q<o;q++)b[q]=c[q*o+I],w[q]=Math.max(0,f[q*o+I]),N+=w[q];N-=w[I],w[I]=f[I*o+I],N+=w[I];for(var z=0;z<o;z++)c[z*o+I]=(1-i.damping)*Math.min(0,N-w[z])+i.damping*b[z];c[I*o+I]=(1-i.damping)*(N-w[I])+i.damping*b[I]}for(var F=0,_=0;_<o;_++){var U=c[_*o+_]+f[_*o+_]>0?1:0;x[T%i.minIterations*o+_]=U,F+=U}if(F>0&&(T>=i.minIterations-1||T==i.maxIterations-1)){for(var X=0,$=0;$<o;$++){S[$]=0;for(var Q=0;Q<i.minIterations;Q++)S[$]+=x[Q*o+$];(S[$]===0||S[$]===i.minIterations)&&X++}if(X===o)break}}for(var ee=bU(o,f,c),oe=wU(o,u,ee),te={},V=0;V<ee.length;V++)te[ee[V]]=[];for(var W=0;W<n.length;W++){var K=a[n[W].id()],ie=oe[K];ie!=null&&te[ie].push(n[W])}for(var ue=new Array(ee.length),Me=0;Me<ee.length;Me++)ue[Me]=t.collection(te[ee[Me]]);return ue},xU={affinityPropagation:$E,ap:$E},SU=ar({root:void 0,directed:!1}),CU={hierholzer:function(e){if(!$e(e)){var t=arguments;e={root:t[0],directed:t[1]}}var n=SU(e),i=n.root,a=n.directed,s=this,o=!1,l,u,h;i&&(h=be(i)?this.filter(i)[0].id():i[0].id());var f={},c={};a?s.forEach(function(y){var b=y.id();if(y.isNode()){var w=y.indegree(!0),S=y.outdegree(!0),C=w-S,x=S-w;C==1?l?o=!0:l=b:x==1?u?o=!0:u=b:(x>1||C>1)&&(o=!0),f[b]=[],y.outgoers().forEach(function(A){A.isEdge()&&f[b].push(A.id())})}else c[b]=[void 0,y.target().id()]}):s.forEach(function(y){var b=y.id();if(y.isNode()){var w=y.degree(!0);w%2&&(l?u?o=!0:u=b:l=b),f[b]=[],y.connectedEdges().forEach(function(S){return f[b].push(S.id())})}else c[b]=[y.source().id(),y.target().id()]});var d={found:!1,trail:void 0};if(o)return d;if(u&&l)if(a){if(h&&u!=h)return d;h=u}else{if(h&&u!=h&&l!=h)return d;h||(h=u)}else h||(h=s[0].id());var p=function(b){for(var w=b,S=[b],C,x,A;f[w].length;)C=f[w].shift(),x=c[C][0],A=c[C][1],w!=A?(f[A]=f[A].filter(function(T){return T!=C}),w=A):!a&&w!=x&&(f[x]=f[x].filter(function(T){return T!=C}),w=x),S.unshift(C),S.unshift(w);return S},g=[],v=[];for(v=p(h);v.length!=1;)f[v[0]].length==0?(g.unshift(s.getElementById(v.shift())),g.unshift(s.getElementById(v.shift()))):v=p(v.shift()).concat(v);g.unshift(s.getElementById(v.shift()));for(var m in f)if(f[m].length)return d;return d.found=!0,d.trail=this.spawn(g,!0),d}},Kf=function(){var e=this,t={},n=0,i=0,a=[],s=[],o={},l=function(c,d){for(var p=s.length-1,g=[],v=e.spawn();s[p].x!=c||s[p].y!=d;)g.push(s.pop().edge),p--;g.push(s.pop().edge),g.forEach(function(m){var y=m.connectedNodes().intersection(e);v.merge(m),y.forEach(function(b){var w=b.id(),S=b.connectedEdges().intersection(e);v.merge(b),t[w].cutVertex?v.merge(S.filter(function(C){return C.isLoop()})):v.merge(S)})}),a.push(v)},u=function(c,d,p){c===p&&(i+=1),t[d]={id:n,low:n++,cutVertex:!1};var g=e.getElementById(d).connectedEdges().intersection(e);if(g.size()===0)a.push(e.spawn(e.getElementById(d)));else{var v,m,y,b;g.forEach(function(w){v=w.source().id(),m=w.target().id(),y=v===d?m:v,y!==p&&(b=w.id(),o[b]||(o[b]=!0,s.push({x:d,y,edge:w})),y in t?t[d].low=Math.min(t[d].low,t[y].id):(u(c,y,d),t[d].low=Math.min(t[d].low,t[y].low),t[d].id<=t[y].low&&(t[d].cutVertex=!0,l(d,y))))})}};e.forEach(function(f){if(f.isNode()){var c=f.id();c in t||(i=0,u(c,c),t[c].cutVertex=i>1)}});var h=Object.keys(t).filter(function(f){return t[f].cutVertex}).map(function(f){return e.getElementById(f)});return{cut:e.spawn(h),components:a}},kU={hopcroftTarjanBiconnected:Kf,htbc:Kf,htb:Kf,hopcroftTarjanBiconnectedComponents:Kf},jf=function(){var e=this,t={},n=0,i=[],a=[],s=e.spawn(e),o=function(u){a.push(u),t[u]={index:n,low:n++,explored:!1};var h=e.getElementById(u).connectedEdges().intersection(e);if(h.forEach(function(g){var v=g.target().id();v!==u&&(v in t||o(v),t[v].explored||(t[u].low=Math.min(t[u].low,t[v].low)))}),t[u].index===t[u].low){for(var f=e.spawn();;){var c=a.pop();if(f.merge(e.getElementById(c)),t[c].low=t[u].index,t[c].explored=!0,c===u)break}var d=f.edgesWith(f),p=f.merge(d);i.push(p),s=s.difference(p)}};return e.forEach(function(l){if(l.isNode()){var u=l.id();u in t||o(u)}}),{cut:s,components:i}},EU={tarjanStronglyConnected:jf,tsc:jf,tscc:jf,tarjanStronglyConnectedComponents:jf},g2={};[Ul,t8,r8,i8,s8,l8,f8,F8,Ks,js,zy,Z8,hU,pU,xU,CU,kU,EU].forEach(function(r){Ce(g2,r)});var v2=0,m2=1,y2=2,wn=function(e){if(!(this instanceof wn))return new wn(e);this.id="Thenable/1.0.7",this.state=v2,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};wn.prototype={fulfill:function(e){return ZE(this,m2,"fulfillValue",e)},reject:function(e){return ZE(this,y2,"rejectReason",e)},then:function(e,t){var n=this,i=new wn;return n.onFulfilled.push(JE(e,i,"fulfill")),n.onRejected.push(JE(t,i,"reject")),b2(n),i.proxy}};var ZE=function(e,t,n,i){return e.state===v2&&(e.state=t,e[n]=i,b2(e)),e},b2=function(e){e.state===m2?QE(e,"onFulfilled",e.fulfillValue):e.state===y2&&QE(e,"onRejected",e.rejectReason)},QE=function(e,t,n){if(e[t].length!==0){var i=e[t];e[t]=[];var a=function(){for(var o=0;o<i.length;o++)i[o](n)};typeof setImmediate=="function"?setImmediate(a):setTimeout(a,0)}},JE=function(e,t,n){return function(i){if(typeof e!="function")t[n].call(t,i);else{var a;try{a=e(i)}catch(s){t.reject(s);return}w2(t,a)}}},w2=function(e,t){if(e===t||e.proxy===t){e.reject(new TypeError("cannot resolve promise with itself"));return}var n;if(Ht(t)==="object"&&t!==null||typeof t=="function")try{n=t.then}catch(a){e.reject(a);return}if(typeof n=="function"){var i=!1;try{n.call(t,function(a){i||(i=!0,a===t?e.reject(new TypeError("circular thenable chain")):w2(e,a))},function(a){i||(i=!0,e.reject(a))})}catch(a){i||e.reject(a)}return}e.fulfill(t)};wn.all=function(r){return new wn(function(e,t){for(var n=new Array(r.length),i=0,a=function(l,u){n[l]=u,i++,i===r.length&&e(n)},s=0;s<r.length;s++)(function(o){var l=r[o],u=l!=null&&l.then!=null;if(u)l.then(function(f){a(o,f)},function(f){t(f)});else{var h=l;a(o,h)}})(s)})};wn.resolve=function(r){return new wn(function(e,t){e(r)})};wn.reject=function(r){return new wn(function(e,t){t(r)})};var eo=typeof Promise<"u"?Promise:wn,Wy=function(e,t,n){var i=i0(e),a=!i,s=this._private=Ce({duration:1e3},t,n);if(s.target=e,s.style=s.style||s.css,s.started=!1,s.playing=!1,s.hooked=!1,s.applying=!1,s.progress=0,s.completes=[],s.frames=[],s.complete&&kt(s.complete)&&s.completes.push(s.complete),a){var o=e.position();s.startPosition=s.startPosition||{x:o.x,y:o.y},s.startStyle=s.startStyle||e.cy().style().getAnimationStartStyle(e,s.style)}if(i){var l=e.pan();s.startPan={x:l.x,y:l.y},s.startZoom=e.zoom()}this.length=1,this[0]=this},Ha=Wy.prototype;Ce(Ha,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var t,n=e.target._private.animation;e.queue?t=n.queue:t=n.current,t.push(this),Wr(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var t=this._private;return e===void 0?t.progress*t.duration:this.progress(e/t.duration)},progress:function(e){var t=this._private,n=t.playing;return e===void 0?t.progress:(n&&this.pause(),t.progress=e,t.started=!1,n&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,t=e.playing;t&&this.pause(),e.progress=1-e.progress,e.started=!1;var n=function(u,h){var f=e[u];f!=null&&(e[u]=e[h],e[h]=f)};if(n("zoom","startZoom"),n("pan","startPan"),n("position","startPosition"),e.style)for(var i=0;i<e.style.length;i++){var a=e.style[i],s=a.name,o=e.startStyle[s];e.startStyle[s]=a,e.style[i]=o}return t&&this.play(),this},promise:function(e){var t=this._private,n;switch(e){case"frame":n=t.frames;break;default:case"complete":case"completed":n=t.completes}return new eo(function(i,a){n.push(function(){i()})})}});Ha.complete=Ha.completed;Ha.run=Ha.play;Ha.running=Ha.playing;var TU={animated:function(){return function(){var t=this,n=t.length!==void 0,i=n?t:[t],a=this._private.cy||this;if(!a.styleEnabled())return!1;var s=i[0];if(s)return s._private.animation.current.length>0}},clearQueue:function(){return function(){var t=this,n=t.length!==void 0,i=n?t:[t],a=this._private.cy||this;if(!a.styleEnabled())return this;for(var s=0;s<i.length;s++){var o=i[s];o._private.animation.queue=[]}return this}},delay:function(){return function(t,n){var i=this._private.cy||this;return i.styleEnabled()?this.animate({delay:t,duration:t,complete:n}):this}},delayAnimation:function(){return function(t,n){var i=this._private.cy||this;return i.styleEnabled()?this.animation({delay:t,duration:t,complete:n}):this}},animation:function(){return function(t,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this,l=!a,u=!l;if(!o.styleEnabled())return this;var h=o.style();t=Ce({},t,n);var f=Object.keys(t).length===0;if(f)return new Wy(s[0],t);switch(t.duration===void 0&&(t.duration=400),t.duration){case"slow":t.duration=600;break;case"fast":t.duration=200;break}if(u&&(t.style=h.getPropsList(t.style||t.css),t.css=void 0),u&&t.renderedPosition!=null){var c=t.renderedPosition,d=o.pan(),p=o.zoom();t.position=s2(c,p,d)}if(l&&t.panBy!=null){var g=t.panBy,v=o.pan();t.pan={x:v.x+g.x,y:v.y+g.y}}var m=t.center||t.centre;if(l&&m!=null){var y=o.getCenterPan(m.eles,t.zoom);y!=null&&(t.pan=y)}if(l&&t.fit!=null){var b=t.fit,w=o.getFitViewport(b.eles||b.boundingBox,b.padding);w!=null&&(t.pan=w.pan,t.zoom=w.zoom)}if(l&&$e(t.zoom)){var S=o.getZoomedViewport(t.zoom);S!=null?(S.zoomed&&(t.zoom=S.zoom),S.panned&&(t.pan=S.pan)):t.zoom=null}return new Wy(s[0],t)}},animate:function(){return function(t,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this;if(!o.styleEnabled())return this;n&&(t=Ce({},t,n));for(var l=0;l<s.length;l++){var u=s[l],h=u.animated()&&(t.queue===void 0||t.queue),f=u.animation(t,h?{queue:!0}:void 0);f.play()}return this}},stop:function(){return function(t,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this;if(!o.styleEnabled())return this;for(var l=0;l<s.length;l++){for(var u=s[l],h=u._private,f=h.animation.current,c=0;c<f.length;c++){var d=f[c],p=d._private;n&&(p.duration=0)}t&&(h.animation.queue=[]),n||(h.animation.current=[])}return o.notify("draw"),this}}},Am,eT;function Bc(){if(eT)return Am;eT=1;var r=Array.isArray;return Am=r,Am}var Mm,tT;function AU(){if(tT)return Mm;tT=1;var r=Bc(),e=nu(),t=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(r(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||e(a)?!0:n.test(a)||!t.test(a)||s!=null&&a in Object(s)}return Mm=i,Mm}var Dm,rT;function MU(){if(rT)return Dm;rT=1;var r=ZA(),e=ru(),t="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!e(o))return!1;var l=r(o);return l==n||l==i||l==t||l==a}return Dm=s,Dm}var Pm,nT;function DU(){if(nT)return Pm;nT=1;var r=Ac(),e=r["__core-js_shared__"];return Pm=e,Pm}var Bm,iT;function PU(){if(iT)return Bm;iT=1;var r=DU(),e=function(){var n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function t(n){return!!e&&e in n}return Bm=t,Bm}var Om,aT;function BU(){if(aT)return Om;aT=1;var r=Function.prototype,e=r.toString;function t(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return Om=t,Om}var Rm,sT;function OU(){if(sT)return Rm;sT=1;var r=MU(),e=PU(),t=ru(),n=BU(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,l=s.toString,u=o.hasOwnProperty,h=RegExp("^"+l.call(u).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(c){if(!t(c)||e(c))return!1;var d=r(c)?h:a;return d.test(n(c))}return Rm=f,Rm}var Lm,oT;function RU(){if(oT)return Lm;oT=1;function r(e,t){return e?.[t]}return Lm=r,Lm}var Im,lT;function g0(){if(lT)return Im;lT=1;var r=OU(),e=RU();function t(n,i){var a=e(n,i);return r(a)?a:void 0}return Im=t,Im}var Nm,uT;function Oc(){if(uT)return Nm;uT=1;var r=g0(),e=r(Object,"create");return Nm=e,Nm}var qm,hT;function LU(){if(hT)return qm;hT=1;var r=Oc();function e(){this.__data__=r?r(null):{},this.size=0}return qm=e,qm}var Fm,fT;function IU(){if(fT)return Fm;fT=1;function r(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return Fm=r,Fm}var _m,cT;function NU(){if(cT)return _m;cT=1;var r=Oc(),e="__lodash_hash_undefined__",t=Object.prototype,n=t.hasOwnProperty;function i(a){var s=this.__data__;if(r){var o=s[a];return o===e?void 0:o}return n.call(s,a)?s[a]:void 0}return _m=i,_m}var zm,dT;function qU(){if(dT)return zm;dT=1;var r=Oc(),e=Object.prototype,t=e.hasOwnProperty;function n(i){var a=this.__data__;return r?a[i]!==void 0:t.call(a,i)}return zm=n,zm}var Vm,pT;function FU(){if(pT)return Vm;pT=1;var r=Oc(),e="__lodash_hash_undefined__";function t(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=r&&i===void 0?e:i,this}return Vm=t,Vm}var Hm,gT;function _U(){if(gT)return Hm;gT=1;var r=LU(),e=IU(),t=NU(),n=qU(),i=FU();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=r,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=n,a.prototype.set=i,Hm=a,Hm}var Wm,vT;function zU(){if(vT)return Wm;vT=1;function r(){this.__data__=[],this.size=0}return Wm=r,Wm}var Gm,mT;function x2(){if(mT)return Gm;mT=1;function r(e,t){return e===t||e!==e&&t!==t}return Gm=r,Gm}var Um,yT;function Rc(){if(yT)return Um;yT=1;var r=x2();function e(t,n){for(var i=t.length;i--;)if(r(t[i][0],n))return i;return-1}return Um=e,Um}var Km,bT;function VU(){if(bT)return Km;bT=1;var r=Rc(),e=Array.prototype,t=e.splice;function n(i){var a=this.__data__,s=r(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():t.call(a,s,1),--this.size,!0}return Km=n,Km}var jm,wT;function HU(){if(wT)return jm;wT=1;var r=Rc();function e(t){var n=this.__data__,i=r(n,t);return i<0?void 0:n[i][1]}return jm=e,jm}var Ym,xT;function WU(){if(xT)return Ym;xT=1;var r=Rc();function e(t){return r(this.__data__,t)>-1}return Ym=e,Ym}var Xm,ST;function GU(){if(ST)return Xm;ST=1;var r=Rc();function e(t,n){var i=this.__data__,a=r(i,t);return a<0?(++this.size,i.push([t,n])):i[a][1]=n,this}return Xm=e,Xm}var $m,CT;function UU(){if(CT)return $m;CT=1;var r=zU(),e=VU(),t=HU(),n=WU(),i=GU();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=r,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=n,a.prototype.set=i,$m=a,$m}var Zm,kT;function KU(){if(kT)return Zm;kT=1;var r=g0(),e=Ac(),t=r(e,"Map");return Zm=t,Zm}var Qm,ET;function jU(){if(ET)return Qm;ET=1;var r=_U(),e=UU(),t=KU();function n(){this.size=0,this.__data__={hash:new r,map:new(t||e),string:new r}}return Qm=n,Qm}var Jm,TT;function YU(){if(TT)return Jm;TT=1;function r(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return Jm=r,Jm}var ey,AT;function Lc(){if(AT)return ey;AT=1;var r=YU();function e(t,n){var i=t.__data__;return r(n)?i[typeof n=="string"?"string":"hash"]:i.map}return ey=e,ey}var ty,MT;function XU(){if(MT)return ty;MT=1;var r=Lc();function e(t){var n=r(this,t).delete(t);return this.size-=n?1:0,n}return ty=e,ty}var ry,DT;function $U(){if(DT)return ry;DT=1;var r=Lc();function e(t){return r(this,t).get(t)}return ry=e,ry}var ny,PT;function ZU(){if(PT)return ny;PT=1;var r=Lc();function e(t){return r(this,t).has(t)}return ny=e,ny}var iy,BT;function QU(){if(BT)return iy;BT=1;var r=Lc();function e(t,n){var i=r(this,t),a=i.size;return i.set(t,n),this.size+=i.size==a?0:1,this}return iy=e,iy}var ay,OT;function JU(){if(OT)return ay;OT=1;var r=jU(),e=XU(),t=$U(),n=ZU(),i=QU();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=r,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=n,a.prototype.set=i,ay=a,ay}var sy,RT;function eK(){if(RT)return sy;RT=1;var r=JU(),e="Expected a function";function t(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(e);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],l=a.cache;if(l.has(o))return l.get(o);var u=n.apply(this,s);return a.cache=l.set(o,u)||l,u};return a.cache=new(t.Cache||r),a}return t.Cache=r,sy=t,sy}var oy,LT;function tK(){if(LT)return oy;LT=1;var r=eK(),e=500;function t(n){var i=r(n,function(s){return a.size===e&&a.clear(),s}),a=i.cache;return i}return oy=t,oy}var ly,IT;function S2(){if(IT)return ly;IT=1;var r=tK(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,t=/\\(\\)?/g,n=r(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(e,function(s,o,l,u){a.push(l?u.replace(t,"$1"):o||s)}),a});return ly=n,ly}var uy,NT;function C2(){if(NT)return uy;NT=1;function r(e,t){for(var n=-1,i=e==null?0:e.length,a=Array(i);++n<i;)a[n]=t(e[n],n,e);return a}return uy=r,uy}var hy,qT;function rK(){if(qT)return hy;qT=1;var r=s0(),e=C2(),t=Bc(),n=nu(),i=r?r.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(t(o))return e(o,s)+"";if(n(o))return a?a.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}return hy=s,hy}var fy,FT;function k2(){if(FT)return fy;FT=1;var r=rK();function e(t){return t==null?"":r(t)}return fy=e,fy}var cy,_T;function E2(){if(_T)return cy;_T=1;var r=Bc(),e=AU(),t=S2(),n=k2();function i(a,s){return r(a)?a:e(a,s)?[a]:t(n(a))}return cy=i,cy}var dy,zT;function v0(){if(zT)return dy;zT=1;var r=nu();function e(t){if(typeof t=="string"||r(t))return t;var n=t+"";return n=="0"&&1/t==-1/0?"-0":n}return dy=e,dy}var py,VT;function nK(){if(VT)return py;VT=1;var r=E2(),e=v0();function t(n,i){i=r(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[e(i[a++])];return a&&a==s?n:void 0}return py=t,py}var gy,HT;function iK(){if(HT)return gy;HT=1;var r=nK();function e(t,n,i){var a=t==null?void 0:r(t,n);return a===void 0?i:a}return gy=e,gy}var aK=iK(),sK=tu(aK),vy,WT;function oK(){if(WT)return vy;WT=1;var r=g0(),e=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch{}}();return vy=e,vy}var my,GT;function lK(){if(GT)return my;GT=1;var r=oK();function e(t,n,i){n=="__proto__"&&r?r(t,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[n]=i}return my=e,my}var yy,UT;function uK(){if(UT)return yy;UT=1;var r=lK(),e=x2(),t=Object.prototype,n=t.hasOwnProperty;function i(a,s,o){var l=a[s];(!(n.call(a,s)&&e(l,o))||o===void 0&&!(s in a))&&r(a,s,o)}return yy=i,yy}var by,KT;function hK(){if(KT)return by;KT=1;var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(n,i){var a=typeof n;return i=i??r,!!i&&(a=="number"||a!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return by=t,by}var wy,jT;function fK(){if(jT)return wy;jT=1;var r=uK(),e=E2(),t=hK(),n=ru(),i=v0();function a(s,o,l,u){if(!n(s))return s;o=e(o,s);for(var h=-1,f=o.length,c=f-1,d=s;d!=null&&++h<f;){var p=i(o[h]),g=l;if(p==="__proto__"||p==="constructor"||p==="prototype")return s;if(h!=c){var v=d[p];g=u?u(v,p,d):void 0,g===void 0&&(g=n(v)?v:t(o[h+1])?[]:{})}r(d,p,g),d=d[p]}return s}return wy=a,wy}var xy,YT;function cK(){if(YT)return xy;YT=1;var r=fK();function e(t,n,i){return t==null?t:r(t,n,i)}return xy=e,xy}var dK=cK(),pK=tu(dK),Sy,XT;function gK(){if(XT)return Sy;XT=1;function r(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}return Sy=r,Sy}var Cy,$T;function vK(){if($T)return Cy;$T=1;var r=C2(),e=gK(),t=Bc(),n=nu(),i=S2(),a=v0(),s=k2();function o(l){return t(l)?r(l,a):n(l)?[l]:e(i(s(l)))}return Cy=o,Cy}var mK=vK(),yK=tu(mK),bK={data:function(e){var t={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(i){},beforeSet:function(i,a){},onSet:function(i){},canSet:function(i){return!0}};return e=Ce({},t,e),function(i,a){var s=e,o=this,l=o.length!==void 0,u=l?o:[o],h=l?o[0]:o;if(be(i)){var f=i.indexOf(".")!==-1,c=f&&yK(i);if(s.allowGetting&&a===void 0){var d;return h&&(s.beforeGet(h),c&&h._private[s.field][i]===void 0?d=sK(h._private[s.field],c):d=h._private[s.field][i]),d}else if(s.allowSetting&&a!==void 0){var p=!s.immutableKeys[i];if(p){var g=VA({},i,a);s.beforeSet(o,g);for(var v=0,m=u.length;v<m;v++){var y=u[v];s.canSet(y)&&(c&&h._private[s.field][i]===void 0?pK(y._private[s.field],c,a):y._private[s.field][i]=a)}s.updateStyle&&o.updateStyle(),s.onSet(o),s.settingTriggersEvent&&o[s.triggerFnName](s.settingEvent)}}}else if(s.allowSetting&&$e(i)){var b=i,w,S,C=Object.keys(b);s.beforeSet(o,b);for(var x=0;x<C.length;x++){w=C[x],S=b[w];var A=!s.immutableKeys[w];if(A)for(var T=0;T<u.length;T++){var D=u[T];s.canSet(D)&&(D._private[s.field][w]=S)}}s.updateStyle&&o.updateStyle(),s.onSet(o),s.settingTriggersEvent&&o[s.triggerFnName](s.settingEvent)}else if(s.allowBinding&&kt(i)){var k=i;o.on(s.bindingEvent,k)}else if(s.allowGetting&&i===void 0){var E;return h&&(s.beforeGet(h),E=h._private[s.field]),E}return o}},removeData:function(e){var t={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return e=Ce({},t,e),function(i){var a=e,s=this,o=s.length!==void 0,l=o?s:[s];if(be(i)){for(var u=i.split(/\s+/),h=u.length,f=0;f<h;f++){var c=u[f];if(!Fi(c)){var d=!a.immutableKeys[c];if(d)for(var p=0,g=l.length;p<g;p++)l[p]._private[a.field][c]=void 0}}a.triggerEvent&&s[a.triggerFnName](a.event)}else if(i===void 0){for(var v=0,m=l.length;v<m;v++)for(var y=l[v]._private[a.field],b=Object.keys(y),w=0;w<b.length;w++){var S=b[w],C=!a.immutableKeys[S];C&&(y[S]=void 0)}a.triggerEvent&&s[a.triggerFnName](a.event)}return s}}},wK={eventAliasesOn:function(e){var t=e;t.addListener=t.listen=t.bind=t.on,t.unlisten=t.unbind=t.off=t.removeListener,t.trigger=t.emit,t.pon=t.promiseOn=function(n,i){var a=this,s=Array.prototype.slice.call(arguments,0);return new eo(function(o,l){var u=function(d){a.off.apply(a,f),o(d)},h=s.concat([u]),f=h.concat([]);a.on.apply(a,h)})}}},nt={};[TU,bK,wK].forEach(function(r){Ce(nt,r)});var xK={animate:nt.animate(),animation:nt.animation(),animated:nt.animated(),clearQueue:nt.clearQueue(),delay:nt.delay(),delayAnimation:nt.delayAnimation(),stop:nt.stop()},ic={classes:function(e){var t=this;if(e===void 0){var n=[];return t[0]._private.classes.forEach(function(p){return n.push(p)}),n}else ft(e)||(e=(e||"").match(/\S+/g)||[]);for(var i=[],a=new Js(e),s=0;s<t.length;s++){for(var o=t[s],l=o._private,u=l.classes,h=!1,f=0;f<e.length;f++){var c=e[f],d=u.has(c);if(!d){h=!0;break}}h||(h=u.size!==e.length),h&&(l.classes=a,i.push(o))}return i.length>0&&this.spawn(i).updateStyle().emit("class"),t},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var t=this[0];return t!=null&&t._private.classes.has(e)},toggleClass:function(e,t){ft(e)||(e=e.match(/\S+/g)||[]);for(var n=this,i=t===void 0,a=[],s=0,o=n.length;s<o;s++)for(var l=n[s],u=l._private.classes,h=!1,f=0;f<e.length;f++){var c=e[f],d=u.has(c),p=!1;t||i&&!d?(u.add(c),p=!0):(!t||i&&d)&&(u.delete(c),p=!0),!h&&p&&(a.push(l),h=!0)}return a.length>0&&this.spawn(a).updateStyle().emit("class"),n},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,t){var n=this;if(t==null)t=250;else if(t===0)return n;return n.addClass(e),setTimeout(function(){n.removeClass(e)},t),n}};ic.className=ic.classNames=ic.classes;var Xe={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:Vt,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};Xe.variable="(?:[\\w-.]|(?:\\\\"+Xe.metaChar+"))+";Xe.className="(?:[\\w-]|(?:\\\\"+Xe.metaChar+"))+";Xe.value=Xe.string+"|"+Xe.number;Xe.id=Xe.variable;(function(){var r,e,t;for(r=Xe.comparatorOp.split("|"),t=0;t<r.length;t++)e=r[t],Xe.comparatorOp+="|@"+e;for(r=Xe.comparatorOp.split("|"),t=0;t<r.length;t++)e=r[t],!(e.indexOf("!")>=0)&&e!=="="&&(Xe.comparatorOp+="|\\!"+e)})();var lt=function(){return{checks:[]}},fe={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},Gy=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(r,e){return SG(r.selector,e.selector)}),SK=function(){for(var r={},e,t=0;t<Gy.length;t++)e=Gy[t],r[e.selector]=e.matches;return r}(),CK=function(e,t){return SK[e](t)},kK="("+Gy.map(function(r){return r.selector}).join("|")+")",Ls=function(e){return e.replace(new RegExp("\\\\("+Xe.metaChar+")","g"),function(t,n){return n})},Li=function(e,t,n){e[e.length-1]=n},Uy=[{name:"group",query:!0,regex:"("+Xe.group+")",populate:function(e,t,n){var i=zt(n,1),a=i[0];t.checks.push({type:fe.GROUP,value:a==="*"?a:a+"s"})}},{name:"state",query:!0,regex:kK,populate:function(e,t,n){var i=zt(n,1),a=i[0];t.checks.push({type:fe.STATE,value:a})}},{name:"id",query:!0,regex:"\\#("+Xe.id+")",populate:function(e,t,n){var i=zt(n,1),a=i[0];t.checks.push({type:fe.ID,value:Ls(a)})}},{name:"className",query:!0,regex:"\\.("+Xe.className+")",populate:function(e,t,n){var i=zt(n,1),a=i[0];t.checks.push({type:fe.CLASS,value:Ls(a)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+Xe.variable+")\\s*\\]",populate:function(e,t,n){var i=zt(n,1),a=i[0];t.checks.push({type:fe.DATA_EXIST,field:Ls(a)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+Xe.variable+")\\s*("+Xe.comparatorOp+")\\s*("+Xe.value+")\\s*\\]",populate:function(e,t,n){var i=zt(n,3),a=i[0],s=i[1],o=i[2],l=new RegExp("^"+Xe.string+"$").exec(o)!=null;l?o=o.substring(1,o.length-1):o=parseFloat(o),t.checks.push({type:fe.DATA_COMPARE,field:Ls(a),operator:s,value:o})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+Xe.boolOp+")\\s*("+Xe.variable+")\\s*\\]",populate:function(e,t,n){var i=zt(n,2),a=i[0],s=i[1];t.checks.push({type:fe.DATA_BOOL,field:Ls(s),operator:a})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+Xe.meta+")\\s*("+Xe.comparatorOp+")\\s*("+Xe.number+")\\s*\\]\\]",populate:function(e,t,n){var i=zt(n,3),a=i[0],s=i[1],o=i[2];t.checks.push({type:fe.META_COMPARE,field:Ls(a),operator:s,value:parseFloat(o)})}},{name:"nextQuery",separator:!0,regex:Xe.separator,populate:function(e,t){var n=e.currentSubject,i=e.edgeCount,a=e.compoundCount,s=e[e.length-1];n!=null&&(s.subject=n,e.currentSubject=null),s.edgeCount=i,s.compoundCount=a,e.edgeCount=0,e.compoundCount=0;var o=e[e.length++]=lt();return o}},{name:"directedEdge",separator:!0,regex:Xe.directedEdge,populate:function(e,t){if(e.currentSubject==null){var n=lt(),i=t,a=lt();return n.checks.push({type:fe.DIRECTED_EDGE,source:i,target:a}),Li(e,t,n),e.edgeCount++,a}else{var s=lt(),o=t,l=lt();return s.checks.push({type:fe.NODE_SOURCE,source:o,target:l}),Li(e,t,s),e.edgeCount++,l}}},{name:"undirectedEdge",separator:!0,regex:Xe.undirectedEdge,populate:function(e,t){if(e.currentSubject==null){var n=lt(),i=t,a=lt();return n.checks.push({type:fe.UNDIRECTED_EDGE,nodes:[i,a]}),Li(e,t,n),e.edgeCount++,a}else{var s=lt(),o=t,l=lt();return s.checks.push({type:fe.NODE_NEIGHBOR,node:o,neighbor:l}),Li(e,t,s),l}}},{name:"child",separator:!0,regex:Xe.child,populate:function(e,t){if(e.currentSubject==null){var n=lt(),i=lt(),a=e[e.length-1];return n.checks.push({type:fe.CHILD,parent:a,child:i}),Li(e,t,n),e.compoundCount++,i}else if(e.currentSubject===t){var s=lt(),o=e[e.length-1],l=lt(),u=lt(),h=lt(),f=lt();return s.checks.push({type:fe.COMPOUND_SPLIT,left:o,right:l,subject:u}),u.checks=t.checks,t.checks=[{type:fe.TRUE}],f.checks.push({type:fe.TRUE}),l.checks.push({type:fe.PARENT,parent:f,child:h}),Li(e,o,s),e.currentSubject=u,e.compoundCount++,h}else{var c=lt(),d=lt(),p=[{type:fe.PARENT,parent:c,child:d}];return c.checks=t.checks,t.checks=p,e.compoundCount++,d}}},{name:"descendant",separator:!0,regex:Xe.descendant,populate:function(e,t){if(e.currentSubject==null){var n=lt(),i=lt(),a=e[e.length-1];return n.checks.push({type:fe.DESCENDANT,ancestor:a,descendant:i}),Li(e,t,n),e.compoundCount++,i}else if(e.currentSubject===t){var s=lt(),o=e[e.length-1],l=lt(),u=lt(),h=lt(),f=lt();return s.checks.push({type:fe.COMPOUND_SPLIT,left:o,right:l,subject:u}),u.checks=t.checks,t.checks=[{type:fe.TRUE}],f.checks.push({type:fe.TRUE}),l.checks.push({type:fe.ANCESTOR,ancestor:f,descendant:h}),Li(e,o,s),e.currentSubject=u,e.compoundCount++,h}else{var c=lt(),d=lt(),p=[{type:fe.ANCESTOR,ancestor:c,descendant:d}];return c.checks=t.checks,t.checks=p,e.compoundCount++,d}}},{name:"subject",modifier:!0,regex:Xe.subject,populate:function(e,t){if(e.currentSubject!=null&&e.currentSubject!==t)return it("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=t;var n=e[e.length-1],i=n.checks[0],a=i==null?null:i.type;a===fe.DIRECTED_EDGE?i.type=fe.NODE_TARGET:a===fe.UNDIRECTED_EDGE&&(i.type=fe.NODE_NEIGHBOR,i.node=i.nodes[1],i.neighbor=i.nodes[0],i.nodes=null)}}];Uy.forEach(function(r){return r.regexObj=new RegExp("^"+r.regex)});var EK=function(e){for(var t,n,i,a=0;a<Uy.length;a++){var s=Uy[a],o=s.name,l=e.match(s.regexObj);if(l!=null){n=l,t=s,i=o;var u=l[0];e=e.substring(u.length);break}}return{expr:t,match:n,name:i,remaining:e}},TK=function(e){var t=e.match(/^\s+/);if(t){var n=t[0];e=e.substring(n.length)}return e},AK=function(e){var t=this,n=t.inputText=e,i=t[0]=lt();for(t.length=1,n=TK(n);;){var a=EK(n);if(a.expr==null)return it("The selector `"+e+"`is invalid"),!1;var s=a.match.slice(1),o=a.expr.populate(t,i,s);if(o===!1)return!1;if(o!=null&&(i=o),n=a.remaining,n.match(/^\s*$/))break}var l=t[t.length-1];t.currentSubject!=null&&(l.subject=t.currentSubject),l.edgeCount=t.edgeCount,l.compoundCount=t.compoundCount;for(var u=0;u<t.length;u++){var h=t[u];if(h.compoundCount>0&&h.edgeCount>0)return it("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(h.edgeCount>1)return it("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;h.edgeCount===1&&it("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},MK=function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(h){return h??""},t=function(h){return be(h)?'"'+h+'"':e(h)},n=function(h){return" "+h+" "},i=function(h,f){var c=h.type,d=h.value;switch(c){case fe.GROUP:{var p=e(d);return p.substring(0,p.length-1)}case fe.DATA_COMPARE:{var g=h.field,v=h.operator;return"["+g+n(e(v))+t(d)+"]"}case fe.DATA_BOOL:{var m=h.operator,y=h.field;return"["+e(m)+y+"]"}case fe.DATA_EXIST:{var b=h.field;return"["+b+"]"}case fe.META_COMPARE:{var w=h.operator,S=h.field;return"[["+S+n(e(w))+t(d)+"]]"}case fe.STATE:return d;case fe.ID:return"#"+d;case fe.CLASS:return"."+d;case fe.PARENT:case fe.CHILD:return a(h.parent,f)+n(">")+a(h.child,f);case fe.ANCESTOR:case fe.DESCENDANT:return a(h.ancestor,f)+" "+a(h.descendant,f);case fe.COMPOUND_SPLIT:{var C=a(h.left,f),x=a(h.subject,f),A=a(h.right,f);return C+(C.length>0?" ":"")+x+A}case fe.TRUE:return""}},a=function(h,f){return h.checks.reduce(function(c,d,p){return c+(f===h&&p===0?"$":"")+i(d,f)},"")},s="",o=0;o<this.length;o++){var l=this[o];s+=a(l,l.subject),this.length>1&&o<this.length-1&&(s+=", ")}return this.toStringCache=s,s},DK={parse:AK,toString:MK},T2=function(e,t,n){var i,a=be(e),s=se(e),o=be(n),l,u,h=!1,f=!1,c=!1;switch(t.indexOf("!")>=0&&(t=t.replace("!",""),f=!0),t.indexOf("@")>=0&&(t=t.replace("@",""),h=!0),(a||o||h)&&(l=!a&&!s?"":""+e,u=""+n),h&&(e=l=l.toLowerCase(),n=u=u.toLowerCase()),t){case"*=":i=l.indexOf(u)>=0;break;case"$=":i=l.indexOf(u,l.length-u.length)>=0;break;case"^=":i=l.indexOf(u)===0;break;case"=":i=e===n;break;case">":c=!0,i=e>n;break;case">=":c=!0,i=e>=n;break;case"<":c=!0,i=e<n;break;case"<=":c=!0,i=e<=n;break;default:i=!1;break}return f&&(e!=null||!c)&&(i=!i),i},PK=function(e,t){switch(t){case"?":return!!e;case"!":return!e;case"^":return e===void 0}},BK=function(e){return e!==void 0},m0=function(e,t){return e.data(t)},OK=function(e,t){return e[t]()},Tt=[],wt=function(e,t){return e.checks.every(function(n){return Tt[n.type](n,t)})};Tt[fe.GROUP]=function(r,e){var t=r.value;return t==="*"||t===e.group()};Tt[fe.STATE]=function(r,e){var t=r.value;return CK(t,e)};Tt[fe.ID]=function(r,e){var t=r.value;return e.id()===t};Tt[fe.CLASS]=function(r,e){var t=r.value;return e.hasClass(t)};Tt[fe.META_COMPARE]=function(r,e){var t=r.field,n=r.operator,i=r.value;return T2(OK(e,t),n,i)};Tt[fe.DATA_COMPARE]=function(r,e){var t=r.field,n=r.operator,i=r.value;return T2(m0(e,t),n,i)};Tt[fe.DATA_BOOL]=function(r,e){var t=r.field,n=r.operator;return PK(m0(e,t),n)};Tt[fe.DATA_EXIST]=function(r,e){var t=r.field;return r.operator,BK(m0(e,t))};Tt[fe.UNDIRECTED_EDGE]=function(r,e){var t=r.nodes[0],n=r.nodes[1],i=e.source(),a=e.target();return wt(t,i)&&wt(n,a)||wt(n,i)&&wt(t,a)};Tt[fe.NODE_NEIGHBOR]=function(r,e){return wt(r.node,e)&&e.neighborhood().some(function(t){return t.isNode()&&wt(r.neighbor,t)})};Tt[fe.DIRECTED_EDGE]=function(r,e){return wt(r.source,e.source())&&wt(r.target,e.target())};Tt[fe.NODE_SOURCE]=function(r,e){return wt(r.source,e)&&e.outgoers().some(function(t){return t.isNode()&&wt(r.target,t)})};Tt[fe.NODE_TARGET]=function(r,e){return wt(r.target,e)&&e.incomers().some(function(t){return t.isNode()&&wt(r.source,t)})};Tt[fe.CHILD]=function(r,e){return wt(r.child,e)&&wt(r.parent,e.parent())};Tt[fe.PARENT]=function(r,e){return wt(r.parent,e)&&e.children().some(function(t){return wt(r.child,t)})};Tt[fe.DESCENDANT]=function(r,e){return wt(r.descendant,e)&&e.ancestors().some(function(t){return wt(r.ancestor,t)})};Tt[fe.ANCESTOR]=function(r,e){return wt(r.ancestor,e)&&e.descendants().some(function(t){return wt(r.descendant,t)})};Tt[fe.COMPOUND_SPLIT]=function(r,e){return wt(r.subject,e)&&wt(r.left,e)&&wt(r.right,e)};Tt[fe.TRUE]=function(){return!0};Tt[fe.COLLECTION]=function(r,e){var t=r.value;return t.has(e)};Tt[fe.FILTER]=function(r,e){var t=r.value;return t(e)};var RK=function(e){var t=this;if(t.length===1&&t[0].checks.length===1&&t[0].checks[0].type===fe.ID)return e.getElementById(t[0].checks[0].value).collection();var n=function(a){for(var s=0;s<t.length;s++){var o=t[s];if(wt(o,a))return!0}return!1};return t.text()==null&&(n=function(){return!0}),e.filter(n)},LK=function(e){for(var t=this,n=0;n<t.length;n++){var i=t[n];if(wt(i,e))return!0}return!1},IK={matches:LK,filter:RK},Vi=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||be(e)&&e.match(/^\s*$/)||(Wr(e)?this.addQuery({checks:[{type:fe.COLLECTION,value:e.collection()}]}):kt(e)?this.addQuery({checks:[{type:fe.FILTER,value:e}]}):be(e)?this.parse(e)||(this.invalid=!0):Ct("A selector must be created from a string; found "))},Hi=Vi.prototype;[DK,IK].forEach(function(r){return Ce(Hi,r)});Hi.text=function(){return this.inputText};Hi.size=function(){return this.length};Hi.eq=function(r){return this[r]};Hi.sameText=function(r){return!this.invalid&&!r.invalid&&this.text()===r.text()};Hi.addQuery=function(r){this[this.length++]=r};Hi.selector=Hi.toString;var Ni={allAre:function(e){var t=new Vi(e);return this.every(function(n){return t.matches(n)})},is:function(e){var t=new Vi(e);return this.some(function(n){return t.matches(n)})},some:function(e,t){for(var n=0;n<this.length;n++){var i=t?e.apply(t,[this[n],n,this]):e(this[n],n,this);if(i)return!0}return!1},every:function(e,t){for(var n=0;n<this.length;n++){var i=t?e.apply(t,[this[n],n,this]):e(this[n],n,this);if(!i)return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var t=this.length,n=e.length;return t!==n?!1:t===1?this[0]===e[0]:this.every(function(i){return e.hasElementWithId(i.id())})},anySame:function(e){return e=this.cy().collection(e),this.some(function(t){return e.hasElementWithId(t.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var t=this.neighborhood();return e.every(function(n){return t.hasElementWithId(n.id())})},contains:function(e){e=this.cy().collection(e);var t=this;return e.every(function(n){return t.hasElementWithId(n.id())})}};Ni.allAreNeighbours=Ni.allAreNeighbors;Ni.has=Ni.contains;Ni.equal=Ni.equals=Ni.same;var rn=function(e,t){return function(i,a,s,o){var l=i,u=this,h;if(l==null?h="":Wr(l)&&l.length===1&&(h=l.id()),u.length===1&&h){var f=u[0]._private,c=f.traversalCache=f.traversalCache||{},d=c[t]=c[t]||[],p=za(h),g=d[p];return g||(d[p]=e.call(u,i,a,s,o))}else return e.call(u,i,a,s,o)}},Qs={parent:function(e){var t=[];if(this.length===1){var n=this[0]._private.parent;if(n)return n}for(var i=0;i<this.length;i++){var a=this[i],s=a._private.parent;s&&t.push(s)}return this.spawn(t,!0).filter(e)},parents:function(e){for(var t=[],n=this.parent();n.nonempty();){for(var i=0;i<n.length;i++){var a=n[i];t.push(a)}n=n.parent()}return this.spawn(t,!0).filter(e)},commonAncestors:function(e){for(var t,n=0;n<this.length;n++){var i=this[n],a=i.parents();t=t||a,t=t.intersect(a)}return t.filter(e)},orphans:function(e){return this.stdFilter(function(t){return t.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(t){return t.isChild()}).filter(e)},children:rn(function(r){for(var e=[],t=0;t<this.length;t++)for(var n=this[t],i=n._private.children,a=0;a<i.length;a++)e.push(i[a]);return this.spawn(e,!0).filter(r)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var t=[];function n(i){for(var a=0;a<i.length;a++){var s=i[a];t.push(s),s.children().nonempty()&&n(s.children())}}return n(this.children()),this.spawn(t,!0).filter(e)}};function y0(r,e,t,n){for(var i=[],a=new Js,s=r.cy(),o=s.hasCompoundNodes(),l=0;l<r.length;l++){var u=r[l];t?i.push(u):o&&n(i,a,u)}for(;i.length>0;){var h=i.shift();e(h),a.add(h.id()),o&&n(i,a,h)}return r}function A2(r,e,t){if(t.isParent())for(var n=t._private.children,i=0;i<n.length;i++){var a=n[i];e.has(a.id())||r.push(a)}}Qs.forEachDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return y0(this,r,e,A2)};function M2(r,e,t){if(t.isChild()){var n=t._private.parent;e.has(n.id())||r.push(n)}}Qs.forEachUp=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return y0(this,r,e,M2)};function NK(r,e,t){M2(r,e,t),A2(r,e,t)}Qs.forEachUpAndDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return y0(this,r,e,NK)};Qs.ancestors=Qs.parents;var Yl,D2;Yl=D2={data:nt.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:nt.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:nt.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:nt.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:nt.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:nt.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}};Yl.attr=Yl.data;Yl.removeAttr=Yl.removeData;var qK=D2,Ic={};function ky(r){return function(e){var t=this;if(e===void 0&&(e=!0),t.length!==0)if(t.isNode()&&!t.removed()){for(var n=0,i=t[0],a=i._private.edges,s=0;s<a.length;s++){var o=a[s];!e&&o.isLoop()||(n+=r(i,o))}return n}else return}}Ce(Ic,{degree:ky(function(r,e){return e.source().same(e.target())?2:1}),indegree:ky(function(r,e){return e.target().same(r)?1:0}),outdegree:ky(function(r,e){return e.source().same(r)?1:0})});function Is(r,e){return function(t){for(var n,i=this.nodes(),a=0;a<i.length;a++){var s=i[a],o=s[r](t);o!==void 0&&(n===void 0||e(o,n))&&(n=o)}return n}}Ce(Ic,{minDegree:Is("degree",function(r,e){return r<e}),maxDegree:Is("degree",function(r,e){return r>e}),minIndegree:Is("indegree",function(r,e){return r<e}),maxIndegree:Is("indegree",function(r,e){return r>e}),minOutdegree:Is("outdegree",function(r,e){return r<e}),maxOutdegree:Is("outdegree",function(r,e){return r>e})});Ce(Ic,{totalDegree:function(e){for(var t=0,n=this.nodes(),i=0;i<n.length;i++)t+=n[i].degree(e);return t}});var bn,P2,B2=function(e,t,n){for(var i=0;i<e.length;i++){var a=e[i];if(!a.locked()){var s=a._private.position,o={x:t.x!=null?t.x-s.x:0,y:t.y!=null?t.y-s.y:0};a.isParent()&&!(o.x===0&&o.y===0)&&a.children().shift(o,n),a.dirtyBoundingBoxCache()}}},ZT={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,t){B2(e,t,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};bn=P2={position:nt.data(ZT),silentPosition:nt.data(Ce({},ZT,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,t){B2(e,t,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,t){if($e(e))t?this.silentPosition(e):this.position(e);else if(kt(e)){var n=e,i=this.cy();i.startBatch();for(var a=0;a<this.length;a++){var s=this[a],o=void 0;(o=n(s,a))&&(t?s.silentPosition(o):s.position(o))}i.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,t,n){var i;if($e(e)?(i={x:se(e.x)?e.x:0,y:se(e.y)?e.y:0},n=t):be(e)&&se(t)&&(i={x:0,y:0},i[e]=t),i!=null){var a=this.cy();a.startBatch();for(var s=0;s<this.length;s++){var o=this[s];if(!(a.hasCompoundNodes()&&o.isChild()&&o.ancestors().anySame(this))){var l=o.position(),u={x:l.x+i.x,y:l.y+i.y};n?o.silentPosition(u):o.position(u)}}a.endBatch()}return this},silentShift:function(e,t){return $e(e)?this.shift(e,!0):be(e)&&se(t)&&this.shift(e,t,!0),this},renderedPosition:function(e,t){var n=this[0],i=this.cy(),a=i.zoom(),s=i.pan(),o=$e(e)?e:void 0,l=o!==void 0||t!==void 0&&be(e);if(n&&n.isNode())if(l)for(var u=0;u<this.length;u++){var h=this[u];t!==void 0?h.position(e,(t-s[e])/a):o!==void 0&&h.position(s2(o,a,s))}else{var f=n.position();return o=Dc(f,a,s),e===void 0?o:o[e]}else if(!l)return;return this},relativePosition:function(e,t){var n=this[0],i=this.cy(),a=$e(e)?e:void 0,s=a!==void 0||t!==void 0&&be(e),o=i.hasCompoundNodes();if(n&&n.isNode())if(s)for(var l=0;l<this.length;l++){var u=this[l],h=o?u.parent():null,f=h&&h.length>0,c=f;f&&(h=h[0]);var d=c?h.position():{x:0,y:0};t!==void 0?u.position(e,t+d[e]):a!==void 0&&u.position({x:a.x+d.x,y:a.y+d.y})}else{var p=n.position(),g=o?n.parent():null,v=g&&g.length>0,m=v;v&&(g=g[0]);var y=m?g.position():{x:0,y:0};return a={x:p.x-y.x,y:p.y-y.y},e===void 0?a:a[e]}else if(!s)return;return this}};bn.modelPosition=bn.point=bn.position;bn.modelPositions=bn.points=bn.positions;bn.renderedPoint=bn.renderedPosition;bn.relativePoint=bn.relativePosition;var FK=P2,Ys,Ki;Ys=Ki={};Ki.renderedBoundingBox=function(r){var e=this.boundingBox(r),t=this.cy(),n=t.zoom(),i=t.pan(),a=e.x1*n+i.x,s=e.x2*n+i.x,o=e.y1*n+i.y,l=e.y2*n+i.y;return{x1:a,x2:s,y1:o,y2:l,w:s-a,h:l-o}};Ki.dirtyCompoundBoundsCache=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();return!e.styleEnabled()||!e.hasCompoundNodes()?this:(this.forEachUp(function(t){if(t.isParent()){var n=t._private;n.compoundBoundsClean=!1,n.bbCache=null,r||t.emitAndNotify("bounds")}}),this)};Ki.updateCompoundBounds=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!r&&e.batching())return this;function t(s){if(!s.isParent())return;var o=s._private,l=s.children(),u=s.pstyle("compound-sizing-wrt-labels").value==="include",h={width:{val:s.pstyle("min-width").pfValue,left:s.pstyle("min-width-bias-left"),right:s.pstyle("min-width-bias-right")},height:{val:s.pstyle("min-height").pfValue,top:s.pstyle("min-height-bias-top"),bottom:s.pstyle("min-height-bias-bottom")}},f=l.boundingBox({includeLabels:u,includeOverlays:!1,useCache:!1}),c=o.position;(f.w===0||f.h===0)&&(f={w:s.pstyle("width").pfValue,h:s.pstyle("height").pfValue},f.x1=c.x-f.w/2,f.x2=c.x+f.w/2,f.y1=c.y-f.h/2,f.y2=c.y+f.h/2);function d(T,D,k){var E=0,M=0,O=D+k;return T>0&&O>0&&(E=D/O*T,M=k/O*T),{biasDiff:E,biasComplementDiff:M}}function p(T,D,k,E){if(k.units==="%")switch(E){case"width":return T>0?k.pfValue*T:0;case"height":return D>0?k.pfValue*D:0;case"average":return T>0&&D>0?k.pfValue*(T+D)/2:0;case"min":return T>0&&D>0?T>D?k.pfValue*D:k.pfValue*T:0;case"max":return T>0&&D>0?T>D?k.pfValue*T:k.pfValue*D:0;default:return 0}else return k.units==="px"?k.pfValue:0}var g=h.width.left.value;h.width.left.units==="px"&&h.width.val>0&&(g=g*100/h.width.val);var v=h.width.right.value;h.width.right.units==="px"&&h.width.val>0&&(v=v*100/h.width.val);var m=h.height.top.value;h.height.top.units==="px"&&h.height.val>0&&(m=m*100/h.height.val);var y=h.height.bottom.value;h.height.bottom.units==="px"&&h.height.val>0&&(y=y*100/h.height.val);var b=d(h.width.val-f.w,g,v),w=b.biasDiff,S=b.biasComplementDiff,C=d(h.height.val-f.h,m,y),x=C.biasDiff,A=C.biasComplementDiff;o.autoPadding=p(f.w,f.h,s.pstyle("padding"),s.pstyle("padding-relative-to").value),o.autoWidth=Math.max(f.w,h.width.val),c.x=(-w+f.x1+f.x2+S)/2,o.autoHeight=Math.max(f.h,h.height.val),c.y=(-x+f.y1+f.y2+A)/2}for(var n=0;n<this.length;n++){var i=this[n],a=i._private;(!a.compoundBoundsClean||r)&&(t(i),e.batching()||(a.compoundBoundsClean=!0))}return this};var tn=function(e){return e===1/0||e===-1/0?0:e},yn=function(e,t,n,i,a){i-t===0||a-n===0||t==null||n==null||i==null||a==null||(e.x1=t<e.x1?t:e.x1,e.x2=i>e.x2?i:e.x2,e.y1=n<e.y1?n:e.y1,e.y2=a>e.y2?a:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},Ia=function(e,t){return t==null?e:yn(e,t.x1,t.y1,t.x2,t.y2)},Bl=function(e,t,n){return Or(e,t,n)},Yf=function(e,t,n){if(!t.cy().headless()){var i=t._private,a=i.rstyle,s=a.arrowWidth/2,o=t.pstyle(n+"-arrow-shape").value,l,u;if(o!=="none"){n==="source"?(l=a.srcX,u=a.srcY):n==="target"?(l=a.tgtX,u=a.tgtY):(l=a.midX,u=a.midY);var h=i.arrowBounds=i.arrowBounds||{},f=h[n]=h[n]||{};f.x1=l-s,f.y1=u-s,f.x2=l+s,f.y2=u+s,f.w=f.x2-f.x1,f.h=f.y2-f.y1,rc(f,1),yn(e,f.x1,f.y1,f.x2,f.y2)}}},Ey=function(e,t,n){if(!t.cy().headless()){var i;n?i=n+"-":i="";var a=t._private,s=a.rstyle,o=t.pstyle(i+"label").strValue;if(o){var l=t.pstyle("text-halign"),u=t.pstyle("text-valign"),h=Bl(s,"labelWidth",n),f=Bl(s,"labelHeight",n),c=Bl(s,"labelX",n),d=Bl(s,"labelY",n),p=t.pstyle(i+"text-margin-x").pfValue,g=t.pstyle(i+"text-margin-y").pfValue,v=t.isEdge(),m=t.pstyle(i+"text-rotation"),y=t.pstyle("text-outline-width").pfValue,b=t.pstyle("text-border-width").pfValue,w=b/2,S=t.pstyle("text-background-padding").pfValue,C=2,x=f,A=h,T=A/2,D=x/2,k,E,M,O;if(v)k=c-T,E=c+T,M=d-D,O=d+D;else{switch(l.value){case"left":k=c-A,E=c;break;case"center":k=c-T,E=c+T;break;case"right":k=c,E=c+A;break}switch(u.value){case"top":M=d-x,O=d;break;case"center":M=d-D,O=d+D;break;case"bottom":M=d,O=d+x;break}}var R=p-Math.max(y,w)-S-C,L=p+Math.max(y,w)+S+C,I=g-Math.max(y,w)-S-C,N=g+Math.max(y,w)+S+C;k+=R,E+=L,M+=I,O+=N;var q=n||"main",z=a.labelBounds,F=z[q]=z[q]||{};F.x1=k,F.y1=M,F.x2=E,F.y2=O,F.w=E-k,F.h=O-M,F.leftPad=R,F.rightPad=L,F.topPad=I,F.botPad=N;var _=v&&m.strValue==="autorotate",U=m.pfValue!=null&&m.pfValue!==0;if(_||U){var X=_?Bl(a.rstyle,"labelAngle",n):m.pfValue,$=Math.cos(X),Q=Math.sin(X),ee=(k+E)/2,oe=(M+O)/2;if(!v){switch(l.value){case"left":ee=E;break;case"right":ee=k;break}switch(u.value){case"top":oe=O;break;case"bottom":oe=M;break}}var te=function(at,ce){return at=at-ee,ce=ce-oe,{x:at*$-ce*Q+ee,y:at*Q+ce*$+oe}},V=te(k,M),W=te(k,O),K=te(E,M),ie=te(E,O);k=Math.min(V.x,W.x,K.x,ie.x),E=Math.max(V.x,W.x,K.x,ie.x),M=Math.min(V.y,W.y,K.y,ie.y),O=Math.max(V.y,W.y,K.y,ie.y)}var ue=q+"Rot",Me=z[ue]=z[ue]||{};Me.x1=k,Me.y1=M,Me.x2=E,Me.y2=O,Me.w=E-k,Me.h=O-M,yn(e,k,M,E,O),yn(a.labelBounds.all,k,M,E,O)}return e}},_K=function(e,t){if(!t.cy().headless()){var n=t.pstyle("outline-opacity").value,i=t.pstyle("outline-width").value;if(n>0&&i>0){var a=t.pstyle("outline-offset").value,s=t.pstyle("shape").value,o=i+a,l=(e.w+o*2)/e.w,u=(e.h+o*2)/e.h,h=0,f=0;["diamond","pentagon","round-triangle"].includes(s)?(l=(e.w+o*2.4)/e.w,f=-o/3.6):["concave-hexagon","rhomboid","right-rhomboid"].includes(s)?l=(e.w+o*2.4)/e.w:s==="star"?(l=(e.w+o*2.8)/e.w,u=(e.h+o*2.6)/e.h,f=-o/3.8):s==="triangle"?(l=(e.w+o*2.8)/e.w,u=(e.h+o*2.4)/e.h,f=-o/1.4):s==="vee"&&(l=(e.w+o*4.4)/e.w,u=(e.h+o*3.8)/e.h,f=-o*.5);var c=e.h*u-e.h,d=e.w*l-e.w;if(nc(e,[Math.ceil(c/2),Math.ceil(d/2)]),h!=0||f!==0){var p=S8(e,h,f);o2(e,p)}}}},zK=function(e,t){var n=e._private.cy,i=n.styleEnabled(),a=n.headless(),s=Ir(),o=e._private,l=e.isNode(),u=e.isEdge(),h,f,c,d,p,g,v=o.rstyle,m=l&&i?e.pstyle("bounds-expansion").pfValue:[0],y=function(bt){return bt.pstyle("display").value!=="none"},b=!i||y(e)&&(!u||y(e.source())&&y(e.target()));if(b){var w=0,S=0;i&&t.includeOverlays&&(w=e.pstyle("overlay-opacity").value,w!==0&&(S=e.pstyle("overlay-padding").value));var C=0,x=0;i&&t.includeUnderlays&&(C=e.pstyle("underlay-opacity").value,C!==0&&(x=e.pstyle("underlay-padding").value));var A=Math.max(S,x),T=0,D=0;if(i&&(T=e.pstyle("width").pfValue,D=T/2),l&&t.includeNodes){var k=e.position();p=k.x,g=k.y;var E=e.outerWidth(),M=E/2,O=e.outerHeight(),R=O/2;h=p-M,f=p+M,c=g-R,d=g+R,yn(s,h,c,f,d),i&&t.includeOutlines&&_K(s,e)}else if(u&&t.includeEdges)if(i&&!a){var L=e.pstyle("curve-style").strValue;if(h=Math.min(v.srcX,v.midX,v.tgtX),f=Math.max(v.srcX,v.midX,v.tgtX),c=Math.min(v.srcY,v.midY,v.tgtY),d=Math.max(v.srcY,v.midY,v.tgtY),h-=D,f+=D,c-=D,d+=D,yn(s,h,c,f,d),L==="haystack"){var I=v.haystackPts;if(I&&I.length===2){if(h=I[0].x,c=I[0].y,f=I[1].x,d=I[1].y,h>f){var N=h;h=f,f=N}if(c>d){var q=c;c=d,d=q}yn(s,h-D,c-D,f+D,d+D)}}else if(L==="bezier"||L==="unbundled-bezier"||L.endsWith("segments")||L.endsWith("taxi")){var z;switch(L){case"bezier":case"unbundled-bezier":z=v.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":z=v.linePts;break}if(z!=null)for(var F=0;F<z.length;F++){var _=z[F];h=_.x-D,f=_.x+D,c=_.y-D,d=_.y+D,yn(s,h,c,f,d)}}}else{var U=e.source(),X=U.position(),$=e.target(),Q=$.position();if(h=X.x,f=Q.x,c=X.y,d=Q.y,h>f){var ee=h;h=f,f=ee}if(c>d){var oe=c;c=d,d=oe}h-=D,f+=D,c-=D,d+=D,yn(s,h,c,f,d)}if(i&&t.includeEdges&&u&&(Yf(s,e,"mid-source"),Yf(s,e,"mid-target"),Yf(s,e,"source"),Yf(s,e,"target")),i){var te=e.pstyle("ghost").value==="yes";if(te){var V=e.pstyle("ghost-offset-x").pfValue,W=e.pstyle("ghost-offset-y").pfValue;yn(s,s.x1+V,s.y1+W,s.x2+V,s.y2+W)}}var K=o.bodyBounds=o.bodyBounds||{};FE(K,s),nc(K,m),rc(K,1),i&&(h=s.x1,f=s.x2,c=s.y1,d=s.y2,yn(s,h-A,c-A,f+A,d+A));var ie=o.overlayBounds=o.overlayBounds||{};FE(ie,s),nc(ie,m),rc(ie,1);var ue=o.labelBounds=o.labelBounds||{};ue.all!=null?x8(ue.all):ue.all=Ir(),i&&t.includeLabels&&(t.includeMainLabels&&Ey(s,e,null),u&&(t.includeSourceLabels&&Ey(s,e,"source"),t.includeTargetLabels&&Ey(s,e,"target")))}return s.x1=tn(s.x1),s.y1=tn(s.y1),s.x2=tn(s.x2),s.y2=tn(s.y2),s.w=tn(s.x2-s.x1),s.h=tn(s.y2-s.y1),s.w>0&&s.h>0&&b&&(nc(s,m),rc(s,1)),s},O2=function(e){var t=0,n=function(s){return(s?1:0)<<t++},i=0;return i+=n(e.incudeNodes),i+=n(e.includeEdges),i+=n(e.includeLabels),i+=n(e.includeMainLabels),i+=n(e.includeSourceLabels),i+=n(e.includeTargetLabels),i+=n(e.includeOverlays),i+=n(e.includeOutlines),i},R2=function(e){var t=function(o){return Math.round(o)};if(e.isEdge()){var n=e.source().position(),i=e.target().position();return OE([t(n.x),t(n.y),t(i.x),t(i.y)])}else{var a=e.position();return OE([t(a.x),t(a.y)])}},QT=function(e,t){var n=e._private,i,a=e.isEdge(),s=t==null?JT:O2(t),o=s===JT;if(n.bbCache==null?(i=zK(e,Xl),n.bbCache=i,n.bbCachePosKey=R2(e)):i=n.bbCache,!o){var l=e.isNode();i=Ir(),(t.includeNodes&&l||t.includeEdges&&!l)&&(t.includeOverlays?Ia(i,n.overlayBounds):Ia(i,n.bodyBounds)),t.includeLabels&&(t.includeMainLabels&&(!a||t.includeSourceLabels&&t.includeTargetLabels)?Ia(i,n.labelBounds.all):(t.includeMainLabels&&Ia(i,n.labelBounds.mainRot),t.includeSourceLabels&&Ia(i,n.labelBounds.sourceRot),t.includeTargetLabels&&Ia(i,n.labelBounds.targetRot))),i.w=i.x2-i.x1,i.h=i.y2-i.y1}return i},Xl={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},JT=O2(Xl),eA=ar(Xl);Ki.boundingBox=function(r){var e,t=r===void 0||r.useCache===void 0||r.useCache===!0,n=Xs(function(h){var f=h._private;return f.bbCache==null||f.styleDirty||f.bbCachePosKey!==R2(h)},function(h){return h.id()});if(t&&this.length===1&&!n(this[0]))r===void 0?r=Xl:r=eA(r),e=QT(this[0],r);else{e=Ir(),r=r||Xl;var i=eA(r),a=this,s=a.cy(),o=s.styleEnabled();this.edges().forEach(n),this.nodes().forEach(n),o&&this.recalculateRenderedStyle(t),this.updateCompoundBounds(!t);for(var l=0;l<a.length;l++){var u=a[l];n(u)&&u.dirtyBoundingBoxCache(),Ia(e,QT(u,i))}}return e.x1=tn(e.x1),e.y1=tn(e.y1),e.x2=tn(e.x2),e.y2=tn(e.y2),e.w=tn(e.x2-e.x1),e.h=tn(e.y2-e.y1),e};Ki.dirtyBoundingBoxCache=function(){for(var r=0;r<this.length;r++){var e=this[r]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};Ki.boundingBoxAt=function(r){var e=this.nodes(),t=this.cy(),n=t.hasCompoundNodes(),i=t.collection();if(n&&(i=e.filter(function(u){return u.isParent()}),e=e.not(i)),$e(r)){var a=r;r=function(){return a}}var s=function(h,f){return h._private.bbAtOldPos=r(h,f)},o=function(h){return h._private.bbAtOldPos};t.startBatch(),e.forEach(s).silentPositions(r),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0));var l=w8(this.boundingBox({useCache:!1}));return e.silentPositions(o),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0)),t.endBatch(),l};Ys.boundingbox=Ys.bb=Ys.boundingBox;Ys.renderedBoundingbox=Ys.renderedBoundingBox;var VK=Ki,Fl,su;Fl=su={};var L2=function(e){e.uppercaseName=mE(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=mE(e.outerName),Fl[e.name]=function(){var n=this[0],i=n._private,a=i.cy,s=a._private.styleEnabled;if(n)if(s){if(n.isParent())return n.updateCompoundBounds(),i[e.autoName]||0;var o=n.pstyle(e.name);switch(o.strValue){case"label":return n.recalculateRenderedStyle(),i.rstyle[e.labelName]||0;default:return o.pfValue}}else return 1},Fl["outer"+e.uppercaseName]=function(){var n=this[0],i=n._private,a=i.cy,s=a._private.styleEnabled;if(n)if(s){var o=n[e.name](),l=n.pstyle("border-position").value,u;l==="center"?u=n.pstyle("border-width").pfValue:l==="outside"?u=2*n.pstyle("border-width").pfValue:u=0;var h=2*n.padding();return o+u+h}else return 1},Fl["rendered"+e.uppercaseName]=function(){var n=this[0];if(n){var i=n[e.name]();return i*this.cy().zoom()}},Fl["rendered"+e.uppercaseOuterName]=function(){var n=this[0];if(n){var i=n[e.outerName]();return i*this.cy().zoom()}}};L2({name:"width"});L2({name:"height"});su.padding=function(){var r=this[0],e=r._private;return r.isParent()?(r.updateCompoundBounds(),e.autoPadding!==void 0?e.autoPadding:r.pstyle("padding").pfValue):r.pstyle("padding").pfValue};su.paddedHeight=function(){var r=this[0];return r.height()+2*r.padding()};su.paddedWidth=function(){var r=this[0];return r.width()+2*r.padding()};var HK=su,WK=function(e,t){if(e.isEdge()&&e.takesUpSpace())return t(e)},GK=function(e,t){if(e.isEdge()&&e.takesUpSpace()){var n=e.cy();return Dc(t(e),n.zoom(),n.pan())}},UK=function(e,t){if(e.isEdge()&&e.takesUpSpace()){var n=e.cy(),i=n.pan(),a=n.zoom();return t(e).map(function(s){return Dc(s,a,i)})}},KK=function(e){return e.renderer().getControlPoints(e)},jK=function(e){return e.renderer().getSegmentPoints(e)},YK=function(e){return e.renderer().getSourceEndpoint(e)},XK=function(e){return e.renderer().getTargetEndpoint(e)},$K=function(e){return e.renderer().getEdgeMidpoint(e)},tA={controlPoints:{get:KK,mult:!0},segmentPoints:{get:jK,mult:!0},sourceEndpoint:{get:YK},targetEndpoint:{get:XK},midpoint:{get:$K}},ZK=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)},QK=Object.keys(tA).reduce(function(r,e){var t=tA[e],n=ZK(e);return r[e]=function(){return WK(this,t.get)},t.mult?r[n]=function(){return UK(this,t.get)}:r[n]=function(){return GK(this,t.get)},r},{}),JK=Ce({},FK,VK,HK,QK);var I2=function(e,t){this.recycle(e,t)};function Ol(){return!1}function Xf(){return!0}I2.prototype={instanceString:function(){return"event"},recycle:function(e,t){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=Ol,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?Xf:Ol):e!=null&&e.type?t=e:this.type=e,t!=null&&(this.originalEvent=t.originalEvent,this.type=t.type!=null?t.type:this.type,this.cy=t.cy,this.target=t.target,this.position=t.position,this.renderedPosition=t.renderedPosition,this.namespace=t.namespace,this.layout=t.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var n=this.position,i=this.cy.zoom(),a=this.cy.pan();this.renderedPosition={x:n.x*i+a.x,y:n.y*i+a.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=Xf;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=Xf;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Xf,this.stopPropagation()},isDefaultPrevented:Ol,isPropagationStopped:Ol,isImmediatePropagationStopped:Ol};var N2=/^([^.]+)(\.(?:[^.]+))?$/,e9=".*",q2={qualifierCompare:function(e,t){return e===t},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},rA=Object.keys(q2),t9={};function Nc(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t9,e=arguments.length>1?arguments[1]:void 0,t=0;t<rA.length;t++){var n=rA[t];this[n]=r[n]||q2[n]}this.context=e||this.context,this.listeners=[],this.emitting=0}var Wi=Nc.prototype,F2=function(e,t,n,i,a,s,o){kt(i)&&(a=i,i=null),o&&(s==null?s=o:s=Ce({},s,o));for(var l=ft(n)?n:n.split(/\s+/),u=0;u<l.length;u++){var h=l[u];if(!Fi(h)){var f=h.match(N2);if(f){var c=f[1],d=f[2]?f[2]:null,p=t(e,h,c,d,i,a,s);if(p===!1)break}}}},nA=function(e,t){return e.addEventFields(e.context,t),new I2(t.type,t)},r9=function(e,t,n){if(fG(n)){t(e,n);return}else if($e(n)){t(e,nA(e,n));return}for(var i=ft(n)?n:n.split(/\s+/),a=0;a<i.length;a++){var s=i[a];if(!Fi(s)){var o=s.match(N2);if(o){var l=o[1],u=o[2]?o[2]:null,h=nA(e,{type:l,namespace:u,target:e.context});t(e,h)}}}};Wi.on=Wi.addListener=function(r,e,t,n,i){return F2(this,function(a,s,o,l,u,h,f){kt(h)&&a.listeners.push({event:s,callback:h,type:o,namespace:l,qualifier:u,conf:f})},r,e,t,n,i),this};Wi.one=function(r,e,t,n){return this.on(r,e,t,n,{one:!0})};Wi.removeListener=Wi.off=function(r,e,t,n){var i=this;this.emitting!==0&&(this.listeners=GG(this.listeners));for(var a=this.listeners,s=function(u){var h=a[u];F2(i,function(f,c,d,p,g,v){if((h.type===d||r==="*")&&(!p&&h.namespace!==".*"||h.namespace===p)&&(!g||f.qualifierCompare(h.qualifier,g))&&(!v||h.callback===v))return a.splice(u,1),!1},r,e,t,n)},o=a.length-1;o>=0;o--)s(o);return this};Wi.removeAllListeners=function(){return this.removeListener("*")};Wi.emit=Wi.trigger=function(r,e,t){var n=this.listeners,i=n.length;return this.emitting++,ft(e)||(e=[e]),r9(this,function(a,s){t!=null&&(n=[{event:s.event,type:s.type,namespace:s.namespace,callback:t}],i=n.length);for(var o=function(){var h=n[l];if(h.type===s.type&&(!h.namespace||h.namespace===s.namespace||h.namespace===e9)&&a.eventMatches(a.context,h,s)){var f=[s];e!=null&&KG(f,e),a.beforeEmit(a.context,h,s),h.conf&&h.conf.one&&(a.listeners=a.listeners.filter(function(p){return p!==h}));var c=a.callbackContext(a.context,h,s),d=h.callback.apply(c,f);a.afterEmit(a.context,h,s),d===!1&&(s.stopPropagation(),s.preventDefault())}},l=0;l<i;l++)o();a.bubble(a.context)&&!s.isPropagationStopped()&&a.parent(a.context).emit(s,e)},r),this.emitting--,this};var n9={qualifierCompare:function(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function(e,t,n){var i=t.qualifier;return i!=null?e!==n.target&&eu(n.target)&&i.matches(n.target):!0},addEventFields:function(e,t){t.cy=e.cy(),t.target=e},callbackContext:function(e,t,n){return t.qualifier!=null?n.target:e},beforeEmit:function(e,t){t.conf&&t.conf.once&&t.conf.onceCollection.removeListener(t.event,t.qualifier,t.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},$f=function(e){return be(e)?new Vi(e):e},_2={createEmitter:function(){for(var e=0;e<this.length;e++){var t=this[e],n=t._private;n.emitter||(n.emitter=new Nc(n9,t))}return this},emitter:function(){return this._private.emitter},on:function(e,t,n){for(var i=$f(t),a=0;a<this.length;a++){var s=this[a];s.emitter().on(e,i,n)}return this},removeListener:function(e,t,n){for(var i=$f(t),a=0;a<this.length;a++){var s=this[a];s.emitter().removeListener(e,i,n)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){var t=this[e];t.emitter().removeAllListeners()}return this},one:function(e,t,n){for(var i=$f(t),a=0;a<this.length;a++){var s=this[a];s.emitter().one(e,i,n)}return this},once:function(e,t,n){for(var i=$f(t),a=0;a<this.length;a++){var s=this[a];s.emitter().on(e,i,n,{once:!0,onceCollection:this})}},emit:function(e,t){for(var n=0;n<this.length;n++){var i=this[n];i.emitter().emit(e,t)}return this},emitAndNotify:function(e,t){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,t),this}};nt.eventAliasesOn(_2);var z2={nodes:function(e){return this.filter(function(t){return t.isNode()}).filter(e)},edges:function(e){return this.filter(function(t){return t.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),t=this.spawn(),n=0;n<this.length;n++){var i=this[n];i.isNode()?e.push(i):t.push(i)}return{nodes:e,edges:t}},filter:function(e,t){if(e===void 0)return this;if(be(e)||Wr(e))return new Vi(e).filter(this);if(kt(e)){for(var n=this.spawn(),i=this,a=0;a<i.length;a++){var s=i[a],o=t?e.apply(t,[s,a,i]):e(s,a,i);o&&n.push(s)}return n}return this.spawn()},not:function(e){if(e){be(e)&&(e=this.filter(e));for(var t=this.spawn(),n=0;n<this.length;n++){var i=this[n],a=e.has(i);a||t.push(i)}return t}else return this},absoluteComplement:function(){var e=this.cy();return e.mutableElements().not(this)},intersect:function(e){if(be(e)){var t=e;return this.filter(t)}for(var n=this.spawn(),i=this,a=e,s=this.length<e.length,o=s?i:a,l=s?a:i,u=0;u<o.length;u++){var h=o[u];l.has(h)&&n.push(h)}return n},xor:function(e){var t=this._private.cy;be(e)&&(e=t.$(e));var n=this.spawn(),i=this,a=e,s=function(l,u){for(var h=0;h<l.length;h++){var f=l[h],c=f._private.data.id,d=u.hasElementWithId(c);d||n.push(f)}};return s(i,a),s(a,i),n},diff:function(e){var t=this._private.cy;be(e)&&(e=t.$(e));var n=this.spawn(),i=this.spawn(),a=this.spawn(),s=this,o=e,l=function(h,f,c){for(var d=0;d<h.length;d++){var p=h[d],g=p._private.data.id,v=f.hasElementWithId(g);v?a.merge(p):c.push(p)}};return l(s,o,n),l(o,s,i),{left:n,right:i,both:a}},add:function(e){var t=this._private.cy;if(!e)return this;if(be(e)){var n=e;e=t.mutableElements().filter(n)}for(var i=this.spawnSelf(),a=0;a<e.length;a++){var s=e[a],o=!this.has(s);o&&i.push(s)}return i},merge:function(e){var t=this._private,n=t.cy;if(!e)return this;if(e&&be(e)){var i=e;e=n.mutableElements().filter(i)}for(var a=t.map,s=0;s<e.length;s++){var o=e[s],l=o._private.data.id,u=!a.has(l);if(u){var h=this.length++;this[h]=o,a.set(l,{ele:o,index:h})}}return this},unmergeAt:function(e){var t=this[e],n=t.id(),i=this._private,a=i.map;this[e]=void 0,a.delete(n);var s=e===this.length-1;if(this.length>1&&!s){var o=this.length-1,l=this[o],u=l._private.data.id;this[o]=void 0,this[e]=l,a.set(u,{ele:l,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var t=this._private,n=e._private.data.id,i=t.map,a=i.get(n);if(!a)return this;var s=a.index;return this.unmergeAt(s),this},unmerge:function(e){var t=this._private.cy;if(!e)return this;if(e&&be(e)){var n=e;e=t.mutableElements().filter(n)}for(var i=0;i<e.length;i++)this.unmergeOne(e[i]);return this},unmergeBy:function(e){for(var t=this.length-1;t>=0;t--){var n=this[t];e(n)&&this.unmergeAt(t)}return this},map:function(e,t){for(var n=[],i=this,a=0;a<i.length;a++){var s=i[a],o=t?e.apply(t,[s,a,i]):e(s,a,i);n.push(o)}return n},reduce:function(e,t){for(var n=t,i=this,a=0;a<i.length;a++)n=e(n,i[a],a,i);return n},max:function(e,t){for(var n=-1/0,i,a=this,s=0;s<a.length;s++){var o=a[s],l=t?e.apply(t,[o,s,a]):e(o,s,a);l>n&&(n=l,i=o)}return{value:n,ele:i}},min:function(e,t){for(var n=1/0,i,a=this,s=0;s<a.length;s++){var o=a[s],l=t?e.apply(t,[o,s,a]):e(o,s,a);l<n&&(n=l,i=o)}return{value:n,ele:i}}},Je=z2;Je.u=Je["|"]=Je["+"]=Je.union=Je.or=Je.add;Je["\\"]=Je["!"]=Je["-"]=Je.difference=Je.relativeComplement=Je.subtract=Je.not;Je.n=Je["&"]=Je["."]=Je.and=Je.intersection=Je.intersect;Je["^"]=Je["(+)"]=Je["(-)"]=Je.symmetricDifference=Je.symdiff=Je.xor;Je.fnFilter=Je.filterFn=Je.stdFilter=Je.filter;Je.complement=Je.abscomp=Je.absoluteComplement;var i9={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},V2=function(e,t){var n=e.cy(),i=n.hasCompoundNodes();function a(h){var f=h.pstyle("z-compound-depth");return f.value==="auto"?i?h.zDepth():0:f.value==="bottom"?-1:f.value==="top"?o0:0}var s=a(e)-a(t);if(s!==0)return s;function o(h){var f=h.pstyle("z-index-compare");return f.value==="auto"&&h.isNode()?1:0}var l=o(e)-o(t);if(l!==0)return l;var u=e.pstyle("z-index").value-t.pstyle("z-index").value;return u!==0?u:e.poolIndex()-t.poolIndex()},bc={forEach:function(e,t){if(kt(e))for(var n=this.length,i=0;i<n;i++){var a=this[i],s=t?e.apply(t,[a,i,this]):e(a,i,this);if(s===!1)break}return this},toArray:function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t]);return e},slice:function(e,t){var n=[],i=this.length;t==null&&(t=i),e==null&&(e=0),e<0&&(e=i+e),t<0&&(t=i+t);for(var a=e;a>=0&&a<t&&a<i;a++)n.push(this[a]);return this.spawn(n)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!kt(e))return this;var t=this.toArray().sort(e);return this.spawn(t)},sortByZIndex:function(){return this.sort(V2)},zDepth:function(){var e=this[0];if(e){var t=e._private,n=t.group;if(n==="nodes"){var i=t.data.parent?e.parents().size():0;return e.isParent()?i:o0-1}else{var a=t.source,s=t.target,o=a.zDepth(),l=s.zDepth();return Math.max(o,l,0)}}}};bc.each=bc.forEach;var a9=function(){var e="undefined",t=(typeof Symbol>"u"?"undefined":Ht(Symbol))!=e&&Ht(Symbol.iterator)!=e;t&&(bc[Symbol.iterator]=function(){var n=this,i={value:void 0,done:!1},a=0,s=this.length;return VA({next:function(){return a<s?i.value=n[a++]:(i.value=void 0,i.done=!0),i}},Symbol.iterator,function(){return this})})};a9();var s9=ar({nodeDimensionsIncludeLabels:!1}),ac={layoutDimensions:function(e){e=s9(e);var t;if(!this.takesUpSpace())t={w:0,h:0};else if(e.nodeDimensionsIncludeLabels){var n=this.boundingBox();t={w:n.w,h:n.h}}else t={w:this.outerWidth(),h:this.outerHeight()};return(t.w===0||t.h===0)&&(t.w=t.h=1),t},layoutPositions:function(e,t,n){var i=this.nodes().filter(function(S){return!S.isParent()}),a=this.cy(),s=t.eles,o=function(C){return C.id()},l=Xs(n,o);e.emit({type:"layoutstart",layout:e}),e.animations=[];var u=function(C,x,A){var T={x:x.x1+x.w/2,y:x.y1+x.h/2},D={x:(A.x-T.x)*C,y:(A.y-T.y)*C};return{x:T.x+D.x,y:T.y+D.y}},h=t.spacingFactor&&t.spacingFactor!==1,f=function(){if(!h)return null;for(var C=Ir(),x=0;x<i.length;x++){var A=i[x],T=l(A,x);C8(C,T.x,T.y)}return C},c=f(),d=Xs(function(S,C){var x=l(S,C);if(h){var A=Math.abs(t.spacingFactor);x=u(A,c,x)}return t.transform!=null&&(x=t.transform(S,x)),x},o);if(t.animate){for(var p=0;p<i.length;p++){var g=i[p],v=d(g,p),m=t.animateFilter==null||t.animateFilter(g,p);if(m){var y=g.animation({position:v,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(y)}else g.position(v)}if(t.fit){var b=a.animation({fit:{boundingBox:s.boundingBoxAt(d),padding:t.padding},duration:t.animationDuration,easing:t.animationEasing});e.animations.push(b)}else if(t.zoom!==void 0&&t.pan!==void 0){var w=a.animation({zoom:t.zoom,pan:t.pan,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(w)}e.animations.forEach(function(S){return S.play()}),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),eo.all(e.animations.map(function(S){return S.promise()})).then(function(){e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e})})}else i.positions(d),t.fit&&a.fit(t.eles,t.padding),t.zoom!=null&&a.zoom(t.zoom),t.pan&&a.pan(t.pan),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){var t=this.cy();return t.makeLayout(Ce({},e,{eles:this}))}};ac.createLayout=ac.makeLayout=ac.layout;function H2(r,e,t){var n=t._private,i=n.styleCache=n.styleCache||[],a;return(a=i[r])!=null||(a=i[r]=e(t)),a}function qc(r,e){return r=za(r),function(n){return H2(r,e,n)}}function Fc(r,e){r=za(r);var t=function(i){return e.call(i)};return function(){var i=this[0];if(i)return H2(r,t,i)}}var nr={recalculateRenderedStyle:function(e){var t=this.cy(),n=t.renderer(),i=t.styleEnabled();return n&&i&&n.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e=this.cy(),t=function(a){return a._private.styleCache=null};if(e.hasCompoundNodes()){var n;n=this.spawnSelf().merge(this.descendants()).merge(this.parents()),n.merge(n.connectedEdges()),n.forEach(t)}else this.forEach(function(i){t(i),i.connectedEdges().forEach(t)});return this},updateStyle:function(e){var t=this._private.cy;if(!t.styleEnabled())return this;if(t.batching()){var n=t._private.batchStyleEles;return n.merge(this),this}var i=t.hasCompoundNodes(),a=this;e=!!(e||e===void 0),i&&(a=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var s=a;return e?s.emitAndNotify("style"):s.emit("style"),a.forEach(function(o){return o._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(e.styleEnabled())for(var t=0;t<this.length;t++){var n=this[t];n._private.styleDirty&&(n._private.styleDirty=!1,e.style().apply(n))}},parsedStyle:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this[0],i=n.cy();if(i.styleEnabled()&&n){n._private.styleDirty&&(n._private.styleDirty=!1,i.style().apply(n));var a=n._private.style[e];return a??(t?i.style().getDefaultProperty(e):null)}},numericStyle:function(e){var t=this[0];if(t.cy().styleEnabled()&&t){var n=t.pstyle(e);return n.pfValue!==void 0?n.pfValue:n.value}},numericStyleUnits:function(e){var t=this[0];if(t.cy().styleEnabled()&&t)return t.pstyle(e).units},renderedStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var n=this[0];if(n)return t.style().getRenderedStyle(n,e)},style:function(e,t){var n=this.cy();if(!n.styleEnabled())return this;var i=!1,a=n.style();if($e(e)){var s=e;a.applyBypass(this,s,i),this.emitAndNotify("style")}else if(be(e))if(t===void 0){var o=this[0];return o?a.getStylePropertyValue(o,e):void 0}else a.applyBypass(this,e,t,i),this.emitAndNotify("style");else if(e===void 0){var l=this[0];return l?a.getRawStyle(l):void 0}return this},removeStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var n=!1,i=t.style(),a=this;if(e===void 0)for(var s=0;s<a.length;s++){var o=a[s];i.removeAllBypasses(o,n)}else{e=e.split(/\s+/);for(var l=0;l<a.length;l++){var u=a[l];i.removeBypasses(u,e,n)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var t=e.hasCompoundNodes(),n=this[0];if(n){var i=n._private,a=n.pstyle("opacity").value;if(!t)return a;var s=i.data.parent?n.parents():null;if(s)for(var o=0;o<s.length;o++){var l=s[o],u=l.pstyle("opacity").value;a=u*a}return a}},transparent:function(){var e=this.cy();if(!e.styleEnabled())return!1;var t=this[0],n=t.cy().hasCompoundNodes();if(t)return n?t.effectiveOpacity()===0:t.pstyle("opacity").value===0},backgrounding:function(){var e=this.cy();if(!e.styleEnabled())return!1;var t=this[0];return!!t._private.backgrounding}};function Ty(r,e){var t=r._private,n=t.data.parent?r.parents():null;if(n)for(var i=0;i<n.length;i++){var a=n[i];if(!e(a))return!1}return!0}function b0(r){var e=r.ok,t=r.edgeOkViaNode||r.ok,n=r.parentOk||r.ok;return function(){var i=this.cy();if(!i.styleEnabled())return!0;var a=this[0],s=i.hasCompoundNodes();if(a){var o=a._private;if(!e(a))return!1;if(a.isNode())return!s||Ty(a,n);var l=o.source,u=o.target;return t(l)&&(!s||Ty(l,t))&&(l===u||t(u)&&(!s||Ty(u,t)))}}}var to=qc("eleTakesUpSpace",function(r){return r.pstyle("display").value==="element"&&r.width()!==0&&(r.isNode()?r.height()!==0:!0)});nr.takesUpSpace=Fc("takesUpSpace",b0({ok:to}));var o9=qc("eleInteractive",function(r){return r.pstyle("events").value==="yes"&&r.pstyle("visibility").value==="visible"&&to(r)}),l9=qc("parentInteractive",function(r){return r.pstyle("visibility").value==="visible"&&to(r)});nr.interactive=Fc("interactive",b0({ok:o9,parentOk:l9,edgeOkViaNode:to}));nr.noninteractive=function(){var r=this[0];if(r)return!r.interactive()};var u9=qc("eleVisible",function(r){return r.pstyle("visibility").value==="visible"&&r.pstyle("opacity").pfValue!==0&&to(r)}),h9=to;nr.visible=Fc("visible",b0({ok:u9,edgeOkViaNode:h9}));nr.hidden=function(){var r=this[0];if(r)return!r.visible()};nr.isBundledBezier=Fc("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});nr.bypass=nr.css=nr.style;nr.renderedCss=nr.renderedStyle;nr.removeBypass=nr.removeCss=nr.removeStyle;nr.pstyle=nr.parsedStyle;var qi={};function iA(r){return function(){var e=arguments,t=[];if(e.length===2){var n=e[0],i=e[1];this.on(r.event,n,i)}else if(e.length===1&&kt(e[0])){var a=e[0];this.on(r.event,a)}else if(e.length===0||e.length===1&&ft(e[0])){for(var s=e.length===1?e[0]:null,o=0;o<this.length;o++){var l=this[o],u=!r.ableField||l._private[r.ableField],h=l._private[r.field]!=r.value;if(r.overrideAble){var f=r.overrideAble(l);if(f!==void 0&&(u=f,!f))return this}u&&(l._private[r.field]=r.value,h&&t.push(l))}var c=this.spawn(t);c.updateStyle(),c.emit(r.event),s&&c.emit(s)}return this}}function ro(r){qi[r.field]=function(){var e=this[0];if(e){if(r.overrideField){var t=r.overrideField(e);if(t!==void 0)return t}return e._private[r.field]}},qi[r.on]=iA({event:r.on,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!0}),qi[r.off]=iA({event:r.off,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!1})}ro({field:"locked",overrideField:function(e){return e.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});ro({field:"grabbable",overrideField:function(e){return e.cy().autoungrabify()||e.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});ro({field:"selected",ableField:"selectable",overrideAble:function(e){return e.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});ro({field:"selectable",overrideField:function(e){return e.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});qi.deselect=qi.unselect;qi.grabbed=function(){var r=this[0];if(r)return r._private.grabbed};ro({field:"active",on:"activate",off:"unactivate"});ro({field:"pannable",on:"panify",off:"unpanify"});qi.inactive=function(){var r=this[0];if(r)return!r._private.active};var pr={},aA=function(e){return function(n){for(var i=this,a=[],s=0;s<i.length;s++){var o=i[s];if(o.isNode()){for(var l=!1,u=o.connectedEdges(),h=0;h<u.length;h++){var f=u[h],c=f.source(),d=f.target();if(e.noIncomingEdges&&d===o&&c!==o||e.noOutgoingEdges&&c===o&&d!==o){l=!0;break}}l||a.push(o)}}return this.spawn(a,!0).filter(n)}},sA=function(e){return function(t){for(var n=this,i=[],a=0;a<n.length;a++){var s=n[a];if(s.isNode())for(var o=s.connectedEdges(),l=0;l<o.length;l++){var u=o[l],h=u.source(),f=u.target();e.outgoing&&h===s?(i.push(u),i.push(f)):e.incoming&&f===s&&(i.push(u),i.push(h))}}return this.spawn(i,!0).filter(t)}},oA=function(e){return function(t){for(var n=this,i=[],a={};;){var s=e.outgoing?n.outgoers():n.incomers();if(s.length===0)break;for(var o=!1,l=0;l<s.length;l++){var u=s[l],h=u.id();a[h]||(a[h]=!0,i.push(u),o=!0)}if(!o)break;n=s}return this.spawn(i,!0).filter(t)}};pr.clearTraversalCache=function(){for(var r=0;r<this.length;r++)this[r]._private.traversalCache=null};Ce(pr,{roots:aA({noIncomingEdges:!0}),leaves:aA({noOutgoingEdges:!0}),outgoers:rn(sA({outgoing:!0}),"outgoers"),successors:oA({outgoing:!0}),incomers:rn(sA({incoming:!0}),"incomers"),predecessors:oA({})});Ce(pr,{neighborhood:rn(function(r){for(var e=[],t=this.nodes(),n=0;n<t.length;n++)for(var i=t[n],a=i.connectedEdges(),s=0;s<a.length;s++){var o=a[s],l=o.source(),u=o.target(),h=i===l?u:l;h.length>0&&e.push(h[0]),e.push(o[0])}return this.spawn(e,!0).filter(r)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}});pr.neighbourhood=pr.neighborhood;pr.closedNeighbourhood=pr.closedNeighborhood;pr.openNeighbourhood=pr.openNeighborhood;Ce(pr,{source:rn(function(e){var t=this[0],n;return t&&(n=t._private.source||t.cy().collection()),n&&e?n.filter(e):n},"source"),target:rn(function(e){var t=this[0],n;return t&&(n=t._private.target||t.cy().collection()),n&&e?n.filter(e):n},"target"),sources:lA({attr:"source"}),targets:lA({attr:"target"})});function lA(r){return function(t){for(var n=[],i=0;i<this.length;i++){var a=this[i],s=a._private[r.attr];s&&n.push(s)}return this.spawn(n,!0).filter(t)}}Ce(pr,{edgesWith:rn(uA(),"edgesWith"),edgesTo:rn(uA({thisIsSrc:!0}),"edgesTo")});function uA(r){return function(t){var n=[],i=this._private.cy,a=r||{};be(t)&&(t=i.$(t));for(var s=0;s<t.length;s++)for(var o=t[s]._private.edges,l=0;l<o.length;l++){var u=o[l],h=u._private.data,f=this.hasElementWithId(h.source)&&t.hasElementWithId(h.target),c=t.hasElementWithId(h.source)&&this.hasElementWithId(h.target),d=f||c;d&&((a.thisIsSrc||a.thisIsTgt)&&(a.thisIsSrc&&!f||a.thisIsTgt&&!c)||n.push(u))}return this.spawn(n,!0)}}Ce(pr,{connectedEdges:rn(function(r){for(var e=[],t=this,n=0;n<t.length;n++){var i=t[n];if(i.isNode())for(var a=i._private.edges,s=0;s<a.length;s++){var o=a[s];e.push(o)}}return this.spawn(e,!0).filter(r)},"connectedEdges"),connectedNodes:rn(function(r){for(var e=[],t=this,n=0;n<t.length;n++){var i=t[n];i.isEdge()&&(e.push(i.source()[0]),e.push(i.target()[0]))}return this.spawn(e,!0).filter(r)},"connectedNodes"),parallelEdges:rn(hA(),"parallelEdges"),codirectedEdges:rn(hA({codirected:!0}),"codirectedEdges")});function hA(r){var e={codirected:!1};return r=Ce({},e,r),function(n){for(var i=[],a=this.edges(),s=r,o=0;o<a.length;o++)for(var l=a[o],u=l._private,h=u.source,f=h._private.data.id,c=u.data.target,d=h._private.edges,p=0;p<d.length;p++){var g=d[p],v=g._private.data,m=v.target,y=v.source,b=m===c&&y===f,w=f===m&&c===y;(s.codirected&&b||!s.codirected&&(b||w))&&i.push(g)}return this.spawn(i,!0).filter(n)}}Ce(pr,{components:function(e){var t=this,n=t.cy(),i=n.collection(),a=e==null?t.nodes():e.nodes(),s=[];e!=null&&a.empty()&&(a=e.sources());var o=function(h,f){i.merge(h),a.unmerge(h),f.merge(h)};if(a.empty())return t.spawn();var l=function(){var h=n.collection();s.push(h);var f=a[0];o(f,h),t.bfs({directed:!1,roots:f,visit:function(d){return o(d,h)}}),h.forEach(function(c){c.connectedEdges().forEach(function(d){t.has(d)&&h.has(d.source())&&h.has(d.target())&&h.merge(d)})})};do l();while(a.length>0);return s},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});pr.componentsOf=pr.components;var ir=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e===void 0){Ct("A collection must have a reference to the core");return}var a=new ii,s=!1;if(!t)t=[];else if(t.length>0&&$e(t[0])&&!eu(t[0])){s=!0;for(var o=[],l=new Js,u=0,h=t.length;u<h;u++){var f=t[u];f.data==null&&(f.data={});var c=f.data;if(c.id==null)c.id=i2();else if(e.hasElementWithId(c.id)||l.has(c.id))continue;var d=new Mc(e,f,!1);o.push(d),l.add(c.id)}t=o}this.length=0;for(var p=0,g=t.length;p<g;p++){var v=t[p][0];if(v!=null){var m=v._private.data.id;(!n||!a.has(m))&&(n&&a.set(m,{index:this.length,ele:v}),this[this.length]=v,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(y){this.lazyMap=y},rebuildMap:function(){for(var b=this.lazyMap=new ii,w=this.eles,S=0;S<w.length;S++){var C=w[S];b.set(C.id(),{index:S,ele:C})}}},n&&(this._private.map=a),s&&!i&&this.restore()},mt=Mc.prototype=ir.prototype=Object.create(Array.prototype);mt.instanceString=function(){return"collection"};mt.spawn=function(r,e){return new ir(this.cy(),r,e)};mt.spawnSelf=function(){return this.spawn(this)};mt.cy=function(){return this._private.cy};mt.renderer=function(){return this._private.cy.renderer()};mt.element=function(){return this[0]};mt.collection=function(){return GA(this)?this:new ir(this._private.cy,[this])};mt.unique=function(){return new ir(this._private.cy,this,!0)};mt.hasElementWithId=function(r){return r=""+r,this._private.map.has(r)};mt.getElementById=function(r){r=""+r;var e=this._private.cy,t=this._private.map.get(r);return t?t.ele:new ir(e)};mt.$id=mt.getElementById;mt.poolIndex=function(){var r=this._private.cy,e=r._private.elements,t=this[0]._private.data.id;return e._private.map.get(t).index};mt.indexOf=function(r){var e=r[0]._private.data.id;return this._private.map.get(e).index};mt.indexOfId=function(r){return r=""+r,this._private.map.get(r).index};mt.json=function(r){var e=this.element(),t=this.cy();if(e==null&&r)return this;if(e!=null){var n=e._private;if($e(r)){if(t.startBatch(),r.data){e.data(r.data);var i=n.data;if(e.isEdge()){var a=!1,s={},o=r.data.source,l=r.data.target;o!=null&&o!=i.source&&(s.source=""+o,a=!0),l!=null&&l!=i.target&&(s.target=""+l,a=!0),a&&(e=e.move(s))}else{var u="parent"in r.data,h=r.data.parent;u&&(h!=null||i.parent!=null)&&h!=i.parent&&(h===void 0&&(h=null),h!=null&&(h=""+h),e=e.move({parent:h}))}}r.position&&e.position(r.position);var f=function(g,v,m){var y=r[g];y!=null&&y!==n[g]&&(y?e[v]():e[m]())};return f("removed","remove","restore"),f("selected","select","unselect"),f("selectable","selectify","unselectify"),f("locked","lock","unlock"),f("grabbable","grabify","ungrabify"),f("pannable","panify","unpanify"),r.classes!=null&&e.classes(r.classes),t.endBatch(),this}else if(r===void 0){var c={data:Fn(n.data),position:Fn(n.position),group:n.group,removed:n.removed,selected:n.selected,selectable:n.selectable,locked:n.locked,grabbable:n.grabbable,pannable:n.pannable,classes:null};c.classes="";var d=0;return n.classes.forEach(function(p){return c.classes+=d++===0?p:" "+p}),c}}};mt.jsons=function(){for(var r=[],e=0;e<this.length;e++){var t=this[e],n=t.json();r.push(n)}return r};mt.clone=function(){for(var r=this.cy(),e=[],t=0;t<this.length;t++){var n=this[t],i=n.json(),a=new Mc(r,i,!1);e.push(a)}return new ir(r,e)};mt.copy=mt.clone;mt.restore=function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this,n=t.cy(),i=n._private,a=[],s=[],o,l=0,u=t.length;l<u;l++){var h=t[l];e&&!h.removed()||(h.isNode()?a.push(h):s.push(h))}o=a.concat(s);var f,c=function(){o.splice(f,1),f--};for(f=0;f<o.length;f++){var d=o[f],p=d._private,g=p.data;if(d.clearTraversalCache(),!(!e&&!p.removed)){if(g.id===void 0)g.id=i2();else if(se(g.id))g.id=""+g.id;else if(Fi(g.id)||!be(g.id)){Ct("Can not create element with invalid string ID `"+g.id+"`"),c();continue}else if(n.hasElementWithId(g.id)){Ct("Can not create second element with ID `"+g.id+"`"),c();continue}}var v=g.id;if(d.isNode()){var m=p.position;m.x==null&&(m.x=0),m.y==null&&(m.y=0)}if(d.isEdge()){for(var y=d,b=["source","target"],w=b.length,S=!1,C=0;C<w;C++){var x=b[C],A=g[x];se(A)&&(A=g[x]=""+g[x]),A==null||A===""?(Ct("Can not create edge `"+v+"` with unspecified "+x),S=!0):n.hasElementWithId(A)||(Ct("Can not create edge `"+v+"` with nonexistant "+x+" `"+A+"`"),S=!0)}if(S){c();continue}var T=n.getElementById(g.source),D=n.getElementById(g.target);T.same(D)?T._private.edges.push(y):(T._private.edges.push(y),D._private.edges.push(y)),y._private.source=T,y._private.target=D}p.map=new ii,p.map.set(v,{ele:d,index:0}),p.removed=!1,e&&n.addToPool(d)}for(var k=0;k<a.length;k++){var E=a[k],M=E._private.data;se(M.parent)&&(M.parent=""+M.parent);var O=M.parent,R=O!=null;if(R||E._private.parent){var L=E._private.parent?n.collection().merge(E._private.parent):n.getElementById(O);if(L.empty())M.parent=void 0;else if(L[0].removed())it("Node added with missing parent, reference to parent removed"),M.parent=void 0,E._private.parent=null;else{for(var I=!1,N=L;!N.empty();){if(E.same(N)){I=!0,M.parent=void 0;break}N=N.parent()}I||(L[0]._private.children.push(E),E._private.parent=L[0],i.hasCompoundNodes=!0)}}}if(o.length>0){for(var q=o.length===t.length?t:new ir(n,o),z=0;z<q.length;z++){var F=q[z];F.isNode()||(F.parallelEdges().clearTraversalCache(),F.source().clearTraversalCache(),F.target().clearTraversalCache())}var _;i.hasCompoundNodes?_=n.collection().merge(q).merge(q.connectedNodes()).merge(q.parent()):_=q,_.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(r),r?q.emitAndNotify("add"):e&&q.emit("add")}return t};mt.removed=function(){var r=this[0];return r&&r._private.removed};mt.inside=function(){var r=this[0];return r&&!r._private.removed};mt.remove=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=this,n=[],i={},a=t._private.cy;function s(O){for(var R=O._private.edges,L=0;L<R.length;L++)l(R[L])}function o(O){for(var R=O._private.children,L=0;L<R.length;L++)l(R[L])}function l(O){var R=i[O.id()];e&&O.removed()||R||(i[O.id()]=!0,O.isNode()?(n.push(O),s(O),o(O)):n.unshift(O))}for(var u=0,h=t.length;u<h;u++){var f=t[u];l(f)}function c(O,R){var L=O._private.edges;_i(L,R),O.clearTraversalCache()}function d(O){O.clearTraversalCache()}var p=[];p.ids={};function g(O,R){R=R[0],O=O[0];var L=O._private.children,I=O.id();_i(L,R),R._private.parent=null,p.ids[I]||(p.ids[I]=!0,p.push(O))}t.dirtyCompoundBoundsCache(),e&&a.removeFromPool(n);for(var v=0;v<n.length;v++){var m=n[v];if(m.isEdge()){var y=m.source()[0],b=m.target()[0];c(y,m),c(b,m);for(var w=m.parallelEdges(),S=0;S<w.length;S++){var C=w[S];d(C),C.isBundledBezier()&&C.dirtyBoundingBoxCache()}}else{var x=m.parent();x.length!==0&&g(x,m)}e&&(m._private.removed=!0)}var A=a._private.elements;a._private.hasCompoundNodes=!1;for(var T=0;T<A.length;T++){var D=A[T];if(D.isParent()){a._private.hasCompoundNodes=!0;break}}var k=new ir(this.cy(),n);k.size()>0&&(r?k.emitAndNotify("remove"):e&&k.emit("remove"));for(var E=0;E<p.length;E++){var M=p[E];(!e||!M.removed())&&M.updateStyle()}return k};mt.move=function(r){var e=this._private.cy,t=this,n=!1,i=!1,a=function(p){return p==null?p:""+p};if(r.source!==void 0||r.target!==void 0){var s=a(r.source),o=a(r.target),l=s!=null&&e.hasElementWithId(s),u=o!=null&&e.hasElementWithId(o);(l||u)&&(e.batch(function(){t.remove(n,i),t.emitAndNotify("moveout");for(var d=0;d<t.length;d++){var p=t[d],g=p._private.data;p.isEdge()&&(l&&(g.source=s),u&&(g.target=o))}t.restore(n,i)}),t.emitAndNotify("move"))}else if(r.parent!==void 0){var h=a(r.parent),f=h===null||e.hasElementWithId(h);if(f){var c=h===null?void 0:h;e.batch(function(){var d=t.remove(n,i);d.emitAndNotify("moveout");for(var p=0;p<t.length;p++){var g=t[p],v=g._private.data;g.isNode()&&(v.parent=c)}d.restore(n,i)}),t.emitAndNotify("move")}}return this};[g2,xK,ic,Ni,Qs,qK,Ic,JK,_2,z2,i9,bc,ac,nr,qi,pr].forEach(function(r){Ce(mt,r)});var f9={add:function(e){var t,n=this;if(Wr(e)){var i=e;if(i._private.cy===n)t=i.restore();else{for(var a=[],s=0;s<i.length;s++){var o=i[s];a.push(o.json())}t=new ir(n,a)}}else if(ft(e)){var l=e;t=new ir(n,l)}else if($e(e)&&(ft(e.nodes)||ft(e.edges))){for(var u=e,h=[],f=["nodes","edges"],c=0,d=f.length;c<d;c++){var p=f[c],g=u[p];if(ft(g))for(var v=0,m=g.length;v<m;v++){var y=Ce({group:p},g[v]);h.push(y)}}t=new ir(n,h)}else{var b=e;t=new Mc(n,b).collection()}return t},remove:function(e){if(!Wr(e)){if(be(e)){var t=e;e=this.$(t)}}return e.remove()}};function c9(r,e,t,n){var i=4,a=.001,s=1e-7,o=10,l=11,u=1/(l-1),h=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var f=0;f<4;++f)if(typeof arguments[f]!="number"||isNaN(arguments[f])||!isFinite(arguments[f]))return!1;r=Math.min(r,1),t=Math.min(t,1),r=Math.max(r,0),t=Math.max(t,0);var c=h?new Float32Array(l):new Array(l);function d(D,k){return 1-3*k+3*D}function p(D,k){return 3*k-6*D}function g(D){return 3*D}function v(D,k,E){return((d(k,E)*D+p(k,E))*D+g(k))*D}function m(D,k,E){return 3*d(k,E)*D*D+2*p(k,E)*D+g(k)}function y(D,k){for(var E=0;E<i;++E){var M=m(k,r,t);if(M===0)return k;var O=v(k,r,t)-D;k-=O/M}return k}function b(){for(var D=0;D<l;++D)c[D]=v(D*u,r,t)}function w(D,k,E){var M,O,R=0;do O=k+(E-k)/2,M=v(O,r,t)-D,M>0?E=O:k=O;while(Math.abs(M)>s&&++R<o);return O}function S(D){for(var k=0,E=1,M=l-1;E!==M&&c[E]<=D;++E)k+=u;--E;var O=(D-c[E])/(c[E+1]-c[E]),R=k+O*u,L=m(R,r,t);return L>=a?y(D,R):L===0?R:w(D,k,k+u)}var C=!1;function x(){C=!0,(r!==e||t!==n)&&b()}var A=function(k){return C||x(),r===e&&t===n?k:k===0?0:k===1?1:v(S(k),e,n)};A.getControlPoints=function(){return[{x:r,y:e},{x:t,y:n}]};var T="generateBezier("+[r,e,t,n]+")";return A.toString=function(){return T},A}var d9=function(){function r(n){return-n.tension*n.x-n.friction*n.v}function e(n,i,a){var s={x:n.x+a.dx*i,v:n.v+a.dv*i,tension:n.tension,friction:n.friction};return{dx:s.v,dv:r(s)}}function t(n,i){var a={dx:n.v,dv:r(n)},s=e(n,i*.5,a),o=e(n,i*.5,s),l=e(n,i,o),u=1/6*(a.dx+2*(s.dx+o.dx)+l.dx),h=1/6*(a.dv+2*(s.dv+o.dv)+l.dv);return n.x=n.x+u*i,n.v=n.v+h*i,n}return function n(i,a,s){var o={x:-1,v:0,tension:null,friction:null},l=[0],u=0,h=1/1e4,f=16/1e3,c,d,p;for(i=parseFloat(i)||500,a=parseFloat(a)||20,s=s||null,o.tension=i,o.friction=a,c=s!==null,c?(u=n(i,a),d=u/s*f):d=f;p=t(p||o,d),l.push(1+p.x),u+=16,Math.abs(p.x)>h&&Math.abs(p.v)>h;);return c?function(g){return l[g*(l.length-1)|0]}:u}}(),vt=function(e,t,n,i){var a=c9(e,t,n,i);return function(s,o,l){return s+(o-s)*a(l)}},sc={linear:function(e,t,n){return e+(t-e)*n},ease:vt(.25,.1,.25,1),"ease-in":vt(.42,0,1,1),"ease-out":vt(0,0,.58,1),"ease-in-out":vt(.42,0,.58,1),"ease-in-sine":vt(.47,0,.745,.715),"ease-out-sine":vt(.39,.575,.565,1),"ease-in-out-sine":vt(.445,.05,.55,.95),"ease-in-quad":vt(.55,.085,.68,.53),"ease-out-quad":vt(.25,.46,.45,.94),"ease-in-out-quad":vt(.455,.03,.515,.955),"ease-in-cubic":vt(.55,.055,.675,.19),"ease-out-cubic":vt(.215,.61,.355,1),"ease-in-out-cubic":vt(.645,.045,.355,1),"ease-in-quart":vt(.895,.03,.685,.22),"ease-out-quart":vt(.165,.84,.44,1),"ease-in-out-quart":vt(.77,0,.175,1),"ease-in-quint":vt(.755,.05,.855,.06),"ease-out-quint":vt(.23,1,.32,1),"ease-in-out-quint":vt(.86,0,.07,1),"ease-in-expo":vt(.95,.05,.795,.035),"ease-out-expo":vt(.19,1,.22,1),"ease-in-out-expo":vt(1,0,0,1),"ease-in-circ":vt(.6,.04,.98,.335),"ease-out-circ":vt(.075,.82,.165,1),"ease-in-out-circ":vt(.785,.135,.15,.86),spring:function(e,t,n){if(n===0)return sc.linear;var i=d9(e,t,n);return function(a,s,o){return a+(s-a)*i(o)}},"cubic-bezier":vt};function fA(r,e,t,n,i){if(n===1||e===t)return t;var a=i(e,t,n);return r==null||((r.roundValue||r.color)&&(a=Math.round(a)),r.min!==void 0&&(a=Math.max(a,r.min)),r.max!==void 0&&(a=Math.min(a,r.max))),a}function cA(r,e){return r.pfValue!=null||r.value!=null?r.pfValue!=null&&(e==null||e.type.units!=="%")?r.pfValue:r.value:r}function Ns(r,e,t,n,i){var a=i!=null?i.type:null;t<0?t=0:t>1&&(t=1);var s=cA(r,i),o=cA(e,i);if(se(s)&&se(o))return fA(a,s,o,t,n);if(ft(s)&&ft(o)){for(var l=[],u=0;u<o.length;u++){var h=s[u],f=o[u];if(h!=null&&f!=null){var c=fA(a,h,f,t,n);l.push(c)}else l.push(f)}return l}}function p9(r,e,t,n){var i=!n,a=r._private,s=e._private,o=s.easing,l=s.startTime,u=n?r:r.cy(),h=u.style();if(!s.easingImpl)if(o==null)s.easingImpl=sc.linear;else{var f;if(be(o)){var c=h.parse("transition-timing-function",o);f=c.value}else f=o;var d,p;be(f)?(d=f,p=[]):(d=f[1],p=f.slice(2).map(function(q){return+q})),p.length>0?(d==="spring"&&p.push(s.duration),s.easingImpl=sc[d].apply(null,p)):s.easingImpl=sc[d]}var g=s.easingImpl,v;if(s.duration===0?v=1:v=(t-l)/s.duration,s.applying&&(v=s.progress),v<0?v=0:v>1&&(v=1),s.delay==null){var m=s.startPosition,y=s.position;if(y&&i&&!r.locked()){var b={};Rl(m.x,y.x)&&(b.x=Ns(m.x,y.x,v,g)),Rl(m.y,y.y)&&(b.y=Ns(m.y,y.y,v,g)),r.position(b)}var w=s.startPan,S=s.pan,C=a.pan,x=S!=null&&n;x&&(Rl(w.x,S.x)&&(C.x=Ns(w.x,S.x,v,g)),Rl(w.y,S.y)&&(C.y=Ns(w.y,S.y,v,g)),r.emit("pan"));var A=s.startZoom,T=s.zoom,D=T!=null&&n;D&&(Rl(A,T)&&(a.zoom=Kl(a.minZoom,Ns(A,T,v,g),a.maxZoom)),r.emit("zoom")),(x||D)&&r.emit("viewport");var k=s.style;if(k&&k.length>0&&i){for(var E=0;E<k.length;E++){var M=k[E],O=M.name,R=M,L=s.startStyle[O],I=h.properties[L.name],N=Ns(L,R,v,g,I);h.overrideBypass(r,O,N)}r.emit("style")}}return s.progress=v,v}function Rl(r,e){return r==null||e==null?!1:se(r)&&se(e)?!0:!!(r&&e)}function g9(r,e,t,n){var i=e._private;i.started=!0,i.startTime=t-i.progress*i.duration}function dA(r,e){var t=e._private.aniEles,n=[];function i(h,f){var c=h._private,d=c.animation.current,p=c.animation.queue,g=!1;if(d.length===0){var v=p.shift();v&&d.push(v)}for(var m=function(C){for(var x=C.length-1;x>=0;x--){var A=C[x];A()}C.splice(0,C.length)},y=d.length-1;y>=0;y--){var b=d[y],w=b._private;if(w.stopped){d.splice(y,1),w.hooked=!1,w.playing=!1,w.started=!1,m(w.frames);continue}!w.playing&&!w.applying||(w.playing&&w.applying&&(w.applying=!1),w.started||g9(h,b,r),p9(h,b,r,f),w.applying&&(w.applying=!1),m(w.frames),w.step!=null&&w.step(r),b.completed()&&(d.splice(y,1),w.hooked=!1,w.playing=!1,w.started=!1,m(w.completes)),g=!0)}return!f&&d.length===0&&p.length===0&&n.push(h),g}for(var a=!1,s=0;s<t.length;s++){var o=t[s],l=i(o);a=a||l}var u=i(e,!0);(a||u)&&(t.length>0?e.notify("draw",t):e.notify("draw")),t.unmerge(n),e.emit("step")}var v9={animate:nt.animate(),animation:nt.animation(),animated:nt.animated(),clearQueue:nt.clearQueue(),delay:nt.delay(),delayAnimation:nt.delayAnimation(),stop:nt.stop(),addToAnimationPool:function(e){var t=this;t.styleEnabled()&&t._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,!e.styleEnabled())return;function t(){e._private.animationsRunning&&pc(function(a){dA(a,e),t()})}var n=e.renderer();n&&n.beforeRender?n.beforeRender(function(a,s){dA(s,e)},n.beforeRenderPriorities.animations):t()}},m9={qualifierCompare:function(e,t){return e==null||t==null?e==null&&t==null:e.sameText(t)},eventMatches:function(e,t,n){var i=t.qualifier;return i!=null?e!==n.target&&eu(n.target)&&i.matches(n.target):!0},addEventFields:function(e,t){t.cy=e,t.target=e},callbackContext:function(e,t,n){return t.qualifier!=null?n.target:e}},Zf=function(e){return be(e)?new Vi(e):e},W2={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new Nc(m9,this)),this},emitter:function(){return this._private.emitter},on:function(e,t,n){return this.emitter().on(e,Zf(t),n),this},removeListener:function(e,t,n){return this.emitter().removeListener(e,Zf(t),n),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,t,n){return this.emitter().one(e,Zf(t),n),this},once:function(e,t,n){return this.emitter().one(e,Zf(t),n),this},emit:function(e,t){return this.emitter().emit(e,t),this},emitAndNotify:function(e,t){return this.emit(e),this.notify(e,t),this}};nt.eventAliasesOn(W2);var Ky={png:function(e){var t=this._private.renderer;return e=e||{},t.png(e)},jpg:function(e){var t=this._private.renderer;return e=e||{},e.bg=e.bg||"#fff",t.jpg(e)}};Ky.jpeg=Ky.jpg;var oc={layout:function(e){var t=this;if(e==null){Ct("Layout options must be specified to make a layout");return}if(e.name==null){Ct("A `name` must be specified to make a layout");return}var n=e.name,i=t.extension("layout",n);if(i==null){Ct("No such layout `"+n+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var a;be(e.eles)?a=t.$(e.eles):a=e.eles!=null?e.eles:t.$();var s=new i(Ce({},e,{cy:t,eles:a}));return s}};oc.createLayout=oc.makeLayout=oc.layout;var y9={notify:function(e,t){var n=this._private;if(this.batching()){n.batchNotifications=n.batchNotifications||{};var i=n.batchNotifications[e]=n.batchNotifications[e]||this.collection();t!=null&&i.merge(t);return}if(n.notificationsEnabled){var a=this.renderer();this.destroyed()||!a||a.notify(e,t)}},notifications:function(e){var t=this._private;return e===void 0?t.notificationsEnabled:(t.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var t=this.renderer();Object.keys(e.batchNotifications).forEach(function(n){var i=e.batchNotifications[n];i.empty()?t.notify(n):t.notify(n,i)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var t=this;return this.batch(function(){for(var n=Object.keys(e),i=0;i<n.length;i++){var a=n[i],s=e[a],o=t.getElementById(a);o.data(s)}})}},b9=ar({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),jy={renderTo:function(e,t,n,i){var a=this._private.renderer;return a.renderTo(e,t,n,i),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var t=this,n=t.extension("renderer",e.name);if(n==null){Ct("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}e.wheelSensitivity!==void 0&&it("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var i=b9(e);i.cy=t,t._private.renderer=new n(i),this.notify("init")},destroyRenderer:function(){var e=this;e.notify("destroy");var t=e.container();if(t)for(t._cyreg=null;t.childNodes.length>0;)t.removeChild(t.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(n){var i=n._private;i.rscratch={},i.rstyle={},i.animation.current=[],i.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};jy.invalidateDimensions=jy.resize;var lc={collection:function(e,t){return be(e)?this.$(e):Wr(e)?e.collection():ft(e)?(t||(t={}),new ir(this,e,t.unique,t.removed)):new ir(this)},nodes:function(e){var t=this.$(function(n){return n.isNode()});return e?t.filter(e):t},edges:function(e){var t=this.$(function(n){return n.isEdge()});return e?t.filter(e):t},$:function(e){var t=this._private.elements;return e?t.filter(e):t.spawnSelf()},mutableElements:function(){return this._private.elements}};lc.elements=lc.filter=lc.$;var Xt={},zl="t",w9="f";Xt.apply=function(r){for(var e=this,t=e._private,n=t.cy,i=n.collection(),a=0;a<r.length;a++){var s=r[a],o=e.getContextMeta(s);if(!o.empty){var l=e.getContextStyle(o),u=e.applyContextStyle(o,l,s);s._private.appliedInitStyle?e.updateTransitions(s,u.diffProps):s._private.appliedInitStyle=!0;var h=e.updateStyleHints(s);h&&i.push(s)}}return i};Xt.getPropertiesDiff=function(r,e){var t=this,n=t._private.propDiffs=t._private.propDiffs||{},i=r+"-"+e,a=n[i];if(a)return a;for(var s=[],o={},l=0;l<t.length;l++){var u=t[l],h=r[l]===zl,f=e[l]===zl,c=h!==f,d=u.mappedProperties.length>0;if(c||f&&d){var p=void 0;c&&d||c?p=u.properties:d&&(p=u.mappedProperties);for(var g=0;g<p.length;g++){for(var v=p[g],m=v.name,y=!1,b=l+1;b<t.length;b++){var w=t[b],S=e[b]===zl;if(S&&(y=w.properties[v.name]!=null,y))break}!o[m]&&!y&&(o[m]=!0,s.push(m))}}}return n[i]=s,s};Xt.getContextMeta=function(r){for(var e=this,t="",n,i=r._private.styleCxtKey||"",a=0;a<e.length;a++){var s=e[a],o=s.selector&&s.selector.matches(r);o?t+=zl:t+=w9}return n=e.getPropertiesDiff(i,t),r._private.styleCxtKey=t,{key:t,diffPropNames:n,empty:n.length===0}};Xt.getContextStyle=function(r){var e=r.key,t=this,n=this._private.contextStyles=this._private.contextStyles||{};if(n[e])return n[e];for(var i={_private:{key:e}},a=0;a<t.length;a++){var s=t[a],o=e[a]===zl;if(o)for(var l=0;l<s.properties.length;l++){var u=s.properties[l];i[u.name]=u}}return n[e]=i,i};Xt.applyContextStyle=function(r,e,t){for(var n=this,i=r.diffPropNames,a={},s=n.types,o=0;o<i.length;o++){var l=i[o],u=e[l],h=t.pstyle(l);if(!u)if(h)h.bypass?u={name:l,deleteBypassed:!0}:u={name:l,delete:!0};else continue;if(h!==u){if(u.mapped===s.fn&&h!=null&&h.mapping!=null&&h.mapping.value===u.value){var f=h.mapping,c=f.fnValue=u.value(t);if(c===f.prevFnValue)continue}var d=a[l]={prev:h};n.applyParsedProperty(t,u),d.next=t.pstyle(l),d.next&&d.next.bypass&&(d.next=d.next.bypassed)}}return{diffProps:a}};Xt.updateStyleHints=function(r){var e=r._private,t=this,n=t.propertyGroupNames,i=t.propertyGroupKeys,a=function(K,ie,ue){return t.getPropertiesHash(K,ie,ue)},s=e.styleKey;if(r.removed())return!1;var o=e.group==="nodes",l=r._private.style;n=Object.keys(l);for(var u=0;u<i.length;u++){var h=i[u];e.styleKeys[h]=[qa,Vs]}for(var f=function(K,ie){return e.styleKeys[ie][0]=Wl(K,e.styleKeys[ie][0])},c=function(K,ie){return e.styleKeys[ie][1]=Gl(K,e.styleKeys[ie][1])},d=function(K,ie){f(K,ie),c(K,ie)},p=function(K,ie){for(var ue=0;ue<K.length;ue++){var Me=K.charCodeAt(ue);f(Me,ie),c(Me,ie)}},g=2e9,v=function(K){return-128<K&&K<128&&Math.floor(K)!==K?g-(K*1024|0):K},m=0;m<n.length;m++){var y=n[m],b=l[y];if(b!=null){var w=this.properties[y],S=w.type,C=w.groupKey,x=void 0;w.hashOverride!=null?x=w.hashOverride(r,b):b.pfValue!=null&&(x=b.pfValue);var A=w.enums==null?b.value:null,T=x!=null,D=A!=null,k=T||D,E=b.units;if(S.number&&k&&!S.multiple){var M=T?x:A;d(v(M),C),!T&&E!=null&&p(E,C)}else p(b.strValue,C)}}for(var O=[qa,Vs],R=0;R<i.length;R++){var L=i[R],I=e.styleKeys[L];O[0]=Wl(I[0],O[0]),O[1]=Gl(I[1],O[1])}e.styleKey=_G(O[0],O[1]);var N=e.styleKeys;e.labelDimsKey=Ri(N.labelDimensions);var q=a(r,["label"],N.labelDimensions);if(e.labelKey=Ri(q),e.labelStyleKey=Ri(Wf(N.commonLabel,q)),!o){var z=a(r,["source-label"],N.labelDimensions);e.sourceLabelKey=Ri(z),e.sourceLabelStyleKey=Ri(Wf(N.commonLabel,z));var F=a(r,["target-label"],N.labelDimensions);e.targetLabelKey=Ri(F),e.targetLabelStyleKey=Ri(Wf(N.commonLabel,F))}if(o){var _=e.styleKeys,U=_.nodeBody,X=_.nodeBorder,$=_.nodeOutline,Q=_.backgroundImage,ee=_.compound,oe=_.pie,te=_.stripe,V=[U,X,$,Q,ee,oe,te].filter(function(W){return W!=null}).reduce(Wf,[qa,Vs]);e.nodeKey=Ri(V),e.hasPie=oe!=null&&oe[0]!==qa&&oe[1]!==Vs,e.hasStripe=te!=null&&te[0]!==qa&&te[1]!==Vs}return s!==e.styleKey};Xt.clearStyleHints=function(r){var e=r._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null,e.hasStripe=null};Xt.applyParsedProperty=function(r,e){var t=this,n=e,i=r._private.style,a,s=t.types,o=t.properties[n.name].type,l=n.bypass,u=i[n.name],h=u&&u.bypass,f=r._private,c="mapping",d=function(U){return U==null?null:U.pfValue!=null?U.pfValue:U.value},p=function(){var U=d(u),X=d(n);t.checkTriggers(r,n.name,U,X)};if(e.name==="curve-style"&&r.isEdge()&&(e.value!=="bezier"&&r.isLoop()||e.value==="haystack"&&(r.source().isParent()||r.target().isParent()))&&(n=e=this.parse(e.name,"bezier",l)),n.delete)return i[n.name]=void 0,p(),!0;if(n.deleteBypassed)return u?u.bypass?(u.bypassed=void 0,p(),!0):!1:(p(),!0);if(n.deleteBypass)return u?u.bypass?(i[n.name]=u.bypassed,p(),!0):!1:(p(),!0);var g=function(){it("Do not assign mappings to elements without corresponding data (i.e. ele `"+r.id()+"` has no mapping for property `"+n.name+"` with data field `"+n.field+"`); try a `["+n.field+"]` selector to limit scope to elements with `"+n.field+"` defined")};switch(n.mapped){case s.mapData:{for(var v=n.field.split("."),m=f.data,y=0;y<v.length&&m;y++){var b=v[y];m=m[b]}if(m==null)return g(),!1;var w;if(se(m)){var S=n.fieldMax-n.fieldMin;S===0?w=0:w=(m-n.fieldMin)/S}else return it("Do not use continuous mappers without specifying numeric data (i.e. `"+n.field+": "+m+"` for `"+r.id()+"` is non-numeric)"),!1;if(w<0?w=0:w>1&&(w=1),o.color){var C=n.valueMin[0],x=n.valueMax[0],A=n.valueMin[1],T=n.valueMax[1],D=n.valueMin[2],k=n.valueMax[2],E=n.valueMin[3]==null?1:n.valueMin[3],M=n.valueMax[3]==null?1:n.valueMax[3],O=[Math.round(C+(x-C)*w),Math.round(A+(T-A)*w),Math.round(D+(k-D)*w),Math.round(E+(M-E)*w)];a={bypass:n.bypass,name:n.name,value:O,strValue:"rgb("+O[0]+", "+O[1]+", "+O[2]+")"}}else if(o.number){var R=n.valueMin+(n.valueMax-n.valueMin)*w;a=this.parse(n.name,R,n.bypass,c)}else return!1;if(!a)return g(),!1;a.mapping=n,n=a;break}case s.data:{for(var L=n.field.split("."),I=f.data,N=0;N<L.length&&I;N++){var q=L[N];I=I[q]}if(I!=null&&(a=this.parse(n.name,I,n.bypass,c)),!a)return g(),!1;a.mapping=n,n=a;break}case s.fn:{var z=n.value,F=n.fnValue!=null?n.fnValue:z(r);if(n.prevFnValue=F,F==null)return it("Custom function mappers may not return null (i.e. `"+n.name+"` for ele `"+r.id()+"` is null)"),!1;if(a=this.parse(n.name,F,n.bypass,c),!a)return it("Custom function mappers may not return invalid values for the property type (i.e. `"+n.name+"` for ele `"+r.id()+"` is invalid)"),!1;a.mapping=Fn(n),n=a;break}case void 0:break;default:return!1}return l?(h?n.bypassed=u.bypassed:n.bypassed=u,i[n.name]=n):h?u.bypassed=n:i[n.name]=n,p(),!0};Xt.cleanElements=function(r,e){for(var t=0;t<r.length;t++){var n=r[t];if(this.clearStyleHints(n),n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),!e)n._private.style={};else for(var i=n._private.style,a=Object.keys(i),s=0;s<a.length;s++){var o=a[s],l=i[o];l!=null&&(l.bypass?l.bypassed=null:i[o]=null)}}};Xt.update=function(){var r=this._private.cy,e=r.mutableElements();e.updateStyle()};Xt.updateTransitions=function(r,e){var t=this,n=r._private,i=r.pstyle("transition-property").value,a=r.pstyle("transition-duration").pfValue,s=r.pstyle("transition-delay").pfValue;if(i.length>0&&a>0){for(var o={},l=!1,u=0;u<i.length;u++){var h=i[u],f=r.pstyle(h),c=e[h];if(c){var d=c.prev,p=d,g=c.next!=null?c.next:f,v=!1,m=void 0,y=1e-6;p&&(se(p.pfValue)&&se(g.pfValue)?(v=g.pfValue-p.pfValue,m=p.pfValue+y*v):se(p.value)&&se(g.value)?(v=g.value-p.value,m=p.value+y*v):ft(p.value)&&ft(g.value)&&(v=p.value[0]!==g.value[0]||p.value[1]!==g.value[1]||p.value[2]!==g.value[2],m=p.strValue),v&&(o[h]=g.strValue,this.applyBypass(r,h,m),l=!0))}}if(!l)return;n.transitioning=!0,new eo(function(b){s>0?r.delayAnimation(s).play().promise().then(b):b()}).then(function(){return r.animation({style:o,duration:a,easing:r.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){t.removeBypasses(r,i),r.emitAndNotify("style"),n.transitioning=!1})}else n.transitioning&&(this.removeBypasses(r,i),r.emitAndNotify("style"),n.transitioning=!1)};Xt.checkTrigger=function(r,e,t,n,i,a){var s=this.properties[e],o=i(s);r.removed()||o!=null&&o(t,n,r)&&a(s)};Xt.checkZOrderTrigger=function(r,e,t,n){var i=this;this.checkTrigger(r,e,t,n,function(a){return a.triggersZOrder},function(){i._private.cy.notify("zorder",r)})};Xt.checkBoundsTrigger=function(r,e,t,n){this.checkTrigger(r,e,t,n,function(i){return i.triggersBounds},function(i){r.dirtyCompoundBoundsCache(),r.dirtyBoundingBoxCache()})};Xt.checkConnectedEdgesBoundsTrigger=function(r,e,t,n){this.checkTrigger(r,e,t,n,function(i){return i.triggersBoundsOfConnectedEdges},function(i){r.connectedEdges().forEach(function(a){a.dirtyBoundingBoxCache()})})};Xt.checkParallelEdgesBoundsTrigger=function(r,e,t,n){this.checkTrigger(r,e,t,n,function(i){return i.triggersBoundsOfParallelEdges},function(i){r.parallelEdges().forEach(function(a){a.dirtyBoundingBoxCache()})})};Xt.checkTriggers=function(r,e,t,n){r.dirtyStyleCache(),this.checkZOrderTrigger(r,e,t,n),this.checkBoundsTrigger(r,e,t,n),this.checkConnectedEdgesBoundsTrigger(r,e,t,n),this.checkParallelEdgesBoundsTrigger(r,e,t,n)};var ou={};ou.applyBypass=function(r,e,t,n){var i=this,a=[],s=!0;if(e==="*"||e==="**"){if(t!==void 0)for(var o=0;o<i.properties.length;o++){var l=i.properties[o],u=l.name,h=this.parse(u,t,!0);h&&a.push(h)}}else if(be(e)){var f=this.parse(e,t,!0);f&&a.push(f)}else if($e(e)){var c=e;n=t;for(var d=Object.keys(c),p=0;p<d.length;p++){var g=d[p],v=c[g];if(v===void 0&&(v=c[Tc(g)]),v!==void 0){var m=this.parse(g,v,!0);m&&a.push(m)}}}else return!1;if(a.length===0)return!1;for(var y=!1,b=0;b<r.length;b++){for(var w=r[b],S={},C=void 0,x=0;x<a.length;x++){var A=a[x];if(n){var T=w.pstyle(A.name);C=S[A.name]={prev:T}}y=this.applyParsedProperty(w,Fn(A))||y,n&&(C.next=w.pstyle(A.name))}y&&this.updateStyleHints(w),n&&this.updateTransitions(w,S,s)}return y};ou.overrideBypass=function(r,e,t){e=a0(e);for(var n=0;n<r.length;n++){var i=r[n],a=i._private.style[e],s=this.properties[e].type,o=s.color,l=s.mutiple,u=a?a.pfValue!=null?a.pfValue:a.value:null;!a||!a.bypass?this.applyBypass(i,e,t):(a.value=t,a.pfValue!=null&&(a.pfValue=t),o?a.strValue="rgb("+t.join(",")+")":l?a.strValue=t.join(" "):a.strValue=""+t,this.updateStyleHints(i)),this.checkTriggers(i,e,u,t)}};ou.removeAllBypasses=function(r,e){return this.removeBypasses(r,this.propertyNames,e)};ou.removeBypasses=function(r,e,t){for(var n=!0,i=0;i<r.length;i++){for(var a=r[i],s={},o=0;o<e.length;o++){var l=e[o],u=this.properties[l],h=a.pstyle(u.name);if(!(!h||!h.bypass)){var f="",c=this.parse(l,f,!0),d=s[u.name]={prev:h};this.applyParsedProperty(a,c),d.next=a.pstyle(u.name)}}this.updateStyleHints(a),t&&this.updateTransitions(a,s,n)}};var w0={};w0.getEmSizeInPixels=function(){var r=this.containerCss("font-size");return r!=null?parseFloat(r):1};w0.containerCss=function(r){var e=this._private.cy,t=e.container(),n=e.window();if(n&&t&&n.getComputedStyle)return n.getComputedStyle(t).getPropertyValue(r)};var _n={};_n.getRenderedStyle=function(r,e){return e?this.getStylePropertyValue(r,e,!0):this.getRawStyle(r,!0)};_n.getRawStyle=function(r,e){var t=this;if(r=r[0],r){for(var n={},i=0;i<t.properties.length;i++){var a=t.properties[i],s=t.getStylePropertyValue(r,a.name,e);s!=null&&(n[a.name]=s,n[Tc(a.name)]=s)}return n}};_n.getIndexedStyle=function(r,e,t,n){var i=r.pstyle(e)[t][n];return i??r.cy().style().getDefaultProperty(e)[t][0]};_n.getStylePropertyValue=function(r,e,t){var n=this;if(r=r[0],r){var i=n.properties[e];i.alias&&(i=i.pointsTo);var a=i.type,s=r.pstyle(i.name);if(s){var o=s.value,l=s.units,u=s.strValue;if(t&&a.number&&o!=null&&se(o)){var h=r.cy().zoom(),f=function(v){return v*h},c=function(v,m){return f(v)+m},d=ft(o),p=d?l.every(function(g){return g!=null}):l!=null;return p?d?o.map(function(g,v){return c(g,l[v])}).join(" "):c(o,l):d?o.map(function(g){return be(g)?g:""+f(g)}).join(" "):""+f(o)}else if(u!=null)return u}return null}};_n.getAnimationStartStyle=function(r,e){for(var t={},n=0;n<e.length;n++){var i=e[n],a=i.name,s=r.pstyle(a);s!==void 0&&($e(s)?s=this.parse(a,s.strValue):s=this.parse(a,s)),s&&(t[a]=s)}return t};_n.getPropsList=function(r){var e=this,t=[],n=r,i=e.properties;if(n)for(var a=Object.keys(n),s=0;s<a.length;s++){var o=a[s],l=n[o],u=i[o]||i[a0(o)],h=this.parse(u.name,l);h&&t.push(h)}return t};_n.getNonDefaultPropertiesHash=function(r,e,t){var n=t.slice(),i,a,s,o,l,u;for(l=0;l<e.length;l++)if(i=e[l],a=r.pstyle(i,!1),a!=null)if(a.pfValue!=null)n[0]=Wl(o,n[0]),n[1]=Gl(o,n[1]);else for(s=a.strValue,u=0;u<s.length;u++)o=s.charCodeAt(u),n[0]=Wl(o,n[0]),n[1]=Gl(o,n[1]);return n};_n.getPropertiesHash=_n.getNonDefaultPropertiesHash;var _c={};_c.appendFromJson=function(r){for(var e=this,t=0;t<r.length;t++){var n=r[t],i=n.selector,a=n.style||n.css,s=Object.keys(a);e.selector(i);for(var o=0;o<s.length;o++){var l=s[o],u=a[l];e.css(l,u)}}return e};_c.fromJson=function(r){var e=this;return e.resetToDefault(),e.appendFromJson(r),e};_c.json=function(){for(var r=[],e=this.defaultLength;e<this.length;e++){for(var t=this[e],n=t.selector,i=t.properties,a={},s=0;s<i.length;s++){var o=i[s];a[o.name]=o.strValue}r.push({selector:n?n.toString():"core",style:a})}return r};var x0={};x0.appendFromString=function(r){var e=this,t=this,n=""+r,i,a,s;n=n.replace(/[/][*](\s|.)+?[*][/]/g,"");function o(){n.length>i.length?n=n.substr(i.length):n=""}function l(){a.length>s.length?a=a.substr(s.length):a=""}for(;;){var u=n.match(/^\s*$/);if(u)break;var h=n.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!h){it("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+n);break}i=h[0];var f=h[1];if(f!=="core"){var c=new Vi(f);if(c.invalid){it("Skipping parsing of block: Invalid selector found in string stylesheet: "+f),o();continue}}var d=h[2],p=!1;a=d;for(var g=[];;){var v=a.match(/^\s*$/);if(v)break;var m=a.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!m){it("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+d),p=!0;break}s=m[0];var y=m[1],b=m[2],w=e.properties[y];if(!w){it("Skipping property: Invalid property name in: "+s),l();continue}var S=t.parse(y,b);if(!S){it("Skipping property: Invalid property definition in: "+s),l();continue}g.push({name:y,val:b}),l()}if(p){o();break}t.selector(f);for(var C=0;C<g.length;C++){var x=g[C];t.css(x.name,x.val)}o()}return t};x0.fromString=function(r){var e=this;return e.resetToDefault(),e.appendFromString(r),e};var Nt={};(function(){var r=Vt,e=mG,t=bG,n=wG,i=xG,a=function(W){return"^"+W+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},s=function(W){var K=r+"|\\w+|"+e+"|"+t+"|"+n+"|"+i;return"^"+W+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+r+")\\s*\\,\\s*("+r+")\\s*,\\s*("+K+")\\s*\\,\\s*("+K+")\\)$"},o=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];Nt.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},axisDirectionExplicit:{enums:["leftward","rightward","upward","downward"]},axisDirectionPrimary:{enums:["horizontal","vertical"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:a("data")},layoutData:{mapping:!0,regex:a("layoutData")},scratch:{mapping:!0,regex:a("scratch")},mapData:{mapping:!0,regex:s("mapData")},mapLayoutData:{mapping:!0,regex:s("mapLayoutData")},mapScratch:{mapping:!0,regex:s("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:o,singleRegexMatchValue:!0},urls:{regexes:o,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(W,K){switch(W.length){case 2:return K[0]!=="deg"&&K[0]!=="rad"&&K[1]!=="deg"&&K[1]!=="rad";case 1:return be(W[0])||K[0]==="deg"||K[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(W){var K=W.length;return K===1||K===2||K===4}}};var l={zeroNonZero:function(W,K){return(W==null||K==null)&&W!==K||W==0&&K!=0?!0:W!=0&&K==0},any:function(W,K){return W!=K},emptyNonEmpty:function(W,K){var ie=Fi(W),ue=Fi(K);return ie&&!ue||!ie&&ue}},u=Nt.types,h=[{name:"label",type:u.text,triggersBounds:l.any,triggersZOrder:l.emptyNonEmpty},{name:"text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any}],f=[{name:"source-label",type:u.text,triggersBounds:l.any},{name:"source-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"source-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-offset",type:u.size,triggersBounds:l.any}],c=[{name:"target-label",type:u.text,triggersBounds:l.any},{name:"target-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"target-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-offset",type:u.size,triggersBounds:l.any}],d=[{name:"font-family",type:u.fontFamily,triggersBounds:l.any},{name:"font-style",type:u.fontStyle,triggersBounds:l.any},{name:"font-weight",type:u.fontWeight,triggersBounds:l.any},{name:"font-size",type:u.size,triggersBounds:l.any},{name:"text-transform",type:u.textTransform,triggersBounds:l.any},{name:"text-wrap",type:u.textWrap,triggersBounds:l.any},{name:"text-overflow-wrap",type:u.textOverflowWrap,triggersBounds:l.any},{name:"text-max-width",type:u.size,triggersBounds:l.any},{name:"text-outline-width",type:u.size,triggersBounds:l.any},{name:"line-height",type:u.positiveNumber,triggersBounds:l.any}],p=[{name:"text-valign",type:u.valign,triggersBounds:l.any},{name:"text-halign",type:u.halign,triggersBounds:l.any},{name:"color",type:u.color},{name:"text-outline-color",type:u.color},{name:"text-outline-opacity",type:u.zeroOneNumber},{name:"text-background-color",type:u.color},{name:"text-background-opacity",type:u.zeroOneNumber},{name:"text-background-padding",type:u.size,triggersBounds:l.any},{name:"text-border-opacity",type:u.zeroOneNumber},{name:"text-border-color",type:u.color},{name:"text-border-width",type:u.size,triggersBounds:l.any},{name:"text-border-style",type:u.borderStyle,triggersBounds:l.any},{name:"text-background-shape",type:u.textBackgroundShape,triggersBounds:l.any},{name:"text-justification",type:u.justification},{name:"box-select-labels",type:u.bool,triggersBounds:l.any}],g=[{name:"events",type:u.bool,triggersZOrder:l.any},{name:"text-events",type:u.bool,triggersZOrder:l.any}],v=[{name:"display",type:u.display,triggersZOrder:l.any,triggersBounds:l.any,triggersBoundsOfConnectedEdges:l.any,triggersBoundsOfParallelEdges:function(W,K,ie){return W===K?!1:ie.pstyle("curve-style").value==="bezier"}},{name:"visibility",type:u.visibility,triggersZOrder:l.any},{name:"opacity",type:u.zeroOneNumber,triggersZOrder:l.zeroNonZero},{name:"text-opacity",type:u.zeroOneNumber},{name:"min-zoomed-font-size",type:u.size},{name:"z-compound-depth",type:u.zCompoundDepth,triggersZOrder:l.any},{name:"z-index-compare",type:u.zIndexCompare,triggersZOrder:l.any},{name:"z-index",type:u.number,triggersZOrder:l.any}],m=[{name:"overlay-padding",type:u.size,triggersBounds:l.any},{name:"overlay-color",type:u.color},{name:"overlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"overlay-shape",type:u.overlayShape,triggersBounds:l.any},{name:"overlay-corner-radius",type:u.cornerRadius}],y=[{name:"underlay-padding",type:u.size,triggersBounds:l.any},{name:"underlay-color",type:u.color},{name:"underlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"underlay-shape",type:u.overlayShape,triggersBounds:l.any},{name:"underlay-corner-radius",type:u.cornerRadius}],b=[{name:"transition-property",type:u.propList},{name:"transition-duration",type:u.time},{name:"transition-delay",type:u.time},{name:"transition-timing-function",type:u.easing}],w=function(W,K){return K.value==="label"?-W.poolIndex():K.pfValue},S=[{name:"height",type:u.nodeSize,triggersBounds:l.any,hashOverride:w},{name:"width",type:u.nodeSize,triggersBounds:l.any,hashOverride:w},{name:"shape",type:u.nodeShape,triggersBounds:l.any},{name:"shape-polygon-points",type:u.polygonPointList,triggersBounds:l.any},{name:"corner-radius",type:u.cornerRadius},{name:"background-color",type:u.color},{name:"background-fill",type:u.fill},{name:"background-opacity",type:u.zeroOneNumber},{name:"background-blacken",type:u.nOneOneNumber},{name:"background-gradient-stop-colors",type:u.colors},{name:"background-gradient-stop-positions",type:u.percentages},{name:"background-gradient-direction",type:u.gradientDirection},{name:"padding",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"padding-relative-to",type:u.paddingRelativeTo,triggersBounds:l.any},{name:"bounds-expansion",type:u.boundsExpansion,triggersBounds:l.any}],C=[{name:"border-color",type:u.color},{name:"border-opacity",type:u.zeroOneNumber},{name:"border-width",type:u.size,triggersBounds:l.any},{name:"border-style",type:u.borderStyle},{name:"border-cap",type:u.lineCap},{name:"border-join",type:u.lineJoin},{name:"border-dash-pattern",type:u.numbers},{name:"border-dash-offset",type:u.number},{name:"border-position",type:u.linePosition}],x=[{name:"outline-color",type:u.color},{name:"outline-opacity",type:u.zeroOneNumber},{name:"outline-width",type:u.size,triggersBounds:l.any},{name:"outline-style",type:u.borderStyle},{name:"outline-offset",type:u.size,triggersBounds:l.any}],A=[{name:"background-image",type:u.urls},{name:"background-image-crossorigin",type:u.bgCrossOrigin},{name:"background-image-opacity",type:u.zeroOneNumbers},{name:"background-image-containment",type:u.bgContainment},{name:"background-image-smoothing",type:u.bools},{name:"background-position-x",type:u.bgPos},{name:"background-position-y",type:u.bgPos},{name:"background-width-relative-to",type:u.bgRelativeTo},{name:"background-height-relative-to",type:u.bgRelativeTo},{name:"background-repeat",type:u.bgRepeat},{name:"background-fit",type:u.bgFit},{name:"background-clip",type:u.bgClip},{name:"background-width",type:u.bgWH},{name:"background-height",type:u.bgWH},{name:"background-offset-x",type:u.bgPos},{name:"background-offset-y",type:u.bgPos}],T=[{name:"position",type:u.position,triggersBounds:l.any},{name:"compound-sizing-wrt-labels",type:u.compoundIncludeLabels,triggersBounds:l.any},{name:"min-width",type:u.size,triggersBounds:l.any},{name:"min-width-bias-left",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-width-bias-right",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height",type:u.size,triggersBounds:l.any},{name:"min-height-bias-top",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height-bias-bottom",type:u.sizeMaybePercent,triggersBounds:l.any}],D=[{name:"line-style",type:u.lineStyle},{name:"line-color",type:u.color},{name:"line-fill",type:u.fill},{name:"line-cap",type:u.lineCap},{name:"line-opacity",type:u.zeroOneNumber},{name:"line-dash-pattern",type:u.numbers},{name:"line-dash-offset",type:u.number},{name:"line-outline-width",type:u.size},{name:"line-outline-color",type:u.color},{name:"line-gradient-stop-colors",type:u.colors},{name:"line-gradient-stop-positions",type:u.percentages},{name:"curve-style",type:u.curveStyle,triggersBounds:l.any,triggersBoundsOfParallelEdges:function(W,K){return W===K?!1:W==="bezier"||K==="bezier"}},{name:"haystack-radius",type:u.zeroOneNumber,triggersBounds:l.any},{name:"source-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"target-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"control-point-step-size",type:u.size,triggersBounds:l.any},{name:"control-point-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"control-point-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"segment-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-radii",type:u.numbers,triggersBounds:l.any},{name:"radius-type",type:u.radiusType,triggersBounds:l.any},{name:"taxi-turn",type:u.bidirectionalSizeMaybePercent,triggersBounds:l.any},{name:"taxi-turn-min-distance",type:u.size,triggersBounds:l.any},{name:"taxi-direction",type:u.axisDirection,triggersBounds:l.any},{name:"taxi-radius",type:u.number,triggersBounds:l.any},{name:"edge-distances",type:u.edgeDistances,triggersBounds:l.any},{name:"arrow-scale",type:u.positiveNumber,triggersBounds:l.any},{name:"loop-direction",type:u.angle,triggersBounds:l.any},{name:"loop-sweep",type:u.angle,triggersBounds:l.any},{name:"source-distance-from-node",type:u.size,triggersBounds:l.any},{name:"target-distance-from-node",type:u.size,triggersBounds:l.any}],k=[{name:"ghost",type:u.bool,triggersBounds:l.any},{name:"ghost-offset-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-offset-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-opacity",type:u.zeroOneNumber}],E=[{name:"selection-box-color",type:u.color},{name:"selection-box-opacity",type:u.zeroOneNumber},{name:"selection-box-border-color",type:u.color},{name:"selection-box-border-width",type:u.size},{name:"active-bg-color",type:u.color},{name:"active-bg-opacity",type:u.zeroOneNumber},{name:"active-bg-size",type:u.size},{name:"outside-texture-bg-color",type:u.color},{name:"outside-texture-bg-opacity",type:u.zeroOneNumber}],M=[];Nt.pieBackgroundN=16,M.push({name:"pie-size",type:u.sizeMaybePercent}),M.push({name:"pie-hole",type:u.sizeMaybePercent}),M.push({name:"pie-start-angle",type:u.angle});for(var O=1;O<=Nt.pieBackgroundN;O++)M.push({name:"pie-"+O+"-background-color",type:u.color}),M.push({name:"pie-"+O+"-background-size",type:u.percent}),M.push({name:"pie-"+O+"-background-opacity",type:u.zeroOneNumber});var R=[];Nt.stripeBackgroundN=16,R.push({name:"stripe-size",type:u.sizeMaybePercent}),R.push({name:"stripe-direction",type:u.axisDirectionPrimary});for(var L=1;L<=Nt.stripeBackgroundN;L++)R.push({name:"stripe-"+L+"-background-color",type:u.color}),R.push({name:"stripe-"+L+"-background-size",type:u.percent}),R.push({name:"stripe-"+L+"-background-opacity",type:u.zeroOneNumber});var I=[],N=Nt.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:u.arrowShape,triggersBounds:l.any},{name:"arrow-color",type:u.color},{name:"arrow-fill",type:u.arrowFill},{name:"arrow-width",type:u.arrowWidth}].forEach(function(V){N.forEach(function(W){var K=W+"-"+V.name,ie=V.type,ue=V.triggersBounds;I.push({name:K,type:ie,triggersBounds:ue})})},{});var q=Nt.properties=[].concat(g,b,v,m,y,k,p,d,h,f,c,S,C,x,A,M,R,T,D,I,E),z=Nt.propertyGroups={behavior:g,transition:b,visibility:v,overlay:m,underlay:y,ghost:k,commonLabel:p,labelDimensions:d,mainLabel:h,sourceLabel:f,targetLabel:c,nodeBody:S,nodeBorder:C,nodeOutline:x,backgroundImage:A,pie:M,stripe:R,compound:T,edgeLine:D,edgeArrow:I,core:E},F=Nt.propertyGroupNames={},_=Nt.propertyGroupKeys=Object.keys(z);_.forEach(function(V){F[V]=z[V].map(function(W){return W.name}),z[V].forEach(function(W){return W.groupKey=V})});var U=Nt.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];Nt.propertyNames=q.map(function(V){return V.name});for(var X=0;X<q.length;X++){var $=q[X];q[$.name]=$}for(var Q=0;Q<U.length;Q++){var ee=U[Q],oe=q[ee.pointsTo],te={name:ee.name,alias:!0,pointsTo:oe};q.push(te),q[ee.name]=te}})();Nt.getDefaultProperty=function(r){return this.getDefaultProperties()[r]};Nt.getDefaultProperties=function(){var r=this._private;if(r.defaultProperties!=null)return r.defaultProperties;for(var e=Ce({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","box-select-labels":"no","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%","pie-hole":0,"pie-start-angle":"0deg"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var h=1;h<=Nt.pieBackgroundN;h++){var f=u.name.replace("{{i}}",h),c=u.value;l[f]=c}return l},{}),{"stripe-size":"100%","stripe-direction":"horizontal"},[{name:"stripe-{{i}}-background-color",value:"black"},{name:"stripe-{{i}}-background-size",value:"0%"},{name:"stripe-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var h=1;h<=Nt.stripeBackgroundN;h++){var f=u.name.replace("{{i}}",h),c=u.value;l[f]=c}return l},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(l,u){return Nt.arrowPrefixes.forEach(function(h){var f=h+"-"+u.name,c=u.value;l[f]=c}),l},{})),t={},n=0;n<this.properties.length;n++){var i=this.properties[n];if(!i.pointsTo){var a=i.name,s=e[a],o=this.parse(a,s);t[a]=o}}return r.defaultProperties=t,r.defaultProperties};Nt.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var zc={};zc.parse=function(r,e,t,n){var i=this;if(kt(e))return i.parseImplWarn(r,e,t,n);var a=n==="mapping"||n===!0||n===!1||n==null?"dontcare":n,s=t?"t":"f",o=""+e,l=t2(r,o,s,a),u=i.propCache=i.propCache||[],h;return(h=u[l])||(h=u[l]=i.parseImplWarn(r,e,t,n)),(t||n==="mapping")&&(h=Fn(h),h&&(h.value=Fn(h.value))),h};zc.parseImplWarn=function(r,e,t,n){var i=this.parseImpl(r,e,t,n);return!i&&e!=null&&it("The style property `".concat(r,": ").concat(e,"` is invalid")),i&&(i.name==="width"||i.name==="height")&&e==="label"&&it("The style value of `label` is deprecated for `"+i.name+"`"),i};zc.parseImpl=function(r,e,t,n){var i=this;r=a0(r);var a=i.properties[r],s=e,o=i.types;if(!a||e===void 0)return null;a.alias&&(a=a.pointsTo,r=a.name);var l=be(e);l&&(e=e.trim());var u=a.type;if(!u)return null;if(t&&(e===""||e===null))return{name:r,value:e,bypass:!0,deleteBypass:!0};if(kt(e))return{name:r,value:e,strValue:"fn",mapped:o.fn,bypass:t};var h,f;if(!(!l||n||e.length<7||e[1]!=="a")){if(e.length>=7&&e[0]==="d"&&(h=new RegExp(o.data.regex).exec(e))){if(t)return!1;var c=o.data;return{name:r,value:h,strValue:""+e,mapped:c,field:h[1],bypass:t}}else if(e.length>=10&&e[0]==="m"&&(f=new RegExp(o.mapData.regex).exec(e))){if(t||u.multiple)return!1;var d=o.mapData;if(!(u.color||u.number))return!1;var p=this.parse(r,f[4]);if(!p||p.mapped)return!1;var g=this.parse(r,f[5]);if(!g||g.mapped)return!1;if(p.pfValue===g.pfValue||p.strValue===g.strValue)return it("`"+r+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+r+": "+p.strValue+"`"),this.parse(r,p.strValue);if(u.color){var v=p.value,m=g.value,y=v[0]===m[0]&&v[1]===m[1]&&v[2]===m[2]&&(v[3]===m[3]||(v[3]==null||v[3]===1)&&(m[3]==null||m[3]===1));if(y)return!1}return{name:r,value:f,strValue:""+e,mapped:d,field:f[1],fieldMin:parseFloat(f[2]),fieldMax:parseFloat(f[3]),valueMin:p.value,valueMax:g.value,bypass:t}}}if(u.multiple&&n!=="multiple"){var b;if(l?b=e.split(/\s+/):ft(e)?b=e:b=[e],u.evenMultiple&&b.length%2!==0)return null;for(var w=[],S=[],C=[],x="",A=!1,T=0;T<b.length;T++){var D=i.parse(r,b[T],t,"multiple");A=A||be(D.value),w.push(D.value),C.push(D.pfValue!=null?D.pfValue:D.value),S.push(D.units),x+=(T>0?" ":"")+D.strValue}return u.validate&&!u.validate(w,S)?null:u.singleEnum&&A?w.length===1&&be(w[0])?{name:r,value:w[0],strValue:w[0],bypass:t}:null:{name:r,value:w,pfValue:C,strValue:x,bypass:t,units:S}}var k=function(){for(var te=0;te<u.enums.length;te++){var V=u.enums[te];if(V===e)return{name:r,value:e,strValue:""+e,bypass:t}}return null};if(u.number){var E,M="px";if(u.units&&(E=u.units),u.implicitUnits&&(M=u.implicitUnits),!u.unitless)if(l){var O="px|em"+(u.allowPercent?"|\\%":"");E&&(O=E);var R=e.match("^("+Vt+")("+O+")?$");R&&(e=R[1],E=R[2]||M)}else(!E||u.implicitUnits)&&(E=M);if(e=parseFloat(e),isNaN(e)&&u.enums===void 0)return null;if(isNaN(e)&&u.enums!==void 0)return e=s,k();if(u.integer&&!hG(e)||u.min!==void 0&&(e<u.min||u.strictMin&&e===u.min)||u.max!==void 0&&(e>u.max||u.strictMax&&e===u.max))return null;var L={name:r,value:e,strValue:""+e+(E||""),units:E,bypass:t};return u.unitless||E!=="px"&&E!=="em"?L.pfValue=e:L.pfValue=E==="px"||!E?e:this.getEmSizeInPixels()*e,(E==="ms"||E==="s")&&(L.pfValue=E==="ms"?e:1e3*e),(E==="deg"||E==="rad")&&(L.pfValue=E==="rad"?e:m8(e)),E==="%"&&(L.pfValue=e/100),L}else if(u.propList){var I=[],N=""+e;if(N!=="none"){for(var q=N.split(/\s*,\s*|\s+/),z=0;z<q.length;z++){var F=q[z].trim();i.properties[F]?I.push(F):it("`"+F+"` is not a valid property name")}if(I.length===0)return null}return{name:r,value:I,strValue:I.length===0?"none":I.join(" "),bypass:t}}else if(u.color){var _=YA(e);return _?{name:r,value:_,pfValue:_,strValue:"rgb("+_[0]+","+_[1]+","+_[2]+")",bypass:t}:null}else if(u.regex||u.regexes){if(u.enums){var U=k();if(U)return U}for(var X=u.regexes?u.regexes:[u.regex],$=0;$<X.length;$++){var Q=new RegExp(X[$]),ee=Q.exec(e);if(ee)return{name:r,value:u.singleRegexMatchValue?ee[1]:ee,strValue:""+e,bypass:t}}return null}else return u.string?{name:r,value:""+e,strValue:""+e,bypass:t}:u.enums?k():null};var Yt=function(e){if(!(this instanceof Yt))return new Yt(e);if(!i0(e)){Ct("A style must have a core reference");return}this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()},gr=Yt.prototype;gr.instanceString=function(){return"style"};gr.clear=function(){for(var r=this._private,e=r.cy,t=e.elements(),n=0;n<this.length;n++)this[n]=void 0;return this.length=0,r.contextStyles={},r.propDiffs={},this.cleanElements(t,!0),t.forEach(function(i){var a=i[0]._private;a.styleDirty=!0,a.appliedInitStyle=!1}),this};gr.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};gr.core=function(r){return this._private.coreStyle[r]||this.getDefaultProperty(r)};gr.selector=function(r){var e=r==="core"?null:new Vi(r),t=this.length++;return this[t]={selector:e,properties:[],mappedProperties:[],index:t},this};gr.css=function(){var r=this,e=arguments;if(e.length===1)for(var t=e[0],n=0;n<r.properties.length;n++){var i=r.properties[n],a=t[i.name];a===void 0&&(a=t[Tc(i.name)]),a!==void 0&&this.cssRule(i.name,a)}else e.length===2&&this.cssRule(e[0],e[1]);return this};gr.style=gr.css;gr.cssRule=function(r,e){var t=this.parse(r,e);if(t){var n=this.length-1;this[n].properties.push(t),this[n].properties[t.name]=t,t.name.match(/pie-(\d+)-background-size/)&&t.value&&(this._private.hasPie=!0),t.name.match(/stripe-(\d+)-background-size/)&&t.value&&(this._private.hasStripe=!0),t.mapped&&this[n].mappedProperties.push(t);var i=!this[n].selector;i&&(this._private.coreStyle[t.name]=t)}return this};gr.append=function(r){return UA(r)?r.appendToStyle(this):ft(r)?this.appendFromJson(r):be(r)&&this.appendFromString(r),this};Yt.fromJson=function(r,e){var t=new Yt(r);return t.fromJson(e),t};Yt.fromString=function(r,e){return new Yt(r).fromString(e)};[Xt,ou,w0,_n,_c,x0,Nt,zc].forEach(function(r){Ce(gr,r)});Yt.types=gr.types;Yt.properties=gr.properties;Yt.propertyGroups=gr.propertyGroups;Yt.propertyGroupNames=gr.propertyGroupNames;Yt.propertyGroupKeys=gr.propertyGroupKeys;var x9={style:function(e){if(e){var t=this.setStyle(e);t.update()}return this._private.style},setStyle:function(e){var t=this._private;return UA(e)?t.style=e.generateStyle(this):ft(e)?t.style=Yt.fromJson(this,e):be(e)?t.style=Yt.fromString(this,e):t.style=Yt(this),t.style},updateStyle:function(){this.mutableElements().updateStyle()}},S9="single",Wa={autolock:function(e){if(e!==void 0)this._private.autolock=!!e;else return this._private.autolock;return this},autoungrabify:function(e){if(e!==void 0)this._private.autoungrabify=!!e;else return this._private.autoungrabify;return this},autounselectify:function(e){if(e!==void 0)this._private.autounselectify=!!e;else return this._private.autounselectify;return this},selectionType:function(e){var t=this._private;if(t.selectionType==null&&(t.selectionType=S9),e!==void 0)(e==="additive"||e==="single")&&(t.selectionType=e);else return t.selectionType;return this},panningEnabled:function(e){if(e!==void 0)this._private.panningEnabled=!!e;else return this._private.panningEnabled;return this},userPanningEnabled:function(e){if(e!==void 0)this._private.userPanningEnabled=!!e;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(e){if(e!==void 0)this._private.zoomingEnabled=!!e;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(e){if(e!==void 0)this._private.userZoomingEnabled=!!e;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(e){if(e!==void 0)this._private.boxSelectionEnabled=!!e;else return this._private.boxSelectionEnabled;return this},pan:function(){var e=arguments,t=this._private.pan,n,i,a,s,o;switch(e.length){case 0:return t;case 1:if(be(e[0]))return n=e[0],t[n];if($e(e[0])){if(!this._private.panningEnabled)return this;a=e[0],s=a.x,o=a.y,se(s)&&(t.x=s),se(o)&&(t.y=o),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;n=e[0],i=e[1],(n==="x"||n==="y")&&se(i)&&(t[n]=i),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(e,t){var n=arguments,i=this._private.pan,a,s,o,l,u;if(!this._private.panningEnabled)return this;switch(n.length){case 1:$e(e)&&(o=n[0],l=o.x,u=o.y,se(l)&&(i.x+=l),se(u)&&(i.y+=u),this.emit("pan viewport"));break;case 2:a=e,s=t,(a==="x"||a==="y")&&se(s)&&(i[a]+=s),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(e,t){var n=this.getFitViewport(e,t);if(n){var i=this._private;i.zoom=n.zoom,i.pan=n.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,t){if(se(e)&&t===void 0&&(t=e,e=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var n;if(be(e)){var i=e;e=this.$(i)}else if(dG(e)){var a=e;n={x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},n.w=n.x2-n.x1,n.h=n.y2-n.y1}else Wr(e)||(e=this.mutableElements());if(!(Wr(e)&&e.empty())){n=n||e.boundingBox();var s=this.width(),o=this.height(),l;if(t=se(t)?t:0,!isNaN(s)&&!isNaN(o)&&s>0&&o>0&&!isNaN(n.w)&&!isNaN(n.h)&&n.w>0&&n.h>0){l=Math.min((s-2*t)/n.w,(o-2*t)/n.h),l=l>this._private.maxZoom?this._private.maxZoom:l,l=l<this._private.minZoom?this._private.minZoom:l;var u={x:(s-l*(n.x1+n.x2))/2,y:(o-l*(n.y1+n.y2))/2};return{zoom:l,pan:u}}}}},zoomRange:function(e,t){var n=this._private;if(t==null){var i=e;e=i.min,t=i.max}return se(e)&&se(t)&&e<=t?(n.minZoom=e,n.maxZoom=t):se(e)&&t===void 0&&e<=n.maxZoom?n.minZoom=e:se(t)&&e===void 0&&t>=n.minZoom&&(n.maxZoom=t),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var t=this._private,n=t.pan,i=t.zoom,a,s,o=!1;if(t.zoomingEnabled||(o=!0),se(e)?s=e:$e(e)&&(s=e.level,e.position!=null?a=Dc(e.position,i,n):e.renderedPosition!=null&&(a=e.renderedPosition),a!=null&&!t.panningEnabled&&(o=!0)),s=s>t.maxZoom?t.maxZoom:s,s=s<t.minZoom?t.minZoom:s,o||!se(s)||s===i||a!=null&&(!se(a.x)||!se(a.y)))return null;if(a!=null){var l=n,u=i,h=s,f={x:-h/u*(a.x-l.x)+a.x,y:-h/u*(a.y-l.y)+a.y};return{zoomed:!0,panned:!0,zoom:h,pan:f}}else return{zoomed:!0,panned:!1,zoom:s,pan:n}},zoom:function(e){if(e===void 0)return this._private.zoom;var t=this.getZoomedViewport(e),n=this._private;return t==null||!t.zoomed?this:(n.zoom=t.zoom,t.panned&&(n.pan.x=t.pan.x,n.pan.y=t.pan.y),this.emit("zoom"+(t.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(e){var t=this._private,n=!0,i=!0,a=[],s=!1,o=!1;if(!e)return this;if(se(e.zoom)||(n=!1),$e(e.pan)||(i=!1),!n&&!i)return this;if(n){var l=e.zoom;l<t.minZoom||l>t.maxZoom||!t.zoomingEnabled?s=!0:(t.zoom=l,a.push("zoom"))}if(i&&(!s||!e.cancelOnFailedZoom)&&t.panningEnabled){var u=e.pan;se(u.x)&&(t.pan.x=u.x,o=!1),se(u.y)&&(t.pan.y=u.y,o=!1),o||a.push("pan")}return a.length>0&&(a.push("viewport"),this.emit(a.join(" ")),this.notify("viewport")),this},center:function(e){var t=this.getCenterPan(e);return t&&(this._private.pan=t,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,t){if(this._private.panningEnabled){if(be(e)){var n=e;e=this.mutableElements().filter(n)}else Wr(e)||(e=this.mutableElements());if(e.length!==0){var i=e.boundingBox(),a=this.width(),s=this.height();t=t===void 0?this._private.zoom:t;var o={x:(a-t*(i.x1+i.x2))/2,y:(s-t*(i.y1+i.y2))/2};return o}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e=this._private,t=e.container,n=this;return e.sizeCache=e.sizeCache||(t?function(){var i=n.window().getComputedStyle(t),a=function(o){return parseFloat(i.getPropertyValue(o))};return{width:t.clientWidth-a("padding-left")-a("padding-right"),height:t.clientHeight-a("padding-top")-a("padding-bottom")}}():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,t=this._private.zoom,n=this.renderedExtent(),i={x1:(n.x1-e.x)/t,x2:(n.x2-e.x)/t,y1:(n.y1-e.y)/t,y2:(n.y2-e.y)/t};return i.w=i.x2-i.x1,i.h=i.y2-i.y1,i},renderedExtent:function(){var e=this.width(),t=this.height();return{x1:0,y1:0,x2:e,y2:t,w:e,h:t}},multiClickDebounceTime:function(e){if(e)this._private.multiClickDebounceTime=e;else return this._private.multiClickDebounceTime;return this}};Wa.centre=Wa.center;Wa.autolockNodes=Wa.autolock;Wa.autoungrabifyNodes=Wa.autoungrabify;var $l={data:nt.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:nt.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:nt.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:nt.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};$l.attr=$l.data;$l.removeAttr=$l.removeData;var Zl=function(e){var t=this;e=Ce({},e);var n=e.container;n&&!dc(n)&&dc(n[0])&&(n=n[0]);var i=n?n._cyreg:null;i=i||{},i&&i.cy&&(i.cy.destroy(),i={});var a=i.readies=i.readies||[];n&&(n._cyreg=i),i.cy=t;var s=_t!==void 0&&n!==void 0&&!e.headless,o=e;o.layout=Ce({name:s?"grid":"null"},o.layout),o.renderer=Ce({name:s?"canvas":"null"},o.renderer);var l=function(p,g,v){return g!==void 0?g:v!==void 0?v:p},u=this._private={container:n,ready:!1,options:o,elements:new ir(this),listeners:[],aniEles:new ir(this),data:o.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:l(!0,o.zoomingEnabled),userZoomingEnabled:l(!0,o.userZoomingEnabled),panningEnabled:l(!0,o.panningEnabled),userPanningEnabled:l(!0,o.userPanningEnabled),boxSelectionEnabled:l(!0,o.boxSelectionEnabled),autolock:l(!1,o.autolock,o.autolockNodes),autoungrabify:l(!1,o.autoungrabify,o.autoungrabifyNodes),autounselectify:l(!1,o.autounselectify),styleEnabled:o.styleEnabled===void 0?s:o.styleEnabled,zoom:se(o.zoom)?o.zoom:1,pan:{x:$e(o.pan)&&se(o.pan.x)?o.pan.x:0,y:$e(o.pan)&&se(o.pan.y)?o.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:l(250,o.multiClickDebounceTime)};this.createEmitter(),this.selectionType(o.selectionType),this.zoomRange({min:o.minZoom,max:o.maxZoom});var h=function(p,g){var v=p.some(pG);if(v)return eo.all(p).then(g);g(p)};u.styleEnabled&&t.setStyle([]);var f=Ce({},o,o.renderer);t.initRenderer(f);var c=function(p,g,v){t.notifications(!1);var m=t.mutableElements();m.length>0&&m.remove(),p!=null&&($e(p)||ft(p))&&t.add(p),t.one("layoutready",function(b){t.notifications(!0),t.emit(b),t.one("load",g),t.emitAndNotify("load")}).one("layoutstop",function(){t.one("done",v),t.emit("done")});var y=Ce({},t._private.options.layout);y.eles=t.elements(),t.layout(y).run()};h([o.style,o.elements],function(d){var p=d[0],g=d[1];u.styleEnabled&&t.style().append(p),c(g,function(){t.startAnimationLoop(),u.ready=!0,kt(o.ready)&&t.on("ready",o.ready);for(var v=0;v<a.length;v++){var m=a[v];t.on("ready",m)}i&&(i.readies=[]),t.emit("ready")},o.done)})},wc=Zl.prototype;Ce(wc,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},window:function(){var e=this._private.container;if(e==null)return _t;var t=this._private.container.ownerDocument;return t===void 0||t==null?_t:t.defaultView||_t},mount:function(e){if(e!=null){var t=this,n=t._private,i=n.options;return!dc(e)&&dc(e[0])&&(e=e[0]),t.stopAnimationLoop(),t.destroyRenderer(),n.container=e,n.styleEnabled=!0,t.invalidateSize(),t.initRenderer(Ce({},i,i.renderer,{name:i.renderer.name==="null"?"canvas":i.renderer.name})),t.startAnimationLoop(),t.style(i.style),t.emit("mount"),t}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return Fn(this._private.options)},json:function(e){var t=this,n=t._private,i=t.mutableElements(),a=function(w){return t.getElementById(w.id())};if($e(e)){if(t.startBatch(),e.elements){var s={},o=function(w,S){for(var C=[],x=[],A=0;A<w.length;A++){var T=w[A];if(!T.data.id){it("cy.json() cannot handle elements without an ID attribute");continue}var D=""+T.data.id,k=t.getElementById(D);s[D]=!0,k.length!==0?x.push({ele:k,json:T}):(S&&(T.group=S),C.push(T))}t.add(C);for(var E=0;E<x.length;E++){var M=x[E],O=M.ele,R=M.json;O.json(R)}};if(ft(e.elements))o(e.elements);else for(var l=["nodes","edges"],u=0;u<l.length;u++){var h=l[u],f=e.elements[h];ft(f)&&o(f,h)}var c=t.collection();i.filter(function(b){return!s[b.id()]}).forEach(function(b){b.isParent()?c.merge(b):b.remove()}),c.forEach(function(b){return b.children().move({parent:null})}),c.forEach(function(b){return a(b).remove()})}e.style&&t.style(e.style),e.zoom!=null&&e.zoom!==n.zoom&&t.zoom(e.zoom),e.pan&&(e.pan.x!==n.pan.x||e.pan.y!==n.pan.y)&&t.pan(e.pan),e.data&&t.data(e.data);for(var d=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],p=0;p<d.length;p++){var g=d[p];e[g]!=null&&t[g](e[g])}return t.endBatch(),this}else{var v=!!e,m={};v?m.elements=this.elements().map(function(b){return b.json()}):(m.elements={},i.forEach(function(b){var w=b.group();m.elements[w]||(m.elements[w]=[]),m.elements[w].push(b.json())})),this._private.styleEnabled&&(m.style=t.style().json()),m.data=Fn(t.data());var y=n.options;return m.zoomingEnabled=n.zoomingEnabled,m.userZoomingEnabled=n.userZoomingEnabled,m.zoom=n.zoom,m.minZoom=n.minZoom,m.maxZoom=n.maxZoom,m.panningEnabled=n.panningEnabled,m.userPanningEnabled=n.userPanningEnabled,m.pan=Fn(n.pan),m.boxSelectionEnabled=n.boxSelectionEnabled,m.renderer=Fn(y.renderer),m.hideEdgesOnViewport=y.hideEdgesOnViewport,m.textureOnViewport=y.textureOnViewport,m.wheelSensitivity=y.wheelSensitivity,m.motionBlur=y.motionBlur,m.multiClickDebounceTime=y.multiClickDebounceTime,m}}});wc.$id=wc.getElementById;[f9,v9,W2,Ky,oc,y9,jy,lc,x9,Wa,$l].forEach(function(r){Ce(wc,r)});var C9={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}},k9={maximal:!1,acyclic:!1},qs=function(e){return e.scratch("breadthfirst")},pA=function(e,t){return e.scratch("breadthfirst",t)};function G2(r){this.options=Ce({},C9,k9,r)}G2.prototype.run=function(){var r=this.options,e=r.cy,t=r.eles,n=t.nodes().filter(function(ce){return ce.isChildless()}),i=t,a=r.directed,s=r.acyclic||r.maximal||r.maximalAdjustments>0,o=!!r.boundingBox,l=e.extent(),u=Ir(o?r.boundingBox:{x1:l.x1,y1:l.y1,w:l.w,h:l.h}),h;if(Wr(r.roots))h=r.roots;else if(ft(r.roots)){for(var f=[],c=0;c<r.roots.length;c++){var d=r.roots[c],p=e.getElementById(d);f.push(p)}h=e.collection(f)}else if(be(r.roots))h=e.$(r.roots);else if(a)h=n.roots();else{var g=t.components();h=e.collection();for(var v=function(){var de=g[m],xe=de.maxDegree(!1),ke=de.filter(function(Se){return Se.degree(!1)===xe});h=h.add(ke)},m=0;m<g.length;m++)v()}var y=[],b={},w=function(de,xe){y[xe]==null&&(y[xe]=[]);var ke=y[xe].length;y[xe].push(de),pA(de,{index:ke,depth:xe})},S=function(de,xe){var ke=qs(de),Se=ke.depth,Te=ke.index;y[Se][Te]=null,de.isChildless()&&w(de,xe)};i.bfs({roots:h,directed:r.directed,visit:function(de,xe,ke,Se,Te){var Pe=de[0],Ke=Pe.id();Pe.isChildless()&&w(Pe,Te),b[Ke]=!0}});for(var C=[],x=0;x<n.length;x++){var A=n[x];b[A.id()]||C.push(A)}var T=function(de){for(var xe=y[de],ke=0;ke<xe.length;ke++){var Se=xe[ke];if(Se==null){xe.splice(ke,1),ke--;continue}pA(Se,{depth:de,index:ke})}},D=function(de,xe){for(var ke=qs(de),Se=de.incomers().filter(function(Bt){return Bt.isNode()&&t.has(Bt)}),Te=-1,Pe=de.id(),Ke=0;Ke<Se.length;Ke++){var ut=Se[Ke],Et=qs(ut);Te=Math.max(Te,Et.depth)}if(ke.depth<=Te){if(!r.acyclic&&xe[Pe])return null;var Ze=Te+1;return S(de,Ze),xe[Pe]=Ze,!0}return!1};if(a&&s){var k=[],E={},M=function(de){return k.push(de)},O=function(){return k.shift()};for(n.forEach(function(ce){return k.push(ce)});k.length>0;){var R=O(),L=D(R,E);if(L)R.outgoers().filter(function(ce){return ce.isNode()&&t.has(ce)}).forEach(M);else if(L===null){it("Detected double maximal shift for node `"+R.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var I=0;if(r.avoidOverlap)for(var N=0;N<n.length;N++){var q=n[N],z=q.layoutDimensions(r),F=z.w,_=z.h;I=Math.max(I,F,_)}var U={},X=function(de){if(U[de.id()])return U[de.id()];for(var xe=qs(de).depth,ke=de.neighborhood(),Se=0,Te=0,Pe=0;Pe<ke.length;Pe++){var Ke=ke[Pe];if(!(Ke.isEdge()||Ke.isParent()||!n.has(Ke))){var ut=qs(Ke);if(ut!=null){var Et=ut.index,Ze=ut.depth;if(!(Et==null||Ze==null)){var Bt=y[Ze].length;Ze<xe&&(Se+=Et/Bt,Te++)}}}}return Te=Math.max(1,Te),Se=Se/Te,Te===0&&(Se=0),U[de.id()]=Se,Se},$=function(de,xe){var ke=X(de),Se=X(xe),Te=ke-Se;return Te===0?jA(de.id(),xe.id()):Te};r.depthSort!==void 0&&($=r.depthSort);for(var Q=y.length,ee=0;ee<Q;ee++)y[ee].sort($),T(ee);for(var oe=[],te=0;te<C.length;te++)oe.push(C[te]);var V=function(){for(var de=0;de<Q;de++)T(de)};oe.length&&(y.unshift(oe),Q=y.length,V());for(var W=0,K=0;K<Q;K++)W=Math.max(y[K].length,W);var ie={x:u.x1+u.w/2,y:u.y1+u.h/2},ue=n.reduce(function(ce,de){return function(xe){return{w:ce.w===-1?xe.w:(ce.w+xe.w)/2,h:ce.h===-1?xe.h:(ce.h+xe.h)/2}}(de.boundingBox({includeLabels:r.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),Me=Math.max(Q===1?0:o?(u.h-r.padding*2-ue.h)/(Q-1):(u.h-r.padding*2-ue.h)/(Q+1),I),bt=y.reduce(function(ce,de){return Math.max(ce,de.length)},0),at=function(de){var xe=qs(de),ke=xe.depth,Se=xe.index;if(r.circle){var Te=Math.min(u.w/2/Q,u.h/2/Q);Te=Math.max(Te,I);var Pe=Te*ke+Te-(Q>0&&y[0].length<=3?Te/2:0),Ke=2*Math.PI/y[ke].length*Se;return ke===0&&y[0].length===1&&(Pe=1),{x:ie.x+Pe*Math.cos(Ke),y:ie.y+Pe*Math.sin(Ke)}}else{var ut=y[ke].length,Et=Math.max(ut===1?0:o?(u.w-r.padding*2-ue.w)/((r.grid?bt:ut)-1):(u.w-r.padding*2-ue.w)/((r.grid?bt:ut)+1),I),Ze={x:ie.x+(Se+1-(ut+1)/2)*Et,y:ie.y+(ke+1-(Q+1)/2)*Me};return Ze}};return t.nodes().layoutPositions(this,r,at),this};var E9={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function U2(r){this.options=Ce({},E9,r)}U2.prototype.run=function(){var r=this.options,e=r,t=r.cy,n=e.eles,i=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,a=n.nodes().not(":parent");e.sort&&(a=a.sort(e.sort));for(var s=Ir(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),o={x:s.x1+s.w/2,y:s.y1+s.h/2},l=e.sweep===void 0?2*Math.PI-2*Math.PI/a.length:e.sweep,u=l/Math.max(1,a.length-1),h,f=0,c=0;c<a.length;c++){var d=a[c],p=d.layoutDimensions(e),g=p.w,v=p.h;f=Math.max(f,g,v)}if(se(e.radius)?h=e.radius:a.length<=1?h=0:h=Math.min(s.h,s.w)/2-f,a.length>1&&e.avoidOverlap){f*=1.75;var m=Math.cos(u)-Math.cos(0),y=Math.sin(u)-Math.sin(0),b=Math.sqrt(f*f/(m*m+y*y));h=Math.max(b,h)}var w=function(C,x){var A=e.startAngle+x*u*(i?1:-1),T=h*Math.cos(A),D=h*Math.sin(A),k={x:o.x+T,y:o.y+D};return k};return n.nodes().layoutPositions(this,e,w),this};var T9={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function K2(r){this.options=Ce({},T9,r)}K2.prototype.run=function(){for(var r=this.options,e=r,t=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,n=r.cy,i=e.eles,a=i.nodes().not(":parent"),s=Ir(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),o={x:s.x1+s.w/2,y:s.y1+s.h/2},l=[],u=0,h=0;h<a.length;h++){var f=a[h],c=void 0;c=e.concentric(f),l.push({value:c,node:f}),f._private.scratch.concentric=c}a.updateStyle();for(var d=0;d<a.length;d++){var p=a[d],g=p.layoutDimensions(e);u=Math.max(u,g.w,g.h)}l.sort(function(ue,Me){return Me.value-ue.value});for(var v=e.levelWidth(a),m=[[]],y=m[0],b=0;b<l.length;b++){var w=l[b];if(y.length>0){var S=Math.abs(y[0].value-w.value);S>=v&&(y=[],m.push(y))}y.push(w)}var C=u+e.minNodeSpacing;if(!e.avoidOverlap){var x=m.length>0&&m[0].length>1,A=Math.min(s.w,s.h)/2-C,T=A/(m.length+x?1:0);C=Math.min(C,T)}for(var D=0,k=0;k<m.length;k++){var E=m[k],M=e.sweep===void 0?2*Math.PI-2*Math.PI/E.length:e.sweep,O=E.dTheta=M/Math.max(1,E.length-1);if(E.length>1&&e.avoidOverlap){var R=Math.cos(O)-Math.cos(0),L=Math.sin(O)-Math.sin(0),I=Math.sqrt(C*C/(R*R+L*L));D=Math.max(I,D)}E.r=D,D+=C}if(e.equidistant){for(var N=0,q=0,z=0;z<m.length;z++){var F=m[z],_=F.r-q;N=Math.max(N,_)}q=0;for(var U=0;U<m.length;U++){var X=m[U];U===0&&(q=X.r),X.r=q,q+=N}}for(var $={},Q=0;Q<m.length;Q++)for(var ee=m[Q],oe=ee.dTheta,te=ee.r,V=0;V<ee.length;V++){var W=ee[V],K=e.startAngle+(t?1:-1)*oe*V,ie={x:o.x+te*Math.cos(K),y:o.y+te*Math.sin(K)};$[W.node.id()]=ie}return i.nodes().layoutPositions(this,e,function(ue){var Me=ue.id();return $[Me]}),this};var Ay,A9={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,t){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function Vc(r){this.options=Ce({},A9,r),this.options.layout=this;var e=this.options.eles.nodes(),t=this.options.eles.edges(),n=t.filter(function(i){var a=i.source().data("id"),s=i.target().data("id"),o=e.some(function(u){return u.data("id")===a}),l=e.some(function(u){return u.data("id")===s});return!o||!l});this.options.eles=this.options.eles.not(n)}Vc.prototype.run=function(){var r=this.options,e=r.cy,t=this;t.stopped=!1,(r.animate===!0||r.animate===!1)&&t.emit({type:"layoutstart",layout:t}),r.debug===!0?Ay=!0:Ay=!1;var n=M9(e,t,r);Ay&&P9(n),r.randomize&&B9(n);var i=ai(),a=function(){O9(n,e,r),r.fit===!0&&e.fit(r.padding)},s=function(c){return!(t.stopped||c>=r.numIter||(R9(n,r),n.temperature=n.temperature*r.coolingFactor,n.temperature<r.minTemp))},o=function(){if(r.animate===!0||r.animate===!1)a(),t.one("layoutstop",r.stop),t.emit({type:"layoutstop",layout:t});else{var c=r.eles.nodes(),d=Y2(n,r,c);c.layoutPositions(t,r,d)}},l=0,u=!0;if(r.animate===!0){var h=function(){for(var c=0;u&&c<r.refresh;)u=s(l),l++,c++;if(!u)vA(n,r),o();else{var d=ai();d-i>=r.animationThreshold&&a(),pc(h)}};h()}else{for(;u;)u=s(l),l++;vA(n,r),o()}return this};Vc.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};Vc.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var M9=function(e,t,n){for(var i=n.eles.edges(),a=n.eles.nodes(),s=Ir(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),o={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:a.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:i.size(),temperature:n.initialTemp,clientWidth:s.w,clientHeight:s.h,boundingBox:s},l=n.eles.components(),u={},h=0;h<l.length;h++)for(var f=l[h],c=0;c<f.length;c++){var d=f[c];u[d.id()]=h}for(var h=0;h<o.nodeSize;h++){var p=a[h],g=p.layoutDimensions(n),v={};v.isLocked=p.locked(),v.id=p.data("id"),v.parentId=p.data("parent"),v.cmptId=u[p.id()],v.children=[],v.positionX=p.position("x"),v.positionY=p.position("y"),v.offsetX=0,v.offsetY=0,v.height=g.w,v.width=g.h,v.maxX=v.positionX+v.width/2,v.minX=v.positionX-v.width/2,v.maxY=v.positionY+v.height/2,v.minY=v.positionY-v.height/2,v.padLeft=parseFloat(p.style("padding")),v.padRight=parseFloat(p.style("padding")),v.padTop=parseFloat(p.style("padding")),v.padBottom=parseFloat(p.style("padding")),v.nodeRepulsion=kt(n.nodeRepulsion)?n.nodeRepulsion(p):n.nodeRepulsion,o.layoutNodes.push(v),o.idToIndex[v.id]=h}for(var m=[],y=0,b=-1,w=[],h=0;h<o.nodeSize;h++){var p=o.layoutNodes[h],S=p.parentId;S!=null?o.layoutNodes[o.idToIndex[S]].children.push(p.id):(m[++b]=p.id,w.push(p.id))}for(o.graphSet.push(w);y<=b;){var C=m[y++],x=o.idToIndex[C],d=o.layoutNodes[x],A=d.children;if(A.length>0){o.graphSet.push(A);for(var h=0;h<A.length;h++)m[++b]=A[h]}}for(var h=0;h<o.graphSet.length;h++)for(var T=o.graphSet[h],c=0;c<T.length;c++){var D=o.idToIndex[T[c]];o.indexToGraph[D]=h}for(var h=0;h<o.edgeSize;h++){var k=i[h],E={};E.id=k.data("id"),E.sourceId=k.data("source"),E.targetId=k.data("target");var M=kt(n.idealEdgeLength)?n.idealEdgeLength(k):n.idealEdgeLength,O=kt(n.edgeElasticity)?n.edgeElasticity(k):n.edgeElasticity,R=o.idToIndex[E.sourceId],L=o.idToIndex[E.targetId],I=o.indexToGraph[R],N=o.indexToGraph[L];if(I!=N){for(var q=D9(E.sourceId,E.targetId,o),z=o.graphSet[q],F=0,v=o.layoutNodes[R];z.indexOf(v.id)===-1;)v=o.layoutNodes[o.idToIndex[v.parentId]],F++;for(v=o.layoutNodes[L];z.indexOf(v.id)===-1;)v=o.layoutNodes[o.idToIndex[v.parentId]],F++;M*=F*n.nestingFactor}E.idealLength=M,E.elasticity=O,o.layoutEdges.push(E)}return o},D9=function(e,t,n){var i=j2(e,t,0,n);return 2>i.count?0:i.graph},j2=function(e,t,n,i){var a=i.graphSet[n];if(-1<a.indexOf(e)&&-1<a.indexOf(t))return{count:2,graph:n};for(var s=0,o=0;o<a.length;o++){var l=a[o],u=i.idToIndex[l],h=i.layoutNodes[u].children;if(h.length!==0){var f=i.indexToGraph[i.idToIndex[h[0]]],c=j2(e,t,f,i);if(c.count!==0)if(c.count===1){if(s++,s===2)break}else return c}}return{count:s,graph:n}},P9,B9=function(e,t){for(var n=e.clientWidth,i=e.clientHeight,a=0;a<e.nodeSize;a++){var s=e.layoutNodes[a];s.children.length===0&&!s.isLocked&&(s.positionX=Math.random()*n,s.positionY=Math.random()*i)}},Y2=function(e,t,n){var i=e.boundingBox,a={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return t.boundingBox&&(n.forEach(function(s){var o=e.layoutNodes[e.idToIndex[s.data("id")]];a.x1=Math.min(a.x1,o.positionX),a.x2=Math.max(a.x2,o.positionX),a.y1=Math.min(a.y1,o.positionY),a.y2=Math.max(a.y2,o.positionY)}),a.w=a.x2-a.x1,a.h=a.y2-a.y1),function(s,o){var l=e.layoutNodes[e.idToIndex[s.data("id")]];if(t.boundingBox){var u=(l.positionX-a.x1)/a.w,h=(l.positionY-a.y1)/a.h;return{x:i.x1+u*i.w,y:i.y1+h*i.h}}else return{x:l.positionX,y:l.positionY}}},O9=function(e,t,n){var i=n.layout,a=n.eles.nodes(),s=Y2(e,n,a);a.positions(s),e.ready!==!0&&(e.ready=!0,i.one("layoutready",n.ready),i.emit({type:"layoutready",layout:this}))},R9=function(e,t,n){L9(e,t),q9(e),F9(e,t),_9(e),z9(e)},L9=function(e,t){for(var n=0;n<e.graphSet.length;n++)for(var i=e.graphSet[n],a=i.length,s=0;s<a;s++)for(var o=e.layoutNodes[e.idToIndex[i[s]]],l=s+1;l<a;l++){var u=e.layoutNodes[e.idToIndex[i[l]]];I9(o,u,e,t)}},gA=function(e){return-1+2*e*Math.random()},I9=function(e,t,n,i){var a=e.cmptId,s=t.cmptId;if(!(a!==s&&!n.isCompound)){var o=t.positionX-e.positionX,l=t.positionY-e.positionY,u=1;o===0&&l===0&&(o=gA(u),l=gA(u));var h=N9(e,t,o,l);if(h>0)var f=i.nodeOverlap*h,c=Math.sqrt(o*o+l*l),d=f*o/c,p=f*l/c;else var g=xc(e,o,l),v=xc(t,-1*o,-1*l),m=v.x-g.x,y=v.y-g.y,b=m*m+y*y,c=Math.sqrt(b),f=(e.nodeRepulsion+t.nodeRepulsion)/b,d=f*m/c,p=f*y/c;e.isLocked||(e.offsetX-=d,e.offsetY-=p),t.isLocked||(t.offsetX+=d,t.offsetY+=p)}},N9=function(e,t,n,i){if(n>0)var a=e.maxX-t.minX;else var a=t.maxX-e.minX;if(i>0)var s=e.maxY-t.minY;else var s=t.maxY-e.minY;return a>=0&&s>=0?Math.sqrt(a*a+s*s):0},xc=function(e,t,n){var i=e.positionX,a=e.positionY,s=e.height||1,o=e.width||1,l=n/t,u=s/o,h={};return t===0&&0<n||t===0&&0>n?(h.x=i,h.y=a+s/2,h):0<t&&-1*u<=l&&l<=u?(h.x=i+o/2,h.y=a+o*n/2/t,h):0>t&&-1*u<=l&&l<=u?(h.x=i-o/2,h.y=a-o*n/2/t,h):0<n&&(l<=-1*u||l>=u)?(h.x=i+s*t/2/n,h.y=a+s/2,h):(0>n&&(l<=-1*u||l>=u)&&(h.x=i-s*t/2/n,h.y=a-s/2),h)},q9=function(e,t){for(var n=0;n<e.edgeSize;n++){var i=e.layoutEdges[n],a=e.idToIndex[i.sourceId],s=e.layoutNodes[a],o=e.idToIndex[i.targetId],l=e.layoutNodes[o],u=l.positionX-s.positionX,h=l.positionY-s.positionY;if(!(u===0&&h===0)){var f=xc(s,u,h),c=xc(l,-1*u,-1*h),d=c.x-f.x,p=c.y-f.y,g=Math.sqrt(d*d+p*p),v=Math.pow(i.idealLength-g,2)/i.elasticity;if(g!==0)var m=v*d/g,y=v*p/g;else var m=0,y=0;s.isLocked||(s.offsetX+=m,s.offsetY+=y),l.isLocked||(l.offsetX-=m,l.offsetY-=y)}}},F9=function(e,t){if(t.gravity!==0)for(var n=1,i=0;i<e.graphSet.length;i++){var a=e.graphSet[i],s=a.length;if(i===0)var o=e.clientHeight/2,l=e.clientWidth/2;else var u=e.layoutNodes[e.idToIndex[a[0]]],h=e.layoutNodes[e.idToIndex[u.parentId]],o=h.positionX,l=h.positionY;for(var f=0;f<s;f++){var c=e.layoutNodes[e.idToIndex[a[f]]];if(!c.isLocked){var d=o-c.positionX,p=l-c.positionY,g=Math.sqrt(d*d+p*p);if(g>n){var v=t.gravity*d/g,m=t.gravity*p/g;c.offsetX+=v,c.offsetY+=m}}}}},_9=function(e,t){var n=[],i=0,a=-1;for(n.push.apply(n,e.graphSet[0]),a+=e.graphSet[0].length;i<=a;){var s=n[i++],o=e.idToIndex[s],l=e.layoutNodes[o],u=l.children;if(0<u.length&&!l.isLocked){for(var h=l.offsetX,f=l.offsetY,c=0;c<u.length;c++){var d=e.layoutNodes[e.idToIndex[u[c]]];d.offsetX+=h,d.offsetY+=f,n[++a]=u[c]}l.offsetX=0,l.offsetY=0}}},z9=function(e,t){for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&(i.maxX=void 0,i.minX=void 0,i.maxY=void 0,i.minY=void 0)}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];if(!(0<i.children.length||i.isLocked)){var a=V9(i.offsetX,i.offsetY,e.temperature);i.positionX+=a.x,i.positionY+=a.y,i.offsetX=0,i.offsetY=0,i.minX=i.positionX-i.width,i.maxX=i.positionX+i.width,i.minY=i.positionY-i.height,i.maxY=i.positionY+i.height,X2(i,e)}}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&!i.isLocked&&(i.positionX=(i.maxX+i.minX)/2,i.positionY=(i.maxY+i.minY)/2,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY)}},V9=function(e,t,n){var i=Math.sqrt(e*e+t*t);if(i>n)var a={x:n*e/i,y:n*t/i};else var a={x:e,y:t};return a},X2=function(e,t){var n=e.parentId;if(n!=null){var i=t.layoutNodes[t.idToIndex[n]],a=!1;if((i.maxX==null||e.maxX+i.padRight>i.maxX)&&(i.maxX=e.maxX+i.padRight,a=!0),(i.minX==null||e.minX-i.padLeft<i.minX)&&(i.minX=e.minX-i.padLeft,a=!0),(i.maxY==null||e.maxY+i.padBottom>i.maxY)&&(i.maxY=e.maxY+i.padBottom,a=!0),(i.minY==null||e.minY-i.padTop<i.minY)&&(i.minY=e.minY-i.padTop,a=!0),a)return X2(i,t)}},vA=function(e,t){for(var n=e.layoutNodes,i=[],a=0;a<n.length;a++){var s=n[a],o=s.cmptId,l=i[o]=i[o]||[];l.push(s)}for(var u=0,a=0;a<i.length;a++){var h=i[a];if(h){h.x1=1/0,h.x2=-1/0,h.y1=1/0,h.y2=-1/0;for(var f=0;f<h.length;f++){var c=h[f];h.x1=Math.min(h.x1,c.positionX-c.width/2),h.x2=Math.max(h.x2,c.positionX+c.width/2),h.y1=Math.min(h.y1,c.positionY-c.height/2),h.y2=Math.max(h.y2,c.positionY+c.height/2)}h.w=h.x2-h.x1,h.h=h.y2-h.y1,u+=h.w*h.h}}i.sort(function(y,b){return b.w*b.h-y.w*y.h});for(var d=0,p=0,g=0,v=0,m=Math.sqrt(u)*e.clientWidth/e.clientHeight,a=0;a<i.length;a++){var h=i[a];if(h){for(var f=0;f<h.length;f++){var c=h[f];c.isLocked||(c.positionX+=d-h.x1,c.positionY+=p-h.y1)}d+=h.w+t.componentSpacing,g+=h.w+t.componentSpacing,v=Math.max(v,h.h),g>m&&(p+=v+t.componentSpacing,d=0,g=0,v=0)}}},H9={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function $2(r){this.options=Ce({},H9,r)}$2.prototype.run=function(){var r=this.options,e=r,t=r.cy,n=e.eles,i=n.nodes().not(":parent");e.sort&&(i=i.sort(e.sort));var a=Ir(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()});if(a.h===0||a.w===0)n.nodes().layoutPositions(this,e,function(U){return{x:a.x1,y:a.y1}});else{var s=i.size(),o=Math.sqrt(s*a.h/a.w),l=Math.round(o),u=Math.round(a.w/a.h*o),h=function(X){if(X==null)return Math.min(l,u);var $=Math.min(l,u);$==l?l=X:u=X},f=function(X){if(X==null)return Math.max(l,u);var $=Math.max(l,u);$==l?l=X:u=X},c=e.rows,d=e.cols!=null?e.cols:e.columns;if(c!=null&&d!=null)l=c,u=d;else if(c!=null&&d==null)l=c,u=Math.ceil(s/l);else if(c==null&&d!=null)u=d,l=Math.ceil(s/u);else if(u*l>s){var p=h(),g=f();(p-1)*g>=s?h(p-1):(g-1)*p>=s&&f(g-1)}else for(;u*l<s;){var v=h(),m=f();(m+1)*v>=s?f(m+1):h(v+1)}var y=a.w/u,b=a.h/l;if(e.condense&&(y=0,b=0),e.avoidOverlap)for(var w=0;w<i.length;w++){var S=i[w],C=S._private.position;(C.x==null||C.y==null)&&(C.x=0,C.y=0);var x=S.layoutDimensions(e),A=e.avoidOverlapPadding,T=x.w+A,D=x.h+A;y=Math.max(y,T),b=Math.max(b,D)}for(var k={},E=function(X,$){return!!k["c-"+X+"-"+$]},M=function(X,$){k["c-"+X+"-"+$]=!0},O=0,R=0,L=function(){R++,R>=u&&(R=0,O++)},I={},N=0;N<i.length;N++){var q=i[N],z=e.position(q);if(z&&(z.row!==void 0||z.col!==void 0)){var F={row:z.row,col:z.col};if(F.col===void 0)for(F.col=0;E(F.row,F.col);)F.col++;else if(F.row===void 0)for(F.row=0;E(F.row,F.col);)F.row++;I[q.id()]=F,M(F.row,F.col)}}var _=function(X,$){var Q,ee;if(X.locked()||X.isParent())return!1;var oe=I[X.id()];if(oe)Q=oe.col*y+y/2+a.x1,ee=oe.row*b+b/2+a.y1;else{for(;E(O,R);)L();Q=R*y+y/2+a.x1,ee=O*b+b/2+a.y1,M(O,R),L()}return{x:Q,y:ee}};i.layoutPositions(this,e,_)}return this};var W9={ready:function(){},stop:function(){}};function S0(r){this.options=Ce({},W9,r)}S0.prototype.run=function(){var r=this.options,e=r.eles,t=this;return r.cy,t.emit("layoutstart"),e.nodes().positions(function(){return{x:0,y:0}}),t.one("layoutready",r.ready),t.emit("layoutready"),t.one("layoutstop",r.stop),t.emit("layoutstop"),this};S0.prototype.stop=function(){return this};var G9={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Z2(r){this.options=Ce({},G9,r)}Z2.prototype.run=function(){var r=this.options,e=r.eles,t=e.nodes(),n=kt(r.positions);function i(a){if(r.positions==null)return c8(a.position());if(n)return r.positions(a);var s=r.positions[a._private.data.id];return s??null}return t.layoutPositions(this,r,function(a,s){var o=i(a);return a.locked()||o==null?!1:o}),this};var U9={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Q2(r){this.options=Ce({},U9,r)}Q2.prototype.run=function(){var r=this.options,e=r.cy,t=r.eles,n=Ir(r.boundingBox?r.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),i=function(s,o){return{x:n.x1+Math.round(Math.random()*n.w),y:n.y1+Math.round(Math.random()*n.h)}};return t.nodes().layoutPositions(this,r,i),this};var K9=[{name:"breadthfirst",impl:G2},{name:"circle",impl:U2},{name:"concentric",impl:K2},{name:"cose",impl:Vc},{name:"grid",impl:$2},{name:"null",impl:S0},{name:"preset",impl:Z2},{name:"random",impl:Q2}];function J2(r){this.options=r,this.notifications=0}var mA=function(){},yA=function(){throw new Error("A headless instance can not render images")};J2.prototype={recalculateRenderedStyle:mA,notify:function(){this.notifications++},init:mA,isHeadless:function(){return!0},png:yA,jpg:yA};var C0={};C0.arrowShapeWidth=.3;C0.registerArrowShapes=function(){var r=this.arrowShapes={},e=this,t=function(u,h,f,c,d,p,g){var v=d.x-f/2-g,m=d.x+f/2+g,y=d.y-f/2-g,b=d.y+f/2+g,w=v<=u&&u<=m&&y<=h&&h<=b;return w},n=function(u,h,f,c,d){var p=u*Math.cos(c)-h*Math.sin(c),g=u*Math.sin(c)+h*Math.cos(c),v=p*f,m=g*f,y=v+d.x,b=m+d.y;return{x:y,y:b}},i=function(u,h,f,c){for(var d=[],p=0;p<u.length;p+=2){var g=u[p],v=u[p+1];d.push(n(g,v,h,f,c))}return d},a=function(u){for(var h=[],f=0;f<u.length;f++){var c=u[f];h.push(c.x,c.y)}return h},s=function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").pfValue*2},o=function(u,h){be(h)&&(h=r[h]),r[u]=Ce({name:u,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(c,d,p,g,v,m){var y=a(i(this.points,p+2*m,g,v)),b=Rr(c,d,y);return b},roughCollide:t,draw:function(c,d,p,g){var v=i(this.points,d,p,g);e.arrowShapeImpl("polygon")(c,v)},spacing:function(c){return 0},gap:s},h)};o("none",{collide:gc,roughCollide:gc,draw:l0,spacing:LE,gap:LE}),o("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),o("arrow","triangle"),o("triangle-backcurve",{points:r.triangle.points,controlPoint:[0,-.15],roughCollide:t,draw:function(u,h,f,c,d){var p=i(this.points,h,f,c),g=this.controlPoint,v=n(g[0],g[1],h,f,c);e.arrowShapeImpl(this.name)(u,p,v)},gap:function(u){return s(u)*.8}}),o("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(u,h,f,c,d,p,g){var v=a(i(this.points,f+2*g,c,d)),m=a(i(this.pointsTee,f+2*g,c,d)),y=Rr(u,h,v)||Rr(u,h,m);return y},draw:function(u,h,f,c,d){var p=i(this.points,h,f,c),g=i(this.pointsTee,h,f,c);e.arrowShapeImpl(this.name)(u,p,g)}}),o("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(u,h,f,c,d,p,g){var v=d,m=Math.pow(v.x-u,2)+Math.pow(v.y-h,2)<=Math.pow((f+2*g)*this.radius,2),y=a(i(this.points,f+2*g,c,d));return Rr(u,h,y)||m},draw:function(u,h,f,c,d){var p=i(this.pointsTr,h,f,c);e.arrowShapeImpl(this.name)(u,p,c.x,c.y,this.radius*h)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),o("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(u,h){var f=this.baseCrossLinePts.slice(),c=h/u,d=3,p=5;return f[d]=f[d]-c,f[p]=f[p]-c,f},collide:function(u,h,f,c,d,p,g){var v=a(i(this.points,f+2*g,c,d)),m=a(i(this.crossLinePts(f,p),f+2*g,c,d)),y=Rr(u,h,v)||Rr(u,h,m);return y},draw:function(u,h,f,c,d){var p=i(this.points,h,f,c),g=i(this.crossLinePts(h,d),h,f,c);e.arrowShapeImpl(this.name)(u,p,g)}}),o("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(u){return s(u)*.525}}),o("circle",{radius:.15,collide:function(u,h,f,c,d,p,g){var v=d,m=Math.pow(v.x-u,2)+Math.pow(v.y-h,2)<=Math.pow((f+2*g)*this.radius,2);return m},draw:function(u,h,f,c,d){e.arrowShapeImpl(this.name)(u,c.x,c.y,this.radius*h)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),o("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(u){return 1},gap:function(u){return 1}}),o("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),o("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}}),o("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(u){return .95*u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}})};var Ka={};Ka.projectIntoViewport=function(r,e){var t=this.cy,n=this.findContainerClientCoords(),i=n[0],a=n[1],s=n[4],o=t.pan(),l=t.zoom(),u=((r-i)/s-o.x)/l,h=((e-a)/s-o.y)/l;return[u,h]};Ka.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var r=this.container,e=r.getBoundingClientRect(),t=this.cy.window().getComputedStyle(r),n=function(m){return parseFloat(t.getPropertyValue(m))},i={left:n("padding-left"),right:n("padding-right"),top:n("padding-top"),bottom:n("padding-bottom")},a={left:n("border-left-width"),right:n("border-right-width"),top:n("border-top-width"),bottom:n("border-bottom-width")},s=r.clientWidth,o=r.clientHeight,l=i.left+i.right,u=i.top+i.bottom,h=a.left+a.right,f=e.width/(s+h),c=s-l,d=o-u,p=e.left+i.left+a.left,g=e.top+i.top+a.top;return this.containerBB=[p,g,c,d,f]};Ka.invalidateContainerClientCoordsCache=function(){this.containerBB=null};Ka.findNearestElement=function(r,e,t,n){return this.findNearestElements(r,e,t,n)[0]};Ka.findNearestElements=function(r,e,t,n){var i=this,a=this,s=a.getCachedZSortedEles(),o=[],l=a.cy.zoom(),u=a.cy.hasCompoundNodes(),h=(n?24:8)/l,f=(n?8:2)/l,c=(n?8:2)/l,d=1/0,p,g;t&&(s=s.interactive);function v(x,A){if(x.isNode()){if(g)return;g=x,o.push(x)}if(x.isEdge()&&(A==null||A<d))if(p){if(p.pstyle("z-compound-depth").value===x.pstyle("z-compound-depth").value&&p.pstyle("z-compound-depth").value===x.pstyle("z-compound-depth").value){for(var T=0;T<o.length;T++)if(o[T].isEdge()){o[T]=x,p=x,d=A??d;break}}}else o.push(x),p=x,d=A??d}function m(x){var A=x.outerWidth()+2*f,T=x.outerHeight()+2*f,D=A/2,k=T/2,E=x.position(),M=x.pstyle("corner-radius").value==="auto"?"auto":x.pstyle("corner-radius").pfValue,O=x._private.rscratch;if(E.x-D<=r&&r<=E.x+D&&E.y-k<=e&&e<=E.y+k){var R=a.nodeShapes[i.getNodeShape(x)];if(R.checkPoint(r,e,0,A,T,E.x,E.y,M,O))return v(x,0),!0}}function y(x){var A=x._private,T=A.rscratch,D=x.pstyle("width").pfValue,k=x.pstyle("arrow-scale").value,E=D/2+h,M=E*E,O=E*2,N=A.source,q=A.target,R;if(T.edgeType==="segments"||T.edgeType==="straight"||T.edgeType==="haystack"){for(var L=T.allpts,I=0;I+3<L.length;I+=2)if(T8(r,e,L[I],L[I+1],L[I+2],L[I+3],O)&&M>(R=B8(r,e,L[I],L[I+1],L[I+2],L[I+3])))return v(x,R),!0}else if(T.edgeType==="bezier"||T.edgeType==="multibezier"||T.edgeType==="self"||T.edgeType==="compound"){for(var L=T.allpts,I=0;I+5<T.allpts.length;I+=4)if(A8(r,e,L[I],L[I+1],L[I+2],L[I+3],L[I+4],L[I+5],O)&&M>(R=P8(r,e,L[I],L[I+1],L[I+2],L[I+3],L[I+4],L[I+5])))return v(x,R),!0}for(var N=N||A.source,q=q||A.target,z=i.getArrowWidth(D,k),F=[{name:"source",x:T.arrowStartX,y:T.arrowStartY,angle:T.srcArrowAngle},{name:"target",x:T.arrowEndX,y:T.arrowEndY,angle:T.tgtArrowAngle},{name:"mid-source",x:T.midX,y:T.midY,angle:T.midsrcArrowAngle},{name:"mid-target",x:T.midX,y:T.midY,angle:T.midtgtArrowAngle}],I=0;I<F.length;I++){var _=F[I],U=a.arrowShapes[x.pstyle(_.name+"-arrow-shape").value],X=x.pstyle("width").pfValue;if(U.roughCollide(r,e,z,_.angle,{x:_.x,y:_.y},X,h)&&U.collide(r,e,z,_.angle,{x:_.x,y:_.y},X,h))return v(x),!0}u&&o.length>0&&(m(N),m(q))}function b(x,A,T){return Or(x,A,T)}function w(x,A){var T=x._private,D=c,k;A?k=A+"-":k="",x.boundingBox();var E=T.labelBounds[A||"main"],M=x.pstyle(k+"label").value,O=x.pstyle("text-events").strValue==="yes";if(!(!O||!M)){var R=b(T.rscratch,"labelX",A),L=b(T.rscratch,"labelY",A),I=b(T.rscratch,"labelAngle",A),N=x.pstyle(k+"text-margin-x").pfValue,q=x.pstyle(k+"text-margin-y").pfValue,z=E.x1-D-N,F=E.x2+D-N,_=E.y1-D-q,U=E.y2+D-q;if(I){var X=Math.cos(I),$=Math.sin(I),Q=function(ie,ue){return ie=ie-R,ue=ue-L,{x:ie*X-ue*$+R,y:ie*$+ue*X+L}},ee=Q(z,_),oe=Q(z,U),te=Q(F,_),V=Q(F,U),W=[ee.x+N,ee.y+q,te.x+N,te.y+q,V.x+N,V.y+q,oe.x+N,oe.y+q];if(Rr(r,e,W))return v(x),!0}else if($s(E,r,e))return v(x),!0}}for(var S=s.length-1;S>=0;S--){var C=s[S];C.isNode()?m(C)||w(C):y(C)||w(C)||w(C,"source")||w(C,"target")}return o};Ka.getAllInBox=function(r,e,t,n){var i=this.getCachedZSortedEles().interactive,a=this.cy.zoom(),s=2/a,o=[],l=Math.min(r,t),u=Math.max(r,t),h=Math.min(e,n),f=Math.max(e,n);r=l,t=u,e=h,n=f;var c=Ir({x1:r,y1:e,x2:t,y2:n});function d(M,O,R){return Or(M,O,R)}function p(M,O){var R=M._private,L=s,I="";M.boundingBox();var N=R.labelBounds.main,q=d(R.rscratch,"labelX",O),z=d(R.rscratch,"labelY",O),F=d(R.rscratch,"labelAngle",O),_=M.pstyle(I+"text-margin-x").pfValue,U=M.pstyle(I+"text-margin-y").pfValue,X=N.x1-L-_,$=N.x2+L-_,Q=N.y1-L-U,ee=N.y2+L-U;if(F){var oe=Math.cos(F),te=Math.sin(F),V=function(K,ie){return K=K-q,ie=ie-z,{x:K*oe-ie*te+q,y:K*te+ie*oe+z}};return[V(X,Q),V($,Q),V($,ee),V(X,ee)]}else return[{x:X,y:Q},{x:$,y:Q},{x:$,y:ee},{x:X,y:ee}]}for(var g=0;g<i.length;g++){var v=i[g];if(v.isNode()){var m=v,y=m.pstyle("text-events").strValue==="yes",b=m.pstyle("box-select-labels").strValue==="yes",w=m.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:b&&y});if(c0(c,w)){var S=p(m),C=[{x:c.x1,y:c.y1},{x:c.x2,y:c.y1},{x:c.x2,y:c.y2},{x:c.x1,y:c.y2}];N8(S,C)&&o.push(m)}}else{var x=v,A=x._private,T=A.rscratch;if(T.startX!=null&&T.startY!=null&&!$s(c,T.startX,T.startY)||T.endX!=null&&T.endY!=null&&!$s(c,T.endX,T.endY))continue;if(T.edgeType==="bezier"||T.edgeType==="multibezier"||T.edgeType==="self"||T.edgeType==="compound"||T.edgeType==="segments"||T.edgeType==="haystack"){for(var D=A.rstyle.bezierPts||A.rstyle.linePts||A.rstyle.haystackPts,k=!0,E=0;E<D.length;E++)if(!k8(c,D[E])){k=!1;break}k&&o.push(x)}else(T.edgeType==="haystack"||T.edgeType==="straight")&&o.push(x)}}return o};var Sc={};Sc.calculateArrowAngles=function(r){var e=r._private.rscratch,t=e.edgeType==="haystack",n=e.edgeType==="bezier",i=e.edgeType==="multibezier",a=e.edgeType==="segments",s=e.edgeType==="compound",o=e.edgeType==="self",l,u,h,f,c,d,m,y;if(t?(h=e.haystackPts[0],f=e.haystackPts[1],c=e.haystackPts[2],d=e.haystackPts[3]):(h=e.arrowStartX,f=e.arrowStartY,c=e.arrowEndX,d=e.arrowEndY),m=e.midX,y=e.midY,a)l=h-e.segpts[0],u=f-e.segpts[1];else if(i||s||o||n){var p=e.allpts,g=jt(p[0],p[2],p[4],.1),v=jt(p[1],p[3],p[5],.1);l=h-g,u=f-v}else l=h-m,u=f-y;e.srcArrowAngle=Gf(l,u);var m=e.midX,y=e.midY;if(t&&(m=(h+c)/2,y=(f+d)/2),l=c-h,u=d-f,a){var p=e.allpts;if(p.length/2%2===0){var b=p.length/2,w=b-2;l=p[b]-p[w],u=p[b+1]-p[w+1]}else if(e.isRound)l=e.midVector[1],u=-e.midVector[0];else{var b=p.length/2-1,w=b-2;l=p[b]-p[w],u=p[b+1]-p[w+1]}}else if(i||s||o){var p=e.allpts,S=e.ctrlpts,C,x,A,T;if(S.length/2%2===0){var D=p.length/2-1,k=D+2,E=k+2;C=jt(p[D],p[k],p[E],0),x=jt(p[D+1],p[k+1],p[E+1],0),A=jt(p[D],p[k],p[E],1e-4),T=jt(p[D+1],p[k+1],p[E+1],1e-4)}else{var k=p.length/2-1,D=k-2,E=k+2;C=jt(p[D],p[k],p[E],.4999),x=jt(p[D+1],p[k+1],p[E+1],.4999),A=jt(p[D],p[k],p[E],.5),T=jt(p[D+1],p[k+1],p[E+1],.5)}l=A-C,u=T-x}if(e.midtgtArrowAngle=Gf(l,u),e.midDispX=l,e.midDispY=u,l*=-1,u*=-1,a){var p=e.allpts;if(p.length/2%2!==0){if(!e.isRound){var b=p.length/2-1,M=b+2;l=-(p[M]-p[b]),u=-(p[M+1]-p[b+1])}}}if(e.midsrcArrowAngle=Gf(l,u),a)l=c-e.segpts[e.segpts.length-2],u=d-e.segpts[e.segpts.length-1];else if(i||s||o||n){var p=e.allpts,O=p.length,g=jt(p[O-6],p[O-4],p[O-2],.9),v=jt(p[O-5],p[O-3],p[O-1],.9);l=c-g,u=d-v}else l=c-m,u=d-y;e.tgtArrowAngle=Gf(l,u)};Sc.getArrowWidth=Sc.getArrowHeight=function(r,e){var t=this.arrowWidthCache=this.arrowWidthCache||{},n=t[r+", "+e];return n||(n=Math.max(Math.pow(r*13.37,.9),29)*e,t[r+", "+e]=n,n)};var Yy,Xy,qn={},en={},bA,wA,Fa,uc,ri,Ba,Na,In,Fs,Qf,eM,tM,$y,Zy,xA,SA=function(e,t,n){n.x=t.x-e.x,n.y=t.y-e.y,n.len=Math.sqrt(n.x*n.x+n.y*n.y),n.nx=n.x/n.len,n.ny=n.y/n.len,n.ang=Math.atan2(n.ny,n.nx)},j9=function(e,t){t.x=e.x*-1,t.y=e.y*-1,t.nx=e.nx*-1,t.ny=e.ny*-1,t.ang=e.ang>0?-(Math.PI-e.ang):Math.PI+e.ang},Y9=function(e,t,n,i,a){if(e!==xA?SA(t,e,qn):j9(en,qn),SA(t,n,en),bA=qn.nx*en.ny-qn.ny*en.nx,wA=qn.nx*en.nx-qn.ny*-en.ny,ri=Math.asin(Math.max(-1,Math.min(1,bA))),Math.abs(ri)<1e-6){Yy=t.x,Xy=t.y,Na=Fs=0;return}Fa=1,uc=!1,wA<0?ri<0?ri=Math.PI+ri:(ri=Math.PI-ri,Fa=-1,uc=!0):ri>0&&(Fa=-1,uc=!0),t.radius!==void 0?Fs=t.radius:Fs=i,Ba=ri/2,Qf=Math.min(qn.len/2,en.len/2),a?(In=Math.abs(Math.cos(Ba)*Fs/Math.sin(Ba)),In>Qf?(In=Qf,Na=Math.abs(In*Math.sin(Ba)/Math.cos(Ba))):Na=Fs):(In=Math.min(Qf,Fs),Na=Math.abs(In*Math.sin(Ba)/Math.cos(Ba))),$y=t.x+en.nx*In,Zy=t.y+en.ny*In,Yy=$y-en.ny*Na*Fa,Xy=Zy+en.nx*Na*Fa,eM=t.x+qn.nx*In,tM=t.y+qn.ny*In,xA=t};function rM(r,e){e.radius===0?r.lineTo(e.cx,e.cy):r.arc(e.cx,e.cy,e.radius,e.startAngle,e.endAngle,e.counterClockwise)}function k0(r,e,t,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return n===0||e.radius===0?{cx:e.x,cy:e.y,radius:0,startX:e.x,startY:e.y,stopX:e.x,stopY:e.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(Y9(r,e,t,n,i),{cx:Yy,cy:Xy,radius:Na,startX:eM,startY:tM,stopX:$y,stopY:Zy,startAngle:qn.ang+Math.PI/2*Fa,endAngle:en.ang-Math.PI/2*Fa,counterClockwise:uc})}var Ql=.01,X9=Math.sqrt(2*Ql),vr={};vr.findMidptPtsEtc=function(r,e){var t=e.posPts,n=e.intersectionPts,i=e.vectorNormInverse,a,s=r.pstyle("source-endpoint"),o=r.pstyle("target-endpoint"),l=s.units!=null&&o.units!=null,u=function(S,C,x,A){var T=A-C,D=x-S,k=Math.sqrt(D*D+T*T);return{x:-T/k,y:D/k}},h=r.pstyle("edge-distances").value;switch(h){case"node-position":a=t;break;case"intersection":a=n;break;case"endpoints":{if(l){var f=this.manualEndptToPx(r.source()[0],s),c=zt(f,2),d=c[0],p=c[1],g=this.manualEndptToPx(r.target()[0],o),v=zt(g,2),m=v[0],y=v[1],b={x1:d,y1:p,x2:m,y2:y};i=u(d,p,m,y),a=b}else it("Edge ".concat(r.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),a=n;break}}return{midptPts:a,vectorNormInverse:i}};vr.findHaystackPoints=function(r){for(var e=0;e<r.length;e++){var t=r[e],n=t._private,i=n.rscratch;if(!i.haystack){var a=Math.random()*2*Math.PI;i.source={x:Math.cos(a),y:Math.sin(a)},a=Math.random()*2*Math.PI,i.target={x:Math.cos(a),y:Math.sin(a)}}var s=n.source,o=n.target,l=s.position(),u=o.position(),h=s.width(),f=o.width(),c=s.height(),d=o.height(),p=t.pstyle("haystack-radius").value,g=p/2;i.haystackPts=i.allpts=[i.source.x*h*g+l.x,i.source.y*c*g+l.y,i.target.x*f*g+u.x,i.target.y*d*g+u.y],i.midX=(i.allpts[0]+i.allpts[2])/2,i.midY=(i.allpts[1]+i.allpts[3])/2,i.edgeType="haystack",i.haystack=!0,this.storeEdgeProjections(t),this.calculateArrowAngles(t),this.recalculateEdgeLabelProjections(t),this.calculateLabelAngles(t)}};vr.findSegmentsPoints=function(r,e){var t=r._private.rscratch,n=r.pstyle("segment-weights"),i=r.pstyle("segment-distances"),a=r.pstyle("segment-radii"),s=r.pstyle("radius-type"),o=Math.min(n.pfValue.length,i.pfValue.length),l=a.pfValue[a.pfValue.length-1],u=s.pfValue[s.pfValue.length-1];t.edgeType="segments",t.segpts=[],t.radii=[],t.isArcRadius=[];for(var h=0;h<o;h++){var f=n.pfValue[h],c=i.pfValue[h],d=1-f,p=f,g=this.findMidptPtsEtc(r,e),v=g.midptPts,m=g.vectorNormInverse,y={x:v.x1*d+v.x2*p,y:v.y1*d+v.y2*p};t.segpts.push(y.x+m.x*c,y.y+m.y*c),t.radii.push(a.pfValue[h]!==void 0?a.pfValue[h]:l),t.isArcRadius.push((s.pfValue[h]!==void 0?s.pfValue[h]:u)==="arc-radius")}};vr.findLoopPoints=function(r,e,t,n){var i=r._private.rscratch,a=e.dirCounts,s=e.srcPos,o=r.pstyle("control-point-distances"),l=o?o.pfValue[0]:void 0,u=r.pstyle("loop-direction").pfValue,h=r.pstyle("loop-sweep").pfValue,f=r.pstyle("control-point-step-size").pfValue;i.edgeType="self";var c=t,d=f;n&&(c=0,d=l);var p=u-Math.PI/2,g=p-h/2,v=p+h/2,m=u+"_"+h;c=a[m]===void 0?a[m]=0:++a[m],i.ctrlpts=[s.x+Math.cos(g)*1.4*d*(c/3+1),s.y+Math.sin(g)*1.4*d*(c/3+1),s.x+Math.cos(v)*1.4*d*(c/3+1),s.y+Math.sin(v)*1.4*d*(c/3+1)]};vr.findCompoundLoopPoints=function(r,e,t,n){var i=r._private.rscratch;i.edgeType="compound";var a=e.srcPos,s=e.tgtPos,o=e.srcW,l=e.srcH,u=e.tgtW,h=e.tgtH,f=r.pstyle("control-point-step-size").pfValue,c=r.pstyle("control-point-distances"),d=c?c.pfValue[0]:void 0,p=t,g=f;n&&(p=0,g=d);var v=50,m={x:a.x-o/2,y:a.y-l/2},y={x:s.x-u/2,y:s.y-h/2},b={x:Math.min(m.x,y.x),y:Math.min(m.y,y.y)},w=.5,S=Math.max(w,Math.log(o*Ql)),C=Math.max(w,Math.log(u*Ql));i.ctrlpts=[b.x,b.y-(1+Math.pow(v,1.12)/100)*g*(p/3+1)*S,b.x-(1+Math.pow(v,1.12)/100)*g*(p/3+1)*C,b.y]};vr.findStraightEdgePoints=function(r){r._private.rscratch.edgeType="straight"};vr.findBezierPoints=function(r,e,t,n,i){var a=r._private.rscratch,s=r.pstyle("control-point-step-size").pfValue,o=r.pstyle("control-point-distances"),l=r.pstyle("control-point-weights"),u=o&&l?Math.min(o.value.length,l.value.length):1,h=o?o.pfValue[0]:void 0,f=l.value[0],c=n;a.edgeType=c?"multibezier":"bezier",a.ctrlpts=[];for(var d=0;d<u;d++){var p=(.5-e.eles.length/2+t)*s*(i?-1:1),g=void 0,v=f0(p);c&&(h=o?o.pfValue[d]:s,f=l.value[d]),n?g=h:g=h!==void 0?v*h:void 0;var m=g!==void 0?g:p,y=1-f,b=f,w=this.findMidptPtsEtc(r,e),S=w.midptPts,C=w.vectorNormInverse,x={x:S.x1*y+S.x2*b,y:S.y1*y+S.y2*b};a.ctrlpts.push(x.x+C.x*m,x.y+C.y*m)}};vr.findTaxiPoints=function(r,e){var t=r._private.rscratch;t.edgeType="segments";var n="vertical",i="horizontal",a="leftward",s="rightward",o="downward",l="upward",u="auto",h=e.posPts,f=e.srcW,c=e.srcH,d=e.tgtW,p=e.tgtH,g=r.pstyle("edge-distances").value,v=g!=="node-position",m=r.pstyle("taxi-direction").value,y=m,b=r.pstyle("taxi-turn"),w=b.units==="%",S=b.pfValue,C=S<0,x=r.pstyle("taxi-turn-min-distance").pfValue,A=v?(f+d)/2:0,T=v?(c+p)/2:0,D=h.x2-h.x1,k=h.y2-h.y1,E=function(P,G){return P>0?Math.max(P-G,0):Math.min(P+G,0)},M=E(D,A),O=E(k,T),R=!1;y===u?m=Math.abs(M)>Math.abs(O)?i:n:y===l||y===o?(m=n,R=!0):(y===a||y===s)&&(m=i,R=!0);var L=m===n,I=L?O:M,N=L?k:D,q=f0(N),z=!1;!(R&&(w||C))&&(y===o&&N<0||y===l&&N>0||y===a&&N>0||y===s&&N<0)&&(q*=-1,I=q*Math.abs(I),z=!0);var F;if(w){var _=S<0?1+S:S;F=_*I}else{var U=S<0?I:0;F=U+S*q}var X=function(P){return Math.abs(P)<x||Math.abs(P)>=Math.abs(I)},$=X(F),Q=X(Math.abs(I)-Math.abs(F)),ee=$||Q;if(ee&&!z)if(L){var oe=Math.abs(N)<=c/2,te=Math.abs(D)<=d/2;if(oe){var V=(h.x1+h.x2)/2,W=h.y1,K=h.y2;t.segpts=[V,W,V,K]}else if(te){var ie=(h.y1+h.y2)/2,ue=h.x1,Me=h.x2;t.segpts=[ue,ie,Me,ie]}else t.segpts=[h.x1,h.y2]}else{var bt=Math.abs(N)<=f/2,at=Math.abs(k)<=p/2;if(bt){var ce=(h.y1+h.y2)/2,de=h.x1,xe=h.x2;t.segpts=[de,ce,xe,ce]}else if(at){var ke=(h.x1+h.x2)/2,Se=h.y1,Te=h.y2;t.segpts=[ke,Se,ke,Te]}else t.segpts=[h.x2,h.y1]}else if(L){var Pe=h.y1+F+(v?c/2*q:0),Ke=h.x1,ut=h.x2;t.segpts=[Ke,Pe,ut,Pe]}else{var Et=h.x1+F+(v?f/2*q:0),Ze=h.y1,Bt=h.y2;t.segpts=[Et,Ze,Et,Bt]}if(t.isRound){var Ye=r.pstyle("taxi-radius").value,me=r.pstyle("radius-type").value[0]==="arc-radius";t.radii=new Array(t.segpts.length/2).fill(Ye),t.isArcRadius=new Array(t.segpts.length/2).fill(me)}};vr.tryToCorrectInvalidPoints=function(r,e){var t=r._private.rscratch;if(t.edgeType==="bezier"){var n=e.srcPos,i=e.tgtPos,a=e.srcW,s=e.srcH,o=e.tgtW,l=e.tgtH,u=e.srcShape,h=e.tgtShape,f=e.srcCornerRadius,c=e.tgtCornerRadius,d=e.srcRs,p=e.tgtRs,g=!se(t.startX)||!se(t.startY),v=!se(t.arrowStartX)||!se(t.arrowStartY),m=!se(t.endX)||!se(t.endY),y=!se(t.arrowEndX)||!se(t.arrowEndY),b=3,w=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth,S=b*w,C=Va({x:t.ctrlpts[0],y:t.ctrlpts[1]},{x:t.startX,y:t.startY}),x=C<S,A=Va({x:t.ctrlpts[0],y:t.ctrlpts[1]},{x:t.endX,y:t.endY}),T=A<S,D=!1;if(g||v||x){D=!0;var k={x:t.ctrlpts[0]-n.x,y:t.ctrlpts[1]-n.y},E=Math.sqrt(k.x*k.x+k.y*k.y),M={x:k.x/E,y:k.y/E},O=Math.max(a,s),R={x:t.ctrlpts[0]+M.x*2*O,y:t.ctrlpts[1]+M.y*2*O},L=u.intersectLine(n.x,n.y,a,s,R.x,R.y,0,f,d);x?(t.ctrlpts[0]=t.ctrlpts[0]+M.x*(S-C),t.ctrlpts[1]=t.ctrlpts[1]+M.y*(S-C)):(t.ctrlpts[0]=L[0]+M.x*S,t.ctrlpts[1]=L[1]+M.y*S)}if(m||y||T){D=!0;var I={x:t.ctrlpts[0]-i.x,y:t.ctrlpts[1]-i.y},N=Math.sqrt(I.x*I.x+I.y*I.y),q={x:I.x/N,y:I.y/N},z=Math.max(a,s),F={x:t.ctrlpts[0]+q.x*2*z,y:t.ctrlpts[1]+q.y*2*z},_=h.intersectLine(i.x,i.y,o,l,F.x,F.y,0,c,p);T?(t.ctrlpts[0]=t.ctrlpts[0]+q.x*(S-A),t.ctrlpts[1]=t.ctrlpts[1]+q.y*(S-A)):(t.ctrlpts[0]=_[0]+q.x*S,t.ctrlpts[1]=_[1]+q.y*S)}D&&this.findEndpoints(r)}};vr.storeAllpts=function(r){var e=r._private.rscratch;if(e.edgeType==="multibezier"||e.edgeType==="bezier"||e.edgeType==="self"||e.edgeType==="compound"){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var t=0;t+1<e.ctrlpts.length;t+=2)e.allpts.push(e.ctrlpts[t],e.ctrlpts[t+1]),t+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[t]+e.ctrlpts[t+2])/2,(e.ctrlpts[t+1]+e.ctrlpts[t+3])/2);e.allpts.push(e.endX,e.endY);var n,i;e.ctrlpts.length/2%2===0?(n=e.allpts.length/2-1,e.midX=e.allpts[n],e.midY=e.allpts[n+1]):(n=e.allpts.length/2-3,i=.5,e.midX=jt(e.allpts[n],e.allpts[n+2],e.allpts[n+4],i),e.midY=jt(e.allpts[n+1],e.allpts[n+3],e.allpts[n+5],i))}else if(e.edgeType==="straight")e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if(e.edgeType==="segments"){if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.isRound){e.roundCorners=[];for(var a=2;a+3<e.allpts.length;a+=2){var s=e.radii[a/2-1],o=e.isArcRadius[a/2-1];e.roundCorners.push(k0({x:e.allpts[a-2],y:e.allpts[a-1]},{x:e.allpts[a],y:e.allpts[a+1],radius:s},{x:e.allpts[a+2],y:e.allpts[a+3]},s,o))}}if(e.segpts.length%4===0){var l=e.segpts.length/2,u=l-2;e.midX=(e.segpts[u]+e.segpts[l])/2,e.midY=(e.segpts[u+1]+e.segpts[l+1])/2}else{var h=e.segpts.length/2-1;if(!e.isRound)e.midX=e.segpts[h],e.midY=e.segpts[h+1];else{var f={x:e.segpts[h],y:e.segpts[h+1]},c=e.roundCorners[h/2];if(c.radius===0){var d={x:e.segpts[h+2],y:e.segpts[h+3]};e.midX=f.x,e.midY=f.y,e.midVector=[f.y-d.y,d.x-f.x]}else{var p=[f.x-c.cx,f.y-c.cy],g=c.radius/Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2));p=p.map(function(v){return v*g}),e.midX=c.cx+p[0],e.midY=c.cy+p[1],e.midVector=p}}}}};vr.checkForInvalidEdgeWarning=function(r){var e=r[0]._private.rscratch;e.nodesOverlap||se(e.startX)&&se(e.startY)&&se(e.endX)&&se(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,it("Edge `"+r.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};vr.findEdgeControlPoints=function(r){var e=this;if(!(!r||r.length===0)){for(var t=this,n=t.cy,i=n.hasCompoundNodes(),a=new ii,s=function(T,D){return[].concat(cc(T),[D?1:0]).join("-")},o=[],l=[],u=0;u<r.length;u++){var h=r[u],f=h._private,c=h.pstyle("curve-style").value;if(!(h.removed()||!h.takesUpSpace())){if(c==="haystack"){l.push(h);continue}var d=c==="unbundled-bezier"||c.endsWith("segments")||c==="straight"||c==="straight-triangle"||c.endsWith("taxi"),p=c==="unbundled-bezier"||c==="bezier",g=f.source,v=f.target,m=g.poolIndex(),y=v.poolIndex(),b=[m,y].sort(),w=s(b,d),S=a.get(w);S==null&&(S={eles:[]},o.push({pairId:b,edgeIsUnbundled:d}),a.set(w,S)),S.eles.push(h),d&&(S.hasUnbundled=!0),p&&(S.hasBezier=!0)}}for(var C=function(){var T=o[x],D=T.pairId,k=T.edgeIsUnbundled,E=s(D,k),M=a.get(E),O;if(!M.hasUnbundled){var R=M.eles[0].parallelEdges().filter(function(me){return me.isBundledBezier()});u0(M.eles),R.forEach(function(me){return M.eles.push(me)}),M.eles.sort(function(me,J){return me.poolIndex()-J.poolIndex()})}var L=M.eles[0],I=L.source(),N=L.target();if(I.poolIndex()>N.poolIndex()){var q=I;I=N,N=q}var z=M.srcPos=I.position(),F=M.tgtPos=N.position(),_=M.srcW=I.outerWidth(),U=M.srcH=I.outerHeight(),X=M.tgtW=N.outerWidth(),$=M.tgtH=N.outerHeight(),Q=M.srcShape=t.nodeShapes[e.getNodeShape(I)],ee=M.tgtShape=t.nodeShapes[e.getNodeShape(N)],oe=M.srcCornerRadius=I.pstyle("corner-radius").value==="auto"?"auto":I.pstyle("corner-radius").pfValue,te=M.tgtCornerRadius=N.pstyle("corner-radius").value==="auto"?"auto":N.pstyle("corner-radius").pfValue,V=M.tgtRs=N._private.rscratch,W=M.srcRs=I._private.rscratch;M.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var K=0;K<M.eles.length;K++){var ie=M.eles[K],ue=ie[0]._private.rscratch,Me=ie.pstyle("curve-style").value,bt=Me==="unbundled-bezier"||Me.endsWith("segments")||Me.endsWith("taxi"),at=!I.same(ie.source());if(!M.calculatedIntersection&&I!==N&&(M.hasBezier||M.hasUnbundled)){M.calculatedIntersection=!0;var ce=Q.intersectLine(z.x,z.y,_,U,F.x,F.y,0,oe,W),de=M.srcIntn=ce,xe=ee.intersectLine(F.x,F.y,X,$,z.x,z.y,0,te,V),ke=M.tgtIntn=xe,Se=M.intersectionPts={x1:ce[0],x2:xe[0],y1:ce[1],y2:xe[1]},Te=M.posPts={x1:z.x,x2:F.x,y1:z.y,y2:F.y},Pe=xe[1]-ce[1],Ke=xe[0]-ce[0],ut=Math.sqrt(Ke*Ke+Pe*Pe);se(ut)&&ut>=X9||(ut=Math.sqrt(Math.max(Ke*Ke,Ql)+Math.max(Pe*Pe,Ql)));var Et=M.vector={x:Ke,y:Pe},Ze=M.vectorNorm={x:Et.x/ut,y:Et.y/ut},Bt={x:-Ze.y,y:Ze.x};M.nodesOverlap=!se(ut)||ee.checkPoint(ce[0],ce[1],0,X,$,F.x,F.y,te,V)||Q.checkPoint(xe[0],xe[1],0,_,U,z.x,z.y,oe,W),M.vectorNormInverse=Bt,O={nodesOverlap:M.nodesOverlap,dirCounts:M.dirCounts,calculatedIntersection:!0,hasBezier:M.hasBezier,hasUnbundled:M.hasUnbundled,eles:M.eles,srcPos:F,srcRs:V,tgtPos:z,tgtRs:W,srcW:X,srcH:$,tgtW:_,tgtH:U,srcIntn:ke,tgtIntn:de,srcShape:ee,tgtShape:Q,posPts:{x1:Te.x2,y1:Te.y2,x2:Te.x1,y2:Te.y1},intersectionPts:{x1:Se.x2,y1:Se.y2,x2:Se.x1,y2:Se.y1},vector:{x:-Et.x,y:-Et.y},vectorNorm:{x:-Ze.x,y:-Ze.y},vectorNormInverse:{x:-Bt.x,y:-Bt.y}}}var Ye=at?O:M;ue.nodesOverlap=Ye.nodesOverlap,ue.srcIntn=Ye.srcIntn,ue.tgtIntn=Ye.tgtIntn,ue.isRound=Me.startsWith("round"),i&&(I.isParent()||I.isChild()||N.isParent()||N.isChild())&&(I.parents().anySame(N)||N.parents().anySame(I)||I.same(N)&&I.isParent())?e.findCompoundLoopPoints(ie,Ye,K,bt):I===N?e.findLoopPoints(ie,Ye,K,bt):Me.endsWith("segments")?e.findSegmentsPoints(ie,Ye):Me.endsWith("taxi")?e.findTaxiPoints(ie,Ye):Me==="straight"||!bt&&M.eles.length%2===1&&K===Math.floor(M.eles.length/2)?e.findStraightEdgePoints(ie):e.findBezierPoints(ie,Ye,K,bt,at),e.findEndpoints(ie),e.tryToCorrectInvalidPoints(ie,Ye),e.checkForInvalidEdgeWarning(ie),e.storeAllpts(ie),e.storeEdgeProjections(ie),e.calculateArrowAngles(ie),e.recalculateEdgeLabelProjections(ie),e.calculateLabelAngles(ie)}},x=0;x<o.length;x++)C();this.findHaystackPoints(l)}};function nM(r){var e=[];if(r!=null){for(var t=0;t<r.length;t+=2){var n=r[t],i=r[t+1];e.push({x:n,y:i})}return e}}vr.getSegmentPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var t=e.edgeType;if(t==="segments")return nM(e.segpts)};vr.getControlPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var t=e.edgeType;if(t==="bezier"||t==="multibezier"||t==="self"||t==="compound")return nM(e.ctrlpts)};vr.getEdgeMidpoint=function(r){var e=r[0]._private.rscratch;return this.recalculateRenderedStyle(r),{x:e.midX,y:e.midY}};var lu={};lu.manualEndptToPx=function(r,e){var t=this,n=r.position(),i=r.outerWidth(),a=r.outerHeight(),s=r._private.rscratch;if(e.value.length===2){var o=[e.pfValue[0],e.pfValue[1]];return e.units[0]==="%"&&(o[0]=o[0]*i),e.units[1]==="%"&&(o[1]=o[1]*a),o[0]+=n.x,o[1]+=n.y,o}else{var l=e.pfValue[0];l=-Math.PI/2+l;var u=2*Math.max(i,a),h=[n.x+Math.cos(l)*u,n.y+Math.sin(l)*u];return t.nodeShapes[this.getNodeShape(r)].intersectLine(n.x,n.y,i,a,h[0],h[1],0,r.pstyle("corner-radius").value==="auto"?"auto":r.pstyle("corner-radius").pfValue,s)}};lu.findEndpoints=function(r){var e=this,t,n=r.source()[0],i=r.target()[0],a=n.position(),s=i.position(),o=r.pstyle("target-arrow-shape").value,l=r.pstyle("source-arrow-shape").value,u=r.pstyle("target-distance-from-node").pfValue,h=r.pstyle("source-distance-from-node").pfValue,f=n._private.rscratch,c=i._private.rscratch,d=r.pstyle("curve-style").value,p=r._private.rscratch,g=p.edgeType,v=d==="taxi",m=g==="self"||g==="compound",y=g==="bezier"||g==="multibezier"||m,b=g!=="bezier",w=g==="straight"||g==="segments",S=g==="segments",C=y||b||w,x=m||v,A=r.pstyle("source-endpoint"),T=x?"outside-to-node":A.value,D=n.pstyle("corner-radius").value==="auto"?"auto":n.pstyle("corner-radius").pfValue,k=r.pstyle("target-endpoint"),E=x?"outside-to-node":k.value,M=i.pstyle("corner-radius").value==="auto"?"auto":i.pstyle("corner-radius").pfValue;p.srcManEndpt=A,p.tgtManEndpt=k;var O,R,L,I;if(y){var N=[p.ctrlpts[0],p.ctrlpts[1]],q=b?[p.ctrlpts[p.ctrlpts.length-2],p.ctrlpts[p.ctrlpts.length-1]]:N;O=q,R=N}else if(w){var z=S?p.segpts.slice(0,2):[s.x,s.y],F=S?p.segpts.slice(p.segpts.length-2):[a.x,a.y];O=F,R=z}if(E==="inside-to-node")t=[s.x,s.y];else if(k.units)t=this.manualEndptToPx(i,k);else if(E==="outside-to-line")t=p.tgtIntn;else if(E==="outside-to-node"||E==="outside-to-node-or-label"?L=O:(E==="outside-to-line"||E==="outside-to-line-or-label")&&(L=[a.x,a.y]),t=e.nodeShapes[this.getNodeShape(i)].intersectLine(s.x,s.y,i.outerWidth(),i.outerHeight(),L[0],L[1],0,M,c),E==="outside-to-node-or-label"||E==="outside-to-line-or-label"){var _=i._private.rscratch,U=_.labelWidth,X=_.labelHeight,$=_.labelX,Q=_.labelY,ee=U/2,oe=X/2,te=i.pstyle("text-valign").value;te==="top"?Q-=oe:te==="bottom"&&(Q+=oe);var V=i.pstyle("text-halign").value;V==="left"?$-=ee:V==="right"&&($+=ee);var W=jl(L[0],L[1],[$-ee,Q-oe,$+ee,Q-oe,$+ee,Q+oe,$-ee,Q+oe],s.x,s.y);if(W.length>0){var K=a,ie=La(K,Hs(t)),ue=La(K,Hs(W)),Me=ie;if(ue<ie&&(t=W,Me=ue),W.length>2){var bt=La(K,{x:W[2],y:W[3]});bt<Me&&(t=[W[2],W[3]])}}}var at=Uf(t,O,e.arrowShapes[o].spacing(r)+u),ce=Uf(t,O,e.arrowShapes[o].gap(r)+u);if(p.endX=ce[0],p.endY=ce[1],p.arrowEndX=at[0],p.arrowEndY=at[1],T==="inside-to-node")t=[a.x,a.y];else if(A.units)t=this.manualEndptToPx(n,A);else if(T==="outside-to-line")t=p.srcIntn;else if(T==="outside-to-node"||T==="outside-to-node-or-label"?I=R:(T==="outside-to-line"||T==="outside-to-line-or-label")&&(I=[s.x,s.y]),t=e.nodeShapes[this.getNodeShape(n)].intersectLine(a.x,a.y,n.outerWidth(),n.outerHeight(),I[0],I[1],0,D,f),T==="outside-to-node-or-label"||T==="outside-to-line-or-label"){var de=n._private.rscratch,xe=de.labelWidth,ke=de.labelHeight,Se=de.labelX,Te=de.labelY,Pe=xe/2,Ke=ke/2,ut=n.pstyle("text-valign").value;ut==="top"?Te-=Ke:ut==="bottom"&&(Te+=Ke);var Et=n.pstyle("text-halign").value;Et==="left"?Se-=Pe:Et==="right"&&(Se+=Pe);var Ze=jl(I[0],I[1],[Se-Pe,Te-Ke,Se+Pe,Te-Ke,Se+Pe,Te+Ke,Se-Pe,Te+Ke],a.x,a.y);if(Ze.length>0){var Bt=s,Ye=La(Bt,Hs(t)),me=La(Bt,Hs(Ze)),J=Ye;if(me<Ye&&(t=[Ze[0],Ze[1]],J=me),Ze.length>2){var P=La(Bt,{x:Ze[2],y:Ze[3]});P<J&&(t=[Ze[2],Ze[3]])}}}var G=Uf(t,R,e.arrowShapes[l].spacing(r)+h),j=Uf(t,R,e.arrowShapes[l].gap(r)+h);p.startX=j[0],p.startY=j[1],p.arrowStartX=G[0],p.arrowStartY=G[1],C&&(!se(p.startX)||!se(p.startY)||!se(p.endX)||!se(p.endY)?p.badLine=!0:p.badLine=!1)};lu.getSourceEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[0],y:e.haystackPts[1]};default:return{x:e.arrowStartX,y:e.arrowStartY}}};lu.getTargetEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[2],y:e.haystackPts[3]};default:return{x:e.arrowEndX,y:e.arrowEndY}}};var E0={};function $9(r,e,t){for(var n=function(u,h,f,c){return jt(u,h,f,c)},i=e._private,a=i.rstyle.bezierPts,s=0;s<r.bezierProjPcts.length;s++){var o=r.bezierProjPcts[s];a.push({x:n(t[0],t[2],t[4],o),y:n(t[1],t[3],t[5],o)})}}E0.storeEdgeProjections=function(r){var e=r._private,t=e.rscratch,n=t.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,n==="multibezier"||n==="bezier"||n==="self"||n==="compound"){e.rstyle.bezierPts=[];for(var i=0;i+5<t.allpts.length;i+=4)$9(this,r,t.allpts.slice(i,i+6))}else if(n==="segments")for(var a=e.rstyle.linePts=[],i=0;i+1<t.allpts.length;i+=2)a.push({x:t.allpts[i],y:t.allpts[i+1]});else if(n==="haystack"){var s=t.haystackPts;e.rstyle.haystackPts=[{x:s[0],y:s[1]},{x:s[2],y:s[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth};E0.recalculateEdgeProjections=function(r){this.findEdgeControlPoints(r)};var zn={};zn.recalculateNodeLabelProjection=function(r){var e=r.pstyle("label").strValue;if(!Fi(e)){var t,n,i=r._private,a=r.width(),s=r.height(),o=r.padding(),l=r.position(),u=r.pstyle("text-halign").strValue,h=r.pstyle("text-valign").strValue,f=i.rscratch,c=i.rstyle;switch(u){case"left":t=l.x-a/2-o;break;case"right":t=l.x+a/2+o;break;default:t=l.x}switch(h){case"top":n=l.y-s/2-o;break;case"bottom":n=l.y+s/2+o;break;default:n=l.y}f.labelX=t,f.labelY=n,c.labelX=t,c.labelY=n,this.calculateLabelAngles(r),this.applyLabelDimensions(r)}};var iM=function(e,t){var n=Math.atan(t/e);return e===0&&n<0&&(n=n*-1),n},aM=function(e,t){var n=t.x-e.x,i=t.y-e.y;return iM(n,i)},Z9=function(e,t,n,i){var a=Kl(0,i-.001,1),s=Kl(0,i+.001,1),o=Us(e,t,n,a),l=Us(e,t,n,s);return aM(o,l)};zn.recalculateEdgeLabelProjections=function(r){var e,t=r._private,n=t.rscratch,i=this,a={mid:r.pstyle("label").strValue,source:r.pstyle("source-label").strValue,target:r.pstyle("target-label").strValue};if(a.mid||a.source||a.target){e={x:n.midX,y:n.midY};var s=function(f,c,d){ni(t.rscratch,f,c,d),ni(t.rstyle,f,c,d)};s("labelX",null,e.x),s("labelY",null,e.y);var o=iM(n.midDispX,n.midDispY);s("labelAutoAngle",null,o);var l=function(){if(l.cache)return l.cache;for(var f=[],c=0;c+5<n.allpts.length;c+=4){var d={x:n.allpts[c],y:n.allpts[c+1]},p={x:n.allpts[c+2],y:n.allpts[c+3]},g={x:n.allpts[c+4],y:n.allpts[c+5]};f.push({p0:d,p1:p,p2:g,startDist:0,length:0,segments:[]})}var v=t.rstyle.bezierPts,m=i.bezierProjPcts.length;function y(x,A,T,D,k){var E=Va(A,T),M=x.segments[x.segments.length-1],O={p0:A,p1:T,t0:D,t1:k,startDist:M?M.startDist+M.length:0,length:E};x.segments.push(O),x.length+=E}for(var b=0;b<f.length;b++){var w=f[b],S=f[b-1];S&&(w.startDist=S.startDist+S.length),y(w,w.p0,v[b*m],0,i.bezierProjPcts[0]);for(var C=0;C<m-1;C++)y(w,v[b*m+C],v[b*m+C+1],i.bezierProjPcts[C],i.bezierProjPcts[C+1]);y(w,v[b*m+m-1],w.p2,i.bezierProjPcts[m-1],1)}return l.cache=f},u=function(f){var c,d=f==="source";if(a[f]){var p=r.pstyle(f+"-text-offset").pfValue;switch(n.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var g=l(),v,m=0,y=0,b=0;b<g.length;b++){for(var w=g[d?b:g.length-1-b],S=0;S<w.segments.length;S++){var C=w.segments[d?S:w.segments.length-1-S],x=b===g.length-1&&S===w.segments.length-1;if(m=y,y+=C.length,y>=p||x){v={cp:w,segment:C};break}}if(v)break}var A=v.cp,T=v.segment,D=(p-m)/T.length,k=T.t1-T.t0,E=d?T.t0+k*D:T.t1-k*D;E=Kl(0,E,1),e=Us(A.p0,A.p1,A.p2,E),c=Z9(A.p0,A.p1,A.p2,E);break}case"straight":case"segments":case"haystack":{for(var M=0,O,R,L,I,N=n.allpts.length,q=0;q+3<N&&(d?(L={x:n.allpts[q],y:n.allpts[q+1]},I={x:n.allpts[q+2],y:n.allpts[q+3]}):(L={x:n.allpts[N-2-q],y:n.allpts[N-1-q]},I={x:n.allpts[N-4-q],y:n.allpts[N-3-q]}),O=Va(L,I),R=M,M+=O,!(M>=p));q+=2);var z=p-R,F=z/O;F=Kl(0,F,1),e=b8(L,I,F),c=aM(L,I);break}}s("labelX",f,e.x),s("labelY",f,e.y),s("labelAutoAngle",f,c)}};u("source"),u("target"),this.applyLabelDimensions(r)}};zn.applyLabelDimensions=function(r){this.applyPrefixedLabelDimensions(r),r.isEdge()&&(this.applyPrefixedLabelDimensions(r,"source"),this.applyPrefixedLabelDimensions(r,"target"))};zn.applyPrefixedLabelDimensions=function(r,e){var t=r._private,n=this.getLabelText(r,e),i=za(n,r._private.labelDimsKey);if(Or(t.rscratch,"prefixedLabelDimsKey",e)!==i){ni(t.rscratch,"prefixedLabelDimsKey",e,i);var a=this.calculateLabelDimensions(r,n),s=r.pstyle("line-height").pfValue,o=r.pstyle("text-wrap").strValue,l=Or(t.rscratch,"labelWrapCachedLines",e)||[],u=o!=="wrap"?1:Math.max(l.length,1),h=a.height/u,f=h*s,c=a.width,d=a.height+(u-1)*(s-1)*h;ni(t.rstyle,"labelWidth",e,c),ni(t.rscratch,"labelWidth",e,c),ni(t.rstyle,"labelHeight",e,d),ni(t.rscratch,"labelHeight",e,d),ni(t.rscratch,"labelLineHeight",e,f)}};zn.getLabelText=function(r,e){var t=r._private,n=e?e+"-":"",i=r.pstyle(n+"label").strValue,a=r.pstyle("text-transform").value,s=function(U,X){return X?(ni(t.rscratch,U,e,X),X):Or(t.rscratch,U,e)};if(!i)return"";a=="none"||(a=="uppercase"?i=i.toUpperCase():a=="lowercase"&&(i=i.toLowerCase()));var o=r.pstyle("text-wrap").value;if(o==="wrap"){var l=s("labelKey");if(l!=null&&s("labelWrapKey")===l)return s("labelWrapCachedText");for(var u="\u200B",h=i.split(`
`),f=r.pstyle("text-max-width").pfValue,c=r.pstyle("text-overflow-wrap").value,d=c==="anywhere",p=[],g=/[\s\u200b]+|$/g,v=0;v<h.length;v++){var m=h[v],y=this.calculateLabelDimensions(r,m),b=y.width;if(d){var w=m.split("").join(u);m=w}if(b>f){var S=m.matchAll(g),C="",x=0,A=Lr(S),T;try{for(A.s();!(T=A.n()).done;){var D=T.value,k=D[0],E=m.substring(x,D.index);x=D.index+k.length;var M=C.length===0?E:C+E+k,O=this.calculateLabelDimensions(r,M),R=O.width;R<=f?C+=E+k:(C&&p.push(C),C=E+k)}}catch(_){A.e(_)}finally{A.f()}C.match(/^[\s\u200b]+$/)||p.push(C)}else p.push(m)}s("labelWrapCachedLines",p),i=s("labelWrapCachedText",p.join(`
`)),s("labelWrapKey",l)}else if(o==="ellipsis"){var L=r.pstyle("text-max-width").pfValue,I="",N="\u2026",q=!1;if(this.calculateLabelDimensions(r,i).width<L)return i;for(var z=0;z<i.length;z++){var F=this.calculateLabelDimensions(r,I+i[z]+N).width;if(F>L)break;I+=i[z],z===i.length-1&&(q=!0)}return q||(I+=N),I}return i};zn.getLabelJustification=function(r){var e=r.pstyle("text-justification").strValue,t=r.pstyle("text-halign").strValue;if(e==="auto")if(r.isNode())switch(t){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return e};zn.calculateLabelDimensions=function(r,e){var t=this,n=t.cy.window(),i=n.document,a=0,s=r.pstyle("font-style").strValue,o=r.pstyle("font-size").pfValue,l=r.pstyle("font-family").strValue,u=r.pstyle("font-weight").strValue,h=this.labelCalcCanvas,f=this.labelCalcCanvasContext;if(!h){h=this.labelCalcCanvas=i.createElement("canvas"),f=this.labelCalcCanvasContext=h.getContext("2d");var c=h.style;c.position="absolute",c.left="-9999px",c.top="-9999px",c.zIndex="-1",c.visibility="hidden",c.pointerEvents="none"}f.font="".concat(s," ").concat(u," ").concat(o,"px ").concat(l);for(var d=0,p=0,g=e.split(`
`),v=0;v<g.length;v++){var m=g[v],y=f.measureText(m),b=Math.ceil(y.width),w=o;d=Math.max(b,d),p+=w}return d+=a,p+=a,{width:d,height:p}};zn.calculateLabelAngle=function(r,e){var t=r._private,n=t.rscratch,i=r.isEdge(),a=e?e+"-":"",s=r.pstyle(a+"text-rotation"),o=s.strValue;return o==="none"?0:i&&o==="autorotate"?n.labelAutoAngle:o==="autorotate"?0:s.pfValue};zn.calculateLabelAngles=function(r){var e=this,t=r.isEdge(),n=r._private,i=n.rscratch;i.labelAngle=e.calculateLabelAngle(r),t&&(i.sourceLabelAngle=e.calculateLabelAngle(r,"source"),i.targetLabelAngle=e.calculateLabelAngle(r,"target"))};var sM={},CA=28,kA=!1;sM.getNodeShape=function(r){var e=this,t=r.pstyle("shape").value;if(t==="cutrectangle"&&(r.width()<CA||r.height()<CA))return kA||(it("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),kA=!0),"rectangle";if(r.isParent())return t==="rectangle"||t==="roundrectangle"||t==="round-rectangle"||t==="cutrectangle"||t==="cut-rectangle"||t==="barrel"?t:"rectangle";if(t==="polygon"){var n=r.pstyle("shape-polygon-points").value;return e.nodeShapes.makePolygon(n).name}return t};var Hc={};Hc.registerCalculationListeners=function(){var r=this.cy,e=r.collection(),t=this,n=function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.merge(s),o)for(var l=0;l<s.length;l++){var u=s[l],h=u._private,f=h.rstyle;f.clean=!1,f.cleanConnected=!1}};t.binder(r).on("bounds.* dirty.*",function(s){var o=s.target;n(o)}).on("style.* background.*",function(s){var o=s.target;n(o,!1)});var i=function(s){if(s){var o=t.onUpdateEleCalcsFns;e.cleanStyle();for(var l=0;l<e.length;l++){var u=e[l],h=u._private.rstyle;u.isNode()&&!h.cleanConnected&&(n(u.connectedEdges()),h.cleanConnected=!0)}if(o)for(var f=0;f<o.length;f++){var c=o[f];c(s,e)}t.recalculateRenderedStyle(e),e=r.collection()}};t.flushRenderedStyleQueue=function(){i(!0)},t.beforeRender(i,t.beforeRenderPriorities.eleCalcs)};Hc.onUpdateEleCalcs=function(r){var e=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];e.push(r)};Hc.recalculateRenderedStyle=function(r,e){var t=function(w){return w._private.rstyle.cleanConnected};if(r.length!==0){var n=[],i=[];if(!this.destroyed){e===void 0&&(e=!0);for(var a=0;a<r.length;a++){var s=r[a],o=s._private,l=o.rstyle;s.isEdge()&&(!t(s.source())||!t(s.target()))&&(l.clean=!1),s.isEdge()&&s.isBundledBezier()&&s.parallelEdges().some(function(b){return!b._private.rstyle.clean&&b.isBundledBezier()})&&(l.clean=!1),!(e&&l.clean||s.removed())&&s.pstyle("display").value!=="none"&&(o.group==="nodes"?i.push(s):n.push(s),l.clean=!0)}for(var u=0;u<i.length;u++){var h=i[u],f=h._private,c=f.rstyle,d=h.position();this.recalculateNodeLabelProjection(h),c.nodeX=d.x,c.nodeY=d.y,c.nodeW=h.pstyle("width").pfValue,c.nodeH=h.pstyle("height").pfValue}this.recalculateEdgeProjections(n);for(var p=0;p<n.length;p++){var g=n[p],v=g._private,m=v.rstyle,y=v.rscratch;m.srcX=y.arrowStartX,m.srcY=y.arrowStartY,m.tgtX=y.arrowEndX,m.tgtY=y.arrowEndY,m.midX=y.midX,m.midY=y.midY,m.labelAngle=y.labelAngle,m.sourceLabelAngle=y.sourceLabelAngle,m.targetLabelAngle=y.targetLabelAngle}}}};var Wc={};Wc.updateCachedGrabbedEles=function(){var r=this.cachedZSortedEles;if(r){r.drag=[],r.nondrag=[];for(var e=[],t=0;t<r.length;t++){var n=r[t],i=n._private.rscratch;n.grabbed()&&!n.isParent()?e.push(n):i.inDragLayer?r.drag.push(n):r.nondrag.push(n)}for(var t=0;t<e.length;t++){var n=e[t];r.drag.push(n)}}};Wc.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};Wc.getCachedZSortedEles=function(r){if(r||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(V2),e.interactive=e.filter(function(t){return t.interactive()}),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e};var oM={};[Ka,Sc,vr,lu,E0,zn,sM,Hc,Wc].forEach(function(r){Ce(oM,r)});var lM={};lM.getCachedImage=function(r,e,t){var n=this,i=n.imageCache=n.imageCache||{},a=i[r];if(a)return a.image.complete||a.image.addEventListener("load",t),a.image;a=i[r]=i[r]||{};var s=a.image=new Image;s.addEventListener("load",t),s.addEventListener("error",function(){s.error=!0});var o="data:",l=r.substring(0,o.length).toLowerCase()===o;return l||(e=e==="null"?null:e,s.crossOrigin=e),s.src=r,s};var no={};no.registerBinding=function(r,e,t,n){var i=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(r)){for(var a=[],s=0;s<r.length;s++){var o=r[s];if(o!==void 0){var l=this.binder(o);a.push(l.on.apply(l,i))}}return a}var l=this.binder(r);return l.on.apply(l,i)};no.binder=function(r){var e=this,t=e.cy.window(),n=r===t||r===t.document||r===t.document.body||cG(r);if(e.supportsPassiveEvents==null){var i=!1;try{var a=Object.defineProperty({},"passive",{get:function(){return i=!0,!0}});t.addEventListener("test",null,a)}catch{}e.supportsPassiveEvents=i}var s=function(l,u,h){var f=Array.prototype.slice.call(arguments);return n&&e.supportsPassiveEvents&&(f[2]={capture:h??!1,passive:!1,once:!1}),e.bindings.push({target:r,args:f}),(r.addEventListener||r.on).apply(r,f),this};return{on:s,addEventListener:s,addListener:s,bind:s}};no.nodeIsDraggable=function(r){return r&&r.isNode()&&!r.locked()&&r.grabbable()};no.nodeIsGrabbable=function(r){return this.nodeIsDraggable(r)&&r.interactive()};no.load=function(){var r=this,e=r.cy.window(),t=function(P){return P.selected()},n=function(P){var G=P.getRootNode();if(G&&G.nodeType===11&&G.host!==void 0)return G},i=function(P,G,j,Y){P==null&&(P=r.cy);for(var Z=0;Z<G.length;Z++){var ve=G[Z];P.emit({originalEvent:j,type:ve,position:Y})}},a=function(P){return P.shiftKey||P.metaKey||P.ctrlKey},s=function(P,G){var j=!0;if(r.cy.hasCompoundNodes()&&P&&P.pannable())for(var Y=0;G&&Y<G.length;Y++){var P=G[Y];if(P.isNode()&&P.isParent()&&!P.pannable()){j=!1;break}}else j=!0;return j},o=function(P){P[0]._private.grabbed=!0},l=function(P){P[0]._private.grabbed=!1},u=function(P){P[0]._private.rscratch.inDragLayer=!0},h=function(P){P[0]._private.rscratch.inDragLayer=!1},f=function(P){P[0]._private.rscratch.isGrabTarget=!0},c=function(P){P[0]._private.rscratch.isGrabTarget=!1},d=function(P,G){var j=G.addToList,Y=j.has(P);!Y&&P.grabbable()&&!P.locked()&&(j.merge(P),o(P))},p=function(P,G){if(P.cy().hasCompoundNodes()&&!(G.inDragLayer==null&&G.addToList==null)){var j=P.descendants();G.inDragLayer&&(j.forEach(u),j.connectedEdges().forEach(u)),G.addToList&&d(j,G)}},g=function(P,G){G=G||{};var j=P.cy().hasCompoundNodes();G.inDragLayer&&(P.forEach(u),P.neighborhood().stdFilter(function(Y){return!j||Y.isEdge()}).forEach(u)),G.addToList&&P.forEach(function(Y){d(Y,G)}),p(P,G),y(P,{inDragLayer:G.inDragLayer}),r.updateCachedGrabbedEles()},v=g,m=function(P){P&&(r.getCachedZSortedEles().forEach(function(G){l(G),h(G),c(G)}),r.updateCachedGrabbedEles())},y=function(P,G){if(!(G.inDragLayer==null&&G.addToList==null)&&P.cy().hasCompoundNodes()){var j=P.ancestors().orphans();if(!j.same(P)){var Y=j.descendants().spawnSelf().merge(j).unmerge(P).unmerge(P.descendants()),Z=Y.connectedEdges();G.inDragLayer&&(Z.forEach(u),Y.forEach(u)),G.addToList&&Y.forEach(function(ve){d(ve,G)})}}},b=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},w=typeof MutationObserver<"u",S=typeof ResizeObserver<"u";w?(r.removeObserver=new MutationObserver(function(J){for(var P=0;P<J.length;P++){var G=J[P],j=G.removedNodes;if(j)for(var Y=0;Y<j.length;Y++){var Z=j[Y];if(Z===r.container){r.destroy();break}}}}),r.container.parentNode&&r.removeObserver.observe(r.container.parentNode,{childList:!0})):r.registerBinding(r.container,"DOMNodeRemoved",function(J){r.destroy()});var C=iu(function(){r.cy.resize()},100);w&&(r.styleObserver=new MutationObserver(C),r.styleObserver.observe(r.container,{attributes:!0})),r.registerBinding(e,"resize",C),S&&(r.resizeObserver=new ResizeObserver(C),r.resizeObserver.observe(r.container));var x=function(P,G){for(;P!=null;)G(P),P=P.parentNode},A=function(){r.invalidateContainerClientCoordsCache()};x(r.container,function(J){r.registerBinding(J,"transitionend",A),r.registerBinding(J,"animationend",A),r.registerBinding(J,"scroll",A)}),r.registerBinding(r.container,"contextmenu",function(J){J.preventDefault()});var T=function(){return r.selection[4]!==0},D=function(P){for(var G=r.findContainerClientCoords(),j=G[0],Y=G[1],Z=G[2],ve=G[3],re=P.touches?P.touches:[P],ye=!1,Le=0;Le<re.length;Le++){var We=re[Le];if(j<=We.clientX&&We.clientX<=j+Z&&Y<=We.clientY&&We.clientY<=Y+ve){ye=!0;break}}if(!ye)return!1;for(var Ee=r.container,Ne=P.target,Ae=Ne.parentNode,Be=!1;Ae;){if(Ae===Ee){Be=!0;break}Ae=Ae.parentNode}return!!Be};r.registerBinding(r.container,"mousedown",function(P){if(D(P)&&!(r.hoverData.which===1&&P.which!==1)){P.preventDefault(),b(),r.hoverData.capture=!0,r.hoverData.which=P.which;var G=r.cy,j=[P.clientX,P.clientY],Y=r.projectIntoViewport(j[0],j[1]),Z=r.selection,ve=r.findNearestElements(Y[0],Y[1],!0,!1),re=ve[0],ye=r.dragData.possibleDragElements;r.hoverData.mdownPos=Y,r.hoverData.mdownGPos=j;var Le=function(){r.hoverData.tapholdCancelled=!1,clearTimeout(r.hoverData.tapholdTimeout),r.hoverData.tapholdTimeout=setTimeout(function(){if(!r.hoverData.tapholdCancelled){var st=r.hoverData.down;st?st.emit({originalEvent:P,type:"taphold",position:{x:Y[0],y:Y[1]}}):G.emit({originalEvent:P,type:"taphold",position:{x:Y[0],y:Y[1]}})}},r.tapholdDuration)};if(P.which==3){r.hoverData.cxtStarted=!0;var We={originalEvent:P,type:"cxttapstart",position:{x:Y[0],y:Y[1]}};re?(re.activate(),re.emit(We),r.hoverData.down=re):G.emit(We),r.hoverData.downTime=new Date().getTime(),r.hoverData.cxtDragged=!1}else if(P.which==1){re&&re.activate();{if(re!=null&&r.nodeIsGrabbable(re)){var Ee=function(st){return{originalEvent:P,type:st,position:{x:Y[0],y:Y[1]}}},Ne=function(st){st.emit(Ee("grab"))};if(f(re),!re.selected())ye=r.dragData.possibleDragElements=G.collection(),v(re,{addToList:ye}),re.emit(Ee("grabon")).emit(Ee("grab"));else{ye=r.dragData.possibleDragElements=G.collection();var Ae=G.$(function(Be){return Be.isNode()&&Be.selected()&&r.nodeIsGrabbable(Be)});g(Ae,{addToList:ye}),re.emit(Ee("grabon")),Ae.forEach(Ne)}r.redrawHint("eles",!0),r.redrawHint("drag",!0)}r.hoverData.down=re,r.hoverData.downs=ve,r.hoverData.downTime=new Date().getTime()}i(re,["mousedown","tapstart","vmousedown"],P,{x:Y[0],y:Y[1]}),re==null?(Z[4]=1,r.data.bgActivePosistion={x:Y[0],y:Y[1]},r.redrawHint("select",!0),r.redraw()):re.pannable()&&(Z[4]=1),Le()}Z[0]=Z[2]=Y[0],Z[1]=Z[3]=Y[1]}},!1);var k=n(r.container);r.registerBinding([e,k],"mousemove",function(P){var G=r.hoverData.capture;if(!(!G&&!D(P))){var j=!1,Y=r.cy,Z=Y.zoom(),ve=[P.clientX,P.clientY],re=r.projectIntoViewport(ve[0],ve[1]),ye=r.hoverData.mdownPos,Le=r.hoverData.mdownGPos,We=r.selection,Ee=null;!r.hoverData.draggingEles&&!r.hoverData.dragging&&!r.hoverData.selecting&&(Ee=r.findNearestElement(re[0],re[1],!0,!1));var Ne=r.hoverData.last,Ae=r.hoverData.down,Be=[re[0]-We[2],re[1]-We[3]],st=r.dragData.possibleDragElements,Ot;if(Le){var Zt=ve[0]-Le[0],Gt=Zt*Zt,At=ve[1]-Le[1],Qt=At*At,qt=Gt+Qt;r.hoverData.isOverThresholdDrag=Ot=qt>=r.desktopTapThreshold2}var Sr=a(P);Ot&&(r.hoverData.tapholdCancelled=!0);var Sn=function(){var Cn=r.hoverData.dragDelta=r.hoverData.dragDelta||[];Cn.length===0?(Cn.push(Be[0]),Cn.push(Be[1])):(Cn[0]+=Be[0],Cn[1]+=Be[1])};j=!0,i(Ee,["mousemove","vmousemove","tapdrag"],P,{x:re[0],y:re[1]});var gi=function(){r.data.bgActivePosistion=void 0,r.hoverData.selecting||Y.emit({originalEvent:P,type:"boxstart",position:{x:re[0],y:re[1]}}),We[4]=1,r.hoverData.selecting=!0,r.redrawHint("select",!0),r.redraw()};if(r.hoverData.which===3){if(Ot){var jn={originalEvent:P,type:"cxtdrag",position:{x:re[0],y:re[1]}};Ae?Ae.emit(jn):Y.emit(jn),r.hoverData.cxtDragged=!0,(!r.hoverData.cxtOver||Ee!==r.hoverData.cxtOver)&&(r.hoverData.cxtOver&&r.hoverData.cxtOver.emit({originalEvent:P,type:"cxtdragout",position:{x:re[0],y:re[1]}}),r.hoverData.cxtOver=Ee,Ee&&Ee.emit({originalEvent:P,type:"cxtdragover",position:{x:re[0],y:re[1]}}))}}else if(r.hoverData.dragging){if(j=!0,Y.panningEnabled()&&Y.userPanningEnabled()){var ns;if(r.hoverData.justStartedPan){var Uu=r.hoverData.mdownPos;ns={x:(re[0]-Uu[0])*Z,y:(re[1]-Uu[1])*Z},r.hoverData.justStartedPan=!1}else ns={x:Be[0]*Z,y:Be[1]*Z};Y.panBy(ns),Y.emit("dragpan"),r.hoverData.dragged=!0}re=r.projectIntoViewport(P.clientX,P.clientY)}else if(We[4]==1&&(Ae==null||Ae.pannable())){if(Ot){if(!r.hoverData.dragging&&Y.boxSelectionEnabled()&&(Sr||!Y.panningEnabled()||!Y.userPanningEnabled()))gi();else if(!r.hoverData.selecting&&Y.panningEnabled()&&Y.userPanningEnabled()){var aa=s(Ae,r.hoverData.downs);aa&&(r.hoverData.dragging=!0,r.hoverData.justStartedPan=!0,We[4]=0,r.data.bgActivePosistion=Hs(ye),r.redrawHint("select",!0),r.redraw())}Ae&&Ae.pannable()&&Ae.active()&&Ae.unactivate()}}else{if(Ae&&Ae.pannable()&&Ae.active()&&Ae.unactivate(),(!Ae||!Ae.grabbed())&&Ee!=Ne&&(Ne&&i(Ne,["mouseout","tapdragout"],P,{x:re[0],y:re[1]}),Ee&&i(Ee,["mouseover","tapdragover"],P,{x:re[0],y:re[1]}),r.hoverData.last=Ee),Ae)if(Ot){if(Y.boxSelectionEnabled()&&Sr)Ae&&Ae.grabbed()&&(m(st),Ae.emit("freeon"),st.emit("free"),r.dragData.didDrag&&(Ae.emit("dragfreeon"),st.emit("dragfree"))),gi();else if(Ae&&Ae.grabbed()&&r.nodeIsDraggable(Ae)){var Cr=!r.dragData.didDrag;Cr&&r.redrawHint("eles",!0),r.dragData.didDrag=!0,r.hoverData.draggingEles||g(st,{inDragLayer:!0});var or={x:0,y:0};if(se(Be[0])&&se(Be[1])&&(or.x+=Be[0],or.y+=Be[1],Cr)){var kr=r.hoverData.dragDelta;kr&&se(kr[0])&&se(kr[1])&&(or.x+=kr[0],or.y+=kr[1])}r.hoverData.draggingEles=!0,st.silentShift(or).emit("position drag"),r.redrawHint("drag",!0),r.redraw()}}else Sn();j=!0}if(We[2]=re[0],We[3]=re[1],j)return P.stopPropagation&&P.stopPropagation(),P.preventDefault&&P.preventDefault(),!1}},!1);var E,M,O;r.registerBinding(e,"mouseup",function(P){if(!(r.hoverData.which===1&&P.which!==1&&r.hoverData.capture)){var G=r.hoverData.capture;if(G){r.hoverData.capture=!1;var j=r.cy,Y=r.projectIntoViewport(P.clientX,P.clientY),Z=r.selection,ve=r.findNearestElement(Y[0],Y[1],!0,!1),re=r.dragData.possibleDragElements,ye=r.hoverData.down,Le=a(P);if(r.data.bgActivePosistion&&(r.redrawHint("select",!0),r.redraw()),r.hoverData.tapholdCancelled=!0,r.data.bgActivePosistion=void 0,ye&&ye.unactivate(),r.hoverData.which===3){var We={originalEvent:P,type:"cxttapend",position:{x:Y[0],y:Y[1]}};if(ye?ye.emit(We):j.emit(We),!r.hoverData.cxtDragged){var Ee={originalEvent:P,type:"cxttap",position:{x:Y[0],y:Y[1]}};ye?ye.emit(Ee):j.emit(Ee)}r.hoverData.cxtDragged=!1,r.hoverData.which=null}else if(r.hoverData.which===1){if(i(ve,["mouseup","tapend","vmouseup"],P,{x:Y[0],y:Y[1]}),!r.dragData.didDrag&&!r.hoverData.dragged&&!r.hoverData.selecting&&!r.hoverData.isOverThresholdDrag&&(i(ye,["click","tap","vclick"],P,{x:Y[0],y:Y[1]}),M=!1,P.timeStamp-O<=j.multiClickDebounceTime()?(E&&clearTimeout(E),M=!0,O=null,i(ye,["dblclick","dbltap","vdblclick"],P,{x:Y[0],y:Y[1]})):(E=setTimeout(function(){M||i(ye,["oneclick","onetap","voneclick"],P,{x:Y[0],y:Y[1]})},j.multiClickDebounceTime()),O=P.timeStamp)),ye==null&&!r.dragData.didDrag&&!r.hoverData.selecting&&!r.hoverData.dragged&&!a(P)&&(j.$(t).unselect(["tapunselect"]),re.length>0&&r.redrawHint("eles",!0),r.dragData.possibleDragElements=re=j.collection()),ve==ye&&!r.dragData.didDrag&&!r.hoverData.selecting&&ve!=null&&ve._private.selectable&&(r.hoverData.dragging||(j.selectionType()==="additive"||Le?ve.selected()?ve.unselect(["tapunselect"]):ve.select(["tapselect"]):Le||(j.$(t).unmerge(ve).unselect(["tapunselect"]),ve.select(["tapselect"]))),r.redrawHint("eles",!0)),r.hoverData.selecting){var Ne=j.collection(r.getAllInBox(Z[0],Z[1],Z[2],Z[3]));r.redrawHint("select",!0),Ne.length>0&&r.redrawHint("eles",!0),j.emit({type:"boxend",originalEvent:P,position:{x:Y[0],y:Y[1]}});var Ae=function(Ot){return Ot.selectable()&&!Ot.selected()};j.selectionType()==="additive"||Le||j.$(t).unmerge(Ne).unselect(),Ne.emit("box").stdFilter(Ae).select().emit("boxselect"),r.redraw()}if(r.hoverData.dragging&&(r.hoverData.dragging=!1,r.redrawHint("select",!0),r.redrawHint("eles",!0),r.redraw()),!Z[4]){r.redrawHint("drag",!0),r.redrawHint("eles",!0);var Be=ye&&ye.grabbed();m(re),Be&&(ye.emit("freeon"),re.emit("free"),r.dragData.didDrag&&(ye.emit("dragfreeon"),re.emit("dragfree")))}}Z[4]=0,r.hoverData.down=null,r.hoverData.cxtStarted=!1,r.hoverData.draggingEles=!1,r.hoverData.selecting=!1,r.hoverData.isOverThresholdDrag=!1,r.dragData.didDrag=!1,r.hoverData.dragged=!1,r.hoverData.dragDelta=[],r.hoverData.mdownPos=null,r.hoverData.mdownGPos=null,r.hoverData.which=null}}},!1);var R=[],L=4,I,N=1e5,q=function(P,G){for(var j=0;j<P.length;j++)if(P[j]%G!==0)return!1;return!0},z=function(P){for(var G=Math.abs(P[0]),j=1;j<P.length;j++)if(Math.abs(P[j])!==G)return!1;return!0},F=function(P){var G=!1,j=P.deltaY;if(j==null&&(P.wheelDeltaY!=null?j=P.wheelDeltaY/4:P.wheelDelta!=null&&(j=P.wheelDelta/4)),I==null)if(R.length>=L){var Y=R;if(I=q(Y,5),!I){var Z=Math.abs(Y[0]);I=z(Y)&&Z>5}if(I)for(var ve=0;ve<Y.length;ve++)N=Math.min(Math.abs(Y[ve]),N)}else R.push(j),G=!0;else I&&(N=Math.min(Math.abs(j),N));if(!r.scrollingPage){var re=r.cy,ye=re.zoom(),Le=re.pan(),We=r.projectIntoViewport(P.clientX,P.clientY),Ee=[We[0]*ye+Le.x,We[1]*ye+Le.y];if(r.hoverData.draggingEles||r.hoverData.dragging||r.hoverData.cxtStarted||T()){P.preventDefault();return}if(re.panningEnabled()&&re.userPanningEnabled()&&re.zoomingEnabled()&&re.userZoomingEnabled()){P.preventDefault(),r.data.wheelZooming=!0,clearTimeout(r.data.wheelTimeout),r.data.wheelTimeout=setTimeout(function(){r.data.wheelZooming=!1,r.redrawHint("eles",!0),r.redraw()},150);var Ne;G&&Math.abs(j)>5&&(j=f0(j)*5),Ne=j/-250,I&&(Ne/=N,Ne*=3),Ne=Ne*r.wheelSensitivity;var Ae=P.deltaMode===1;Ae&&(Ne*=33);var Be=re.zoom()*Math.pow(10,Ne);P.type==="gesturechange"&&(Be=r.gestureStartZoom*P.scale),re.zoom({level:Be,renderedPosition:{x:Ee[0],y:Ee[1]}}),re.emit(P.type==="gesturechange"?"pinchzoom":"scrollzoom")}}};r.registerBinding(r.container,"wheel",F,!0),r.registerBinding(e,"scroll",function(P){r.scrollingPage=!0,clearTimeout(r.scrollingPageTimeout),r.scrollingPageTimeout=setTimeout(function(){r.scrollingPage=!1},250)},!0),r.registerBinding(r.container,"gesturestart",function(P){r.gestureStartZoom=r.cy.zoom(),r.hasTouchStarted||P.preventDefault()},!0),r.registerBinding(r.container,"gesturechange",function(J){r.hasTouchStarted||F(J)},!0),r.registerBinding(r.container,"mouseout",function(P){var G=r.projectIntoViewport(P.clientX,P.clientY);r.cy.emit({originalEvent:P,type:"mouseout",position:{x:G[0],y:G[1]}})},!1),r.registerBinding(r.container,"mouseover",function(P){var G=r.projectIntoViewport(P.clientX,P.clientY);r.cy.emit({originalEvent:P,type:"mouseover",position:{x:G[0],y:G[1]}})},!1);var _,U,X,$,Q,ee,oe,te,V,W,K,ie,ue,Me=function(P,G,j,Y){return Math.sqrt((j-P)*(j-P)+(Y-G)*(Y-G))},bt=function(P,G,j,Y){return(j-P)*(j-P)+(Y-G)*(Y-G)},at;r.registerBinding(r.container,"touchstart",at=function(P){if(r.hasTouchStarted=!0,!!D(P)){b(),r.touchData.capture=!0,r.data.bgActivePosistion=void 0;var G=r.cy,j=r.touchData.now,Y=r.touchData.earlier;if(P.touches[0]){var Z=r.projectIntoViewport(P.touches[0].clientX,P.touches[0].clientY);j[0]=Z[0],j[1]=Z[1]}if(P.touches[1]){var Z=r.projectIntoViewport(P.touches[1].clientX,P.touches[1].clientY);j[2]=Z[0],j[3]=Z[1]}if(P.touches[2]){var Z=r.projectIntoViewport(P.touches[2].clientX,P.touches[2].clientY);j[4]=Z[0],j[5]=Z[1]}if(P.touches[1]){r.touchData.singleTouchMoved=!0,m(r.dragData.touchDragEles);var ve=r.findContainerClientCoords();V=ve[0],W=ve[1],K=ve[2],ie=ve[3],_=P.touches[0].clientX-V,U=P.touches[0].clientY-W,X=P.touches[1].clientX-V,$=P.touches[1].clientY-W,ue=0<=_&&_<=K&&0<=X&&X<=K&&0<=U&&U<=ie&&0<=$&&$<=ie;var re=G.pan(),ye=G.zoom();Q=Me(_,U,X,$),ee=bt(_,U,X,$),oe=[(_+X)/2,(U+$)/2],te=[(oe[0]-re.x)/ye,(oe[1]-re.y)/ye];var Le=200,We=Le*Le;if(ee<We&&!P.touches[2]){var Ee=r.findNearestElement(j[0],j[1],!0,!0),Ne=r.findNearestElement(j[2],j[3],!0,!0);Ee&&Ee.isNode()?(Ee.activate().emit({originalEvent:P,type:"cxttapstart",position:{x:j[0],y:j[1]}}),r.touchData.start=Ee):Ne&&Ne.isNode()?(Ne.activate().emit({originalEvent:P,type:"cxttapstart",position:{x:j[0],y:j[1]}}),r.touchData.start=Ne):G.emit({originalEvent:P,type:"cxttapstart",position:{x:j[0],y:j[1]}}),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!0,r.touchData.cxtDragged=!1,r.data.bgActivePosistion=void 0,r.redraw();return}}if(P.touches[2])G.boxSelectionEnabled()&&P.preventDefault();else if(!P.touches[1]){if(P.touches[0]){var Ae=r.findNearestElements(j[0],j[1],!0,!0),Be=Ae[0];if(Be!=null&&(Be.activate(),r.touchData.start=Be,r.touchData.starts=Ae,r.nodeIsGrabbable(Be))){var st=r.dragData.touchDragEles=G.collection(),Ot=null;r.redrawHint("eles",!0),r.redrawHint("drag",!0),Be.selected()?(Ot=G.$(function(qt){return qt.selected()&&r.nodeIsGrabbable(qt)}),g(Ot,{addToList:st})):v(Be,{addToList:st}),f(Be);var Zt=function(Sr){return{originalEvent:P,type:Sr,position:{x:j[0],y:j[1]}}};Be.emit(Zt("grabon")),Ot?Ot.forEach(function(qt){qt.emit(Zt("grab"))}):Be.emit(Zt("grab"))}i(Be,["touchstart","tapstart","vmousedown"],P,{x:j[0],y:j[1]}),Be==null&&(r.data.bgActivePosistion={x:Z[0],y:Z[1]},r.redrawHint("select",!0),r.redraw()),r.touchData.singleTouchMoved=!1,r.touchData.singleTouchStartTime=+new Date,clearTimeout(r.touchData.tapholdTimeout),r.touchData.tapholdTimeout=setTimeout(function(){r.touchData.singleTouchMoved===!1&&!r.pinching&&!r.touchData.selecting&&i(r.touchData.start,["taphold"],P,{x:j[0],y:j[1]})},r.tapholdDuration)}}if(P.touches.length>=1){for(var Gt=r.touchData.startPosition=[null,null,null,null,null,null],At=0;At<j.length;At++)Gt[At]=Y[At]=j[At];var Qt=P.touches[0];r.touchData.startGPosition=[Qt.clientX,Qt.clientY]}}},!1);var ce;r.registerBinding(e,"touchmove",ce=function(P){var G=r.touchData.capture;if(!(!G&&!D(P))){var j=r.selection,Y=r.cy,Z=r.touchData.now,ve=r.touchData.earlier,re=Y.zoom();if(P.touches[0]){var ye=r.projectIntoViewport(P.touches[0].clientX,P.touches[0].clientY);Z[0]=ye[0],Z[1]=ye[1]}if(P.touches[1]){var ye=r.projectIntoViewport(P.touches[1].clientX,P.touches[1].clientY);Z[2]=ye[0],Z[3]=ye[1]}if(P.touches[2]){var ye=r.projectIntoViewport(P.touches[2].clientX,P.touches[2].clientY);Z[4]=ye[0],Z[5]=ye[1]}var Le=r.touchData.startGPosition,We;if(G&&P.touches[0]&&Le){for(var Ee=[],Ne=0;Ne<Z.length;Ne++)Ee[Ne]=Z[Ne]-ve[Ne];var Ae=P.touches[0].clientX-Le[0],Be=Ae*Ae,st=P.touches[0].clientY-Le[1],Ot=st*st,Zt=Be+Ot;We=Zt>=r.touchTapThreshold2}if(G&&r.touchData.cxt){P.preventDefault();var Gt=P.touches[0].clientX-V,At=P.touches[0].clientY-W,Qt=P.touches[1].clientX-V,qt=P.touches[1].clientY-W,Sr=bt(Gt,At,Qt,qt),Sn=Sr/ee,gi=150,jn=gi*gi,ns=1.5,Uu=ns*ns;if(Sn>=Uu||Sr>=jn){r.touchData.cxt=!1,r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var aa={originalEvent:P,type:"cxttapend",position:{x:Z[0],y:Z[1]}};r.touchData.start?(r.touchData.start.unactivate().emit(aa),r.touchData.start=null):Y.emit(aa)}}if(G&&r.touchData.cxt){var aa={originalEvent:P,type:"cxtdrag",position:{x:Z[0],y:Z[1]}};r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.touchData.start?r.touchData.start.emit(aa):Y.emit(aa),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxtDragged=!0;var Cr=r.findNearestElement(Z[0],Z[1],!0,!0);(!r.touchData.cxtOver||Cr!==r.touchData.cxtOver)&&(r.touchData.cxtOver&&r.touchData.cxtOver.emit({originalEvent:P,type:"cxtdragout",position:{x:Z[0],y:Z[1]}}),r.touchData.cxtOver=Cr,Cr&&Cr.emit({originalEvent:P,type:"cxtdragover",position:{x:Z[0],y:Z[1]}}))}else if(G&&P.touches[2]&&Y.boxSelectionEnabled())P.preventDefault(),r.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,r.touchData.selecting||Y.emit({originalEvent:P,type:"boxstart",position:{x:Z[0],y:Z[1]}}),r.touchData.selecting=!0,r.touchData.didSelect=!0,j[4]=1,!j||j.length===0||j[0]===void 0?(j[0]=(Z[0]+Z[2]+Z[4])/3,j[1]=(Z[1]+Z[3]+Z[5])/3,j[2]=(Z[0]+Z[2]+Z[4])/3+1,j[3]=(Z[1]+Z[3]+Z[5])/3+1):(j[2]=(Z[0]+Z[2]+Z[4])/3,j[3]=(Z[1]+Z[3]+Z[5])/3),r.redrawHint("select",!0),r.redraw();else if(G&&P.touches[1]&&!r.touchData.didSelect&&Y.zoomingEnabled()&&Y.panningEnabled()&&Y.userZoomingEnabled()&&Y.userPanningEnabled()){P.preventDefault(),r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var or=r.dragData.touchDragEles;if(or){r.redrawHint("drag",!0);for(var kr=0;kr<or.length;kr++){var Ku=or[kr]._private;Ku.grabbed=!1,Ku.rscratch.inDragLayer=!1}}var Cn=r.touchData.start,Gt=P.touches[0].clientX-V,At=P.touches[0].clientY-W,Qt=P.touches[1].clientX-V,qt=P.touches[1].clientY-W,ww=Me(Gt,At,Qt,qt),ez=ww/Q;if(ue){var tz=Gt-_,rz=At-U,nz=Qt-X,iz=qt-$,az=(tz+nz)/2,sz=(rz+iz)/2,xo=Y.zoom(),Rd=xo*ez,ju=Y.pan(),xw=te[0]*xo+ju.x,Sw=te[1]*xo+ju.y,oz={x:-Rd/xo*(xw-ju.x-az)+xw,y:-Rd/xo*(Sw-ju.y-sz)+Sw};if(Cn&&Cn.active()){var or=r.dragData.touchDragEles;m(or),r.redrawHint("drag",!0),r.redrawHint("eles",!0),Cn.unactivate().emit("freeon"),or.emit("free"),r.dragData.didDrag&&(Cn.emit("dragfreeon"),or.emit("dragfree"))}Y.viewport({zoom:Rd,pan:oz,cancelOnFailedZoom:!0}),Y.emit("pinchzoom"),Q=ww,_=Gt,U=At,X=Qt,$=qt,r.pinching=!0}if(P.touches[0]){var ye=r.projectIntoViewport(P.touches[0].clientX,P.touches[0].clientY);Z[0]=ye[0],Z[1]=ye[1]}if(P.touches[1]){var ye=r.projectIntoViewport(P.touches[1].clientX,P.touches[1].clientY);Z[2]=ye[0],Z[3]=ye[1]}if(P.touches[2]){var ye=r.projectIntoViewport(P.touches[2].clientX,P.touches[2].clientY);Z[4]=ye[0],Z[5]=ye[1]}}else if(P.touches[0]&&!r.touchData.didSelect){var ln=r.touchData.start,Ld=r.touchData.last,Cr;if(!r.hoverData.draggingEles&&!r.swipePanning&&(Cr=r.findNearestElement(Z[0],Z[1],!0,!0)),G&&ln!=null&&P.preventDefault(),G&&ln!=null&&r.nodeIsDraggable(ln))if(We){var or=r.dragData.touchDragEles,Cw=!r.dragData.didDrag;Cw&&g(or,{inDragLayer:!0}),r.dragData.didDrag=!0;var So={x:0,y:0};if(se(Ee[0])&&se(Ee[1])&&(So.x+=Ee[0],So.y+=Ee[1],Cw)){r.redrawHint("eles",!0);var un=r.touchData.dragDelta;un&&se(un[0])&&se(un[1])&&(So.x+=un[0],So.y+=un[1])}r.hoverData.draggingEles=!0,or.silentShift(So).emit("position drag"),r.redrawHint("drag",!0),r.touchData.startPosition[0]==ve[0]&&r.touchData.startPosition[1]==ve[1]&&r.redrawHint("eles",!0),r.redraw()}else{var un=r.touchData.dragDelta=r.touchData.dragDelta||[];un.length===0?(un.push(Ee[0]),un.push(Ee[1])):(un[0]+=Ee[0],un[1]+=Ee[1])}if(i(ln||Cr,["touchmove","tapdrag","vmousemove"],P,{x:Z[0],y:Z[1]}),(!ln||!ln.grabbed())&&Cr!=Ld&&(Ld&&Ld.emit({originalEvent:P,type:"tapdragout",position:{x:Z[0],y:Z[1]}}),Cr&&Cr.emit({originalEvent:P,type:"tapdragover",position:{x:Z[0],y:Z[1]}})),r.touchData.last=Cr,G)for(var kr=0;kr<Z.length;kr++)Z[kr]&&r.touchData.startPosition[kr]&&We&&(r.touchData.singleTouchMoved=!0);if(G&&(ln==null||ln.pannable())&&Y.panningEnabled()&&Y.userPanningEnabled()){var lz=s(ln,r.touchData.starts);lz&&(P.preventDefault(),r.data.bgActivePosistion||(r.data.bgActivePosistion=Hs(r.touchData.startPosition)),r.swipePanning?(Y.panBy({x:Ee[0]*re,y:Ee[1]*re}),Y.emit("dragpan")):We&&(r.swipePanning=!0,Y.panBy({x:Ae*re,y:st*re}),Y.emit("dragpan"),ln&&(ln.unactivate(),r.redrawHint("select",!0),r.touchData.start=null)));var ye=r.projectIntoViewport(P.touches[0].clientX,P.touches[0].clientY);Z[0]=ye[0],Z[1]=ye[1]}}for(var Ne=0;Ne<Z.length;Ne++)ve[Ne]=Z[Ne];G&&P.touches.length>0&&!r.hoverData.draggingEles&&!r.swipePanning&&r.data.bgActivePosistion!=null&&(r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.redraw())}},!1);var de;r.registerBinding(e,"touchcancel",de=function(P){var G=r.touchData.start;r.touchData.capture=!1,G&&G.unactivate()});var xe,ke,Se,Te;if(r.registerBinding(e,"touchend",xe=function(P){var G=r.touchData.start,j=r.touchData.capture;if(j)P.touches.length===0&&(r.touchData.capture=!1),P.preventDefault();else return;var Y=r.selection;r.swipePanning=!1,r.hoverData.draggingEles=!1;var Z=r.cy,ve=Z.zoom(),re=r.touchData.now,ye=r.touchData.earlier;if(P.touches[0]){var Le=r.projectIntoViewport(P.touches[0].clientX,P.touches[0].clientY);re[0]=Le[0],re[1]=Le[1]}if(P.touches[1]){var Le=r.projectIntoViewport(P.touches[1].clientX,P.touches[1].clientY);re[2]=Le[0],re[3]=Le[1]}if(P.touches[2]){var Le=r.projectIntoViewport(P.touches[2].clientX,P.touches[2].clientY);re[4]=Le[0],re[5]=Le[1]}G&&G.unactivate();var We;if(r.touchData.cxt){if(We={originalEvent:P,type:"cxttapend",position:{x:re[0],y:re[1]}},G?G.emit(We):Z.emit(We),!r.touchData.cxtDragged){var Ee={originalEvent:P,type:"cxttap",position:{x:re[0],y:re[1]}};G?G.emit(Ee):Z.emit(Ee)}r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!1,r.touchData.start=null,r.redraw();return}if(!P.touches[2]&&Z.boxSelectionEnabled()&&r.touchData.selecting){r.touchData.selecting=!1;var Ne=Z.collection(r.getAllInBox(Y[0],Y[1],Y[2],Y[3]));Y[0]=void 0,Y[1]=void 0,Y[2]=void 0,Y[3]=void 0,Y[4]=0,r.redrawHint("select",!0),Z.emit({type:"boxend",originalEvent:P,position:{x:re[0],y:re[1]}});var Ae=function(jn){return jn.selectable()&&!jn.selected()};Ne.emit("box").stdFilter(Ae).select().emit("boxselect"),Ne.nonempty()&&r.redrawHint("eles",!0),r.redraw()}if(G?.unactivate(),P.touches[2])r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);else if(!P.touches[1]){if(!P.touches[0]){if(!P.touches[0]){r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var Be=r.dragData.touchDragEles;if(G!=null){var st=G._private.grabbed;m(Be),r.redrawHint("drag",!0),r.redrawHint("eles",!0),st&&(G.emit("freeon"),Be.emit("free"),r.dragData.didDrag&&(G.emit("dragfreeon"),Be.emit("dragfree"))),i(G,["touchend","tapend","vmouseup","tapdragout"],P,{x:re[0],y:re[1]}),G.unactivate(),r.touchData.start=null}else{var Ot=r.findNearestElement(re[0],re[1],!0,!0);i(Ot,["touchend","tapend","vmouseup","tapdragout"],P,{x:re[0],y:re[1]})}var Zt=r.touchData.startPosition[0]-re[0],Gt=Zt*Zt,At=r.touchData.startPosition[1]-re[1],Qt=At*At,qt=Gt+Qt,Sr=qt*ve*ve;r.touchData.singleTouchMoved||(G||Z.$(":selected").unselect(["tapunselect"]),i(G,["tap","vclick"],P,{x:re[0],y:re[1]}),ke=!1,P.timeStamp-Te<=Z.multiClickDebounceTime()?(Se&&clearTimeout(Se),ke=!0,Te=null,i(G,["dbltap","vdblclick"],P,{x:re[0],y:re[1]})):(Se=setTimeout(function(){ke||i(G,["onetap","voneclick"],P,{x:re[0],y:re[1]})},Z.multiClickDebounceTime()),Te=P.timeStamp)),G!=null&&!r.dragData.didDrag&&G._private.selectable&&Sr<r.touchTapThreshold2&&!r.pinching&&(Z.selectionType()==="single"?(Z.$(t).unmerge(G).unselect(["tapunselect"]),G.select(["tapselect"])):G.selected()?G.unselect(["tapunselect"]):G.select(["tapselect"]),r.redrawHint("eles",!0)),r.touchData.singleTouchMoved=!0}}}for(var Sn=0;Sn<re.length;Sn++)ye[Sn]=re[Sn];r.dragData.didDrag=!1,P.touches.length===0&&(r.touchData.dragDelta=[],r.touchData.startPosition=[null,null,null,null,null,null],r.touchData.startGPosition=null,r.touchData.didSelect=!1),P.touches.length<2&&(P.touches.length===1&&(r.touchData.startGPosition=[P.touches[0].clientX,P.touches[0].clientY]),r.pinching=!1,r.redrawHint("eles",!0),r.redraw())},!1),typeof TouchEvent>"u"){var Pe=[],Ke=function(P){return{clientX:P.clientX,clientY:P.clientY,force:1,identifier:P.pointerId,pageX:P.pageX,pageY:P.pageY,radiusX:P.width/2,radiusY:P.height/2,screenX:P.screenX,screenY:P.screenY,target:P.target}},ut=function(P){return{event:P,touch:Ke(P)}},Et=function(P){Pe.push(ut(P))},Ze=function(P){for(var G=0;G<Pe.length;G++){var j=Pe[G];if(j.event.pointerId===P.pointerId){Pe.splice(G,1);return}}},Bt=function(P){var G=Pe.filter(function(j){return j.event.pointerId===P.pointerId})[0];G.event=P,G.touch=Ke(P)},Ye=function(P){P.touches=Pe.map(function(G){return G.touch})},me=function(P){return P.pointerType==="mouse"||P.pointerType===4};r.registerBinding(r.container,"pointerdown",function(J){me(J)||(J.preventDefault(),Et(J),Ye(J),at(J))}),r.registerBinding(r.container,"pointerup",function(J){me(J)||(Ze(J),Ye(J),xe(J))}),r.registerBinding(r.container,"pointercancel",function(J){me(J)||(Ze(J),Ye(J),de(J))}),r.registerBinding(r.container,"pointermove",function(J){me(J)||(J.preventDefault(),Bt(J),Ye(J),ce(J))})}};var oi={};oi.generatePolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,draw:function(n,i,a,s,o,l){this.renderer.nodeShapeImpl("polygon",n,i,a,s,o,this.points)},intersectLine:function(n,i,a,s,o,l,u,h){return jl(o,l,this.points,n,i,a/2,s/2,u)},checkPoint:function(n,i,a,s,o,l,u,h){return si(n,i,this.points,l,u,s,o,[0,-1],a)}}};oi.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,t,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a)},intersectLine:function(e,t,n,i,a,s,o,l){return R8(a,s,e,t,n/2+o,i/2+o)},checkPoint:function(e,t,n,i,a,s,o,l){return _a(e,t,i,a,s,o,n)}}};oi.generateRoundPolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,getOrCreateCorners:function(n,i,a,s,o,l,u){if(l[u]!==void 0&&l[u+"-cx"]===n&&l[u+"-cy"]===i)return l[u];l[u]=new Array(e.length/2),l[u+"-cx"]=n,l[u+"-cy"]=i;var h=a/2,f=s/2;o=o==="auto"?h2(a,s):o;for(var c=new Array(e.length/2),d=0;d<e.length/2;d++)c[d]={x:n+h*e[d*2],y:i+f*e[d*2+1]};var p,g,v,m,y=c.length;for(g=c[y-1],p=0;p<y;p++)v=c[p%y],m=c[(p+1)%y],l[u][p]=k0(g,v,m,o),g=v,v=m;return l[u]},draw:function(n,i,a,s,o,l,u){this.renderer.nodeShapeImpl("round-polygon",n,i,a,s,o,this.points,this.getOrCreateCorners(i,a,s,o,l,u,"drawCorners"))},intersectLine:function(n,i,a,s,o,l,u,h,f){return L8(o,l,this.points,n,i,a,s,u,this.getOrCreateCorners(n,i,a,s,h,f,"corners"))},checkPoint:function(n,i,a,s,o,l,u,h,f){return O8(n,i,this.points,l,u,s,o,this.getOrCreateCorners(l,u,s,o,h,f,"corners"))}}};oi.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:br(4,0),draw:function(e,t,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a,this.points,s)},intersectLine:function(e,t,n,i,a,s,o,l){return l2(a,s,e,t,n,i,o,l)},checkPoint:function(e,t,n,i,a,s,o,l){var u=i/2,h=a/2;l=l==="auto"?zi(i,a):l,l=Math.min(u,h,l);var f=l*2;return!!(si(e,t,this.points,s,o,i,a-f,[0,-1],n)||si(e,t,this.points,s,o,i-f,a,[0,-1],n)||_a(e,t,f,f,s-u+l,o-h+l,n)||_a(e,t,f,f,s+u-l,o-h+l,n)||_a(e,t,f,f,s+u-l,o+h-l,n)||_a(e,t,f,f,s-u+l,o+h-l,n))}}};oi.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:d0(),points:br(4,0),draw:function(e,t,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a,null,s)},generateCutTrianglePts:function(e,t,n,i,a){var s=a==="auto"?this.cornerLength:a,o=t/2,l=e/2,u=n-l,h=n+l,f=i-o,c=i+o;return{topLeft:[u,f+s,u+s,f,u+s,f+s],topRight:[h-s,f,h,f+s,h-s,f+s],bottomRight:[h,c-s,h-s,c,h-s,c-s],bottomLeft:[u+s,c,u,c-s,u+s,c-s]}},intersectLine:function(e,t,n,i,a,s,o,l){var u=this.generateCutTrianglePts(n+2*o,i+2*o,e,t,l),h=[].concat.apply([],[u.topLeft.splice(0,4),u.topRight.splice(0,4),u.bottomRight.splice(0,4),u.bottomLeft.splice(0,4)]);return jl(a,s,h,e,t)},checkPoint:function(e,t,n,i,a,s,o,l){var u=l==="auto"?this.cornerLength:l;if(si(e,t,this.points,s,o,i,a-2*u,[0,-1],n)||si(e,t,this.points,s,o,i-2*u,a,[0,-1],n))return!0;var h=this.generateCutTrianglePts(i,a,s,o);return Rr(e,t,h.topLeft)||Rr(e,t,h.topRight)||Rr(e,t,h.bottomRight)||Rr(e,t,h.bottomLeft)}}};oi.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:br(4,0),draw:function(e,t,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a)},intersectLine:function(e,t,n,i,a,s,o,l){var u=.15,h=.5,f=.85,c=this.generateBarrelBezierPts(n+2*o,i+2*o,e,t),d=function(v){var m=Us({x:v[0],y:v[1]},{x:v[2],y:v[3]},{x:v[4],y:v[5]},u),y=Us({x:v[0],y:v[1]},{x:v[2],y:v[3]},{x:v[4],y:v[5]},h),b=Us({x:v[0],y:v[1]},{x:v[2],y:v[3]},{x:v[4],y:v[5]},f);return[v[0],v[1],m.x,m.y,y.x,y.y,b.x,b.y,v[4],v[5]]},p=[].concat(d(c.topLeft),d(c.topRight),d(c.bottomRight),d(c.bottomLeft));return jl(a,s,p,e,t)},generateBarrelBezierPts:function(e,t,n,i){var a=t/2,s=e/2,o=n-s,l=n+s,u=i-a,h=i+a,f=_y(e,t),c=f.heightOffset,d=f.widthOffset,p=f.ctrlPtOffsetPct*e,g={topLeft:[o,u+c,o+p,u,o+d,u],topRight:[l-d,u,l-p,u,l,u+c],bottomRight:[l,h-c,l-p,h,l-d,h],bottomLeft:[o+d,h,o+p,h,o,h-c]};return g.topLeft.isTop=!0,g.topRight.isTop=!0,g.bottomLeft.isBottom=!0,g.bottomRight.isBottom=!0,g},checkPoint:function(e,t,n,i,a,s,o,l){var u=_y(i,a),h=u.heightOffset,f=u.widthOffset;if(si(e,t,this.points,s,o,i,a-2*h,[0,-1],n)||si(e,t,this.points,s,o,i-2*f,a,[0,-1],n))return!0;for(var c=this.generateBarrelBezierPts(i,a,s,o),d=function(A,T,D){var k=D[4],E=D[2],M=D[0],O=D[5],R=D[1],L=Math.min(k,M),I=Math.max(k,M),N=Math.min(O,R),q=Math.max(O,R);if(L<=A&&A<=I&&N<=T&&T<=q){var z=I8(k,E,M),F=M8(z[0],z[1],z[2],A),_=F.filter(function(U){return 0<=U&&U<=1});if(_.length>0)return _[0]}return null},p=Object.keys(c),g=0;g<p.length;g++){var v=p[g],m=c[v],y=d(e,t,m);if(y!=null){var b=m[5],w=m[3],S=m[1],C=jt(b,w,S,y);if(m.isTop&&C<=t||m.isBottom&&t<=C)return!0}}return!1}}};oi.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:br(4,0),draw:function(e,t,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,t,n,i,a,this.points,s)},intersectLine:function(e,t,n,i,a,s,o,l){var u=e-(n/2+o),h=t-(i/2+o),f=h,c=e+(n/2+o),d=Ii(a,s,e,t,u,h,c,f,!1);return d.length>0?d:l2(a,s,e,t,n,i,o,l)},checkPoint:function(e,t,n,i,a,s,o,l){l=l==="auto"?zi(i,a):l;var u=2*l;if(si(e,t,this.points,s,o,i,a-u,[0,-1],n)||si(e,t,this.points,s,o,i-u,a,[0,-1],n))return!0;var h=i/2+2*n,f=a/2+2*n,c=[s-h,o-f,s-h,o,s+h,o,s+h,o-f];return!!(Rr(e,t,c)||_a(e,t,u,u,s+i/2-l,o+a/2-l,n)||_a(e,t,u,u,s-i/2+l,o+a/2-l,n))}}};oi.registerNodeShapes=function(){var r=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",br(3,0)),this.generateRoundPolygon("round-triangle",br(3,0)),this.generatePolygon("rectangle",br(4,0)),r.square=r.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var t=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",t),this.generateRoundPolygon("round-diamond",t)}this.generatePolygon("pentagon",br(5,0)),this.generateRoundPolygon("round-pentagon",br(5,0)),this.generatePolygon("hexagon",br(6,0)),this.generateRoundPolygon("round-hexagon",br(6,0)),this.generatePolygon("heptagon",br(7,0)),this.generateRoundPolygon("round-heptagon",br(7,0)),this.generatePolygon("octagon",br(8,0)),this.generateRoundPolygon("round-octagon",br(8,0));var n=new Array(20);{var i=Fy(5,0),a=Fy(5,Math.PI/5),s=.5*(3-Math.sqrt(5));s*=1.57;for(var o=0;o<a.length/2;o++)a[o*2]*=s,a[o*2+1]*=s;for(var o=0;o<20/4;o++)n[o*4]=i[o*2],n[o*4+1]=i[o*2+1],n[o*4+2]=a[o*2],n[o*4+3]=a[o*2+1]}n=u2(n),this.generatePolygon("star",n),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var l=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",l),this.generateRoundPolygon("round-tag",l)}r.makePolygon=function(u){var h=u.join("$"),f="polygon-"+h,c;return(c=this[f])?c:e.generatePolygon(f,u)}};var uu={};uu.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};uu.redraw=function(r){r=r||a2();var e=this;e.averageRedrawTime===void 0&&(e.averageRedrawTime=0),e.lastRedrawTime===void 0&&(e.lastRedrawTime=0),e.lastDrawTime===void 0&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=r};uu.beforeRender=function(r,e){if(!this.destroyed){e==null&&Ct("Priority is not optional for beforeRender");var t=this.beforeRenderCallbacks;t.push({fn:r,priority:e}),t.sort(function(n,i){return i.priority-n.priority})}};var EA=function(e,t,n){for(var i=e.beforeRenderCallbacks,a=0;a<i.length;a++)i[a].fn(t,n)};uu.startRenderLoop=function(){var r=this,e=r.cy;if(!r.renderLoopStarted){r.renderLoopStarted=!0;var t=function(i){if(!r.destroyed){if(!e.batching())if(r.requestedFrame&&!r.skipFrame){EA(r,!0,i);var a=ai();r.render(r.renderOptions);var s=r.lastDrawTime=ai();r.averageRedrawTime===void 0&&(r.averageRedrawTime=s-a),r.redrawCount===void 0&&(r.redrawCount=0),r.redrawCount++,r.redrawTotalTime===void 0&&(r.redrawTotalTime=0);var o=s-a;r.redrawTotalTime+=o,r.lastRedrawTime=o,r.averageRedrawTime=r.averageRedrawTime/2+o/2,r.requestedFrame=!1}else EA(r,!1,i);r.skipFrame=!1,pc(t)}};pc(t)}};var Q9=function(e){this.init(e)},uM=Q9,io=uM.prototype;io.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];io.init=function(r){var e=this;e.options=r,e.cy=r.cy;var t=e.container=r.cy.container(),n=e.cy.window();if(n){var i=n.document,a=i.head,s="__________cytoscape_stylesheet",o="__________cytoscape_container",l=i.getElementById(s)!=null;if(t.className.indexOf(o)<0&&(t.className=(t.className||"")+" "+o),!l){var u=i.createElement("style");u.id=s,u.textContent="."+o+" { position: relative; }",a.insertBefore(u,a.children[0])}var h=n.getComputedStyle(t),f=h.getPropertyValue("position");f==="static"&&it("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=r.showFps,e.debug=r.debug,e.webgl=r.webgl,e.hideEdgesOnViewport=r.hideEdgesOnViewport,e.textureOnViewport=r.textureOnViewport,e.wheelSensitivity=r.wheelSensitivity,e.motionBlurEnabled=r.motionBlur,e.forcedPixelRatio=se(r.pixelRatio)?r.pixelRatio:null,e.motionBlur=r.motionBlur,e.motionBlurOpacity=r.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=r.desktopTapThreshold,e.desktopTapThreshold2=r.desktopTapThreshold*r.desktopTapThreshold,e.touchTapThreshold=r.touchTapThreshold,e.touchTapThreshold2=r.touchTapThreshold*r.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()};io.notify=function(r,e){var t=this,n=t.cy;if(!this.destroyed){if(r==="init"){t.load();return}if(r==="destroy"){t.destroy();return}(r==="add"||r==="remove"||r==="move"&&n.hasCompoundNodes()||r==="load"||r==="zorder"||r==="mount")&&t.invalidateCachedZSortedEles(),r==="viewport"&&t.redrawHint("select",!0),r==="gc"&&t.redrawHint("gc",!0),(r==="load"||r==="resize"||r==="mount")&&(t.invalidateContainerClientCoordsCache(),t.matchCanvasSize(t.container)),t.redrawHint("eles",!0),t.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};io.destroy=function(){var r=this;r.destroyed=!0,r.cy.stopAnimationLoop();for(var e=0;e<r.bindings.length;e++){var t=r.bindings[e],n=t,i=n.target;(i.off||i.removeEventListener).apply(i,n.args)}if(r.bindings=[],r.beforeRenderCallbacks=[],r.onUpdateEleCalcsFns=[],r.removeObserver&&r.removeObserver.disconnect(),r.styleObserver&&r.styleObserver.disconnect(),r.resizeObserver&&r.resizeObserver.disconnect(),r.labelCalcDiv)try{document.body.removeChild(r.labelCalcDiv)}catch{}};io.isHeadless=function(){return!1};[C0,oM,lM,no,oi,uu].forEach(function(r){Ce(io,r)});var My=1e3/60,hM={setupDequeueing:function(e){return function(){var n=this,i=this.renderer;if(!n.dequeueingSetup){n.dequeueingSetup=!0;var a=iu(function(){i.redrawHint("eles",!0),i.redrawHint("drag",!0),i.redraw()},e.deqRedrawThreshold),s=function(u,h){var f=ai(),c=i.averageRedrawTime,d=i.lastRedrawTime,p=[],g=i.cy.extent(),v=i.getPixelRatio();for(u||i.flushRenderedStyleQueue();;){var m=ai(),y=m-f,b=m-h;if(d<My){var w=My-(u?c:0);if(b>=e.deqFastCost*w)break}else if(u){if(y>=e.deqCost*d||y>=e.deqAvgCost*c)break}else if(b>=e.deqNoDrawCost*My)break;var S=e.deq(n,v,g);if(S.length>0)for(var C=0;C<S.length;C++)p.push(S[C]);else break}p.length>0&&(e.onDeqd(n,p),!u&&e.shouldRedraw(n,p,v,g)&&a())},o=e.priority||l0;i.beforeRender(s,o(n))}}}},J9=function(){function r(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:gc;Gi(this,r),this.idsByKey=new ii,this.keyForId=new ii,this.cachesByLvl=new ii,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=t}return Ui(r,[{key:"getIdsFor",value:function(t){t==null&&Ct("Can not get id list for null key");var n=this.idsByKey,i=this.idsByKey.get(t);return i||(i=new Js,n.set(t,i)),i}},{key:"addIdForKey",value:function(t,n){t!=null&&this.getIdsFor(t).add(n)}},{key:"deleteIdForKey",value:function(t,n){t!=null&&this.getIdsFor(t).delete(n)}},{key:"getNumberOfIdsForKey",value:function(t){return t==null?0:this.getIdsFor(t).size}},{key:"updateKeyMappingFor",value:function(t){var n=t.id(),i=this.keyForId.get(n),a=this.getKey(t);this.deleteIdForKey(i,n),this.addIdForKey(a,n),this.keyForId.set(n,a)}},{key:"deleteKeyMappingFor",value:function(t){var n=t.id(),i=this.keyForId.get(n);this.deleteIdForKey(i,n),this.keyForId.delete(n)}},{key:"keyHasChangedFor",value:function(t){var n=t.id(),i=this.keyForId.get(n),a=this.getKey(t);return i!==a}},{key:"isInvalid",value:function(t){return this.keyHasChangedFor(t)||this.doesEleInvalidateKey(t)}},{key:"getCachesAt",value:function(t){var n=this.cachesByLvl,i=this.lvls,a=n.get(t);return a||(a=new ii,n.set(t,a),i.push(t)),a}},{key:"getCache",value:function(t,n){return this.getCachesAt(n).get(t)}},{key:"get",value:function(t,n){var i=this.getKey(t),a=this.getCache(i,n);return a!=null&&this.updateKeyMappingFor(t),a}},{key:"getForCachedKey",value:function(t,n){var i=this.keyForId.get(t.id()),a=this.getCache(i,n);return a}},{key:"hasCache",value:function(t,n){return this.getCachesAt(n).has(t)}},{key:"has",value:function(t,n){var i=this.getKey(t);return this.hasCache(i,n)}},{key:"setCache",value:function(t,n,i){i.key=t,this.getCachesAt(n).set(t,i)}},{key:"set",value:function(t,n,i){var a=this.getKey(t);this.setCache(a,n,i),this.updateKeyMappingFor(t)}},{key:"deleteCache",value:function(t,n){this.getCachesAt(n).delete(t)}},{key:"delete",value:function(t,n){var i=this.getKey(t);this.deleteCache(i,n)}},{key:"invalidateKey",value:function(t){var n=this;this.lvls.forEach(function(i){return n.deleteCache(t,i)})}},{key:"invalidate",value:function(t){var n=t.id(),i=this.keyForId.get(n);this.deleteKeyMappingFor(t);var a=this.doesEleInvalidateKey(t);return a&&this.invalidateKey(i),a||this.getNumberOfIdsForKey(i)===0}}])}(),TA=25,Jf=50,hc=-4,Qy=3,fM=7.99,e6=8,t6=1024,r6=1024,n6=1024,i6=.2,a6=.8,s6=10,o6=.15,l6=.1,u6=.9,h6=.9,f6=100,c6=1,Gs={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},d6=ar({getKey:null,doesEleInvalidateKey:gc,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:r2,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),_l=function(e,t){var n=this;n.renderer=e,n.onDequeues=[];var i=d6(t);Ce(n,i),n.lookup=new J9(i.getKey,i.doesEleInvalidateKey),n.setupDequeueing()},Wt=_l.prototype;Wt.reasons=Gs;Wt.getTextureQueue=function(r){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[r]=e.eleImgCaches[r]||[]};Wt.getRetiredTextureQueue=function(r){var e=this,t=e.eleImgCaches.retired=e.eleImgCaches.retired||{},n=t[r]=t[r]||[];return n};Wt.getElementQueue=function(){var r=this,e=r.eleCacheQueue=r.eleCacheQueue||new au(function(t,n){return n.reqs-t.reqs});return e};Wt.getElementKeyToQueue=function(){var r=this,e=r.eleKeyToCacheQueue=r.eleKeyToCacheQueue||{};return e};Wt.getElement=function(r,e,t,n,i){var a=this,s=this.renderer,o=s.cy.zoom(),l=this.lookup;if(!e||e.w===0||e.h===0||isNaN(e.w)||isNaN(e.h)||!r.visible()||r.removed()||!a.allowEdgeTxrCaching&&r.isEdge()||!a.allowParentTxrCaching&&r.isParent())return null;if(n==null&&(n=Math.ceil(h0(o*t))),n<hc)n=hc;else if(o>=fM||n>Qy)return null;var u=Math.pow(2,n),h=e.h*u,f=e.w*u,c=s.eleTextBiggerThanMin(r,u);if(!this.isVisible(r,c))return null;var d=l.get(r,n);if(d&&d.invalidated&&(d.invalidated=!1,d.texture.invalidatedWidth-=d.width),d)return d;var p;if(h<=TA?p=TA:h<=Jf?p=Jf:p=Math.ceil(h/Jf)*Jf,h>n6||f>r6)return null;var g=a.getTextureQueue(p),v=g[g.length-2],m=function(){return a.recycleTexture(p,f)||a.addTexture(p,f)};v||(v=g[g.length-1]),v||(v=m()),v.width-v.usedWidth<f&&(v=m());for(var y=function(L){return L&&L.scaledLabelShown===c},b=i&&i===Gs.dequeue,w=i&&i===Gs.highQuality,S=i&&i===Gs.downscale,C,x=n+1;x<=Qy;x++){var A=l.get(r,x);if(A){C=A;break}}var T=C&&C.level===n+1?C:null,D=function(){v.context.drawImage(T.texture.canvas,T.x,0,T.width,T.height,v.usedWidth,0,f,h)};if(v.context.setTransform(1,0,0,1,0,0),v.context.clearRect(v.usedWidth,0,f,p),y(T))D();else if(y(C))if(w){for(var k=C.level;k>n;k--)T=a.getElement(r,e,t,k,Gs.downscale);D()}else return a.queueElement(r,C.level-1),C;else{var E;if(!b&&!w&&!S)for(var M=n-1;M>=hc;M--){var O=l.get(r,M);if(O){E=O;break}}if(y(E))return a.queueElement(r,n),E;v.context.translate(v.usedWidth,0),v.context.scale(u,u),this.drawElement(v.context,r,e,c,!1),v.context.scale(1/u,1/u),v.context.translate(-v.usedWidth,0)}return d={x:v.usedWidth,texture:v,level:n,scale:u,width:f,height:h,scaledLabelShown:c},v.usedWidth+=Math.ceil(f+e6),v.eleCaches.push(d),l.set(r,n,d),a.checkTextureFullness(v),d};Wt.invalidateElements=function(r){for(var e=0;e<r.length;e++)this.invalidateElement(r[e])};Wt.invalidateElement=function(r){var e=this,t=e.lookup,n=[],i=t.isInvalid(r);if(i){for(var a=hc;a<=Qy;a++){var s=t.getForCachedKey(r,a);s&&n.push(s)}var o=t.invalidate(r);if(o)for(var l=0;l<n.length;l++){var u=n[l],h=u.texture;h.invalidatedWidth+=u.width,u.invalidated=!0,e.checkTextureUtility(h)}e.removeFromQueue(r)}};Wt.checkTextureUtility=function(r){r.invalidatedWidth>=i6*r.width&&this.retireTexture(r)};Wt.checkTextureFullness=function(r){var e=this,t=e.getTextureQueue(r.height);r.usedWidth/r.width>a6&&r.fullnessChecks>=s6?_i(t,r):r.fullnessChecks++};Wt.retireTexture=function(r){var e=this,t=r.height,n=e.getTextureQueue(t),i=this.lookup;_i(n,r),r.retired=!0;for(var a=r.eleCaches,s=0;s<a.length;s++){var o=a[s];i.deleteCache(o.key,o.level)}u0(a);var l=e.getRetiredTextureQueue(t);l.push(r)};Wt.addTexture=function(r,e){var t=this,n=t.getTextureQueue(r),i={};return n.push(i),i.eleCaches=[],i.height=r,i.width=Math.max(t6,e),i.usedWidth=0,i.invalidatedWidth=0,i.fullnessChecks=0,i.canvas=t.renderer.makeOffscreenCanvas(i.width,i.height),i.context=i.canvas.getContext("2d"),i};Wt.recycleTexture=function(r,e){for(var t=this,n=t.getTextureQueue(r),i=t.getRetiredTextureQueue(r),a=0;a<i.length;a++){var s=i[a];if(s.width>=e)return s.retired=!1,s.usedWidth=0,s.invalidatedWidth=0,s.fullnessChecks=0,u0(s.eleCaches),s.context.setTransform(1,0,0,1,0,0),s.context.clearRect(0,0,s.width,s.height),_i(i,s),n.push(s),s}};Wt.queueElement=function(r,e){var t=this,n=t.getElementQueue(),i=t.getElementKeyToQueue(),a=this.getKey(r),s=i[a];if(s)s.level=Math.max(s.level,e),s.eles.merge(r),s.reqs++,n.updateItem(s);else{var o={eles:r.spawn().merge(r),level:e,reqs:1,key:a};n.push(o),i[a]=o}};Wt.dequeue=function(r){for(var e=this,t=e.getElementQueue(),n=e.getElementKeyToQueue(),i=[],a=e.lookup,s=0;s<c6&&t.size()>0;s++){var o=t.pop(),l=o.key,u=o.eles[0],h=a.hasCache(u,o.level);if(n[l]=null,h)continue;i.push(o);var f=e.getBoundingBox(u);e.getElement(u,f,r,o.level,Gs.dequeue)}return i};Wt.removeFromQueue=function(r){var e=this,t=e.getElementQueue(),n=e.getElementKeyToQueue(),i=this.getKey(r),a=n[i];a!=null&&(a.eles.length===1?(a.reqs=o0,t.updateItem(a),t.pop(),n[i]=null):a.eles.unmerge(r))};Wt.onDequeue=function(r){this.onDequeues.push(r)};Wt.offDequeue=function(r){_i(this.onDequeues,r)};Wt.setupDequeueing=hM.setupDequeueing({deqRedrawThreshold:f6,deqCost:o6,deqAvgCost:l6,deqNoDrawCost:u6,deqFastCost:h6,deq:function(e,t,n){return e.dequeue(t,n)},onDeqd:function(e,t){for(var n=0;n<e.onDequeues.length;n++){var i=e.onDequeues[n];i(t)}},shouldRedraw:function(e,t,n,i){for(var a=0;a<t.length;a++)for(var s=t[a].eles,o=0;o<s.length;o++){var l=s[o].boundingBox();if(c0(l,i))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var p6=1,Vl=-4,Cc=2,g6=3.99,v6=50,m6=50,y6=.15,b6=.1,w6=.9,x6=.9,S6=1,AA=250,C6=4e3*4e3,MA=32767,k6=!0,cM=function(e){var t=this,n=t.renderer=e,i=n.cy;t.layersByLevel={},t.firstGet=!0,t.lastInvalidationTime=ai()-2*AA,t.skipping=!1,t.eleTxrDeqs=i.collection(),t.scheduleElementRefinement=iu(function(){t.refineElementTextures(t.eleTxrDeqs),t.eleTxrDeqs.unmerge(t.eleTxrDeqs)},m6),n.beforeRender(function(s,o){o-t.lastInvalidationTime<=AA?t.skipping=!0:t.skipping=!1},n.beforeRenderPriorities.lyrTxrSkip);var a=function(o,l){return l.reqs-o.reqs};t.layersQueue=new au(a),t.setupDequeueing()},sr=cM.prototype,DA=0,E6=Math.pow(2,53)-1;sr.makeLayer=function(r,e){var t=Math.pow(2,e),n=Math.ceil(r.w*t),i=Math.ceil(r.h*t),a=this.renderer.makeOffscreenCanvas(n,i),s={id:DA=++DA%E6,bb:r,level:e,width:n,height:i,canvas:a,context:a.getContext("2d"),eles:[],elesQueue:[],reqs:0},o=s.context,l=-s.bb.x1,u=-s.bb.y1;return o.scale(t,t),o.translate(l,u),s};sr.getLayers=function(r,e,t){var n=this,i=n.renderer,a=i.cy,s=a.zoom(),o=n.firstGet;if(n.firstGet=!1,t==null){if(t=Math.ceil(h0(s*e)),t<Vl)t=Vl;else if(s>=g6||t>Cc)return null}n.validateLayersElesOrdering(t,r);var l=n.layersByLevel,u=Math.pow(2,t),h=l[t]=l[t]||[],f,c=n.levelIsComplete(t,r),d,p=function(){var D=function(R){if(n.validateLayersElesOrdering(R,r),n.levelIsComplete(R,r))return d=l[R],!0},k=function(R){if(!d)for(var L=t+R;Vl<=L&&L<=Cc&&!D(L);L+=R);};k(1),k(-1);for(var E=h.length-1;E>=0;E--){var M=h[E];M.invalid&&_i(h,M)}};if(!c)p();else return h;var g=function(){if(!f){f=Ir();for(var D=0;D<r.length;D++)o2(f,r[D].boundingBox())}return f},v=function(D){D=D||{};var k=D.after;g();var E=Math.ceil(f.w*u),M=Math.ceil(f.h*u);if(E>MA||M>MA)return null;var O=E*M;if(O>C6)return null;var R=n.makeLayer(f,t);if(k!=null){var L=h.indexOf(k)+1;h.splice(L,0,R)}else(D.insert===void 0||D.insert)&&h.unshift(R);return R};if(n.skipping&&!o)return null;for(var m=null,y=r.length/p6,b=!o,w=0;w<r.length;w++){var S=r[w],C=S._private.rscratch,x=C.imgLayerCaches=C.imgLayerCaches||{},A=x[t];if(A){m=A;continue}if((!m||m.eles.length>=y||!E8(m.bb,S.boundingBox()))&&(m=v({insert:!0,after:m}),!m))return null;d||b?n.queueLayer(m,S):n.drawEleInLayer(m,S,t,e),m.eles.push(S),x[t]=m}return d||(b?null:h)};sr.getEleLevelForLayerLevel=function(r,e){return r};sr.drawEleInLayer=function(r,e,t,n){var i=this,a=this.renderer,s=r.context,o=e.boundingBox();o.w===0||o.h===0||!e.visible()||(t=i.getEleLevelForLayerLevel(t,n),a.setImgSmoothing(s,!1),a.drawCachedElement(s,e,null,null,t,k6),a.setImgSmoothing(s,!0))};sr.levelIsComplete=function(r,e){var t=this,n=t.layersByLevel[r];if(!n||n.length===0)return!1;for(var i=0,a=0;a<n.length;a++){var s=n[a];if(s.reqs>0||s.invalid)return!1;i+=s.eles.length}return i===e.length};sr.validateLayersElesOrdering=function(r,e){var t=this.layersByLevel[r];if(t)for(var n=0;n<t.length;n++){for(var i=t[n],a=-1,s=0;s<e.length;s++)if(i.eles[0]===e[s]){a=s;break}if(a<0){this.invalidateLayer(i);continue}for(var o=a,s=0;s<i.eles.length;s++)if(i.eles[s]!==e[o+s]){this.invalidateLayer(i);break}}};sr.updateElementsInLayers=function(r,e){for(var t=this,n=eu(r[0]),i=0;i<r.length;i++)for(var a=n?null:r[i],s=n?r[i]:r[i].ele,o=s._private.rscratch,l=o.imgLayerCaches=o.imgLayerCaches||{},u=Vl;u<=Cc;u++){var h=l[u];h&&(a&&t.getEleLevelForLayerLevel(h.level)!==a.level||e(h,s,a))}};sr.haveLayers=function(){for(var r=this,e=!1,t=Vl;t<=Cc;t++){var n=r.layersByLevel[t];if(n&&n.length>0){e=!0;break}}return e};sr.invalidateElements=function(r){var e=this;r.length!==0&&(e.lastInvalidationTime=ai(),!(r.length===0||!e.haveLayers())&&e.updateElementsInLayers(r,function(n,i,a){e.invalidateLayer(n)}))};sr.invalidateLayer=function(r){if(this.lastInvalidationTime=ai(),!r.invalid){var e=r.level,t=r.eles,n=this.layersByLevel[e];_i(n,r),r.elesQueue=[],r.invalid=!0,r.replacement&&(r.replacement.invalid=!0);for(var i=0;i<t.length;i++){var a=t[i]._private.rscratch.imgLayerCaches;a&&(a[e]=null)}}};sr.refineElementTextures=function(r){var e=this;e.updateElementsInLayers(r,function(n,i,a){var s=n.replacement;if(s||(s=n.replacement=e.makeLayer(n.bb,n.level),s.replaces=n,s.eles=n.eles),!s.reqs)for(var o=0;o<s.eles.length;o++)e.queueLayer(s,s.eles[o])})};sr.enqueueElementRefinement=function(r){this.eleTxrDeqs.merge(r),this.scheduleElementRefinement()};sr.queueLayer=function(r,e){var t=this,n=t.layersQueue,i=r.elesQueue,a=i.hasId=i.hasId||{};if(!r.replacement){if(e){if(a[e.id()])return;i.push(e),a[e.id()]=!0}r.reqs?(r.reqs++,n.updateItem(r)):(r.reqs=1,n.push(r))}};sr.dequeue=function(r){for(var e=this,t=e.layersQueue,n=[],i=0;i<S6&&t.size()!==0;){var a=t.peek();if(a.replacement){t.pop();continue}if(a.replaces&&a!==a.replaces.replacement){t.pop();continue}if(a.invalid){t.pop();continue}var s=a.elesQueue.shift();s&&(e.drawEleInLayer(a,s,a.level,r),i++),n.length===0&&n.push(!0),a.elesQueue.length===0&&(t.pop(),a.reqs=0,a.replaces&&e.applyLayerReplacement(a),e.requestRedraw())}return n};sr.applyLayerReplacement=function(r){var e=this,t=e.layersByLevel[r.level],n=r.replaces,i=t.indexOf(n);if(!(i<0||n.invalid)){t[i]=r;for(var a=0;a<r.eles.length;a++){var s=r.eles[a]._private,o=s.imgLayerCaches=s.imgLayerCaches||{};o&&(o[r.level]=r)}e.requestRedraw()}};sr.requestRedraw=iu(function(){var r=this.renderer;r.redrawHint("eles",!0),r.redrawHint("drag",!0),r.redraw()},100);sr.setupDequeueing=hM.setupDequeueing({deqRedrawThreshold:v6,deqCost:y6,deqAvgCost:b6,deqNoDrawCost:w6,deqFastCost:x6,deq:function(e,t){return e.dequeue(t)},onDeqd:l0,shouldRedraw:r2,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var dM={},PA;function T6(r,e){for(var t=0;t<e.length;t++){var n=e[t];r.lineTo(n.x,n.y)}}function A6(r,e,t){for(var n,i=0;i<e.length;i++){var a=e[i];i===0&&(n=a),r.lineTo(a.x,a.y)}r.quadraticCurveTo(t.x,t.y,n.x,n.y)}function BA(r,e,t){r.beginPath&&r.beginPath();for(var n=e,i=0;i<n.length;i++){var a=n[i];r.lineTo(a.x,a.y)}var s=t,o=t[0];r.moveTo(o.x,o.y);for(var i=1;i<s.length;i++){var a=s[i];r.lineTo(a.x,a.y)}r.closePath&&r.closePath()}function M6(r,e,t,n,i){r.beginPath&&r.beginPath(),r.arc(t,n,i,0,Math.PI*2,!1);var a=e,s=a[0];r.moveTo(s.x,s.y);for(var o=0;o<a.length;o++){var l=a[o];r.lineTo(l.x,l.y)}r.closePath&&r.closePath()}function D6(r,e,t,n){r.arc(e,t,n,0,Math.PI*2,!1)}dM.arrowShapeImpl=function(r){return(PA||(PA={polygon:T6,"triangle-backcurve":A6,"triangle-tee":BA,"circle-triangle":M6,"triangle-cross":BA,circle:D6}))[r]};var Vn={};Vn.drawElement=function(r,e,t,n,i,a){var s=this;e.isNode()?s.drawNode(r,e,t,n,i,a):s.drawEdge(r,e,t,n,i,a)};Vn.drawElementOverlay=function(r,e){var t=this;e.isNode()?t.drawNodeOverlay(r,e):t.drawEdgeOverlay(r,e)};Vn.drawElementUnderlay=function(r,e){var t=this;e.isNode()?t.drawNodeUnderlay(r,e):t.drawEdgeUnderlay(r,e)};Vn.drawCachedElementPortion=function(r,e,t,n,i,a,s,o){var l=this,u=t.getBoundingBox(e);if(!(u.w===0||u.h===0)){var h=t.getElement(e,u,n,i,a);if(h!=null){var f=o(l,e);if(f===0)return;var c=s(l,e),d=u.x1,p=u.y1,g=u.w,v=u.h,m,y,b,w,S;if(c!==0){var C=t.getRotationPoint(e);b=C.x,w=C.y,r.translate(b,w),r.rotate(c),S=l.getImgSmoothing(r),S||l.setImgSmoothing(r,!0);var x=t.getRotationOffset(e);m=x.x,y=x.y}else m=d,y=p;var A;f!==1&&(A=r.globalAlpha,r.globalAlpha=A*f),r.drawImage(h.texture.canvas,h.x,0,h.width,h.height,m,y,g,v),f!==1&&(r.globalAlpha=A),c!==0&&(r.rotate(-c),r.translate(-b,-w),S||l.setImgSmoothing(r,!1))}else t.drawElement(r,e)}};var P6=function(){return 0},B6=function(e,t){return e.getTextAngle(t,null)},O6=function(e,t){return e.getTextAngle(t,"source")},R6=function(e,t){return e.getTextAngle(t,"target")},L6=function(e,t){return t.effectiveOpacity()},Dy=function(e,t){return t.pstyle("text-opacity").pfValue*t.effectiveOpacity()};Vn.drawCachedElement=function(r,e,t,n,i,a){var s=this,o=s.data,l=o.eleTxrCache,u=o.lblTxrCache,h=o.slbTxrCache,f=o.tlbTxrCache,c=e.boundingBox(),d=a===!0?l.reasons.highQuality:null;if(!(c.w===0||c.h===0||!e.visible())&&(!n||c0(c,n))){var p=e.isEdge(),g=e.element()._private.rscratch.badLine;s.drawElementUnderlay(r,e),s.drawCachedElementPortion(r,e,l,t,i,d,P6,L6),(!p||!g)&&s.drawCachedElementPortion(r,e,u,t,i,d,B6,Dy),p&&!g&&(s.drawCachedElementPortion(r,e,h,t,i,d,O6,Dy),s.drawCachedElementPortion(r,e,f,t,i,d,R6,Dy)),s.drawElementOverlay(r,e)}};Vn.drawElements=function(r,e){for(var t=this,n=0;n<e.length;n++){var i=e[n];t.drawElement(r,i)}};Vn.drawCachedElements=function(r,e,t,n){for(var i=this,a=0;a<e.length;a++){var s=e[a];i.drawCachedElement(r,s,t,n)}};Vn.drawCachedNodes=function(r,e,t,n){for(var i=this,a=0;a<e.length;a++){var s=e[a];s.isNode()&&i.drawCachedElement(r,s,t,n)}};Vn.drawLayeredElements=function(r,e,t,n){var i=this,a=i.data.lyrTxrCache.getLayers(e,t);if(a)for(var s=0;s<a.length;s++){var o=a[s],l=o.bb;l.w===0||l.h===0||r.drawImage(o.canvas,l.x1,l.y1,l.w,l.h)}else i.drawCachedElements(r,e,t,n)};var li={};li.drawEdge=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this,o=e._private.rscratch;if(!(a&&!e.visible())&&!(o.badLine||o.allpts==null||isNaN(o.allpts[0]))){var l;t&&(l=t,r.translate(-l.x1,-l.y1));var u=a?e.pstyle("opacity").value:1,h=a?e.pstyle("line-opacity").value:1,f=e.pstyle("curve-style").value,c=e.pstyle("line-style").value,d=e.pstyle("width").pfValue,p=e.pstyle("line-cap").value,g=e.pstyle("line-outline-width").value,v=e.pstyle("line-outline-color").value,m=u*h,y=u*h,b=function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:m;f==="straight-triangle"?(s.eleStrokeStyle(r,e,R),s.drawEdgeTrianglePath(e,r,o.allpts)):(r.lineWidth=d,r.lineCap=p,s.eleStrokeStyle(r,e,R),s.drawEdgePath(e,r,o.allpts,c),r.lineCap="butt")},w=function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:m;if(r.lineWidth=d+g,r.lineCap=p,g>0)s.colorStrokeStyle(r,v[0],v[1],v[2],R);else{r.lineCap="butt";return}f==="straight-triangle"?s.drawEdgeTrianglePath(e,r,o.allpts):(s.drawEdgePath(e,r,o.allpts,c),r.lineCap="butt")},S=function(){i&&s.drawEdgeOverlay(r,e)},C=function(){i&&s.drawEdgeUnderlay(r,e)},x=function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y;s.drawArrowheads(r,e,R)},A=function(){s.drawElementText(r,e,null,n)};r.lineJoin="round";var T=e.pstyle("ghost").value==="yes";if(T){var D=e.pstyle("ghost-offset-x").pfValue,k=e.pstyle("ghost-offset-y").pfValue,E=e.pstyle("ghost-opacity").value,M=m*E;r.translate(D,k),b(M),x(M),r.translate(-D,-k)}else w();C(),b(),x(),S(),A(),t&&r.translate(l.x1,l.y1)}};var pM=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,n){if(n.visible()){var i=n.pstyle("".concat(e,"-opacity")).value;if(i!==0){var a=this,s=a.usePaths(),o=n._private.rscratch,l=n.pstyle("".concat(e,"-padding")).pfValue,u=2*l,h=n.pstyle("".concat(e,"-color")).value;t.lineWidth=u,o.edgeType==="self"&&!s?t.lineCap="butt":t.lineCap="round",a.colorStrokeStyle(t,h[0],h[1],h[2],i),a.drawEdgePath(n,t,o.allpts,"solid")}}}};li.drawEdgeOverlay=pM("overlay");li.drawEdgeUnderlay=pM("underlay");li.drawEdgePath=function(r,e,t,n){var i=r._private.rscratch,a=e,s,o=!1,l=this.usePaths(),u=r.pstyle("line-dash-pattern").pfValue,h=r.pstyle("line-dash-offset").pfValue;if(l){var f=t.join("$"),c=i.pathCacheKey&&i.pathCacheKey===f;c?(s=e=i.pathCache,o=!0):(s=e=new Path2D,i.pathCacheKey=f,i.pathCache=s)}if(a.setLineDash)switch(n){case"dotted":a.setLineDash([1,1]);break;case"dashed":a.setLineDash(u),a.lineDashOffset=h;break;case"solid":a.setLineDash([]);break}if(!o&&!i.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(t[0],t[1]),i.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var d=2;d+3<t.length;d+=4)e.quadraticCurveTo(t[d],t[d+1],t[d+2],t[d+3]);break;case"straight":case"haystack":for(var p=2;p+1<t.length;p+=2)e.lineTo(t[p],t[p+1]);break;case"segments":if(i.isRound){var g=Lr(i.roundCorners),v;try{for(g.s();!(v=g.n()).done;){var m=v.value;rM(e,m)}}catch(b){g.e(b)}finally{g.f()}e.lineTo(t[t.length-2],t[t.length-1])}else for(var y=2;y+1<t.length;y+=2)e.lineTo(t[y],t[y+1]);break}e=a,l?e.stroke(s):e.stroke(),e.setLineDash&&e.setLineDash([])};li.drawEdgeTrianglePath=function(r,e,t){e.fillStyle=e.strokeStyle;for(var n=r.pstyle("width").pfValue,i=0;i+1<t.length;i+=2){var a=[t[i+2]-t[i],t[i+3]-t[i+1]],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]),o=[a[1]/s,-a[0]/s],l=[o[0]*n/2,o[1]*n/2];e.beginPath(),e.moveTo(t[i]-l[0],t[i+1]-l[1]),e.lineTo(t[i]+l[0],t[i+1]+l[1]),e.lineTo(t[i+2],t[i+3]),e.closePath(),e.fill()}};li.drawArrowheads=function(r,e,t){var n=e._private.rscratch,i=n.edgeType==="haystack";i||this.drawArrowhead(r,e,"source",n.arrowStartX,n.arrowStartY,n.srcArrowAngle,t),this.drawArrowhead(r,e,"mid-target",n.midX,n.midY,n.midtgtArrowAngle,t),this.drawArrowhead(r,e,"mid-source",n.midX,n.midY,n.midsrcArrowAngle,t),i||this.drawArrowhead(r,e,"target",n.arrowEndX,n.arrowEndY,n.tgtArrowAngle,t)};li.drawArrowhead=function(r,e,t,n,i,a,s){if(!(isNaN(n)||n==null||isNaN(i)||i==null||isNaN(a)||a==null)){var o=this,l=e.pstyle(t+"-arrow-shape").value;if(l!=="none"){var u=e.pstyle(t+"-arrow-fill").value==="hollow"?"both":"filled",h=e.pstyle(t+"-arrow-fill").value,f=e.pstyle("width").pfValue,c=e.pstyle(t+"-arrow-width"),d=c.value==="match-line"?f:c.pfValue;c.units==="%"&&(d*=f);var p=e.pstyle("opacity").value;s===void 0&&(s=p);var g=r.globalCompositeOperation;(s!==1||h==="hollow")&&(r.globalCompositeOperation="destination-out",o.colorFillStyle(r,255,255,255,1),o.colorStrokeStyle(r,255,255,255,1),o.drawArrowShape(e,r,u,f,l,d,n,i,a),r.globalCompositeOperation=g);var v=e.pstyle(t+"-arrow-color").value;o.colorFillStyle(r,v[0],v[1],v[2],s),o.colorStrokeStyle(r,v[0],v[1],v[2],s),o.drawArrowShape(e,r,h,f,l,d,n,i,a)}}};li.drawArrowShape=function(r,e,t,n,i,a,s,o,l){var u=this,h=this.usePaths()&&i!=="triangle-cross",f=!1,c,d=e,p={x:s,y:o},g=r.pstyle("arrow-scale").value,v=this.getArrowWidth(n,g),m=u.arrowShapes[i];if(h){var y=u.arrowPathCache=u.arrowPathCache||[],b=za(i),w=y[b];w!=null?(c=e=w,f=!0):(c=e=new Path2D,y[b]=c)}f||(e.beginPath&&e.beginPath(),h?m.draw(e,1,0,{x:0,y:0},1):m.draw(e,v,l,p,n),e.closePath&&e.closePath()),e=d,h&&(e.translate(s,o),e.rotate(l),e.scale(v,v)),(t==="filled"||t==="both")&&(h?e.fill(c):e.fill()),(t==="hollow"||t==="both")&&(e.lineWidth=a/(h?v:1),e.lineJoin="miter",h?e.stroke(c):e.stroke()),h&&(e.scale(1/v,1/v),e.rotate(-l),e.translate(-s,-o))};var T0={};T0.safeDrawImage=function(r,e,t,n,i,a,s,o,l,u){if(!(i<=0||a<=0||l<=0||u<=0))try{r.drawImage(e,t,n,i,a,s,o,l,u)}catch(h){it(h)}};T0.drawInscribedImage=function(r,e,t,n,i){var a=this,s=t.position(),o=s.x,l=s.y,u=t.cy().style(),h=u.getIndexedStyle.bind(u),f=h(t,"background-fit","value",n),c=h(t,"background-repeat","value",n),d=t.width(),p=t.height(),g=t.padding()*2,v=d+(h(t,"background-width-relative-to","value",n)==="inner"?0:g),m=p+(h(t,"background-height-relative-to","value",n)==="inner"?0:g),y=t._private.rscratch,b=h(t,"background-clip","value",n),w=b==="node",S=h(t,"background-image-opacity","value",n)*i,C=h(t,"background-image-smoothing","value",n),x=t.pstyle("corner-radius").value;x!=="auto"&&(x=t.pstyle("corner-radius").pfValue);var A=e.width||e.cachedW,T=e.height||e.cachedH;(A==null||T==null)&&(document.body.appendChild(e),A=e.cachedW=e.width||e.offsetWidth,T=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var D=A,k=T;if(h(t,"background-width","value",n)!=="auto"&&(h(t,"background-width","units",n)==="%"?D=h(t,"background-width","pfValue",n)*v:D=h(t,"background-width","pfValue",n)),h(t,"background-height","value",n)!=="auto"&&(h(t,"background-height","units",n)==="%"?k=h(t,"background-height","pfValue",n)*m:k=h(t,"background-height","pfValue",n)),!(D===0||k===0)){if(f==="contain"){var E=Math.min(v/D,m/k);D*=E,k*=E}else if(f==="cover"){var E=Math.max(v/D,m/k);D*=E,k*=E}var M=o-v/2,O=h(t,"background-position-x","units",n),R=h(t,"background-position-x","pfValue",n);O==="%"?M+=(v-D)*R:M+=R;var L=h(t,"background-offset-x","units",n),I=h(t,"background-offset-x","pfValue",n);L==="%"?M+=(v-D)*I:M+=I;var N=l-m/2,q=h(t,"background-position-y","units",n),z=h(t,"background-position-y","pfValue",n);q==="%"?N+=(m-k)*z:N+=z;var F=h(t,"background-offset-y","units",n),_=h(t,"background-offset-y","pfValue",n);F==="%"?N+=(m-k)*_:N+=_,y.pathCache&&(M-=o,N-=l,o=0,l=0);var U=r.globalAlpha;r.globalAlpha=S;var X=a.getImgSmoothing(r),$=!1;if(C==="no"&&X?(a.setImgSmoothing(r,!1),$=!0):C==="yes"&&!X&&(a.setImgSmoothing(r,!0),$=!0),c==="no-repeat")w&&(r.save(),y.pathCache?r.clip(y.pathCache):(a.nodeShapes[a.getNodeShape(t)].draw(r,o,l,v,m,x,y),r.clip())),a.safeDrawImage(r,e,0,0,A,T,M,N,D,k),w&&r.restore();else{var Q=r.createPattern(e,c);r.fillStyle=Q,a.nodeShapes[a.getNodeShape(t)].draw(r,o,l,v,m,x,y),r.translate(M,N),r.fill(),r.translate(-M,-N)}r.globalAlpha=U,$&&a.setImgSmoothing(r,X)}};var ja={};ja.eleTextBiggerThanMin=function(r,e){if(!e){var t=r.cy().zoom(),n=this.getPixelRatio(),i=Math.ceil(h0(t*n));e=Math.pow(2,i)}var a=r.pstyle("font-size").pfValue*e,s=r.pstyle("min-zoomed-font-size").pfValue;return!(a<s)};ja.drawElementText=function(r,e,t,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this;if(n==null){if(a&&!s.eleTextBiggerThanMin(e))return}else if(n===!1)return;if(e.isNode()){var o=e.pstyle("label");if(!o||!o.value)return;var l=s.getLabelJustification(e);r.textAlign=l,r.textBaseline="bottom"}else{var u=e.element()._private.rscratch.badLine,h=e.pstyle("label"),f=e.pstyle("source-label"),c=e.pstyle("target-label");if(u||(!h||!h.value)&&(!f||!f.value)&&(!c||!c.value))return;r.textAlign="center",r.textBaseline="bottom"}var d=!t,p;t&&(p=t,r.translate(-p.x1,-p.y1)),i==null?(s.drawText(r,e,null,d,a),e.isEdge()&&(s.drawText(r,e,"source",d,a),s.drawText(r,e,"target",d,a))):s.drawText(r,e,i,d,a),t&&r.translate(p.x1,p.y1)};ja.getFontCache=function(r){var e;this.fontCaches=this.fontCaches||[];for(var t=0;t<this.fontCaches.length;t++)if(e=this.fontCaches[t],e.context===r)return e;return e={context:r},this.fontCaches.push(e),e};ja.setupTextStyle=function(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=e.pstyle("font-style").strValue,i=e.pstyle("font-size").pfValue+"px",a=e.pstyle("font-family").strValue,s=e.pstyle("font-weight").strValue,o=t?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,l=e.pstyle("text-outline-opacity").value*o,u=e.pstyle("color").value,h=e.pstyle("text-outline-color").value;r.font=n+" "+s+" "+i+" "+a,r.lineJoin="round",this.colorFillStyle(r,u[0],u[1],u[2],o),this.colorStrokeStyle(r,h[0],h[1],h[2],l)};function Py(r,e,t,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,s=arguments.length>6?arguments[6]:void 0;r.beginPath(),r.moveTo(e+a,t),r.lineTo(e+n-a,t),r.quadraticCurveTo(e+n,t,e+n,t+a),r.lineTo(e+n,t+i-a),r.quadraticCurveTo(e+n,t+i,e+n-a,t+i),r.lineTo(e+a,t+i),r.quadraticCurveTo(e,t+i,e,t+i-a),r.lineTo(e,t+a),r.quadraticCurveTo(e,t,e+a,t),r.closePath(),s?r.stroke():r.fill()}ja.getTextAngle=function(r,e){var t,n=r._private,i=n.rscratch,a=e?e+"-":"",s=r.pstyle(a+"text-rotation");if(s.strValue==="autorotate"){var o=Or(i,"labelAngle",e);t=r.isEdge()?o:0}else s.strValue==="none"?t=0:t=s.pfValue;return t};ja.drawText=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=e._private,s=a.rscratch,o=i?e.effectiveOpacity():1;if(!(i&&(o===0||e.pstyle("text-opacity").value===0))){t==="main"&&(t=null);var l=Or(s,"labelX",t),u=Or(s,"labelY",t),h,f,c=this.getLabelText(e,t);if(c!=null&&c!==""&&!isNaN(l)&&!isNaN(u)){this.setupTextStyle(r,e,i);var d=t?t+"-":"",p=Or(s,"labelWidth",t),g=Or(s,"labelHeight",t),v=e.pstyle(d+"text-margin-x").pfValue,m=e.pstyle(d+"text-margin-y").pfValue,y=e.isEdge(),b=e.pstyle("text-halign").value,w=e.pstyle("text-valign").value;y&&(b="center",w="center"),l+=v,u+=m;var S;switch(n?S=this.getTextAngle(e,t):S=0,S!==0&&(h=l,f=u,r.translate(h,f),r.rotate(S),l=0,u=0),w){case"top":break;case"center":u+=g/2;break;case"bottom":u+=g;break}var C=e.pstyle("text-background-opacity").value,x=e.pstyle("text-border-opacity").value,A=e.pstyle("text-border-width").pfValue,T=e.pstyle("text-background-padding").pfValue,D=e.pstyle("text-background-shape").strValue,k=D.indexOf("round")===0,E=2;if(C>0||A>0&&x>0){var M=l-T;switch(b){case"left":M-=p;break;case"center":M-=p/2;break}var O=u-g-T,R=p+2*T,L=g+2*T;if(C>0){var I=r.fillStyle,N=e.pstyle("text-background-color").value;r.fillStyle="rgba("+N[0]+","+N[1]+","+N[2]+","+C*o+")",k?Py(r,M,O,R,L,E):r.fillRect(M,O,R,L),r.fillStyle=I}if(A>0&&x>0){var q=r.strokeStyle,z=r.lineWidth,F=e.pstyle("text-border-color").value,_=e.pstyle("text-border-style").value;if(r.strokeStyle="rgba("+F[0]+","+F[1]+","+F[2]+","+x*o+")",r.lineWidth=A,r.setLineDash)switch(_){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"double":r.lineWidth=A/4,r.setLineDash([]);break;case"solid":r.setLineDash([]);break}if(k?Py(r,M,O,R,L,E,"stroke"):r.strokeRect(M,O,R,L),_==="double"){var U=A/2;k?Py(r,M+U,O+U,R-U*2,L-U*2,E,"stroke"):r.strokeRect(M+U,O+U,R-U*2,L-U*2)}r.setLineDash&&r.setLineDash([]),r.lineWidth=z,r.strokeStyle=q}}var X=2*e.pstyle("text-outline-width").pfValue;if(X>0&&(r.lineWidth=X),e.pstyle("text-wrap").value==="wrap"){var $=Or(s,"labelWrapCachedLines",t),Q=Or(s,"labelLineHeight",t),ee=p/2,oe=this.getLabelJustification(e);switch(oe==="auto"||(b==="left"?oe==="left"?l+=-p:oe==="center"&&(l+=-ee):b==="center"?oe==="left"?l+=-ee:oe==="right"&&(l+=ee):b==="right"&&(oe==="center"?l+=ee:oe==="right"&&(l+=p))),w){case"top":u-=($.length-1)*Q;break;case"center":case"bottom":u-=($.length-1)*Q;break}for(var te=0;te<$.length;te++)X>0&&r.strokeText($[te],l,u),r.fillText($[te],l,u),u+=Q}else X>0&&r.strokeText(c,l,u),r.fillText(c,l,u);S!==0&&(r.rotate(-S),r.translate(-h,-f))}}};var ji={};ji.drawNode=function(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this,o,l,u=e._private,h=u.rscratch,f=e.position();if(!(!se(f.x)||!se(f.y))&&!(a&&!e.visible())){var c=a?e.effectiveOpacity():1,d=s.usePaths(),p,g=!1,v=e.padding();o=e.width()+2*v,l=e.height()+2*v;var m;t&&(m=t,r.translate(-m.x1,-m.y1));for(var y=e.pstyle("background-image"),b=y.value,w=new Array(b.length),S=new Array(b.length),C=0,x=0;x<b.length;x++){var A=b[x],T=w[x]=A!=null&&A!=="none";if(T){var D=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",x);C++,S[x]=s.getCachedImage(A,D,function(){u.backgroundTimestamp=Date.now(),e.emitAndNotify("background")})}}var k=e.pstyle("background-blacken").value,E=e.pstyle("border-width").pfValue,M=e.pstyle("background-opacity").value*c,O=e.pstyle("border-color").value,R=e.pstyle("border-style").value,L=e.pstyle("border-join").value,I=e.pstyle("border-cap").value,N=e.pstyle("border-position").value,q=e.pstyle("border-dash-pattern").pfValue,z=e.pstyle("border-dash-offset").pfValue,F=e.pstyle("border-opacity").value*c,_=e.pstyle("outline-width").pfValue,U=e.pstyle("outline-color").value,X=e.pstyle("outline-style").value,$=e.pstyle("outline-opacity").value*c,Q=e.pstyle("outline-offset").value,ee=e.pstyle("corner-radius").value;ee!=="auto"&&(ee=e.pstyle("corner-radius").pfValue);var oe=function(){var me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:M;s.eleFillStyle(r,e,me)},te=function(){var me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:F;s.colorStrokeStyle(r,O[0],O[1],O[2],me)},V=function(){var me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$;s.colorStrokeStyle(r,U[0],U[1],U[2],me)},W=function(me,J,P,G){var j=s.nodePathCache=s.nodePathCache||[],Y=t2(P==="polygon"?P+","+G.join(","):P,""+J,""+me,""+ee),Z=j[Y],ve,re=!1;return Z!=null?(ve=Z,re=!0,h.pathCache=ve):(ve=new Path2D,j[Y]=h.pathCache=ve),{path:ve,cacheHit:re}},K=e.pstyle("shape").strValue,ie=e.pstyle("shape-polygon-points").pfValue;if(d){r.translate(f.x,f.y);var ue=W(o,l,K,ie);p=ue.path,g=ue.cacheHit}var Me=function(){if(!g){var me=f;d&&(me={x:0,y:0}),s.nodeShapes[s.getNodeShape(e)].draw(p||r,me.x,me.y,o,l,ee,h)}d?r.fill(p):r.fill()},bt=function(){for(var me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:c,J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,P=u.backgrounding,G=0,j=0;j<S.length;j++){var Y=e.cy().style().getIndexedStyle(e,"background-image-containment","value",j);if(J&&Y==="over"||!J&&Y==="inside"){G++;continue}w[j]&&S[j].complete&&!S[j].error&&(G++,s.drawInscribedImage(r,S[j],e,j,me))}u.backgrounding=G!==C,P!==u.backgrounding&&e.updateStyle(!1)},at=function(){var me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c;s.hasPie(e)&&(s.drawPie(r,e,J),me&&(d||s.nodeShapes[s.getNodeShape(e)].draw(r,f.x,f.y,o,l,ee,h)))},ce=function(){var me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c;s.hasStripe(e)&&(r.save(),d?r.clip(h.pathCache):(s.nodeShapes[s.getNodeShape(e)].draw(r,f.x,f.y,o,l,ee,h),r.clip()),s.drawStripe(r,e,J),r.restore(),me&&(d||s.nodeShapes[s.getNodeShape(e)].draw(r,f.x,f.y,o,l,ee,h)))},de=function(){var me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:c,J=(k>0?k:-k)*me,P=k>0?0:255;k!==0&&(s.colorFillStyle(r,P,P,P,J),d?r.fill(p):r.fill())},xe=function(){if(E>0){if(r.lineWidth=E,r.lineCap=I,r.lineJoin=L,r.setLineDash)switch(R){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash(q),r.lineDashOffset=z;break;case"solid":case"double":r.setLineDash([]);break}if(N!=="center"){if(r.save(),r.lineWidth*=2,N==="inside")d?r.clip(p):r.clip();else{var me=new Path2D;me.rect(-o/2-E,-l/2-E,o+2*E,l+2*E),me.addPath(p),r.clip(me,"evenodd")}d?r.stroke(p):r.stroke(),r.restore()}else d?r.stroke(p):r.stroke();if(R==="double"){r.lineWidth=E/3;var J=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",d?r.stroke(p):r.stroke(),r.globalCompositeOperation=J}r.setLineDash&&r.setLineDash([])}},ke=function(){if(_>0){if(r.lineWidth=_,r.lineCap="butt",r.setLineDash)switch(X){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"solid":case"double":r.setLineDash([]);break}var me=f;d&&(me={x:0,y:0});var J=s.getNodeShape(e),P=E;N==="inside"&&(P=0),N==="outside"&&(P*=2);var G=(o+P+(_+Q))/o,j=(l+P+(_+Q))/l,Y=o*G,Z=l*j,ve=s.nodeShapes[J].points,re;if(d){var ye=W(Y,Z,J,ve);re=ye.path}if(J==="ellipse")s.drawEllipsePath(re||r,me.x,me.y,Y,Z);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(J)){var Le=0,We=0,Ee=0;J==="round-diamond"?Le=(P+Q+_)*1.4:J==="round-heptagon"?(Le=(P+Q+_)*1.075,Ee=-(P/2+Q+_)/35):J==="round-hexagon"?Le=(P+Q+_)*1.12:J==="round-pentagon"?(Le=(P+Q+_)*1.13,Ee=-(P/2+Q+_)/15):J==="round-tag"?(Le=(P+Q+_)*1.12,We=(P/2+_+Q)*.07):J==="round-triangle"&&(Le=(P+Q+_)*(Math.PI/2),Ee=-(P+Q/2+_)/Math.PI),Le!==0&&(G=(o+Le)/o,Y=o*G,["round-hexagon","round-tag"].includes(J)||(j=(l+Le)/l,Z=l*j)),ee=ee==="auto"?h2(Y,Z):ee;for(var Ne=Y/2,Ae=Z/2,Be=ee+(P+_+Q)/2,st=new Array(ve.length/2),Ot=new Array(ve.length/2),Zt=0;Zt<ve.length/2;Zt++)st[Zt]={x:me.x+We+Ne*ve[Zt*2],y:me.y+Ee+Ae*ve[Zt*2+1]};var Gt,At,Qt,qt,Sr=st.length;for(At=st[Sr-1],Gt=0;Gt<Sr;Gt++)Qt=st[Gt%Sr],qt=st[(Gt+1)%Sr],Ot[Gt]=k0(At,Qt,qt,Be),At=Qt,Qt=qt;s.drawRoundPolygonPath(re||r,me.x+We,me.y+Ee,o*G,l*j,ve,Ot)}else if(["roundrectangle","round-rectangle"].includes(J))ee=ee==="auto"?zi(Y,Z):ee,s.drawRoundRectanglePath(re||r,me.x,me.y,Y,Z,ee+(P+_+Q)/2);else if(["cutrectangle","cut-rectangle"].includes(J))ee=ee==="auto"?d0():ee,s.drawCutRectanglePath(re||r,me.x,me.y,Y,Z,null,ee+(P+_+Q)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(J))ee=ee==="auto"?zi(Y,Z):ee,s.drawBottomRoundRectanglePath(re||r,me.x,me.y,Y,Z,ee+(P+_+Q)/2);else if(J==="barrel")s.drawBarrelPath(re||r,me.x,me.y,Y,Z);else if(J.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(J)){var Sn=(P+_+Q)/o;ve=vc(mc(ve,Sn)),s.drawPolygonPath(re||r,me.x,me.y,o,l,ve)}else{var gi=(P+_+Q)/o;ve=vc(mc(ve,-gi)),s.drawPolygonPath(re||r,me.x,me.y,o,l,ve)}if(d?r.stroke(re):r.stroke(),X==="double"){r.lineWidth=P/3;var jn=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",d?r.stroke(re):r.stroke(),r.globalCompositeOperation=jn}r.setLineDash&&r.setLineDash([])}},Se=function(){i&&s.drawNodeOverlay(r,e,f,o,l)},Te=function(){i&&s.drawNodeUnderlay(r,e,f,o,l)},Pe=function(){s.drawElementText(r,e,null,n)},Ke=e.pstyle("ghost").value==="yes";if(Ke){var ut=e.pstyle("ghost-offset-x").pfValue,Et=e.pstyle("ghost-offset-y").pfValue,Ze=e.pstyle("ghost-opacity").value,Bt=Ze*c;r.translate(ut,Et),V(),ke(),oe(Ze*M),Me(),bt(Bt,!0),te(Ze*F),xe(),at(k!==0||E!==0),ce(k!==0||E!==0),bt(Bt,!1),de(Bt),r.translate(-ut,-Et)}d&&r.translate(-f.x,-f.y),Te(),d&&r.translate(f.x,f.y),V(),ke(),oe(),Me(),bt(c,!0),te(),xe(),at(k!==0||E!==0),ce(k!==0||E!==0),bt(c,!1),de(),d&&r.translate(-f.x,-f.y),Pe(),Se(),t&&r.translate(m.x1,m.y1)}};var gM=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(t,n,i,a,s){var o=this;if(n.visible()){var l=n.pstyle("".concat(e,"-padding")).pfValue,u=n.pstyle("".concat(e,"-opacity")).value,h=n.pstyle("".concat(e,"-color")).value,f=n.pstyle("".concat(e,"-shape")).value,c=n.pstyle("".concat(e,"-corner-radius")).value;if(u>0){if(i=i||n.position(),a==null||s==null){var d=n.padding();a=n.width()+2*d,s=n.height()+2*d}o.colorFillStyle(t,h[0],h[1],h[2],u),o.nodeShapes[f].draw(t,i.x,i.y,a+l*2,s+l*2,c),t.fill()}}}};ji.drawNodeOverlay=gM("overlay");ji.drawNodeUnderlay=gM("underlay");ji.hasPie=function(r){return r=r[0],r._private.hasPie};ji.hasStripe=function(r){return r=r[0],r._private.hasStripe};ji.drawPie=function(r,e,t,n){e=e[0],n=n||e.position();var i=e.cy().style(),a=e.pstyle("pie-size"),s=e.pstyle("pie-hole"),o=e.pstyle("pie-start-angle").pfValue,l=n.x,u=n.y,h=e.width(),f=e.height(),c=Math.min(h,f)/2,d,p=0,g=this.usePaths();if(g&&(l=0,u=0),a.units==="%"?c=c*a.pfValue:a.pfValue!==void 0&&(c=a.pfValue/2),s.units==="%"?d=c*s.pfValue:s.pfValue!==void 0&&(d=s.pfValue/2),!(d>=c))for(var v=1;v<=i.pieBackgroundN;v++){var m=e.pstyle("pie-"+v+"-background-size").value,y=e.pstyle("pie-"+v+"-background-color").value,b=e.pstyle("pie-"+v+"-background-opacity").value*t,w=m/100;w+p>1&&(w=1-p);var S=1.5*Math.PI+2*Math.PI*p;S+=o;var C=2*Math.PI*w,x=S+C;m===0||p>=1||p+w>1||(d===0?(r.beginPath(),r.moveTo(l,u),r.arc(l,u,c,S,x),r.closePath()):(r.beginPath(),r.arc(l,u,c,S,x),r.arc(l,u,d,x,S,!0),r.closePath()),this.colorFillStyle(r,y[0],y[1],y[2],b),r.fill(),p+=w)}};ji.drawStripe=function(r,e,t,n){e=e[0],n=n||e.position();var i=e.cy().style(),a=n.x,s=n.y,o=e.width(),l=e.height(),u=0,h=this.usePaths();r.save();var f=e.pstyle("stripe-direction").value,c=e.pstyle("stripe-size");switch(f){case"vertical":break;case"righward":r.rotate(-Math.PI/2);break}var d=o,p=l;c.units==="%"?(d=d*c.pfValue,p=p*c.pfValue):c.pfValue!==void 0&&(d=c.pfValue,p=c.pfValue),h&&(a=0,s=0),s-=d/2,a-=p/2;for(var g=1;g<=i.stripeBackgroundN;g++){var v=e.pstyle("stripe-"+g+"-background-size").value,m=e.pstyle("stripe-"+g+"-background-color").value,y=e.pstyle("stripe-"+g+"-background-opacity").value*t,b=v/100;b+u>1&&(b=1-u),!(v===0||u>=1||u+b>1)&&(r.beginPath(),r.rect(a,s+p*u,d,p*b),r.closePath(),this.colorFillStyle(r,m[0],m[1],m[2],y),r.fill(),u+=b)}r.restore()};var wr={},I6=100;wr.getPixelRatio=function(){var r=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var e=this.cy.window(),t=r.backingStorePixelRatio||r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;return(e.devicePixelRatio||1)/t};wr.paintCache=function(r){for(var e=this.paintCaches=this.paintCaches||[],t=!0,n,i=0;i<e.length;i++)if(n=e[i],n.context===r){t=!1;break}return t&&(n={context:r},e.push(n)),n};wr.createGradientStyleFor=function(r,e,t,n,i){var a,s=this.usePaths(),o=t.pstyle(e+"-gradient-stop-colors").value,l=t.pstyle(e+"-gradient-stop-positions").pfValue;if(n==="radial-gradient")if(t.isEdge()){var u=t.sourceEndpoint(),h=t.targetEndpoint(),f=t.midpoint(),c=Va(u,f),d=Va(h,f);a=r.createRadialGradient(f.x,f.y,0,f.x,f.y,Math.max(c,d))}else{var p=s?{x:0,y:0}:t.position(),g=t.paddedWidth(),v=t.paddedHeight();a=r.createRadialGradient(p.x,p.y,0,p.x,p.y,Math.max(g,v))}else if(t.isEdge()){var m=t.sourceEndpoint(),y=t.targetEndpoint();a=r.createLinearGradient(m.x,m.y,y.x,y.y)}else{var b=s?{x:0,y:0}:t.position(),w=t.paddedWidth(),S=t.paddedHeight(),C=w/2,x=S/2,A=t.pstyle("background-gradient-direction").value;switch(A){case"to-bottom":a=r.createLinearGradient(b.x,b.y-x,b.x,b.y+x);break;case"to-top":a=r.createLinearGradient(b.x,b.y+x,b.x,b.y-x);break;case"to-left":a=r.createLinearGradient(b.x+C,b.y,b.x-C,b.y);break;case"to-right":a=r.createLinearGradient(b.x-C,b.y,b.x+C,b.y);break;case"to-bottom-right":case"to-right-bottom":a=r.createLinearGradient(b.x-C,b.y-x,b.x+C,b.y+x);break;case"to-top-right":case"to-right-top":a=r.createLinearGradient(b.x-C,b.y+x,b.x+C,b.y-x);break;case"to-bottom-left":case"to-left-bottom":a=r.createLinearGradient(b.x+C,b.y-x,b.x-C,b.y+x);break;case"to-top-left":case"to-left-top":a=r.createLinearGradient(b.x+C,b.y+x,b.x-C,b.y-x);break}}if(!a)return null;for(var T=l.length===o.length,D=o.length,k=0;k<D;k++)a.addColorStop(T?l[k]:k/(D-1),"rgba("+o[k][0]+","+o[k][1]+","+o[k][2]+","+i+")");return a};wr.gradientFillStyle=function(r,e,t,n){var i=this.createGradientStyleFor(r,"background",e,t,n);if(!i)return null;r.fillStyle=i};wr.colorFillStyle=function(r,e,t,n,i){r.fillStyle="rgba("+e+","+t+","+n+","+i+")"};wr.eleFillStyle=function(r,e,t){var n=e.pstyle("background-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientFillStyle(r,e,n,t);else{var i=e.pstyle("background-color").value;this.colorFillStyle(r,i[0],i[1],i[2],t)}};wr.gradientStrokeStyle=function(r,e,t,n){var i=this.createGradientStyleFor(r,"line",e,t,n);if(!i)return null;r.strokeStyle=i};wr.colorStrokeStyle=function(r,e,t,n,i){r.strokeStyle="rgba("+e+","+t+","+n+","+i+")"};wr.eleStrokeStyle=function(r,e,t){var n=e.pstyle("line-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientStrokeStyle(r,e,n,t);else{var i=e.pstyle("line-color").value;this.colorStrokeStyle(r,i[0],i[1],i[2],t)}};wr.matchCanvasSize=function(r){var e=this,t=e.data,n=e.findContainerClientCoords(),i=n[2],a=n[3],s=e.getPixelRatio(),o=e.motionBlurPxRatio;(r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]||r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG])&&(s=o);var l=i*s,u=a*s,h;if(!(l===e.canvasWidth&&u===e.canvasHeight)){e.fontCaches=null;var f=t.canvasContainer;f.style.width=i+"px",f.style.height=a+"px";for(var c=0;c<e.CANVAS_LAYERS;c++)h=t.canvases[c],h.width=l,h.height=u,h.style.width=i+"px",h.style.height=a+"px";for(var c=0;c<e.BUFFER_COUNT;c++)h=t.bufferCanvases[c],h.width=l,h.height=u,h.style.width=i+"px",h.style.height=a+"px";e.textureMult=1,s<=1&&(h=t.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,h.width=l*e.textureMult,h.height=u*e.textureMult),e.canvasWidth=l,e.canvasHeight=u,e.pixelRatio=s}};wr.renderTo=function(r,e,t,n){this.render({forcedContext:r,forcedZoom:e,forcedPan:t,drawAllLayers:!0,forcedPxRatio:n})};wr.clearCanvas=function(){var r=this,e=r.data;function t(n){n.clearRect(0,0,r.canvasWidth,r.canvasHeight)}t(e.contexts[r.NODE]),t(e.contexts[r.DRAG])};wr.render=function(r){var e=this;r=r||a2();var t=e.cy,n=r.forcedContext,i=r.drawAllLayers,a=r.drawOnlyNodeLayer,s=r.forcedZoom,o=r.forcedPan,l=r.forcedPxRatio===void 0?this.getPixelRatio():r.forcedPxRatio,u=e.data,h=u.canvasNeedsRedraw,f=e.textureOnViewport&&!n&&(e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming),c=r.motionBlur!==void 0?r.motionBlur:e.motionBlur,d=e.motionBlurPxRatio,p=t.hasCompoundNodes(),g=e.hoverData.draggingEles,v=!!(e.hoverData.selecting||e.touchData.selecting);c=c&&!n&&e.motionBlurEnabled&&!v;var m=c;n||(e.prevPxRatio!==l&&(e.invalidateContainerClientCoordsCache(),e.matchCanvasSize(e.container),e.redrawHint("eles",!0),e.redrawHint("drag",!0)),e.prevPxRatio=l),!n&&e.motionBlurTimeout&&clearTimeout(e.motionBlurTimeout),c&&(e.mbFrames==null&&(e.mbFrames=0),e.mbFrames++,e.mbFrames<3&&(m=!1),e.mbFrames>e.minMbLowQualFrames&&(e.motionBlurPxRatio=e.mbPxRBlurry)),e.clearingMotionBlur&&(e.motionBlurPxRatio=1),e.textureDrawLastFrame&&!f&&(h[e.NODE]=!0,h[e.SELECT_BOX]=!0);var y=t.style(),b=t.zoom(),w=s!==void 0?s:b,S=t.pan(),C={x:S.x,y:S.y},x={zoom:b,pan:{x:S.x,y:S.y}},A=e.prevViewport,T=A===void 0||x.zoom!==A.zoom||x.pan.x!==A.pan.x||x.pan.y!==A.pan.y;!T&&!(g&&!p)&&(e.motionBlurPxRatio=1),o&&(C=o),w*=l,C.x*=l,C.y*=l;var D=e.getCachedZSortedEles();function k(te,V,W,K,ie){var ue=te.globalCompositeOperation;te.globalCompositeOperation="destination-out",e.colorFillStyle(te,255,255,255,e.motionBlurTransparency),te.fillRect(V,W,K,ie),te.globalCompositeOperation=ue}function E(te,V){var W,K,ie,ue;!e.clearingMotionBlur&&(te===u.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]||te===u.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG])?(W={x:S.x*d,y:S.y*d},K=b*d,ie=e.canvasWidth*d,ue=e.canvasHeight*d):(W=C,K=w,ie=e.canvasWidth,ue=e.canvasHeight),te.setTransform(1,0,0,1,0,0),V==="motionBlur"?k(te,0,0,ie,ue):!n&&(V===void 0||V)&&te.clearRect(0,0,ie,ue),i||(te.translate(W.x,W.y),te.scale(K,K)),o&&te.translate(o.x,o.y),s&&te.scale(s,s)}if(f||(e.textureDrawLastFrame=!1),f){if(e.textureDrawLastFrame=!0,!e.textureCache){e.textureCache={},e.textureCache.bb=t.mutableElements().boundingBox(),e.textureCache.texture=e.data.bufferCanvases[e.TEXTURE_BUFFER];var M=e.data.bufferContexts[e.TEXTURE_BUFFER];M.setTransform(1,0,0,1,0,0),M.clearRect(0,0,e.canvasWidth*e.textureMult,e.canvasHeight*e.textureMult),e.render({forcedContext:M,drawOnlyNodeLayer:!0,forcedPxRatio:l*e.textureMult});var x=e.textureCache.viewport={zoom:t.zoom(),pan:t.pan(),width:e.canvasWidth,height:e.canvasHeight};x.mpan={x:(0-x.pan.x)/x.zoom,y:(0-x.pan.y)/x.zoom}}h[e.DRAG]=!1,h[e.NODE]=!1;var O=u.contexts[e.NODE],R=e.textureCache.texture,x=e.textureCache.viewport;O.setTransform(1,0,0,1,0,0),c?k(O,0,0,x.width,x.height):O.clearRect(0,0,x.width,x.height);var L=y.core("outside-texture-bg-color").value,I=y.core("outside-texture-bg-opacity").value;e.colorFillStyle(O,L[0],L[1],L[2],I),O.fillRect(0,0,x.width,x.height);var b=t.zoom();E(O,!1),O.clearRect(x.mpan.x,x.mpan.y,x.width/x.zoom/l,x.height/x.zoom/l),O.drawImage(R,x.mpan.x,x.mpan.y,x.width/x.zoom/l,x.height/x.zoom/l)}else e.textureOnViewport&&!n&&(e.textureCache=null);var N=t.extent(),q=e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming||e.hoverData.draggingEles||e.cy.animated(),z=e.hideEdgesOnViewport&&q,F=[];if(F[e.NODE]=!h[e.NODE]&&c&&!e.clearedForMotionBlur[e.NODE]||e.clearingMotionBlur,F[e.NODE]&&(e.clearedForMotionBlur[e.NODE]=!0),F[e.DRAG]=!h[e.DRAG]&&c&&!e.clearedForMotionBlur[e.DRAG]||e.clearingMotionBlur,F[e.DRAG]&&(e.clearedForMotionBlur[e.DRAG]=!0),h[e.NODE]||i||a||F[e.NODE]){var _=c&&!F[e.NODE]&&d!==1,O=n||(_?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]:u.contexts[e.NODE]),U=c&&!_?"motionBlur":void 0;E(O,U),z?e.drawCachedNodes(O,D.nondrag,l,N):e.drawLayeredElements(O,D.nondrag,l,N),e.debug&&e.drawDebugPoints(O,D.nondrag),!i&&!c&&(h[e.NODE]=!1)}if(!a&&(h[e.DRAG]||i||F[e.DRAG])){var _=c&&!F[e.DRAG]&&d!==1,O=n||(_?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG]:u.contexts[e.DRAG]);E(O,c&&!_?"motionBlur":void 0),z?e.drawCachedNodes(O,D.drag,l,N):e.drawCachedElements(O,D.drag,l,N),e.debug&&e.drawDebugPoints(O,D.drag),!i&&!c&&(h[e.DRAG]=!1)}if(this.drawSelectionRectangle(r,E),c&&d!==1){var X=u.contexts[e.NODE],$=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE],Q=u.contexts[e.DRAG],ee=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG],oe=function(V,W,K){V.setTransform(1,0,0,1,0,0),K||!m?V.clearRect(0,0,e.canvasWidth,e.canvasHeight):k(V,0,0,e.canvasWidth,e.canvasHeight);var ie=d;V.drawImage(W,0,0,e.canvasWidth*ie,e.canvasHeight*ie,0,0,e.canvasWidth,e.canvasHeight)};(h[e.NODE]||F[e.NODE])&&(oe(X,$,F[e.NODE]),h[e.NODE]=!1),(h[e.DRAG]||F[e.DRAG])&&(oe(Q,ee,F[e.DRAG]),h[e.DRAG]=!1)}e.prevViewport=x,e.clearingMotionBlur&&(e.clearingMotionBlur=!1,e.motionBlurCleared=!0,e.motionBlur=!0),c&&(e.motionBlurTimeout=setTimeout(function(){e.motionBlurTimeout=null,e.clearedForMotionBlur[e.NODE]=!1,e.clearedForMotionBlur[e.DRAG]=!1,e.motionBlur=!1,e.clearingMotionBlur=!f,e.mbFrames=0,h[e.NODE]=!0,h[e.DRAG]=!0,e.redraw()},I6)),n||t.emit("render")};var Ll;wr.drawSelectionRectangle=function(r,e){var t=this,n=t.cy,i=t.data,a=n.style(),s=r.drawOnlyNodeLayer,o=r.drawAllLayers,l=i.canvasNeedsRedraw,u=r.forcedContext;if(t.showFps||!s&&l[t.SELECT_BOX]&&!o){var h=u||i.contexts[t.SELECT_BOX];if(e(h),t.selection[4]==1&&(t.hoverData.selecting||t.touchData.selecting)){var f=t.cy.zoom(),c=a.core("selection-box-border-width").value/f;h.lineWidth=c,h.fillStyle="rgba("+a.core("selection-box-color").value[0]+","+a.core("selection-box-color").value[1]+","+a.core("selection-box-color").value[2]+","+a.core("selection-box-opacity").value+")",h.fillRect(t.selection[0],t.selection[1],t.selection[2]-t.selection[0],t.selection[3]-t.selection[1]),c>0&&(h.strokeStyle="rgba("+a.core("selection-box-border-color").value[0]+","+a.core("selection-box-border-color").value[1]+","+a.core("selection-box-border-color").value[2]+","+a.core("selection-box-opacity").value+")",h.strokeRect(t.selection[0],t.selection[1],t.selection[2]-t.selection[0],t.selection[3]-t.selection[1]))}if(i.bgActivePosistion&&!t.hoverData.selecting){var f=t.cy.zoom(),d=i.bgActivePosistion;h.fillStyle="rgba("+a.core("active-bg-color").value[0]+","+a.core("active-bg-color").value[1]+","+a.core("active-bg-color").value[2]+","+a.core("active-bg-opacity").value+")",h.beginPath(),h.arc(d.x,d.y,a.core("active-bg-size").pfValue/f,0,2*Math.PI),h.fill()}var p=t.lastRedrawTime;if(t.showFps&&p){p=Math.round(p);var g=Math.round(1e3/p),v="1 frame = "+p+" ms = "+g+" fps";if(h.setTransform(1,0,0,1,0,0),h.fillStyle="rgba(255, 0, 0, 0.75)",h.strokeStyle="rgba(255, 0, 0, 0.75)",h.font="30px Arial",!Ll){var m=h.measureText(v);Ll=m.actualBoundingBoxAscent}h.fillText(v,0,Ll);var y=60;h.strokeRect(0,Ll+10,250,20),h.fillRect(0,Ll+10,250*Math.min(g/y,1),20)}o||(l[t.SELECT_BOX]=!1)}};function OA(r,e,t){var n=r.createShader(e);if(r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS))throw new Error(r.getShaderInfoLog(n));return n}function N6(r,e,t){var n=OA(r,r.VERTEX_SHADER,e),i=OA(r,r.FRAGMENT_SHADER,t),a=r.createProgram();if(r.attachShader(a,n),r.attachShader(a,i),r.linkProgram(a),!r.getProgramParameter(a,r.LINK_STATUS))throw new Error("Could not initialize shaders");return a}function q6(r,e,t){t===void 0&&(t=e);var n=r.makeOffscreenCanvas(e,t),i=n.context=n.getContext("2d");return n.clear=function(){return i.clearRect(0,0,n.width,n.height)},n.clear(),n}function A0(r){var e=r.pixelRatio,t=r.cy.zoom(),n=r.cy.pan();return{zoom:t*e,pan:{x:n.x*e,y:n.y*e}}}function F6(r){var e=r.pixelRatio,t=r.cy.zoom();return t*e}function _6(r,e,t,n,i){var a=n*t+e.x,s=i*t+e.y;return s=Math.round(r.canvasHeight-s),[a,s]}function z6(r){return r.pstyle("background-fill").value!=="solid"||r.pstyle("background-image").strValue!=="none"?!1:r.pstyle("border-width").value===0||r.pstyle("border-opacity").value===0?!0:r.pstyle("border-style").value==="solid"}function V6(r,e){if(r.length!==e.length)return!1;for(var t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function Oa(r,e,t){var n=r[0]/255,i=r[1]/255,a=r[2]/255,s=e,o=t||new Array(4);return o[0]=n*s,o[1]=i*s,o[2]=a*s,o[3]=s,o}function _s(r,e){var t=e||new Array(4);return t[0]=(r>>0&255)/255,t[1]=(r>>8&255)/255,t[2]=(r>>16&255)/255,t[3]=(r>>24&255)/255,t}function H6(r){return r[0]+(r[1]<<8)+(r[2]<<16)+(r[3]<<24)}function W6(r,e){var t=r.createTexture();return t.buffer=function(n){r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_NEAREST),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null)},t.deleteTexture=function(){r.deleteTexture(t)},t}function vM(r,e){switch(e){case"float":return[1,r.FLOAT,4];case"vec2":return[2,r.FLOAT,4];case"vec3":return[3,r.FLOAT,4];case"vec4":return[4,r.FLOAT,4];case"int":return[1,r.INT,4];case"ivec2":return[2,r.INT,4]}}function mM(r,e,t){switch(e){case r.FLOAT:return new Float32Array(t);case r.INT:return new Int32Array(t)}}function G6(r,e,t,n,i,a){switch(e){case r.FLOAT:return new Float32Array(t.buffer,a*n,i);case r.INT:return new Int32Array(t.buffer,a*n,i)}}function U6(r,e,t,n){var i=vM(r,e),a=zt(i,2),s=a[0],o=a[1],l=mM(r,o,n),u=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,u),r.bufferData(r.ARRAY_BUFFER,l,r.STATIC_DRAW),o===r.FLOAT?r.vertexAttribPointer(t,s,o,!1,0,0):o===r.INT&&r.vertexAttribIPointer(t,s,o,0,0),r.enableVertexAttribArray(t),r.bindBuffer(r.ARRAY_BUFFER,null),u}function Nn(r,e,t,n){var i=vM(r,t),a=zt(i,3),s=a[0],o=a[1],l=a[2],u=mM(r,o,e*s),h=s*l,f=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,f),r.bufferData(r.ARRAY_BUFFER,e*h,r.DYNAMIC_DRAW),r.enableVertexAttribArray(n),o===r.FLOAT?r.vertexAttribPointer(n,s,o,!1,h,0):o===r.INT&&r.vertexAttribIPointer(n,s,o,h,0),r.vertexAttribDivisor(n,1),r.bindBuffer(r.ARRAY_BUFFER,null);for(var c=new Array(e),d=0;d<e;d++)c[d]=G6(r,o,u,h,s,d);return f.dataArray=u,f.stride=h,f.size=s,f.getView=function(p){return c[p]},f.setPoint=function(p,g,v){var m=c[p];m[0]=g,m[1]=v},f.bufferSubData=function(p){r.bindBuffer(r.ARRAY_BUFFER,f),p?r.bufferSubData(r.ARRAY_BUFFER,0,u,0,p*s):r.bufferSubData(r.ARRAY_BUFFER,0,u)},f}function K6(r,e,t){for(var n=9,i=new Float32Array(e*n),a=new Array(e),s=0;s<e;s++){var o=s*n*4;a[s]=new Float32Array(i.buffer,o,n)}var l=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,l),r.bufferData(r.ARRAY_BUFFER,i.byteLength,r.DYNAMIC_DRAW);for(var u=0;u<3;u++){var h=t+u;r.enableVertexAttribArray(h),r.vertexAttribPointer(h,3,r.FLOAT,!1,3*12,u*12),r.vertexAttribDivisor(h,1)}return r.bindBuffer(r.ARRAY_BUFFER,null),l.getMatrixView=function(f){return a[f]},l.setData=function(f,c){a[c].set(f,0)},l.bufferSubData=function(){r.bindBuffer(r.ARRAY_BUFFER,l),r.bufferSubData(r.ARRAY_BUFFER,0,i)},l}function j6(r){var e=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,e);var t=r.createTexture();return r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),r.bindFramebuffer(r.FRAMEBUFFER,null),e.setFramebufferAttachmentSizes=function(n,i){r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n,i,0,r.RGBA,r.UNSIGNED_BYTE,null)},e}var RA=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function By(){var r=new RA(9);return RA!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function LA(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function Y6(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],h=e[7],f=e[8],c=t[0],d=t[1],p=t[2],g=t[3],v=t[4],m=t[5],y=t[6],b=t[7],w=t[8];return r[0]=c*n+d*s+p*u,r[1]=c*i+d*o+p*h,r[2]=c*a+d*l+p*f,r[3]=g*n+v*s+m*u,r[4]=g*i+v*o+m*h,r[5]=g*a+v*l+m*f,r[6]=y*n+b*s+w*u,r[7]=y*i+b*o+w*h,r[8]=y*a+b*l+w*f,r}function fc(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],h=e[7],f=e[8],c=t[0],d=t[1];return r[0]=n,r[1]=i,r[2]=a,r[3]=s,r[4]=o,r[5]=l,r[6]=c*n+d*s+u,r[7]=c*i+d*o+h,r[8]=c*a+d*l+f,r}function IA(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],h=e[7],f=e[8],c=Math.sin(t),d=Math.cos(t);return r[0]=d*n+c*s,r[1]=d*i+c*o,r[2]=d*a+c*l,r[3]=d*s-c*n,r[4]=d*o-c*i,r[5]=d*l-c*a,r[6]=u,r[7]=h,r[8]=f,r}function Jy(r,e,t){var n=t[0],i=t[1];return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=i*e[3],r[4]=i*e[4],r[5]=i*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function X6(r,e,t){return r[0]=2/e,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/t,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r}var $6=function(){function r(e,t,n,i){Gi(this,r),this.debugID=Math.floor(Math.random()*1e4),this.r=e,this.texSize=t,this.texRows=n,this.texHeight=Math.floor(t/n),this.enableWrapping=!0,this.locked=!1,this.texture=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=i(e,t,t),this.scratch=i(e,t,this.texHeight,"scratch")}return Ui(r,[{key:"lock",value:function(){this.locked=!0}},{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(t){var n=t.w,i=t.h,a=this.texHeight,s=this.texSize,o=a/i,l=n*o,u=i*o;return l>s&&(o=s/n,l=n*o,u=i*o),{scale:o,texW:l,texH:u}}},{key:"draw",value:function(t,n,i){var a=this;if(this.locked)throw new Error("can't draw, atlas is locked");var s=this.texSize,o=this.texRows,l=this.texHeight,u=this.getScale(n),h=u.scale,f=u.texW,c=u.texH,d=function(b,w){if(i&&w){var S=w.context,C=b.x,x=b.row,A=C,T=l*x;S.save(),S.translate(A,T),S.scale(h,h),i(S,n),S.restore()}},p=[null,null],g=function(){d(a.freePointer,a.canvas),p[0]={x:a.freePointer.x,y:a.freePointer.row*l,w:f,h:c},p[1]={x:a.freePointer.x+f,y:a.freePointer.row*l,w:0,h:c},a.freePointer.x+=f,a.freePointer.x==s&&(a.freePointer.x=0,a.freePointer.row++)},v=function(){var b=a.scratch,w=a.canvas;b.clear(),d({x:0,row:0},b);var S=s-a.freePointer.x,C=f-S,x=l;{var A=a.freePointer.x,T=a.freePointer.row*l,D=S;w.context.drawImage(b,0,0,D,x,A,T,D,x),p[0]={x:A,y:T,w:D,h:c}}{var k=S,E=(a.freePointer.row+1)*l,M=C;w&&w.context.drawImage(b,k,0,M,x,0,E,M,x),p[1]={x:0,y:E,w:M,h:c}}a.freePointer.x=C,a.freePointer.row++},m=function(){a.freePointer.x=0,a.freePointer.row++};if(this.freePointer.x+f<=s)g();else{if(this.freePointer.row>=o-1)return!1;this.freePointer.x===s?(m(),g()):this.enableWrapping?v():(m(),g())}return this.keyToLocation.set(t,p),this.needsBuffer=!0,p}},{key:"getOffsets",value:function(t){return this.keyToLocation.get(t)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(t){if(this.locked)return!1;var n=this.texSize,i=this.texRows,a=this.getScale(t),s=a.texW;return this.freePointer.x+s>n?this.freePointer.row<i-1:!0}},{key:"bufferIfNeeded",value:function(t){this.texture||(this.texture=W6(t,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1,this.locked&&(this.canvas=null,this.scratch=null))}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null),this.canvas=null,this.scratch=null,this.locked=!0}}])}(),Z6=function(){function r(e,t,n,i){Gi(this,r),this.r=e,this.texSize=t,this.texRows=n,this.createTextureCanvas=i,this.atlases=[],this.styleKeyToAtlas=new Map,this.markedKeys=new Set}return Ui(r,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function(){var t=this.r,n=this.texSize,i=this.texRows,a=this.createTextureCanvas;return new $6(t,n,i,a)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var t=this.r,n=this.texSize,i=this.texRows,a=this.createTextureCanvas,s=Math.floor(n/i);this.scratch=a(t,n,s,"scratch")}return this.scratch}},{key:"draw",value:function(t,n,i){var a=this.styleKeyToAtlas.get(t);return a||(a=this.atlases[this.atlases.length-1],(!a||!a.canFit(n))&&(a&&a.lock(),a=this._createAtlas(),this.atlases.push(a)),a.draw(t,n,i),this.styleKeyToAtlas.set(t,a)),a}},{key:"getAtlas",value:function(t){return this.styleKeyToAtlas.get(t)}},{key:"hasAtlas",value:function(t){return this.styleKeyToAtlas.has(t)}},{key:"markKeyForGC",value:function(t){this.markedKeys.add(t)}},{key:"gc",value:function(){var t=this,n=this.markedKeys;if(n.size===0){console.log("nothing to garbage collect");return}var i=[],a=new Map,s=null,o=Lr(this.atlases),l;try{var u=function(){var f=l.value,c=f.getKeys(),d=Q6(n,c);if(d.size===0)return i.push(f),c.forEach(function(S){return a.set(S,f)}),1;s||(s=t._createAtlas(),i.push(s));var p=Lr(c),g;try{for(p.s();!(g=p.n()).done;){var v=g.value;if(!d.has(v)){var m=f.getOffsets(v),y=zt(m,2),b=y[0],w=y[1];s.canFit({w:b.w+w.w,h:b.h})||(s.lock(),s=t._createAtlas(),i.push(s)),f.canvas&&(t._copyTextureToNewAtlas(v,f,s),a.set(v,s))}}}catch(S){p.e(S)}finally{p.f()}f.dispose()};for(o.s();!(l=o.n()).done;)u()}catch(h){o.e(h)}finally{o.f()}this.atlases=i,this.styleKeyToAtlas=a,this.markedKeys=new Set}},{key:"_copyTextureToNewAtlas",value:function(t,n,i){var a=n.getOffsets(t),s=zt(a,2),o=s[0],l=s[1];if(l.w===0)i.draw(t,o,function(c){c.drawImage(n.canvas,o.x,o.y,o.w,o.h,0,0,o.w,o.h)});else{var u=this._getScratchCanvas();u.clear(),u.context.drawImage(n.canvas,o.x,o.y,o.w,o.h,0,0,o.w,o.h),u.context.drawImage(n.canvas,l.x,l.y,l.w,l.h,o.w,0,l.w,l.h);var h=o.w+l.w,f=o.h;i.draw(t,{w:h,h:f},function(c){c.drawImage(u,0,0,h,f,0,0,h,f)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}])}();function Q6(r,e){return r.intersection?r.intersection(e):new Set(cc(r).filter(function(t){return e.has(t)}))}var J6=function(){function r(e,t){Gi(this,r),this.r=e,this.globalOptions=t,this.atlasSize=t.webglTexSize,this.maxAtlasesPerBatch=t.webglTexPerBatch,this.renderTypes=new Map,this.collections=new Map,this.typeAndIdToKey=new Map}return Ui(r,[{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"addAtlasCollection",value:function(t,n){var i=this.globalOptions,a=i.webglTexSize,s=i.createTextureCanvas,o=n.texRows,l=this._cacheScratchCanvas(s),u=new Z6(this.r,a,o,l);this.collections.set(t,u)}},{key:"addRenderType",value:function(t,n){var i=n.collection;if(!this.collections.has(i))throw new Error("invalid atlas collection name '".concat(i,"'"));var a=this.collections.get(i),s=Ce({type:t,atlasCollection:a},n);this.renderTypes.set(t,s)}},{key:"getRenderTypeOpts",value:function(t){return this.renderTypes.get(t)}},{key:"getAtlasCollection",value:function(t){return this.collections.get(t)}},{key:"_cacheScratchCanvas",value:function(t){var n=-1,i=-1,a=null;return function(s,o,l,u){return u?((!a||o!=n||l!=i)&&(n=o,i=l,a=t(s,o,l)),a):t(s,o,l)}}},{key:"_key",value:function(t,n){return"".concat(t,"-").concat(n)}},{key:"invalidate",value:function(t){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=i.forceRedraw,s=a===void 0?!1:a,o=i.filterEle,l=o===void 0?function(){return!0}:o,u=i.filterType,h=u===void 0?function(){return!0}:u,f=!1,c=!1,d=Lr(t),p;try{for(d.s();!(p=d.n()).done;){var g=p.value;if(l(g)){var v=Lr(this.renderTypes.values()),m;try{var y=function(){var w=m.value,S=w.type;if(h(S)){var C=n.collections.get(w.collection),x=w.getKey(g),A=Array.isArray(x)?x:[x];if(s)A.forEach(function(E){return C.markKeyForGC(E)}),c=!0;else{var T=w.getID?w.getID(g):g.id(),D=n._key(S,T),k=n.typeAndIdToKey.get(D);k!==void 0&&!V6(A,k)&&(f=!0,n.typeAndIdToKey.delete(D),k.forEach(function(E){return C.markKeyForGC(E)}))}}};for(v.s();!(m=v.n()).done;)y()}catch(b){v.e(b)}finally{v.f()}}}}catch(b){d.e(b)}finally{d.f()}return c&&(this.gc(),f=!1),f}},{key:"gc",value:function(){var t=Lr(this.collections.values()),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;i.gc()}}catch(a){t.e(a)}finally{t.f()}}},{key:"getOrCreateAtlas",value:function(t,n,i,a){var s=this.renderTypes.get(n),o=this.collections.get(s.collection),l=!1,u=o.draw(a,i,function(c){s.drawClipped?(c.save(),c.beginPath(),c.rect(0,0,i.w,i.h),c.clip(),s.drawElement(c,t,i,!0,!0),c.restore()):s.drawElement(c,t,i,!0,!0),l=!0});if(l){var h=s.getID?s.getID(t):t.id(),f=this._key(n,h);this.typeAndIdToKey.has(f)?this.typeAndIdToKey.get(f).push(a):this.typeAndIdToKey.set(f,[a])}return u}},{key:"getAtlasInfo",value:function(t,n){var i=this,a=this.renderTypes.get(n),s=a.getKey(t),o=Array.isArray(s)?s:[s];return o.map(function(l){var u=a.getBoundingBox(t,l),h=i.getOrCreateAtlas(t,n,u,l),f=h.getOffsets(l),c=zt(f,2),d=c[0],p=c[1];return{atlas:h,tex:d,tex1:d,tex2:p,bb:u}})}},{key:"getDebugInfo",value:function(){var t=[],n=Lr(this.collections),i;try{for(n.s();!(i=n.n()).done;){var a=zt(i.value,2),s=a[0],o=a[1],l=o.getCounts(),u=l.keyCount,h=l.atlasCount;t.push({type:s,keyCount:u,atlasCount:h})}}catch(f){n.e(f)}finally{n.f()}return t}}])}(),ej=function(){function r(e){Gi(this,r),this.globalOptions=e,this.atlasSize=e.webglTexSize,this.maxAtlasesPerBatch=e.webglTexPerBatch,this.batchAtlases=[]}return Ui(r,[{key:"getMaxAtlasesPerBatch",value:function(){return this.maxAtlasesPerBatch}},{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlasesPerBatch},function(t,n){return n})}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function(t){return this.batchAtlases.length===this.maxAtlasesPerBatch?this.batchAtlases.includes(t):!0}},{key:"getAtlasIndexForBatch",value:function(t){var n=this.batchAtlases.indexOf(t);if(n<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)throw new Error("cannot add more atlases to batch");this.batchAtlases.push(t),n=this.batchAtlases.length-1}return n}}])}(),tj=`
  float circleSD(vec2 p, float r) {
    return distance(vec2(0), p) - r; // signed distance
  }
`,rj=`
  float rectangleSD(vec2 p, vec2 b) {
    vec2 d = abs(p)-b;
    return distance(vec2(0),max(d,0.0)) + min(max(d.x,d.y),0.0);
  }
`,nj=`
  float roundRectangleSD(vec2 p, vec2 b, vec4 cr) {
    cr.xy = (p.x > 0.0) ? cr.xy : cr.zw;
    cr.x  = (p.y > 0.0) ? cr.x  : cr.y;
    vec2 q = abs(p) - b + cr.x;
    return min(max(q.x, q.y), 0.0) + distance(vec2(0), max(q, 0.0)) - cr.x;
  }
`,ij=`
  float ellipseSD(vec2 p, vec2 ab) {
    p = abs( p ); // symmetry

    // find root with Newton solver
    vec2 q = ab*(p-ab);
    float w = (q.x<q.y)? 1.570796327 : 0.0;
    for( int i=0; i<5; i++ ) {
      vec2 cs = vec2(cos(w),sin(w));
      vec2 u = ab*vec2( cs.x,cs.y);
      vec2 v = ab*vec2(-cs.y,cs.x);
      w = w + dot(p-u,v)/(dot(p-u,u)+dot(v,v));
    }
    
    // compute final point and distance
    float d = length(p-ab*vec2(cos(w),sin(w)));
    
    // return signed distance
    return (dot(p/ab,p/ab)>1.0) ? d : -d;
  }
`,Hl={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},kc={IGNORE:1,USE_BB:2},Oy=0,NA=1,qA=2,Ry=3,zs=4,ec=5,Il=6,Nl=7,aj=function(){function r(e,t,n){Gi(this,r),this.r=e,this.gl=t,this.maxInstances=n.webglBatchSize,this.atlasSize=n.webglTexSize,this.bgColor=n.bgColor,this.debug=n.webglDebug,this.batchDebugInfo=[],n.enableWrapping=!0,n.createTextureCanvas=q6,this.atlasManager=new J6(e,n),this.batchManager=new ej(n),this.simpleShapeOptions=new Map,this.program=this._createShaderProgram(Hl.SCREEN),this.pickingProgram=this._createShaderProgram(Hl.PICKING),this.vao=this._createVAO()}return Ui(r,[{key:"addAtlasCollection",value:function(t,n){this.atlasManager.addAtlasCollection(t,n)}},{key:"addTextureAtlasRenderType",value:function(t,n){this.atlasManager.addRenderType(t,n)}},{key:"addSimpleShapeRenderType",value:function(t,n){this.simpleShapeOptions.set(t,n)}},{key:"invalidate",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.type,a=this.atlasManager;return i?a.invalidate(t,{filterType:function(o){return o===i},forceRedraw:!0}):a.invalidate(t)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"_createShaderProgram",value:function(t){var n=this.gl,i=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; // a vertex from the unit square
      
      in mat3 aTransform; // used to transform verticies, eg into a bounding box
      in int aVertType; // the type of thing we are rendering

      // the z-index that is output when using picking mode
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex; // x/y/w/h of texture in atlas

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in vec2 aLineWidth; // also used for node border width

      // simple shapes
      in vec4 aCornerRadius; // for round-rectangle [top-right, bottom-right, top-left, bottom-left]
      in vec4 aColor; // also used for edges
      in vec4 aBorderColor; // aLineWidth is used for border width

      // output values passed to the fragment shader
      out vec2 vTexCoord;
      out vec4 vColor;
      out vec2 vPosition;
      // flat values are not interpolated
      flat out int vAtlasId; 
      flat out int vVertType;
      flat out vec2 vTopRight;
      flat out vec2 vBotLeft;
      flat out vec4 vCornerRadius;
      flat out vec4 vBorderColor;
      flat out vec2 vBorderWidth;
      flat out vec4 vIndex;
      
      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition; // TODO make this a vec3, simplifies some code below

        if(aVertType == `.concat(Oy,`) {
          float texX = aTex.x; // texture coordinates
          float texY = aTex.y;
          float texW = aTex.z;
          float texH = aTex.w;

          if(vid == 1 || vid == 2 || vid == 4) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(zs," || aVertType == ").concat(Nl,` 
             || aVertType == `).concat(ec," || aVertType == ").concat(Il,`) { // simple shapes

          // the bounding box is needed by the fragment shader
          vBotLeft  = (aTransform * vec3(0, 0, 1)).xy; // flat
          vTopRight = (aTransform * vec3(1, 1, 1)).xy; // flat
          vPosition = (aTransform * vec3(position, 1)).xy; // will be interpolated

          // calculations are done in the fragment shader, just pass these along
          vColor = aColor;
          vCornerRadius = aCornerRadius;
          vBorderColor = aBorderColor;
          vBorderWidth = aLineWidth;

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(NA,`) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          // stretch the unit square into a long skinny rectangle
          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth[0] * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vColor = aColor;
        } 
        else if(aVertType == `).concat(qA,`) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0, p1, p2, pos;
          if(position.x == 0.0) { // The left side of the unit square
            p0 = pointA;
            p1 = pointB;
            p2 = pointC;
            pos = position;
          } else { // The right side of the unit square, use same approach but flip the geometry upside down
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth[0];

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vColor = aColor;
        } 
        else if(aVertType == `).concat(Ry,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2(  0.0,  0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
          vColor = aColor;
        }
        else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vVertType = aVertType;
        vIndex = aIndex;
      }
    `),a=this.batchManager.getIndexArray(),s=`#version 300 es
      precision highp float;

      // declare texture unit for each texture atlas in the batch
      `.concat(a.map(function(u){return"uniform sampler2D uTexture".concat(u,";")}).join(`
	`),`

      uniform vec4 uBGColor;
      uniform float uZoom;

      in vec2 vTexCoord;
      in vec4 vColor;
      in vec2 vPosition; // model coordinates

      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;
      flat in vec2 vTopRight;
      flat in vec2 vBotLeft;
      flat in vec4 vCornerRadius;
      flat in vec4 vBorderColor;
      flat in vec2 vBorderWidth;

      out vec4 outColor;

      `).concat(tj,`
      `).concat(rj,`
      `).concat(nj,`
      `).concat(ij,`

      vec4 blend(vec4 top, vec4 bot) { // blend colors with premultiplied alpha
        return vec4( 
          top.rgb + (bot.rgb * (1.0 - top.a)),
          top.a   + (bot.a   * (1.0 - top.a)) 
        );
      }

      vec4 distInterp(vec4 cA, vec4 cB, float d) { // interpolate color using Signed Distance
        // scale to the zoom level so that borders don't look blurry when zoomed in
        // note 1.5 is an aribitrary value chosen because it looks good
        return mix(cA, cB, 1.0 - smoothstep(0.0, 1.5 / uZoom, abs(d))); 
      }

      void main(void) {
        if(vVertType == `).concat(Oy,`) {
          // look up the texel from the texture unit
          `).concat(a.map(function(u){return"if(vAtlasId == ".concat(u,") outColor = texture(uTexture").concat(u,", vTexCoord);")}).join(`
	else `),`
        } 
        else if(vVertType == `).concat(Ry,`) {
          // mimics how canvas renderer uses context.globalCompositeOperation = 'destination-out';
          outColor = blend(vColor, uBGColor);
          outColor.a = 1.0; // make opaque, masks out line under arrow
        }
        else if(vVertType == `).concat(zs,` && vBorderWidth == vec2(0.0)) { // simple rectangle with no border
          outColor = vColor; // unit square is already transformed to the rectangle, nothing else needs to be done
        }
        else if(vVertType == `).concat(zs," || vVertType == ").concat(Nl,` 
          || vVertType == `).concat(ec," || vVertType == ").concat(Il,`) { // use SDF

          float outerBorder = vBorderWidth[0];
          float innerBorder = vBorderWidth[1];
          float borderPadding = outerBorder * 2.0;
          float w = vTopRight.x - vBotLeft.x - borderPadding;
          float h = vTopRight.y - vBotLeft.y - borderPadding;
          vec2 b = vec2(w/2.0, h/2.0); // half width, half height
          vec2 p = vPosition - vec2(vTopRight.x - b[0] - outerBorder, vTopRight.y - b[1] - outerBorder); // translate to center

          float d; // signed distance
          if(vVertType == `).concat(zs,`) {
            d = rectangleSD(p, b);
          } else if(vVertType == `).concat(Nl,` && w == h) {
            d = circleSD(p, b.x); // faster than ellipse
          } else if(vVertType == `).concat(Nl,`) {
            d = ellipseSD(p, b);
          } else {
            d = roundRectangleSD(p, b, vCornerRadius.wzyx);
          }

          // use the distance to interpolate a color to smooth the edges of the shape, doesn't need multisampling
          // we must smooth colors inwards, because we can't change pixels outside the shape's bounding box
          if(d > 0.0) {
            if(d > outerBorder) {
              discard;
            } else {
              outColor = distInterp(vBorderColor, vec4(0), d - outerBorder);
            }
          } else {
            if(d > innerBorder) {
              vec4 outerColor = outerBorder == 0.0 ? vec4(0) : vBorderColor;
              vec4 innerBorderColor = blend(vBorderColor, vColor);
              outColor = distInterp(innerBorderColor, outerColor, d);
            } 
            else {
              vec4 outerColor;
              if(innerBorder == 0.0 && outerBorder == 0.0) {
                outerColor = vec4(0);
              } else if(innerBorder == 0.0) {
                outerColor = vBorderColor;
              } else {
                outerColor = blend(vBorderColor, vColor);
              }
              outColor = distInterp(vColor, outerColor, d - innerBorder);
            }
          }
        }
        else {
          outColor = vColor;
        }

        `).concat(t.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),o=N6(n,i,s);o.aPosition=n.getAttribLocation(o,"aPosition"),o.aIndex=n.getAttribLocation(o,"aIndex"),o.aVertType=n.getAttribLocation(o,"aVertType"),o.aTransform=n.getAttribLocation(o,"aTransform"),o.aAtlasId=n.getAttribLocation(o,"aAtlasId"),o.aTex=n.getAttribLocation(o,"aTex"),o.aPointAPointB=n.getAttribLocation(o,"aPointAPointB"),o.aPointCPointD=n.getAttribLocation(o,"aPointCPointD"),o.aLineWidth=n.getAttribLocation(o,"aLineWidth"),o.aColor=n.getAttribLocation(o,"aColor"),o.aCornerRadius=n.getAttribLocation(o,"aCornerRadius"),o.aBorderColor=n.getAttribLocation(o,"aBorderColor"),o.uPanZoomMatrix=n.getUniformLocation(o,"uPanZoomMatrix"),o.uAtlasSize=n.getUniformLocation(o,"uAtlasSize"),o.uBGColor=n.getUniformLocation(o,"uBGColor"),o.uZoom=n.getUniformLocation(o,"uZoom"),o.uTextures=[];for(var l=0;l<this.batchManager.getMaxAtlasesPerBatch();l++)o.uTextures.push(n.getUniformLocation(o,"uTexture".concat(l)));return o}},{key:"_createVAO",value:function(){var t=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=t.length/2;var n=this.maxInstances,i=this.gl,a=this.program,s=i.createVertexArray();return i.bindVertexArray(s),U6(i,"vec2",a.aPosition,t),this.transformBuffer=K6(i,n,a.aTransform),this.indexBuffer=Nn(i,n,"vec4",a.aIndex),this.vertTypeBuffer=Nn(i,n,"int",a.aVertType),this.atlasIdBuffer=Nn(i,n,"int",a.aAtlasId),this.texBuffer=Nn(i,n,"vec4",a.aTex),this.pointAPointBBuffer=Nn(i,n,"vec4",a.aPointAPointB),this.pointCPointDBuffer=Nn(i,n,"vec4",a.aPointCPointD),this.lineWidthBuffer=Nn(i,n,"vec2",a.aLineWidth),this.colorBuffer=Nn(i,n,"vec4",a.aColor),this.cornerRadiusBuffer=Nn(i,n,"vec4",a.aCornerRadius),this.borderColorBuffer=Nn(i,n,"vec4",a.aBorderColor),i.bindVertexArray(null),s}},{key:"buffers",get:function(){var t=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(n){return n.endsWith("Buffer")}).map(function(n){return t[n]})),this._buffers}},{key:"startFrame",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Hl.SCREEN;this.panZoomMatrix=t,this.renderTarget=n,this.batchDebugInfo=[],this.wrappedCount=0,this.simpleCount=0,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.batchManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"_isVisible",value:function(t,n){return t.visible()?n&&n.isVisible?n.isVisible(t):!0:!1}},{key:"drawTexture",value:function(t,n,i){var a=this.atlasManager,s=this.batchManager,o=a.getRenderTypeOpts(i);if(this._isVisible(t,o)){if(this.renderTarget.picking&&o.getTexPickingMode){var l=o.getTexPickingMode(t);if(l===kc.IGNORE)return;if(l==kc.USE_BB){this.drawPickingRectangle(t,n,i);return}}var u=a.getAtlasInfo(t,i),h=Lr(u),f;try{for(h.s();!(f=h.n()).done;){var c=f.value,d=c.atlas,p=c.tex1,g=c.tex2;s.canAddToCurrentBatch(d)||this.endBatch();for(var v=s.getAtlasIndexForBatch(d),m=0,y=[[p,!0],[g,!1]];m<y.length;m++){var b=zt(y[m],2),w=b[0],S=b[1];if(w.w!=0){var C=this.instanceCount;this.vertTypeBuffer.getView(C)[0]=Oy;var x=this.indexBuffer.getView(C);_s(n,x);var A=this.atlasIdBuffer.getView(C);A[0]=v;var T=this.texBuffer.getView(C);T[0]=w.x,T[1]=w.y,T[2]=w.w,T[3]=w.h;var D=this.transformBuffer.getMatrixView(C);this.setTransformMatrix(t,D,o,c,S),this.instanceCount++,S||this.wrappedCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}catch(k){h.e(k)}finally{h.f()}}}},{key:"setTransformMatrix",value:function(t,n,i,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=0;if(i.shapeProps&&i.shapeProps.padding&&(o=t.pstyle(i.shapeProps.padding).pfValue),a){var l=a.bb,u=a.tex1,h=a.tex2,f=u.w/(u.w+h.w);s||(f=1-f);var c=this._getAdjustedBB(l,o,s,f);this._applyTransformMatrix(n,c,i,t)}else{var d=i.getBoundingBox(t),p=this._getAdjustedBB(d,o,!0,1);this._applyTransformMatrix(n,p,i,t)}}},{key:"_applyTransformMatrix",value:function(t,n,i,a){var s,o;LA(t);var l=i.getRotation?i.getRotation(a):0;if(l!==0){var u=i.getRotationPoint(a),h=u.x,f=u.y;fc(t,t,[h,f]),IA(t,t,l);var c=i.getRotationOffset(a);s=c.x+(n.xOffset||0),o=c.y+(n.yOffset||0)}else s=n.x1,o=n.y1;fc(t,t,[s,o]),Jy(t,t,[n.w,n.h])}},{key:"_getAdjustedBB",value:function(t,n,i,a){var s=t.x1,o=t.y1,l=t.w,u=t.h,h=t.yOffset;n&&(s-=n,o-=n,l+=2*n,u+=2*n);var f=0,c=l*a;return i&&a<1?l=c:!i&&a<1&&(f=l-c,s+=f,l=c),{x1:s,y1:o,w:l,h:u,xOffset:f,yOffset:h}}},{key:"drawPickingRectangle",value:function(t,n,i){var a=this.atlasManager.getRenderTypeOpts(i),s=this.instanceCount;this.vertTypeBuffer.getView(s)[0]=zs;var o=this.indexBuffer.getView(s);_s(n,o);var l=this.colorBuffer.getView(s);Oa([0,0,0],1,l);var u=this.transformBuffer.getMatrixView(s);this.setTransformMatrix(t,u,a),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawNode",value:function(t,n,i){var a=this.simpleShapeOptions.get(i);if(this._isVisible(t,a)){var s=a.shapeProps,o=this._getVertTypeForShape(t,s.shape);if(o===void 0||a.isSimple&&!a.isSimple(t)){this.drawTexture(t,n,i);return}var l=this.instanceCount;if(this.vertTypeBuffer.getView(l)[0]=o,o===ec||o===Il){var u=a.getBoundingBox(t),h=this._getCornerRadius(t,s.radius,u),f=this.cornerRadiusBuffer.getView(l);f[0]=h,f[1]=h,f[2]=h,f[3]=h,o===Il&&(f[0]=0,f[2]=0)}var c=this.indexBuffer.getView(l);_s(n,c);var d=t.pstyle(s.color).value,p=t.pstyle(s.opacity).value,g=this.colorBuffer.getView(l);Oa(d,p,g);var v=this.lineWidthBuffer.getView(l);if(v[0]=0,v[1]=0,s.border){var m=t.pstyle("border-width").value;if(m>0){var y=t.pstyle("border-color").value,b=t.pstyle("border-opacity").value,w=this.borderColorBuffer.getView(l);Oa(y,b,w);var S=t.pstyle("border-position").value;if(S==="inside")v[0]=0,v[1]=-m;else if(S==="outside")v[0]=m,v[1]=0;else{var C=m/2;v[0]=C,v[1]=-C}}}var x=this.transformBuffer.getMatrixView(l);this.setTransformMatrix(t,x,a),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"_getVertTypeForShape",value:function(t,n){var i=t.pstyle(n).value;switch(i){case"rectangle":return zs;case"ellipse":return Nl;case"roundrectangle":case"round-rectangle":return ec;case"bottom-round-rectangle":return Il;default:return}}},{key:"_getCornerRadius",value:function(t,n,i){var a=i.w,s=i.h;if(t.pstyle(n).value==="auto")return zi(a,s);var o=t.pstyle(n).pfValue,l=a/2,u=s/2;return Math.min(o,u,l)}},{key:"drawEdgeArrow",value:function(t,n,i){if(t.visible()){var a=t._private.rscratch,s,o,l;if(i==="source"?(s=a.arrowStartX,o=a.arrowStartY,l=a.srcArrowAngle):(s=a.arrowEndX,o=a.arrowEndY,l=a.tgtArrowAngle),!(isNaN(s)||s==null||isNaN(o)||o==null||isNaN(l)||l==null)){var u=t.pstyle(i+"-arrow-shape").value;if(u!=="none"){var h=t.pstyle(i+"-arrow-color").value,f=t.pstyle("opacity").value,c=t.pstyle("line-opacity").value,d=f*c,p=t.pstyle("width").pfValue,g=t.pstyle("arrow-scale").value,v=this.r.getArrowWidth(p,g),m=this.instanceCount,y=this.transformBuffer.getMatrixView(m);LA(y),fc(y,y,[s,o]),Jy(y,y,[v,v]),IA(y,y,l),this.vertTypeBuffer.getView(m)[0]=Ry;var b=this.indexBuffer.getView(m);_s(n,b);var w=this.colorBuffer.getView(m);Oa(h,d,w),this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"drawEdgeLine",value:function(t,n){if(t.visible()){var i=this._getEdgePoints(t);if(i){var a=t.pstyle("opacity").value,s=t.pstyle("line-opacity").value,o=t.pstyle("width").pfValue,l=t.pstyle("line-color").value,u=a*s;if(i.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),i.length==4){var h=this.instanceCount;this.vertTypeBuffer.getView(h)[0]=NA;var f=this.indexBuffer.getView(h);_s(n,f);var c=this.colorBuffer.getView(h);Oa(l,u,c);var d=this.lineWidthBuffer.getView(h);d[0]=o;var p=this.pointAPointBBuffer.getView(h);p[0]=i[0],p[1]=i[1],p[2]=i[2],p[3]=i[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var g=0;g<i.length-2;g+=2){var v=this.instanceCount;this.vertTypeBuffer.getView(v)[0]=qA;var m=this.indexBuffer.getView(v);_s(n,m);var y=this.colorBuffer.getView(v);Oa(l,u,y);var b=this.lineWidthBuffer.getView(v);b[0]=o;var w=i[g-2],S=i[g-1],C=i[g],x=i[g+1],A=i[g+2],T=i[g+3],D=i[g+4],k=i[g+5];g==0&&(w=2*C-A+.001,S=2*x-T+.001),g==i.length-4&&(D=2*A-C+.001,k=2*T-x+.001);var E=this.pointAPointBBuffer.getView(v);E[0]=w,E[1]=S,E[2]=C,E[3]=x;var M=this.pointCPointDBuffer.getView(v);M[0]=A,M[1]=T,M[2]=D,M[3]=k,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"_getEdgePoints",value:function(t){var n=t._private.rscratch;if(!(n.badLine||n.allpts==null||isNaN(n.allpts[0]))){var i=n.allpts;if(i.length==4)return i;var a=this._getNumSegments(t);return this._getCurveSegmentPoints(i,a)}}},{key:"_getNumSegments",value:function(t){var n=15;return Math.min(Math.max(n,5),this.maxInstances)}},{key:"_getCurveSegmentPoints",value:function(t,n){if(t.length==4)return t;for(var i=Array((n+1)*2),a=0;a<=n;a++)if(a==0)i[0]=t[0],i[1]=t[1];else if(a==n)i[a*2]=t[t.length-2],i[a*2+1]=t[t.length-1];else{var s=a/n;this._setCurvePoint(t,s,i,a*2)}return i}},{key:"_setCurvePoint",value:function(t,n,i,a){if(t.length<=2)i[a]=t[0],i[a+1]=t[1];else{for(var s=Array(t.length-2),o=0;o<s.length;o+=2){var l=(1-n)*t[o]+n*t[o+2],u=(1-n)*t[o+1]+n*t[o+3];s[o]=l,s[o+1]=u}return this._setCurvePoint(s,n,i,a)}}},{key:"endBatch",value:function(){var t=this.gl,n=this.vao,i=this.vertexCount,a=this.instanceCount;if(a!==0){var s=this.renderTarget.picking?this.pickingProgram:this.program;t.useProgram(s),t.bindVertexArray(n);var o=Lr(this.buffers),l;try{for(o.s();!(l=o.n()).done;){var u=l.value;u.bufferSubData(a)}}catch(p){o.e(p)}finally{o.f()}for(var h=this.batchManager.getAtlases(),f=0;f<h.length;f++)h[f].bufferIfNeeded(t);for(var c=0;c<h.length;c++)t.activeTexture(t.TEXTURE0+c),t.bindTexture(t.TEXTURE_2D,h[c].texture),t.uniform1i(s.uTextures[c],c);t.uniform1f(s.uZoom,F6(this.r)),t.uniformMatrix3fv(s.uPanZoomMatrix,!1,this.panZoomMatrix),t.uniform1i(s.uAtlasSize,this.batchManager.getAtlasSize());var d=Oa(this.bgColor,1);t.uniform4fv(s.uBGColor,d),t.drawArraysInstanced(t.TRIANGLES,0,i,a),t.bindVertexArray(null),t.bindTexture(t.TEXTURE_2D,null),this.debug&&this.batchDebugInfo.push({count:a,atlasCount:h.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){var t=this.atlasManager.getDebugInfo(),n=t.reduce(function(s,o){return s+o.atlasCount},0),i=this.batchDebugInfo,a=i.reduce(function(s,o){return s+o.count},0);return{atlasInfo:t,totalAtlases:n,wrappedCount:this.wrappedCount,simpleCount:this.simpleCount,batchCount:i.length,batchInfo:i,totalInstances:a}}}])}(),yM={};yM.initWebgl=function(r,e){var t=this,n=t.data.contexts[t.WEBGL];r.bgColor=sj(t),r.webglTexSize=Math.min(r.webglTexSize,n.getParameter(n.MAX_TEXTURE_SIZE)),r.webglTexRows=Math.min(r.webglTexRows,54),r.webglTexRowsNodes=Math.min(r.webglTexRowsNodes,54),r.webglBatchSize=Math.min(r.webglBatchSize,16384),r.webglTexPerBatch=Math.min(r.webglTexPerBatch,n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),t.webglDebug=r.webglDebug,t.webglDebugShowAtlases=r.webglDebugShowAtlases,t.pickingFrameBuffer=j6(n),t.pickingFrameBuffer.needsDraw=!0,t.drawing=new aj(t,n,r);var i=function(f){return function(c){return t.getTextAngle(c,f)}},a=function(f){return function(c){var d=c.pstyle(f);return d&&d.value}},s=function(f){return function(c){return c.pstyle("".concat(f,"-opacity")).value>0}},o=function(f){var c=f.pstyle("text-events").strValue==="yes";return c?kc.USE_BB:kc.IGNORE},l=function(f){var c=f.position(),d=c.x,p=c.y,g=f.outerWidth(),v=f.outerHeight();return{w:g,h:v,x1:d-g/2,y1:p-v/2}};t.drawing.addAtlasCollection("node",{texRows:r.webglTexRowsNodes}),t.drawing.addAtlasCollection("label",{texRows:r.webglTexRows}),t.drawing.addTextureAtlasRenderType("node-body",{collection:"node",getKey:e.getStyleKey,getBoundingBox:e.getElementBox,drawElement:e.drawElement}),t.drawing.addSimpleShapeRenderType("node-body",{getBoundingBox:l,isSimple:z6,shapeProps:{shape:"shape",color:"background-color",opacity:"background-opacity",radius:"corner-radius",border:!0}}),t.drawing.addSimpleShapeRenderType("node-overlay",{getBoundingBox:l,isVisible:s("overlay"),shapeProps:{shape:"overlay-shape",color:"overlay-color",opacity:"overlay-opacity",padding:"overlay-padding",radius:"overlay-corner-radius"}}),t.drawing.addSimpleShapeRenderType("node-underlay",{getBoundingBox:l,isVisible:s("underlay"),shapeProps:{shape:"underlay-shape",color:"underlay-color",opacity:"underlay-opacity",padding:"underlay-padding",radius:"underlay-corner-radius"}}),t.drawing.addTextureAtlasRenderType("label",{collection:"label",getTexPickingMode:o,getKey:Ly(e.getLabelKey,null),getBoundingBox:Iy(e.getLabelBox,null),drawClipped:!0,drawElement:e.drawLabel,getRotation:i(null),getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:a("label")}),t.drawing.addTextureAtlasRenderType("edge-source-label",{collection:"label",getTexPickingMode:o,getKey:Ly(e.getSourceLabelKey,"source"),getBoundingBox:Iy(e.getSourceLabelBox,"source"),drawClipped:!0,drawElement:e.drawSourceLabel,getRotation:i("source"),getRotationPoint:e.getSourceLabelRotationPoint,getRotationOffset:e.getSourceLabelRotationOffset,isVisible:a("source-label")}),t.drawing.addTextureAtlasRenderType("edge-target-label",{collection:"label",getTexPickingMode:o,getKey:Ly(e.getTargetLabelKey,"target"),getBoundingBox:Iy(e.getTargetLabelBox,"target"),drawClipped:!0,drawElement:e.drawTargetLabel,getRotation:i("target"),getRotationPoint:e.getTargetLabelRotationPoint,getRotationOffset:e.getTargetLabelRotationOffset,isVisible:a("target-label")});var u=iu(function(){console.log("garbage collect flag set"),t.data.gc=!0},1e4);t.onUpdateEleCalcs(function(h,f){var c=!1;f&&f.length>0&&(c|=t.drawing.invalidate(f)),c&&u()}),oj(t)};function sj(r){var e=r.cy.container(),t=e&&e.style&&e.style.backgroundColor||"white";return YA(t)}function bM(r,e){var t=r._private.rscratch;return Or(t,"labelWrapCachedLines",e)||[]}var Ly=function(e,t){return function(n){var i=e(n),a=bM(n,t);return a.length>1?a.map(function(s,o){return"".concat(i,"_").concat(o)}):i}},Iy=function(e,t){return function(n,i){var a=e(n);if(typeof i=="string"){var s=i.indexOf("_");if(s>0){var o=Number(i.substring(s+1)),l=bM(n,t),u=a.h/l.length,h=u*o,f=a.y1+h;return{x1:a.x1,w:a.w,y1:f,h:u,yOffset:h}}}return a}};function oj(r){{var e=r.render;r.render=function(a){a=a||{};var s=r.cy;r.webgl&&(s.zoom()>fM?(lj(r),e.call(r,a)):(uj(r),xM(r,a,Hl.SCREEN)))}}{var t=r.matchCanvasSize;r.matchCanvasSize=function(a){t.call(r,a),r.pickingFrameBuffer.setFramebufferAttachmentSizes(r.canvasWidth,r.canvasHeight),r.pickingFrameBuffer.needsDraw=!0}}r.findNearestElements=function(a,s,o,l){return gj(r,a,s)};{var n=r.invalidateCachedZSortedEles;r.invalidateCachedZSortedEles=function(){n.call(r),r.pickingFrameBuffer.needsDraw=!0}}{var i=r.notify;r.notify=function(a,s){i.call(r,a,s),a==="viewport"||a==="bounds"?r.pickingFrameBuffer.needsDraw=!0:a==="background"&&r.drawing.invalidate(s,{type:"node-body"})}}}function lj(r){var e=r.data.contexts[r.WEBGL];e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function uj(r){var e=function(n){n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,r.canvasWidth,r.canvasHeight),n.restore()};e(r.data.contexts[r.NODE]),e(r.data.contexts[r.DRAG])}function hj(r){var e=r.canvasWidth,t=r.canvasHeight,n=A0(r),i=n.pan,a=n.zoom,s=By();fc(s,s,[i.x,i.y]),Jy(s,s,[a,a]);var o=By();X6(o,e,t);var l=By();return Y6(l,o,s),l}function wM(r,e){var t=r.canvasWidth,n=r.canvasHeight,i=A0(r),a=i.pan,s=i.zoom;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t,n),e.translate(a.x,a.y),e.scale(s,s)}function fj(r,e){r.drawSelectionRectangle(e,function(t){return wM(r,t)})}function cj(r){var e=r.data.contexts[r.NODE];e.save(),wM(r,e),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.moveTo(-1e3,0),e.lineTo(1e3,0),e.stroke(),e.beginPath(),e.moveTo(0,-1e3),e.lineTo(0,1e3),e.stroke(),e.restore()}function dj(r){var e=function(i,a,s){for(var o=i.atlasManager.getAtlasCollection(a),l=r.data.contexts[r.NODE],u=o.atlases,h=0;h<u.length;h++){var f=u[h],c=f.canvas;if(c){var d=c.width,p=c.height,g=d*h,v=c.height*s,m=.4;l.save(),l.scale(m,m),l.drawImage(c,g,v),l.strokeStyle="black",l.rect(g,v,d,p),l.stroke(),l.restore()}}},t=0;e(r.drawing,"node",t++),e(r.drawing,"label",t++)}function pj(r,e,t,n,i){var a,s,o,l,u=A0(r),h=u.pan,f=u.zoom;{var c=_6(r,h,f,e,t),d=zt(c,2),p=d[0],g=d[1],v=6;a=p-v/2,s=g-v/2,o=v,l=v}if(o===0||l===0)return[];var m=r.data.contexts[r.WEBGL];m.bindFramebuffer(m.FRAMEBUFFER,r.pickingFrameBuffer),r.pickingFrameBuffer.needsDraw&&(m.viewport(0,0,m.canvas.width,m.canvas.height),xM(r,null,Hl.PICKING),r.pickingFrameBuffer.needsDraw=!1);var y=o*l,b=new Uint8Array(y*4);m.readPixels(a,s,o,l,m.RGBA,m.UNSIGNED_BYTE,b),m.bindFramebuffer(m.FRAMEBUFFER,null);for(var w=new Set,S=0;S<y;S++){var C=b.slice(S*4,S*4+4),x=H6(C)-1;x>=0&&w.add(x)}return w}function gj(r,e,t){var n=pj(r,e,t),i=r.getCachedZSortedEles(),a,s,o=Lr(n),l;try{for(o.s();!(l=o.n()).done;){var u=l.value,h=i[u];if(!a&&h.isNode()&&(a=h),!s&&h.isEdge()&&(s=h),a&&s)break}}catch(f){o.e(f)}finally{o.f()}return[a,s].filter(Boolean)}function Ny(r,e,t){var n=r.drawing;e+=1,t.isNode()?(n.drawNode(t,e,"node-underlay"),n.drawNode(t,e,"node-body"),n.drawTexture(t,e,"label"),n.drawNode(t,e,"node-overlay")):(n.drawEdgeLine(t,e),n.drawEdgeArrow(t,e,"source"),n.drawEdgeArrow(t,e,"target"),n.drawTexture(t,e,"label"),n.drawTexture(t,e,"edge-source-label"),n.drawTexture(t,e,"edge-target-label"))}function xM(r,e,t){var n;r.webglDebug&&(n=performance.now());var i=r.drawing,a=0;if(t.screen&&r.data.canvasNeedsRedraw[r.SELECT_BOX]&&fj(r,e),r.data.canvasNeedsRedraw[r.NODE]||t.picking){var s=r.data.contexts[r.WEBGL];t.screen?(s.clearColor(0,0,0,0),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA)):s.disable(s.BLEND),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.viewport(0,0,s.canvas.width,s.canvas.height);var o=hj(r),l=r.getCachedZSortedEles();if(a=l.length,i.startFrame(o,t),t.screen){for(var u=0;u<l.nondrag.length;u++)Ny(r,u,l.nondrag[u]);for(var h=0;h<l.drag.length;h++)Ny(r,h,l.drag[h])}else if(t.picking)for(var f=0;f<l.length;f++)Ny(r,f,l[f]);i.endFrame(),t.screen&&r.webglDebugShowAtlases&&(cj(r),dj(r)),r.data.canvasNeedsRedraw[r.NODE]=!1,r.data.canvasNeedsRedraw[r.DRAG]=!1}if(r.webglDebug){var c=performance.now(),d=!1,p=Math.ceil(c-n),g=i.getDebugInfo(),v=["".concat(a," elements"),"".concat(g.totalInstances," instances"),"".concat(g.batchCount," batches"),"".concat(g.totalAtlases," atlases"),"".concat(g.wrappedCount," wrapped textures"),"".concat(g.simpleCount," simple shapes")].join(", ");if(d)console.log("WebGL (".concat(t.name,") - time ").concat(p,"ms, ").concat(v));else{console.log("WebGL (".concat(t.name,") - frame time ").concat(p,"ms")),console.log("Totals:"),console.log("  ".concat(v)),console.log("Texture Atlases Used:");var m=g.atlasInfo,y=Lr(m),b;try{for(y.s();!(b=y.n()).done;){var w=b.value;console.log("  ".concat(w.type,": ").concat(w.keyCount," keys, ").concat(w.atlasCount," atlases"))}}catch(S){y.e(S)}finally{y.f()}console.log("")}}r.data.gc&&(console.log("Garbage Collect!"),r.data.gc=!1,i.gc())}var Yi={};Yi.drawPolygonPath=function(r,e,t,n,i,a){var s=n/2,o=i/2;r.beginPath&&r.beginPath(),r.moveTo(e+s*a[0],t+o*a[1]);for(var l=1;l<a.length/2;l++)r.lineTo(e+s*a[l*2],t+o*a[l*2+1]);r.closePath()};Yi.drawRoundPolygonPath=function(r,e,t,n,i,a,s){s.forEach(function(o){return rM(r,o)}),r.closePath()};Yi.drawRoundRectanglePath=function(r,e,t,n,i,a){var s=n/2,o=i/2,l=a==="auto"?zi(n,i):Math.min(a,o,s);r.beginPath&&r.beginPath(),r.moveTo(e,t-o),r.arcTo(e+s,t-o,e+s,t,l),r.arcTo(e+s,t+o,e,t+o,l),r.arcTo(e-s,t+o,e-s,t,l),r.arcTo(e-s,t-o,e,t-o,l),r.lineTo(e,t-o),r.closePath()};Yi.drawBottomRoundRectanglePath=function(r,e,t,n,i,a){var s=n/2,o=i/2,l=a==="auto"?zi(n,i):a;r.beginPath&&r.beginPath(),r.moveTo(e,t-o),r.lineTo(e+s,t-o),r.lineTo(e+s,t),r.arcTo(e+s,t+o,e,t+o,l),r.arcTo(e-s,t+o,e-s,t,l),r.lineTo(e-s,t-o),r.lineTo(e,t-o),r.closePath()};Yi.drawCutRectanglePath=function(r,e,t,n,i,a,s){var o=n/2,l=i/2,u=s==="auto"?d0():s;r.beginPath&&r.beginPath(),r.moveTo(e-o+u,t-l),r.lineTo(e+o-u,t-l),r.lineTo(e+o,t-l+u),r.lineTo(e+o,t+l-u),r.lineTo(e+o-u,t+l),r.lineTo(e-o+u,t+l),r.lineTo(e-o,t+l-u),r.lineTo(e-o,t-l+u),r.closePath()};Yi.drawBarrelPath=function(r,e,t,n,i){var a=n/2,s=i/2,o=e-a,l=e+a,u=t-s,h=t+s,f=_y(n,i),c=f.widthOffset,d=f.heightOffset,p=f.ctrlPtOffsetPct*c;r.beginPath&&r.beginPath(),r.moveTo(o,u+d),r.lineTo(o,h-d),r.quadraticCurveTo(o+p,h,o+c,h),r.lineTo(l-c,h),r.quadraticCurveTo(l-p,h,l,h-d),r.lineTo(l,u+d),r.quadraticCurveTo(l-p,u,l-c,u),r.lineTo(o+c,u),r.quadraticCurveTo(o+p,u,o,u+d),r.closePath()};var FA=Math.sin(0),_A=Math.cos(0),e0={},t0={},SM=Math.PI/40;for(Ra=0*Math.PI;Ra<2*Math.PI;Ra+=SM)e0[Ra]=Math.sin(Ra),t0[Ra]=Math.cos(Ra);var Ra;Yi.drawEllipsePath=function(r,e,t,n,i){if(r.beginPath&&r.beginPath(),r.ellipse)r.ellipse(e,t,n/2,i/2,0,0,2*Math.PI);else for(var a,s,o=n/2,l=i/2,u=0*Math.PI;u<2*Math.PI;u+=SM)a=e-o*e0[u]*FA+o*t0[u]*_A,s=t+l*t0[u]*FA+l*e0[u]*_A,u===0?r.moveTo(a,s):r.lineTo(a,s);r.closePath()};var hu={};hu.createBuffer=function(r,e){var t=document.createElement("canvas");return t.width=r,t.height=e,[t,t.getContext("2d")]};hu.bufferCanvasImage=function(r){var e=this.cy,t=e.mutableElements(),n=t.boundingBox(),i=this.findContainerClientCoords(),a=r.full?Math.ceil(n.w):i[2],s=r.full?Math.ceil(n.h):i[3],o=se(r.maxWidth)||se(r.maxHeight),l=this.getPixelRatio(),u=1;if(r.scale!==void 0)a*=r.scale,s*=r.scale,u=r.scale;else if(o){var h=1/0,f=1/0;se(r.maxWidth)&&(h=u*r.maxWidth/a),se(r.maxHeight)&&(f=u*r.maxHeight/s),u=Math.min(h,f),a*=u,s*=u}o||(a*=l,s*=l,u*=l);var c=document.createElement("canvas");c.width=a,c.height=s,c.style.width=a+"px",c.style.height=s+"px";var d=c.getContext("2d");if(a>0&&s>0){d.clearRect(0,0,a,s),d.globalCompositeOperation="source-over";var p=this.getCachedZSortedEles();if(r.full)d.translate(-n.x1*u,-n.y1*u),d.scale(u,u),this.drawElements(d,p),d.scale(1/u,1/u),d.translate(n.x1*u,n.y1*u);else{var g=e.pan(),v={x:g.x*u,y:g.y*u};u*=e.zoom(),d.translate(v.x,v.y),d.scale(u,u),this.drawElements(d,p),d.scale(1/u,1/u),d.translate(-v.x,-v.y)}r.bg&&(d.globalCompositeOperation="destination-over",d.fillStyle=r.bg,d.rect(0,0,a,s),d.fill())}return c};function vj(r,e){for(var t=atob(r),n=new ArrayBuffer(t.length),i=new Uint8Array(n),a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return new Blob([n],{type:e})}function zA(r){var e=r.indexOf(",");return r.substr(e+1)}function CM(r,e,t){var n=function(){return e.toDataURL(t,r.quality)};switch(r.output){case"blob-promise":return new eo(function(i,a){try{e.toBlob(function(s){s!=null?i(s):a(new Error("`canvas.toBlob()` sent a null value in its callback"))},t,r.quality)}catch(s){a(s)}});case"blob":return vj(zA(n()),t);case"base64":return zA(n());case"base64uri":default:return n()}}hu.png=function(r){return CM(r,this.bufferCanvasImage(r),"image/png")};hu.jpg=function(r){return CM(r,this.bufferCanvasImage(r),"image/jpeg")};var kM={};kM.nodeShapeImpl=function(r,e,t,n,i,a,s,o){switch(r){case"ellipse":return this.drawEllipsePath(e,t,n,i,a);case"polygon":return this.drawPolygonPath(e,t,n,i,a,s);case"round-polygon":return this.drawRoundPolygonPath(e,t,n,i,a,s,o);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,t,n,i,a,o);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,t,n,i,a,s,o);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,t,n,i,a,o);case"barrel":return this.drawBarrelPath(e,t,n,i,a)}};var mj=EM,_e=EM.prototype;_e.CANVAS_LAYERS=3;_e.SELECT_BOX=0;_e.DRAG=1;_e.NODE=2;_e.WEBGL=3;_e.CANVAS_TYPES=["2d","2d","2d","webgl2"];_e.BUFFER_COUNT=3;_e.TEXTURE_BUFFER=0;_e.MOTIONBLUR_BUFFER_NODE=1;_e.MOTIONBLUR_BUFFER_DRAG=2;function EM(r){var e=this,t=e.cy.window(),n=t.document;r.webgl&&(_e.CANVAS_LAYERS=e.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),e.data={canvases:new Array(_e.CANVAS_LAYERS),contexts:new Array(_e.CANVAS_LAYERS),canvasNeedsRedraw:new Array(_e.CANVAS_LAYERS),bufferCanvases:new Array(_e.BUFFER_COUNT),bufferContexts:new Array(_e.CANVAS_LAYERS)};var i="-webkit-tap-highlight-color",a="rgba(0,0,0,0)";e.data.canvasContainer=n.createElement("div");var s=e.data.canvasContainer.style;e.data.canvasContainer.style[i]=a,s.position="relative",s.zIndex="0",s.overflow="hidden";var o=r.cy.container();o.appendChild(e.data.canvasContainer),o.style[i]=a;var l={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};gG()&&(l["-ms-touch-action"]="none",l["touch-action"]="none");for(var u=0;u<_e.CANVAS_LAYERS;u++){var h=e.data.canvases[u]=n.createElement("canvas"),f=_e.CANVAS_TYPES[u];e.data.contexts[u]=h.getContext(f),e.data.contexts[u]||Ct("Could not create canvas of type "+f),Object.keys(l).forEach(function(te){h.style[te]=l[te]}),h.style.position="absolute",h.setAttribute("data-id","layer"+u),h.style.zIndex=String(_e.CANVAS_LAYERS-u),e.data.canvasContainer.appendChild(h),e.data.canvasNeedsRedraw[u]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[_e.NODE].setAttribute("data-id","layer"+_e.NODE+"-node"),e.data.canvases[_e.SELECT_BOX].setAttribute("data-id","layer"+_e.SELECT_BOX+"-selectbox"),e.data.canvases[_e.DRAG].setAttribute("data-id","layer"+_e.DRAG+"-drag"),e.data.canvases[_e.WEBGL]&&e.data.canvases[_e.WEBGL].setAttribute("data-id","layer"+_e.WEBGL+"-webgl");for(var u=0;u<_e.BUFFER_COUNT;u++)e.data.bufferCanvases[u]=n.createElement("canvas"),e.data.bufferContexts[u]=e.data.bufferCanvases[u].getContext("2d"),e.data.bufferCanvases[u].style.position="absolute",e.data.bufferCanvases[u].setAttribute("data-id","buffer"+u),e.data.bufferCanvases[u].style.zIndex=String(-u-1),e.data.bufferCanvases[u].style.visibility="hidden";e.pathsEnabled=!0;var c=Ir(),d=function(V){return{x:(V.x1+V.x2)/2,y:(V.y1+V.y2)/2}},p=function(V){return{x:-V.w/2,y:-V.h/2}},g=function(V){var W=V[0]._private,K=W.oldBackgroundTimestamp===W.backgroundTimestamp;return!K},v=function(V){return V[0]._private.nodeKey},m=function(V){return V[0]._private.labelStyleKey},y=function(V){return V[0]._private.sourceLabelStyleKey},b=function(V){return V[0]._private.targetLabelStyleKey},w=function(V,W,K,ie,ue){return e.drawElement(V,W,K,!1,!1,ue)},S=function(V,W,K,ie,ue){return e.drawElementText(V,W,K,ie,"main",ue)},C=function(V,W,K,ie,ue){return e.drawElementText(V,W,K,ie,"source",ue)},x=function(V,W,K,ie,ue){return e.drawElementText(V,W,K,ie,"target",ue)},A=function(V){return V.boundingBox(),V[0]._private.bodyBounds},T=function(V){return V.boundingBox(),V[0]._private.labelBounds.main||c},D=function(V){return V.boundingBox(),V[0]._private.labelBounds.source||c},k=function(V){return V.boundingBox(),V[0]._private.labelBounds.target||c},E=function(V,W){return W},M=function(V){return d(A(V))},O=function(V,W,K){var ie=V?V+"-":"";return{x:W.x+K.pstyle(ie+"text-margin-x").pfValue,y:W.y+K.pstyle(ie+"text-margin-y").pfValue}},R=function(V,W,K){var ie=V[0]._private.rscratch;return{x:ie[W],y:ie[K]}},L=function(V){return O("",R(V,"labelX","labelY"),V)},I=function(V){return O("source",R(V,"sourceLabelX","sourceLabelY"),V)},N=function(V){return O("target",R(V,"targetLabelX","targetLabelY"),V)},q=function(V){return p(A(V))},z=function(V){return p(D(V))},F=function(V){return p(k(V))},_=function(V){var W=T(V),K=p(T(V));if(V.isNode()){switch(V.pstyle("text-halign").value){case"left":K.x=-W.w-(W.leftPad||0);break;case"right":K.x=-(W.rightPad||0);break}switch(V.pstyle("text-valign").value){case"top":K.y=-W.h-(W.topPad||0);break;case"bottom":K.y=-(W.botPad||0);break}}return K},U=e.data.eleTxrCache=new _l(e,{getKey:v,doesEleInvalidateKey:g,drawElement:w,getBoundingBox:A,getRotationPoint:M,getRotationOffset:q,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),X=e.data.lblTxrCache=new _l(e,{getKey:m,drawElement:S,getBoundingBox:T,getRotationPoint:L,getRotationOffset:_,isVisible:E}),$=e.data.slbTxrCache=new _l(e,{getKey:y,drawElement:C,getBoundingBox:D,getRotationPoint:I,getRotationOffset:z,isVisible:E}),Q=e.data.tlbTxrCache=new _l(e,{getKey:b,drawElement:x,getBoundingBox:k,getRotationPoint:N,getRotationOffset:F,isVisible:E}),ee=e.data.lyrTxrCache=new cM(e);e.onUpdateEleCalcs(function(V,W){U.invalidateElements(W),X.invalidateElements(W),$.invalidateElements(W),Q.invalidateElements(W),ee.invalidateElements(W);for(var K=0;K<W.length;K++){var ie=W[K]._private;ie.oldBackgroundTimestamp=ie.backgroundTimestamp}});var oe=function(V){for(var W=0;W<V.length;W++)ee.enqueueElementRefinement(V[W].ele)};U.onDequeue(oe),X.onDequeue(oe),$.onDequeue(oe),Q.onDequeue(oe),r.webgl&&e.initWebgl(r,{getStyleKey:v,getLabelKey:m,getSourceLabelKey:y,getTargetLabelKey:b,drawElement:w,drawLabel:S,drawSourceLabel:C,drawTargetLabel:x,getElementBox:A,getLabelBox:T,getSourceLabelBox:D,getTargetLabelBox:k,getElementRotationPoint:M,getElementRotationOffset:q,getLabelRotationPoint:L,getSourceLabelRotationPoint:I,getTargetLabelRotationPoint:N,getLabelRotationOffset:_,getSourceLabelRotationOffset:z,getTargetLabelRotationOffset:F})}_e.redrawHint=function(r,e){var t=this;switch(r){case"eles":t.data.canvasNeedsRedraw[_e.NODE]=e;break;case"drag":t.data.canvasNeedsRedraw[_e.DRAG]=e;break;case"select":t.data.canvasNeedsRedraw[_e.SELECT_BOX]=e;break;case"gc":t.data.gc=!0;break}};var yj=typeof Path2D<"u";_e.path2dEnabled=function(r){if(r===void 0)return this.pathsEnabled;this.pathsEnabled=!!r};_e.usePaths=function(){return yj&&this.pathsEnabled};_e.setImgSmoothing=function(r,e){r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled=e:(r.webkitImageSmoothingEnabled=e,r.mozImageSmoothingEnabled=e,r.msImageSmoothingEnabled=e)};_e.getImgSmoothing=function(r){return r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled:r.webkitImageSmoothingEnabled||r.mozImageSmoothingEnabled||r.msImageSmoothingEnabled};_e.makeOffscreenCanvas=function(r,e){var t;if((typeof OffscreenCanvas>"u"?"undefined":Ht(OffscreenCanvas))!=="undefined")t=new OffscreenCanvas(r,e);else{var n=this.cy.window(),i=n.document;t=i.createElement("canvas"),t.width=r,t.height=e}return t};[dM,Vn,li,T0,ja,ji,wr,yM,Yi,hu,kM].forEach(function(r){Ce(_e,r)});var bj=[{name:"null",impl:J2},{name:"base",impl:uM},{name:"canvas",impl:mj}],wj=[{type:"layout",extensions:K9},{type:"renderer",extensions:bj}],TM={},AM={};function MM(r,e,t){var n=t,i=function(A){it("Can not register `"+e+"` for `"+r+"` since `"+A+"` already exists in the prototype and can not be overridden")};if(r==="core"){if(Zl.prototype[e])return i(e);Zl.prototype[e]=t}else if(r==="collection"){if(ir.prototype[e])return i(e);ir.prototype[e]=t}else if(r==="layout"){for(var a=function(A){this.options=A,t.call(this,A),$e(this._private)||(this._private={}),this._private.cy=A.cy,this._private.listeners=[],this.createEmitter()},s=a.prototype=Object.create(t.prototype),o=[],l=0;l<o.length;l++){var u=o[l];s[u]=s[u]||function(){return this}}s.start&&!s.run?s.run=function(){return this.start(),this}:!s.start&&s.run&&(s.start=function(){return this.run(),this});var h=t.prototype.stop;s.stop=function(){var x=this.options;if(x&&x.animate){var A=this.animations;if(A)for(var T=0;T<A.length;T++)A[T].stop()}return h?h.call(this):this.emit("layoutstop"),this},s.destroy||(s.destroy=function(){return this}),s.cy=function(){return this._private.cy};var f=function(A){return A._private.cy},c={addEventFields:function(A,T){T.layout=A,T.cy=f(A),T.target=A},bubble:function(){return!0},parent:function(A){return f(A)}};Ce(s,{createEmitter:function(){return this._private.emitter=new Nc(c,this),this},emitter:function(){return this._private.emitter},on:function(A,T){return this.emitter().on(A,T),this},one:function(A,T){return this.emitter().one(A,T),this},once:function(A,T){return this.emitter().one(A,T),this},removeListener:function(A,T){return this.emitter().removeListener(A,T),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(A,T){return this.emitter().emit(A,T),this}}),nt.eventAliasesOn(s),n=a}else if(r==="renderer"&&e!=="null"&&e!=="base"){var d=DM("renderer","base"),p=d.prototype,g=t,v=t.prototype,m=function(){d.apply(this,arguments),g.apply(this,arguments)},y=m.prototype;for(var b in p){var w=p[b],S=v[b]!=null;if(S)return i(b);y[b]=w}for(var C in v)y[C]=v[C];p.clientFunctions.forEach(function(x){y[x]=y[x]||function(){Ct("Renderer does not implement `renderer."+x+"()` on its prototype")}}),n=m}else if(r==="__proto__"||r==="constructor"||r==="prototype")return Ct(r+" is an illegal type to be registered, possibly lead to prototype pollutions");return XA({map:TM,keys:[r,e],value:n})}function DM(r,e){return $A({map:TM,keys:[r,e]})}function xj(r,e,t,n,i){return XA({map:AM,keys:[r,e,t,n],value:i})}function Sj(r,e,t,n){return $A({map:AM,keys:[r,e,t,n]})}var r0=function(){if(arguments.length===2)return DM.apply(null,arguments);if(arguments.length===3)return MM.apply(null,arguments);if(arguments.length===4)return Sj.apply(null,arguments);if(arguments.length===5)return xj.apply(null,arguments);Ct("Invalid extension access syntax")};Zl.prototype.extension=r0;wj.forEach(function(r){r.extensions.forEach(function(e){MM(r.type,e.name,e.impl)})});var Ec=function(){if(!(this instanceof Ec))return new Ec;this.length=0},Ga=Ec.prototype;Ga.instanceString=function(){return"stylesheet"};Ga.selector=function(r){var e=this.length++;return this[e]={selector:r,properties:[]},this};Ga.css=function(r,e){var t=this.length-1;if(be(r))this[t].properties.push({name:r,value:e});else if($e(r))for(var n=r,i=Object.keys(n),a=0;a<i.length;a++){var s=i[a],o=n[s];if(o!=null){var l=Yt.properties[s]||Yt.properties[Tc(s)];if(l!=null){var u=l.name,h=o;this[t].properties.push({name:u,value:h})}}}return this};Ga.style=Ga.css;Ga.generateStyle=function(r){var e=new Yt(r);return this.appendToStyle(e)};Ga.appendToStyle=function(r){for(var e=0;e<this.length;e++){var t=this[e],n=t.selector,i=t.properties;r.selector(n);for(var a=0;a<i.length;a++){var s=i[a];r.css(s.name,s.value)}}return r};var Cj="3.32.0",Ua=function(e){if(e===void 0&&(e={}),$e(e))return new Zl(e);if(be(e))return r0.apply(r0,arguments)};Ua.use=function(r){var e=Array.prototype.slice.call(arguments,1);return e.unshift(Ua),r.apply(null,e),this};Ua.warnings=function(r){return n2(r)};Ua.version=Cj;Ua.stylesheet=Ua.Stylesheet=Ec;PM.exports=Ua});var RM=B((Kce,OM)=>{function kj(){this.__data__=[],this.size=0}OM.exports=kj});var Ya=B((jce,LM)=>{function Ej(r,e){return r===e||r!==r&&e!==e}LM.exports=Ej});var fu=B((Yce,IM)=>{var Tj=Ya();function Aj(r,e){for(var t=r.length;t--;)if(Tj(r[t][0],e))return t;return-1}IM.exports=Aj});var qM=B((Xce,NM)=>{var Mj=fu(),Dj=Array.prototype,Pj=Dj.splice;function Bj(r){var e=this.__data__,t=Mj(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():Pj.call(e,t,1),--this.size,!0}NM.exports=Bj});var _M=B(($ce,FM)=>{var Oj=fu();function Rj(r){var e=this.__data__,t=Oj(e,r);return t<0?void 0:e[t][1]}FM.exports=Rj});var VM=B((Zce,zM)=>{var Lj=fu();function Ij(r){return Lj(this.__data__,r)>-1}zM.exports=Ij});var WM=B((Qce,HM)=>{var Nj=fu();function qj(r,e){var t=this.__data__,n=Nj(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}HM.exports=qj});var cu=B((Jce,GM)=>{var Fj=RM(),_j=qM(),zj=_M(),Vj=VM(),Hj=WM();function ao(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}ao.prototype.clear=Fj;ao.prototype.delete=_j;ao.prototype.get=zj;ao.prototype.has=Vj;ao.prototype.set=Hj;GM.exports=ao});var KM=B((ede,UM)=>{var Wj=cu();function Gj(){this.__data__=new Wj,this.size=0}UM.exports=Gj});var YM=B((tde,jM)=>{function Uj(r){var e=this.__data__,t=e.delete(r);return this.size=e.size,t}jM.exports=Uj});var $M=B((rde,XM)=>{function Kj(r){return this.__data__.get(r)}XM.exports=Kj});var QM=B((nde,ZM)=>{function jj(r){return this.__data__.has(r)}ZM.exports=jj});var M0=B((ide,JM)=>{var Yj=typeof global=="object"&&global&&global.Object===Object&&global;JM.exports=Yj});var nn=B((ade,eD)=>{var Xj=M0(),$j=typeof self=="object"&&self&&self.Object===Object&&self,Zj=Xj||$j||Function("return this")();eD.exports=Zj});var Xa=B((sde,tD)=>{var Qj=nn(),Jj=Qj.Symbol;tD.exports=Jj});var aD=B((ode,iD)=>{var rD=Xa(),nD=Object.prototype,eY=nD.hasOwnProperty,tY=nD.toString,du=rD?rD.toStringTag:void 0;function rY(r){var e=eY.call(r,du),t=r[du];try{r[du]=void 0;var n=!0}catch{}var i=tY.call(r);return n&&(e?r[du]=t:delete r[du]),i}iD.exports=rY});var oD=B((lde,sD)=>{var nY=Object.prototype,iY=nY.toString;function aY(r){return iY.call(r)}sD.exports=aY});var Xi=B((ude,hD)=>{var lD=Xa(),sY=aD(),oY=oD(),lY="[object Null]",uY="[object Undefined]",uD=lD?lD.toStringTag:void 0;function hY(r){return r==null?r===void 0?uY:lY:uD&&uD in Object(r)?sY(r):oY(r)}hD.exports=hY});var Gr=B((hde,fD)=>{function fY(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}fD.exports=fY});var so=B((fde,cD)=>{var cY=Xi(),dY=Gr(),pY="[object AsyncFunction]",gY="[object Function]",vY="[object GeneratorFunction]",mY="[object Proxy]";function yY(r){if(!dY(r))return!1;var e=cY(r);return e==gY||e==vY||e==pY||e==mY}cD.exports=yY});var pD=B((cde,dD)=>{var bY=nn(),wY=bY["__core-js_shared__"];dD.exports=wY});var mD=B((dde,vD)=>{var D0=pD(),gD=function(){var r=/[^.]+$/.exec(D0&&D0.keys&&D0.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function xY(r){return!!gD&&gD in r}vD.exports=xY});var P0=B((pde,yD)=>{var SY=Function.prototype,CY=SY.toString;function kY(r){if(r!=null){try{return CY.call(r)}catch{}try{return r+""}catch{}}return""}yD.exports=kY});var wD=B((gde,bD)=>{var EY=so(),TY=mD(),AY=Gr(),MY=P0(),DY=/[\\^$.*+?()[\]{}|]/g,PY=/^\[object .+?Constructor\]$/,BY=Function.prototype,OY=Object.prototype,RY=BY.toString,LY=OY.hasOwnProperty,IY=RegExp("^"+RY.call(LY).replace(DY,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function NY(r){if(!AY(r)||TY(r))return!1;var e=EY(r)?IY:PY;return e.test(MY(r))}bD.exports=NY});var SD=B((vde,xD)=>{function qY(r,e){return r?.[e]}xD.exports=qY});var $i=B((mde,CD)=>{var FY=wD(),_Y=SD();function zY(r,e){var t=_Y(r,e);return FY(t)?t:void 0}CD.exports=zY});var Gc=B((yde,kD)=>{var VY=$i(),HY=nn(),WY=VY(HY,"Map");kD.exports=WY});var pu=B((bde,ED)=>{var GY=$i(),UY=GY(Object,"create");ED.exports=UY});var MD=B((wde,AD)=>{var TD=pu();function KY(){this.__data__=TD?TD(null):{},this.size=0}AD.exports=KY});var PD=B((xde,DD)=>{function jY(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}DD.exports=jY});var OD=B((Sde,BD)=>{var YY=pu(),XY="__lodash_hash_undefined__",$Y=Object.prototype,ZY=$Y.hasOwnProperty;function QY(r){var e=this.__data__;if(YY){var t=e[r];return t===XY?void 0:t}return ZY.call(e,r)?e[r]:void 0}BD.exports=QY});var LD=B((Cde,RD)=>{var JY=pu(),e7=Object.prototype,t7=e7.hasOwnProperty;function r7(r){var e=this.__data__;return JY?e[r]!==void 0:t7.call(e,r)}RD.exports=r7});var ND=B((kde,ID)=>{var n7=pu(),i7="__lodash_hash_undefined__";function a7(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=n7&&e===void 0?i7:e,this}ID.exports=a7});var FD=B((Ede,qD)=>{var s7=MD(),o7=PD(),l7=OD(),u7=LD(),h7=ND();function oo(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}oo.prototype.clear=s7;oo.prototype.delete=o7;oo.prototype.get=l7;oo.prototype.has=u7;oo.prototype.set=h7;qD.exports=oo});var VD=B((Tde,zD)=>{var _D=FD(),f7=cu(),c7=Gc();function d7(){this.size=0,this.__data__={hash:new _D,map:new(c7||f7),string:new _D}}zD.exports=d7});var WD=B((Ade,HD)=>{function p7(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}HD.exports=p7});var gu=B((Mde,GD)=>{var g7=WD();function v7(r,e){var t=r.__data__;return g7(e)?t[typeof e=="string"?"string":"hash"]:t.map}GD.exports=v7});var KD=B((Dde,UD)=>{var m7=gu();function y7(r){var e=m7(this,r).delete(r);return this.size-=e?1:0,e}UD.exports=y7});var YD=B((Pde,jD)=>{var b7=gu();function w7(r){return b7(this,r).get(r)}jD.exports=w7});var $D=B((Bde,XD)=>{var x7=gu();function S7(r){return x7(this,r).has(r)}XD.exports=S7});var QD=B((Ode,ZD)=>{var C7=gu();function k7(r,e){var t=C7(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}ZD.exports=k7});var Uc=B((Rde,JD)=>{var E7=VD(),T7=KD(),A7=YD(),M7=$D(),D7=QD();function lo(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}lo.prototype.clear=E7;lo.prototype.delete=T7;lo.prototype.get=A7;lo.prototype.has=M7;lo.prototype.set=D7;JD.exports=lo});var tP=B((Lde,eP)=>{var P7=cu(),B7=Gc(),O7=Uc(),R7=200;function L7(r,e){var t=this.__data__;if(t instanceof P7){var n=t.__data__;if(!B7||n.length<R7-1)return n.push([r,e]),this.size=++t.size,this;t=this.__data__=new O7(n)}return t.set(r,e),this.size=t.size,this}eP.exports=L7});var vu=B((Ide,rP)=>{var I7=cu(),N7=KM(),q7=YM(),F7=$M(),_7=QM(),z7=tP();function uo(r){var e=this.__data__=new I7(r);this.size=e.size}uo.prototype.clear=N7;uo.prototype.delete=q7;uo.prototype.get=F7;uo.prototype.has=_7;uo.prototype.set=z7;rP.exports=uo});var Kc=B((Nde,nP)=>{function V7(r,e){for(var t=-1,n=r==null?0:r.length;++t<n&&e(r[t],t,r)!==!1;);return r}nP.exports=V7});var B0=B((qde,iP)=>{var H7=$i(),W7=function(){try{var r=H7(Object,"defineProperty");return r({},"",{}),r}catch{}}();iP.exports=W7});var mu=B((Fde,sP)=>{var aP=B0();function G7(r,e,t){e=="__proto__"&&aP?aP(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}sP.exports=G7});var yu=B((_de,oP)=>{var U7=mu(),K7=Ya(),j7=Object.prototype,Y7=j7.hasOwnProperty;function X7(r,e,t){var n=r[e];(!(Y7.call(r,e)&&K7(n,t))||t===void 0&&!(e in r))&&U7(r,e,t)}oP.exports=X7});var ho=B((zde,lP)=>{var $7=yu(),Z7=mu();function Q7(r,e,t,n){var i=!t;t||(t={});for(var a=-1,s=e.length;++a<s;){var o=e[a],l=n?n(t[o],r[o],o,t,r):void 0;l===void 0&&(l=r[o]),i?Z7(t,o,l):$7(t,o,l)}return t}lP.exports=Q7});var hP=B((Vde,uP)=>{function J7(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}uP.exports=J7});var xn=B((Hde,fP)=>{function eX(r){return r!=null&&typeof r=="object"}fP.exports=eX});var dP=B((Wde,cP)=>{var tX=Xi(),rX=xn(),nX="[object Arguments]";function iX(r){return rX(r)&&tX(r)==nX}cP.exports=iX});var fo=B((Gde,vP)=>{var pP=dP(),aX=xn(),gP=Object.prototype,sX=gP.hasOwnProperty,oX=gP.propertyIsEnumerable,lX=pP(function(){return arguments}())?pP:function(r){return aX(r)&&sX.call(r,"callee")&&!oX.call(r,"callee")};vP.exports=lX});var Pt=B((Ude,mP)=>{var uX=Array.isArray;mP.exports=uX});var bP=B((Kde,yP)=>{function hX(){return!1}yP.exports=hX});var $a=B((bu,co)=>{var fX=nn(),cX=bP(),SP=typeof bu=="object"&&bu&&!bu.nodeType&&bu,wP=SP&&typeof co=="object"&&co&&!co.nodeType&&co,dX=wP&&wP.exports===SP,xP=dX?fX.Buffer:void 0,pX=xP?xP.isBuffer:void 0,gX=pX||cX;co.exports=gX});var wu=B((jde,CP)=>{var vX=9007199254740991,mX=/^(?:0|[1-9]\d*)$/;function yX(r,e){var t=typeof r;return e=e??vX,!!e&&(t=="number"||t!="symbol"&&mX.test(r))&&r>-1&&r%1==0&&r<e}CP.exports=yX});var jc=B((Yde,kP)=>{var bX=9007199254740991;function wX(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=bX}kP.exports=wX});var TP=B((Xde,EP)=>{var xX=Xi(),SX=jc(),CX=xn(),kX="[object Arguments]",EX="[object Array]",TX="[object Boolean]",AX="[object Date]",MX="[object Error]",DX="[object Function]",PX="[object Map]",BX="[object Number]",OX="[object Object]",RX="[object RegExp]",LX="[object Set]",IX="[object String]",NX="[object WeakMap]",qX="[object ArrayBuffer]",FX="[object DataView]",_X="[object Float32Array]",zX="[object Float64Array]",VX="[object Int8Array]",HX="[object Int16Array]",WX="[object Int32Array]",GX="[object Uint8Array]",UX="[object Uint8ClampedArray]",KX="[object Uint16Array]",jX="[object Uint32Array]",xt={};xt[_X]=xt[zX]=xt[VX]=xt[HX]=xt[WX]=xt[GX]=xt[UX]=xt[KX]=xt[jX]=!0;xt[kX]=xt[EX]=xt[qX]=xt[TX]=xt[FX]=xt[AX]=xt[MX]=xt[DX]=xt[PX]=xt[BX]=xt[OX]=xt[RX]=xt[LX]=xt[IX]=xt[NX]=!1;function YX(r){return CX(r)&&SX(r.length)&&!!xt[xX(r)]}EP.exports=YX});var xu=B(($de,AP)=>{function XX(r){return function(e){return r(e)}}AP.exports=XX});var Yc=B((Su,po)=>{var $X=M0(),MP=typeof Su=="object"&&Su&&!Su.nodeType&&Su,Cu=MP&&typeof po=="object"&&po&&!po.nodeType&&po,ZX=Cu&&Cu.exports===MP,O0=ZX&&$X.process,QX=function(){try{var r=Cu&&Cu.require&&Cu.require("util").types;return r||O0&&O0.binding&&O0.binding("util")}catch{}}();po.exports=QX});var go=B((Zde,BP)=>{var JX=TP(),e$=xu(),DP=Yc(),PP=DP&&DP.isTypedArray,t$=PP?e$(PP):JX;BP.exports=t$});var R0=B((Qde,OP)=>{var r$=hP(),n$=fo(),i$=Pt(),a$=$a(),s$=wu(),o$=go(),l$=Object.prototype,u$=l$.hasOwnProperty;function h$(r,e){var t=i$(r),n=!t&&n$(r),i=!t&&!n&&a$(r),a=!t&&!n&&!i&&o$(r),s=t||n||i||a,o=s?r$(r.length,String):[],l=o.length;for(var u in r)(e||u$.call(r,u))&&!(s&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||s$(u,l)))&&o.push(u);return o}OP.exports=h$});var ku=B((Jde,RP)=>{var f$=Object.prototype;function c$(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||f$;return r===t}RP.exports=c$});var L0=B((epe,LP)=>{function d$(r,e){return function(t){return r(e(t))}}LP.exports=d$});var NP=B((tpe,IP)=>{var p$=L0(),g$=p$(Object.keys,Object);IP.exports=g$});var Xc=B((rpe,qP)=>{var v$=ku(),m$=NP(),y$=Object.prototype,b$=y$.hasOwnProperty;function w$(r){if(!v$(r))return m$(r);var e=[];for(var t in Object(r))b$.call(r,t)&&t!="constructor"&&e.push(t);return e}qP.exports=w$});var Hn=B((npe,FP)=>{var x$=so(),S$=jc();function C$(r){return r!=null&&S$(r.length)&&!x$(r)}FP.exports=C$});var ui=B((ipe,_P)=>{var k$=R0(),E$=Xc(),T$=Hn();function A$(r){return T$(r)?k$(r):E$(r)}_P.exports=A$});var VP=B((ape,zP)=>{var M$=ho(),D$=ui();function P$(r,e){return r&&M$(e,D$(e),r)}zP.exports=P$});var WP=B((spe,HP)=>{function B$(r){var e=[];if(r!=null)for(var t in Object(r))e.push(t);return e}HP.exports=B$});var UP=B((ope,GP)=>{var O$=Gr(),R$=ku(),L$=WP(),I$=Object.prototype,N$=I$.hasOwnProperty;function q$(r){if(!O$(r))return L$(r);var e=R$(r),t=[];for(var n in r)n=="constructor"&&(e||!N$.call(r,n))||t.push(n);return t}GP.exports=q$});var Zi=B((lpe,KP)=>{var F$=R0(),_$=UP(),z$=Hn();function V$(r){return z$(r)?F$(r,!0):_$(r)}KP.exports=V$});var YP=B((upe,jP)=>{var H$=ho(),W$=Zi();function G$(r,e){return r&&H$(e,W$(e),r)}jP.exports=G$});var I0=B((Eu,vo)=>{var U$=nn(),QP=typeof Eu=="object"&&Eu&&!Eu.nodeType&&Eu,XP=QP&&typeof vo=="object"&&vo&&!vo.nodeType&&vo,K$=XP&&XP.exports===QP,$P=K$?U$.Buffer:void 0,ZP=$P?$P.allocUnsafe:void 0;function j$(r,e){if(e)return r.slice();var t=r.length,n=ZP?ZP(t):new r.constructor(t);return r.copy(n),n}vo.exports=j$});var N0=B((hpe,JP)=>{function Y$(r,e){var t=-1,n=r.length;for(e||(e=Array(n));++t<n;)e[t]=r[t];return e}JP.exports=Y$});var q0=B((fpe,eB)=>{function X$(r,e){for(var t=-1,n=r==null?0:r.length,i=0,a=[];++t<n;){var s=r[t];e(s,t,r)&&(a[i++]=s)}return a}eB.exports=X$});var F0=B((cpe,tB)=>{function $$(){return[]}tB.exports=$$});var $c=B((dpe,nB)=>{var Z$=q0(),Q$=F0(),J$=Object.prototype,eZ=J$.propertyIsEnumerable,rB=Object.getOwnPropertySymbols,tZ=rB?function(r){return r==null?[]:(r=Object(r),Z$(rB(r),function(e){return eZ.call(r,e)}))}:Q$;nB.exports=tZ});var aB=B((ppe,iB)=>{var rZ=ho(),nZ=$c();function iZ(r,e){return rZ(r,nZ(r),e)}iB.exports=iZ});var Zc=B((gpe,sB)=>{function aZ(r,e){for(var t=-1,n=e.length,i=r.length;++t<n;)r[i+t]=e[t];return r}sB.exports=aZ});var Tu=B((vpe,oB)=>{var sZ=L0(),oZ=sZ(Object.getPrototypeOf,Object);oB.exports=oZ});var _0=B((mpe,lB)=>{var lZ=Zc(),uZ=Tu(),hZ=$c(),fZ=F0(),cZ=Object.getOwnPropertySymbols,dZ=cZ?function(r){for(var e=[];r;)lZ(e,hZ(r)),r=uZ(r);return e}:fZ;lB.exports=dZ});var hB=B((ype,uB)=>{var pZ=ho(),gZ=_0();function vZ(r,e){return pZ(r,gZ(r),e)}uB.exports=vZ});var z0=B((bpe,fB)=>{var mZ=Zc(),yZ=Pt();function bZ(r,e,t){var n=e(r);return yZ(r)?n:mZ(n,t(r))}fB.exports=bZ});var V0=B((wpe,cB)=>{var wZ=z0(),xZ=$c(),SZ=ui();function CZ(r){return wZ(r,SZ,xZ)}cB.exports=CZ});var pB=B((xpe,dB)=>{var kZ=z0(),EZ=_0(),TZ=Zi();function AZ(r){return kZ(r,TZ,EZ)}dB.exports=AZ});var vB=B((Spe,gB)=>{var MZ=$i(),DZ=nn(),PZ=MZ(DZ,"DataView");gB.exports=PZ});var yB=B((Cpe,mB)=>{var BZ=$i(),OZ=nn(),RZ=BZ(OZ,"Promise");mB.exports=RZ});var H0=B((kpe,bB)=>{var LZ=$i(),IZ=nn(),NZ=LZ(IZ,"Set");bB.exports=NZ});var xB=B((Epe,wB)=>{var qZ=$i(),FZ=nn(),_Z=qZ(FZ,"WeakMap");wB.exports=_Z});var Qa=B((Tpe,MB)=>{var W0=vB(),G0=Gc(),U0=yB(),K0=H0(),j0=xB(),AB=Xi(),mo=P0(),SB="[object Map]",zZ="[object Object]",CB="[object Promise]",kB="[object Set]",EB="[object WeakMap]",TB="[object DataView]",VZ=mo(W0),HZ=mo(G0),WZ=mo(U0),GZ=mo(K0),UZ=mo(j0),Za=AB;(W0&&Za(new W0(new ArrayBuffer(1)))!=TB||G0&&Za(new G0)!=SB||U0&&Za(U0.resolve())!=CB||K0&&Za(new K0)!=kB||j0&&Za(new j0)!=EB)&&(Za=function(r){var e=AB(r),t=e==zZ?r.constructor:void 0,n=t?mo(t):"";if(n)switch(n){case VZ:return TB;case HZ:return SB;case WZ:return CB;case GZ:return kB;case UZ:return EB}return e});MB.exports=Za});var PB=B((Ape,DB)=>{var KZ=Object.prototype,jZ=KZ.hasOwnProperty;function YZ(r){var e=r.length,t=new r.constructor(e);return e&&typeof r[0]=="string"&&jZ.call(r,"index")&&(t.index=r.index,t.input=r.input),t}DB.exports=YZ});var Y0=B((Mpe,BB)=>{var XZ=nn(),$Z=XZ.Uint8Array;BB.exports=$Z});var Qc=B((Dpe,RB)=>{var OB=Y0();function ZZ(r){var e=new r.constructor(r.byteLength);return new OB(e).set(new OB(r)),e}RB.exports=ZZ});var IB=B((Ppe,LB)=>{var QZ=Qc();function JZ(r,e){var t=e?QZ(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.byteLength)}LB.exports=JZ});var qB=B((Bpe,NB)=>{var eQ=/\w*$/;function tQ(r){var e=new r.constructor(r.source,eQ.exec(r));return e.lastIndex=r.lastIndex,e}NB.exports=tQ});var HB=B((Ope,VB)=>{var FB=Xa(),_B=FB?FB.prototype:void 0,zB=_B?_B.valueOf:void 0;function rQ(r){return zB?Object(zB.call(r)):{}}VB.exports=rQ});var X0=B((Rpe,WB)=>{var nQ=Qc();function iQ(r,e){var t=e?nQ(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.length)}WB.exports=iQ});var UB=B((Lpe,GB)=>{var aQ=Qc(),sQ=IB(),oQ=qB(),lQ=HB(),uQ=X0(),hQ="[object Boolean]",fQ="[object Date]",cQ="[object Map]",dQ="[object Number]",pQ="[object RegExp]",gQ="[object Set]",vQ="[object String]",mQ="[object Symbol]",yQ="[object ArrayBuffer]",bQ="[object DataView]",wQ="[object Float32Array]",xQ="[object Float64Array]",SQ="[object Int8Array]",CQ="[object Int16Array]",kQ="[object Int32Array]",EQ="[object Uint8Array]",TQ="[object Uint8ClampedArray]",AQ="[object Uint16Array]",MQ="[object Uint32Array]";function DQ(r,e,t){var n=r.constructor;switch(e){case yQ:return aQ(r);case hQ:case fQ:return new n(+r);case bQ:return sQ(r,t);case wQ:case xQ:case SQ:case CQ:case kQ:case EQ:case TQ:case AQ:case MQ:return uQ(r,t);case cQ:return new n;case dQ:case vQ:return new n(r);case pQ:return oQ(r);case gQ:return new n;case mQ:return lQ(r)}}GB.exports=DQ});var $0=B((Ipe,jB)=>{var PQ=Gr(),KB=Object.create,BQ=function(){function r(){}return function(e){if(!PQ(e))return{};if(KB)return KB(e);r.prototype=e;var t=new r;return r.prototype=void 0,t}}();jB.exports=BQ});var Z0=B((Npe,YB)=>{var OQ=$0(),RQ=Tu(),LQ=ku();function IQ(r){return typeof r.constructor=="function"&&!LQ(r)?OQ(RQ(r)):{}}YB.exports=IQ});var $B=B((qpe,XB)=>{var NQ=Qa(),qQ=xn(),FQ="[object Map]";function _Q(r){return qQ(r)&&NQ(r)==FQ}XB.exports=_Q});var eO=B((Fpe,JB)=>{var zQ=$B(),VQ=xu(),ZB=Yc(),QB=ZB&&ZB.isMap,HQ=QB?VQ(QB):zQ;JB.exports=HQ});var rO=B((_pe,tO)=>{var WQ=Qa(),GQ=xn(),UQ="[object Set]";function KQ(r){return GQ(r)&&WQ(r)==UQ}tO.exports=KQ});var sO=B((zpe,aO)=>{var jQ=rO(),YQ=xu(),nO=Yc(),iO=nO&&nO.isSet,XQ=iO?YQ(iO):jQ;aO.exports=XQ});var Q0=B((Vpe,hO)=>{var $Q=vu(),ZQ=Kc(),QQ=yu(),JQ=VP(),eJ=YP(),tJ=I0(),rJ=N0(),nJ=aB(),iJ=hB(),aJ=V0(),sJ=pB(),oJ=Qa(),lJ=PB(),uJ=UB(),hJ=Z0(),fJ=Pt(),cJ=$a(),dJ=eO(),pJ=Gr(),gJ=sO(),vJ=ui(),mJ=Zi(),yJ=1,bJ=2,wJ=4,oO="[object Arguments]",xJ="[object Array]",SJ="[object Boolean]",CJ="[object Date]",kJ="[object Error]",lO="[object Function]",EJ="[object GeneratorFunction]",TJ="[object Map]",AJ="[object Number]",uO="[object Object]",MJ="[object RegExp]",DJ="[object Set]",PJ="[object String]",BJ="[object Symbol]",OJ="[object WeakMap]",RJ="[object ArrayBuffer]",LJ="[object DataView]",IJ="[object Float32Array]",NJ="[object Float64Array]",qJ="[object Int8Array]",FJ="[object Int16Array]",_J="[object Int32Array]",zJ="[object Uint8Array]",VJ="[object Uint8ClampedArray]",HJ="[object Uint16Array]",WJ="[object Uint32Array]",yt={};yt[oO]=yt[xJ]=yt[RJ]=yt[LJ]=yt[SJ]=yt[CJ]=yt[IJ]=yt[NJ]=yt[qJ]=yt[FJ]=yt[_J]=yt[TJ]=yt[AJ]=yt[uO]=yt[MJ]=yt[DJ]=yt[PJ]=yt[BJ]=yt[zJ]=yt[VJ]=yt[HJ]=yt[WJ]=!0;yt[kJ]=yt[lO]=yt[OJ]=!1;function Jc(r,e,t,n,i,a){var s,o=e&yJ,l=e&bJ,u=e&wJ;if(t&&(s=i?t(r,n,i,a):t(r)),s!==void 0)return s;if(!pJ(r))return r;var h=fJ(r);if(h){if(s=lJ(r),!o)return rJ(r,s)}else{var f=oJ(r),c=f==lO||f==EJ;if(cJ(r))return tJ(r,o);if(f==uO||f==oO||c&&!i){if(s=l||c?{}:hJ(r),!o)return l?iJ(r,eJ(s,r)):nJ(r,JQ(s,r))}else{if(!yt[f])return i?r:{};s=uJ(r,f,o)}}a||(a=new $Q);var d=a.get(r);if(d)return d;a.set(r,s),gJ(r)?r.forEach(function(v){s.add(Jc(v,e,t,v,r,a))}):dJ(r)&&r.forEach(function(v,m){s.set(m,Jc(v,e,t,m,r,a))});var p=u?l?sJ:aJ:l?mJ:vJ,g=h?void 0:p(r);return ZQ(g||r,function(v,m){g&&(m=v,v=r[m]),QQ(s,m,Jc(v,e,t,m,r,a))}),s}hO.exports=Jc});var cO=B((Hpe,fO)=>{var GJ=Q0(),UJ=4;function KJ(r){return GJ(r,UJ)}fO.exports=KJ});var ed=B((Wpe,dO)=>{function jJ(r){return function(){return r}}dO.exports=jJ});var gO=B((Gpe,pO)=>{function YJ(r){return function(e,t,n){for(var i=-1,a=Object(e),s=n(e),o=s.length;o--;){var l=s[r?o:++i];if(t(a[l],l,a)===!1)break}return e}}pO.exports=YJ});var td=B((Upe,vO)=>{var XJ=gO(),$J=XJ();vO.exports=$J});var rd=B((Kpe,mO)=>{var ZJ=td(),QJ=ui();function JJ(r,e){return r&&ZJ(r,e,QJ)}mO.exports=JJ});var bO=B((jpe,yO)=>{var eee=Hn();function tee(r,e){return function(t,n){if(t==null)return t;if(!eee(t))return r(t,n);for(var i=t.length,a=e?i:-1,s=Object(t);(e?a--:++a<i)&&n(s[a],a,s)!==!1;);return t}}yO.exports=tee});var Au=B((Ype,wO)=>{var ree=rd(),nee=bO(),iee=nee(ree);wO.exports=iee});var Qi=B((Xpe,xO)=>{function aee(r){return r}xO.exports=aee});var J0=B(($pe,SO)=>{var see=Qi();function oee(r){return typeof r=="function"?r:see}SO.exports=oee});var eb=B((Zpe,CO)=>{var lee=Kc(),uee=Au(),hee=J0(),fee=Pt();function cee(r,e){var t=fee(r)?lee:uee;return t(r,hee(e))}CO.exports=cee});var tb=B((Qpe,kO)=>{kO.exports=eb()});var TO=B((Jpe,EO)=>{var dee=Au();function pee(r,e){var t=[];return dee(r,function(n,i,a){e(n,i,a)&&t.push(n)}),t}EO.exports=pee});var MO=B((ege,AO)=>{var gee="__lodash_hash_undefined__";function vee(r){return this.__data__.set(r,gee),this}AO.exports=vee});var PO=B((tge,DO)=>{function mee(r){return this.__data__.has(r)}DO.exports=mee});var rb=B((rge,BO)=>{var yee=Uc(),bee=MO(),wee=PO();function nd(r){var e=-1,t=r==null?0:r.length;for(this.__data__=new yee;++e<t;)this.add(r[e])}nd.prototype.add=nd.prototype.push=bee;nd.prototype.has=wee;BO.exports=nd});var RO=B((nge,OO)=>{function xee(r,e){for(var t=-1,n=r==null?0:r.length;++t<n;)if(e(r[t],t,r))return!0;return!1}OO.exports=xee});var nb=B((ige,LO)=>{function See(r,e){return r.has(e)}LO.exports=See});var ib=B((age,IO)=>{var Cee=rb(),kee=RO(),Eee=nb(),Tee=1,Aee=2;function Mee(r,e,t,n,i,a){var s=t&Tee,o=r.length,l=e.length;if(o!=l&&!(s&&l>o))return!1;var u=a.get(r),h=a.get(e);if(u&&h)return u==e&&h==r;var f=-1,c=!0,d=t&Aee?new Cee:void 0;for(a.set(r,e),a.set(e,r);++f<o;){var p=r[f],g=e[f];if(n)var v=s?n(g,p,f,e,r,a):n(p,g,f,r,e,a);if(v!==void 0){if(v)continue;c=!1;break}if(d){if(!kee(e,function(m,y){if(!Eee(d,y)&&(p===m||i(p,m,t,n,a)))return d.push(y)})){c=!1;break}}else if(!(p===g||i(p,g,t,n,a))){c=!1;break}}return a.delete(r),a.delete(e),c}IO.exports=Mee});var qO=B((sge,NO)=>{function Dee(r){var e=-1,t=Array(r.size);return r.forEach(function(n,i){t[++e]=[i,n]}),t}NO.exports=Dee});var id=B((oge,FO)=>{function Pee(r){var e=-1,t=Array(r.size);return r.forEach(function(n){t[++e]=n}),t}FO.exports=Pee});var WO=B((lge,HO)=>{var _O=Xa(),zO=Y0(),Bee=Ya(),Oee=ib(),Ree=qO(),Lee=id(),Iee=1,Nee=2,qee="[object Boolean]",Fee="[object Date]",_ee="[object Error]",zee="[object Map]",Vee="[object Number]",Hee="[object RegExp]",Wee="[object Set]",Gee="[object String]",Uee="[object Symbol]",Kee="[object ArrayBuffer]",jee="[object DataView]",VO=_O?_O.prototype:void 0,ab=VO?VO.valueOf:void 0;function Yee(r,e,t,n,i,a,s){switch(t){case jee:if(r.byteLength!=e.byteLength||r.byteOffset!=e.byteOffset)return!1;r=r.buffer,e=e.buffer;case Kee:return!(r.byteLength!=e.byteLength||!a(new zO(r),new zO(e)));case qee:case Fee:case Vee:return Bee(+r,+e);case _ee:return r.name==e.name&&r.message==e.message;case Hee:case Gee:return r==e+"";case zee:var o=Ree;case Wee:var l=n&Iee;if(o||(o=Lee),r.size!=e.size&&!l)return!1;var u=s.get(r);if(u)return u==e;n|=Nee,s.set(r,e);var h=Oee(o(r),o(e),n,i,a,s);return s.delete(r),h;case Uee:if(ab)return ab.call(r)==ab.call(e)}return!1}HO.exports=Yee});var KO=B((uge,UO)=>{var GO=V0(),Xee=1,$ee=Object.prototype,Zee=$ee.hasOwnProperty;function Qee(r,e,t,n,i,a){var s=t&Xee,o=GO(r),l=o.length,u=GO(e),h=u.length;if(l!=h&&!s)return!1;for(var f=l;f--;){var c=o[f];if(!(s?c in e:Zee.call(e,c)))return!1}var d=a.get(r),p=a.get(e);if(d&&p)return d==e&&p==r;var g=!0;a.set(r,e),a.set(e,r);for(var v=s;++f<l;){c=o[f];var m=r[c],y=e[c];if(n)var b=s?n(y,m,c,e,r,a):n(m,y,c,r,e,a);if(!(b===void 0?m===y||i(m,y,t,n,a):b)){g=!1;break}v||(v=c=="constructor")}if(g&&!v){var w=r.constructor,S=e.constructor;w!=S&&"constructor"in r&&"constructor"in e&&!(typeof w=="function"&&w instanceof w&&typeof S=="function"&&S instanceof S)&&(g=!1)}return a.delete(r),a.delete(e),g}UO.exports=Qee});var eR=B((hge,JO)=>{var sb=vu(),Jee=ib(),ete=WO(),tte=KO(),jO=Qa(),YO=Pt(),XO=$a(),rte=go(),nte=1,$O="[object Arguments]",ZO="[object Array]",ad="[object Object]",ite=Object.prototype,QO=ite.hasOwnProperty;function ate(r,e,t,n,i,a){var s=YO(r),o=YO(e),l=s?ZO:jO(r),u=o?ZO:jO(e);l=l==$O?ad:l,u=u==$O?ad:u;var h=l==ad,f=u==ad,c=l==u;if(c&&XO(r)){if(!XO(e))return!1;s=!0,h=!1}if(c&&!h)return a||(a=new sb),s||rte(r)?Jee(r,e,t,n,i,a):ete(r,e,l,t,n,i,a);if(!(t&nte)){var d=h&&QO.call(r,"__wrapped__"),p=f&&QO.call(e,"__wrapped__");if(d||p){var g=d?r.value():r,v=p?e.value():e;return a||(a=new sb),i(g,v,t,n,a)}}return c?(a||(a=new sb),tte(r,e,t,n,i,a)):!1}JO.exports=ate});var ob=B((fge,nR)=>{var ste=eR(),tR=xn();function rR(r,e,t,n,i){return r===e?!0:r==null||e==null||!tR(r)&&!tR(e)?r!==r&&e!==e:ste(r,e,t,n,rR,i)}nR.exports=rR});var aR=B((cge,iR)=>{var ote=vu(),lte=ob(),ute=1,hte=2;function fte(r,e,t,n){var i=t.length,a=i,s=!n;if(r==null)return!a;for(r=Object(r);i--;){var o=t[i];if(s&&o[2]?o[1]!==r[o[0]]:!(o[0]in r))return!1}for(;++i<a;){o=t[i];var l=o[0],u=r[l],h=o[1];if(s&&o[2]){if(u===void 0&&!(l in r))return!1}else{var f=new ote;if(n)var c=n(u,h,l,r,e,f);if(!(c===void 0?lte(h,u,ute|hte,n,f):c))return!1}}return!0}iR.exports=fte});var lb=B((dge,sR)=>{var cte=Gr();function dte(r){return r===r&&!cte(r)}sR.exports=dte});var lR=B((pge,oR)=>{var pte=lb(),gte=ui();function vte(r){for(var e=gte(r),t=e.length;t--;){var n=e[t],i=r[n];e[t]=[n,i,pte(i)]}return e}oR.exports=vte});var ub=B((gge,uR)=>{function mte(r,e){return function(t){return t==null?!1:t[r]===e&&(e!==void 0||r in Object(t))}}uR.exports=mte});var fR=B((vge,hR)=>{var yte=aR(),bte=lR(),wte=ub();function xte(r){var e=bte(r);return e.length==1&&e[0][2]?wte(e[0][0],e[0][1]):function(t){return t===r||yte(t,r,e)}}hR.exports=xte});var Ja=B((mge,cR)=>{var Ste=Xi(),Cte=xn(),kte="[object Symbol]";function Ete(r){return typeof r=="symbol"||Cte(r)&&Ste(r)==kte}cR.exports=Ete});var sd=B((yge,dR)=>{var Tte=Pt(),Ate=Ja(),Mte=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dte=/^\w*$/;function Pte(r,e){if(Tte(r))return!1;var t=typeof r;return t=="number"||t=="symbol"||t=="boolean"||r==null||Ate(r)?!0:Dte.test(r)||!Mte.test(r)||e!=null&&r in Object(e)}dR.exports=Pte});var vR=B((bge,gR)=>{var pR=Uc(),Bte="Expected a function";function hb(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(Bte);var t=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=t.cache;if(a.has(i))return a.get(i);var s=r.apply(this,n);return t.cache=a.set(i,s)||a,s};return t.cache=new(hb.Cache||pR),t}hb.Cache=pR;gR.exports=hb});var yR=B((wge,mR)=>{var Ote=vR(),Rte=500;function Lte(r){var e=Ote(r,function(n){return t.size===Rte&&t.clear(),n}),t=e.cache;return e}mR.exports=Lte});var wR=B((xge,bR)=>{var Ite=yR(),Nte=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,qte=/\\(\\)?/g,Fte=Ite(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(Nte,function(t,n,i,a){e.push(i?a.replace(qte,"$1"):n||t)}),e});bR.exports=Fte});var Mu=B((Sge,xR)=>{function _te(r,e){for(var t=-1,n=r==null?0:r.length,i=Array(n);++t<n;)i[t]=e(r[t],t,r);return i}xR.exports=_te});var AR=B((Cge,TR)=>{var SR=Xa(),zte=Mu(),Vte=Pt(),Hte=Ja(),Wte=1/0,CR=SR?SR.prototype:void 0,kR=CR?CR.toString:void 0;function ER(r){if(typeof r=="string")return r;if(Vte(r))return zte(r,ER)+"";if(Hte(r))return kR?kR.call(r):"";var e=r+"";return e=="0"&&1/r==-Wte?"-0":e}TR.exports=ER});var fb=B((kge,MR)=>{var Gte=AR();function Ute(r){return r==null?"":Gte(r)}MR.exports=Ute});var Du=B((Ege,DR)=>{var Kte=Pt(),jte=sd(),Yte=wR(),Xte=fb();function $te(r,e){return Kte(r)?r:jte(r,e)?[r]:Yte(Xte(r))}DR.exports=$te});var yo=B((Tge,PR)=>{var Zte=Ja(),Qte=1/0;function Jte(r){if(typeof r=="string"||Zte(r))return r;var e=r+"";return e=="0"&&1/r==-Qte?"-0":e}PR.exports=Jte});var Pu=B((Age,BR)=>{var ere=Du(),tre=yo();function rre(r,e){e=ere(e,r);for(var t=0,n=e.length;r!=null&&t<n;)r=r[tre(e[t++])];return t&&t==n?r:void 0}BR.exports=rre});var RR=B((Mge,OR)=>{var nre=Pu();function ire(r,e,t){var n=r==null?void 0:nre(r,e);return n===void 0?t:n}OR.exports=ire});var IR=B((Dge,LR)=>{function are(r,e){return r!=null&&e in Object(r)}LR.exports=are});var cb=B((Pge,NR)=>{var sre=Du(),ore=fo(),lre=Pt(),ure=wu(),hre=jc(),fre=yo();function cre(r,e,t){e=sre(e,r);for(var n=-1,i=e.length,a=!1;++n<i;){var s=fre(e[n]);if(!(a=r!=null&&t(r,s)))break;r=r[s]}return a||++n!=i?a:(i=r==null?0:r.length,!!i&&hre(i)&&ure(s,i)&&(lre(r)||ore(r)))}NR.exports=cre});var db=B((Bge,qR)=>{var dre=IR(),pre=cb();function gre(r,e){return r!=null&&pre(r,e,dre)}qR.exports=gre});var _R=B((Oge,FR)=>{var vre=ob(),mre=RR(),yre=db(),bre=sd(),wre=lb(),xre=ub(),Sre=yo(),Cre=1,kre=2;function Ere(r,e){return bre(r)&&wre(e)?xre(Sre(r),e):function(t){var n=mre(t,r);return n===void 0&&n===e?yre(t,r):vre(e,n,Cre|kre)}}FR.exports=Ere});var pb=B((Rge,zR)=>{function Tre(r){return function(e){return e?.[r]}}zR.exports=Tre});var HR=B((Lge,VR)=>{var Are=Pu();function Mre(r){return function(e){return Are(e,r)}}VR.exports=Mre});var GR=B((Ige,WR)=>{var Dre=pb(),Pre=HR(),Bre=sd(),Ore=yo();function Rre(r){return Bre(r)?Dre(Ore(r)):Pre(r)}WR.exports=Rre});var Wn=B((Nge,UR)=>{var Lre=fR(),Ire=_R(),Nre=Qi(),qre=Pt(),Fre=GR();function _re(r){return typeof r=="function"?r:r==null?Nre:typeof r=="object"?qre(r)?Ire(r[0],r[1]):Lre(r):Fre(r)}UR.exports=_re});var gb=B((qge,KR)=>{var zre=q0(),Vre=TO(),Hre=Wn(),Wre=Pt();function Gre(r,e){var t=Wre(r)?zre:Vre;return t(r,Hre(e,3))}KR.exports=Gre});var YR=B((Fge,jR)=>{var Ure=Object.prototype,Kre=Ure.hasOwnProperty;function jre(r,e){return r!=null&&Kre.call(r,e)}jR.exports=jre});var vb=B((_ge,XR)=>{var Yre=YR(),Xre=cb();function $re(r,e){return r!=null&&Xre(r,e,Yre)}XR.exports=$re});var ZR=B((zge,$R)=>{var Zre=Xc(),Qre=Qa(),Jre=fo(),ene=Pt(),tne=Hn(),rne=$a(),nne=ku(),ine=go(),ane="[object Map]",sne="[object Set]",one=Object.prototype,lne=one.hasOwnProperty;function une(r){if(r==null)return!0;if(tne(r)&&(ene(r)||typeof r=="string"||typeof r.splice=="function"||rne(r)||ine(r)||Jre(r)))return!r.length;var e=Qre(r);if(e==ane||e==sne)return!r.size;if(nne(r))return!Zre(r).length;for(var t in r)if(lne.call(r,t))return!1;return!0}$R.exports=une});var mb=B((Vge,QR)=>{function hne(r){return r===void 0}QR.exports=hne});var yb=B((Hge,JR)=>{var fne=Au(),cne=Hn();function dne(r,e){var t=-1,n=cne(r)?Array(r.length):[];return fne(r,function(i,a,s){n[++t]=e(i,a,s)}),n}JR.exports=dne});var bb=B((Wge,eL)=>{var pne=Mu(),gne=Wn(),vne=yb(),mne=Pt();function yne(r,e){var t=mne(r)?pne:vne;return t(r,gne(e,3))}eL.exports=yne});var rL=B((Gge,tL)=>{function bne(r,e,t,n){var i=-1,a=r==null?0:r.length;for(n&&a&&(t=r[++i]);++i<a;)t=e(t,r[i],i,r);return t}tL.exports=bne});var iL=B((Uge,nL)=>{function wne(r,e,t,n,i){return i(r,function(a,s,o){t=n?(n=!1,a):e(t,a,s,o)}),t}nL.exports=wne});var wb=B((Kge,aL)=>{var xne=rL(),Sne=Au(),Cne=Wn(),kne=iL(),Ene=Pt();function Tne(r,e,t){var n=Ene(r)?xne:kne,i=arguments.length<3;return n(r,Cne(e,4),t,i,Sne)}aL.exports=Tne});var oL=B((jge,sL)=>{var Ane=Xi(),Mne=Pt(),Dne=xn(),Pne="[object String]";function Bne(r){return typeof r=="string"||!Mne(r)&&Dne(r)&&Ane(r)==Pne}sL.exports=Bne});var uL=B((Yge,lL)=>{var One=pb(),Rne=One("length");lL.exports=Rne});var fL=B((Xge,hL)=>{var Lne="\\ud800-\\udfff",Ine="\\u0300-\\u036f",Nne="\\ufe20-\\ufe2f",qne="\\u20d0-\\u20ff",Fne=Ine+Nne+qne,_ne="\\ufe0e\\ufe0f",zne="\\u200d",Vne=RegExp("["+zne+Lne+Fne+_ne+"]");function Hne(r){return Vne.test(r)}hL.exports=Hne});var wL=B(($ge,bL)=>{var dL="\\ud800-\\udfff",Wne="\\u0300-\\u036f",Gne="\\ufe20-\\ufe2f",Une="\\u20d0-\\u20ff",Kne=Wne+Gne+Une,jne="\\ufe0e\\ufe0f",Yne="["+dL+"]",xb="["+Kne+"]",Sb="\\ud83c[\\udffb-\\udfff]",Xne="(?:"+xb+"|"+Sb+")",pL="[^"+dL+"]",gL="(?:\\ud83c[\\udde6-\\uddff]){2}",vL="[\\ud800-\\udbff][\\udc00-\\udfff]",$ne="\\u200d",mL=Xne+"?",yL="["+jne+"]?",Zne="(?:"+$ne+"(?:"+[pL,gL,vL].join("|")+")"+yL+mL+")*",Qne=yL+mL+Zne,Jne="(?:"+[pL+xb+"?",xb,gL,vL,Yne].join("|")+")",cL=RegExp(Sb+"(?="+Sb+")|"+Jne+Qne,"g");function eie(r){for(var e=cL.lastIndex=0;cL.test(r);)++e;return e}bL.exports=eie});var SL=B((Zge,xL)=>{var tie=uL(),rie=fL(),nie=wL();function iie(r){return rie(r)?nie(r):tie(r)}xL.exports=iie});var kL=B((Qge,CL)=>{var aie=Xc(),sie=Qa(),oie=Hn(),lie=oL(),uie=SL(),hie="[object Map]",fie="[object Set]";function cie(r){if(r==null)return 0;if(oie(r))return lie(r)?uie(r):r.length;var e=sie(r);return e==hie||e==fie?r.size:aie(r).length}CL.exports=cie});var TL=B((Jge,EL)=>{var die=Kc(),pie=$0(),gie=rd(),vie=Wn(),mie=Tu(),yie=Pt(),bie=$a(),wie=so(),xie=Gr(),Sie=go();function Cie(r,e,t){var n=yie(r),i=n||bie(r)||Sie(r);if(e=vie(e,4),t==null){var a=r&&r.constructor;i?t=n?new a:[]:xie(r)?t=wie(a)?pie(mie(r)):{}:t={}}return(i?die:gie)(r,function(s,o,l){return e(t,s,o,l)}),t}EL.exports=Cie});var PL=B((eve,DL)=>{var AL=Xa(),kie=fo(),Eie=Pt(),ML=AL?AL.isConcatSpreadable:void 0;function Tie(r){return Eie(r)||kie(r)||!!(ML&&r&&r[ML])}DL.exports=Tie});var od=B((tve,OL)=>{var Aie=Zc(),Mie=PL();function BL(r,e,t,n,i){var a=-1,s=r.length;for(t||(t=Mie),i||(i=[]);++a<s;){var o=r[a];e>0&&t(o)?e>1?BL(o,e-1,t,n,i):Aie(i,o):n||(i[i.length]=o)}return i}OL.exports=BL});var LL=B((rve,RL)=>{function Die(r,e,t){switch(t.length){case 0:return r.call(e);case 1:return r.call(e,t[0]);case 2:return r.call(e,t[0],t[1]);case 3:return r.call(e,t[0],t[1],t[2])}return r.apply(e,t)}RL.exports=Die});var Cb=B((nve,NL)=>{var Pie=LL(),IL=Math.max;function Bie(r,e,t){return e=IL(e===void 0?r.length-1:e,0),function(){for(var n=arguments,i=-1,a=IL(n.length-e,0),s=Array(a);++i<a;)s[i]=n[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=n[i];return o[e]=t(s),Pie(r,this,o)}}NL.exports=Bie});var _L=B((ive,FL)=>{var Oie=ed(),qL=B0(),Rie=Qi(),Lie=qL?function(r,e){return qL(r,"toString",{configurable:!0,enumerable:!1,value:Oie(e),writable:!0})}:Rie;FL.exports=Lie});var VL=B((ave,zL)=>{var Iie=800,Nie=16,qie=Date.now;function Fie(r){var e=0,t=0;return function(){var n=qie(),i=Nie-(n-t);if(t=n,i>0){if(++e>=Iie)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}zL.exports=Fie});var kb=B((sve,HL)=>{var _ie=_L(),zie=VL(),Vie=zie(_ie);HL.exports=Vie});var Bu=B((ove,WL)=>{var Hie=Qi(),Wie=Cb(),Gie=kb();function Uie(r,e){return Gie(Wie(r,e,Hie),r+"")}WL.exports=Uie});var Eb=B((lve,GL)=>{function Kie(r,e,t,n){for(var i=r.length,a=t+(n?1:-1);n?a--:++a<i;)if(e(r[a],a,r))return a;return-1}GL.exports=Kie});var KL=B((uve,UL)=>{function jie(r){return r!==r}UL.exports=jie});var YL=B((hve,jL)=>{function Yie(r,e,t){for(var n=t-1,i=r.length;++n<i;)if(r[n]===e)return n;return-1}jL.exports=Yie});var $L=B((fve,XL)=>{var Xie=Eb(),$ie=KL(),Zie=YL();function Qie(r,e,t){return e===e?Zie(r,e,t):Xie(r,$ie,t)}XL.exports=Qie});var QL=B((cve,ZL)=>{var Jie=$L();function eae(r,e){var t=r==null?0:r.length;return!!t&&Jie(r,e,0)>-1}ZL.exports=eae});var eI=B((dve,JL)=>{function tae(r,e,t){for(var n=-1,i=r==null?0:r.length;++n<i;)if(t(e,r[n]))return!0;return!1}JL.exports=tae});var rI=B((pve,tI)=>{function rae(){}tI.exports=rae});var iI=B((gve,nI)=>{var Tb=H0(),nae=rI(),iae=id(),aae=1/0,sae=Tb&&1/iae(new Tb([,-0]))[1]==aae?function(r){return new Tb(r)}:nae;nI.exports=sae});var sI=B((vve,aI)=>{var oae=rb(),lae=QL(),uae=eI(),hae=nb(),fae=iI(),cae=id(),dae=200;function pae(r,e,t){var n=-1,i=lae,a=r.length,s=!0,o=[],l=o;if(t)s=!1,i=uae;else if(a>=dae){var u=e?null:fae(r);if(u)return cae(u);s=!1,i=hae,l=new oae}else l=e?[]:o;e:for(;++n<a;){var h=r[n],f=e?e(h):h;if(h=t||h!==0?h:0,s&&f===f){for(var c=l.length;c--;)if(l[c]===f)continue e;e&&l.push(f),o.push(h)}else i(l,f,t)||(l!==o&&l.push(f),o.push(h))}return o}aI.exports=pae});var Ab=B((mve,oI)=>{var gae=Hn(),vae=xn();function mae(r){return vae(r)&&gae(r)}oI.exports=mae});var uI=B((yve,lI)=>{var yae=od(),bae=Bu(),wae=sI(),xae=Ab(),Sae=bae(function(r){return wae(yae(r,1,xae,!0))});lI.exports=Sae});var fI=B((bve,hI)=>{var Cae=Mu();function kae(r,e){return Cae(e,function(t){return r[t]})}hI.exports=kae});var Mb=B((wve,cI)=>{var Eae=fI(),Tae=ui();function Aae(r){return r==null?[]:Eae(r,Tae(r))}cI.exports=Aae});var Ur=B((xve,dI)=>{var ld;if(typeof is=="function")try{ld={clone:cO(),constant:ed(),each:tb(),filter:gb(),has:vb(),isArray:Pt(),isEmpty:ZR(),isFunction:so(),isUndefined:mb(),keys:ui(),map:bb(),reduce:wb(),size:kL(),transform:TL(),union:uI(),values:Mb()}}catch{}ld||(ld=window._);dI.exports=ld});var ud=B((Cve,mI)=>{"use strict";var Oe=Ur();mI.exports=He;var Mae="\0",es="\0",pI="";function He(r){this._isDirected=Oe.has(r,"directed")?r.directed:!0,this._isMultigraph=Oe.has(r,"multigraph")?r.multigraph:!1,this._isCompound=Oe.has(r,"compound")?r.compound:!1,this._label=void 0,this._defaultNodeLabelFn=Oe.constant(void 0),this._defaultEdgeLabelFn=Oe.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[es]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}He.prototype._nodeCount=0;He.prototype._edgeCount=0;He.prototype.isDirected=function(){return this._isDirected};He.prototype.isMultigraph=function(){return this._isMultigraph};He.prototype.isCompound=function(){return this._isCompound};He.prototype.setGraph=function(r){return this._label=r,this};He.prototype.graph=function(){return this._label};He.prototype.setDefaultNodeLabel=function(r){return Oe.isFunction(r)||(r=Oe.constant(r)),this._defaultNodeLabelFn=r,this};He.prototype.nodeCount=function(){return this._nodeCount};He.prototype.nodes=function(){return Oe.keys(this._nodes)};He.prototype.sources=function(){var r=this;return Oe.filter(this.nodes(),function(e){return Oe.isEmpty(r._in[e])})};He.prototype.sinks=function(){var r=this;return Oe.filter(this.nodes(),function(e){return Oe.isEmpty(r._out[e])})};He.prototype.setNodes=function(r,e){var t=arguments,n=this;return Oe.each(r,function(i){t.length>1?n.setNode(i,e):n.setNode(i)}),this};He.prototype.setNode=function(r,e){return Oe.has(this._nodes,r)?(arguments.length>1&&(this._nodes[r]=e),this):(this._nodes[r]=arguments.length>1?e:this._defaultNodeLabelFn(r),this._isCompound&&(this._parent[r]=es,this._children[r]={},this._children[es][r]=!0),this._in[r]={},this._preds[r]={},this._out[r]={},this._sucs[r]={},++this._nodeCount,this)};He.prototype.node=function(r){return this._nodes[r]};He.prototype.hasNode=function(r){return Oe.has(this._nodes,r)};He.prototype.removeNode=function(r){var e=this;if(Oe.has(this._nodes,r)){var t=function(n){e.removeEdge(e._edgeObjs[n])};delete this._nodes[r],this._isCompound&&(this._removeFromParentsChildList(r),delete this._parent[r],Oe.each(this.children(r),function(n){e.setParent(n)}),delete this._children[r]),Oe.each(Oe.keys(this._in[r]),t),delete this._in[r],delete this._preds[r],Oe.each(Oe.keys(this._out[r]),t),delete this._out[r],delete this._sucs[r],--this._nodeCount}return this};He.prototype.setParent=function(r,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(Oe.isUndefined(e))e=es;else{e+="";for(var t=e;!Oe.isUndefined(t);t=this.parent(t))if(t===r)throw new Error("Setting "+e+" as parent of "+r+" would create a cycle");this.setNode(e)}return this.setNode(r),this._removeFromParentsChildList(r),this._parent[r]=e,this._children[e][r]=!0,this};He.prototype._removeFromParentsChildList=function(r){delete this._children[this._parent[r]][r]};He.prototype.parent=function(r){if(this._isCompound){var e=this._parent[r];if(e!==es)return e}};He.prototype.children=function(r){if(Oe.isUndefined(r)&&(r=es),this._isCompound){var e=this._children[r];if(e)return Oe.keys(e)}else{if(r===es)return this.nodes();if(this.hasNode(r))return[]}};He.prototype.predecessors=function(r){var e=this._preds[r];if(e)return Oe.keys(e)};He.prototype.successors=function(r){var e=this._sucs[r];if(e)return Oe.keys(e)};He.prototype.neighbors=function(r){var e=this.predecessors(r);if(e)return Oe.union(e,this.successors(r))};He.prototype.isLeaf=function(r){var e;return this.isDirected()?e=this.successors(r):e=this.neighbors(r),e.length===0};He.prototype.filterNodes=function(r){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var t=this;Oe.each(this._nodes,function(a,s){r(s)&&e.setNode(s,a)}),Oe.each(this._edgeObjs,function(a){e.hasNode(a.v)&&e.hasNode(a.w)&&e.setEdge(a,t.edge(a))});var n={};function i(a){var s=t.parent(a);return s===void 0||e.hasNode(s)?(n[a]=s,s):s in n?n[s]:i(s)}return this._isCompound&&Oe.each(e.nodes(),function(a){e.setParent(a,i(a))}),e};He.prototype.setDefaultEdgeLabel=function(r){return Oe.isFunction(r)||(r=Oe.constant(r)),this._defaultEdgeLabelFn=r,this};He.prototype.edgeCount=function(){return this._edgeCount};He.prototype.edges=function(){return Oe.values(this._edgeObjs)};He.prototype.setPath=function(r,e){var t=this,n=arguments;return Oe.reduce(r,function(i,a){return n.length>1?t.setEdge(i,a,e):t.setEdge(i,a),a}),this};He.prototype.setEdge=function(){var r,e,t,n,i=!1,a=arguments[0];typeof a=="object"&&a!==null&&"v"in a?(r=a.v,e=a.w,t=a.name,arguments.length===2&&(n=arguments[1],i=!0)):(r=a,e=arguments[1],t=arguments[3],arguments.length>2&&(n=arguments[2],i=!0)),r=""+r,e=""+e,Oe.isUndefined(t)||(t=""+t);var s=Ou(this._isDirected,r,e,t);if(Oe.has(this._edgeLabels,s))return i&&(this._edgeLabels[s]=n),this;if(!Oe.isUndefined(t)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(r),this.setNode(e),this._edgeLabels[s]=i?n:this._defaultEdgeLabelFn(r,e,t);var o=Dae(this._isDirected,r,e,t);return r=o.v,e=o.w,Object.freeze(o),this._edgeObjs[s]=o,gI(this._preds[e],r),gI(this._sucs[r],e),this._in[e][s]=o,this._out[r][s]=o,this._edgeCount++,this};He.prototype.edge=function(r,e,t){var n=arguments.length===1?Db(this._isDirected,arguments[0]):Ou(this._isDirected,r,e,t);return this._edgeLabels[n]};He.prototype.hasEdge=function(r,e,t){var n=arguments.length===1?Db(this._isDirected,arguments[0]):Ou(this._isDirected,r,e,t);return Oe.has(this._edgeLabels,n)};He.prototype.removeEdge=function(r,e,t){var n=arguments.length===1?Db(this._isDirected,arguments[0]):Ou(this._isDirected,r,e,t),i=this._edgeObjs[n];return i&&(r=i.v,e=i.w,delete this._edgeLabels[n],delete this._edgeObjs[n],vI(this._preds[e],r),vI(this._sucs[r],e),delete this._in[e][n],delete this._out[r][n],this._edgeCount--),this};He.prototype.inEdges=function(r,e){var t=this._in[r];if(t){var n=Oe.values(t);return e?Oe.filter(n,function(i){return i.v===e}):n}};He.prototype.outEdges=function(r,e){var t=this._out[r];if(t){var n=Oe.values(t);return e?Oe.filter(n,function(i){return i.w===e}):n}};He.prototype.nodeEdges=function(r,e){var t=this.inEdges(r,e);if(t)return t.concat(this.outEdges(r,e))};function gI(r,e){r[e]?r[e]++:r[e]=1}function vI(r,e){--r[e]||delete r[e]}function Ou(r,e,t,n){var i=""+e,a=""+t;if(!r&&i>a){var s=i;i=a,a=s}return i+pI+a+pI+(Oe.isUndefined(n)?Mae:n)}function Dae(r,e,t,n){var i=""+e,a=""+t;if(!r&&i>a){var s=i;i=a,a=s}var o={v:i,w:a};return n&&(o.name=n),o}function Db(r,e){return Ou(r,e.v,e.w,e.name)}});var bI=B((kve,yI)=>{yI.exports="2.1.8"});var xI=B((Eve,wI)=>{wI.exports={Graph:ud(),version:bI()}});var CI=B((Tve,SI)=>{var Gn=Ur(),Pae=ud();SI.exports={write:Bae,read:Lae};function Bae(r){var e={options:{directed:r.isDirected(),multigraph:r.isMultigraph(),compound:r.isCompound()},nodes:Oae(r),edges:Rae(r)};return Gn.isUndefined(r.graph())||(e.value=Gn.clone(r.graph())),e}function Oae(r){return Gn.map(r.nodes(),function(e){var t=r.node(e),n=r.parent(e),i={v:e};return Gn.isUndefined(t)||(i.value=t),Gn.isUndefined(n)||(i.parent=n),i})}function Rae(r){return Gn.map(r.edges(),function(e){var t=r.edge(e),n={v:e.v,w:e.w};return Gn.isUndefined(e.name)||(n.name=e.name),Gn.isUndefined(t)||(n.value=t),n})}function Lae(r){var e=new Pae(r.options).setGraph(r.value);return Gn.each(r.nodes,function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)}),Gn.each(r.edges,function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)}),e}});var EI=B((Ave,kI)=>{var hd=Ur();kI.exports=Iae;function Iae(r){var e={},t=[],n;function i(a){hd.has(e,a)||(e[a]=!0,n.push(a),hd.each(r.successors(a),i),hd.each(r.predecessors(a),i))}return hd.each(r.nodes(),function(a){n=[],i(a),n.length&&t.push(n)}),t}});var Pb=B((Mve,AI)=>{var TI=Ur();AI.exports=an;function an(){this._arr=[],this._keyIndices={}}an.prototype.size=function(){return this._arr.length};an.prototype.keys=function(){return this._arr.map(function(r){return r.key})};an.prototype.has=function(r){return TI.has(this._keyIndices,r)};an.prototype.priority=function(r){var e=this._keyIndices[r];if(e!==void 0)return this._arr[e].priority};an.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key};an.prototype.add=function(r,e){var t=this._keyIndices;if(r=String(r),!TI.has(t,r)){var n=this._arr,i=n.length;return t[r]=i,n.push({key:r,priority:e}),this._decrease(i),!0}return!1};an.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key};an.prototype.decrease=function(r,e){var t=this._keyIndices[r];if(e>this._arr[t].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[t].priority+" New: "+e);this._arr[t].priority=e,this._decrease(t)};an.prototype._heapify=function(r){var e=this._arr,t=2*r,n=t+1,i=r;t<e.length&&(i=e[t].priority<e[i].priority?t:i,n<e.length&&(i=e[n].priority<e[i].priority?n:i),i!==r&&(this._swap(r,i),this._heapify(i)))};an.prototype._decrease=function(r){for(var e=this._arr,t=e[r].priority,n;r!==0&&(n=r>>1,!(e[n].priority<t));)this._swap(r,n),r=n};an.prototype._swap=function(r,e){var t=this._arr,n=this._keyIndices,i=t[r],a=t[e];t[r]=a,t[e]=i,n[a.key]=r,n[i.key]=e}});var Bb=B((Dve,MI)=>{var Nae=Ur(),qae=Pb();MI.exports=_ae;var Fae=Nae.constant(1);function _ae(r,e,t,n){return zae(r,String(e),t||Fae,n||function(i){return r.outEdges(i)})}function zae(r,e,t,n){var i={},a=new qae,s,o,l=function(u){var h=u.v!==s?u.v:u.w,f=i[h],c=t(u),d=o.distance+c;if(c<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+u+" Weight: "+c);d<f.distance&&(f.distance=d,f.predecessor=s,a.decrease(h,d))};for(r.nodes().forEach(function(u){var h=u===e?0:Number.POSITIVE_INFINITY;i[u]={distance:h},a.add(u,h)});a.size()>0&&(s=a.removeMin(),o=i[s],o.distance!==Number.POSITIVE_INFINITY);)n(s).forEach(l);return i}});var PI=B((Pve,DI)=>{var Vae=Bb(),Hae=Ur();DI.exports=Wae;function Wae(r,e,t){return Hae.transform(r.nodes(),function(n,i){n[i]=Vae(r,i,e,t)},{})}});var Ob=B((Bve,OI)=>{var BI=Ur();OI.exports=Gae;function Gae(r){var e=0,t=[],n={},i=[];function a(s){var o=n[s]={onStack:!0,lowlink:e,index:e++};if(t.push(s),r.successors(s).forEach(function(h){BI.has(n,h)?n[h].onStack&&(o.lowlink=Math.min(o.lowlink,n[h].index)):(a(h),o.lowlink=Math.min(o.lowlink,n[h].lowlink))}),o.lowlink===o.index){var l=[],u;do u=t.pop(),n[u].onStack=!1,l.push(u);while(s!==u);i.push(l)}}return r.nodes().forEach(function(s){BI.has(n,s)||a(s)}),i}});var LI=B((Ove,RI)=>{var Uae=Ur(),Kae=Ob();RI.exports=jae;function jae(r){return Uae.filter(Kae(r),function(e){return e.length>1||e.length===1&&r.hasEdge(e[0],e[0])})}});var NI=B((Rve,II)=>{var Yae=Ur();II.exports=$ae;var Xae=Yae.constant(1);function $ae(r,e,t){return Zae(r,e||Xae,t||function(n){return r.outEdges(n)})}function Zae(r,e,t){var n={},i=r.nodes();return i.forEach(function(a){n[a]={},n[a][a]={distance:0},i.forEach(function(s){a!==s&&(n[a][s]={distance:Number.POSITIVE_INFINITY})}),t(a).forEach(function(s){var o=s.v===a?s.w:s.v,l=e(s);n[a][o]={distance:l,predecessor:a}})}),i.forEach(function(a){var s=n[a];i.forEach(function(o){var l=n[o];i.forEach(function(u){var h=l[a],f=s[u],c=l[u],d=h.distance+f.distance;d<c.distance&&(c.distance=d,c.predecessor=f.predecessor)})})}),n}});var Rb=B((Lve,FI)=>{var Ru=Ur();FI.exports=qI;qI.CycleException=fd;function qI(r){var e={},t={},n=[];function i(a){if(Ru.has(t,a))throw new fd;Ru.has(e,a)||(t[a]=!0,e[a]=!0,Ru.each(r.predecessors(a),i),delete t[a],n.push(a))}if(Ru.each(r.sinks(),i),Ru.size(e)!==r.nodeCount())throw new fd;return n}function fd(){}fd.prototype=new Error});var VI=B((Ive,zI)=>{var _I=Rb();zI.exports=Qae;function Qae(r){try{_I(r)}catch(e){if(e instanceof _I.CycleException)return!1;throw e}return!0}});var Lb=B((Nve,WI)=>{var cd=Ur();WI.exports=Jae;function Jae(r,e,t){cd.isArray(e)||(e=[e]);var n=(r.isDirected()?r.successors:r.neighbors).bind(r),i=[],a={};return cd.each(e,function(s){if(!r.hasNode(s))throw new Error("Graph does not have node: "+s);HI(r,s,t==="post",a,n,i)}),i}function HI(r,e,t,n,i,a){cd.has(n,e)||(n[e]=!0,t||a.push(e),cd.each(i(e),function(s){HI(r,s,t,n,i,a)}),t&&a.push(e))}});var UI=B((qve,GI)=>{var ese=Lb();GI.exports=tse;function tse(r,e){return ese(r,e,"post")}});var jI=B((Fve,KI)=>{var rse=Lb();KI.exports=nse;function nse(r,e){return rse(r,e,"pre")}});var $I=B((_ve,XI)=>{var YI=Ur(),ise=ud(),ase=Pb();XI.exports=sse;function sse(r,e){var t=new ise,n={},i=new ase,a;function s(l){var u=l.v===a?l.w:l.v,h=i.priority(u);if(h!==void 0){var f=e(l);f<h&&(n[u]=a,i.decrease(u,f))}}if(r.nodeCount()===0)return t;YI.each(r.nodes(),function(l){i.add(l,Number.POSITIVE_INFINITY),t.setNode(l)}),i.decrease(r.nodes()[0],0);for(var o=!1;i.size()>0;){if(a=i.removeMin(),YI.has(n,a))t.setEdge(a,n[a]);else{if(o)throw new Error("Input graph is not connected: "+r);o=!0}r.nodeEdges(a).forEach(s)}return t}});var QI=B((zve,ZI)=>{ZI.exports={components:EI(),dijkstra:Bb(),dijkstraAll:PI(),findCycles:LI(),floydWarshall:NI(),isAcyclic:VI(),postorder:UI(),preorder:jI(),prim:$I(),tarjan:Ob(),topsort:Rb()}});var tN=B((Vve,eN)=>{var JI=xI();eN.exports={Graph:JI.Graph,json:CI(),alg:QI(),version:JI.version}});var sn=B((Hve,rN)=>{var dd;if(typeof is=="function")try{dd=tN()}catch{}dd||(dd=window.graphlib);rN.exports=dd});var iN=B((Gve,nN)=>{var ose=Q0(),lse=1,use=4;function hse(r){return ose(r,lse|use)}nN.exports=hse});var Lu=B((Uve,aN)=>{var fse=Ya(),cse=Hn(),dse=wu(),pse=Gr();function gse(r,e,t){if(!pse(t))return!1;var n=typeof e;return(n=="number"?cse(t)&&dse(e,t.length):n=="string"&&e in t)?fse(t[e],r):!1}aN.exports=gse});var lN=B((Kve,oN)=>{var vse=Bu(),mse=Ya(),yse=Lu(),bse=Zi(),sN=Object.prototype,wse=sN.hasOwnProperty,xse=vse(function(r,e){r=Object(r);var t=-1,n=e.length,i=n>2?e[2]:void 0;for(i&&yse(e[0],e[1],i)&&(n=1);++t<n;)for(var a=e[t],s=bse(a),o=-1,l=s.length;++o<l;){var u=s[o],h=r[u];(h===void 0||mse(h,sN[u])&&!wse.call(r,u))&&(r[u]=a[u])}return r});oN.exports=xse});var hN=B((jve,uN)=>{var Sse=Wn(),Cse=Hn(),kse=ui();function Ese(r){return function(e,t,n){var i=Object(e);if(!Cse(e)){var a=Sse(t,3);e=kse(e),t=function(o){return a(i[o],o,i)}}var s=r(e,t,n);return s>-1?i[a?e[s]:s]:void 0}}uN.exports=Ese});var cN=B((Yve,fN)=>{var Tse=/\s/;function Ase(r){for(var e=r.length;e--&&Tse.test(r.charAt(e)););return e}fN.exports=Ase});var pN=B((Xve,dN)=>{var Mse=cN(),Dse=/^\s+/;function Pse(r){return r&&r.slice(0,Mse(r)+1).replace(Dse,"")}dN.exports=Pse});var yN=B(($ve,mN)=>{var Bse=pN(),gN=Gr(),Ose=Ja(),vN=NaN,Rse=/^[-+]0x[0-9a-f]+$/i,Lse=/^0b[01]+$/i,Ise=/^0o[0-7]+$/i,Nse=parseInt;function qse(r){if(typeof r=="number")return r;if(Ose(r))return vN;if(gN(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=gN(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=Bse(r);var t=Lse.test(r);return t||Ise.test(r)?Nse(r.slice(2),t?2:8):Rse.test(r)?vN:+r}mN.exports=qse});var Ib=B((Zve,wN)=>{var Fse=yN(),bN=1/0,_se=17976931348623157e292;function zse(r){if(!r)return r===0?r:0;if(r=Fse(r),r===bN||r===-bN){var e=r<0?-1:1;return e*_se}return r===r?r:0}wN.exports=zse});var SN=B((Qve,xN)=>{var Vse=Ib();function Hse(r){var e=Vse(r),t=e%1;return e===e?t?e-t:e:0}xN.exports=Hse});var kN=B((Jve,CN)=>{var Wse=Eb(),Gse=Wn(),Use=SN(),Kse=Math.max;function jse(r,e,t){var n=r==null?0:r.length;if(!n)return-1;var i=t==null?0:Use(t);return i<0&&(i=Kse(n+i,0)),Wse(r,Gse(e,3),i)}CN.exports=jse});var TN=B((eme,EN)=>{var Yse=hN(),Xse=kN(),$se=Yse(Xse);EN.exports=$se});var Nb=B((tme,AN)=>{var Zse=od();function Qse(r){var e=r==null?0:r.length;return e?Zse(r,1):[]}AN.exports=Qse});var DN=B((rme,MN)=>{var Jse=td(),eoe=J0(),toe=Zi();function roe(r,e){return r==null?r:Jse(r,eoe(e),toe)}MN.exports=roe});var BN=B((nme,PN)=>{function noe(r){var e=r==null?0:r.length;return e?r[e-1]:void 0}PN.exports=noe});var RN=B((ime,ON)=>{var ioe=mu(),aoe=rd(),soe=Wn();function ooe(r,e){var t={};return e=soe(e,3),aoe(r,function(n,i,a){ioe(t,i,e(n,i,a))}),t}ON.exports=ooe});var pd=B((ame,LN)=>{var loe=Ja();function uoe(r,e,t){for(var n=-1,i=r.length;++n<i;){var a=r[n],s=e(a);if(s!=null&&(o===void 0?s===s&&!loe(s):t(s,o)))var o=s,l=a}return l}LN.exports=uoe});var NN=B((sme,IN)=>{function hoe(r,e){return r>e}IN.exports=hoe});var FN=B((ome,qN)=>{var foe=pd(),coe=NN(),doe=Qi();function poe(r){return r&&r.length?foe(r,doe,coe):void 0}qN.exports=poe});var qb=B((lme,_N)=>{var goe=mu(),voe=Ya();function moe(r,e,t){(t!==void 0&&!voe(r[e],t)||t===void 0&&!(e in r))&&goe(r,e,t)}_N.exports=moe});var HN=B((ume,VN)=>{var yoe=Xi(),boe=Tu(),woe=xn(),xoe="[object Object]",Soe=Function.prototype,Coe=Object.prototype,zN=Soe.toString,koe=Coe.hasOwnProperty,Eoe=zN.call(Object);function Toe(r){if(!woe(r)||yoe(r)!=xoe)return!1;var e=boe(r);if(e===null)return!0;var t=koe.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&zN.call(t)==Eoe}VN.exports=Toe});var Fb=B((hme,WN)=>{function Aoe(r,e){if(!(e==="constructor"&&typeof r[e]=="function")&&e!="__proto__")return r[e]}WN.exports=Aoe});var UN=B((fme,GN)=>{var Moe=ho(),Doe=Zi();function Poe(r){return Moe(r,Doe(r))}GN.exports=Poe});var ZN=B((cme,$N)=>{var KN=qb(),Boe=I0(),Ooe=X0(),Roe=N0(),Loe=Z0(),jN=fo(),YN=Pt(),Ioe=Ab(),Noe=$a(),qoe=so(),Foe=Gr(),_oe=HN(),zoe=go(),XN=Fb(),Voe=UN();function Hoe(r,e,t,n,i,a,s){var o=XN(r,t),l=XN(e,t),u=s.get(l);if(u){KN(r,t,u);return}var h=a?a(o,l,t+"",r,e,s):void 0,f=h===void 0;if(f){var c=YN(l),d=!c&&Noe(l),p=!c&&!d&&zoe(l);h=l,c||d||p?YN(o)?h=o:Ioe(o)?h=Roe(o):d?(f=!1,h=Boe(l,!0)):p?(f=!1,h=Ooe(l,!0)):h=[]:_oe(l)||jN(l)?(h=o,jN(o)?h=Voe(o):(!Foe(o)||qoe(o))&&(h=Loe(l))):f=!1}f&&(s.set(l,h),i(h,l,n,a,s),s.delete(l)),KN(r,t,h)}$N.exports=Hoe});var eq=B((dme,JN)=>{var Woe=vu(),Goe=qb(),Uoe=td(),Koe=ZN(),joe=Gr(),Yoe=Zi(),Xoe=Fb();function QN(r,e,t,n,i){r!==e&&Uoe(e,function(a,s){if(i||(i=new Woe),joe(a))Koe(r,e,s,t,QN,n,i);else{var o=n?n(Xoe(r,s),a,s+"",r,e,i):void 0;o===void 0&&(o=a),Goe(r,s,o)}},Yoe)}JN.exports=QN});var rq=B((pme,tq)=>{var $oe=Bu(),Zoe=Lu();function Qoe(r){return $oe(function(e,t){var n=-1,i=t.length,a=i>1?t[i-1]:void 0,s=i>2?t[2]:void 0;for(a=r.length>3&&typeof a=="function"?(i--,a):void 0,s&&Zoe(t[0],t[1],s)&&(a=i<3?void 0:a,i=1),e=Object(e);++n<i;){var o=t[n];o&&r(e,o,n,a)}return e})}tq.exports=Qoe});var iq=B((gme,nq)=>{var Joe=eq(),ele=rq(),tle=ele(function(r,e,t){Joe(r,e,t)});nq.exports=tle});var _b=B((vme,aq)=>{function rle(r,e){return r<e}aq.exports=rle});var oq=B((mme,sq)=>{var nle=pd(),ile=_b(),ale=Qi();function sle(r){return r&&r.length?nle(r,ale,ile):void 0}sq.exports=sle});var uq=B((yme,lq)=>{var ole=pd(),lle=Wn(),ule=_b();function hle(r,e){return r&&r.length?ole(r,lle(e,2),ule):void 0}lq.exports=hle});var fq=B((bme,hq)=>{var fle=nn(),cle=function(){return fle.Date.now()};hq.exports=cle});var pq=B((wme,dq)=>{var dle=yu(),ple=Du(),gle=wu(),cq=Gr(),vle=yo();function mle(r,e,t,n){if(!cq(r))return r;e=ple(e,r);for(var i=-1,a=e.length,s=a-1,o=r;o!=null&&++i<a;){var l=vle(e[i]),u=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return r;if(i!=s){var h=o[l];u=n?n(h,l,o):void 0,u===void 0&&(u=cq(h)?h:gle(e[i+1])?[]:{})}dle(o,l,u),o=o[l]}return r}dq.exports=mle});var vq=B((xme,gq)=>{var yle=Pu(),ble=pq(),wle=Du();function xle(r,e,t){for(var n=-1,i=e.length,a={};++n<i;){var s=e[n],o=yle(r,s);t(o,s)&&ble(a,wle(s,r),o)}return a}gq.exports=xle});var yq=B((Sme,mq)=>{var Sle=vq(),Cle=db();function kle(r,e){return Sle(r,e,function(t,n){return Cle(r,n)})}mq.exports=kle});var wq=B((Cme,bq)=>{var Ele=Nb(),Tle=Cb(),Ale=kb();function Mle(r){return Ale(Tle(r,void 0,Ele),r+"")}bq.exports=Mle});var Sq=B((kme,xq)=>{var Dle=yq(),Ple=wq(),Ble=Ple(function(r,e){return r==null?{}:Dle(r,e)});xq.exports=Ble});var kq=B((Eme,Cq)=>{var Ole=Math.ceil,Rle=Math.max;function Lle(r,e,t,n){for(var i=-1,a=Rle(Ole((e-r)/(t||1)),0),s=Array(a);a--;)s[n?a:++i]=r,r+=t;return s}Cq.exports=Lle});var Tq=B((Tme,Eq)=>{var Ile=kq(),Nle=Lu(),zb=Ib();function qle(r){return function(e,t,n){return n&&typeof n!="number"&&Nle(e,t,n)&&(t=n=void 0),e=zb(e),t===void 0?(t=e,e=0):t=zb(t),n=n===void 0?e<t?1:-1:zb(n),Ile(e,t,n,r)}}Eq.exports=qle});var Mq=B((Ame,Aq)=>{var Fle=Tq(),_le=Fle();Aq.exports=_le});var Pq=B((Mme,Dq)=>{function zle(r,e){var t=r.length;for(r.sort(e);t--;)r[t]=r[t].value;return r}Dq.exports=zle});var Rq=B((Dme,Oq)=>{var Bq=Ja();function Vle(r,e){if(r!==e){var t=r!==void 0,n=r===null,i=r===r,a=Bq(r),s=e!==void 0,o=e===null,l=e===e,u=Bq(e);if(!o&&!u&&!a&&r>e||a&&s&&l&&!o&&!u||n&&s&&l||!t&&l||!i)return 1;if(!n&&!a&&!u&&r<e||u&&t&&i&&!n&&!a||o&&t&&i||!s&&i||!l)return-1}return 0}Oq.exports=Vle});var Iq=B((Pme,Lq)=>{var Hle=Rq();function Wle(r,e,t){for(var n=-1,i=r.criteria,a=e.criteria,s=i.length,o=t.length;++n<s;){var l=Hle(i[n],a[n]);if(l){if(n>=o)return l;var u=t[n];return l*(u=="desc"?-1:1)}}return r.index-e.index}Lq.exports=Wle});var qq=B((Bme,Nq)=>{var Vb=Mu(),Gle=Pu(),Ule=Wn(),Kle=yb(),jle=Pq(),Yle=xu(),Xle=Iq(),$le=Qi(),Zle=Pt();function Qle(r,e,t){e.length?e=Vb(e,function(a){return Zle(a)?function(s){return Gle(s,a.length===1?a[0]:a)}:a}):e=[$le];var n=-1;e=Vb(e,Yle(Ule));var i=Kle(r,function(a,s,o){var l=Vb(e,function(u){return u(a)});return{criteria:l,index:++n,value:a}});return jle(i,function(a,s){return Xle(a,s,t)})}Nq.exports=Qle});var zq=B((Ome,_q)=>{var Jle=od(),eue=qq(),tue=Bu(),Fq=Lu(),rue=tue(function(r,e){if(r==null)return[];var t=e.length;return t>1&&Fq(r,e[0],e[1])?e=[]:t>2&&Fq(e[0],e[1],e[2])&&(e=[e[0]]),eue(r,Jle(e,1),[])});_q.exports=rue});var Hq=B((Rme,Vq)=>{var nue=fb(),iue=0;function aue(r){var e=++iue;return nue(r)+e}Vq.exports=aue});var Gq=B((Lme,Wq)=>{function sue(r,e,t){for(var n=-1,i=r.length,a=e.length,s={};++n<i;){var o=n<a?e[n]:void 0;t(s,r[n],o)}return s}Wq.exports=sue});var Kq=B((Ime,Uq)=>{var oue=yu(),lue=Gq();function uue(r,e){return lue(r||[],e||[],oue)}Uq.exports=uue});var St=B((Nme,jq)=>{var gd;if(typeof is=="function")try{gd={cloneDeep:iN(),constant:ed(),defaults:lN(),each:tb(),filter:gb(),find:TN(),flatten:Nb(),forEach:eb(),forIn:DN(),has:vb(),isUndefined:mb(),last:BN(),map:bb(),mapValues:RN(),max:FN(),merge:iq(),min:oq(),minBy:uq(),now:fq(),pick:Sq(),range:Mq(),reduce:wb(),sortBy:zq(),uniqueId:Hq(),values:Mb(),zipObject:Kq()}}catch{}gd||(gd=window._);jq.exports=gd});var $q=B((Fme,Xq)=>{Xq.exports=vd;function vd(){var r={};r._next=r._prev=r,this._sentinel=r}vd.prototype.dequeue=function(){var r=this._sentinel,e=r._prev;if(e!==r)return Yq(e),e};vd.prototype.enqueue=function(r){var e=this._sentinel;r._prev&&r._next&&Yq(r),r._next=e._next,e._next._prev=r,e._next=r,r._prev=e};vd.prototype.toString=function(){for(var r=[],e=this._sentinel,t=e._prev;t!==e;)r.push(JSON.stringify(t,hue)),t=t._prev;return"["+r.join(", ")+"]"};function Yq(r){r._prev._next=r._next,r._next._prev=r._prev,delete r._next,delete r._prev}function hue(r,e){if(r!=="_next"&&r!=="_prev")return e}});var Qq=B((_me,Zq)=>{var hi=St(),fue=sn().Graph,cue=$q();Zq.exports=pue;var due=hi.constant(1);function pue(r,e){if(r.nodeCount()<=1)return[];var t=vue(r,e||due),n=gue(t.graph,t.buckets,t.zeroIdx);return hi.flatten(hi.map(n,function(i){return r.outEdges(i.v,i.w)}),!0)}function gue(r,e,t){for(var n=[],i=e[e.length-1],a=e[0],s;r.nodeCount();){for(;s=a.dequeue();)Hb(r,e,t,s);for(;s=i.dequeue();)Hb(r,e,t,s);if(r.nodeCount()){for(var o=e.length-2;o>0;--o)if(s=e[o].dequeue(),s){n=n.concat(Hb(r,e,t,s,!0));break}}}return n}function Hb(r,e,t,n,i){var a=i?[]:void 0;return hi.forEach(r.inEdges(n.v),function(s){var o=r.edge(s),l=r.node(s.v);i&&a.push({v:s.v,w:s.w}),l.out-=o,Wb(e,t,l)}),hi.forEach(r.outEdges(n.v),function(s){var o=r.edge(s),l=s.w,u=r.node(l);u.in-=o,Wb(e,t,u)}),r.removeNode(n.v),a}function vue(r,e){var t=new fue,n=0,i=0;hi.forEach(r.nodes(),function(o){t.setNode(o,{v:o,in:0,out:0})}),hi.forEach(r.edges(),function(o){var l=t.edge(o.v,o.w)||0,u=e(o),h=l+u;t.setEdge(o.v,o.w,h),i=Math.max(i,t.node(o.v).out+=u),n=Math.max(n,t.node(o.w).in+=u)});var a=hi.range(i+n+3).map(function(){return new cue}),s=n+1;return hi.forEach(t.nodes(),function(o){Wb(a,s,t.node(o))}),{graph:t,buckets:a,zeroIdx:s}}function Wb(r,e,t){t.out?t.in?r[t.out-t.in+e].enqueue(t):r[r.length-1].enqueue(t):r[0].enqueue(t)}});var eF=B((zme,Jq)=>{"use strict";var ts=St(),mue=Qq();Jq.exports={run:yue,undo:wue};function yue(r){var e=r.graph().acyclicer==="greedy"?mue(r,t(r)):bue(r);ts.forEach(e,function(n){var i=r.edge(n);r.removeEdge(n),i.forwardName=n.name,i.reversed=!0,r.setEdge(n.w,n.v,i,ts.uniqueId("rev"))});function t(n){return function(i){return n.edge(i).weight}}}function bue(r){var e=[],t={},n={};function i(a){ts.has(n,a)||(n[a]=!0,t[a]=!0,ts.forEach(r.outEdges(a),function(s){ts.has(t,s.w)?e.push(s):i(s.w)}),delete t[a])}return ts.forEach(r.nodes(),i),e}function wue(r){ts.forEach(r.edges(),function(e){var t=r.edge(e);if(t.reversed){r.removeEdge(e);var n=t.forwardName;delete t.reversed,delete t.forwardName,r.setEdge(e.w,e.v,t,n)}})}});var xr=B((Vme,iF)=>{"use strict";var rt=St(),tF=sn().Graph;iF.exports={addDummyNode:rF,simplify:xue,asNonCompoundGraph:Sue,successorWeights:Cue,predecessorWeights:kue,intersectRect:Eue,buildLayerMatrix:Tue,normalizeRanks:Aue,removeEmptyRanks:Mue,addBorderNode:Due,maxRank:nF,partition:Pue,time:Bue,notime:Oue};function rF(r,e,t,n){var i;do i=rt.uniqueId(n);while(r.hasNode(i));return t.dummy=e,r.setNode(i,t),i}function xue(r){var e=new tF().setGraph(r.graph());return rt.forEach(r.nodes(),function(t){e.setNode(t,r.node(t))}),rt.forEach(r.edges(),function(t){var n=e.edge(t.v,t.w)||{weight:0,minlen:1},i=r.edge(t);e.setEdge(t.v,t.w,{weight:n.weight+i.weight,minlen:Math.max(n.minlen,i.minlen)})}),e}function Sue(r){var e=new tF({multigraph:r.isMultigraph()}).setGraph(r.graph());return rt.forEach(r.nodes(),function(t){r.children(t).length||e.setNode(t,r.node(t))}),rt.forEach(r.edges(),function(t){e.setEdge(t,r.edge(t))}),e}function Cue(r){var e=rt.map(r.nodes(),function(t){var n={};return rt.forEach(r.outEdges(t),function(i){n[i.w]=(n[i.w]||0)+r.edge(i).weight}),n});return rt.zipObject(r.nodes(),e)}function kue(r){var e=rt.map(r.nodes(),function(t){var n={};return rt.forEach(r.inEdges(t),function(i){n[i.v]=(n[i.v]||0)+r.edge(i).weight}),n});return rt.zipObject(r.nodes(),e)}function Eue(r,e){var t=r.x,n=r.y,i=e.x-t,a=e.y-n,s=r.width/2,o=r.height/2;if(!i&&!a)throw new Error("Not possible to find intersection inside of the rectangle");var l,u;return Math.abs(a)*s>Math.abs(i)*o?(a<0&&(o=-o),l=o*i/a,u=o):(i<0&&(s=-s),l=s,u=s*a/i),{x:t+l,y:n+u}}function Tue(r){var e=rt.map(rt.range(nF(r)+1),function(){return[]});return rt.forEach(r.nodes(),function(t){var n=r.node(t),i=n.rank;rt.isUndefined(i)||(e[i][n.order]=t)}),e}function Aue(r){var e=rt.min(rt.map(r.nodes(),function(t){return r.node(t).rank}));rt.forEach(r.nodes(),function(t){var n=r.node(t);rt.has(n,"rank")&&(n.rank-=e)})}function Mue(r){var e=rt.min(rt.map(r.nodes(),function(a){return r.node(a).rank})),t=[];rt.forEach(r.nodes(),function(a){var s=r.node(a).rank-e;t[s]||(t[s]=[]),t[s].push(a)});var n=0,i=r.graph().nodeRankFactor;rt.forEach(t,function(a,s){rt.isUndefined(a)&&s%i!==0?--n:n&&rt.forEach(a,function(o){r.node(o).rank+=n})})}function Due(r,e,t,n){var i={width:0,height:0};return arguments.length>=4&&(i.rank=t,i.order=n),rF(r,"border",i,e)}function nF(r){return rt.max(rt.map(r.nodes(),function(e){var t=r.node(e).rank;if(!rt.isUndefined(t))return t}))}function Pue(r,e){var t={lhs:[],rhs:[]};return rt.forEach(r,function(n){e(n)?t.lhs.push(n):t.rhs.push(n)}),t}function Bue(r,e){var t=rt.now();try{return e()}finally{console.log(r+" time: "+(rt.now()-t)+"ms")}}function Oue(r,e){return e()}});var oF=B((Hme,sF)=>{"use strict";var aF=St(),Rue=xr();sF.exports={run:Lue,undo:Nue};function Lue(r){r.graph().dummyChains=[],aF.forEach(r.edges(),function(e){Iue(r,e)})}function Iue(r,e){var t=e.v,n=r.node(t).rank,i=e.w,a=r.node(i).rank,s=e.name,o=r.edge(e),l=o.labelRank;if(a!==n+1){r.removeEdge(e);var u,h,f;for(f=0,++n;n<a;++f,++n)o.points=[],h={width:0,height:0,edgeLabel:o,edgeObj:e,rank:n},u=Rue.addDummyNode(r,"edge",h,"_d"),n===l&&(h.width=o.width,h.height=o.height,h.dummy="edge-label",h.labelpos=o.labelpos),r.setEdge(t,u,{weight:o.weight},s),f===0&&r.graph().dummyChains.push(u),t=u;r.setEdge(t,i,{weight:o.weight},s)}}function Nue(r){aF.forEach(r.graph().dummyChains,function(e){var t=r.node(e),n=t.edgeLabel,i;for(r.setEdge(t.edgeObj,n);t.dummy;)i=r.successors(e)[0],r.removeNode(e),n.points.push({x:t.x,y:t.y}),t.dummy==="edge-label"&&(n.x=t.x,n.y=t.y,n.width=t.width,n.height=t.height),e=i,t=r.node(e)})}});var Iu=B((Wme,lF)=>{"use strict";var md=St();lF.exports={longestPath:que,slack:Fue};function que(r){var e={};function t(n){var i=r.node(n);if(md.has(e,n))return i.rank;e[n]=!0;var a=md.min(md.map(r.outEdges(n),function(s){return t(s.w)-r.edge(s).minlen}));return(a===Number.POSITIVE_INFINITY||a===void 0||a===null)&&(a=0),i.rank=a}md.forEach(r.sources(),t)}function Fue(r,e){return r.node(e.w).rank-r.node(e.v).rank-r.edge(e).minlen}});var Gb=B((Gme,uF)=>{"use strict";var yd=St(),_ue=sn().Graph,bd=Iu().slack;uF.exports=zue;function zue(r){var e=new _ue({directed:!1}),t=r.nodes()[0],n=r.nodeCount();e.setNode(t,{});for(var i,a;Vue(e,r)<n;)i=Hue(e,r),a=e.hasNode(i.v)?bd(r,i):-bd(r,i),Wue(e,r,a);return e}function Vue(r,e){function t(n){yd.forEach(e.nodeEdges(n),function(i){var a=i.v,s=n===a?i.w:a;!r.hasNode(s)&&!bd(e,i)&&(r.setNode(s,{}),r.setEdge(n,s,{}),t(s))})}return yd.forEach(r.nodes(),t),r.nodeCount()}function Hue(r,e){return yd.minBy(e.edges(),function(t){if(r.hasNode(t.v)!==r.hasNode(t.w))return bd(e,t)})}function Wue(r,e,t){yd.forEach(r.nodes(),function(n){e.node(n).rank+=t})}});var mF=B((Ume,vF)=>{"use strict";var fi=St(),Gue=Gb(),Uue=Iu().slack,Kue=Iu().longestPath,jue=sn().alg.preorder,Yue=sn().alg.postorder,Xue=xr().simplify;vF.exports=rs;rs.initLowLimValues=Kb;rs.initCutValues=Ub;rs.calcCutValue=fF;rs.leaveEdge=dF;rs.enterEdge=pF;rs.exchangeEdges=gF;function rs(r){r=Xue(r),Kue(r);var e=Gue(r);Kb(e),Ub(e,r);for(var t,n;t=dF(e);)n=pF(e,r,t),gF(e,r,t,n)}function Ub(r,e){var t=Yue(r,r.nodes());t=t.slice(0,t.length-1),fi.forEach(t,function(n){$ue(r,e,n)})}function $ue(r,e,t){var n=r.node(t),i=n.parent;r.edge(t,i).cutvalue=fF(r,e,t)}function fF(r,e,t){var n=r.node(t),i=n.parent,a=!0,s=e.edge(t,i),o=0;return s||(a=!1,s=e.edge(i,t)),o=s.weight,fi.forEach(e.nodeEdges(t),function(l){var u=l.v===t,h=u?l.w:l.v;if(h!==i){var f=u===a,c=e.edge(l).weight;if(o+=f?c:-c,Que(r,t,h)){var d=r.edge(t,h).cutvalue;o+=f?-d:d}}}),o}function Kb(r,e){arguments.length<2&&(e=r.nodes()[0]),cF(r,{},1,e)}function cF(r,e,t,n,i){var a=t,s=r.node(n);return e[n]=!0,fi.forEach(r.neighbors(n),function(o){fi.has(e,o)||(t=cF(r,e,t,o,n))}),s.low=a,s.lim=t++,i?s.parent=i:delete s.parent,t}function dF(r){return fi.find(r.edges(),function(e){return r.edge(e).cutvalue<0})}function pF(r,e,t){var n=t.v,i=t.w;e.hasEdge(n,i)||(n=t.w,i=t.v);var a=r.node(n),s=r.node(i),o=a,l=!1;a.lim>s.lim&&(o=s,l=!0);var u=fi.filter(e.edges(),function(h){return l===hF(r,r.node(h.v),o)&&l!==hF(r,r.node(h.w),o)});return fi.minBy(u,function(h){return Uue(e,h)})}function gF(r,e,t,n){var i=t.v,a=t.w;r.removeEdge(i,a),r.setEdge(n.v,n.w,{}),Kb(r),Ub(r,e),Zue(r,e)}function Zue(r,e){var t=fi.find(r.nodes(),function(i){return!e.node(i).parent}),n=jue(r,t);n=n.slice(1),fi.forEach(n,function(i){var a=r.node(i).parent,s=e.edge(i,a),o=!1;s||(s=e.edge(a,i),o=!0),e.node(i).rank=e.node(a).rank+(o?s.minlen:-s.minlen)})}function Que(r,e,t){return r.hasEdge(e,t)}function hF(r,e,t){return t.low<=e.lim&&e.lim<=t.lim}});var xF=B((Kme,wF)=>{"use strict";var Jue=Iu(),bF=Jue.longestPath,ehe=Gb(),the=mF();wF.exports=rhe;function rhe(r){switch(r.graph().ranker){case"network-simplex":yF(r);break;case"tight-tree":ihe(r);break;case"longest-path":nhe(r);break;default:yF(r)}}var nhe=bF;function ihe(r){bF(r),ehe(r)}function yF(r){the(r)}});var CF=B((jme,SF)=>{var jb=St();SF.exports=ahe;function ahe(r){var e=ohe(r);jb.forEach(r.graph().dummyChains,function(t){for(var n=r.node(t),i=n.edgeObj,a=she(r,e,i.v,i.w),s=a.path,o=a.lca,l=0,u=s[l],h=!0;t!==i.w;){if(n=r.node(t),h){for(;(u=s[l])!==o&&r.node(u).maxRank<n.rank;)l++;u===o&&(h=!1)}if(!h){for(;l<s.length-1&&r.node(u=s[l+1]).minRank<=n.rank;)l++;u=s[l]}r.setParent(t,u),t=r.successors(t)[0]}})}function she(r,e,t,n){var i=[],a=[],s=Math.min(e[t].low,e[n].low),o=Math.max(e[t].lim,e[n].lim),l,u;l=t;do l=r.parent(l),i.push(l);while(l&&(e[l].low>s||o>e[l].lim));for(u=l,l=n;(l=r.parent(l))!==u;)a.push(l);return{path:i.concat(a.reverse()),lca:u}}function ohe(r){var e={},t=0;function n(i){var a=t;jb.forEach(r.children(i),n),e[i]={low:a,lim:t++}}return jb.forEach(r.children(),n),e}});var TF=B((Yme,EF)=>{var ci=St(),Yb=xr();EF.exports={run:lhe,cleanup:fhe};function lhe(r){var e=Yb.addDummyNode(r,"root",{},"_root"),t=uhe(r),n=ci.max(ci.values(t))-1,i=2*n+1;r.graph().nestingRoot=e,ci.forEach(r.edges(),function(s){r.edge(s).minlen*=i});var a=hhe(r)+1;ci.forEach(r.children(),function(s){kF(r,e,i,a,n,t,s)}),r.graph().nodeRankFactor=i}function kF(r,e,t,n,i,a,s){var o=r.children(s);if(!o.length){s!==e&&r.setEdge(e,s,{weight:0,minlen:t});return}var l=Yb.addBorderNode(r,"_bt"),u=Yb.addBorderNode(r,"_bb"),h=r.node(s);r.setParent(l,s),h.borderTop=l,r.setParent(u,s),h.borderBottom=u,ci.forEach(o,function(f){kF(r,e,t,n,i,a,f);var c=r.node(f),d=c.borderTop?c.borderTop:f,p=c.borderBottom?c.borderBottom:f,g=c.borderTop?n:2*n,v=d!==p?1:i-a[s]+1;r.setEdge(l,d,{weight:g,minlen:v,nestingEdge:!0}),r.setEdge(p,u,{weight:g,minlen:v,nestingEdge:!0})}),r.parent(s)||r.setEdge(e,l,{weight:0,minlen:i+a[s]})}function uhe(r){var e={};function t(n,i){var a=r.children(n);a&&a.length&&ci.forEach(a,function(s){t(s,i+1)}),e[n]=i}return ci.forEach(r.children(),function(n){t(n,1)}),e}function hhe(r){return ci.reduce(r.edges(),function(e,t){return e+r.edge(t).weight},0)}function fhe(r){var e=r.graph();r.removeNode(e.nestingRoot),delete e.nestingRoot,ci.forEach(r.edges(),function(t){var n=r.edge(t);n.nestingEdge&&r.removeEdge(t)})}});var DF=B((Xme,MF)=>{var Xb=St(),che=xr();MF.exports=dhe;function dhe(r){function e(t){var n=r.children(t),i=r.node(t);if(n.length&&Xb.forEach(n,e),Xb.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var a=i.minRank,s=i.maxRank+1;a<s;++a)AF(r,"borderLeft","_bl",t,i,a),AF(r,"borderRight","_br",t,i,a)}}Xb.forEach(r.children(),e)}function AF(r,e,t,n,i,a){var s={width:0,height:0,rank:a,borderType:e},o=i[e][a-1],l=che.addDummyNode(r,"border",s,t);i[e][a]=l,r.setParent(l,n),o&&r.setEdge(o,l,{weight:1})}});var RF=B(($me,OF)=>{"use strict";var Un=St();OF.exports={adjust:phe,undo:ghe};function phe(r){var e=r.graph().rankdir.toLowerCase();(e==="lr"||e==="rl")&&BF(r)}function ghe(r){var e=r.graph().rankdir.toLowerCase();(e==="bt"||e==="rl")&&vhe(r),(e==="lr"||e==="rl")&&(mhe(r),BF(r))}function BF(r){Un.forEach(r.nodes(),function(e){PF(r.node(e))}),Un.forEach(r.edges(),function(e){PF(r.edge(e))})}function PF(r){var e=r.width;r.width=r.height,r.height=e}function vhe(r){Un.forEach(r.nodes(),function(e){$b(r.node(e))}),Un.forEach(r.edges(),function(e){var t=r.edge(e);Un.forEach(t.points,$b),Un.has(t,"y")&&$b(t)})}function $b(r){r.y=-r.y}function mhe(r){Un.forEach(r.nodes(),function(e){Zb(r.node(e))}),Un.forEach(r.edges(),function(e){var t=r.edge(e);Un.forEach(t.points,Zb),Un.has(t,"x")&&Zb(t)})}function Zb(r){var e=r.x;r.x=r.y,r.y=e}});var IF=B((Zme,LF)=>{"use strict";var di=St();LF.exports=yhe;function yhe(r){var e={},t=di.filter(r.nodes(),function(o){return!r.children(o).length}),n=di.max(di.map(t,function(o){return r.node(o).rank})),i=di.map(di.range(n+1),function(){return[]});function a(o){if(!di.has(e,o)){e[o]=!0;var l=r.node(o);i[l.rank].push(o),di.forEach(r.successors(o),a)}}var s=di.sortBy(t,function(o){return r.node(o).rank});return di.forEach(s,a),i}});var qF=B((Qme,NF)=>{"use strict";var Ji=St();NF.exports=bhe;function bhe(r,e){for(var t=0,n=1;n<e.length;++n)t+=whe(r,e[n-1],e[n]);return t}function whe(r,e,t){for(var n=Ji.zipObject(t,Ji.map(t,function(u,h){return h})),i=Ji.flatten(Ji.map(e,function(u){return Ji.sortBy(Ji.map(r.outEdges(u),function(h){return{pos:n[h.w],weight:r.edge(h).weight}}),"pos")}),!0),a=1;a<t.length;)a<<=1;var s=2*a-1;a-=1;var o=Ji.map(new Array(s),function(){return 0}),l=0;return Ji.forEach(i.forEach(function(u){var h=u.pos+a;o[h]+=u.weight;for(var f=0;h>0;)h%2&&(f+=o[h+1]),h=h-1>>1,o[h]+=u.weight;l+=u.weight*f})),l}});var zF=B((Jme,_F)=>{var FF=St();_F.exports=xhe;function xhe(r,e){return FF.map(e,function(t){var n=r.inEdges(t);if(n.length){var i=FF.reduce(n,function(a,s){var o=r.edge(s),l=r.node(s.v);return{sum:a.sum+o.weight*l.order,weight:a.weight+o.weight}},{sum:0,weight:0});return{v:t,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:t}})}});var HF=B((eye,VF)=>{"use strict";var Kr=St();VF.exports=She;function She(r,e){var t={};Kr.forEach(r,function(i,a){var s=t[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:a};Kr.isUndefined(i.barycenter)||(s.barycenter=i.barycenter,s.weight=i.weight)}),Kr.forEach(e.edges(),function(i){var a=t[i.v],s=t[i.w];!Kr.isUndefined(a)&&!Kr.isUndefined(s)&&(s.indegree++,a.out.push(t[i.w]))});var n=Kr.filter(t,function(i){return!i.indegree});return Che(n)}function Che(r){var e=[];function t(a){return function(s){s.merged||(Kr.isUndefined(s.barycenter)||Kr.isUndefined(a.barycenter)||s.barycenter>=a.barycenter)&&khe(a,s)}}function n(a){return function(s){s.in.push(a),--s.indegree===0&&r.push(s)}}for(;r.length;){var i=r.pop();e.push(i),Kr.forEach(i.in.reverse(),t(i)),Kr.forEach(i.out,n(i))}return Kr.map(Kr.filter(e,function(a){return!a.merged}),function(a){return Kr.pick(a,["vs","i","barycenter","weight"])})}function khe(r,e){var t=0,n=0;r.weight&&(t+=r.barycenter*r.weight,n+=r.weight),e.weight&&(t+=e.barycenter*e.weight,n+=e.weight),r.vs=e.vs.concat(r.vs),r.barycenter=t/n,r.weight=n,r.i=Math.min(e.i,r.i),e.merged=!0}});var UF=B((tye,GF)=>{var Nu=St(),Ehe=xr();GF.exports=The;function The(r,e){var t=Ehe.partition(r,function(h){return Nu.has(h,"barycenter")}),n=t.lhs,i=Nu.sortBy(t.rhs,function(h){return-h.i}),a=[],s=0,o=0,l=0;n.sort(Ahe(!!e)),l=WF(a,i,l),Nu.forEach(n,function(h){l+=h.vs.length,a.push(h.vs),s+=h.barycenter*h.weight,o+=h.weight,l=WF(a,i,l)});var u={vs:Nu.flatten(a,!0)};return o&&(u.barycenter=s/o,u.weight=o),u}function WF(r,e,t){for(var n;e.length&&(n=Nu.last(e)).i<=t;)e.pop(),r.push(n.vs),t++;return t}function Ahe(r){return function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:r?t.i-e.i:e.i-t.i}}});var YF=B((rye,jF)=>{var ea=St(),Mhe=zF(),Dhe=HF(),Phe=UF();jF.exports=KF;function KF(r,e,t,n){var i=r.children(e),a=r.node(e),s=a?a.borderLeft:void 0,o=a?a.borderRight:void 0,l={};s&&(i=ea.filter(i,function(p){return p!==s&&p!==o}));var u=Mhe(r,i);ea.forEach(u,function(p){if(r.children(p.v).length){var g=KF(r,p.v,t,n);l[p.v]=g,ea.has(g,"barycenter")&&Ohe(p,g)}});var h=Dhe(u,t);Bhe(h,l);var f=Phe(h,n);if(s&&(f.vs=ea.flatten([s,f.vs,o],!0),r.predecessors(s).length)){var c=r.node(r.predecessors(s)[0]),d=r.node(r.predecessors(o)[0]);ea.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+c.order+d.order)/(f.weight+2),f.weight+=2}return f}function Bhe(r,e){ea.forEach(r,function(t){t.vs=ea.flatten(t.vs.map(function(n){return e[n]?e[n].vs:n}),!0)})}function Ohe(r,e){ea.isUndefined(r.barycenter)?(r.barycenter=e.barycenter,r.weight=e.weight):(r.barycenter=(r.barycenter*r.weight+e.barycenter*e.weight)/(r.weight+e.weight),r.weight+=e.weight)}});var $F=B((nye,XF)=>{var qu=St(),Rhe=sn().Graph;XF.exports=Lhe;function Lhe(r,e,t){var n=Ihe(r),i=new Rhe({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(a){return r.node(a)});return qu.forEach(r.nodes(),function(a){var s=r.node(a),o=r.parent(a);(s.rank===e||s.minRank<=e&&e<=s.maxRank)&&(i.setNode(a),i.setParent(a,o||n),qu.forEach(r[t](a),function(l){var u=l.v===a?l.w:l.v,h=i.edge(u,a),f=qu.isUndefined(h)?0:h.weight;i.setEdge(u,a,{weight:r.edge(l).weight+f})}),qu.has(s,"minRank")&&i.setNode(a,{borderLeft:s.borderLeft[e],borderRight:s.borderRight[e]}))}),i}function Ihe(r){for(var e;r.hasNode(e=qu.uniqueId("_root")););return e}});var QF=B((iye,ZF)=>{var Nhe=St();ZF.exports=qhe;function qhe(r,e,t){var n={},i;Nhe.forEach(t,function(a){for(var s=r.parent(a),o,l;s;){if(o=r.parent(s),o?(l=n[o],n[o]=s):(l=i,i=s),l&&l!==s){e.setEdge(l,s);return}s=o}})}});var n_=B((aye,r_)=>{"use strict";var ta=St(),Fhe=IF(),_he=qF(),zhe=YF(),Vhe=$F(),Hhe=QF(),Whe=sn().Graph,JF=xr();r_.exports=Ghe;function Ghe(r){var e=JF.maxRank(r),t=e_(r,ta.range(1,e+1),"inEdges"),n=e_(r,ta.range(e-1,-1,-1),"outEdges"),i=Fhe(r);t_(r,i);for(var a=Number.POSITIVE_INFINITY,s,o=0,l=0;l<4;++o,++l){Uhe(o%2?t:n,o%4>=2),i=JF.buildLayerMatrix(r);var u=_he(r,i);u<a&&(l=0,s=ta.cloneDeep(i),a=u)}t_(r,s)}function e_(r,e,t){return ta.map(e,function(n){return Vhe(r,n,t)})}function Uhe(r,e){var t=new Whe;ta.forEach(r,function(n){var i=n.graph().root,a=zhe(n,i,t,e);ta.forEach(a.vs,function(s,o){n.node(s).order=o}),Hhe(n,t,a.vs)})}function t_(r,e){ta.forEach(e,function(t){ta.forEach(t,function(n,i){r.node(n).order=i})})}});var d_=B((sye,c_)=>{"use strict";var Re=St(),Khe=sn().Graph,jhe=xr();c_.exports={positionX:$he,findType1Conflicts:i_,findType2Conflicts:a_,addConflict:Qb,hasConflict:s_,verticalAlignment:o_,horizontalCompaction:l_,alignCoordinates:h_,findSmallestWidthAlignment:u_,balance:f_};function i_(r,e){var t={};function n(i,a){var s=0,o=0,l=i.length,u=Re.last(a);return Re.forEach(a,function(h,f){var c=Yhe(r,h),d=c?r.node(c).order:l;(c||h===u)&&(Re.forEach(a.slice(o,f+1),function(p){Re.forEach(r.predecessors(p),function(g){var v=r.node(g),m=v.order;(m<s||d<m)&&!(v.dummy&&r.node(p).dummy)&&Qb(t,g,p)})}),o=f+1,s=d)}),a}return Re.reduce(e,n),t}function a_(r,e){var t={};function n(a,s,o,l,u){var h;Re.forEach(Re.range(s,o),function(f){h=a[f],r.node(h).dummy&&Re.forEach(r.predecessors(h),function(c){var d=r.node(c);d.dummy&&(d.order<l||d.order>u)&&Qb(t,c,h)})})}function i(a,s){var o=-1,l,u=0;return Re.forEach(s,function(h,f){if(r.node(h).dummy==="border"){var c=r.predecessors(h);c.length&&(l=r.node(c[0]).order,n(s,u,f,o,l),u=f,o=l)}n(s,u,s.length,l,a.length)}),s}return Re.reduce(e,i),t}function Yhe(r,e){if(r.node(e).dummy)return Re.find(r.predecessors(e),function(t){return r.node(t).dummy})}function Qb(r,e,t){if(e>t){var n=e;e=t,t=n}var i=r[e];i||(r[e]=i={}),i[t]=!0}function s_(r,e,t){if(e>t){var n=e;e=t,t=n}return Re.has(r[e],t)}function o_(r,e,t,n){var i={},a={},s={};return Re.forEach(e,function(o){Re.forEach(o,function(l,u){i[l]=l,a[l]=l,s[l]=u})}),Re.forEach(e,function(o){var l=-1;Re.forEach(o,function(u){var h=n(u);if(h.length){h=Re.sortBy(h,function(g){return s[g]});for(var f=(h.length-1)/2,c=Math.floor(f),d=Math.ceil(f);c<=d;++c){var p=h[c];a[u]===u&&l<s[p]&&!s_(t,u,p)&&(a[p]=u,a[u]=i[u]=i[p],l=s[p])}}})}),{root:i,align:a}}function l_(r,e,t,n,i){var a={},s=Xhe(r,e,t,i),o=i?"borderLeft":"borderRight";function l(f,c){for(var d=s.nodes(),p=d.pop(),g={};p;)g[p]?f(p):(g[p]=!0,d.push(p),d=d.concat(c(p))),p=d.pop()}function u(f){a[f]=s.inEdges(f).reduce(function(c,d){return Math.max(c,a[d.v]+s.edge(d))},0)}function h(f){var c=s.outEdges(f).reduce(function(p,g){return Math.min(p,a[g.w]-s.edge(g))},Number.POSITIVE_INFINITY),d=r.node(f);c!==Number.POSITIVE_INFINITY&&d.borderType!==o&&(a[f]=Math.max(a[f],c))}return l(u,s.predecessors.bind(s)),l(h,s.successors.bind(s)),Re.forEach(n,function(f){a[f]=a[t[f]]}),a}function Xhe(r,e,t,n){var i=new Khe,a=r.graph(),s=Zhe(a.nodesep,a.edgesep,n);return Re.forEach(e,function(o){var l;Re.forEach(o,function(u){var h=t[u];if(i.setNode(h),l){var f=t[l],c=i.edge(f,h);i.setEdge(f,h,Math.max(s(r,u,l),c||0))}l=u})}),i}function u_(r,e){return Re.minBy(Re.values(e),function(t){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return Re.forIn(t,function(a,s){var o=Qhe(r,s)/2;n=Math.max(a+o,n),i=Math.min(a-o,i)}),n-i})}function h_(r,e){var t=Re.values(e),n=Re.min(t),i=Re.max(t);Re.forEach(["u","d"],function(a){Re.forEach(["l","r"],function(s){var o=a+s,l=r[o],u;if(l!==e){var h=Re.values(l);u=s==="l"?n-Re.min(h):i-Re.max(h),u&&(r[o]=Re.mapValues(l,function(f){return f+u}))}})})}function f_(r,e){return Re.mapValues(r.ul,function(t,n){if(e)return r[e.toLowerCase()][n];var i=Re.sortBy(Re.map(r,n));return(i[1]+i[2])/2})}function $he(r){var e=jhe.buildLayerMatrix(r),t=Re.merge(i_(r,e),a_(r,e)),n={},i;Re.forEach(["u","d"],function(s){i=s==="u"?e:Re.values(e).reverse(),Re.forEach(["l","r"],function(o){o==="r"&&(i=Re.map(i,function(f){return Re.values(f).reverse()}));var l=(s==="u"?r.predecessors:r.successors).bind(r),u=o_(r,i,t,l),h=l_(r,i,u.root,u.align,o==="r");o==="r"&&(h=Re.mapValues(h,function(f){return-f})),n[s+o]=h})});var a=u_(r,n);return h_(n,a),f_(n,r.graph().align)}function Zhe(r,e,t){return function(n,i,a){var s=n.node(i),o=n.node(a),l=0,u;if(l+=s.width/2,Re.has(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":u=-s.width/2;break;case"r":u=s.width/2;break}if(u&&(l+=t?u:-u),u=0,l+=(s.dummy?e:r)/2,l+=(o.dummy?e:r)/2,l+=o.width/2,Re.has(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":u=o.width/2;break;case"r":u=-o.width/2;break}return u&&(l+=t?u:-u),u=0,l}}function Qhe(r,e){return r.node(e).width}});var v_=B((oye,g_)=>{"use strict";var Fu=St(),p_=xr(),Jhe=d_().positionX;g_.exports=efe;function efe(r){r=p_.asNonCompoundGraph(r),tfe(r),Fu.forEach(Jhe(r),function(e,t){r.node(t).x=e})}function tfe(r){var e=p_.buildLayerMatrix(r),t=r.graph().ranksep,n=0;Fu.forEach(e,function(i){var a=Fu.max(Fu.map(i,function(s){return r.node(s).height}));Fu.forEach(i,function(s){r.node(s).y=n+a/2}),n+=a+t})}});var S_=B((lye,x_)=>{"use strict";var ze=St(),m_=eF(),y_=oF(),rfe=xF(),nfe=xr().normalizeRanks,ife=CF(),afe=xr().removeEmptyRanks,b_=TF(),sfe=DF(),w_=RF(),ofe=n_(),lfe=v_(),ra=xr(),ufe=sn().Graph;x_.exports=hfe;function hfe(r,e){var t=e&&e.debugTiming?ra.time:ra.notime;t("layout",function(){var n=t("  buildLayoutGraph",function(){return xfe(r)});t("  runLayout",function(){ffe(n,t)}),t("  updateInputGraph",function(){cfe(r,n)})})}function ffe(r,e){e("    makeSpaceForEdgeLabels",function(){Sfe(r)}),e("    removeSelfEdges",function(){Bfe(r)}),e("    acyclic",function(){m_.run(r)}),e("    nestingGraph.run",function(){b_.run(r)}),e("    rank",function(){rfe(ra.asNonCompoundGraph(r))}),e("    injectEdgeLabelProxies",function(){Cfe(r)}),e("    removeEmptyRanks",function(){afe(r)}),e("    nestingGraph.cleanup",function(){b_.cleanup(r)}),e("    normalizeRanks",function(){nfe(r)}),e("    assignRankMinMax",function(){kfe(r)}),e("    removeEdgeLabelProxies",function(){Efe(r)}),e("    normalize.run",function(){y_.run(r)}),e("    parentDummyChains",function(){ife(r)}),e("    addBorderSegments",function(){sfe(r)}),e("    order",function(){ofe(r)}),e("    insertSelfEdges",function(){Ofe(r)}),e("    adjustCoordinateSystem",function(){w_.adjust(r)}),e("    position",function(){lfe(r)}),e("    positionSelfEdges",function(){Rfe(r)}),e("    removeBorderNodes",function(){Pfe(r)}),e("    normalize.undo",function(){y_.undo(r)}),e("    fixupEdgeLabelCoords",function(){Mfe(r)}),e("    undoCoordinateSystem",function(){w_.undo(r)}),e("    translateGraph",function(){Tfe(r)}),e("    assignNodeIntersects",function(){Afe(r)}),e("    reversePoints",function(){Dfe(r)}),e("    acyclic.undo",function(){m_.undo(r)})}function cfe(r,e){ze.forEach(r.nodes(),function(t){var n=r.node(t),i=e.node(t);n&&(n.x=i.x,n.y=i.y,e.children(t).length&&(n.width=i.width,n.height=i.height))}),ze.forEach(r.edges(),function(t){var n=r.edge(t),i=e.edge(t);n.points=i.points,ze.has(i,"x")&&(n.x=i.x,n.y=i.y)}),r.graph().width=e.graph().width,r.graph().height=e.graph().height}var dfe=["nodesep","edgesep","ranksep","marginx","marginy"],pfe={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},gfe=["acyclicer","ranker","rankdir","align"],vfe=["width","height"],mfe={width:0,height:0},yfe=["minlen","weight","width","height","labeloffset"],bfe={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},wfe=["labelpos"];function xfe(r){var e=new ufe({multigraph:!0,compound:!0}),t=ew(r.graph());return e.setGraph(ze.merge({},pfe,Jb(t,dfe),ze.pick(t,gfe))),ze.forEach(r.nodes(),function(n){var i=ew(r.node(n));e.setNode(n,ze.defaults(Jb(i,vfe),mfe)),e.setParent(n,r.parent(n))}),ze.forEach(r.edges(),function(n){var i=ew(r.edge(n));e.setEdge(n,ze.merge({},bfe,Jb(i,yfe),ze.pick(i,wfe)))}),e}function Sfe(r){var e=r.graph();e.ranksep/=2,ze.forEach(r.edges(),function(t){var n=r.edge(t);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(e.rankdir==="TB"||e.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function Cfe(r){ze.forEach(r.edges(),function(e){var t=r.edge(e);if(t.width&&t.height){var n=r.node(e.v),i=r.node(e.w),a={rank:(i.rank-n.rank)/2+n.rank,e};ra.addDummyNode(r,"edge-proxy",a,"_ep")}})}function kfe(r){var e=0;ze.forEach(r.nodes(),function(t){var n=r.node(t);n.borderTop&&(n.minRank=r.node(n.borderTop).rank,n.maxRank=r.node(n.borderBottom).rank,e=ze.max(e,n.maxRank))}),r.graph().maxRank=e}function Efe(r){ze.forEach(r.nodes(),function(e){var t=r.node(e);t.dummy==="edge-proxy"&&(r.edge(t.e).labelRank=t.rank,r.removeNode(e))})}function Tfe(r){var e=Number.POSITIVE_INFINITY,t=0,n=Number.POSITIVE_INFINITY,i=0,a=r.graph(),s=a.marginx||0,o=a.marginy||0;function l(u){var h=u.x,f=u.y,c=u.width,d=u.height;e=Math.min(e,h-c/2),t=Math.max(t,h+c/2),n=Math.min(n,f-d/2),i=Math.max(i,f+d/2)}ze.forEach(r.nodes(),function(u){l(r.node(u))}),ze.forEach(r.edges(),function(u){var h=r.edge(u);ze.has(h,"x")&&l(h)}),e-=s,n-=o,ze.forEach(r.nodes(),function(u){var h=r.node(u);h.x-=e,h.y-=n}),ze.forEach(r.edges(),function(u){var h=r.edge(u);ze.forEach(h.points,function(f){f.x-=e,f.y-=n}),ze.has(h,"x")&&(h.x-=e),ze.has(h,"y")&&(h.y-=n)}),a.width=t-e+s,a.height=i-n+o}function Afe(r){ze.forEach(r.edges(),function(e){var t=r.edge(e),n=r.node(e.v),i=r.node(e.w),a,s;t.points?(a=t.points[0],s=t.points[t.points.length-1]):(t.points=[],a=i,s=n),t.points.unshift(ra.intersectRect(n,a)),t.points.push(ra.intersectRect(i,s))})}function Mfe(r){ze.forEach(r.edges(),function(e){var t=r.edge(e);if(ze.has(t,"x"))switch((t.labelpos==="l"||t.labelpos==="r")&&(t.width-=t.labeloffset),t.labelpos){case"l":t.x-=t.width/2+t.labeloffset;break;case"r":t.x+=t.width/2+t.labeloffset;break}})}function Dfe(r){ze.forEach(r.edges(),function(e){var t=r.edge(e);t.reversed&&t.points.reverse()})}function Pfe(r){ze.forEach(r.nodes(),function(e){if(r.children(e).length){var t=r.node(e),n=r.node(t.borderTop),i=r.node(t.borderBottom),a=r.node(ze.last(t.borderLeft)),s=r.node(ze.last(t.borderRight));t.width=Math.abs(s.x-a.x),t.height=Math.abs(i.y-n.y),t.x=a.x+t.width/2,t.y=n.y+t.height/2}}),ze.forEach(r.nodes(),function(e){r.node(e).dummy==="border"&&r.removeNode(e)})}function Bfe(r){ze.forEach(r.edges(),function(e){if(e.v===e.w){var t=r.node(e.v);t.selfEdges||(t.selfEdges=[]),t.selfEdges.push({e,label:r.edge(e)}),r.removeEdge(e)}})}function Ofe(r){var e=ra.buildLayerMatrix(r);ze.forEach(e,function(t){var n=0;ze.forEach(t,function(i,a){var s=r.node(i);s.order=a+n,ze.forEach(s.selfEdges,function(o){ra.addDummyNode(r,"selfedge",{width:o.label.width,height:o.label.height,rank:s.rank,order:a+ ++n,e:o.e,label:o.label},"_se")}),delete s.selfEdges})})}function Rfe(r){ze.forEach(r.nodes(),function(e){var t=r.node(e);if(t.dummy==="selfedge"){var n=r.node(t.e.v),i=n.x+n.width/2,a=n.y,s=t.x-i,o=n.height/2;r.setEdge(t.e,t.label),r.removeNode(e),t.label.points=[{x:i+2*s/3,y:a-o},{x:i+5*s/6,y:a-o},{x:i+s,y:a},{x:i+5*s/6,y:a+o},{x:i+2*s/3,y:a+o}],t.label.x=t.x,t.label.y=t.y}})}function Jb(r,e){return ze.mapValues(ze.pick(r,e),Number)}function ew(r){var e={};return ze.forEach(r,function(t,n){e[n.toLowerCase()]=t}),e}});var k_=B((uye,C_)=>{var wd=St(),Lfe=xr(),Ife=sn().Graph;C_.exports={debugOrdering:Nfe};function Nfe(r){var e=Lfe.buildLayerMatrix(r),t=new Ife({compound:!0,multigraph:!0}).setGraph({});return wd.forEach(r.nodes(),function(n){t.setNode(n,{label:n}),t.setParent(n,"layer"+r.node(n).rank)}),wd.forEach(r.edges(),function(n){t.setEdge(n.v,n.w,{},n.name)}),wd.forEach(e,function(n,i){var a="layer"+i;t.setNode(a,{rank:"same"}),wd.reduce(n,function(s,o){return t.setEdge(s,o,{style:"invis"}),o})}),t}});var T_=B((hye,E_)=>{E_.exports="0.8.5"});var tw=B((fye,A_)=>{A_.exports={graphlib:sn(),layout:S_(),debug:k_(),util:{time:xr().time,notime:xr().notime},version:T_()}});var M_=B((_u,rw)=>{(function(e,t){typeof _u=="object"&&typeof rw=="object"?rw.exports=t(tw()):typeof define=="function"&&define.amd?define(["dagre"],t):typeof _u=="object"?_u.cytoscapeDagre=t(tw()):e.cytoscapeDagre=t(e.dagre)})(_u,function(r){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(i,a,s){n.o(i,a)||Object.defineProperty(i,a,{enumerable:!0,get:s})},n.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},n.t=function(i,a){if(a&1&&(i=n(i)),a&8||a&4&&typeof i=="object"&&i&&i.__esModule)return i;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:i}),a&2&&typeof i!="string")for(var o in i)n.d(s,o,function(l){return i[l]}.bind(null,o));return s},n.n=function(i){var a=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(a,"a",a),a},n.o=function(i,a){return Object.prototype.hasOwnProperty.call(i,a)},n.p="",n(n.s=0)}([function(e,t,n){var i=n(1),a=function(o){o&&o("layout","dagre",i)};typeof cytoscape<"u"&&a(cytoscape),e.exports=a},function(e,t,n){function i(h){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?i=function(c){return typeof c}:i=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},i(h)}var a=function(f){return typeof f=="function"},s=n(2),o=n(3),l=n(4);function u(h){this.options=o({},s,h)}u.prototype.run=function(){var h=this.options,f=this,c=h.cy,d=h.eles,p=function(q,z){return a(z)?z.apply(q,[q]):z},g=h.boundingBox||{x1:0,y1:0,w:c.width(),h:c.height()};g.x2===void 0&&(g.x2=g.x1+g.w),g.w===void 0&&(g.w=g.x2-g.x1),g.y2===void 0&&(g.y2=g.y1+g.h),g.h===void 0&&(g.h=g.y2-g.y1);var v=new l.graphlib.Graph({multigraph:!0,compound:!0}),m={},y=function(q,z){z!=null&&(m[q]=z)};y("nodesep",h.nodeSep),y("edgesep",h.edgeSep),y("ranksep",h.rankSep),y("rankdir",h.rankDir),y("align",h.align),y("ranker",h.ranker),y("acyclicer",h.acyclicer),v.setGraph(m),v.setDefaultEdgeLabel(function(){return{}}),v.setDefaultNodeLabel(function(){return{}});var b=d.nodes();a(h.sort)&&(b=b.sort(h.sort));for(var w=0;w<b.length;w++){var S=b[w],C=S.layoutDimensions(h);v.setNode(S.id(),{width:C.w,height:C.h,name:S.id()})}for(var x=0;x<b.length;x++){var A=b[x];A.isChild()&&v.setParent(A.id(),A.parent().id())}var T=d.edges().stdFilter(function(N){return!N.source().isParent()&&!N.target().isParent()});a(h.sort)&&(T=T.sort(h.sort));for(var D=0;D<T.length;D++){var k=T[D];v.setEdge(k.source().id(),k.target().id(),{minlen:p(k,h.minLen),weight:p(k,h.edgeWeight),name:k.id()},k.id())}l.layout(v);for(var E=v.nodes(),M=0;M<E.length;M++){var O=E[M],R=v.node(O);c.getElementById(O).scratch().dagre=R}var L;h.boundingBox?(L={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0},b.forEach(function(N){var q=N.scratch().dagre;L.x1=Math.min(L.x1,q.x),L.x2=Math.max(L.x2,q.x),L.y1=Math.min(L.y1,q.y),L.y2=Math.max(L.y2,q.y)}),L.w=L.x2-L.x1,L.h=L.y2-L.y1):L=g;var I=function(q){if(h.boundingBox){var z=L.w===0?0:(q.x-L.x1)/L.w,F=L.h===0?0:(q.y-L.y1)/L.h;return{x:g.x1+z*g.w,y:g.y1+F*g.h}}else return q};return b.layoutPositions(f,h,function(N){N=i(N)==="object"?N:this;var q=N.scratch().dagre;return I({x:q.x,y:q.y})}),this},e.exports=u},function(e,t){var n={nodeSep:void 0,edgeSep:void 0,rankSep:void 0,rankDir:void 0,align:void 0,acyclicer:void 0,ranker:void 0,minLen:function(a){return 1},edgeWeight:function(a){return 1},fit:!0,padding:30,spacingFactor:void 0,nodeDimensionsIncludeLabels:!1,animate:!1,animateFilter:function(a,s){return!0},animationDuration:500,animationEasing:void 0,boundingBox:void 0,transform:function(a,s){return s},ready:function(){},sort:void 0,stop:function(){}};e.exports=n},function(e,t){e.exports=Object.assign!=null?Object.assign.bind(Object):function(n){for(var i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];return a.forEach(function(o){Object.keys(o).forEach(function(l){return n[l]=o[l]})}),n}},function(e,t){e.exports=r}])})});var D_=B(xd=>{"use strict";Object.defineProperty(xd,"__esModule",{value:!0});xd.example=void 0;xd.example=`BEGIN
  A;
  PARBEGIN
    BEGIN
      B;
      C;
    END
    BEGIN
      D;
      E;
    END
  PAREND;
  F;
END
`});var P_=B(Sd=>{"use strict";Object.defineProperty(Sd,"__esModule",{value:!0});Sd.interpret=void 0;var qfe=r=>{let e=[],t=(n,i=[])=>{if(!n)return[];switch(n.type){case"call":return e.push({data:{id:n.id,label:n.label}}),i.forEach(o=>{e.push({data:{source:o.id,target:n.id}})}),[n];case"seq":let a=[...i];return Array.isArray(n.child)&&n.child.forEach(o=>{a=t(o,a)}),a;case"par":let s=[];return Array.isArray(n.child)&&n.child.forEach(o=>{let l=t(o,i);s=[...s,...l]}),s;default:return i}};return t(r),e};Sd.interpret=qfe});var B_=B(Cd=>{"use strict";Object.defineProperty(Cd,"__esModule",{value:!0});Cd.parse=void 0;var Ffe=(r,e)=>{let t=[],n=[],i=e.cursor();do switch(i.name){case"Begin":{t.push("begin"),n.push("[");break}case"End":{t.pop()!=="begin"&&console.log("error"),n.push("]");break}case"ParBegin":{t.push("parbegin"),n.push("(");break}case"ParEnd":{t.pop()!=="parbegin"&&console.log("error"),n.push(")");break}case"Call":{i.firstChild(),n.push(r.substr(i.from,i.to-i.from));break}}while(i.next());return n};Cd.parse=Ffe});function I_(r,e,t,n){switch(r){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function Vu(r,e,t,n){for(var i;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let s=!n&&r instanceof Kn&&r.index<0?null:r.parent;if(!s)return r;r=s}let a=n?0:$t.IgnoreOverlays;if(n)for(let s=r,o=s.parent;o;s=o,o=s.parent)s instanceof Kn&&s.index<0&&((i=o.enter(e,t,a))===null||i===void 0?void 0:i.from)!=s.from&&(r=o);for(;;){let s=r.enter(e,t,a);if(!s)return r;r=s}}function R_(r,e,t,n){let i=r.cursor(),a=[];if(!i.firstChild())return a;if(t!=null){for(let s=!1;!s;)if(s=i.type.is(t),!i.nextSibling())return a}for(;;){if(n!=null&&i.type.is(n))return a;if(i.type.is(e)&&a.push(i.node),!i.nextSibling())return n==null?a:[]}}function iw(r,e,t=e.length-1){for(let n=r;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}function N_(r){if(!r.length)return null;let e=0,t=r[0];for(let a=1;a<r.length;a++){let s=r[a];(s.from>t.from||s.to<t.to)&&(t=s,e=a)}let n=t instanceof Kn&&t.index<0?null:t.parent,i=r.slice();return n?i[e]=n:i.splice(e,1),new sw(i,t)}function Vfe(r,e,t){let n=r.resolveInner(e,t),i=null;for(let a=n instanceof Kn?n:n.context.parent;a;a=a.parent)if(a.index<0){let s=a.parent;(i||(i=[n])).push(s.resolve(e,t)),a=s}else{let s=bo.get(a.tree);if(s&&s.overlay&&s.overlay[0].from<=e&&s.overlay[s.overlay.length-1].to>=e){let o=new Kn(s.tree,s.overlay[0].from+a.from,-1,a);(i||(i=[n])).push(Vu(o,e,t,!1))}}return i?N_(i):n}function lw(r){return r.children.some(e=>e instanceof na||!e.type.isAnonymous||lw(e))}function Hfe(r){var e;let{buffer:t,nodeSet:n,maxBufferLength:i=1024,reused:a=[],minRepeatType:s=n.types.length}=r,o=Array.isArray(t)?new nw(t,t.length):t,l=n.types,u=0,h=0;function f(S,C,x,A,T,D){let{id:k,start:E,end:M,size:O}=o,R=h,L=u;for(;O<0;)if(o.next(),O==-1){let F=a[k];x.push(F),A.push(E-S);return}else if(O==-3){u=k;return}else if(O==-4){h=k;return}else throw new RangeError(`Unrecognized record size: ${O}`);let I=l[k],N,q,z=E-S;if(M-E<=i&&(q=v(o.pos-C,T))){let F=new Uint16Array(q.size-q.skip),_=o.pos-q.size,U=F.length;for(;o.pos>_;)U=m(q.start,F,U);N=new na(F,M-q.start,n),z=q.start-S}else{let F=o.pos-O;o.next();let _=[],U=[],X=k>=s?k:-1,$=0,Q=M;for(;o.pos>F;)X>=0&&o.id==X&&o.size>=0?(o.end<=Q-i&&(p(_,U,E,$,o.end,Q,X,R,L),$=_.length,Q=o.end),o.next()):D>2500?c(E,F,_,U):f(E,F,_,U,X,D+1);if(X>=0&&$>0&&$<_.length&&p(_,U,E,$,E,Q,X,R,L),_.reverse(),U.reverse(),X>-1&&$>0){let ee=d(I,L);N=uw(I,_,U,0,_.length,0,M-E,ee,ee)}else N=g(I,_,U,M-E,R-M,L)}x.push(N),A.push(z)}function c(S,C,x,A){let T=[],D=0,k=-1;for(;o.pos>C;){let{id:E,start:M,end:O,size:R}=o;if(R>4)o.next();else{if(k>-1&&M<k)break;k<0&&(k=O-i),T.push(E,M,O),D++,o.next()}}if(D){let E=new Uint16Array(D*4),M=T[T.length-2];for(let O=T.length-3,R=0;O>=0;O-=3)E[R++]=T[O],E[R++]=T[O+1]-M,E[R++]=T[O+2]-M,E[R++]=R;x.push(new na(E,T[2]-M,n)),A.push(M-S)}}function d(S,C){return(x,A,T)=>{let D=0,k=x.length-1,E,M;if(k>=0&&(E=x[k])instanceof Nr){if(!k&&E.type==S&&E.length==T)return E;(M=E.prop(ct.lookAhead))&&(D=A[k]+E.length+M)}return g(S,x,A,T,D,C)}}function p(S,C,x,A,T,D,k,E,M){let O=[],R=[];for(;S.length>A;)O.push(S.pop()),R.push(C.pop()+x-T);S.push(g(n.types[k],O,R,D-T,E-D,M)),C.push(T-x)}function g(S,C,x,A,T,D,k){if(D){let E=[ct.contextHash,D];k=k?[E].concat(k):[E]}if(T>25){let E=[ct.lookAhead,T];k=k?[E].concat(k):[E]}return new Nr(S,C,x,A,k)}function v(S,C){let x=o.fork(),A=0,T=0,D=0,k=x.end-i,E={size:0,start:0,skip:0};e:for(let M=x.pos-S;x.pos>M;){let O=x.size;if(x.id==C&&O>=0){E.size=A,E.start=T,E.skip=D,D+=4,A+=4,x.next();continue}let R=x.pos-O;if(O<0||R<M||x.start<k)break;let L=x.id>=s?4:0,I=x.start;for(x.next();x.pos>R;){if(x.size<0)if(x.size==-3)L+=4;else break e;else x.id>=s&&(L+=4);x.next()}T=I,A+=O,D+=L}return(C<0||A==S)&&(E.size=A,E.start=T,E.skip=D),E.size>4?E:void 0}function m(S,C,x){let{id:A,start:T,end:D,size:k}=o;if(o.next(),k>=0&&A<s){let E=x;if(k>4){let M=o.pos-(k-4);for(;o.pos>M;)x=m(S,C,x)}C[--x]=E,C[--x]=D-S,C[--x]=T-S,C[--x]=A}else k==-3?u=A:k==-4&&(h=A);return x}let y=[],b=[];for(;o.pos>0;)f(r.start||0,r.bufferStart||0,y,b,-1,0);let w=(e=r.length)!==null&&e!==void 0?e:y.length?b[0]+y[0].length:0;return new Nr(l[r.topID],y.reverse(),b.reverse(),w)}function Ed(r,e){if(!r.isAnonymous||e instanceof na||e.type!=r)return 1;let t=L_.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=r||!(n instanceof Nr)){t=1;break}t+=Ed(r,n)}L_.set(e,t)}return t}function uw(r,e,t,n,i,a,s,o,l){let u=0;for(let p=n;p<i;p++)u+=Ed(r,e[p]);let h=Math.ceil(u*1.5/8),f=[],c=[];function d(p,g,v,m,y){for(let b=v;b<m;){let w=b,S=g[b],C=Ed(r,p[b]);for(b++;b<m;b++){let x=Ed(r,p[b]);if(C+x>=h)break;C+=x}if(b==w+1){if(C>h){let x=p[w];d(x.children,x.positions,0,x.children.length,g[w]+y);continue}f.push(p[w])}else{let x=g[b-1]+p[b-1].length-S;f.push(uw(r,p,g,w,b,S,x,null,l))}c.push(S+y-a)}}return d(e,t,n,i,0),(o||l)(f,c,s)}var _fe,zu,ct,bo,zfe,on,Td,kd,O_,$t,Nr,nw,na,Ad,Kn,aw,Hu,sw,Wu,L_,Md,ow,gye,q_=Nd(()=>{_fe=0,zu=class{constructor(e,t){this.from=e,this.to=t}},ct=class{constructor(e={}){this.id=_fe++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=on.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}};ct.closedBy=new ct({deserialize:r=>r.split(" ")});ct.openedBy=new ct({deserialize:r=>r.split(" ")});ct.group=new ct({deserialize:r=>r.split(" ")});ct.isolate=new ct({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});ct.contextHash=new ct({perNode:!0});ct.lookAhead=new ct({perNode:!0});ct.mounted=new ct({perNode:!0});bo=class{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[ct.mounted.id]}},zfe=Object.create(null),on=class r{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):zfe,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new r(e.name||"",t,e.id,n);if(e.props){for(let a of e.props)if(Array.isArray(a)||(a=a(i)),a){if(a[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[a[0].id]=a[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(ct.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return n=>{for(let i=n.prop(ct.group),a=-1;a<(i?i.length:0);a++){let s=t[a<0?n.name:i[a]];if(s)return s}}}};on.none=new on("",Object.create(null),0,8);Td=class r{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let i=null;for(let a of e){let s=a(n);s&&(i||(i=Object.assign({},n.props)),i[s[0].id]=s[1])}t.push(i?new on(n.name,i,n.id,n.flags):n)}return new r(t)}},kd=new WeakMap,O_=new WeakMap;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})($t||($t={}));Nr=class r{constructor(e,t,n,i,a){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,a&&a.length){this.props=Object.create(null);for(let[s,o]of a)this.props[typeof s=="number"?s:s.id]=o}}toString(){let e=bo.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let i=n.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Wu(this.topNode,e)}cursorAt(e,t=0,n=0){let i=kd.get(this)||this.topNode,a=new Wu(i);return a.moveTo(e,t),kd.set(this,a._tree),a}get topNode(){return new Kn(this,0,0,null)}resolve(e,t=0){let n=Vu(kd.get(this)||this.topNode,e,t,!1);return kd.set(this,n),n}resolveInner(e,t=0){let n=Vu(O_.get(this)||this.topNode,e,t,!0);return O_.set(this,n),n}resolveStack(e,t=0){return Vfe(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:a=this.length}=e,s=e.mode||0,o=(s&$t.IncludeAnonymous)>0;for(let l=this.cursor(s|$t.IncludeAnonymous);;){let u=!1;if(l.from<=a&&l.to>=i&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;u=!0}for(;u&&n&&(o||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;u=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:uw(on.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,i)=>new r(this.type,t,n,i,this.propValues),e.makeTree||((t,n,i)=>new r(on.none,t,n,i)))}static build(e){return Hfe(e)}};Nr.empty=new Nr(on.none,[],[],0);nw=class r{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new r(this.buffer,this.index)}},na=class r{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return on.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],a=i.name;if(/\W/.test(a)&&!i.isError&&(a=JSON.stringify(a)),e+=4,n==e)return a;let s=[];for(;e<n;)s.push(this.childString(e)),e=this.buffer[e+3];return a+"("+s.join(",")+")"}findChild(e,t,n,i,a){let{buffer:s}=this,o=-1;for(let l=e;l!=t&&!(I_(a,i,s[l+1],s[l+2])&&(o=l,n>0));l=s[l+3]);return o}slice(e,t,n){let i=this.buffer,a=new Uint16Array(t-e),s=0;for(let o=e,l=0;o<t;){a[l++]=i[o++],a[l++]=i[o++]-n;let u=a[l++]=i[o++]-n;a[l++]=i[o++]-e,s=Math.max(s,u)}return new r(a,s,this.set)}};Ad=class{cursor(e=0){return new Wu(this,e)}getChild(e,t=null,n=null){let i=R_(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return R_(this,e,t,n)}resolve(e,t=0){return Vu(this,e,t,!1)}resolveInner(e,t=0){return Vu(this,e,t,!0)}matchContext(e){return iw(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}get node(){return this}get next(){return this.parent}},Kn=class r extends Ad{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,a=0){for(let s=this;;){for(let{children:o,positions:l}=s._tree,u=t>0?o.length:-1;e!=u;e+=t){let h=o[e],f=l[e]+s.from;if(I_(i,n,f,f+h.length)){if(h instanceof na){if(a&$t.ExcludeBuffers)continue;let c=h.findChild(0,h.buffer.length,t,n-f,i);if(c>-1)return new Hu(new aw(s,h,e,f),null,c)}else if(a&$t.IncludeAnonymous||!h.type.isAnonymous||lw(h)){let c;if(!(a&$t.IgnoreMounts)&&(c=bo.get(h))&&!c.overlay)return new r(c.tree,f,e,s);let d=new r(h,f,e,s);return a&$t.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(t<0?h.children.length-1:0,t,n,i)}}}if(a&$t.IncludeAnonymous||!s.type.isAnonymous||(s.index>=0?e=s.index+t:e=t<0?-1:s._parent._tree.children.length,s=s._parent,!s))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&$t.IgnoreOverlays)&&(i=bo.get(this._tree))&&i.overlay){let a=e-this.from;for(let{from:s,to:o}of i.overlay)if((t>0?s<=a:s<a)&&(t<0?o>=a:o>a))return new r(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};aw=class{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}},Hu=class r extends Ad{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,a=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return a<0?null:new r(this.context,this,a)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&$t.ExcludeBuffers)return null;let{buffer:i}=this.context,a=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return a<0?null:new r(this.context,this,a)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new r(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new r(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,a=n.buffer[this.index+3];if(a>i){let s=n.buffer[this.index+1];e.push(n.slice(i,a,s)),t.push(0)}return new Nr(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};sw=class{constructor(e,t){this.heads=e,this.node=t}get next(){return N_(this.heads)}};Wu=class{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Kn)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof Kn?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,a=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return a<0?!1:(this.stack.push(this.index),this.yieldBuf(a))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&$t.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&$t.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&$t.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let a=0;a<this.index;a++)if(i.buffer.buffer[a+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let a=t+e,s=e<0?-1:n._tree.children.length;a!=s;a+=e){let o=n._tree.children[a];if(this.mode&$t.IncludeAnonymous||o instanceof na||!o.type.isAnonymous||lw(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,a=this.stack.length;a>=0;){for(let s=e;s;s=s._parent)if(s.index==i){if(i==this.index)return s;t=s,n=a+1;break e}i=this.stack[--a]}for(let i=n;i<this.stack.length;i++)t=new Hu(this.buffer,t,this.stack[i]);return this.bufferNode=new Hu(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return iw(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,a=this.stack.length-1;i>=0;a--){if(a<0)return iw(this._tree,e,i);let s=n[t.buffer[this.stack[a]]];if(!s.isAnonymous){if(e[i]&&e[i]!=s.name)return!1;i--}}return!0}};L_=new WeakMap;Md=class{startParse(e,t,n){return typeof e=="string"&&(e=new ow(e)),n=n?n.length?n.map(i=>new zu(i.from,i.to)):[new zu(0,0)]:[new zu(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let a=i.advance();if(a)return a}}},ow=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}},gye=new ct({perNode:!0})});function Gu(r,e=Uint16Array){if(typeof r!="string")return r;let t=null;for(let n=0,i=0;n<r.length;){let a=0;for(;;){let s=r.charCodeAt(n++),o=!1;if(s==126){a=65535;break}s>=92&&s--,s>=34&&s--;let l=s-32;if(l>=46&&(l-=46,o=!0),a+=l,o)break;a*=46}t?t[i++]=a:t=new e(a)}return t}function W_(r,e,t,n,i,a){let s=0,o=1<<n,{dialect:l}=t.p.parser;e:for(;(o&r[s])!=0;){let u=r[s+1];for(let d=s+3;d<u;d+=2)if((r[d+1]&o)>0){let p=r[d];if(l.allows(p)&&(e.token.value==-1||e.token.value==p||Gfe(p,e.token.value,i,a))){e.acceptToken(p);break}}let h=e.next,f=0,c=r[s+2];if(e.next<0&&c>f&&r[u+c*3-3]==65535){s=r[u+c*3-1];continue e}for(;f<c;){let d=f+c>>1,p=u+d+(d<<1),g=r[p],v=r[p+1]||65536;if(h<g)c=d;else if(h>=v)f=d+1;else{s=r[p+2],e.advance();continue e}}break}}function __(r,e,t){for(let n=e,i;(i=r[n])!=65535;n++)if(i==t)return n-e;return-1}function Gfe(r,e,t,n){let i=__(t,n,e);return i<0||__(t,n,r)<i}function z_(r,e,t){let n=r.cursor($t.IncludeAnonymous);for(n.moveTo(e);;)if(!(t<0?n.childBefore(e):n.childAfter(e)))for(;;){if((t<0?n.to<e:n.from>e)&&!n.type.isError)return t<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(r.length,Math.max(n.from+1,e+25));if(t<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return t<0?0:r.length}}function V_(r,e){for(let t=0;t<e.length;t++){let n=e[t];if(n.pos==r.pos&&n.sameState(r)){e[t].score<r.score&&(e[t]=r);return}}e.push(r)}function pi(r,e){return r[e]|r[e+1]<<16}function Ufe(r){let e=null;for(let t of r){let n=t.p.stoppedAt;(t.pos==t.p.stream.end||n!=null&&t.pos>n)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function H_(r){if(r.external){let e=r.extend?1:0;return(t,n)=>r.external(t,n)<<1|e}return r.get}var fw,Dd,cw,dw,wo,F_,pw,ia,gw,jr,hw,vw,mw,yw,bw,Pd,G_=Nd(()=>{q_();fw=class r{constructor(e,t,n,i,a,s,o,l,u,h=0,f){this.p=e,this.stack=t,this.state=n,this.reducePos=i,this.pos=a,this.score=s,this.buffer=o,this.bufferBase=l,this.curContext=u,this.lookAhead=h,this.parent=f}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,n=0){let i=e.parser.context;return new r(e,[],t,n,n,0,[],0,i?new Dd(i,i.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let n=e>>19,i=e&65535,{parser:a}=this.p,s=this.reducePos<this.pos-25;s&&this.setLookAhead(this.pos);let o=a.dynamicPrecedence(i);if(o&&(this.score+=o),n==0){this.pushState(a.getGoto(this.state,i,!0),this.reducePos),i<a.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,s?8:4,!0),this.reduceContext(i,this.reducePos);return}let l=this.stack.length-(n-1)*3-(e&262144?6:0),u=l?this.stack[l-2]:this.p.ranges[0].from,h=this.reducePos-u;h>=2e3&&!(!((t=this.p.parser.nodeSet.types[i])===null||t===void 0)&&t.isAnonymous)&&(u==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=h):this.p.lastBigReductionSize<h&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=u,this.p.lastBigReductionSize=h));let f=l?this.stack[l-1]:0,c=this.bufferBase+this.buffer.length-f;if(i<a.minRepeatTerm||e&131072){let d=a.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,u,d,c+4,!0)}if(e&262144)this.state=this.stack[l];else{let d=this.stack[l-3];this.state=a.getGoto(d,i,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(i,u)}storeNode(e,t,n,i=4,a=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let s=this,o=this.buffer.length;if(o==0&&s.parent&&(o=s.bufferBase-s.parent.bufferBase,s=s.parent),o>0&&s.buffer[o-4]==0&&s.buffer[o-1]>-1){if(t==n)return;if(s.buffer[o-2]>=t){s.buffer[o-2]=n;return}}}if(!a||this.pos==n)this.buffer.push(e,t,n,i);else{let s=this.buffer.length;if(s>0&&this.buffer[s-4]!=0){let o=!1;for(let l=s;l>0&&this.buffer[l-2]>n;l-=4)if(this.buffer[l-1]>=0){o=!0;break}if(o)for(;s>0&&this.buffer[s-2]>n;)this.buffer[s]=this.buffer[s-4],this.buffer[s+1]=this.buffer[s-3],this.buffer[s+2]=this.buffer[s-2],this.buffer[s+3]=this.buffer[s-1],s-=4,i>4&&(i-=4)}this.buffer[s]=e,this.buffer[s+1]=t,this.buffer[s+2]=n,this.buffer[s+3]=i}}shift(e,t,n,i){if(e&131072)this.pushState(e&65535,this.pos);else if((e&262144)==0){let a=e,{parser:s}=this.p;(i>this.pos||t<=s.maxNode)&&(this.pos=i,s.stateFlag(a,1)||(this.reducePos=i)),this.pushState(a,n),this.shiftContext(t,n),t<=s.maxNode&&this.buffer.push(t,n,i,4)}else this.pos=i,this.shiftContext(t,n),t<=this.p.parser.maxNode&&this.buffer.push(t,n,i,4)}apply(e,t,n,i){e&65536?this.reduce(e):this.shift(e,t,n,i)}useNode(e,t){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let i=this.pos;this.reducePos=this.pos=i+e.length,this.pushState(t,i),this.buffer.push(n,i,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let n=e.buffer.slice(t),i=e.bufferBase+t;for(;e&&i==e.bufferBase;)e=e.parent;return new r(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,i,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new cw(this);;){let n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(n==0)return!1;if((n&65536)==0)return!0;t.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let i=[];for(let a=0,s;a<t.length;a+=2)(s=t[a+1])!=this.state&&this.p.parser.hasAction(s,e)&&i.push(t[a],s);if(this.stack.length<120)for(let a=0;i.length<8&&a<t.length;a+=2){let s=t[a+1];i.some((o,l)=>l&1&&o==s)||i.push(t[a],s)}t=i}let n=[];for(let i=0;i<t.length&&n.length<4;i+=2){let a=t[i+1];if(a==this.state)continue;let s=this.split();s.pushState(a,this.pos),s.storeNode(0,s.pos,s.pos,4,!0),s.shiftContext(t[i],this.pos),s.reducePos=this.pos,s.score-=200,n.push(s)}return n}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if((t&65536)==0)return!1;if(!e.validAction(this.state,t)){let n=t>>19,i=t&65535,a=this.stack.length-n*3;if(a<0||e.getGoto(this.stack[a],i,!1)<0){let s=this.findForcedReduction();if(s==null)return!1;t=s}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],n=(i,a)=>{if(!t.includes(i))return t.push(i),e.allActions(i,s=>{if(!(s&393216))if(s&65536){let o=(s>>19)-a;if(o>1){let l=s&65535,u=this.stack.length-o*3;if(u>=0&&e.getGoto(this.stack[u],l,!1)>=0)return o<<19|65536|l}}else{let o=n(s,a+1);if(o!=null)return o}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new Dd(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}},Dd=class{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}},cw=class{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,n=e>>19;n==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(n-1)*3;let i=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=i}},dw=class r{constructor(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new r(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new r(this.stack,this.pos,this.index)}};wo=class{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}},F_=new wo,pw=class{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=F_,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let n=this.range,i=this.rangeIndex,a=this.pos+e;for(;a<n.from;){if(!i)return null;let s=this.ranges[--i];a-=n.from-s.to,n=s}for(;t<0?a>n.to:a>=n.to;){if(i==this.ranges.length-1)return null;let s=this.ranges[++i];a+=s.from-n.to,n=s}return a}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,n,i;if(t>=0&&t<this.chunk.length)n=this.pos+e,i=this.chunk.charCodeAt(t);else{let a=this.resolveOffset(e,1);if(a==null)return-1;if(n=a,n>=this.chunk2Pos&&n<this.chunk2Pos+this.chunk2.length)i=this.chunk2.charCodeAt(n-this.chunk2Pos);else{let s=this.rangeIndex,o=this.range;for(;o.to<=n;)o=this.ranges[++s];this.chunk2=this.input.chunk(this.chunk2Pos=n),n+this.chunk2.length>o.to&&(this.chunk2=this.chunk2.slice(0,o.to-n)),i=this.chunk2.charCodeAt(0)}}return n>=this.token.lookAhead&&(this.token.lookAhead=n+1),i}acceptToken(e,t=0){let n=t?this.resolveOffset(t,-1):this.pos;if(n==null||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=F_,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let n="";for(let i of this.ranges){if(i.from>=t)break;i.to>e&&(n+=this.input.read(Math.max(i.from,e),Math.min(i.to,t)))}return n}},ia=class{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:n}=t.p;W_(this.data,e,t,this.id,n.data,n.tokenPrecTable)}};ia.prototype.contextual=ia.prototype.fallback=ia.prototype.extend=!1;gw=class{constructor(e,t,n){this.precTable=t,this.elseToken=n,this.data=typeof e=="string"?Gu(e):e}token(e,t){let n=e.pos,i=0;for(;;){let a=e.next<0,s=e.resolveOffset(1,1);if(W_(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(a||i++,s==null)break;e.reset(s,e.token)}i&&(e.reset(n,e.token),e.acceptToken(this.elseToken,i))}};gw.prototype.contextual=ia.prototype.fallback=ia.prototype.extend=!1;jr=typeof process<"u"&&process.env&&/\bparse\b/.test(process.env.LOG),hw=null;vw=class{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?z_(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?z_(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let n=this.trees[t],i=this.index[t];if(i==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let a=n.children[i],s=this.start[t]+n.positions[i];if(s>e)return this.nextStart=s,null;if(a instanceof Nr){if(s==e){if(s<this.safeFrom)return null;let o=s+a.length;if(o<=this.safeTo){let l=a.prop(ct.lookAhead);if(!l||o+l<this.fragment.to)return a}}this.index[t]++,s+a.length>=Math.max(this.safeFrom,e)&&(this.trees.push(a),this.start.push(s),this.index.push(0))}else this.index[t]++,this.nextStart=s+a.length}}},mw=class{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(n=>new wo)}getActions(e){let t=0,n=null,{parser:i}=e.p,{tokenizers:a}=i,s=i.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,l=0;for(let u=0;u<a.length;u++){if((1<<u&s)==0)continue;let h=a[u],f=this.tokens[u];if(!(n&&!h.fallback)&&((h.contextual||f.start!=e.pos||f.mask!=s||f.context!=o)&&(this.updateCachedToken(f,h,e),f.mask=s,f.context=o),f.lookAhead>f.end+25&&(l=Math.max(f.lookAhead,l)),f.value!=0)){let c=t;if(f.extended>-1&&(t=this.addActions(e,f.extended,f.end,t)),t=this.addActions(e,f.value,f.end,t),!h.extend&&(n=f,t>c))break}}for(;this.actions.length>t;)this.actions.pop();return l&&e.setLookAhead(l),!n&&e.pos==this.stream.end&&(n=new wo,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new wo,{pos:n,p:i}=e;return t.start=n,t.end=Math.min(n+1,i.stream.end),t.value=n==i.stream.end?i.parser.eofTerm:0,t}updateCachedToken(e,t,n){let i=this.stream.clipPos(n.pos);if(t.token(this.stream.reset(i,e),n),e.value>-1){let{parser:a}=n.p;for(let s=0;s<a.specialized.length;s++)if(a.specialized[s]==e.value){let o=a.specializers[s](this.stream.read(e.start,e.end),n);if(o>=0&&n.p.parser.dialect.allows(o>>1)){(o&1)==0?e.value=o>>1:e.extended=o>>1;break}}}else e.value=0,e.end=this.stream.clipPos(i+1)}putAction(e,t,n,i){for(let a=0;a<i;a+=3)if(this.actions[a]==e)return i;return this.actions[i++]=e,this.actions[i++]=t,this.actions[i++]=n,i}addActions(e,t,n,i){let{state:a}=e,{parser:s}=e.p,{data:o}=s;for(let l=0;l<2;l++)for(let u=s.stateSlot(a,l?2:1);;u+=3){if(o[u]==65535)if(o[u+1]==1)u=pi(o,u+2);else{i==0&&o[u+1]==2&&(i=this.putAction(pi(o,u+2),t,n,i));break}o[u]==t&&(i=this.putAction(pi(o,u+1),t,n,i))}return i}},yw=class{constructor(e,t,n,i){this.parser=e,this.input=t,this.ranges=i,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new pw(t,i),this.tokens=new mw(e,this.stream),this.topTerm=e.top[1];let{from:a}=i[0];this.stacks=[fw.start(this,e.top[0],a)],this.fragments=n.length&&this.stream.end-a>e.bufferLength*4?new vw(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,n=this.stacks=[],i,a;if(this.bigReductionCount>300&&e.length==1){let[s]=e;for(;s.forceReduce()&&s.stack.length&&s.stack[s.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let s=0;s<e.length;s++){let o=e[s];for(;;){if(this.tokens.mainToken=null,o.pos>t)n.push(o);else{if(this.advanceStack(o,n,e))continue;{i||(i=[],a=[]),i.push(o);let l=this.tokens.getMainToken(o);a.push(l.value,l.end)}}break}}if(!n.length){let s=i&&Ufe(i);if(s)return jr&&console.log("Finish with "+this.stackID(s)),this.stackToTree(s);if(this.parser.strict)throw jr&&i&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&i){let s=this.stoppedAt!=null&&i[0].pos>this.stoppedAt?i[0]:this.runRecovery(i,a,n);if(s)return jr&&console.log("Force-finish "+this.stackID(s)),this.stackToTree(s.forceAll())}if(this.recovering){let s=this.recovering==1?1:this.recovering*3;if(n.length>s)for(n.sort((o,l)=>l.score-o.score);n.length>s;)n.pop();n.some(o=>o.reducePos>t)&&this.recovering--}else if(n.length>1){e:for(let s=0;s<n.length-1;s++){let o=n[s];for(let l=s+1;l<n.length;l++){let u=n[l];if(o.sameState(u)||o.buffer.length>500&&u.buffer.length>500)if((o.score-u.score||o.buffer.length-u.buffer.length)>0)n.splice(l--,1);else{n.splice(s--,1);continue e}}}n.length>12&&n.splice(12,n.length-12)}this.minStackPos=n[0].pos;for(let s=1;s<n.length;s++)n[s].pos<this.minStackPos&&(this.minStackPos=n[s].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,n){let i=e.pos,{parser:a}=this,s=jr?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&i>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let u=e.curContext&&e.curContext.tracker.strict,h=u?e.curContext.hash:0;for(let f=this.fragments.nodeAt(i);f;){let c=this.parser.nodeSet.types[f.type.id]==f.type?a.getGoto(e.state,f.type.id):-1;if(c>-1&&f.length&&(!u||(f.prop(ct.contextHash)||0)==h))return e.useNode(f,c),jr&&console.log(s+this.stackID(e)+` (via reuse of ${a.getName(f.type.id)})`),!0;if(!(f instanceof Nr)||f.children.length==0||f.positions[0]>0)break;let d=f.children[0];if(d instanceof Nr&&f.positions[0]==0)f=d;else break}}let o=a.stateSlot(e.state,4);if(o>0)return e.reduce(o),jr&&console.log(s+this.stackID(e)+` (via always-reduce ${a.getName(o&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let u=0;u<l.length;){let h=l[u++],f=l[u++],c=l[u++],d=u==l.length||!n,p=d?e:e.split(),g=this.tokens.mainToken;if(p.apply(h,f,g?g.start:p.pos,c),jr&&console.log(s+this.stackID(p)+` (via ${(h&65536)==0?"shift":`reduce of ${a.getName(h&65535)}`} for ${a.getName(f)} @ ${i}${p==e?"":", split"})`),d)return!0;p.pos>i?t.push(p):n.push(p)}return!1}advanceFully(e,t){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return V_(e,t),!0}}runRecovery(e,t,n){let i=null,a=!1;for(let s=0;s<e.length;s++){let o=e[s],l=t[s<<1],u=t[(s<<1)+1],h=jr?this.stackID(o)+" -> ":"";if(o.deadEnd&&(a||(a=!0,o.restart(),jr&&console.log(h+this.stackID(o)+" (restarted)"),this.advanceFully(o,n))))continue;let f=o.split(),c=h;for(let d=0;f.forceReduce()&&d<10&&(jr&&console.log(c+this.stackID(f)+" (via force-reduce)"),!this.advanceFully(f,n));d++)jr&&(c=this.stackID(f)+" -> ");for(let d of o.recoverByInsert(l))jr&&console.log(h+this.stackID(d)+" (via recover-insert)"),this.advanceFully(d,n);this.stream.end>o.pos?(u==o.pos&&(u++,l=0),o.recoverByDelete(l,u),jr&&console.log(h+this.stackID(o)+` (via recover-delete ${this.parser.getName(l)})`),V_(o,n)):(!i||i.score<o.score)&&(i=o)}return i}stackToTree(e){return e.close(),Nr.build({buffer:dw.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(hw||(hw=new WeakMap)).get(e);return t||hw.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}};bw=class{constructor(e,t,n){this.source=e,this.flags=t,this.disabled=n}allows(e){return!this.disabled||this.disabled[e]==0}},Pd=class r extends Md{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let o=0;o<e.repeatNodeCount;o++)t.push("");let n=Object.keys(e.topRules).map(o=>e.topRules[o][1]),i=[];for(let o=0;o<t.length;o++)i.push([]);function a(o,l,u){i[o].push([l,l.deserialize(String(u))])}if(e.nodeProps)for(let o of e.nodeProps){let l=o[0];typeof l=="string"&&(l=ct[l]);for(let u=1;u<o.length;){let h=o[u++];if(h>=0)a(h,l,o[u++]);else{let f=o[u+-h];for(let c=-h;c>0;c--)a(o[u++],l,f);u++}}}this.nodeSet=new Td(t.map((o,l)=>on.define({name:l>=this.minRepeatTerm?void 0:o,id:l,props:i[l],top:n.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=1024;let s=Gu(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let o=0;o<this.specializerSpecs.length;o++)this.specialized[o]=this.specializerSpecs[o].term;this.specializers=this.specializerSpecs.map(H_),this.states=Gu(e.states,Uint32Array),this.data=Gu(e.stateData),this.goto=Gu(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(o=>typeof o=="number"?new ia(s,o):o),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,n){let i=new yw(this,e,t,n);for(let a of this.wrappers)i=a(i,e,t,n);return i}getGoto(e,t,n=!1){let i=this.goto;if(t>=i[0])return-1;for(let a=i[t+1];;){let s=i[a++],o=s&1,l=i[a++];if(o&&n)return l;for(let u=a+(s>>1);a<u;a++)if(i[a]==e)return l;if(o)return-1}}hasAction(e,t){let n=this.data;for(let i=0;i<2;i++)for(let a=this.stateSlot(e,i?2:1),s;;a+=3){if((s=n[a])==65535)if(n[a+1]==1)s=n[a=pi(n,a+2)];else{if(n[a+1]==2)return pi(n,a+2);break}if(s==t||s==0)return pi(n,a+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,n=>n==t?!0:null)}allActions(e,t){let n=this.stateSlot(e,4),i=n?t(n):void 0;for(let a=this.stateSlot(e,1);i==null;a+=3){if(this.data[a]==65535)if(this.data[a+1]==1)a=pi(this.data,a+2);else break;i=t(pi(this.data,a+1))}return i}nextStates(e){let t=[];for(let n=this.stateSlot(e,1);;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=pi(this.data,n+2);else break;if((this.data[n+2]&1)==0){let i=this.data[n+1];t.some((a,s)=>s&1&&a==i)||t.push(this.data[n],i)}}return t}configure(e){let t=Object.assign(Object.create(r.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=n}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(n=>{let i=e.tokenizers.find(a=>a.from==n);return i?i.to:n})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((n,i)=>{let a=e.specializers.find(o=>o.from==n.external);if(!a)return n;let s=Object.assign(Object.assign({},n),{external:a.to});return t.specializers[i]=H_(s),s})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),n=t.map(()=>!1);if(e)for(let a of e.split(" ")){let s=t.indexOf(a);s>=0&&(n[s]=!0)}let i=null;for(let a=0;a<t.length;a++)if(!n[a])for(let s=this.dialects[t[a]],o;(o=this.data[s++])!=65535;)(i||(i=new Uint8Array(this.maxTerm+1)))[o]=1;return new bw(e,n,i)}static deserialize(e){return new r(e)}}});var U_={};cz(U_,{parser:()=>jfe});var Kfe,jfe,K_=Nd(()=>{G_();Kfe={__proto__:null,BEGIN:28,END:30,PARBEGIN:32,PAREND:34},jfe=Pd.deserialize({version:14,states:"!dQYQPOOOOQO'#C^'#C^OOQO'#C`'#C`OOQO'#Ca'#CaOOQO'#Cb'#CbOkQPO'#CcOOQO'#Ci'#CiOOQO'#Cd'#CdQYQPOOOOQO,58},58}OOQO-E6b-E6b",stateData:"p~OZOS[OS~ORTO^PO_QO`ROaSO~ObXO~O",goto:"m^PP_P____cPPPPiTUOWQWORYWTVOW",nodeNames:"\u26A0 Program Begin Label End ParBegin ParEnd Call",maxTerm:18,skippedNodes:[0],repeatNodeCount:1,tokenData:"#t~R^X^}pq}!P!Q!r!]!^#a!c!}#f#T#o#f#y#z}$f$g}#BY#BZ}$IS$I_}$I|$JO}$JT$JU}$KV$KW}&FU&FV}~!SYZ~X^}pq}#y#z}$f$g}#BY#BZ}$IS$I_}$I|$JO}$JT$JU}$KV$KW}&FU&FV}~!uP!P!Q!x~!}S[~OY!xZ;'S!x;'S;=`#Z<%lO!x~#^P;=`<%l!x~#fOb~~#kRR~!Q![#f!c!}#f#T#o#f",tokenizers:[0],topRules:{Program:[0,1]},specialized:[{term:3,get:r=>Kfe[r]||-1}],tokenPrec:0})});var j_=B(Bd=>{"use strict";Object.defineProperty(Bd,"__esModule",{value:!0});Bd.stackify=void 0;var Yfe=r=>{let e=[],t=[];for(let n of r)if(n==="["){let i={type:"seq",child:t};e.push(i),t=[]}else if(n==="("){let i={type:"par",child:t};e.push(i),t=[]}else if(n==="]"||n===")"){let i=e.pop(),a={type:i.type,child:t};t=i.child,t.push(a)}else t.push({type:"call",id:crypto.randomUUID(),label:n});return t[0]};Bd.stackify=Yfe});var sce=B(Od=>{var $_=Od&&Od.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Od,"__esModule",{value:!0});var Z_=Ti(),Xfe=gE(),Q_=$_(BM()),$fe=$_(M_()),Zfe=D_(),Qfe=P_(),Jfe=B_(),ece=(K_(),pz(U_)),tce=j_();Q_.default.use($fe.default);var rce=document.getElementById("editor"),nce=document.getElementById("treeContainer"),ice,J_=r=>{let e=ece.parser.parse(r),t=(0,Jfe.parse)(r,e),n=(0,tce.stackify)(t),i=(0,Qfe.interpret)(n);(0,Q_.default)({container:nce,elements:i,layout:{name:"dagre"},style:[{selector:"node",css:{label:"data(label)"}}]})},ace=Z_.EditorView.updateListener.of(r=>{if(r.docChanged){let e=r.state.doc.toString();document.location.hash=encodeURI(e),J_(e)}}),Y_=decodeURI(document.location.hash.substring(1)),X_=Y_||Zfe.example;(async()=>(ice=new Z_.EditorView({extensions:[Xfe.basicSetup,ace],parent:rce,doc:X_}),J_(X_)))()});sce();})();
/*! Bundled license information:

cytoscape/dist/cytoscape.cjs.js:
  (*!
  Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
  Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
  Licensed under The MIT License (http://opensource.org/licenses/MIT)
  *)
  (*!
  Event object based on jQuery events, MIT license
  
  https://jquery.org/license/
  https://tldrlegal.com/license/mit-license
  https://github.com/jquery/jquery/blob/master/src/event.js
  *)
  (*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License *)
  (*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License *)
*/
